--Stealed clientside server code by exechack.cc
--Hostname: [TR] Venom Roleplay | DarkRP #venom25 - discord.gg/eniyisi  - Part 3/12 - 06/04/2025


--PATH lua/zclib/util/sh_convar.lua:
return gluapack()()
--lua/zclib/util/sh_effects.lua:
zclib = zclib or {}
zclib.Effect = zclib.Effect or {}

game.AddParticles("particles/zclib_vfx.pcf")
PrecacheParticleSystem("zclib_item_trail")
PrecacheParticleSystem("zclib_item_trail01")
PrecacheParticleSystem("zclib_sell")

game.AddParticles("particles/zmb_vgui.pcf")
PrecacheParticleSystem("zmb_vgui_destroy")
PrecacheParticleSystem("zmb_vgui_magic")
PrecacheParticleSystem("zmb_vgui_repair")
PrecacheParticleSystem("zmb_vgui_use")
PrecacheParticleSystem("zmb_vgui_upgrade")
PrecacheParticleSystem("zmb_vgui_techno")
PrecacheParticleSystem("zmb_vgui_sell")

PrecacheParticleSystem("zmb_vgui_firework_blue")
PrecacheParticleSystem("zmb_vgui_firework_green")
PrecacheParticleSystem("zmb_vgui_firework_red")
PrecacheParticleSystem("zmb_vgui_firework_yellow")


function zclib.Effect.Generic(effect, vPoint)
	local effectdata = EffectData()
	effectdata:SetStart(vPoint)
	effectdata:SetOrigin(vPoint)
	effectdata:SetScale(2)
	util.Effect(effect, effectdata, true, true)
end

if CLIENT then
	function zclib.Effect.RandomDecals(pos, decal, radius,amount)
		for i = 1, amount or 15 do
			local decal_pos = pos + Vector(1, 0, 0) * math.random(-radius, radius) + Vector(0, 1, 0) * math.random(-radius, radius)
			util.Decal(decal, decal_pos + Vector(0, 0, 5), decal_pos - Vector(0, 0, 50))
		end
	end

	function zclib.Effect.ParticleEffect(effect, pos, ang, ent)
		if zclib.Convar.Get("zclib_cl_particleeffects") == 0 then return end
		if not effect then return end
		if not pos then return end
		if not ang then return end

		if ent and IsValid(ent) then
			ParticleEffect(effect, pos, ang, ent)
		else
			ParticleEffect(effect, pos, ang)
		end
	end

	function zclib.Effect.ParticleEffectAttach(effect, attachType, ent, attachid)
		if zclib.Convar.Get("zclib_cl_particleeffects") == 0 then return end
		if not IsValid(ent) then return end
		if not attachType then return end
		if not effect then return end
		if not attachid then return end

		ParticleEffectAttach(effect, attachType, ent, attachid)
	end
end

zclib.NetEvent = zclib.NetEvent or {}

zclib.NetEvent.Definitions = {}
function zclib.NetEvent.AddDefinition(id,data,action,server)

	zclib.NetEvent.Definitions[id] = {
		data = data,
		action = action,
		server = server,
	}

	if SERVER then
		util.AddNetworkString("zclib_fx_" .. id)
	end

	if CLIENT then
		net.Receive("zclib_fx_" .. id, function(len)

			local received = {}
			for k,v in ipairs(data) do
				if v.type == "entity" then
					received[k] = net.ReadEntity()
				elseif v.type == "vector" then
					received[k] = net.ReadVector()
				elseif v.type == "uiint" then
					received[k] = net.ReadUInt(16)
				elseif v.type == "int" then
					received[k] = net.ReadInt(16)
				elseif v.type == "string" then
					received[k] = net.ReadString()
				elseif v.type == "bool" then
					received[k] = net.ReadBool()
				elseif v.type == "angle" then
					received[k] = net.ReadAngle()
				elseif v.type == "float" then
					received[k] = net.ReadFloat()
				end
			end

			if IsValid(LocalPlayer()) then
				pcall(action,received)
			end
		end)
	end
end

// Sends a Net Effect Msg to all clients
function zclib.NetEvent.Create(id, data01)

	local EffectGroup = zclib.NetEvent.Definitions[id]
	if not EffectGroup then return end

	// Should we call it on server too?
	if EffectGroup.server then
		pcall(EffectGroup.action,data01)
	end

	net.Start("zclib_fx_" .. id)
	for k,v in ipairs(EffectGroup.data) do
		if v.type == "entity" then
			net.WriteEntity(data01[k])
		elseif v.type == "vector" then
			net.WriteVector(data01[k])
		elseif v.type == "uiint" then
			net.WriteUInt(data01[k],16)
		elseif v.type == "int" then
			net.WriteInt(data01[k],16)
		elseif v.type == "string" then
			net.WriteString(data01[k])
		elseif v.type == "bool" then
			net.WriteBool(data01[k])
		elseif v.type == "angle" then
			net.WriteAngle(data01[k])
		elseif v.type == "float" then
			net.WriteFloat(data01[k])
		end
	end
	net.Broadcast()
end

zclib.NetEvent.AddDefinition("zclib_sell", {
	[1] = {
		type = "vector"
	}
}, function(received)
	local pos = received[1]
	if pos == nil then return end
	zclib.Effect.ParticleEffect("zclib_sell", pos, angle_zero, LocalPlayer())
	zclib.Sound.EmitFromPosition(pos,"cash")
end)

--lua/zclib/util/player/sh_player.lua:
zclib = zclib or {}
zclib.Player = zclib.Player or {}

zclib.Player.List = zclib.Player.List or {}

if SERVER then
	util.AddNetworkString("zclib_Player_Send")
	function zclib.Player.Send(plytbl,sendto)

		// Better save then sorry
		local cleantbl = {}
		for k,v in pairs(plytbl) do
			if IsValid(v) then
				table.insert(cleantbl,v)
			end
		end

		local length = table.Count(cleantbl)
		net.Start("zclib_Player_Send")
		net.WriteUInt(length,15)
		for k,v in pairs(cleantbl) do
			net.WriteEntity(v)
		end
		net.Send(sendto)
	end
else
	net.Receive("zclib_Player_Send", function(len)
		zclib.Debug_Net("zclib_Player_Send", len)
		local length = net.ReadUInt(15)
		for i = 1,length do
			local ply = net.ReadEntity()
			if IsValid(ply) then
				zclib.Player.Add(ply)
			end
		end
	end)
end

function zclib.Player.Add(ply)
    zclib.Player.List[zclib.Player.GetID(ply)] = ply
	if SERVER then

		// Tell the other players that this player just joined
		zclib.Player.Send({ply},zclib.Player.GetAll())

		// Tell this player about the other players
		zclib.Player.Send(zclib.Player.GetAll(),ply)
	end
end

function zclib.Player.GetAll()
	local cleantbl = {}
	for k,v in pairs(zclib.Player.List) do
		if IsValid(v) then
			table.insert(cleantbl,v)
		end
	end
	return cleantbl
end

/*
	A timer that auto updates the Playerlist ever 10 minutes
*/
zclib.Timer.Remove("zclib.Player.GetAll")
zclib.Timer.Create("zclib.Player.GetAll",600,0,function()
	for k,v in pairs(player.GetAll()) do
		if IsValid(v) then
			zclib.Player.List[zclib.Player.GetID(v)] = v
		end
	end
end)

// Returns a list of all the players who are close enough to the provided distance
function zclib.Player.GetInSphere(pos,radius)
    local tbl = {}
    for k,v in pairs(zclib.Player.List) do
        if IsValid(v) and zclib.util.InDistance(v:GetPos(), pos, radius) then
            tbl[v] = true
        end
    end
    return tbl
end

// Returns the steam id of the player
function zclib.Player.GetID(ply)
    if ply:IsBot() then
        return ply:UserID()
    else
        return ply:SteamID()
    end
end

// Returns the name of the player
function zclib.Player.GetName(ply)
    if ply:IsBot() then
        return "Bot_" .. ply:UserID()
    else
        return ply:Nick()
    end
end

// Returns the player rank / usergroup
function zclib.Player.GetRank(ply)
	if ply.GetSecondaryUserGroup then
		local rank = ply:GetSecondaryUserGroup()
		if rank == "user" then rank = ply:GetUserGroup() end
		if rank == "" then rank = ply:GetUserGroup() end
		if rank == " " then rank = ply:GetUserGroup() end
		if rank == "  " then rank = ply:GetUserGroup() end
		return rank
	else
		return ply:GetUserGroup()
	end
end

// Checks if the player has one of the specified ranks
function zclib.Player.RankCheck(ply, ranks)
	if not IsValid(ply) or ranks == nil then return false end
	if table.Count(ranks) <= 0 then return true end

	if xAdmin then
		local HasRank = false

		for k, v in pairs(ranks) do
			if ply:IsUserGroup(k) then
				HasRank = true
				break
			end
		end

		return HasRank
	else
		if ranks[ zclib.Player.GetRank(ply) ] == nil then
			return false
		else
			return true
		end
	end
end

function zclib.Player.JobCheck(ply, jobs)
    if not IsValid(ply) or jobs == nil then return false end
    if table.Count(jobs) <= 0 then return true end

    return jobs[zclib.Player.GetJobName(ply)] ~= nil
end

// Returns the players job
function zclib.Player.GetJob(ply)
    if not IsValid(ply) then return -1 end
    return ply:Team()
end

// Returns the players job command
function zclib.Player.GetJobCommand(ply)
    if not IsValid(ply) then return "" end
	local jobtbl = RPExtraTeams[ply:Team()]
	if not jobtbl then return "" end
    return jobtbl.command
end

// Returns the players job name
function zclib.Player.GetJobName(ply)
    if not IsValid(ply) then return "Invalid" end
    return team.GetName(zclib.Player.GetJob(ply))
end

// Gets the position of the players head
function zclib.Player.GetHeadPos(ply)
    local pos = ply:GetPos() + ply:GetUp() * 25
    local attachID = ply:LookupAttachment("eyes")
    if attachID then
        local attach = ply:GetAttachment(attachID)
        if attach then
            pos = attach.Pos
        end
    end
    return pos
end


// This returns true if the player is a admin
function zclib.Player.IsAdmin(ply)
    if IsValid(ply) then

        // xAdmin Support
        if xAdmin then
            return ply:IsAdmin()

        // SAM Support
        elseif sam then
            return ply:IsSuperAdmin()

        // sAdmin support
        elseif sAdmin then
            return ply:IsAdmin()

        elseif ply:IsSuperAdmin() == true then
            return true
        elseif ply.IsAdmin and ply:IsAdmin() == true then
            return true
        else
            if zclib.config.AdminRanks[zclib.Player.GetRank(ply)] then

                return true
            else

                return false
            end
        end
    else
        return false
    end
end

if SERVER then

	// This saves the owners SteamID
	function zclib.Player.SetOwner(ent, ply)

		if (IsValid(ply)) then
			ent:SetNWString("zclib_Owner", ply:SteamID())

			if CPPI then
				ent:CPPISetOwner(ply)
			end

			if gProtect and istable(gProtect) then
				gProtect.SetOwner(ply,ent)
			end
		else
			ent:SetNWString("zclib_Owner", "world")
		end
	end
end

// This returns the entites owner SteamID
function zclib.Player.GetOwnerID(ent)
	return ent:GetNWString("zclib_Owner", "nil")
end

// Checks if both entities have the same owner
function zclib.Player.SharedOwner(ent01,ent02)
	if IsValid(ent01) and IsValid(ent02) then

		if zclib.Player.GetOwnerID(ent01) == zclib.Player.GetOwnerID(ent02) then
			return true
		else
			return false
		end
	else
		return false
	end
end

// This returns the owner
function zclib.Player.GetOwner(ent)
	if IsValid(ent) then

		local id = ent:GetNWString("zclib_Owner", "nil")
		local ply = player.GetBySteamID(id)
		if IsValid(ply) then return ply end

		ply = ent:GetOwner()
		if IsValid(ply) then return ply end


		if gProtect then ply = gProtect.GetOwner(ent) end
		if IsValid(ply) then return ply end

		if ent.CPPIGetOwner then ply = ent:CPPIGetOwner() end
		if IsValid(ply) then return ply end

		return false
	else
		return false
	end
end

// Checks if the player is the owner of the entitiy
function zclib.Player.IsOwner(ply, ent)
	if IsValid(ent) and IsValid(ply) then
		local id = ent:GetNWString("zclib_Owner", "nil")
		local ply_id = ply:SteamID()

		if id == ply_id or id == "world" then

			return true
		else
			return false
		end
	else
		return false
	end
end

--lua/zclib/generic/sh_vgui.lua:
zclib = zclib or {}
zclib.vgui = zclib.vgui or {}

if SERVER then
    // Forces the interface to be closed
    util.AddNetworkString("zclib_vgui_forceclose")
    function zclib.vgui.ForceClose(ply,identifier)
        // Only DFrames which have this value will be removed > identifier
    	net.Start("zclib_vgui_forceclose")
        net.WriteUInt(identifier,32)
    	net.Send(ply)
    end

    function zclib.vgui.ForceCloseAll(identifier)
        net.Start("zclib_vgui_forceclose")
        net.WriteUInt(identifier,32)
        net.Broadcast()
    end
else
    function zclib.vgui.ForceClose(identifier)
        if IsValid(zclib_main_panel) then

            // If this interace doesent have the same identifier then stop
            if identifier and zclib_main_panel[identifier] == nil then return end

            zclib_main_panel:Close()
        end
    end

    net.Receive("zclib_vgui_forceclose", function(len)
        local identifier = net.ReadUInt(32)
        zclib.vgui.ForceClose(identifier)
    end)
end

--lua/zclib/generic/cl_avatar.lua:
if SERVER then return end
zclib = zclib or {}
zclib.Avatar = zclib.Avatar or {}

/*

    Steam avatar downloader taken from > https://github.com/WilliamVenner/glua-material-avatar/blob/master/material-avatar.lua

*/

local AVATAR_IMAGE_CACHE_EXPIRES = 86400 -- 1 day, in seconds
local default = Material("vgui/avatar_default")
function zclib.Avatar.GetMaterial(steamid64, callback)

	if steamid64 == nil then
		return callback(default)
	end

	-- First, check the cache to see if this avatar has already been downloaded.
	-- If the avatar hasn't been cached in data/, file.Time will return 0.
	-- If an avatar material is 1 day old, let's redownload it but use it as a fallback in case something goes wrong.
	local fallback
	if os.time() - file.Time("avatars/" .. steamid64 .. ".png", "DATA") > AVATAR_IMAGE_CACHE_EXPIRES then
		fallback = Material("../data/avatars/" .. steamid64 .. ".png", "smooth")
	elseif os.time() - file.Exists("avatars/" .. steamid64 .. ".jpg", "DATA") > AVATAR_IMAGE_CACHE_EXPIRES then
		fallback = Material("../data/avatars/" .. steamid64 .. ".jpg", "smooth")
	end

	-- If a fallback couldn't be found in data/, default to vgui/avatar_default
	if not fallback or fallback:IsError() then
		fallback = default
	else
		-- Otherwise, if a cached avatar was found, and it hasn't expired, return it!
		return callback(fallback)
	end

	-- Fetch the XML version of the player's Steam profile.
	-- This XML contains a tag, <avatarFull> which contains the URL to their full avatar.
	http.Fetch("https://steamcommunity.com/profiles/" .. steamid64 .. "?xml=1",

		function(body, size, headers, code)
			-- If the HTTP request fails (size = 0, code is not a HTTP success response code) then return the fallback
			if size == 0 or code < 200 or code > 299 then return callback(fallback, steamid64) end

			local url, fileType = body:match("<avatarFull>.-(https?://%S+%f[%.]%.)(%w+).-</avatarFull>") -- Extract the URL and file extension from <avatarFull>
			if not url or not fileType then return callback(fallback, steamid64) end -- If the URL or file type couldn't be extracted, return the fallback.
			if fileType == "jpeg" then fileType = "jpg" end -- Defensively ensure jpeg -> jpg.

			-- Download the avatar image
			http.Fetch(url .. fileType,

				function(body, size, headers, code)
					if size == 0 or code < 200 or code > 299 then return callback(fallback, steamid64) end

					local cachePath = "avatars/" .. steamid64 .. "." .. fileType
					file.CreateDir("avatars")
					file.Write(cachePath, body) -- Write the avatar to data/

					local material = Material("../data/" .. cachePath, "smooth") -- Load the avatar from data/ as a Material
					if material:IsError() then
						-- If the material errors, the image must be corrupt, so we'll delete this from data/ and return the fallback.
						file.Delete(cachePath)
						callback(fallback, steamid64)
					else
						-- We succeeded, return the downloaded avatar image material!
						callback(material, steamid64)
					end

				end,

				-- If we hard-fail, return the fallback image.
				function() callback(fallback, steamid64) end

			)
		end,

		-- If we hard-fail, return the fallback image.
		function() callback(fallback, steamid64) end
	)
end

-- We don't want to fill the user's hard drive up with avatars over time, so we'll clear them whenever they join the server.
-- This also has the added benefit of allowing the user to "manually" regenerate avatars if they so desire.
local function clearCachedAvatars()
    for _, f in ipairs(file.Find("avatars/*", "DATA")) do
        file.Delete("avatars/" .. f)
    end

    hook.Remove("InitPostEntity", "clearCachedAvatars") -- Just to be safe.
end
hook.Add("InitPostEntity", "clearCachedAvatars", clearCachedAvatars)

--lua/zclib/generic/cl_imgur.lua:
return gluapack()()
--lua/zclib/generic/cl_minimap.lua:
if SERVER then return end
zclib = zclib or {}
zclib.MiniMap = zclib.MiniMap or {}

/*

    Modified version of MG Factions MiniMap

*/

local nextopen = 0
local drag_spd = 2
local scroll_spd = 0.2
local max_map_size = 32768
local map_maxz
local sizemult = {0.6, 0.8}
local windowsize = {ScrW() * sizemult[1], ScrH() * sizemult[2]}
local viewmult = math.Clamp(1, 0.5, 3)
local circle32_mat = Material("zerochain/zerolib/ui/circle_32.png", "smooth ignorez")

local function DrawOutlineCircle(x, y, w, h, color, rot)
    surface.SetMaterial(circle32_mat)

    surface.SetDrawColor(color_black)
    surface.DrawTexturedRectRotated(x, y, w / viewmult, h / viewmult, rot)

    surface.SetDrawColor(color)
    surface.DrawTexturedRectRotated(x, y, (w - 2) / viewmult, (h - 2) / viewmult, rot)
end

function zclib.MiniMap.Setup(data)

	local minimap

    local function MiniMap_Open()
        if IsValid(minimap) then minimap:Remove() end

        local ply = LocalPlayer()
        local ang = Angle(0, 0, 0)

        windowsize = {ScrW() * (data.config.Width or sizemult[1]), ScrH() * (data.config.Height or sizemult[2])}

        viewmult = math.Clamp(data.config.MiniMapDefaultZoom, data.config.MiniMapMinZoom, data.config.MiniMapMaxZoom)
        minimap = vgui.Create("DPanel")
        minimap:SetSize(windowsize[1], windowsize[2])
        minimap:Center()
        minimap:MakePopup()
        minimap:ParentToHUD()

        // Enable movement via keyboard
        if data.config.MiniMapMovement then
            minimap:SetKeyboardInputEnabled(false)
        end

        minimap.MousePosX = 0
        minimap.MousePosY = 0
        minimap.OffsetVector = Vector(0, 0, 0)
        minimap.LockedOnPlayer = true
        local ready = false

        minimap.Think = function(self)
            // Close mechanic
            if data.config.MiniMapButton and (input.IsKeyDown(data.config.MiniMapButton) or input.IsKeyDown(KEY_ESCAPE)) then
                if not ready then return end
                self:Remove()
                nextopen = SysTime() + 0.1

                return
            else
                ready = true
            end

            // Drag logic
            if not self:IsHovered() then return end
            local mx, my = input.GetCursorPos()
			self.MouseX = mx
			self.MouseY = my

            local tb = self:GetTable()

            if input.IsMouseDown(MOUSE_LEFT) then
                if not tb.LM then
                    tb.LM = true
                else
                    local nx, ny = tb.MousePosX - mx, tb.MousePosY - my
                    self:StopLock()
                    tb.OffsetVector.x = tb.OffsetVector.x - (ny * viewmult * drag_spd)
                    tb.OffsetVector.y = tb.OffsetVector.y - (nx * viewmult * drag_spd)
                end
            else
                tb.LM = false
            end

            tb.MousePosX, tb.MousePosY = mx, my
        end

        // Scrolling in and out
        minimap.OnMouseWheeled = function(self, scroll)
            viewmult = math.Clamp(viewmult - (scroll * scroll_spd), data.config.MiniMapMinZoom, data.config.MiniMapMaxZoom)
        end

        // Caching the view table
        minimap.viewdata = {
            w = minimap:GetWide() - 20,
            h = minimap:GetTall() - 50,
            drawviewmodel = false,
            drawhud = false,
            drawmonitors = false,
            bloomtone = false
        }

        // Get view pos
        minimap.GetViewPos = function(self)
            local tb = self:GetTable()

            return tb.LockedOnPlayer and ply:EyePos() or Vector(tb.LockPos.x, tb.LockPos.y, tb.LockPos.z)
        end

        // Get view angle
        minimap.GetViewAng = function(self) return ang end

        // Stop locking the view to the player
        minimap.StopLock = function(self)
            if self.LockedOnPlayer then
                self.LockedOnPlayer = false
                self.LockPos = ply:EyePos()
            end
        end

        // Cache max map height
        minimap.GenerateMaxHeight = function()
            if not map_minz or not map_maxz then
                local _, maxs = game.GetWorld():GetRenderBounds()
                map_maxz = maxs.z
            end
        end

        // Get max map height
        minimap.GetMaxHeight = function()
            minimap.GenerateMaxHeight()

            return map_maxz
        end

        // Function for converting something from 3D to 2D.
        minimap.To2D = function(self, pos, campos)
            local w, h = self:GetWide() / 2, self:GetTall() / 2

            return w + ((campos.y - pos.y) / viewmult) / 2, h + ((campos.x - pos.x) / viewmult) / 2
        end

        // Draw player(s)
        minimap.DrawPlayer = function(self, aply, campos, aang)
            local x, y = self:To2D(aply:GetPos(), campos + self.OffsetVector, aang)
            y = y + 10
			if aply.zclib_avatar_icon and viewmult <= 4 then

				local pSize = 200
				local val = math.Clamp(6 - viewmult, 0, 6)
				local reduce = (150 / 6) * val
				pSize = pSize - reduce
				pSize = pSize / viewmult
				local pW = pSize * 0.44

				zclib.BMASKS.BeginMask("zclib_Circle")
				surface.SetMaterial(aply.zclib_avatar_icon)
				surface.SetDrawColor(color_white)
				surface.DrawTexturedRectRotated(x, y, pW * 0.98, pW * 0.98, 0)
				zclib.BMASKS.EndMask("zclib_Circle", x, y , pW, pW, 255, 0)

				surface.SetMaterial(zclib.Materials.Get("circle_thick"))
				surface.SetDrawColor(color_black)
				surface.DrawTexturedRectRotated(x, y, pW * 0.98, pW * 0.98, 0)
			else
				DrawOutlineCircle(x, y, 32, 32, zclib.colors["orange01"], aang.y)
			end

			if viewmult > 4 then return end

			/*
				All of this is just so the name fades in / out if the curso goes near the players avatar
			*/
			if not self.MouseX or not self.MouseY then return end
			if not aply.zclib_map_lasthover then aply.zclib_map_lasthover = CurTime() end
			local sX,sY = self:LocalToScreen(x,y)
			local dist = Vector(sX,sY,0):Distance(Vector(self.MouseX,self.MouseY,0))
			if dist < 100 then aply.zclib_map_lasthover = CurTime() end
			local alpha = math.Clamp(255 - ((255 / 5) * (CurTime() - aply.zclib_map_lasthover)),0,255)

			if (aply.zclib_map_lasthover + 5) > CurTime() then
				draw.SimpleTextOutlined(aply:Name(), zclib.GetFont("zclib_font_small"), x, y + (15 / viewmult), Color(255,255,255,alpha), TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER, 1, Color(0,0,0,alpha))
			end
        end

		/*
			Load all the steam avatar images inside the players entity
		*/
		for _, v in ipairs(player.GetAll()) do
			zclib.Avatar.GetMaterial(v:SteamID64(), function(mat)
				if IsValid(v) and v:IsValid() and mat then
					v.zclib_avatar_icon = mat
				end
			end)
		end


        // Painting the view
        minimap.Paint = function(self, w, h)
            draw.RoundedBox(5, 0, 0, w, h, zclib.colors["ui02"])

            draw.SimpleText("Mini Map", zclib.GetFont("zclib_font_big"), 10 * zclib.wM, 1 * zclib.hM, zclib.colors["text01"], TEXT_ALIGN_LEFT, TEXT_ALIGN_TOP)

			local tb = self:GetTable()
            local campos = minimap:GetViewPos()
            local aang = minimap:GetViewAng()

            // Make a trace to check for the current max height
            local trace = util.TraceLine({
                start = campos,
                endpos = campos + Vector(0, 0, max_map_size),
                filter = ply
            })

            local max_z = self.GetMaxHeight() // Get max height of current map
            campos.z = max_z
            local znear = max_z - trace.HitPos.z

            local viewdata = minimap.viewdata
            viewdata.origin = campos + tb.OffsetVector
            viewdata.znear = znear
            viewdata.zfar = max_map_size
            viewdata.angles = Angle(90, 0, 0)

            local x, y = self:GetPos()
            viewdata.x = x + 10
            viewdata.y = y + 40

            // Setup ortho view
            viewdata.ortho = {
                top = -viewdata.h * viewmult,
                bottom = viewdata.h * viewmult,
                left = -viewdata.w * viewmult,
                right = viewdata.w * viewmult
            }

            // Some parameters to optimise the ongoing render view
            render.SuppressEngineLighting(true)
            render.SetShadowsDisabled(true)
            render.PushFlashlightMode(false)
			local old = DisableClipping( true )

			render.RenderView(viewdata)

			DisableClipping( old )
            render.PopFlashlightMode()
            render.SetShadowsDisabled(false)
            render.SuppressEngineLighting(false)

            // Cut off text outside of the rendered view.
            render.SetScissorRect(viewdata.x, viewdata.y, viewdata.x + viewdata.w, viewdata.y + viewdata.h, true)

            pcall(data.OnDraw,minimap,campos,aang,viewmult)

            // Draw local player
			if not data.config.HideLocalPlayer then
            	self:DrawPlayer(ply, campos, aang)
			end

            // Show other players
            if not data.config.HidePlayers then
                for _, v in ipairs(player.GetAll()) do
                    if ply ~= v and v:GetNoDraw() then continue end
                    self:DrawPlayer(v, campos, aang)
                end
            end

            render.SetScissorRect(0, 0, 0, 0, false)

			if not data.config.HideHelp then
	            draw.SimpleTextOutlined("Drag mouse: Adjust position", zclib.GetFont("zclib_font_mediumsmall_thin"), 15, h - 50, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_TOP, 1, color_black) // Print instructions
	            draw.SimpleTextOutlined("Scroll: Zoom", zclib.GetFont("zclib_font_mediumsmall_thin"), 15, h - 30, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_TOP, 1, color_black)
			end
        end

        if not data.config.HideLockOnPlayer then
            local x = zclib.util.GetTextSize("Lock on player", zclib.GetFont("zclib_font_medium"))

            local btn = zclib.vgui.TextButton(0, 0, x + 50, 40, minimap, {
                Text01 = "Lock on player",
                txt_font = zclib.GetFont("zclib_font_medium")
            }, function()
                // Reset everything and lock the view to the player again
                minimap.LockedOnPlayer = true
                minimap.OffsetVector = Vector(0, 0, 0)
            end, function() return false end, function() return false end)

            btn:Dock(RIGHT)
            btn:DockMargin(0, 670, 15, 15)
        end
    end

    // Open the mini map with pressing a button
    if data.config.MiniMapButton then
        zclib.Hook.Remove("PlayerButtonDown", "zclib_MiniMap")
        zclib.Hook.Add("PlayerButtonDown", "zclib_MiniMap", function(ply, button)
            if data.config.MiniMapButton ~= button or nextopen > SysTime() then return end
            if not IsFirstTimePredicted() then return end
            if ply ~= LocalPlayer() or ply:IsTyping() then return end
			if IsValid(minimap) then
				minimap:Remove()
			else
				MiniMap_Open()
			end
        end)
    end

    // Open the mini map with a command
    if data.config.MiniMapCommand then
        zclib.Hook.Remove("OnPlayerChat", "zclib_MiniMap")
        zclib.Hook.Add("OnPlayerChat", "zclib_MiniMap", function(ply, text)
            if data.config.MiniMapCommand and data.config.MiniMapCommand ~= "" and string.lower(text) == data.config.MiniMapCommand then
                if ply ~= LocalPlayer() then return true end
                MiniMap_Open()

                return true
            end
        end)
    end
end

/*


zclib.MiniMap.Setup({
	config = {
		MiniMapCommand = "!minimap",
		MiniMapButton = KEY_M,
		MiniMapDefaultZoom = 1,
		MiniMapMinZoom = 0.5,
		MiniMapMaxZoom = 15,
		MiniMapMovement = true,
		HideLockOnPlayer = true,
		HideLocalPlayer = false,
		HidePlayers = false,
		HideHelp = true
	},
	OnDraw = function(minimap, campos, aang, viewmult)


	end
})
*/

--lua/zclib/generic/cl_vgui_effects.lua:
return gluapack()()
--lua/zclib/inventory/sh_item.lua:
return gluapack()()
--lua/zclib/inventory/vgui/cl_slot.lua:
return gluapack()()
--addons/[binbon]misc/lua/autorun/!bb_shmisc.lua:

hook.Add('PreGamemodeLoaded', 'BinBon.WidgetsRemover', function()
    function widgets.PlayerTick()
    end
    hook.Remove('PlayerTick', 'TickWidgets')
end)
function widgets.PlayerTick()
end
hook.Remove('PlayerTick', 'TickWidgets')
local seat_class = 'prop_vehicle_prisoner_pod'
local function SetVehicleNoThink(vehicle)
    if IsValid(vehicle) and vehicle:GetClass() == seat_class then vehicle:AddEFlags(EFL_NO_THINK_FUNCTION) end
end

hook.Add('OnEntityCreated', 'BinBon.VehicleSeatsOptimize', function(ent) timer.Simple(0, function() SetVehicleNoThink(ent) end) end)
hook.Add('InitPostEntity', 'BinBon.VehicleSeatsOptimize', function()
    timer.Simple(1, function()
        local entities = ents.GetAll()
        for i = 1, #entities do
            SetVehicleNoThink(entities[i])
        end
    end)
end)

hook.Add('PlayerLeaveVehicle', 'VehicleSeatsOptimizeLeave', function(ply, vehicle) SetVehicleNoThink(vehicle) end)
hook.Add('PlayerEnteredVehicle', 'VehicleSeatsOptimizeLeave', function(ply, vehicle)
   if IsValid(vehicle) and vehicle:GetClass() == seat_class then
        local animate = vehicle:GetSaveTable()
       if animate['m_bEnterAnimOn'] or animate['m_bExitAnimOn'] then
            vehicle:RemoveEFlags(EFL_NO_THINK_FUNCTION)
        else
            vehicle:AddEFlags(EFL_NO_THINK_FUNCTION)
       end
    end
end)

if CLIENT then
    local changeConvarList = {
        ['gmod_mcore_test'] = '1',
        ['mat_queue_mode'] = '-1',
        ['cl_threaded_bone_setup'] = '1',
        ['cl_threaded_client_leaf_system'] = '1',
        ['r_threaded_client_shadow_manager'] = '1',
        ['r_threaded_particles'] = '1',
        ['r_threaded_renderables'] = '1',
        ['r_queued_ropes'] = '1',
        ['studio_queue_mode'] = '1',
        ['cl_forcepreload'] = '1', -- ['mat_specular'] = '0',
        ['r_fastzreject'] = '1',
    }

    for cvar_name, cvar_value in pairs(changeConvarList) do -- ['mp_decals'] = '50', -- ['r_decals'] = '1024', -- ['r_WaterDrawReflection'] = '0',
        RunConsoleCommand(cvar_name, cvar_value)
    end
end

hook.Add("InitPostEntity", "RemoveShittyHooks", function()
    local phys_settings = physenv.GetPerformanceSettings()
    phys_settings.LookAheadTimeObjectsVsObject = 0 -- 0.5
    phys_settings.LookAheadTimeObjectsVsWorld = 0.1 -- 1
    phys_settings.MaxAngularVelocity = 3600 -- 7272.7275390625
    phys_settings.MaxCollisionChecksPerTimestep = 100 -- 50000
    phys_settings.MaxCollisionsPerObjectPerTimestep = 1 -- 10
    phys_settings.MaxFrictionMass = 2500 -- 2500
    phys_settings.MaxVelocity = 768 -- 4000
    phys_settings.MinFrictionMass = 100 -- 10
    physenv.SetPerformanceSettings(phys_settings)
end)

local allowedRanks = {
    ["user"] = true,
    ["donator+"] = true,
    ["donator"] = true,
}

hook.Add("SpawnMenuOpen", "binbon_blockmenutabs", function()
    if not allowedRanks[LocalPlayer():GetUserGroup()] then return end
    for k, v in pairs(g_SpawnMenu.CreateMenu.Items) do
        if not IsValid(v) then continue end
        if v.Tab:GetText() == language.GetPhrase("spawnmenu.category.npcs") or v.Tab:GetText() == language.GetPhrase("spawnmenu.category.entities") or v.Tab:GetText() == language.GetPhrase("spawnmenu.category.weapons") or v.Tab:GetText() == language.GetPhrase("spawnmenu.category.vehicles") or v.Tab:GetText() == language.GetPhrase("spawnmenu.category.postprocess") or v.Tab:GetText() == language.GetPhrase("spawnmenu.category.dupes") or v.Tab:GetText() == language.GetPhrase("spawnmenu.category.saves") then g_SpawnMenu.CreateMenu:CloseTab(v.Tab, true) end
    end
end)


    hook.Remove("PlayerTick", "TickWidgets")
    function widgets.PlayerTick()
    end


local distance = 4096 * 8
function util.GetPlayerTrace(ply, dir)
    local start = ply:EyePos()
    return {
        start = start,
        endpos = start + ((dir or ply:GetAimVector()) * distance),
        filter = ply
    }
end
local yetkililer = {
    ["superadmin"] = true,
    ["admin"] = true,
    ["toplulukyoneticisi"] = true,
    ["genelyetkili"] = true,
    ["denetmen"] = true,
    ["moderator3"] = true,
    ["moderator2"] = true,
    ["moderator"] = true,
    ["denememoderator"] = true,
    ["rehber4"] = true,
    ["rehber3"] = true,
    ["rehber2"] = true,
    ["rehber"] = true,
    ["denemerehber"] = true,
}
function isyetkili(ply)
return yetkililer[ply:GetUserGroup()] and true or false 
end 

-- blink gc test surumdedir, normal yeri clienttir server icin ilk sefer deneniyor duruma gore yer degistirilecek
local blink_gc_memory = CreateClientConVar("blink_gc_memory", "668432", true, false, "Sets the amount of KB! before manually running a garbage collection.")
local blink_gc_enable = CreateClientConVar("blink_gc_enable", "1", true, false, "Activates Blink's Garbage Collection, if loaded disable, it will not load the rest of the script.")
local blink_gc_print = CreateClientConVar("blink_gc_print", "1", true, false, "Shows you your active memory being used in console.")

if blink_gc_enable:GetBool() then  -- if it's disabled, dont load the rest on launch

local function PrintMemory(message)
	if not blink_gc_print:GetBool() then return end
	MsgC(Color(115, 148, 248), message .. "\n")
end
local function ClearLuaMemory()
	if not blink_gc_enable:GetBool() then return end
	local mem = collectgarbage("count")
	PrintMemory("Active Lua Memory : " .. math.Round(mem / 1024) .. " MB.")

	if mem >= math.Clamp(blink_gc_memory:GetInt(), 262144, 978944) then
		collectgarbage("collect")
		local nmem = collectgarbage("count")
		PrintMemory("Removed " .. math.Round((mem - nmem) / 1024) .. " MB from active memory.")
	end
end
timer.Create("Aggro_Lua_GC", 150, 0, ClearLuaMemory)
concommand.Add("blink_gc_luamemory", function()
	local LuaMem = collectgarbage("count")
	PrintMemory("Active Lua Memory : " .. math.Round(LuaMem / 1024) .. " MB.")
end)
end

local pmeta = FindMetaTable("Player")
pmeta.SteamName = pmeta.SteamName or pmeta.Name
function pmeta:Name()
    if not self:IsValid() then DarkRP.error("Attempt to call Name/Nick/GetName on a non-existing player!", SERVER and 1 or 2) end
    return GAMEMODE.Config.allowrpnames and self:getDarkRPVar("rpname")
        or self:SteamName()
end
pmeta.GetName = pmeta.Name
pmeta.Nick = pmeta.Name

local Config = {
    sellerPositions = {
        Vector(-2898.650146, -7279.242188, -131.968750),
        Vector(350.578369, -6781.601074, -131.968750),
        Vector(-702.358154, -6158.956543, -131.968750),
    },
    sellerRadius = 150,
    minTime = 1 * 60,
    maxTime = 5 * 60,
    colors = {
        primary = Color(8, 83, 133),
        secondary = Color(255, 200, 0),
        success = Color(46, 204, 113),
        warning = Color(231, 76, 60),
        background = Color(0, 0, 0, 180),
        text = Color(255, 255, 255),
        highlight = Color(255, 255, 255, 200),
        progressBar = Color(46, 204, 113, 200),
        progressBarBg = Color(52, 73, 94, 150)
    }
}

if SERVER then
    util.AddNetworkString("SaticiMenusuAc")
    util.AddNetworkString("SaticiGoreviniBaslat")
    util.AddNetworkString("SaticiYolGoster")
    util.AddNetworkString("SaticiGoreviniIptalEt")
    util.AddNetworkString("SaticiGoreviTamamlandi")
    
    local aktifSaticilar = {}
    
    function paraver(ply, amount)
        if not IsValid(ply) or not amount or amount <= 0 then return end
        
        net.Start("SaticiMenusuAc")
        net.WriteInt(amount, 32)
        net.WriteInt(math.floor(amount * 2), 32)
        net.Send(ply)
        ply.ParaVeriliyor = true 
        ply.ParaVeriliyor_Miktar = amount
    end
    
    net.Receive("SaticiMenusuAc", function(len, ply)
        local secim = net.ReadInt(8)
        local miktar = net.ReadInt(32)
        if not ply.ParaVeriliyor then return end 
        if ply.ParaVeriliyor_Miktar != miktar then return end
        if secim == 1 then
            ply:addMoney(miktar)
            ply:ChatPrint("" .. miktar .. " para aldın!")
            DarkRP.notify(ply, 0, 10, miktar.." para aldın!")
            ply.ParaVeriliyor = nil 
            ply.ParaVeriliyor_Miktar = nil 
        elseif secim == 2 then
            local bonusMiktar = math.floor(miktar * 2)
            local posIndex = math.random(#Config.sellerPositions)
            local konum = Config.sellerPositions[posIndex]
            
            aktifSaticilar[ply:SteamID()] = {
                player = ply,
                position = konum,
                amount = bonusMiktar,
                originalAmount = miktar,
                active = false,
                earned = 0
            }
            
            net.Start("SaticiYolGoster")
            net.WriteVector(konum)
            net.WriteInt(bonusMiktar, 32)
            net.Send(ply)
            ply.ParaVeriliyor = nil 
            ply.ParaVeriliyor_Miktar = nil 
        end
    end)
    
    net.Receive("SaticiGoreviniBaslat", function(len, ply)
        local steamID = ply:SteamID()
        
        if not aktifSaticilar[steamID] then return end
        
        local saticiVerisi = aktifSaticilar[steamID]
        local hedefKonum = saticiVerisi.position
        local oyuncuKonum = ply:GetPos()
        
        if oyuncuKonum:Distance(hedefKonum) <= 150 then
            saticiVerisi.active = true
            
            local toplamMiktar = saticiVerisi.amount
            local normalMiktar = saticiVerisi.originalAmount
            
            local tekrarSayisi = math.Clamp(math.floor(toplamMiktar / 10), Config.minTime, Config.maxTime)
            local herSeferOdeme = toplamMiktar / tekrarSayisi
            
            local timerAdi = "SaticiGorev_" .. steamID
            
            saticiVerisi.timer = timerAdi
            saticiVerisi.totalTicks = tekrarSayisi
            ply:wanted(nil, "Villalarda Uyuştucu Satmaktan", tekrarSayisi)
            timer.Create(timerAdi, 1, tekrarSayisi, function()
                if not IsValid(ply) then
                    timer.Remove(timerAdi)
                    aktifSaticilar[steamID] = nil
                    return
                end
                
                local suankiKonum = ply:GetPos()
                if suankiKonum:Distance(hedefKonum) > Config.sellerRadius then
                    timer.Remove(timerAdi)
                    aktifSaticilar[steamID] = nil
                    
                    net.Start("SaticiGoreviniIptalEt")
                    net.Send(ply)
                    
                    ply:ChatPrint("[ Venom RolePlay ] Satış başarısız! Satış bölgesinden ayrıldın.")
                    DarkRP.notify(ply, 1, 10, "Satış başarısız! Satış bölgesinden ayrıldın.")
                    return
                end
                
                ply:addMoney(herSeferOdeme)
                saticiVerisi.earned = saticiVerisi.earned + herSeferOdeme
                
                local kalanTekrar = timer.RepsLeft(timerAdi)
                
                net.Start("SaticiGoreviniBaslat")
                net.WriteInt(tekrarSayisi - kalanTekrar, 32)
                net.WriteInt(tekrarSayisi, 32)
                net.WriteInt(math.floor(saticiVerisi.earned), 32)
                net.WriteInt(toplamMiktar, 32)
                net.WriteVector(hedefKonum)
                net.Send(ply)
                
                if kalanTekrar == 0 then
                    aktifSaticilar[steamID] = nil
                    
                    net.Start("SaticiGoreviTamamlandi")
                    net.WriteInt(toplamMiktar, 32)
                    net.Send(ply)
                    
                    ply:ChatPrint("[ Venom RolePlay ] Satış tamamlandı! " .. toplamMiktar .. " para kazandın!")
                    DarkRP.notify(ply, 0, 10, "Satış başarılı "..toplamMiktar.." para kazandın!")
                end
            end)
            
            ply:ChatPrint("[ Venom RolePlay ] Satış başladı! " .. tekrarSayisi .. " saniye boyunca bölgede kal.")
            DarkRP.notify(ply, 0, 10, "Satış başladı! "..tekrarSayisi.." saniye boyunca bölgede kal.")
        else
            ply:ChatPrint("[ Venom RolePlay ] Belirtilen konumda değilsin!")
            DarkRP.notify(ply, 1, 10, "Belirtilen konumda değilsin.")
        end
    end)
    
    hook.Add("PlayerDisconnected", "SaticiGorevleriniTemizle", function(ply)
        local steamID = ply:SteamID()
        
        if aktifSaticilar[steamID] then
            timer.Remove("SaticiGorev_" .. steamID)
            aktifSaticilar[steamID] = nil
        end
    end)
end

if CLIENT then
    local hedefKonum = nil
    local satisKonumu = nil
    local saticiAktif = false
    local saticiYaricap = Config.sellerRadius
    local tamamlananIslem = 0
    local toplamIslem = 0
    local kazanilanPara = 0
    local toplamPara = 0
    
    surface.CreateFont("Venom_Comfortaa_Large", {
        font = "Comfortaa",
        size = 24,
        weight = 700,
        extended = true,
        antialias = true
    })
    
    surface.CreateFont("Venom_Comfortaa_Medium", {
        font = "Comfortaa",
        size = 20,
        weight = 500,
        extended = true,
        antialias = true
    })
    
    surface.CreateFont("Venom_Comfortaa_Small", {
        font = "Comfortaa",
        size = 16,
        weight = 400,
        extended = true,
        antialias = true
    })
    
    local function CizDaireYere(pozisyon, yaricap, renk)
        local segments = 32
        local radius = yaricap
        
        render.SetColorMaterial()
        
        local prevX, prevY = math.cos(0) * radius, math.sin(0) * radius
        
        for i = 0, segments do
            local angle = math.rad((i / segments) * -360)
            local x = math.cos(angle) * radius
            local y = math.sin(angle) * radius
            
            render.DrawLine(pozisyon + Vector(prevX, prevY, 2), pozisyon + Vector(x, y, 2), renk, true)
            
            prevX, prevY = x, y
        end

        render.DrawQuadEasy(pozisyon + Vector(0, 0, 1), Vector(0, 0, 1), radius*2, radius*2, renk, 0)
    end
    
    net.Receive("SaticiMenusuAc", function()
        local miktar = net.ReadInt(32)
        local bonusMiktar = net.ReadInt(32)
        
        local cerceve = vgui.Create("DFrame")
        cerceve:SetSize(450, 250)
        cerceve:Center()
        cerceve:SetTitle("")
        cerceve:SetDraggable(true)
        cerceve:ShowCloseButton(false)
        cerceve:MakePopup()
        
        cerceve.Paint = function(self, w, h)
            draw.RoundedBox(6, 0, 0, w, h, Config.colors.background)
            draw.RoundedBox(6, 0, 0, w, 40, Config.colors.primary)
            
            draw.SimpleText("VENOM ROLEPLAY - SATIŞ SİSTEMİ", "Venom_Comfortaa_Large", w/2, 20, Config.colors.text, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)
            
            draw.RoundedBox(4, 20, 60, w-40, 2, Config.colors.primary)
            
            draw.SimpleText("Satış yöntemini seçin:", "Venom_Comfortaa_Medium", w/2, 80, Config.colors.text, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)
        end
        /*


        local kapat = vgui.Create("DButton", cerceve)
        kapat:SetSize(30, 30)
        kapat:SetPos(cerceve:GetWide() - 40, 5)
        kapat:SetText("")
        kapat.Paint = function(self, w, h)
            draw.RoundedBox(4, 0, 0, w, h, Color(231, 76, 60, 200))
            draw.SimpleText("X", "Venom_Comfortaa_Medium", w/2, h/2, Config.colors.text, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)
        end
        kapat.DoClick = function()
            cerceve:Close()
        end
        */
        local secim1 = vgui.Create("DButton", cerceve)
        secim1:SetPos(25, 110)
        secim1:SetSize(400, 50)
        secim1:SetText("")
        secim1.Paint = function(self, w, h)
            local renk = self:IsHovered() and Color(46, 204, 113) or Config.colors.primary
            draw.RoundedBox(4, 0, 0, w, h, renk)
            
            draw.SimpleText("DİREKT SAT", "Venom_Comfortaa_Medium", 20, h/2, Config.colors.text, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER)
            draw.SimpleText(miktar .. " PARA", "Venom_Comfortaa_Medium", w-20, h/2, Config.colors.text, TEXT_ALIGN_RIGHT, TEXT_ALIGN_CENTER)
        end
        secim1.DoClick = function()
            net.Start("SaticiMenusuAc")
            net.WriteInt(1, 8)
            net.WriteInt(miktar, 32)
            net.SendToServer()
            cerceve:Close()
        end
        
        local secim2 = vgui.Create("DButton", cerceve)
        secim2:SetPos(25, 175)
        secim2:SetSize(400, 50)
        secim2:SetText("")
        secim2.Paint = function(self, w, h)
            local renk = self:IsHovered() and Color(46, 204, 113) or Config.colors.primary
            draw.RoundedBox(4, 0, 0, w, h, renk)
            
            draw.SimpleText("SATICI OLARAK SAT", "Venom_Comfortaa_Medium", 20, h/2, Config.colors.text, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER)
            draw.SimpleText(bonusMiktar .. " PARA", "Venom_Comfortaa_Medium", w-20, h/2, Config.colors.text, TEXT_ALIGN_RIGHT, TEXT_ALIGN_CENTER)
            
            draw.SimpleText("BONUS: +" .. (bonusMiktar - miktar), "Venom_Comfortaa_Small", w/2, h+15, Config.colors.secondary, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)
        end
        secim2.DoClick = function()
            net.Start("SaticiMenusuAc")
            net.WriteInt(2, 8)
            net.WriteInt(miktar, 32)
            net.SendToServer()
            cerceve:Close()
        end
    end)
    
    net.Receive("SaticiYolGoster", function()
        hedefKonum = net.ReadVector()
        local bonusMiktar = net.ReadInt(32)
        toplamPara = bonusMiktar
        
        notification.AddLegacy("Venom RolePlay - İşaretlenen konuma git ve satışa başla!", NOTIFY_HINT, 10)
        surface.PlaySound("buttons/button15.wav")
    end)
    
    net.Receive("SaticiGoreviniBaslat", function()
        tamamlananIslem = net.ReadInt(32)
        toplamIslem = net.ReadInt(32)
        kazanilanPara = net.ReadInt(32)
        toplamPara = net.ReadInt(32)
        satisKonumu = net.ReadVector()
        saticiAktif = true
    end)
    
    hook.Add("Think", "SaticiKonumKontrol", function()
        if hedefKonum then
            local mesafe = LocalPlayer():GetPos():Distance(hedefKonum)
            
            if mesafe <= 150 and not saticiAktif then
                net.Start("SaticiGoreviniBaslat")
                net.SendToServer()
                hedefKonum = nil
            end
        end
    end)
    
    net.Receive("SaticiGoreviniIptalEt", function()
        saticiAktif = false
        satisKonumu = nil
        tamamlananIslem = 0
        toplamIslem = 0
        kazanilanPara = 0
        toplamPara = 0
        
        notification.AddLegacy("Satış iptal edildi! Satış bölgesinden ayrıldın.", NOTIFY_ERROR, 15)
        surface.PlaySound("buttons/button10.wav")
    end)
    
    net.Receive("SaticiGoreviTamamlandi", function()
        local toplamMiktar = net.ReadInt(32)
        saticiAktif = false
        satisKonumu = nil
        tamamlananIslem = 0
        toplamIslem = 0
        kazanilanPara = 0
        toplamPara = 0
        
        notification.AddLegacy("Satış tamamlandı! " .. toplamMiktar .. " para kazandın!", NOTIFY_GENERIC, 15)
        surface.PlaySound("buttons/button15.wav")
    end)
    
    hook.Add("HUDPaint", "SaticiHedefGoster", function()
        if hedefKonum then
            local ekranPozisyon = hedefKonum:ToScreen()
            
            draw.RoundedBox(8, ekranPozisyon.x - 60, ekranPozisyon.y - 50, 120, 100, Config.colors.background)
            draw.RoundedBox(8, ekranPozisyon.x - 10, ekranPozisyon.y - 10, 20, 20, Config.colors.secondary)
            
            draw.SimpleText("SATIŞ NOKTASI", "Venom_Comfortaa_Medium", ekranPozisyon.x, ekranPozisyon.y - 30, Config.colors.secondary, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)
            
            local mesafe = math.floor(LocalPlayer():GetPos():Distance(hedefKonum))
            draw.SimpleText(mesafe .. " BİRİM", "Venom_Comfortaa_Small", ekranPozisyon.x, ekranPozisyon.y + 30, Config.colors.text, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)
        end
        
        if saticiAktif and satisKonumu then
            local cemberRenk = Color(46, 204, 113, 100)
            local icerdeMi = true
            
            if LocalPlayer():GetPos():Distance(satisKonumu) > saticiYaricap then
                cemberRenk = Color(231, 76, 60, 100)
                icerdeMi = false
            end
            
            local panelWidth = 350
            local panelHeight = 160
            local panelX = (ScrW() - panelWidth) / 2
            local panelY = 80
            
            draw.RoundedBox(8, panelX, panelY, panelWidth, panelHeight, Config.colors.background)
            draw.RoundedBox(8, panelX, panelY, panelWidth, 40, Config.colors.primary)
            
            draw.SimpleText("SATIŞ DURUMU", "Venom_Comfortaa_Medium", panelX + panelWidth/2, panelY + 20, Config.colors.text, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)
            
            local durum = icerdeMi and "SATIŞ DEVAM EDİYOR" or "BÖLGEDEN ÇIKTIN!"
            local durumRenk = icerdeMi and Config.colors.success or Config.colors.warning
            
            draw.SimpleText(durum, "Venom_Comfortaa_Medium", panelX + panelWidth/2, panelY + 60, durumRenk, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)
            
            draw.SimpleText("İŞLEM DURUMU:", "Venom_Comfortaa_Small", panelX + 20, panelY + 90, Config.colors.text, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER)
            
            local progressWidth = panelWidth - 40
            draw.RoundedBox(4, panelX + 20, panelY + 105, progressWidth, 15, Config.colors.progressBarBg)
            draw.RoundedBox(4, panelX + 20, panelY + 105, (tamamlananIslem / toplamIslem) * progressWidth, 15, Config.colors.progressBar)
            
            draw.SimpleText(tamamlananIslem .. "/" .. toplamIslem, "Venom_Comfortaa_Small", panelX + panelWidth/2, panelY + 105, Config.colors.text, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)
            
            draw.SimpleText("KAZANÇ:", "Venom_Comfortaa_Small", panelX + 20, panelY + 130, Config.colors.text, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER)
            draw.SimpleText(math.floor(kazanilanPara) .. "/" .. toplamPara, "Venom_Comfortaa_Medium", panelX + panelWidth - 20, panelY + 130, Config.colors.secondary, TEXT_ALIGN_RIGHT, TEXT_ALIGN_CENTER)
        end
    end)
    
    hook.Add("PostDrawTranslucentRenderables", "SaticiYerDairesiCiz", function()
        if saticiAktif and satisKonumu then
            local cemberRenk = LocalPlayer():GetPos():Distance(satisKonumu) > saticiYaricap 
                and Color(231, 76, 60, 30) 
                or Color(46, 204, 113, 30)
            
            local cemberKenarRenk = LocalPlayer():GetPos():Distance(satisKonumu) > saticiYaricap 
                and Color(231, 76, 60, 100) 
                or Color(46, 204, 113, 100)
            
            CizDaireYere(satisKonumu, saticiYaricap, cemberRenk)
            
            render.DrawWireframeSphere(satisKonumu, saticiYaricap, 20, 20, cemberKenarRenk, true)
        end
    end)

    
end
--lua/autorun/aovicki.lua:
return gluapack()()
--lua/autorun/aovicki.lua:
player_manager.AddValidModel( "Arkham Origins Vicki Vale", "models/player/bobert/AOVicki.mdl" )  
list.Set( "PlayerOptionsModel",  "Arkham Origins Vicki Vale", "models/player/bobert/AOVicki.mdl" )

--addons/aphone/lua/aphone/languages/turkish.lua:
return gluapack()()
--addons/aphone/lua/aphone/_libs/__header/cl_loadapps.lua:
function aphone.RegisterApp(app)
    if !app or !app.name or !app.icon then
        print("[APhone] Tried to register a app with missing params")
        return
    end

    if type(app.icon) != "Material" then
        app.icon = Material(app.icon, "smooth 1")
    end

    aphone.RegisteredApps[app.name] = app
end
--addons/aphone/lua/aphone/_libs/_utilities/cl_fonts.lua:
local fonts = {
    ["Roboto18_500"] = {
        font = "Roboto",
        size = 18,
        weight = 500,
        antialias = true
    },
    ["Little"] = {
        font = "Roboto",
        size = 20,
        weight = 1000,
        antialias = true
    },
    ["Little2"] = {
        font = "Roboto",
        size = 20,
        weight = 800,
        antialias = true
    },
    ["Small"] = {
        font = "Roboto",
        size = 25,
        weight = 500,
        antialias = true
    },

    ["Little_NoWeight"] = {
        font = "Roboto",
        size = 20,
        antialias = true
    },

    ["Medium"] = {
        font = "ebrima",
        size = 30,
        antialias = true,
        weight = 550
    },
    ["MediumHeader"] = {
        font = "Roboto",
        size = 30,
        antialias = true
    },

    ["MediumHeader_500"] = {
        font = "Roboto",
        size = 30,
        weight = 550,
        antialias = true
    },

    ["Header_Friends"] = {
        font = "Volaroid Script",
        size = 100,
        weight = 800,
        antialias = true
    },

    ["StartScreen"] = {
        font = "Strasua",
        size = 80,
        antialias = true
    },

    ["Roboto40"] = {
        font = "Roboto",
        size = 40,
        antialias = true
    },

    ["Roboto40_700"] = {
        font = "Roboto",
        size = 40,
        antialias = true,
        weight = 700
    },

    ["Roboto45_700"] = {
        font = "Roboto",
        size = 45,
        antialias = true,
        weight = 700
    },

    ["Roboto60"] = {
        font = "Roboto",
        size = 60,
        antialias = true,
        weight = 550
    },

    ["Roboto80"] = {
        font = "Roboto",
        size = 80,
        antialias = true,
        weight = 550
    },

    ["DateShow_200"] = {
        font = "Arial",
        size = 200,
        antialias = true
    },
    -- SVG
    ["SVG_16"] = {
        font = "Akulla_SVG",
        size = 16,
        antialias = true
    },

    ["SVG_20"] = {
        font = "Akulla_SVG",
        size = 20,
        antialias = true
    },

    ["SVG_25"] = {
        font = "Akulla_SVG",
        size = 25,
        antialias = true
    },

    ["SVG_30"] = {
        font = "Akulla_SVG",
        size = 30,
        antialias = true
    },

    ["SVG_40"] = {
        font = "Akulla_SVG",
        size = 40,
        antialias = true
    },

    ["SVG_45"] = {
        font = "Akulla_SVG",
        size = 45,
        antialias = true
    },

    ["SVG_60"] = {
        font = "Akulla_SVG",
        size = 60,
        antialias = true
    },

    ["SVG_76"] = {
        font = "Akulla_SVG",
        size = 76,
        antialias = true
    },

    ["SVG_90"] = {
        font = "Akulla_SVG",
        size = 90,
        antialias = true
    },

    ["SVG_180"] = {
        font = "Akulla_SVG",
        size = 180,
        antialias = true
    },
    -- Darkweb
    ["BigDarkweb"] = {
        font = "Rockwell",
        size = 60,
        antialias = true
    },

    ["HeaderDarkWeb"] = {
        font = "Rockwell",
        size = 30,
        antialias = true
    },

    ["LittleDarkWeb"] = {
        font = "Rockwell",
        size = 20,
        antialias = true
    }
}

local backup_setting = aphone:GetParameters("Core", "2D", false)

local function create_fonts()
    for _, tags in ipairs({"3D", "2D"}) do
        -- Doing this check so the scaledsize got the good 3D/2D state and not return 2D size for 3D or 3D size for 2D
        aphone:ChangeParameters("Core", "2D", tags ~= "3D")

        for k, v in pairs(fonts) do
            local cp = table.Copy(v)
            cp.size = math.floor(aphone.GUI.ScaledSize(cp.size))

            if cp.weight then
                cp.weight = math.floor(aphone.GUI.ScaledSize(cp.weight))
            end

            surface.CreateFont(k .. "_" .. tags, cp)
        end
    end

    aphone:ChangeParameters("Core", "2D", backup_setting)
end

create_fonts()

function aphone:GetFont(name)
    return name .. "_" .. (aphone:Is2D() and "2D" or "3D")
end

hook.Add("OnScreenSizeChanged", "APhone_RefreshFonts", function()
    create_fonts()
end)
--addons/aphone/lua/aphone/_libs/_utilities/cl_stencils.lua:
aphone.Stencils = aphone.Stencils or {}
local stencil_writemask = render.SetStencilWriteMask
local stencil_testmask = render.SetStencilTestMask
local stencil_id = render.SetStencilReferenceValue
local stencil_fail = render.SetStencilFailOperation
local stencil_zfail = render.SetStencilZFailOperation
local stencil_compare = render.SetStencilCompareFunction
local stencil_pass = render.SetStencilPassOperation

function aphone.Stencils.Start()
    -- Reset
    stencil_writemask(0xFF)
    stencil_testmask(0xFF)
    stencil_fail(STENCIL_KEEP)
    stencil_zfail(STENCIL_KEEP)
    stencil_id(1)
    -- Stencil
    stencil_compare(STENCIL_EQUAL)
    stencil_pass(STENCIL_INCRSAT)
end

function aphone.Stencils.AfterMask(ext)
    stencil_id(2)
    stencil_pass(STENCIL_DECRSAT)
    stencil_compare(ext and STENCIL_LESS or STENCIL_EQUAL)
end

function aphone.Stencils.End()
    stencil_id(1)
    stencil_pass(STENCIL_REPLACE)
end
--addons/aphone/lua/aphone/_libs/_utilities/sh_lib.lua:
-- The main purpose of this function is to put cd on net
-- However, I put this in shared because you can use it to make cooldown easier clientside
function aphone.NetCD(ply, name, cd)
    if IsValid(ply) then
        name = "aphone_" .. name
        ply[name] = ply[name] or 0

        if ply[name] + cd < CurTime() then
            ply[name] = CurTime()

            return true
        end
    end
end

function aphone.FormatTimeStamp(time2, time1)
    local time = os.time() - tonumber(time2)

    if time != os.time() then
        if time < 60 then
            time = math.floor(time) .. "s"
        elseif time < 3600 then
            time = math.floor(time / 60) .. "m"
        elseif time < 86400 then
            time = math.floor(time / 3600) .. "h"
        else
            time = os.date("%d/%m/%y", time2)
        end
    else
        time = ""
    end

    return time
end

local p = FindMetaTable("Player")

-- Get digits
local digits = #string.Split(aphone.Format, "%s") - 1
-- 2, because if we loop at 2, the max we can get is 100, and if the server got 128 players, the while won't stop l.86
if digits <= 2 then
    digits = 8
    print("[APhone] Issue with the number format, trying to set to 8 digits")
end

aphone.digitscount = digits

--
function p:aphone_GetID()
    return self.aphone_ID or 0
end

function aphone.GetNumber(id)
    local str = string.Split(tostring(math.floor(util.SharedRandom("APhone", 0, 10^digits-1, id))), "")
    local n = string.Split(tostring(aphone.Format), "%s")

    while (#str < #n - 1) do
        table.insert(str, 1, 0)
    end

    return string.format(aphone.Format, unpack(str))
end

function aphone.FormatNumber(number)
    local str = string.Split(tostring(number), "")
    local n = string.Split(tostring(aphone.Format), "%s")

    while (#str < #n - 1) do
        table.insert(str, 1, 0)
    end

    return string.format(aphone.Format, unpack(str))
end

function p:aphone_GetNumber()
    if !self.aphone_number then
        return "Loading Player..."
    end

    local str = string.Split(tostring(self.aphone_number), "")
    local n = string.Split(tostring(aphone.Format), "%s")

    while (#str < #n - 1) do
        table.insert(str, 1, 0)
    end

    return string.format(aphone.Format, unpack(str))
end
--addons/aphone/lua/aphone/_libs/banks/sh_bluesatm.lua:
hook.Add("PostGamemodeLoaded", "Aphone_BluesATM", function()
    if BATM then
        if !CBLib then
            print("[APhone] Trying to load BATM without CBLib, reinstall BATM please")
            return
        end

        local Accounts = CBLib.LoadModule("batm/bm_accounts.lua", false)
        local p = FindMetaTable("Player")

        if aphone.Bank then
            print("[APhone] Do you got multiples bank addons ? The last loaded bank will be used for the bank app")
        end

        aphone.Bank = aphone.Bank or {}

        aphone.Bank.clr = Color(52, 152, 219)
        aphone.Bank.logo = Material("akulla/aphone/atm.png", "smooth 1")

        function p:aphone_bankWithdraw(amt)
            if amt < 0 then return end
            local ply = self

            Accounts.GetCachedPersonalAccount(self:SteamID64(), function(account)
                --Check if they have enough
                if account.balance - amt >= 0 then
                    account:AddBalance(-amt, "Withdrawal from account owner.")
                    aphone.Gamemode.AddMoney(ply, amt)
                    account:SaveAccount()
                    BATM.NetworkAccount(ply, account)
                end
            end)
        end

        function p:aphone_bankDeposit(amt)
            local ply = self
            if amt < 0 or aphone.Gamemode.GetMoney(ply) < amt then return end

            Accounts.GetCachedPersonalAccount(ply:SteamID64(), function(account)
                account:AddBalance(amt, "APhone")
                aphone.Gamemode.AddMoney(ply, -amt)

                account:SaveAccount()
                BATM.NetworkAccount(ply, account)
            end)
        end

        function p:aphone_bankTransfer(target, amt)
            if amt < 0 then return end

            local ply = self

            Accounts.GetCachedPersonalAccount(ply:SteamID64(), function(account)
                if account:GetBalance() - amt >= 0 then
                    Accounts.GetCachedPersonalAccount(target, function(targetAccount, didExist)
                        if !IsValid(ply) then return end --Dont do anything as that player has left now
                        if didExist and account:GetBalance() - amount >= 0 then
                            --Take money
                            account:AddBalance(-amount, "Transfer to '"..target.."'")
                            account:SaveAccount()

                            --Add money
                            targetAccount:AddBalance(amount, "Transfer from '"..ply:SteamID64().."'")
                            targetAccount:SaveAccount()	
    
                            --Update display
                            BATM.NetworkAccount(ply, account)

                            ply.batmtransfercooldown = CurTime() + 1.5

                            --If the player is online who he transfered to, then go ahead and network it to them too
                            if player.GetBySteamID64(target) ~= false then
                                BATM.NetworkAccount(player.GetBySteamID64(target) , targetAccount)
                            end
                        end
                    end)
                end
            end)
        end

        function p:aphone_getmoney()
            return BATM.GetPersonalAccount().balance
        end

        function aphone.Bank.FormatMoney(amt)
            return BATM.Lang["$"] .. CBLib.Helper.CommaFormatNumber(amt)
        end
    end
end)
--addons/aphone/lua/aphone/_libs/banks/sh_chatm.lua:
hook.Add("PostGamemodeLoaded", "Aphone_CHATM", function()
    if CH_ATM then
        local p = FindMetaTable("Player")

        if aphone.Bank then
            print("[APhone] Do you got multiples bank addons ? The last loaded bank will be used for the bank app")
        end

        aphone.Bank = aphone.Bank or {}

        aphone.Bank.clr = Color(140, 140, 140)
        aphone.Bank.logo = Material("akulla/aphone/atm.png", "smooth 1")
        aphone.Bank.name = "CH Bank"

        function p:aphone_bankDeposit(amt)
            if amt < 0 or CH_ATM.GetMoney( self ) - amt < 0 then return end
			
			if CH_ATM.GetAccountMaxMoney( self ) != 0 and tonumber( amt + CH_ATM.GetMoneyBankAccount( self ) ) > CH_ATM.GetAccountMaxMoney( self ) then return end
			
            CH_ATM.AddMoneyToBankAccount( self, amt )
            aphone.Gamemode.AddMoney(self, -amt)

            -- Log transaction (only works with SQL enabled)
            CH_ATM.LogSQLTransaction( self, "deposit", amt )
                
            -- bLogs support
            hook.Run( "CH_ATM_bLogs_DepositMoney", self, amt )
        end

        function p:aphone_bankWithdraw(amt)
            if amt < 0 or !aphone.Gamemode.Afford(self, amt) then return end
            aphone.Gamemode.AddMoney(self, amt)
            CH_ATM.TakeMoneyFromBankAccount( self, amt )

            -- Log transaction (only works with SQL enabled)
            CH_ATM.LogSQLTransaction( self, "withdraw", amt )

            -- bLogs support
            hook.Run( "CH_ATM_bLogs_WithdrawMoney", self, amt )
        end

        function p:aphone_bankTransfer(ply2, amt)
            if amt < 0 then return end
            local amtSelfBank = CH_ATM.GetMoney( self )

            if amt > amtSelfBank then return end
            
            CH_ATM.TakeMoneyFromBankAccount( self, amt )
            CH_ATM.AddMoneyToBankAccount( ply2, amt )

            -- Log transaction (only works with SQL enabled)
            CH_ATM.LogSQLTransaction( self, "transfer", amt )
                
            -- bLogs support
            hook.Run( "CH_ATM_bLogs_SendMoney", self, amt, ply2 )
        end

        function p:aphone_getmoney()
            return CH_ATM.GetMoneyBankAccount( self )
        end

        function aphone.Bank.FormatMoney(amt)
            return CH_ATM.FormatMoney(amt)
        end
    end
end)
--addons/aphone/lua/aphone/_libs/gamemodes_related/sh_helix.lua:
return gluapack()()
--addons/aphone/lua/aphone/_libs/gamemodes_related/sh_helix.lua:
// I don't know if i'm dumb, but I didn't found any hooks post load
hook.Add("PostGamemodeLoaded", "APhone_GR_Helix", function()
    if ix then
        aphone.Gamemode = {}

        function aphone.Gamemode.Afford(ply, amt)
            return ply:GetCharacter():GetMoney() > amt
        end

        function aphone.Gamemode.AddMoney(ply, amt)
            local c = ply:GetCharacter()

            local money = c:GetMoney()
            if money + amt < 0 then return false end

            c:SetMoney(c:GetMoney() + amt)
            return true
        end

        function aphone.Gamemode.Format(amt)
            return ix.currency.Get(amt)
        end

        function aphone.Gamemode.GetMoney(ply)
            return ply:GetCharacter():GetMoney()
        end
    end
end)

--addons/aphone/lua/aphone/_libs/panels/cl_call.lua:
local PANEL = {}

local green = Color(46, 204, 113)
local stencil_writemask = render.SetStencilWriteMask
local stencil_testmask = render.SetStencilTestMask
local stencil_id = render.SetStencilReferenceValue
local stencil_fail = render.SetStencilFailOperation
local stencil_zfail = render.SetStencilZFailOperation
local stencil_compare = render.SetStencilCompareFunction
local stencil_pass = render.SetStencilPassOperation

function PANEL:Init()
    local font_svg45 = aphone:GetFont("SVG_45")

    local clr_white = aphone:Color("Text_White")
    local clr_white120 = aphone:Color("Text_White120")
    local clr_white60 = aphone:Color("Text_White60")
    local clr_transparent = Color(1, 1, 1, 1)

    local main_x, main_y = self:GetParent():GetSize()

    if main_x > main_y then
        aphone.RequestAnim(1)
        self:Remove()
        return
    end

    self:SetSize(main_x, main_y)
    self.last_dring = 0

    self:GetParent():SetMouseInputEnabled(false)
    self:SetMouseInputEnabled(true)

    if aphone.Call.Infos.target then
        self.backgroundavatar = vgui.Create("AvatarImage", self)
        self.backgroundavatar:SetSize(main_y, main_y)
        self.backgroundavatar:SetPos(main_x/2 - main_y/2, 0)
        self.backgroundavatar:SetPlayer(aphone.Call.Infos.target, 184)
        self.backgroundavatar:SetPaintedManually(true)
    end

    local circle
    local avatar_outline = vgui.Create("DPanel", self)
    avatar_outline:SetSize(main_x*0.8, main_x*0.8)
    avatar_outline:SetPos(main_x*0.4, -main_x*0.1)
    avatar_outline:SetMouseInputEnabled(false)
    avatar_outline.colorbg = green

    function avatar_outline:Paint(w, h)
        if !circle then
            circle = aphone.GUI.GenerateCircle(w / 2, h / 2, w / 2)
        end

        if !aphone.Call.Infos then return end
        draw.NoTexture()

        if aphone.Call.Infos.target then
            surface.SetDrawColor(self.colorbg or green)
            surface.DrawPoly(circle)
        else
            render.ClearStencil()
            render.SetStencilEnable(true)
            stencil_writemask( 0xFF )
            stencil_testmask( 0xFF )
            stencil_fail( STENCIL_KEEP )
            stencil_zfail( STENCIL_KEEP )
            stencil_id( 1 )

            // Stencil
            stencil_compare(STENCIL_ALWAYS)
            stencil_pass(STENCIL_REPLACE)
                draw.NoTexture()
                surface.SetDrawColor(clr_transparent)
                surface.DrawPoly(circle)
            stencil_id(1)
            stencil_pass(STENCIL_KEEP)
            stencil_compare(STENCIL_EQUAL)
                surface.SetMaterial(aphone.SpecialNumbers[aphone.SpecialCalls[aphone.Call.Infos.special_id].name].icon)
                surface.SetDrawColor(color_white)
                surface.DrawTexturedRect(0, 0, w, h)
            render.SetStencilEnable(false)
        end
    end

    if aphone.Call.Infos.target then
        local player_avatar = vgui.Create("aphone_CircleAvatar", avatar_outline)
        player_avatar:Dock(FILL)
        player_avatar:DockMargin(aphone.GUI.ScaledSize(7, 7, 7, 7))
        player_avatar.ignorestencil = true
        player_avatar:SetPlayer(aphone.Call.Infos.target, 184)
    end
    self.avatar_outline = avatar_outline

    local player_calling = vgui.Create("DLabel", self)
    player_calling:Dock(TOP)
    player_calling:SetFont(aphone:GetFont("MediumHeader"))
    player_calling:SetText("")
    player_calling:SetContentAlignment(4)
    player_calling:DockMargin(main_x*0.08, main_y*0.45, 0, 0)
    player_calling:SetTextColor(aphone:Color("Text_White180"))
    player_calling:SetMouseInputEnabled(true)

    function player_calling:Think()
        if aphone.Call.Infos and aphone.Call.Infos.pending and aphone.Call.Infos.is_caller then
            player_calling:SetText(aphone.L("Calling") .. string.rep( ".", CurTime() % 3 ))
        else
            player_calling:SetText("")
            player_calling.Think = nil
        end
    end
    self.player_calling = player_calling

    surface.SetFont(player_calling:GetFont())
    player_calling:SetTall(select(2, surface.GetTextSize(player_calling:GetText())))

    surface.SetFont(aphone:GetFont("Roboto40"))

    local player_num = vgui.Create("DLabel", self)
    player_num:Dock(TOP)

    player_num:SetText(aphone.Call.Infos.target and aphone.Call.Infos.target:aphone_GetNumber() or "")
    player_num:SetFont(aphone:GetFont("Roboto40"))
    player_num:SetContentAlignment(4)
    player_num:DockMargin(main_x*0.08, 0, 0, 0)
    player_num:SetTextColor(clr_white60)
    self.player_num = player_num

    surface.SetFont(player_num:GetFont())
    player_num:SetTall(select(2, surface.GetTextSize(player_num:GetText())))

    local player_name = vgui.Create("DLabel", self)
    player_name:Dock(TOP)
    player_name:SetFont(aphone:GetFont("Roboto60"))
    player_name:SetContentAlignment(4)
    player_name:DockMargin(main_x*0.08, 0, 0, 0)
    player_name:SetTextColor(clr_white)
    self.player_name = player_name

    if IsValid(aphone.Call.Infos.target) then
        local n = aphone.GetName(aphone.Call.Infos.target)
        if n == aphone.Call.Infos.target:aphone_GetNumber() then 
            // Unknown
            player_name:SetText(player_num:GetText())
            player_num:SetText("")
        else
            player_name:SetText(n)
        end
    elseif aphone.Call.Infos.is_caller then
        player_name:SetText(aphone.SpecialCalls[aphone.Call.Infos.special_id].name)
    else
        player_name:SetText("Unknown")
    end

    surface.SetFont(player_name:GetFont())
    player_name:SetTall(select(2, surface.GetTextSize(player_name:GetText())))

    local buttons = vgui.Create("DPanel", self)
    buttons:Dock(BOTTOM)
    buttons:DockMargin(0, 0, 0, main_y * 0.1)
    buttons:SetTall(main_y * 0.1)
    buttons:SetPaintBackground(false)

    local ref = vgui.Create("DButton", buttons)
    ref:SetPos(((aphone.Call.Infos.pending and !aphone.Call.Infos.is_caller) and main_x * 0.25 or main_x * 0.50) - buttons:GetTall() / 2, 0)
    ref:SetSize(buttons:GetTall(), buttons:GetTall())
    ref:SetText("")
    ref:TDLib()
    ref:ClearPaint()
    ref:Circle(aphone:Color("Black3"))
    ref:CircleFadeHover(aphone:Color("mat_red"))

    ref:On("PaintOver", function(self, w, h)
        draw.SimpleText("4", font_svg45, w / 2, h / 2, clr_white, 1, 1)
    end)

    ref:On("DoClick", function()
        net.Start("aphone_Phone")
            net.WriteUInt(3, 4)
        net.SendToServer()
    end)
    self.button_refuse = ref

    if aphone.Call.Infos.pending and !aphone.Call.Infos.is_caller then
        self.button_accept = vgui.Create("DButton", buttons)
        self.button_accept:SetPos(main_x * 0.75 - buttons:GetTall() / 2, 0)
        self.button_accept:SetSize(buttons:GetTall(), buttons:GetTall())
        self.button_accept:SetText("")
        self.button_accept:TDLib()
        self.button_accept:ClearPaint()
        self.button_accept:Circle(aphone:Color("Black3"))
        self.button_accept:CircleFadeHover(green)

        function self.button_accept:PaintOver(w, h)
            draw.SimpleText("o", aphone:GetFont("SVG_40"), w / 2, h / 2, clr_white, 1, 1)
        end

        function self.button_accept:DoClick()
            net.Start("aphone_Phone")
                net.WriteUInt(2, 4)
            net.SendToServer()
        end

        self.button_accept:aphone_RemoveCursor()
    end

    surface.SetFont(aphone:GetFont("SVG_76"))
    local fc_x, fc_y = surface.GetTextSize("E")

    local fc = vgui.Create("DButton", self)
    fc:SetPos(main_x * 0.1, main_x * 0.1)
    fc:SetSize(main_x * 0.1, main_x * 0.1)
    fc:SetFont(aphone:GetFont("SVG_40"))
    fc:SetText("E")
    fc:SetPaintBackground(false)
    fc:SetEnabled(!aphone.Call.Infos.pending)
    fc:SetAlpha(!aphone.Call.Infos.pending and 255 or 0)
    fc:SetTextColor(aphone.Call.Infos.facetime and clr_white or clr_white120)

    function fc:DoClick()
        aphone.Call.Infos.facetime = !aphone.Call.Infos.facetime
        self:SetTextColor(aphone.Call.Infos.facetime and clr_white or clr_white120)

        net.Start("aphone_Phone")
            net.WriteUInt(4, 4)
        net.SendToServer()
    end

    local msg = vgui.Create("DButton", self)
    msg:SetPos(main_x * 0.1, main_x * 0.2)
    msg:SetSize(main_x * 0.1, main_x * 0.1)
    msg:SetFont(aphone:GetFont("SVG_40"))
    msg:SetText("n")
    msg:SetPaintBackground(false)
    msg:SetEnabled(!aphone.Call.Infos.pending)
    msg:SetAlpha(!aphone.Call.Infos.pending and 255 or 0)
    msg:Phone_AlphaHover()

    function msg:DoClick()
        local msg_pnl = vgui.Create("aphone_Msg", self:GetParent())
        msg_pnl:InitPly(aphone.Call.Infos.target)
    end

    self.msg = msg
    self.fc = fc

    aphone.Call.Panel = self
    self:aphone_RemoveCursor()
end

function PANEL:Accepted()
    if IsValid(self.button_accept) then
        self.button_accept:Remove()
        self.button_refuse:MoveTo(self:GetWide() * 0.5 - self.button_refuse:GetParent():GetTall() / 2, 0, 0.5, 0, 0.5)
    end

    self.fc:SetEnabled(true)
    self.fc:SetAlpha(0)
    self.fc:AlphaTo(255, 0.5, 0)

    self.msg:SetEnabled(true)
    self.msg:SetAlpha(0)
    self.msg:AlphaTo(255, 0.5, 0)
end

function PANEL:OnRemove()
    self:GetParent():SetMouseInputEnabled(true)
    self:SetMouseInputEnabled(false)
    aphone.RenderView_End("phoneCamSelf")
    aphone.RenderView_End("phoneCam")
end

function PANEL:Paint(w, h)
    surface.SetDrawColor(color_white)
    surface.SetMaterial(aphone.GUI.GetBackground())
    surface.DrawTexturedRect(0, 0, w, h)

    if self.backgroundavatar then
        self.backgroundavatar:PaintManual()
    end

    aphone.blur_rt(8 * (h/w), 8, 2)

    if aphone.Call.Infos.target_facetime and IsValid(aphone.Call.Infos.target) then
        // Better use power of 2 numbers for RenderTarget
        local localply = aphone.Call.Infos.target
        local ang = localply:EyeAngles()
        local pos = localply:EyePos()
        local wep = localply:GetActiveWeapon()
        local is_out = IsValid(wep) and wep:GetClass() == "aphone"

        surface.SetDrawColor(color_black)
        surface.DrawRect(0, 0, w, h)

        if is_out then
            local atta = wep:GetAttachment(1)
            local tr = util.TraceLine({
                start = pos,
                endpos = atta.Pos + atta.Ang:Forward() * 5,
                collisiongroup = COLLISION_GROUP_WORLD,
            })

            if !tr.Hit then
                aphone.RenderView_Start("phoneCam", {
                    origin = tr.HitPos,
                    angles = ang,
                    fov = 90,
                    x = 0, y = 0,
                    w = 1024, h = 1024,
                })

                surface.SetMaterial(aphone.RenderView_RequestTexture("phoneCam"))
                surface.SetDrawColor(color_white)
                surface.DrawTexturedRect(w / 2 - h / 2, 0, h, h)
            end
        end
    else
        aphone.RenderView_End("phoneCam")
    end

    if aphone.Call.Infos.facetime then
        // Better use power of 2 numbers for RenderTarget
        local localply = LocalPlayer()
        local ang = localply:EyeAngles()
        local pos = EyePos()

        local tr = util.TraceLine({
            start = EyePos(),
            endpos = pos + ang:Forward() * 10,
            collisiongroup = COLLISION_GROUP_WORLD,
        })

        aphone.RenderView_Start("phoneCamSelf", {
            origin = tr.HitPos,
            angles = ang,
            fov = 90,
            x = 0, y = 0,
            w = 1024, h = 1024,
        })

        surface.SetDrawColor(color_white)
        surface.DrawRect(w * 0.1-2, h - w/4 - w*0.1-2, w/4+4, w/4+4)

        surface.SetMaterial(aphone.RenderView_RequestTexture("phoneCamSelf"))
        surface.SetDrawColor(color_white)
        surface.DrawTexturedRect(w * 0.1, h - w/4 - w*0.1, w/4, w/4)
    else
        aphone.RenderView_End("phoneCamSelf")
    end
end

local old_ratio = 0
function PANEL:Think()
    if !aphone.Call.Infos then
        timer.Remove("aphone_DringSound")
        self:Remove()
    elseif self.player_calling:IsVisible() then
        if self.avatar_outline then
            self.avatar_outline:SetVisible(!aphone.Call.Infos.target_facetime)
            local ratio = 0

            if IsValid(aphone.Call.Infos.target) then
                ratio = aphone.Call.Infos.target:VoiceVolume()*2
            end

            if old_ratio > ratio and old_ratio > 0 then
                old_ratio = old_ratio - 0.03
            else
                old_ratio = ratio
            end

            self.avatar_outline.colorbg.r = Lerp(old_ratio, 46, 52)
            self.avatar_outline.colorbg.g = Lerp(old_ratio, 204, 152)
            self.avatar_outline.colorbg.b = Lerp(old_ratio, 113, 219)
        end

        self.player_calling:SetVisible(!aphone.Call.Infos.target_facetime)
        self.player_name:SetVisible(!aphone.Call.Infos.target_facetime)
        self.player_num:SetVisible(!aphone.Call.Infos.target_facetime)
    end
end

vgui.Register("aphone_Call", PANEL)
--addons/aphone/lua/aphone/_libs/panels/cl_messagepanel.lua:
local PANEL = {}

local empty_color = Color(155, 89, 182)
function PANEL:Init(revert)
	self:SetPaintBackground(false)
	self.bgcolor = empty_color
	self.font = aphone:GetFont("MediumHeader")

	local self_pnl = self

	self.avatar_maindock = vgui.Create("DPanel", self)
	self.avatar_maindock:Dock(revert and RIGHT or LEFT)
	self.avatar_maindock:SetWide(aphone.GUI.ScaledSizeX(48))
	self.avatar_maindock:SetPaintBackground(false)

	self.avatar = vgui.Create("aphone_CircleAvatar", self.avatar_maindock)
	self.avatar:Dock(BOTTOM)
	self.avatar:SetTall(self.avatar_maindock:GetWide())
	self.avatar:SetPlayer(LocalPlayer(), 64)
	self.avatar.ignorestencil = true

	self.text_maindock = vgui.Create("DPanel", self)
	self.text_maindock:Dock(FILL)
	self.text_maindock:SetPaintBackground(false)
	self.text_maindock:DockMargin(aphone.GUI.ScaledSize(!revert and 10 or 0, 0, revert and 10 or 0, 0))

	function self.text_maindock:Paint(w, h)
		if !self_pnl.wrapped_text then
			self_pnl.wrapped_text = aphone.GUI.WrapText(self_pnl.text, self_pnl.font, w-32)

			// Font already set by wraptext
			local _, h1_y = surface.GetTextSize(self_pnl.wrapped_text)
			local h2 = IsValid(self_pnl.avatar) and self_pnl.avatar:GetTall() or 0

			h1_y = h1_y + 32

			self_pnl:SetTall(h1_y > h2 and h1_y or h2)
		end
		draw.RoundedBox(16, 0, 0, w, h, self:GetParent().bgcolor)
		draw.DrawText(self_pnl.wrapped_text or "Placeholder", self_pnl.font, 16, 16, color_white, 0)
	end

	self:aphone_RemoveCursor()

	self.revert = revert
end

function PANEL:KillAvatar()
	self.avatar_maindock:Remove()

	if !self.revert then
		self.text_maindock:DockMargin(aphone.GUI.ScaledSizeX(10), 0, aphone.GUI.ScaledSizeX(48), 0)
	else
		self.text_maindock:DockMargin(aphone.GUI.ScaledSizeX(48), 0, aphone.GUI.ScaledSizeX(10), 0)
	end
end

function PANEL:SetText(t)
	self.text = t
	self.wrapped_text = nil
end

function PANEL:SetAvatar(ply, size)
	self.avatar:SetPlayer(ply, size)
end

function PANEL:GetText()
	return self.text
end

function PANEL:SetFont(n)
	self.text:SetFont(n)
	self:RecalculateHeight()
end

function PANEL:SetBackgroundColor(clr)
	self.bgcolor = clr
end

function PANEL:Left_Avatar(b)
	self:Clear()
	self:Init(b)
end

vgui.Register("aphone_Message", PANEL, "DPanel")
--addons/aphone/lua/aphone/apps/calculator/cl_main.lua:
local APP = {}

APP.name = aphone.L("Calculator")
APP.icon = "akulla/aphone/app_calculator.png"

local operator, last_result
local first_num = ""
local second_num = ""

local function Retrieve_NumberOn()
	if !tonumber(first_num) then
		first_num = ""
	end
	return operator and second_num or first_num
end

local function Set_NumberOn(n)
	if operator then
		second_num = n
	else
		first_num = n
	end
end

local function addnumber(num)
	local new_num = tonumber(Retrieve_NumberOn() .. num)

	if new_num > 999999999 or -999999999 > new_num then return end
	Set_NumberOn(tostring(new_num))
end

local function removenumber()
	if !tonumber(Retrieve_NumberOn()) then return end
	Set_NumberOn(string.sub(Retrieve_NumberOn(), 0, -1))
end

local function switch_sign()
	if !tonumber(Retrieve_NumberOn()) then return end
	Set_NumberOn(-tonumber(Retrieve_NumberOn()))
end

local function add_comma()
	Set_NumberOn(Retrieve_NumberOn() .. ".")
end

local function reset()
	first_num = ""
	second_num = ""
	operator = nil
end

local function operation(o)
	if !operator then
		// Check if he really put a number
		if !tonumber(first_num) or o == "=" then return end

		operator = o
	elseif tonumber(second_num) then
		first_num = tonumber(first_num)
		second_num = tonumber(second_num)

		// Switch and +=, -=, /=, *= would fit so well for this
		if operator == "+" then
			first_num = first_num + second_num
		elseif operator == "-" then
			first_num = first_num - second_num
		elseif operator == "*" then
			first_num = first_num * second_num
		elseif operator == "/" then
			// Little easter egg
			first_num = second_num == 0 and "/0 ?" or first_num / second_num
		elseif operator == "%" then
			first_num = first_num % second_num
		end

		// don't break the easter egg 
		last_result = isnumber(first_num) and string.Comma(math.Round(first_num, 4)) or first_num

		reset()
	end
end

local button_table = {
	[1] = {name = "C", func = reset},
	[2] = {name = "+/-", func = switch_sign},
	[3] = {name = "%"},
	[4] = {name = "/"},
	[5] = {name = 7},
	[6] = {name = 8},
	[7] = {name = 9},
	[8] = {name = "*"},
	[9] = {name = 4},
	[10] = {name = 5},
	[11] = {name = 6},
	[12] = {name = "-"},
	[13] = {name = 1},
	[14] = {name = 2},
	[15] = {name = 3},
	[16] = {name = "+"},
	[17] = {name = 0},
	[18] = {name = ".", func = add_comma},
	[19] = { name = "<", func = removenumber },
	[20] = { name = "=" },
}

local mat_bg = Material("akulla/aphone/background_calculator.jpg")
function APP:Open(main, main_x, main_y, screenmode)
	// consts
	local font_big2 = aphone:GetFont("Roboto80")
	local font_header = aphone:GetFont("Roboto40")
	local font_mediumheader = aphone:GetFont("MediumHeader")
	local clr_white180 = aphone:Color("Text_White180")
	local clr_white = aphone:Color("Text_White")
	local black_120 = Color(40, 40, 40, 120)

	local scaledsize_24 = aphone.GUI.ScaledSizeY(24)
	local scaledsize_61 = aphone.GUI.ScaledSizeY(61)

	// adapt to screenmode
	local sub_panely, p_sizey, p_sizex

	local but_lay = vgui.Create("DIconLayout", main)
	but_lay:SetSpaceX(aphone.GUI.ScaledSizeX(5))
	but_lay:SetSpaceY(aphone.GUI.ScaledSizeY(5))

	if !screenmode then
		sub_panely = math.abs(main_x / 4 * 5 - main_y)
		p_sizey = (main_y - sub_panely) / 5 - aphone.GUI.ScaledSizeY(5)
		p_sizex = main_x / 4 - aphone.GUI.ScaledSizeX(5)
		but_lay:Dock(BOTTOM)
		but_lay:DockMargin(0, sub_panely, 0, aphone.GUI.ScaledSizeY(12))
		but_lay:SetTall(sub_panely)
	else
		sub_panely = math.abs(main_y / 5 * 5 - main_x)
		p_sizey = (main_x - sub_panely) / 5 - aphone.GUI.ScaledSizeY(10)
		p_sizex = main_y / 4 - aphone.GUI.ScaledSizeX(5)
		but_lay:Dock(RIGHT)
		but_lay:DockMargin(sub_panely, aphone.GUI.ScaledSize(12, 12, 12))
		but_lay:SetWide(sub_panely)
	end

	for k, v in SortedPairs(button_table) do
		local d = but_lay:Add("DButton")
		d:SetText(v.name)
		d:SetFont(font_header)
		d:SetSize(p_sizex, p_sizey)
		d:SetTextColor(clr_white)
		d:SetPaintBackground(false)
		d:TDLib()

		d:On("DoClick", function(self)
			if v.func then
				v.func()
			elseif isnumber(v.name) then
				addnumber(v.name)
			else
				operation(v.name)
			end
		end)

		d:FadeHover(black_120)
	end

	function main:Paint(w, h)
		surface.SetMaterial(mat_bg)
		surface.SetDrawColor(color_white)
		surface.DrawTexturedRect(0, 0, w, h)

		surface.SetFont(font_big2)

		if !screenmode then
			if last_result then
				draw.DrawText(last_result, select(1, surface.GetTextSize(last_result)) >= main_x * 0.9 and font_mediumheader or font_big2, w / 2, sub_panely / 2 - scaledsize_24, clr_white, 1, 1)
			end
			draw.SimpleText(first_num .. (operator or "") .. second_num, font_header, w / 2, sub_panely / 2 + scaledsize_61, clr_white180, 1, 0)
		else
			local w_final = (w - but_lay:GetWide()) / 2
			if last_result then
				draw.DrawText(last_result, (select(1, surface.GetTextSize(last_result)) >= main_x * 0.9 and font_mediumheader or font_big2), w_final, h / 3, clr_white, 1, 1)
			end
			draw.SimpleText(first_num .. (operator or "") .. second_num, font_header, w_final, h/2 + scaledsize_61, clr_white180, 1, 0)
		end
	end

	if !screenmode then
		main:Phone_DrawTop(main_x, main_y)
	end
	main:aphone_RemoveCursor()
end

function APP:Open2D(main, main_x, main_y)
	self:Open(main, main_x, main_y, true)
end

aphone.RegisterApp(APP)
--addons/aphone/lua/aphone/apps/camera/cl_main.lua:
local APP = {}

APP.name = aphone.L("Camera")
APP.icon = "akulla/aphone/app_camera.png"
APP.Default = true

// Windows don't like folders with ':' in their names
local dir = "aphone/" .. string.Replace(game.GetIPAddress(), ":", "_") .. "/"

local function reset_rt()
    aphone.RenderView_End("camera2_vertical")
    aphone.RenderView_End("camera_vertical")
    aphone.RenderView_End("camera2_horizontal")
    aphone.RenderView_End("camera_horizontal")
end

function APP:Open(main, main_x, main_y, horizontal)
    reset_rt()
    local last_screen = 0
    local zoom = 1
    local smileys = false
    local font_sf40 = aphone:GetFont("Roboto40")
    local font_svg40 = aphone:GetFont("SVG_40")
    local font_svg60 = aphone:GetFont("SVG_60")
    local selfie_mode = false
    local statename = aphone:Is2D() and "2d" or "3d"

    function main:OnMouseWheeled(num)
        zoom = (num > 0 and 2 or 1)
    end

    function main:Paint(w,h)
        local ang = LocalPlayer():EyeAngles()
        local pos = selfie_mode and aphone.WM_Pos or EyePos()

        if selfie_mode then
            // Perfect inverting angle
            ang = (ang:Forward() * -1):Angle()
        end

        local tr

        if selfie_mode then
            tr = util.TraceLine({
                start = EyePos(),
                endpos = pos + ang:Forward() * 10 + ang:Up() * 3,
                collisiongroup = COLLISION_GROUP_WORLD,
            })
        else
            tr = util.TraceLine({
                start = EyePos(),
                endpos = pos + ang:Forward() * ((zoom-1) * 400 + 10),
                collisiongroup = COLLISION_GROUP_WORLD,
            })
        end

        if tr.Hit and zoom != 1 then
            zoom = zoom - 1
            tr.HitPos = pos
        end

        local mat
        local n = "camera" .. (horizontal and "2_" or "_") .. statename

        aphone.RenderView_Start(n, {
            origin = tr.HitPos,
            angles = ang,
            fov = 90,
            x = 0, y = 0,
            w = w, h = h,
            drawviewmodel = selfie_mode,
            Smileys = smileys,
        })
        mat = aphone.RenderView_RequestTexture(n)

        if mat then
            surface.SetDrawColor(color_white)
            surface.SetMaterial(mat)
            surface.DrawTexturedRect(0, 0, w, h)
        end

        draw.SimpleText( zoom .. "x", font_sf40, w * 0.75, h * 0.1, color_white)
    end

    function main:PaintOver(w, h)
        local t = CurTime() - last_screen

        if t < 0.5 then
            surface.SetDrawColor(255, 255, 255, 255 * (1 - t * 2))
            surface.DrawRect(0, 0, w, h)
        end
    end

    local but = vgui.Create("DButton", main)
    but:Dock(BOTTOM)
    but:SetTall(main_x * 0.15)
    but:DockMargin(main_x * 0.425, 0, main_x * 0.425, !horizontal and main_x * 0.1 or 0)
    but:SetText("")

    function but:DoClick()
        local dir_final = dir .. os.date( "%Y-%m-%d-%H-%M-%S" , os.time() )
        aphone.RenderView_RequestScreenshot(horizontal and "camera2_" .. statename or "camera_" .. statename, dir_final, true)
        last_screen = CurTime()
    end

    function but:Paint(w, h)
        self.aphone_amt = self.aphone_amt or 0
        self.aphone_lastcheck = self.aphone_lastcheck or CurTime()

        local dif = (CurTime() - self.aphone_lastcheck) * 4
        self.aphone_amt = math.Clamp(self.aphone_amt + (self.Hovered and dif or -dif), 0, 1)
        self.aphone_lastcheck = CurTime()

        local r = Lerp(self.aphone_amt, 200, 255)
        local gb = Lerp(self.aphone_amt, 200, 100)

        // Circle, with font because it's prettier
        draw.SimpleText("d", font_svg60, w / 2, h / 2, color_white, 1, 1)
        draw.SimpleText("d", font_svg40, w / 2, h / 2, Color(r, gb, gb), 1, 1)
    end

    surface.SetFont(font_svg40)

    local rotate = main:Add("DLabel")
    rotate:SetPos(main_x * 0.75, horizontal and main_y*0.2 or main_y*0.15)
    rotate:SetText("j")
    rotate:SetFont(font_svg40)
    rotate:Phone_AlphaHover()
    rotate:SetSize(surface.GetTextSize("j"))
    rotate:SetMouseInputEnabled(true)

    function rotate:DoClick()
        selfie_mode = !selfie_mode
    end

    if !aphone.disable_smileycamera then
        local smileybut = main:Add("DLabel")
        smileybut:SetPos(main_x * 0.75, (horizontal and main_y*0.2 or main_y*0.15) + rotate:GetTall())
        smileybut:SetText("6")
        smileybut:SetFont(font_svg40)
        smileybut:Phone_AlphaHover()
        smileybut:SetSize(surface.GetTextSize("j"))
        smileybut:SetMouseInputEnabled(true)

        function smileybut:DoClick()
            smileys = !smileys
        end
    end

    main:aphone_RemoveCursor()
end

function APP:Open2D(main, main_x, main_y)
    reset_rt()
    APP:Open(main, main_x, main_y, true)
end

function APP:OnClose()
    reset_rt()
end

aphone.RegisterApp(APP)
--addons/aphone/lua/aphone/apps/messages/cl_messages.lua:
return gluapack()()
--addons/[binbon]arccw_modify/lua/arccw/shared/sh_effects.lua:
game.AddParticles( "particles/muzzleflashes_test.pcf" )
game.AddParticles( "particles/muzzleflashes_test_b.pcf" )
PrecacheParticleSystem( "muzzleflash_smg" )
PrecacheParticleSystem( "muzzleflash_smg_bizon" )
PrecacheParticleSystem( "muzzleflash_shotgun" )
PrecacheParticleSystem( "muzzleflash_slug" )
PrecacheParticleSystem( "muzzleflash_slug_flame" )
PrecacheParticleSystem( "muzzleflash_pistol" )
PrecacheParticleSystem( "muzzleflash_pistol_cleric" )
PrecacheParticleSystem( "muzzleflash_pistol_deagle" )
PrecacheParticleSystem( "muzzleflash_suppressed" )
PrecacheParticleSystem( "muzzleflash_mp5" )
PrecacheParticleSystem( "muzzleflash_MINIMI" )
PrecacheParticleSystem( "muzzleflash_m79" )
PrecacheParticleSystem( "muzzleflash_m14" )
PrecacheParticleSystem( "muzzleflash_ak47" )
PrecacheParticleSystem( "muzzleflash_ak74" )
PrecacheParticleSystem( "muzzleflash_m82" )
PrecacheParticleSystem( "muzzleflash_m3" )
PrecacheParticleSystem( "muzzleflash_famas" )
PrecacheParticleSystem( "muzzleflash_g3" )
PrecacheParticleSystem( "muzzleflash_1" )
PrecacheParticleSystem( "muzzleflash_3" )
PrecacheParticleSystem( "muzzleflash_4" )
PrecacheParticleSystem( "muzzleflash_5" )
PrecacheParticleSystem( "muzzleflash_6" )
--addons/[binbon]arccw_modify/lua/arccw/shared/sh_loadatts.lua:
ArcCW = ArcCW or {}
ArcCW.AttachmentTable = {}
ArcCW.AttachmentIDTable = {}
ArcCW.AttachmentSlotTable = {}
ArcCW.AttachmentBlacklistTable = {}
ArcCW.NumAttachments = 1
ArcCW.GenerateAttEntities = true

ArcCW.AttachmentCachedLists = {}

local shortname = ""
local genAttCvar = ArcCW.ConVars["reloadatts_registerentities"]

function ArcCW.LoadAttachmentType(att, name)
    if name == "" then return end
    name = name or shortname

    if !att.Ignore or ArcCW.ConVars["reloadatts_showignored"]:GetBool() then
        ArcCW.AttachmentTable[name] = att
        ArcCW.AttachmentIDTable[ArcCW.NumAttachments] = name

        att.Blacklisted = false
        att.ShortName = name

        if !ArcCW.AttachmentSlotTable[att.Slot] then
            ArcCW.AttachmentSlotTable[att.Slot] = {}
        end
        table.insert(ArcCW.AttachmentSlotTable[att.Slot], ArcCW.NumAttachments)

        att.ID = ArcCW.NumAttachments

        if genAttCvar:GetBool() and !att.DoNotRegister and !att.InvAtt and !att.Free then
            local attent = {}
            attent.Base = "arccw_att_base"
            if CLIENT and att.Icon then
                attent.IconOverride = string.Replace( att.Icon:GetTexture( "$basetexture" ):GetName() .. ".png", "0001010", "" )
            end
            attent.PrintName = att.PrintName or name
            attent.Spawnable = att.Spawnable or true
            attent.AdminOnly = att.AdminOnly or false
            attent.Category = att.EntityCategory or "ArcCW - Attachments"
            attent.Model = att.DroppedModel or att.Model or "models/Items/BoxSRounds.mdl"
            attent.GiveAttachments = {
                [att.ShortName] = 1
            }

            if att.EntityCategory and !list.HasEntry("ContentCategoryIcons", att.EntityCategory) then
                list.Set("ContentCategoryIcons", att.EntityCategory, "arccw/icon_16.png")
            end

            scripted_ents.Register( attent, "acwatt_" .. name )
        end

        ArcCW.NumAttachments = ArcCW.NumAttachments + 1

        hook.Run("ArcCW_OnAttLoad", att)
    end
end

local function VerifyBlacklist()
    for attName, v in pairs(ArcCW.AttachmentBlacklistTable) do
        if !ArcCW.AttachmentTable[attName] then
            ArcCW.AttachmentBlacklistTable[attName] = nil
        end
    end
end

local function ArcCW_SendBlacklist(ply)
    if SERVER then
        -- Only load if table is empty, bruh
        if table.IsEmpty(ArcCW.AttachmentBlacklistTable) then
            ArcCW.AttachmentBlacklistTable = util.JSONToTable(file.Read("arccw_blacklist.txt") or "") or {}
            local curcount = table.Count(ArcCW.AttachmentBlacklistTable)
            VerifyBlacklist()
            print("Loaded " .. curcount .. " active (" .. curcount .. " total) blacklisted ArcCW attachments.")
        end
        if ArcCW.AttachmentBlacklistTable and player.GetCount() > 0 then
            timer.Simple(0, function()
                net.Start("arccw_blacklist")
                    net.WriteUInt(table.Count(ArcCW.AttachmentBlacklistTable), ArcCW.GetBitNecessity())
                    for attName, bStatus in pairs(ArcCW.AttachmentBlacklistTable) do
                        net.WriteUInt(ArcCW.AttachmentTable[attName].ID, ArcCW.GetBitNecessity())
                    end
                if ply then net.Send(ply) else net.Broadcast() end
            end)
        end
    elseif CLIENT and ArcCW.AttachmentBlacklistTable == nil then
        -- Actively request the table, this happens on player load into server once
        net.Start("arccw_blacklist")
            net.WriteBool(true)
        net.SendToServer()
    end
end


local attachments_path = "arccw/shared/attachments/"
local bulk_path = "arccw/shared/attachments_bulk/"

local function ArcCW_LoadAtt(att_file)
    att = {} -- Do not bleed over attributes from previous attachments
    --shortname = string.sub(att_file, 1, -5)
    local s = string.Explode("/", att_file)
    shortname = string.sub(s[#s], 1, -5)

    include(att_file)
    AddCSLuaFile(att_file)

    ArcCW.LoadAttachmentType(att)

end

local function ArcCW_LoadFolder(folder)
    folder = folder and (attachments_path .. folder .. "/") or attachments_path
    for k, v in pairs(file.Find(folder .. "*", "LUA")) do
        local yaya, yoyo = pcall(function() ArcCW_LoadAtt(folder .. v) end)
        if !yaya then
            print( "!!!! Attachment " .. v .. " has errors!", yoyo )
            -- Create a stub attachment to prevent customization UI freaking out
            ArcCW.AttachmentTable[shortname] = {
                PrintName = shortname or "ERROR",
                Description = "This attachment failed to load!\nIts file path is: " .. v
            }
        end
    end
end

local function ArcCW_LoadAtts()
    ArcCW.AttachmentTable = {}
    ArcCW.AttachmentIDTable = {}
    ArcCW.AttachmentSlotTable = {}
    ArcCW.NumAttachments = 1
    ArcCW.AttachmentBits = nil
    ArcCW.AttachmentCachedLists = {}

    ArcCW_LoadFolder()
    local _, folders = file.Find(attachments_path .. "/*", "LUA")
    if folders then
        for _, folder in pairs(folders) do
            ArcCW_LoadFolder(folder)
        end
    end

    local bulkfiles = file.Find(bulk_path .. "/*.lua", "LUA")
    for _, filename in pairs(bulkfiles) do
        if filename == "default.lua" then continue end
        local try = pcall(function()
            include(bulk_path .. filename)
            AddCSLuaFile(bulk_path .. filename)
        end)
        if !try then
            print("!!!! Bulk attachment file " .. filename .. " has errors!")
        end
    end

    print("Loaded " .. tostring(ArcCW.NumAttachments) .. " ArcCW attachments.")

    if !game.SinglePlayer() then
        ArcCW_SendBlacklist()
    else
        -- Simply read the file and do no networking, since both client/server has access to it
        ArcCW.AttachmentBlacklistTable = util.JSONToTable(file.Read("arccw_blacklist.txt") or "") or {}
        for i, v in pairs(ArcCW.AttachmentTable) do
            v.Blacklisted = ArcCW.AttachmentBlacklistTable[i]
        end
        print("Loaded blacklist with " .. table.Count(ArcCW.AttachmentBlacklistTable) .. " attachments.")
    end

    hook.Run("ArcCW_PostLoadAtts")
end

function ArcCW.GetBitNecessity()
    if !ArcCW.AttachmentBits then
        ArcCW.AttachmentBits = math.min(math.ceil(math.log(ArcCW.NumAttachments + 1, 2)), 32)
    end
    return ArcCW.AttachmentBits
end

if CLIENT then
    concommand.Add("arccw_reloadatts", function()
        if !LocalPlayer():IsSuperAdmin() then return end

        net.Start("arccw_reloadatts")
        net.SendToServer()
    end)

    net.Receive("arccw_reloadatts", function(len, ply)
        ArcCW_LoadAtts()
    end)

    spawnmenu.AddCreationTab( "#spawnmenu.category.entities", function()

        local ctrl = vgui.Create( "SpawnmenuContentPanel" )
        ctrl:EnableSearch( "entities", "PopulateEntities" )
        ctrl:CallPopulateHook( "PopulateEntities" )

        return ctrl

    end, "icon16/bricks.png", 20 )

    -- Client receives blacklist table from server and updates itself
    net.Receive("arccw_blacklist", function()
        ArcCW.AttachmentBlacklistTable = {}
        local amt = net.ReadUInt(ArcCW.GetBitNecessity())
        for i = 1, amt do
            local id = net.ReadUInt(ArcCW.GetBitNecessity())
            ArcCW.AttachmentBlacklistTable[ArcCW.AttachmentIDTable[id]] = true
        end
        for i, v in pairs(ArcCW.AttachmentTable) do
            v.Blacklisted = ArcCW.AttachmentBlacklistTable[i]
        end
        print("Received blacklist with " .. table.Count(ArcCW.AttachmentBlacklistTable) .. " attachments.")
    end)

    -- Gets around Listen server spawn issues
    hook.Add( "InitPostEntity", "Ready", function()
        if !game.SinglePlayer() then
            net.Start("arccw_blacklist")
                net.WriteBool(true)
            net.SendToServer()
        end
    end )
elseif SERVER then
    net.Receive("arccw_reloadatts", function(len, ply)
        if !ply:IsSuperAdmin() then return end

        ArcCW_LoadAtts()

        net.Start("arccw_reloadatts")
        net.Broadcast()
    end)

    local antiSpam = {}
    net.Receive("arccw_blacklist", function(len, ply)

        -- If this message is a request to get blacklist, send it and return
        local isRequest = net.ReadBool()
        if isRequest then
            if antiSpam[ply] and antiSpam[ply] > CurTime() then return end
            -- Debounce client request so they can't attempt to spam netmessages
            antiSpam[ply] = CurTime() + 10

            ArcCW_SendBlacklist(ply)
            return
        elseif !isRequest and !ply:IsAdmin() then
            return
        end

        -- Server receives admin's changes to blacklist table
        local amt = net.ReadUInt(ArcCW.GetBitNecessity())
        ArcCW.AttachmentBlacklistTable = {}
        for i = 1, amt do
            local id = net.ReadUInt(ArcCW.GetBitNecessity())
            local attName = ArcCW.AttachmentIDTable[id]
            if attName and ArcCW.AttachmentTable[attName] then
                ArcCW.AttachmentBlacklistTable[attName] = true
            end
        end
        for i, k in pairs(ArcCW.AttachmentTable) do
            k.Blacklisted = ArcCW.AttachmentBlacklistTable[i] or false
        end
        print("Received blacklist with " .. table.Count(ArcCW.AttachmentBlacklistTable) .. " attachments.")
        file.Write("arccw_blacklist.txt", util.TableToJSON(ArcCW.AttachmentBlacklistTable))
        ArcCW_SendBlacklist()
    end)
end

hook.Add("PostCleanupMap", "ArcCW_ReloadAttsDebug", function()
    if ArcCW.ConVars["reloadatts_mapcleanup"]:GetBool() then ArcCW_LoadAtts() end
end)

ArcCW_LoadAtts()

--lua/arccw/shared/attachments/optic_cheytacscope.lua:
att.PrintName = "CheyTac (2-4.3x)"
att.Icon = Material("entities/acwatt_optic_cheytacscope.png", "smooth")
att.Description = "Good scope. Gooood scope."

att.SortOrder = 4.3

att.Desc_Pros = {
    "autostat.holosight",
    "autostat.zoom",
}
att.Desc_Cons = {
}
att.AutoStats = true
att.Slot = {"optic","optic_sniper"}

att.Model 			= "models/weapons/arccw/fesiugmw2/atts/cheytacscope_3b.mdl"
att.HolosightPiece 	= "models/weapons/arccw/fesiugmw2/atts/cheytacscope_2b_hsp.mdl"

att.AdditionalSights = {
    {
        Pos = Vector(0, 10.2, -1.5),
        Ang = Angle(0, 0, 0),
        ViewModelFOV = 65 / 2.25,
        Magnification = 2.25,
        ScrollFunc = ArcCW.SCROLL_ZOOM,
        ZoomLevels = 6,
        ZoomSound = "weapons/arccw/fiveseven/fiveseven_slideback.wav",
        IgnoreExtra = true
    }
}

att.ScopeGlint = true

att.Holosight = true
att.HolosightReticle = Material("hud/scopes/m40a3.png", "mips smooth")
att.HolosightNoFlare = true
att.HolosightSize = 25
att.HolosightBone = "holosight"
att.Colorable = false

att.HolosightMagnification = 4.3
att.HolosightBlackbox = true

att.HolosightMagnificationMin = 2
att.HolosightMagnificationMax = 4.3

att.Mult_SightTime = 1.15
att.Mult_SightedSpeedMult = 0.9
-- att.Mult_SpeedMult = 0.98
--lua/arccw/shared/attachments/optic_mw2_augscope_int.lua:
att.PrintName = "Swavorski INT (2.1x)"
att.Icon = Material("entities/acwatt_optic_mw2_augscope.png", "smooth")
att.Description = "Integrated telescopic scope created for the AUG."

att.SortOrder = 1738

att.Desc_Pros = {
    "autostat.holosight",
    "autostat.zoom",
}
att.Desc_Cons = {
}
att.AutoStats = true
att.Slot = {"mw2_augscope"}
att.InvAtt = "optic_mw2_augscope"

att.Model = "models/weapons/arccw/fesiugmw2/atts/scopes/swavorski_base_2b.mdl"

att.AdditionalSights = {
    {
        Pos = Vector(0, 10, -1.62),
        Ang = Angle(0, 0, 0),
        ViewModelFOV = 65 / 1.6,
        Magnification = 1.6,
        ScrollFunc = ArcCW.SCROLL_ZOOM,
        ZoomLevels = 12,
        ZoomSound = "weapons/arccw/fiveseven/fiveseven_slideback.wav",
        IgnoreExtra = true
    }
}

att.ScopeGlint = false

att.Holosight = true
att.HolosightReticle = Material("hud/scopes/m40a3.png", "mips smooth")
att.HolosightNoFlare = true
att.HolosightSize = 14
att.HolosightBone = "holosight"
att.HolosightPiece = "models/weapons/arccw/fesiugmw2/atts/scopes/swavorski_lens_2b.mdl"
att.Colorable = false

att.HolosightMagnification = 2.16
att.HolosightBlackbox = true

att.HolosightConstDist = 64

att.Mult_SightTime = 1.12
att.Mult_SightedSpeedMult = 0.92

att.ModelRotate = Angle(0, 90, 0)

att.AddSuffix = " Swavorski"
--lua/arccw/shared/attachments/optic_mw2_susat.lua:
return gluapack()()
--lua/arccw/shared/attachments/uc_40mm_napalm.lua:
att.PrintName = "40mm Napalm Grenades"
att.AbbrevName = "Napalm"
att.Icon = Material("entities/att/arccw_uc_40mm_generic.png", "mips smooth")
att.Description = "Extremely illegal airburst grenades loaded with sticky napalm.\nWhile the napalm only disperses in a small radius, it will stick onto targets that come into contact with it, causing a gruesome and fiery death."
att.Desc_Pros = {
    "uc.40mm.napalm",
    "uc.40mm.proximity",
}
att.Desc_Cons = {
    "uc.40mm.nodmg",
    "uc.40mm.arm",
    "uc.40mm.drag.high",
}
att.Desc_Neutrals = {
}
att.Slot = "uc_40mm"

att.AutoStats = true

att.Override_ShootEntity = "arccw_uc_40mm_napalm"

att.Mult_MuzzleVelocity = 0.75

att.Mult_ShootPitch = 0.95

att.ActivateElements = {"40mm_napalm"}
--lua/arccw/shared/attachments/uc_ammo_sg_bird2.lua:
att.PrintName = "\"BIRD\" #9 Birdshot"

att.SortOrder = 4
att.Icon = Material("entities/att/arccw_uc_ammo_shotgun_generic.png", "mips smooth")
att.Description = [[Hunting rounds with a wide spread and a very large number of pellets, designed to shoot birds out of the sky.
While not as lethal as buckshot, the loose clump spread makes it easier to hit small or multiple targets.]]
att.Desc_Pros = {
    "uc.pellet.8"
}
att.Desc_Cons = {
    "uc.accuracy.10"
}
att.Desc_Neutrals = {
}
att.Slot = {"ud_ammo_shotgun", "uc_ammo"}

att.InvAtt = "uc_ammo_sg_bird"

att.AutoStats = true

att.Add_Num = 8
att.Mult_Damage = 0.9
att.Mult_DamageMin = 0.9
att.Mult_Recoil = 0.8

att.Add_AccuracyMOA = 10

att.Override_UC_ShellColor = Color(0.4 * 255, 0.6 * 255, 0.8 * 255)

att.Hook_Compatible = function(wep)
    if !wep:GetBuff_Override("UC_Shotshell") then
        return false
    end
end
--lua/arccw/shared/attachments/uc_ammo_sg_frag.lua:
att.PrintName = "\"HE\" FRAG-12"
att.Icon = Material("entities/att/arccw_uc_ammo_shotgun_generic.png", "mips smooth")
att.Description = [[Shotgun slug with a small high-explosive warhead. On impact, the round saturates its surroundings with shrapnel like a frag grenade.
Meant for breaching, but it can also useful for applying damage over an area.
Beware: the explosion doesn't care who it hurts.

Only compatible with manual action shotguns due to a weak pressure curve.]]
att.Desc_Pros = {
    "uc.explode"
}
att.Desc_Cons = {
    "uc.alwaysphys",
}
att.Desc_Neutrals = {
    "uc.oneprojectile",
    "uc.manualonly",
}
att.SortOrder = 2

att.Slot = {"ud_ammo_shotgun", "uc_ammo"}

att.Mult_Penetration = 0.1
att.Mult_Damage = 0.75
att.Mult_DamageMin = 0.75
att.Mult_Range = .5
att.Mult_HipDispersion = 1.5
att.Override_Num = 1
att.Override_Num_Priority = 99
att.AutoStats = true

att.Override_HullSize = 0

att.ActivateElements = {"uc_manualonly"}
att.GivesFlags = {"uc_slug"}

att.Override_AlwaysPhysBullet = true
att.Mult_PhysBulletGravity = 1.5
att.Override_PhysBulletImpact = false

att.Hook_PhysBulletHit = function(wep, data)
    if SERVER then
    local delta = data.bullet.Travelled / (data.bullet.Range / ArcCW.HUToM)
    delta = math.Clamp(delta, 0, 1)
    local dmg = Lerp(delta, data.bullet.DamageMax, data.bullet.DamageMin)

    util.BlastDamage(wep, wep:GetOwner(), data.tr.HitPos, 128, dmg)

    local eff = EffectData()
    eff:SetOrigin(data.tr.HitPos)
    eff:SetMagnitude(4)
    eff:SetScale(0.5)
    eff:SetRadius(4)
    util.Effect("Sparks", eff)
    util.Effect("Explosion", eff)
    util.Decal("Scorch", data.tr.HitPos - data.tr.HitNormal, data.tr.HitPos + data.tr.HitNormal, ents.GetAll())
    end
end

att.Override_UC_ShellColor = Color(0.9 * 255, 0.7 * 255, 0.3 * 255)

att.Hook_Compatible = function(wep)
    if (!wep.ManualAction and !wep.UC_CanManualAction) or !wep:GetIsShotgun() or wep:GetBuff_Override("UC_Shotshell") then return false end
end
--lua/arccw/shared/attachments/uc_ammo_tr.lua:
return gluapack()()
--lua/arccw/shared/attachments/uc_charm_urbancharm_common.lua:
att.PrintName = "Urban Charm - Common"
att.Description = "The icon of a Garry's Mod addon."

att.Desc_Pros = {
}
att.Desc_Cons = {
}
att.AutoStats = true
att.Slot = "charm"

att.Free = true

att.Model = "models/weapons/arccw/atts/charmbase.mdl"

att.DroppedModel = "models/Items/BoxSRounds.mdl"

att.Charm = true
att.CharmModel = "models/weapons/arccw/atts/uc_urbancharm.mdl"
att.CharmAtt = "Charm"
att.CharmScale = Vector(0.5, 0.5, 0.5)
att.CharmOffset = Vector(0, -1.1, -0.2)
att.CharmAngle = Angle(20, 0, 80)
att.CharmSkin = 0

--lua/arccw/shared/attachments/uc_fg_loosesprings.lua:
att.PrintName = "Loose Springs"

att.Icon = Material("entities/att/arccw_uc_loosesprings.png", "mpis smooth")
att.Description = "With help from some loose magazine springs, it is possible to stuff more ammo in a magazine than is usually recommended."
att.Desc_Pros = {
    "uc.loosesprings"
}
att.Desc_Cons = {
}
att.Desc_Neutrals = {
}
att.Slot = "uc_fg"
att.AutoStats = true

function att.Hook_GetCapacity(wep,cap)
    return math.max(cap + 1, math.floor(cap * 1.08))
end

att.Hook_Compatible = function(wep)
    if wep.RejectMagSizeChange or wep:GetCapacity() == 1 then return false end
end

att.Mult_RPM = .85
att.Mult_MalfunctionMean = 0.9
att.GivesFlags = {"ud_loosesprings"}
att.ExcludeFlags = {"ud_underload"}

att.AttachSound = "arccw_uc/common/gunsmith/internal_modification.ogg"
--lua/arccw/shared/attachments/uc_grip_mafg2_tan.lua:
return gluapack()()
--lua/arccw/shared/attachments/uc_muzzle_supp_cylinder.lua:
return gluapack()()
--lua/arccw/shared/attachments/uc_optic_annihilator.lua:
return gluapack()()
--lua/arccw/shared/attachments/uc_optic_comp_m2.lua:
return gluapack()()
--lua/arccw/shared/attachments/uc_powder_high.lua:
return gluapack()()
--lua/arccw/shared/attachments/uc_powder_overpressure.lua:
att.PrintName = "Overpressured"

att.SortOrder = 20
att.Icon = Material("entities/att/acwatt_uc_powder_overpressure.png", "smooth mips")
att.Description = "Higher pressure ammunition allows for higher muzzle velocity at the cost of stronger knockback. Such immense pressure increases the likelihood of extraction failures."
att.Desc_Pros = {
}
att.Desc_Cons = {
}
att.Desc_Neutrals = {
}
att.Slot = "uc_powder"

att.AutoStats = true

att.Mult_RecoilSide = 1.25
att.Mult_Recoil = 1.2
att.Mult_RangeMin = 1.25
att.Mult_Range = 1.3

att.Mult_RPM = 1.08
att.Mult_ShootVol = 1.25
--att.Mult_ShootPitch = 0.9 please don't

att.Mult_MalfunctionMean = 0.7
att.Mult_PhysBulletMuzzleVelocity = 1.25
--lua/arccw/shared/attachments/uc_tac_flashlight1.lua:
att.PrintName = "Civilian Rail-Mounted Flashlight"
att.AbbrevName = "Civilian Flashlight"
att.Icon = Material("entities/att/acwatt_uc_tac_flashlight1.png", "mips smooth")
att.Description = "Illuminates dark areas in front of the muzzle.\nCan be adjusted for a wide light."
att.Desc_Pros = {
    "uc.light"
}
att.Desc_Cons = {
    "con.light"
}
att.Desc_Neutrals = {}
att.AutoStats = true

att.Slot = {"tac","tac_pistol"}
att.SortOrder = 30+1

att.Model = "models/weapons/arccw/atts/ud_flashlight_1.mdl"
att.ModelOffset = Vector(0,0,0)
att.OffsetAng = Angle(0,0,180)
att.ModelScale = Vector(1.2,1.2,1.2)

att.Flashlight = false
att.FlashlightFOV = 50
att.FlashlightFarZ = 1024 -- how far it goes
att.FlashlightNearZ = 1 -- how far away it starts
att.FlashlightAttenuationType = ArcCW.FLASH_ATT_LINEAR -- LINEAR, CONSTANT, QUADRATIC are available
att.FlashlightColor = Color(255, 242, 229)
att.FlashlightTexture = "effects/flashlight001"
att.FlashlightBrightness = 3
att.FlashlightBone = "light"

att.ToggleStats = {
    {
        PrintName = "On",
        Flashlight = true
    },
    {
        PrintName = "Wide",
        Flashlight = true,
        FlashlightFOV = 80,
        FlashlightFarZ = 768,
        FlashlightBrightness = 1
    },
    {
        PrintName = "Off",
        Flashlight = false,
    }
}
--lua/arccw/shared/attachments/uc_tac_flashlight3.lua:
att.PrintName = "High-Power Rail-Mounted Flashlight"
att.AbbrevName = "High-Power Flashlight"
att.Icon = Material("entities/att/acwatt_uc_tac_flashlight3.png", "mips smooth")
att.Description = "Illuminates dark areas in front of the muzzle.\nEmits a strong, orange-tinted light."
att.Desc_Pros = {
    "uc.light"
}
att.Desc_Cons = {
    "con.light"
}
att.Desc_Neutrals = {}
att.AutoStats = true

att.Slot = {"tac"}
att.SortOrder = 30+3

att.Model = "models/weapons/arccw/atts/uc_flashlight.mdl"
att.ModelOffset = Vector(0.5,0,-0.07)
att.OffsetAng = Angle(0,0,0)
att.ModelScale = Vector(0.75,0.75,0.75)

att.Flashlight = false
att.FlashlightFOV = 40
att.FlashlightFarZ = 1536 -- how far it goes
att.FlashlightNearZ = 1 -- how far away it starts
att.FlashlightAttenuationType = ArcCW.FLASH_ATT_LINEAR -- LINEAR, CONSTANT, QUADRATIC are available
att.FlashlightColor = Color(255, 229, 200)
att.FlashlightTexture = "effects/flashlight001"
att.FlashlightBrightness = 4
att.FlashlightBone = "flashlight"

att.ToggleStats = {
    {
        PrintName = "On",
        Flashlight = true
    },
    {
        PrintName = "Off",
        Flashlight = false,
    }
}
--lua/arccw/shared/attachments/uc_tp_bruiser.lua:
return gluapack()()
--lua/arccw/shared/attachments/uc_tp_fastreload.lua:
att.PrintName = "Loading Drills"

att.Icon = Material("entities/att/arccw_uc_tp_loading_drills.png", "smooth mips")
att.Description = "Every second counts in the heat of battle. Repeated training drills allow you to reload your weapon more quickly."
att.Desc_Pros = {
}
att.Desc_Cons = {
}
att.Desc_Neutrals = {
}
att.Slot = "uc_tp"

att.AutoStats = true
att.SortOrder = 13

att.Mult_ReloadTime = 0.9

-- CS/GSO rapid reload OP

att.NotForNPCs = true
--lua/arccw/shared/attachments/uc_tp_sway.lua:
return gluapack()()
--lua/arccw/shared/attachments/uc_ubgl_m203.lua:
return gluapack()()
--lua/arccw/shared/attachments/uc_ubgl_masterkey.lua:
att.PrintName = "Masterkey Underslung Shotgun"
att.AbbrevName = "Masterkey Shotgun"
att.Icon = Material("entities/att/acwatt_uc_ubgl_masterkey.png", "mips smooth")
att.Description = "Underslung shotgun primarily used to breach doors, but loaded with #00 Buckshot for your pleasure."

att.SortOrder = -100000

att.AutoStats = true
att.Desc_Pros = {
}
att.Slot = "uc_ubgl"
att.ExcludeFlags = {"uc_noubgl"}

att.LHIK = true

att.ModelOffset = Vector(1.0, 0, -1.7)
att.Model = "models/weapons/arccw/atts/uc_ubgl_masterkey.mdl"

att.SelectUBGLSound =  ""
att.ExitUBGLSound = ""

att.UBGL = true

att.UBGL_PrintName = "UBSG"
att.UBGL_Automatic = false
att.UBGL_MuzzleEffect = "muzzleflash_shotgun"
att.UBGL_Ammo = "buckshot"
att.UBGL_RPM = 120
att.UBGL_Recoil = 1

-- ??
att.UBGL_Capacity = 4
att.UBGL_ClipSize = 4

att.LHIK_GunDriver = 2
att.LHIK_CamDriver = 3

local pretty = GetConVar("arccw_uc_infiniteubwammo")

att.Hook_ModifyAttBodygroups = function(wep, data)
    if wep:GetBuff_Override("UC_UseClassicM203Mount") then
        data.element.Model:SetBodygroup(1, 1)
    end
end

local function Ammo(wep)
    return (pretty:GetBool() and 9999 or wep:GetOwner():GetAmmoCount("buckshot"))
end

att.Hook_LHIK_TranslateAnimation = function(wep, key)
    if key == "idle" then
        if wep:GetNW2Bool("MasterkeyInReload", false) or wep:GetNW2Float("MasterkeyReloadTime", CurTime()) >= CurTime() then
            return "DoNotPlayIdle"
        elseif wep:GetInUBGL() then
            return "idle_armed"
        else
            return "idle"
        end
    end
end

att.Hook_ShouldNotSight = function(wep)
    if wep:GetInUBGL() then
        return true
    end
end


att.Hook_OnSelectUBGL = function(wep)
    wep:SetNextSecondaryFire(CurTime() + 0.7)
    if (game.SinglePlayer() and SERVER) or (!game.SinglePlayer() and CLIENT and IsFirstTimePredicted()) then
        wep:DoLHIKAnimation("to_armed", 0.7)
        wep:PlaySoundTable({
            {s = "arccw_uc/common/rattle_b2i_rifle.ogg", t = 0},
            {s = "arccw_uc/common/raise.ogg", t = 0.15},
            {s = "arccw_uc/common/grab.ogg", t = 0.3},
        })
    end
end

att.Hook_OnDeselectUBGL = function(wep)
    wep:SetNextSecondaryFire(CurTime() + 0.7)
    if (game.SinglePlayer() and SERVER) or (!game.SinglePlayer() and CLIENT and IsFirstTimePredicted()) then
        wep:DoLHIKAnimation("to_idle", 0.7)
        wep:PlaySoundTable({
            {s = "arccw_uc/common/rattle_b2i_rifle.ogg", t = 0},
            {s = "arccw_uc/common/shoulder.ogg", t = 0.3},
        })
    end
end

local f1 = {
    ")arccw_uc/common/ub12ga/fire-01.ogg",
    ")arccw_uc/common/ub12ga/fire-02.ogg",
    ")arccw_uc/common/ub12ga/fire-03.ogg",
    ")arccw_uc/common/ub12ga/fire-04.ogg",
    ")arccw_uc/common/ub12ga/fire-05.ogg",
    ")arccw_uc/common/ub12ga/fire-06.ogg",
}
local f2 = {
    ")arccw_uc/common/ub12ga/fire-dist-01.ogg",
    ")arccw_uc/common/ub12ga/fire-dist-02.ogg",
    ")arccw_uc/common/ub12ga/fire-dist-03.ogg",
    ")arccw_uc/common/ub12ga/fire-dist-04.ogg",
    ")arccw_uc/common/ub12ga/fire-dist-05.ogg",
    ")arccw_uc/common/ub12ga/fire-dist-06.ogg",
}
local f3 = {
    ")arccw_uc/common/ub12ga/mech-01.ogg",
    ")arccw_uc/common/ub12ga/mech-02.ogg",
    ")arccw_uc/common/ub12ga/mech-03.ogg",
    ")arccw_uc/common/ub12ga/mech-04.ogg",
    ")arccw_uc/common/ub12ga/mech-05.ogg",
    ")arccw_uc/common/ub12ga/mech-06.ogg",
}

att.UBGL_Fire = function(wep, ubgl)
    if wep:Clip2() <= 0 or wep:GetNextPrimaryFire() > CurTime() then return end
    if wep:GetNW2Bool("MasterkeyNeedsPump", false) then return end

    local owner = wep:GetOwner()

    local dir = (owner:EyeAngles() + wep:GetFreeAimOffset()):Forward()

    local bullet = {
        DamageMax = 18, -- 6 pellets to kill
        DamageMin = 13, -- 8 pelllets to kill
        Range = 50,
        RangeMin = 5,
        DamageType = DMG_BUCKSHOT + DMG_BULLET,
        Penleft = 0,
        Penetration = 0,
        Num = 1,
        Damaged = {},
        Weapon = wep,
        BodyDamageMults = ArcCW.UC.BodyDamageMults_Shotgun,
    }

    local data = {
        Attacker = owner,
        Dir        = dir,
        Src        = wep:GetShootSrc(),
        Spread     = Vector(0, 0, 0),
        Damage     = 0,
        Num        = 1,
        Force      = 10,
        HullSize   = 4,
        Weapon     = wep,
        Callback = function(attacker, tr, dmg)
            -- HACK: Pass a fake bullet table instead of ourselves so we don't use the weapon's attributes unintentionally
            bullet.Travelled = (tr.HitPos - tr.StartPos):Length()
            ArcCW:BulletCallback(att, tr, dmg, bullet)
        end
    }

    if wep:GetOwner():IsPlayer() then
        for n = 1, 8 do
            local dirry = Vector(dir.x, dir.y, dir.z)
            math.randomseed(math.Round(util.SharedRandom(n, -1337, 1337, !game.SinglePlayer() and wep:GetOwner():GetCurrentCommand():CommandNumber() or CurTime()) * (wep:EntIndex() % 30241)))
            wep:ApplyRandomSpread(dirry, ArcCW.MOAToAcc * 100)
            data.Dir = dirry
            if GetConVar("arccw_bullet_enable"):GetBool() then
                ArcCW:ShootPhysBullet(wep, data.Src, (250 / ArcCW.HUToM) * data.Dir:GetNormalized(), 0, bullet)
            else
                owner:FireBullets(data, true)
            end
        end
    else
        data.Spread = Vector(ArcCW.MOAToAcc * 50, ArcCW.MOAToAcc * 50, 0)
        data.Num = 8
        owner:FireBullets(data, true)
    end

    if (game.SinglePlayer() and SERVER) or (!game.SinglePlayer() and CLIENT and IsFirstTimePredicted()) then
        wep:MyEmitSound(table.Random(f1), 80, 100, 1, CHAN_STATIC )
        wep:MyEmitSound(table.Random(f2), 149, 100, 1, CHAN_STATIC )
        wep:MyEmitSound(table.Random(f3), 80, 100, 1, CHAN_STATIC )
    end
    
    if game.SinglePlayer() and SERVER or (!game.SinglePlayer() and CLIENT and IsFirstTimePredicted()) then
        wep:DoEffects()
        wep:DoLHIKAnimation("fire")
    end
    wep:SetNextPrimaryFire(CurTime() + 0.4)
    wep:SetClip2(wep:Clip2() - 1)
    wep:SetNW2Bool("MasterkeyNeedsPump", true)
    wep:SetNW2Float("MasterkeyPumpTime", CurTime() + 0.3)
end

att.Hook_Think = function(wep)
    local p = wep:GetOwner()
    local pred = game.SinglePlayer() and SERVER or (!game.SinglePlayer() and CLIENT and IsFirstTimePredicted())
    if wep:GetNW2Bool("MasterkeyInReload", false) then
        if wep:GetNW2Float("MasterkeyReloadTime", CurTime()) <= CurTime() then
            if (!p and false or p:KeyDown(IN_ATTACK)) or Ammo(wep) <= 0 or wep:Clip2() == 4 then
                wep:SetReloading(CurTime() + 0.5)
                wep:SetNW2Float("MasterkeyPumpTime", CurTime() + 0.5)
                wep:SetNW2Float("MasterkeyReloadTime", CurTime() + 0.5)
                if pred then
                    wep:DoLHIKAnimation("sgreload_end")
                    wep:PlaySoundTable({
                        {s = ")arccw_uc/common/shoulder.ogg", t = 0.1},
                    })
                end
                wep:SetNW2Bool("MasterkeyInReload", false)
            else
                wep:SetReloading(CurTime() + 0.9)
                wep:SetNW2Float("MasterkeyReloadTime", CurTime() + 0.7)
                if pred then
                    wep:DoLHIKAnimation("sgreload_insert", 0.9)
                    wep:PlaySoundTable({
                        {s = ")arccw_uc/common/shotgun-insert-alt-01.ogg", t = 0.05},
                    })
                end
                wep:SetClip2(wep:Clip2() + 1)
                if !pretty:GetBool() then
                    wep:GetOwner():RemoveAmmo(1, "buckshot")
                end
            end
        end
    elseif wep:GetNW2Bool("MasterkeyNeedsPump", false) and wep:GetNW2Float("MasterkeyPumpTime", CurTime()) <= CurTime() and wep:Clip2() > 0 and !wep:GetOwner():KeyDown( IN_ATTACK ) then
        wep:SetNW2Bool("MasterkeyNeedsPump", false)
        wep:SetPriorityAnim(CurTime() + 0.4)
        if pred then
            wep:DoLHIKAnimation("cycle", 1.0)
            wep:PlaySoundTable({
                {s = ")weapons/arccw_ud/870/rack_1.ogg", t = 0.02},
                {s = ")weapons/arccw_ud/870/eject.ogg", t = 0.13},
                {s = ")weapons/arccw_ud/870/rack_2.ogg", t = 0.17},
            })
        end
    end
end

att.UBGL_Reload = function(wep, ubgl)
    if wep:Clip2() >= 4 then return end
    if Ammo(wep) <= 0 then return end

    wep:SetNextSecondaryFire(CurTime() + 1)

    local holy = (game.SinglePlayer() and SERVER) or (!game.SinglePlayer() and CLIENT and IsFirstTimePredicted())
    if wep:Clip2() == 0 then -- Always pump on empty.
        wep:SetNW2Bool("MasterkeyNeedsPump", true)
    end
    --[[if wep:Clip2() == 0 then
        if holy then
            wep:DoLHIKAnimation("sgreload_start_empty", 2)
            wep:PlaySoundTable({
                {s = ")weapons/arccw_ud/870/rack_1.ogg", t = 0},
                {s = ")arccw_uc/common/shotgun-insert-alt-01.ogg", t = 0.8},
                {s = ")weapons/arccw_ud/870/rack_2.ogg", t = 1.5},
                {s = ")arccw_uc/common/shoulder.ogg", t = 1.6},
            })
        end
        wep:SetNW2Bool("MasterkeyNeedsPump", false)
        wep:SetReloading(CurTime() + 2)
        wep:SetNW2Float("MasterkeyReloadTime", CurTime() + 2)

        wep:SetClip2(wep:Clip2() + 1)
        if !pretty:GetBool() then
            wep:GetOwner():RemoveAmmo(1, "buckshot")
        end
    else]]
        if holy then
            wep:DoLHIKAnimation("sgreload_start", 0.7)
            wep:PlaySoundTable({
                {s = ")arccw_uc/common/raise.ogg", t = 0.15},
                {s = ")arccw_uc/common/grab.ogg", t = 0.3},
            })
        end
        wep:SetReloading(CurTime() + 0.7)
        wep:SetNW2Float("MasterkeyReloadTime", CurTime() + 0.7)
    --end
    wep:SetNW2Bool("MasterkeyInReload", true)

    --local reserve = Ammo(wep)
    --reserve = reserve + wep:Clip2()
    --local clip = 4
    --local load = math.Clamp(clip, 0, reserve)
    --wep:GetOwner():SetAmmo(reserve - load, "smg1_grenade")
    --wep:SetClip2(load)
end

att.Mult_SightTime = 1.2
att.Mult_SpeedMult = 0.9
att.Mult_SightedSpeedMult = 0.85
--lua/arccw/shared/attachments/uc_usp_skin_nickel.lua:
att.PrintName = "USP Nickel Finish"
att.AbbrevName = "Nickel"
if !GetConVar("arccw_truenames"):GetBool() then
    att.PrintName = "P93 Nickel Finish"
end
att.Icon = Material("entities/att/acwatt_uc_usp_skin_nickel.png","mips smooth")
att.Description = "Your oppressors had best get a good look at the last thing they will see.\n\n\"As a consequence of your action, this entity will continue, and this entity will not.\""
att.Slot = "uc_usp_skin"
att.Desc_Neutrals = {
    "uc.cosmetic"
}
att.SortOrder = 2

att.IgnorePickX = true
att.Free = true

att.GivesFlags = {"usp_freeman_1"}
--lua/arccw/shared/attachments/ud_870_barrel_sawnoff.lua:
att.PrintName = "Express-12 10\" ACCWS Breacher Barrel"
att.AbbrevName = "10\" Breacher Barrel"

if GetConVar("arccw_truenames"):GetBool() then
    att.PrintName = "Remington 870 MCS 10\" Breacher Barrel"
end

att.Icon = Material("entities/att/acwatt_ud_870_barrel_sawnoff.png", "smooth mips")
att.Description = "Hand-made short barrel with no sights. More agile and has a bigger pellet spread."
att.Desc_Pros = {
}
att.Desc_Cons = {
    "uc.nofs",
}
att.Desc_Neutrals = {
}
att.Slot = "ud_870_barrel"

att.AutoStats = true
att.SortOrder = -1

att.Mult_AccuracyMOA = 1.5
att.Mult_Recoil = 1.25
att.Mult_Range = 0.8

att.Mult_Sway = 0.5
att.Mult_SightTime = 0.75
att.Mult_SpeedMult = 1.05

att.Mult_HipDispersion = 0.75

att.Add_BarrelLength = -4

att.A_Hook_Add_SightsDispersion = function(wep, data)
    if data and !wep.Attachments[1].Installed then
        data.add = data.add + 250
    end
end

att.ActivateElements = {"ud_870_barrel_sawnoff"}
--lua/arccw/shared/attachments/ud_870_stock_raptor.lua:
return gluapack()()
--lua/arccw/shared/attachments/ud_870_stock_sawnoff.lua:
att.PrintName = "Express-12 Sawn-off Stock"
att.AbbrevName = "Sawn-off Stock"

if GetConVar("arccw_truenames"):GetBool() then
    att.PrintName = "Remington 870 Sawn-off Stock"
end

att.Icon = Material("entities/att/acwatt_ud_870_stock_sawnoff.png", "smooth mips")
att.Description = "Wooden stock with only a grip remaining. In case you want to roleplay as a bank robber."
att.Desc_Pros = {
}
att.Desc_Cons = {
}
att.Desc_Neutrals = {
}
att.Slot = "ud_870_stock"

att.AutoStats = true

att.Mult_SpeedMult = 1.025
att.Mult_SightTime = 0.75
att.Mult_SightedSpeedMult = 1.1
att.Mult_ShootSpeedMult = 1.05

att.Mult_DrawTime = 0.75
att.Mult_HolsterTime = 0.75

att.Mult_Recoil = 1.5
att.Mult_RecoilSide = 2
att.Mult_VisualRecoilMult = 0.5

att.Add_BarrelLength = -4
att.Mult_Sway = 3

att.ActivateElements = {"ud_870_stock_sawnoff"}

att.Override_ActivePos = Vector(0, 2.5, -0.5)
att.Override_HoldtypeActive = "shotgun"
att.Override_HoldtypeSights = "ar2"
--lua/arccw/shared/attachments/ud_glock_caliber_40sw.lua:
return gluapack()()
--lua/arccw/shared/attachments/ud_glock_slide_auto.lua:
att.PrintName = "GEN3 Auto Slide"
att.AbbrevName = "Auto Slide"

if GetConVar("arccw_truenames"):GetBool() then
    att.PrintName = "Glock 18C Auto Slide"
end

att.Icon = Material("entities/att/acwatt_ud_glock_slide_auto.png", "smooth mips")
att.Description = "An automatic slide capable of a very high rate of fire. Compensator cuts at the top improve recoil control, although that does not change the fact that this is a hell of a bullet nozzle."
att.Desc_Pros = {
    "uc.auto",
}
att.Desc_Cons = {
    "uc.jam"
}
att.Desc_Neutrals = {
}
att.Slot = "ud_glock_slide"

att.AutoStats = true

att.Override_Trivia_Class = "Machine Pistol"

--att.Mult_SightTime = 1
--att.Mult_Recoil = 1
--att.Mult_SpeedMult = 1
att.Mult_MoveDispersion = 1.5
att.Mult_HipDispersion = 1.25
att.Mult_Recoil = 0.95
att.Mult_RPM = 2.38
att.Mult_ShootSpeedMult = 0.85

att.Override_Malfunction = true

att.Override_Firemodes = {
    {
        Mode = 2,
    },
    {
        Mode = 1,
    },
    {
        PrintName = "fcg.safe2",
        Mode = 0,
    }
}

-- att.Hook_TranslateAnimation = function(wep, anim)
--     if (anim == "fire" || anim == "fire_empty") then
--         return anim .. "_18"
--     end
-- end

att.ActivateElements = {"ud_glock_slide_auto"}
att.GivesFlags = {"ud_glock_auto"}
att.ExcludeFlags = {"ud_glock_not_9mil"}
--lua/arccw/shared/attachments/ud_glock_slide_carbine.lua:
att.PrintName = "GEN3 Carbine Slide"
att.AbbrevName = "Carbine Slide"

if GetConVar("arccw_truenames"):GetBool() then
    att.PrintName = "Glock 17 Euro Carbine Slide"
end

att.Icon = Material("entities/att/acwatt_ud_glock_slide_carbine.png", "smooth mips")
att.Description = "Extraordinarily long extended barrel. Designed for use in countries where handguns are banned, in order to fulfil minimum length requirements."
att.Desc_Pros = {
}
att.Desc_Cons = {
}
att.Desc_Neutrals = {
}
att.Slot = "ud_glock_slide"

att.AutoStats = true

att.Mult_SightTime = 1.75
att.Mult_Recoil = 0.5
att.Mult_AccuracyMOA = 0.25
att.Mult_Sway = 2
att.Mult_Range = 3

att.Mult_DrawTime = 1.5
att.Mult_HolsterTime = 1.5

att.Add_BarrelLength = 32

att.ActivateElements = {"ud_glock_slide_carbine"}
--lua/arccw/shared/attachments/ud_m1014_barrel_short.lua:
att.PrintName = "14\" M4 Super 90 Entry Barrel"
att.AbbrevName = "14\" Entry Barrel"

if !GetConVar("arccw_truenames"):GetBool() then
    att.PrintName = "14\" FC1040 Entry Barrel"
end

att.Icon = Material("entities/att/acwatt_ud_m1014_barrel_short.png", "smooth mips")
att.Description = "Short barrel intended for breaching and close quarters use. Noticeably increases pellet spread, but is easier to manuver."
att.Desc_Pros = {
}
att.Desc_Cons = {
}
att.Desc_Neutrals = {
}
att.Slot = "ud_1014_barrel"

att.AutoStats = true

att.Mult_AccuracyMOA = 1.5
att.Mult_Recoil = 1.1
att.Mult_Range = 0.8

att.Mult_Sway = 0.75
att.Mult_SightTime = 0.75
att.Mult_SpeedMult = 1.025
att.Mult_ShootSpeedMult = 1.1

att.Mult_HipDispersion = 0.75

att.Add_BarrelLength = -4

att.ActivateElements = {"ud_autoshotgun_barrel_short"}
--lua/arccw/shared/attachments/ud_m16_charm_tl.lua:
return gluapack()()
--lua/arccw/shared/attachments/ud_m16_hg_lmg.lua:
return gluapack()()
--lua/arccw/shared/attachments/ud_m16_mag_60.lua:
att.PrintName = "STANAG 60-Round Casket Mag"
att.AbbrevName = "60-Round Casket Mag"
att.SortOrder = 60
att.Icon = Material("entities/att/acwatt_ud_m16_mag_60.png", "smooth mips")
att.Description = "Quad-stacked magazine for the M16. Quite bulky, but provides double the ammo capacity of a typical STANAG magazine. Has a tendency to jam."
att.Desc_Pros = {}
att.Desc_Cons = {
    "uc.jam"
}
att.Desc_Neutrals = {}
att.Slot = "ud_m16_mag"

att.AutoStats = true
att.HideIfBlocked = true

att.Override_ClipSize = 60

att.Mult_SightTime = 1.2
att.Mult_ReloadTime = 1.3
att.Mult_Sway = 2

att.Mult_SpeedMult = 0.95
att.Mult_ShootSpeedMult = 0.9

att.Mult_DrawTime = 1.15
att.Mult_HolsterTime = 1.15

att.Mult_HipDispersion = 1.25

att.ActivateElements = {"ud_m16_mag_60"}

--[[]
att.Override_Jamming = true
att.Override_HeatCapacity = 300
att.Override_HeatDissipation = 5
att.Override_HeatDelayTime = 3
]]
att.Override_Malfunction = true
att.Mult_MalfunctionVariance = 1.25

att.Hook_SelectReloadAnimation = function(wep, anim)
    return anim .. "_60"
end

att.ExcludeFlags = {"m16_usas", "m16_9mm", "m16_50beo"}
--lua/arccw/shared/attachments/ud_m16_muzzle_607.lua:
att.PrintName = "Model 607 Moderator"
att.AbbrevName = "M607 Moderator"
att.Icon = Material("entities/att/acwatt_ud_m16_muzzle_607.png", "mips smooth")
att.Description = ""
att.Desc_Pros = {
    "uc.flashhider"
}
att.Desc_Cons = {
}
att.AutoStats = true
att.Slot = "ud_m16_muzzle"

att.SortOrder = -102

att.Model = "models/weapons/arccw/atts/fesiug_moderator_607.mdl"
att.ModelOffset = Vector(0.2, 0, 0)
att.ModelScale = Vector(1, 1, 1)
att.OffsetAng = Angle(0, 0, 0)

att.Add_BarrelLength = 4
att.Mult_Sway = 1.1
att.Mult_HipDispersion = 0.9

att.Mult_ShootPitch = 1.1
att.Mult_ShootVol = 0.75

att.AttachSound = "arccw_uc/common/gunsmith/suppressor_thread.ogg"
--lua/arccw/shared/attachments/ud_m16_receiver_a1.lua:
return gluapack()()
--lua/arccw/shared/attachments/ud_m16_rs.lua:
att.PrintName = "Flip-up Rear Sight"
att.Icon = Material("entities/att/acwatt_ud_m16_rs.png", "smooth mips")
att.Description = "A rail-mounted rear sight for flat top receivers.\nLooks more modern, but that's it."
att.Desc_Pros = {}
att.Desc_Cons = {}
att.Desc_Neutrals = {
    "uc.cosmetic"
}
att.Slot = "ud_m16_rs"

att.ActivateElements = {"ud_m16_upper_flat"}
att.GivesFlags = {"ud_m16_not_retro"}
att.ExcludeFlags = {"ud_m16_retro"}
--att.HideIfBlocked = true

att.SortOrder = 1000
att.Free = true
att.IgnorePickX = true

att.MountPositionOverride = 0.5
att.IronSight = true
att.Override_IronSightStruct = {
    Pos = Vector(-2.80, 0, 0.85),
    Ang = Angle(1.05, 0, 0),
    Magnification = 1.1
}
att.Model = "models/weapons/arccw/atts/sig_rs.mdl"
att.ModelOffset = Vector(-2, -0.002, 0)
att.ModelScale = Vector(.86, .86, .86)

att.HideIfBlocked = true
--lua/arccw/shared/attachments/ud_m16_rs_ch.lua:
att.PrintName = "Carry Handle"
att.Icon = Material("entities/att/acwatt_ud_m16_rs_ch.png", "mips smooth")
att.Description = "Mountable carry handle that is independent from the receiver."
att.Desc_Pros = {}
att.Desc_Cons = {}
att.Desc_Neutrals = {
    "uc.cosmetic"
}
att.Slot = "ud_m16_rs"

att.ActivateElements = {"ud_m16_upper_flat"}
att.GivesFlags = {"ud_m16_not_retro"}
att.ExcludeFlags = {"ud_m16_retro"}
--att.HideIfBlocked = true

att.SortOrder = 1000
att.Free = true
att.IgnorePickX = true

att.MountPositionOverride = 0.64
att.IronSight = true
att.Override_IronSightStruct = {
    Pos = Vector(-2.80, 0, 1.11),
    Ang = Angle(0.4, 0, 0),
    Magnification = 1.1
}
att.Model = "models/weapons/arccw/atts/colt_ch.mdl"
att.ModelOffset = Vector(-2.2, -0.004, 0)
att.ModelScale = Vector(.78, .78, .78)

att.HideIfBlocked = true
--lua/arccw/shared/attachments/ud_m16_rs_magpul.lua:
att.PrintName = "Magpul Rear Sight"
att.Icon = Material("entities/att/acwatt_ud_m16_rs_magpul.png", "smooth mips")
att.Description = "Aftermarket rear sight for flat top receivers. Functionally identical to other iron sights, but may look more tactical (or mall-ninja, depending on your taste)."
att.Desc_Pros = {}
att.Desc_Cons = {}
att.Desc_Neutrals = {
    "uc.cosmetic"
}
att.Slot = "ud_m16_rs"

att.ActivateElements = {"ud_m16_upper_flat"}
att.GivesFlags = {"ud_m16_not_retro"}
att.ExcludeFlags = {"ud_m16_retro"}
--att.HideIfBlocked = true

att.SortOrder = 1000
att.Free = true
att.IgnorePickX = true

att.MountPositionOverride = 0.5
att.IronSight = true
att.Override_IronSightStruct = {
    Pos = Vector(-2.80, 0, 0.85),
    Ang = Angle(1.05, 0, 0),
    Magnification = 1.1
}
att.Model = "models/weapons/arccw/atts/magpul_rs.mdl"
att.ModelOffset = Vector(-1.5, -0.005, 0)
att.ModelScale = Vector(0.87, 0.87, 0.87)

att.HideIfBlocked = true
--lua/arccw/shared/attachments/ud_m16_rs_sclr.lua:
att.PrintName = "Scalarworks Rear Sight"
att.Icon = Material("entities/att/acwatt_ud_m16_rs_sclr.png", "mips smooth")
att.Description = "Aftermarket rear sight for flat top receivers. Functionally identical to other iron sights, but may look more tactical (or mall-ninja, depending on your taste)."
att.Desc_Pros = {}
att.Desc_Cons = {}
att.Desc_Neutrals = {
    "uc.cosmetic"
}
att.Slot = "ud_m16_rs"

att.ActivateElements = {"ud_m16_upper_flat"}
att.GivesFlags = {"ud_m16_not_retro"}
att.ExcludeFlags = {"ud_m16_retro"}
--att.HideIfBlocked = true

att.SortOrder = 1000
att.Free = true
att.IgnorePickX = true

att.MountPositionOverride = 0.5
att.IronSight = true
att.Override_IronSightStruct = {
    Pos = Vector(-2.80, 0, 0.85),
    Ang = Angle(1.05, 0, 0),
    Magnification = 1.1
}
att.Model = "models/weapons/arccw/atts/scalerworks_rs.mdl"
att.ModelOffset = Vector(-3, 0, -0.1)
att.ModelScale = Vector(1.17, 1.17, 1.17)

att.HideIfBlocked = true
--lua/arccw/shared/attachments/ud_m16_stock_231.lua:
att.PrintName = "AMCAR 231 Wire Stock"
att.AbbrevName = "M231 Wire Stock"

if GetConVar("arccw_truenames"):GetBool() then
    att.PrintName = "M16 M231 Wire Stock"
end

att.Icon = Material("entities/att/acwatt_ud_m16_stock_231.png", "smooth mips")
att.Description = "Wire stock used on the M231 FPW that provides some semblance of recoil control. Can be made even more agile by collapsing, improving point-shooting capabilities at the cost of recoil control.\n\nToggling this stock modifies performance accordingly."
att.Desc_Pros = {
}
att.Desc_Cons = {
}
att.Desc_Neutrals = {
}
att.Slot = "ud_m16_stock"

att.AutoStats = true
att.SortOrder = 3

att.Mult_SightTime = 0.75
att.Mult_Recoil = 1.25

att.Add_BarrelLength = -4

att.Mult_DrawTime = 0.75
att.Mult_HolsterTime = 0.75

att.ToggleSound = "arccw_uc/common/stockslide.ogg"

att.ToggleLockDefault = true
att.ToggleStats = {
    {
        PrintName = "Extended",
        AutoStats = true,
        ActivateElements = {"stock_231_ex"},
    },
    {
        PrintName = "Collapsed",
        AutoStats = true,
        Mult_HipDispersion = 0.6,
        Mult_MoveDispersion = 0.6,
        Mult_RecoilSide = 2,
        ActivateElements = {"stock_231_in"},
    },
}
--lua/arccw/shared/attachments/ud_m16_stock_adar.lua:
return gluapack()()
--lua/arccw/shared/attachments/ud_m16_stock_carbine.lua:
att.PrintName = "AMCAR Carbine Stock"
att.AbbrevName = "Carbine Stock"

if GetConVar("arccw_truenames"):GetBool() then
    att.PrintName = "M16 Carbine Stock"
end

att.Icon = Material("entities/att/acwatt_ud_m16_stock_carbine.png", "smooth mips")
att.Description = "Adjustable combat stock used on the XM177 carbine. When collapsed, it allows the user to move swiftly in close quarters; when extended, it functions similarly to a full stock.\n\nToggling this stock modifies performance accordingly."
att.Desc_Pros = {
}
att.Desc_Cons = {
}
att.Desc_Neutrals = {
}
att.Slot = "ud_m16_stock"

att.AutoStats = true
att.SortOrder = 6.5

att.Mult_Sway = 1.25
att.Mult_SightedSpeedMult = 1.15

att.ToggleSound = "arccw_uc/common/stockslide.ogg"

att.ToggleLockDefault = true
att.ToggleStats = {
    {
        PrintName = "Extended",
        AutoStats = true,
        ActivateElements = {"stock_carbine_ex"},
    },
    {
        PrintName = "Collapsed",
        AutoStats = true,
        ActivateElements = {"stock_carbine_in"},
        Mult_RecoilSide = 1.5,
        Add_BarrelLength = -4,
        Mult_ShootSpeedMult = 1.1,
        Mult_SightTime = 0.9,
    },
}
--lua/arccw/shared/attachments/ud_m16_stock_ru556.lua:
att.PrintName = "RU556 Fixed-Adjustable Stock"
att.AbbrevName = "Fixed-Adjustable Stock"

if GetConVar("arccw_truenames"):GetBool() then
    att.PrintName = "Magpul UBR GEN2 Stock"
end
att.Icon = Material("entities/att/acwatt_ud_m16_stock_ru556.png", "smooth mips")
att.Description = "Polymer sliding stock attached from underneath the buffer tube. Allows for better weapon control when moving."
att.Desc_Pros = {
    --"uc.auto"
}
att.Desc_Cons = {
}
att.Desc_Neutrals = {
}
att.Slot = "ud_m16_stock"

att.AutoStats = true
att.SortOrder = 5

att.Mult_MoveDispersion = 0.6
att.Mult_SightedSpeedMult = 1.15

att.Mult_RecoilSide = 1.1
att.Mult_Recoil = 1.15
att.Mult_Sway = 1.25

att.ActivateElements = {"stock_ru556"}
--lua/arccw/shared/attachments/ud_uzi_body_civvy.lua:
return gluapack()()
--lua/arccw/shared/attachments/ud_uzi_body_mini.lua:
return gluapack()()
--lua/arccw/shared/attachments/ud_uzi_body_mini.lua:
att.PrintName = "Uzi 8\" Mini Barrel"
att.AbbrevName = "8\" Mini Barrel"

if !GetConVar("arccw_truenames"):GetBool() then
    att.PrintName = "STAP 8\" Mini Barrel"
end

att.Icon = Material("entities/att/acwatt_ud_uzi_body_mini.png", "smooth mips")
att.Description = "Compact frame with a higher firerate."
att.Desc_Pros = {
}
att.Desc_Cons = {
}
att.Desc_Neutrals = {
}
att.Slot = "ud_uzi_frame"

att.AutoStats = true
att.SortOrder = 8

att.Mult_AccuracyMOA = 1.25
att.Mult_SightTime = 0.85
att.Mult_Recoil = 1.5
att.Mult_RecoilSide = 1.15
att.Mult_RPM = 1.25
att.Mult_Range = 0.75
att.Mult_HipDispersion = 1.25

att.Add_BarrelLength = -4

att.Mult_TriggerDelayTime = 0.75

att.LHIK = true

att.Override_HoldtypeActive = "pistol"
att.Override_HoldtypeSights = "revolver"

att.Model = "models/weapons/arccw/atts/tactical_lhik.mdl"
att.ModelOffset = Vector(2, -4.1, -1.9)
att.OffsetAng = Angle(10, 5, 0)

att.ActivateElements = {"ud_uzi_body_mini"}
--lua/arccw/shared/attachments/ur_1911_cal_10auto.lua:
return gluapack()()
--lua/arccw/shared/attachments/ur_1911_skin_silver.lua:
att.PrintName = "M1911 Silver Finish"
att.AbbrevName = "Silver"
att.Icon = Material("entities/att/ur_1911/skin_silver.png","mips smooth")
att.Description = "This gun may be old, but it will never be out of style."
att.SortOrder = 9

att.Desc_Neutrals = {
    "uc.cosmetic"
}

att.AutoStats = true
att.Slot = "ur_m1911_skin"
att.Free = true

--lua/arccw/shared/attachments/ur_1911_skin_tan.lua:
return gluapack()()
--lua/arccw/shared/attachments/ur_ak_barrel_105.lua:
att.PrintName = "AK-105 12\" Carbine Barrel"
att.AbbrevName = "12\" Carbine Barrel"
att.Icon = Material("entities/att/ur_ak/barrel/105.png", "mips smooth")
att.Description = "Reduced length barrel that serves as a middle ground between full-size and SMG-length barrels. Reduces weight and profile while keeping the weapon accurate and controllable."
att.Slot = {"ur_ak_barrel"}
att.AutoStats = true

if !GetConVar("arccw_truenames"):GetBool() then
    att.PrintName = "KF-104 12\" Carbine Barrel"
end

att.SortOrder = 12

att.Mult_Sway = .85
att.Mult_SightTime = .8
att.Add_BarrelLength = -3
att.Mult_SightedSpeedMult = 1.05

att.Mult_Recoil = 1.3
att.Mult_AccuracyMOA = 1.5
att.Mult_Range = .75
att.Mult_RPM = 625/600
att.Mult_ShootPitch = 105/100

-- att.ToggleLockDefault = true
-- att.ToggleStats = {
--     {
--         PrintName = "Black",
--         ActivateElements = {"barrel_105"},
--     },
--     {
--         PrintName = "Plum",
--         ActivateElements = {"barrel_105_red"},
--     },
--     {
--         PrintName = "Olive Drab",
--         ActivateElements = {"barrel_105_green"},
--     },
-- }

att.ActivateElements = {"barrel_105"}
att.GivesFlags = {"ak_barrelchange","nodong"}
--lua/arccw/shared/attachments/ur_ak_cal_545.lua:
att.PrintName = "AK-74 5.45x39mm Receiver"
att.AbbrevName = "5.45x39mm Receiver"

if !GetConVar("arccw_truenames"):GetBool() then
    att.PrintName = "KF-76 5.45x39mm Receiver"
end

att.Icon = Material("entities/att/uc_bullets/545x39.png", "mips smooth")
att.Description = "Lighter, more accurate cartridge that maintains wounding potential up close, but lacks penetration."
att.Slot = {"ur_ak_cal"}
att.AutoStats = true

att.SortOrder = 10

att.Override_Ammo = "smg1"
att.Override_Trivia_Calibre = "5.45x39mm Soviet"

att.Mult_Range = 1.2
att.Mult_RPM = 1.083 -- 650 rpm
att.Mult_SightedSpeedMult = 1.05
att.Mult_ReloadTime = .95
att.Mult_Recoil = .85
att.Mult_AccuracyMOA = .85
att.Mult_HipDispersion = .75

att.Mult_Penetration = .65
att.Mult_DamageMin = .8
att.Mult_Damage = .8
att.ShootPitchVariation = 1
att.Override_ShellModel = "models/weapons/arccw/uc_shells/545x39.mdl"
att.Override_ShellScale = 0.666
att.GivesFlags = {"cal_545"}

att.ActivateElements = {"mag_545_30"}
local path = ")weapons/arccw_ur/ak/545_39/"
local path1 = ")weapons/arccw_ur/ak/"
local tail = ")/arccw_uc/common/556x45/"
local fire545dist = {tail .. "fire-dist-556x45-rif-ext-01.ogg",tail .. "fire-dist-556x45-rif-ext-02.ogg",tail .. "fire-dist-556x45-rif-ext-03.ogg",tail .. "fire-dist-556x45-rif-ext-04.ogg",tail .. "fire-dist-556x45-rif-ext-05.ogg",tail .. "fire-dist-556x45-rif-ext-06.ogg"}
local fire545 = {path .. "fire-01.ogg", path .. "fire-02.ogg", path .. "fire-03.ogg", path .. "fire-04.ogg", path .. "fire-05.ogg", path .. "fire-06.ogg"}
local fire545supp = {path .. "fire-sup-01.ogg", path .. "fire-sup-02.ogg", path .. "fire-sup-03.ogg", path .. "fire-sup-04.ogg", path .. "fire-sup-05.ogg", path .. "fire-sup-06.ogg"}

att.Hook_GetShootSound = function(wep, fsound)
    if wep:GetBuff_Override("Silencer") then
        return fire545supp
    else
        return fire545
    end
end


att.Hook_GetDistantShootSoundOutdoors = function(wep, distancesound)
    if wep:GetBuff_Override("Silencer") then
        -- fallback to script
    else
        return fire545dist
    end
end

local slotinfo = {
    [6] = {"30-Round Mag", "30-Round Mag", Material("entities/att/ur_ak/magazines/545_30.png", "mips smooth")},
}
att.Hook_GetDefaultAttName = function(wep, slot)
    if slotinfo[slot] then
        return GetConVar("arccw_truenames"):GetBool() and slotinfo[slot][2] or slotinfo[slot][1]
    end
end
att.Hook_GetDefaultAttIcon = function(wep, slot)
    if slotinfo[slot] then
        return slotinfo[slot][3]
    end
end
--lua/arccw/shared/attachments/ur_ak_hg_vepr.lua:
return gluapack()()
--lua/arccw/shared/attachments/ur_ak_muzzle_bayonet.lua:
att.PrintName = "Type 2 Bayonet"
att.Icon = Material("entities/att/ur_ak/acwatt_ur_ak_muzzle_bayonet.png", "mips smooth")
att.Description = "External bayonet unique to early AK-pattern rifles. Wide and sharp, it's a bit bulky but allows for a devastating melee attack."
att.AutoStats = true
att.Slot = {"ur_ak_muzzle"}

att.SortOrder = 997

att.Add_MeleeRange = 16
att.Mult_MeleeDamage = 3.5
att.Mult_MeleeWaitTime = 2
att.Add_BarrelLength = 10
att.Mult_Sway = 1.4
att.Mult_SightTime = 1.1
att.Mult_MeleeTime = 1.1

att.Override_BashPreparePos = Vector(4, -5, -1.8)
att.Override_BashPrepareAng = Angle(-15, -5, -5)
att.Override_BashPos = Vector(-1, 12, 4.5) -- i'm too impatient to not make this bat you in the face with the stock
att.Override_BashAng = Angle(-7, 3, 25)

att.Hook_SelectBashAnim = function(wep,anim)
    return "bash_bayonet"
end

att.AttachSound = "arccw_uc/common/gunsmith/suppressor_thread.ogg"
att.ActivateElements = {"muzzle_bayonet"}
att.GivesFlags = {"ak_bayonet2"}
att.ExcludeFlags = {"ak_barrelchange","ak_bayonet1"}
--lua/arccw/shared/attachments/ur_ak_stock_underfolder.lua:
return gluapack()()
--lua/arccw/shared/attachments/ur_aw_mag_10m.lua:
return gluapack()()
--lua/arccw/shared/attachments/ur_aw_skin_tan.lua:
att.PrintName = "Flat Dark Earth Finish"
att.AbbrevName = "Flat Dark Earth"
att.Icon = Material("entities/att/ur_aw/skin_tan.png", "mips smooth")
att.Description = "The fury of the sandstorm, realized."
att.Slot = "ur_aw_skin"
att.Desc_Neutrals = {
    "uc.cosmetic"
}
att.SortOrder = 1

att.IgnorePickX = true
att.ActivateElements = {"skin_tan"}
--lua/arccw/shared/attachments/ur_aw_stock_fixed.lua:
att.PrintName = "Fixed Stock"
att.Description = "Variant, one-piece stock without a hinge for folding. More rigid than side-folding stocks, but the lack of folding makes it harder to conceal."
att.Icon = Material("entities/att/ur_aw/stock_nonfold.png", "mips smooth")
att.Slot = {"ur_aw_stock"}
att.AutoStats = true

att.SortOrder = 3

att.Mult_Sway = .85
att.Mult_DrawTime = 1.2

att.ActivateElements = {"stock_fixed"}
--lua/arccw/shared/attachments/ur_dbs_barrel_compact.lua:
return gluapack()()
--lua/arccw/shared/attachments/ur_deagle_barrel_compen.lua:
return gluapack()()
--lua/arccw/shared/attachments/ur_g3_barrel_8.lua:
return gluapack()()
--lua/arccw/shared/attachments/ur_g3_bayobipod_bayonet.lua:
att.PrintName = "G3 Bayonet"
att.AbbrevName = "Muzzle Bayonet"

if !GetConVar("arccw_truenames"):GetBool() then
    att.PrintName = "G58 Bayonet"
end

att.Icon = false
att.Description = "Bayonet"
att.Slot = "ur_g3_bayobipod"
att.SortOrder = 999

att.IgnorePickX = true
att.Ignore = true
--lua/arccw/shared/attachments/ur_g3_stock_rucar.lua:
att.PrintName = "RU556 Fixed-Adjustable Stock"
att.AbbrevName = "Fixed-Adjustable Stock"
att.Icon = Material("entities/att/ur_g3/stock_ar.png","smooth mips")
if GetConVar("arccw_truenames"):GetBool() then
    att.PrintName = "Magpul UBR GEN2 Stock"
end

att.Description = [[AR-style buffer tube adapter fit with an adjustable aftermarket stock. Improves weapon control on the move, but lacks weight.]] -- i suggest you use settings from m16's fixed-adjustable stock
att.AutoStats = true
att.Slot = {"ur_g3_stock"}

att.SortOrder = 9

att.Mult_SpeedMult = 1.05
att.Mult_MoveDispersion = .6
att.Mult_SightTime = .9

att.Mult_Sway = 1.5
att.Mult_RecoilSide = 1.5
--lua/arccw/shared/attachments/ur_mp5_caliber_22lr.lua:
att.PrintName = "MP5 .22 LR Conversion"
att.AbbrevName = ".22 LR Receiver"

if !GetConVar("arccw_truenames"):GetBool() then
    att.PrintName = "PK5/22 .22 LR Conversion"
end

att.Description = "A semi-automatic civilian model of the MP5 rechambered in .22 Long Rifle.\nThe low lethality of the cartridge makes this unfit for tactical operations, but far more fun to plink with."

att.Icon = Material("entities/att/uc_bullets/22lr.png", "smooth mips")
att.Desc_Pros = {
}
att.Desc_Cons = {
}
att.Desc_Neutrals = {
}
att.Slot = "ur_mp5_caliber"

att.AutoStats = true
att.SortOrder = -1

att.Override_Trivia_Calibre = ".22 Long Rifle"
att.Override_Ammo = "plinking"

att.Mult_Damage = 0.4
att.Mult_DamageMin = 0.4
att.Mult_Penetration = 3 / 6

att.Mult_Recoil = 0.25
att.Mult_VisualRecoilMult = 0.25
--att.Mult_RPM = 1.25
att.Mult_Penetration = 0.1
att.Mult_ShootSpeedMult = 1.2


att.Override_PhysBulletMuzzleVelocity = 320
att.Mult_HipDispersion = 0.75

att.Mult_ClipSize = 1.2

att.Override_ShellModel = "models/weapons/arccw/uc_shells/22lr.mdl"
att.Override_ShellScale = 1
att.Override_ShellSounds = ArcCW.TinyShellSoundsTable

local path = "arccw_uc/common/"

local fire22 = {path .. "fire-22-01.ogg",path .. "fire-22-02.ogg",path .. "fire-22-03.ogg",path .. "fire-22-04.ogg",path .. "fire-22-05.ogg",path .. "fire-22-06.ogg"}
local fire22sup = {path .. "fire-22-sup-01.ogg",path .. "fire-22-sup-02.ogg",path .. "fire-22-sup-03.ogg",path .. "fire-22-sup-04.ogg",path .. "fire-22-sup-05.ogg",path .. "fire-22-sup-06.ogg"}

att.Hook_GetShootSound = function(wep, sound)
    if wep:GetBuff_Override("Silencer") then
        return fire22sup
    else
        return fire22
    end
end

local fire22dist = {path .. "fire-22-dist-01.ogg", path .. "fire-22-dist-02.ogg", path .. "fire-22-dist-03.ogg", path .. "fire-22-dist-04.ogg", path .. "fire-22-dist-05.ogg", path .. "fire-22-dist-06.ogg"}

att.Hook_GetDistantShootSoundOutdoors = function(wep, distancesound)
    if wep:GetBuff_Override("Silencer") then
        -- fallback to script
    else
        return fire22dist
    end
end


local fire22distint = {path .. "fire-dist-int-pistol-light-01.ogg", path .. "fire-dist-int-pistol-light-02.ogg", path .. "fire-dist-int-pistol-light-03.ogg", path .. "fire-dist-int-pistol-light-04.ogg", path .. "fire-dist-int-pistol-light-05.ogg", path .. "fire-dist-int-pistol-light-06.ogg"}

att.Hook_GetDistantShootSoundIndoors = function(wep, distancesound)
    if wep:GetBuff_Override("Silencer") then
        -- fallback to script
    else
        return fire22distint
    end
end

att.GivesFlags = {"ur_mp5_cal_22lr"}


att.Override_Firemodes_Priority = 0.5
att.Override_Firemodes = {
    {
        Mode = 1,
    },
    {
        Mode = 0
    }
}

att.ActivateElements = {"receiver_lower_semi"}
--lua/arccw/shared/attachments/ur_mp5_caliber_semi.lua:
return gluapack()()
--lua/arccw/shared/attachments/ur_mp5_ub_ris.lua:
att.PrintName = "RIS Handguard"

att.Icon = Material("entities/att/ur_mp5/hg_pica.png", "smooth mips")
att.Description = "Alternative handguard with a tacticool picatinny rail interface. Does not have any tacticool benefits."
att.Desc_Neutrals = {
    "uc.cosmetic"
}
att.AutoStats = true

att.Slot = "ur_mp5_hg"
att.SortOrder = 997


att.IgnorePickX = true
att.ActivateElements = {"ur_mp5_rail_fg"}
att.ExcludeFlags = {"barrel_sd","mp5_kurz"}
--lua/arccw/shared/attachments/ur_spas12_stock_in.lua:
return gluapack()()
--lua/arccw/shared/attachments/ur_spas12_stock_in.lua:
att.PrintName = "Folded Stock"
att.Icon = Material("entities/att/ur_spas/stock_fold.png", "smooth mips")
att.Description = [[Folding the stock makes the weapon significantly shorter, allowing for easier use around corners and making it easier on the move at the cost of less stability.

Contrary to some depictions, the stock obstructs iron sights when folded.]]
att.Desc_Pros = {
}
att.Desc_Cons = {
    "ur.spas12.folded",
}
att.Desc_Neutrals = {
}
att.Slot = "ur_spas12_stock"
att.AttachSound = "arccw_uc/common/stockslide.ogg"

att.AutoStats = true
att.Free = true
att.IgnorePickX = true

att.Mult_Recoil = 1.2
att.Mult_RecoilSide = 1.5

att.Mult_SightedSpeedMult = 1.1
att.Mult_ShootSpeedMult = 1.1
att.Mult_SightTime = 0.5

att.Mult_Sway = 2
att.Add_BarrelLength = -12

att.Override_IronSightStruct = {
    Pos = Vector(-1.1, -2, -1.1),
     Ang = Angle(3, 1.5, 0),
     Magnification = 1.075,
     SwitchToSound = "",
     CrosshairInSights = true,
}

att.Hook_TranslateAnimation = function(wep,anim)
    if string.StartWith(anim,"sgreload") then
        return anim .. "_fold"
    end
end

att.Override_HoldtypeActive = "shotgun"
att.Override_HoldtypeSights = "ar2"

att.A_Hook_Add_SightsDispersion = function(wep, data)
    if data and !wep.Attachments[1].Installed then
        data.add = data.add + 75
    end
end

att.GivesFlags = {"spas12_foldstock"}
--lua/arccw/shared/attachments/ur_spas12_stock_none.lua:
return gluapack()()
--lua/arccw/shared/languages/uc_en.lua:
L = {}

L["uc.title"] = "Urban Coalition"

L["uc.auto"] = "Fully automatic fire"
L["uc.3burst"] = "3-round burst fire"
L["uc.semionly"] = "Semi-automatic fire only"
L["uc.manual"] = "Weapon becomes manual action"
L["uc.manualonly"] = "Manual action only"
L["uc.nofs"] = "Inaccurate without optics"
L["uc.altnofs"] = "Inaccurate without optics. Too bad you can't equip any!"
L["uc.overheat"] = "Will overheat under sustained use"
L["uc.jam"] = "Will occasionally jam"
L["uc.homeboy"] = "Recoil becomes diagonal"
L["uc.pointman"] = "+15% Fire rate on semi-automatic weapons"
L["uc.match.1"] = "-25% Recoil for first shot"
L["uc.match.2"] = "-50% Trigger delay time"
L["uc.slam"] = "Slamfire firemode"
L["uc.invistracer"] = "Invisible tracers"
L["uc.frcd_visrec"] = "+100% Visual recoil"
L["uc.frcd_burst"] = "Worse performance on burst-fire weapons"
L["uc.cosmetic"] = "This attachment is entirely cosmetic."
L["uc.dualstage.pro"] = "-100% Trigger delay time"
L["uc.dualstage.con"] = "+0.1s Delay on first shot"--"-25% Fire rate for first shot"
L["uc.operator"] = "-80% Visual recoil"
L["uc.overload"] = "+1 Magazine capacity"
L["uc.underload"] = "-14% Magazine capacity"
L["uc.loosesprings"] = "+8% Magazine capacity"
L["uc.neverflinch"] = "No shooting movement speed loss"
L["uc.tracer"] = "Visible bullet trail"
L["uc.lowind"] = "Low ammo indication"
L["uc.alwaysphys"] = "Bullet has travel time"
L["uc.explode"] = "Blast damage on hit"
L["uc.reqslug"] = "Only usable with slug ammo types"
L["uc.oneprojectile"] = "One projectile"
L["uc.bus"] = "Double-tap +USE to toggle backup sights"
L["uc.light"] = "Increased visibility"
L["uc.technician"] = "-35% Malfunction fix time"
L["uc.flashhider"] = "Reduced muzzle flash"
L["uc.dragon"] = "Increased muzzle flash"
L["uc.subsonic"] = "No distant tail when suppressed"
L["uc.subsonic.vel"] = "339m/s Muzzle velocity"
L["uc.api.1"] = "Increased damage to objects"
L["uc.api.2"] = "Deals fire damage"
L["uc.swapreticle"] = "Double-tap +USE to toggle reticles"
L["uc.infiniteammo"] = "Infinite ammo"
L["uc.noprojectile"] = "No projectile"
L["uc.baton"] = "Target may drop their weapon"
L["uc.ignite"] = "Ignites targets"
L["uc.custcolor"] = "Use the menu in \"Utilities -> ArcCW -> Urban Coalition\" to modify color."
L["uc.supptail"] = "No distant tail if muzzle velocity < 340m/s"
L["uc.ubgl"] = "Underbarrel grenade launcher"
L["uc.confetti"] = "Pretty"

L["uc.nooptics"] = "Disables Optic attachments"
L["uc.noubs"] = "Disables Underbarrel attachments"
L["uc.nostocks"] = "Disables Stock attachments"
L["uc.nomuzzle"] = "Disables Muzzle attachments"
L["uc.nogrip"] = "Disables Grip Type attachments"
L["uc.nopowder"] = "Disables Powder Load attachments"
L["uc.muzzleblocking"] = "Incompatible with certain Tube and Barrel combinations"
L["uc.nohg"] = "Disables Handguard attachments"

L["uc.exclusive.pistol"] = "Exclusive to small caliber firearms"
L["uc.exclusive.rifle"] = "Exclusive to medium caliber firearms"
L["uc.exclusive.shotgun"] = "Exclusive to shotguns"
L["uc.exclusive.762"] = "Exclusive to Eastern rifle caliber firearms"
L["uc.exclusive.545"] = "Exclusive to Eastern carbine caliber firearms"
L["uc.exclusive.subsonic"] = "Exclusive to small caliber firearms with < 340m/s muzzle velocity"

L["uc.pellet.0.75"] = "-25% Pellets per shot"
L["uc.pellet.2x"] = "+100% Pellets per shot"
L["uc.pellet.8"] = "+8 Pellets per shot"
L["uc.pellet.12"] = "+12 Pellets per shot"
L["uc.pellet.24"] = "+24 Pellets per shot"
L["uc.penetration.8"] = "+8mm Penetration"
L["uc.penetration.12"] = "+12mm Penetration"
L["uc.sightdisp.50"] = "+50 MOA Dispersion in sights"
L["uc.disp.50"] = "+50 MOA Dispersion"
L["uc.disp.100"] = "+100 MOA Dispersion"
L["uc.accuracy.10"] = "+10 MOA Imprecision"
L["uc.accuracy.20"] = "+20 MOA Imprecision"
L["uc.accuracy.35"] = "+35 MOA Imprecision"

L["uc.40mm.nodmg"] = "No blast damage"
L["uc.40mm.mindmg"] = "Minimal blast damage"
L["uc.40mm.buckshot"] = "Fires pellets instead of a projectile"
L["uc.40mm.hornet"] = "Fires bullets instead of a projectile"
L["uc.40mm.incendiary"] = "Creates fire on detonation"
L["uc.40mm.napalm"] = "Creates napalm on detonation"
L["uc.40mm.flash"] = "Blinds targets on detonation"
L["uc.40mm.smoke"] = "Creates smokescreen on detonation"
L["uc.40mm.impact"] = "High impact damage"
L["uc.40mm.hedp"] = "Penetrates walls on impact"
L["uc.40mm.airburst"] = "Creates shrapnel on detonation"
L["uc.40mm.proximity"] = "Projectile detonates by proximity"
L["uc.40mm.arm"] = "0.2 second arm time"
L["uc.40mm.drag.high"] = "Projectile has high drag"
L["uc.40mm.drag.low"] = "Projectile has low drag"
L["uc.40mm.blast.high"] = "Increased blast radius"
L["uc.40mm.blast.low"] = "Reduced blast radius"

L["fcg.slam"] = "Slam-fire"
L["fcg.slam.abbrev"] = "SLAM"
L["fcg.frcd"] = "Forced-reset"
L["fcg.frcd.abbrev"] = "FRCD"
--addons/[binbon]arccw_modify/lua/arccw/client/cl_blacklist.lua:
local srf      = surface



local function ScreenScaleMulti(input)
    return ScreenScale(input) * ArcCW.ConVars["hud_size"]:GetFloat()
end

local blacklistWindow = nil
local blacklistTbl    = {}
local filter          = ""
local onlyblacklisted = false
local internalName    = false
local dragMode = nil

local color_arccwbred = Color(150, 50, 50, 255)
local color_arccwlred = Color(125, 25, 25, 150)
local color_arccwdred = Color(75, 0, 0, 150)
local color_arccwdtbl = Color(0, 0, 0, 200)

local function SaveBlacklist()
    -- We send ID over instead of strings to save on network costs
    -- optimization_is_optimization.png

    local blacklistAmt = 0

    for attName, bStatus in pairs(blacklistTbl) do
        if bStatus then blacklistAmt = blacklistAmt + 1 end
    end

    net.Start("arccw_blacklist")
        net.WriteBool(false)
        net.WriteUInt(blacklistAmt, ArcCW.GetBitNecessity())
        for attName, bStatus in pairs(blacklistTbl) do
            if bStatus then
                net.WriteUInt(ArcCW.AttachmentTable[attName].ID, ArcCW.GetBitNecessity())
            end
        end
    net.SendToServer()

    blacklistTbl = {}
end

local function CreateAttButton(parent, attName, attTbl)
    local attBtn = vgui.Create("DButton", parent)
    attBtn:SetFont("ArcCW_8")
    attBtn:SetText("")
    attBtn:SetSize(ScreenScaleMulti(256), ScreenScaleMulti(16))
    attBtn:Dock(TOP)
    attBtn:DockMargin(ScreenScaleMulti(36), ScreenScaleMulti(1), ScreenScaleMulti(36), ScreenScaleMulti(1))
    attBtn:SetContentAlignment(5)

    attBtn.Paint = function(spaa, w, h)
        local blisted = blacklistTbl[attName]
        if blisted == nil then blisted = attTbl.Blacklisted end

        local hovered = spaa:IsHovered()
        local blackhov = blisted and hovered

        local Bfg_col = blackhov and color_arccwbred or blisted and color_arccwbred or hovered and color_black or color_white
        local Bbg_col = blackhov and color_arccwlred or blisted and color_arccwdred or hovered and color_white or color_arccwdtbl

        srf.SetDrawColor(Bbg_col)
        srf.DrawRect(0, 0, w, h)

        local img = attTbl.Icon
        if img then
            srf.SetDrawColor(Bfg_col)
            srf.SetMaterial(img)
            srf.DrawTexturedRect(ScreenScaleMulti(2), 0, h, h)
        end

        local txt = attTbl.PrintName
        if internalName then txt = attName end
        srf.SetTextColor(Bfg_col)
        srf.SetTextPos(ScreenScaleMulti(20), ScreenScaleMulti(2))
        srf.SetFont("ArcCW_12")
        srf.DrawText(txt)

        local listed   = (blacklistTbl[attName] and !attTbl.Blacklisted)
        local unlisted = (attTbl.Blacklisted and !blacklistTbl[attName])
        local saved = (listed or unlisted) and " [not saved]" or ""
        srf.SetTextColor(Bfg_col)
        srf.SetTextPos(spaa:GetWide() - ScreenScaleMulti(36), ScreenScaleMulti(4))
        srf.SetFont("ArcCW_8")
        srf.DrawText(saved)
    end

    -- In addition to clicking on a button, you can drag over all of them!
    attBtn.OnMousePressed = function(spaa, kc)
        blacklistTbl[attName] = !blacklistTbl[attName] and !attTbl.Blacklisted or !blacklistTbl[attName]
        dragMode = blacklistTbl[attName]
        hook.Add("Think", "ArcCW_Blacklist", function()
            if !input.IsMouseDown(MOUSE_LEFT) then
                dragMode = nil
                hook.Remove("Think", "ArcCW_Blacklist")
            end
        end)
    end
    attBtn.OnCursorEntered = function(spaa, kc)
        if dragMode != nil and input.IsMouseDown(MOUSE_LEFT) then
            blacklistTbl[attName] = dragMode
        end
    end

    return attBtn
end

function ArcCW.MakeBlacklistWindow()
    if blacklistWindow then blacklistWindow:Remove() end

    blacklistTbl = {}

    blacklistWindow = vgui.Create("DFrame")
    blacklistWindow:SetSize(ScrW() * 0.5, ScrH() * 0.75)
    blacklistWindow:Center()
    blacklistWindow:SetTitle("")
    blacklistWindow:SetDraggable(false)
    blacklistWindow:SetVisible(true)
    blacklistWindow:ShowCloseButton(true)
    blacklistWindow:MakePopup()
    blacklistWindow.Paint = function(self, w, h)
        srf.SetDrawColor(color_arccwdtbl)
        srf.DrawRect(0, 0, w, h)
    end

    local title = vgui.Create("DLabel", blacklistWindow)
    title:SetSize(ScreenScaleMulti(256), ScreenScaleMulti(26))
    title:Dock(TOP)
    title:SetFont("ArcCW_24")
    title:SetText("ArcCW Blacklist")
    title:DockMargin(ScreenScaleMulti(16), 0, ScreenScaleMulti(16), ScreenScaleMulti(8))

    local desc = vgui.Create("DLabel", blacklistWindow)
    desc:SetSize(ScreenScaleMulti(256), ScreenScaleMulti(12))
    desc:Dock(TOP)
    desc:DockMargin(ScreenScaleMulti(4), 0, ScreenScaleMulti(4), ScreenScaleMulti(4))
    desc:SetFont("ArcCW_12")
    desc:SetText("Attachments checked here will stop showing up at all.")
    desc:SetContentAlignment(5)

    local attList = vgui.Create("DScrollPanel", blacklistWindow)
    attList:SetText("")
    attList:Dock(FILL)
    attList:SetContentAlignment(5)
    attList.Paint = function(span, w, h) end

    local sbar = attList:GetVBar()
    sbar.Paint = function() end
    sbar.btnUp.Paint = function(span, w, h) end
    sbar.btnDown.Paint = function(span, w, h) end
    sbar.btnGrip.Paint = function(span, w, h)
        srf.SetDrawColor(color_white)
        srf.DrawRect(0, 0, w, h)
    end

    local FilterPanel = vgui.Create("DPanel", blacklistWindow)
    FilterPanel:Dock(TOP)
    FilterPanel:DockMargin(ScreenScaleMulti(16), ScreenScaleMulti(2), ScreenScaleMulti(16), ScreenScaleMulti(2))
    FilterPanel:SetSize(ScreenScaleMulti(256), ScreenScaleMulti(12))
    FilterPanel:SetPaintBackground(false)

    local FilterLabel = vgui.Create("DLabel", FilterPanel)
    FilterLabel:Dock(LEFT)
    FilterLabel:SetWidth(ScreenScaleMulti(36))
    FilterLabel:DockMargin(ScreenScaleMulti(2), ScreenScaleMulti(2), ScreenScaleMulti(2), ScreenScaleMulti(2))
    FilterLabel:SetFont("ArcCW_12")
    FilterLabel:SetText("FILTER")

    local FilterButton = vgui.Create("DButton", FilterPanel)
    FilterButton:SetFont("ArcCW_8")
    FilterButton:SetText("")
    FilterButton:SetSize(ScreenScaleMulti(48), ScreenScaleMulti(12))
    FilterButton:Dock(RIGHT)
    FilterButton:DockMargin(ScreenScaleMulti(1), 0, 0, 0)
    FilterButton:SetContentAlignment(5)

    FilterButton.OnMousePressed = function(spaa, kc)
        onlyblacklisted = !onlyblacklisted

        attList:GenerateButtonsToList()
    end

    FilterButton.Paint = function(spaa, w, h)
        local hovered = spaa:IsHovered()

        local Bfg_col = hovered and color_black or color_white
        local Bbg_col = hovered and color_white or color_arccwdtbl

        srf.SetDrawColor(Bbg_col)
        srf.DrawRect(0, 0, w, h)

        spaa:SetTextColor(Bfg_col)
        spaa:SetText(onlyblacklisted and "BLACKLISTED" or "ALL")
    end

    local NameButton = vgui.Create("DButton", FilterPanel)
    NameButton:SetFont("ArcCW_8")
    NameButton:SetText("")
    NameButton:SetSize(ScreenScaleMulti(24), ScreenScaleMulti(12))
    NameButton:Dock(RIGHT)
    NameButton:DockMargin(ScreenScaleMulti(1), 0, 0, 0)
    NameButton:SetContentAlignment(5)

    NameButton.OnMousePressed = function(spaa, kc)
        internalName = !internalName
        attList:GenerateButtonsToList()
    end

    NameButton.Paint = function(spaa, w, h)
        local hovered = spaa:IsHovered()

        local Bfg_col = hovered and color_black or color_white
        local Bbg_col = hovered and color_white or color_arccwdtbl

        srf.SetDrawColor(Bbg_col)
        srf.DrawRect(0, 0, w, h)

        spaa:SetTextColor(Bfg_col)
        spaa:SetText(internalName and "ID" or "NAME")
    end

    local FilterEntry = vgui.Create("DTextEntry", FilterPanel)
    FilterEntry:Dock(FILL)
    FilterEntry:SetValue(filter)
    FilterEntry:SetFont("ArcCW_12")
    FilterEntry.OnChange = function( self )
        filter = self:GetValue():lower()

        attList:GenerateButtonsToList()
    end

    local accept = vgui.Create("DButton", blacklistWindow)
    accept:SetSize(ScreenScaleMulti(256), ScreenScaleMulti(20))
    accept:SetText("")
    accept:Dock(BOTTOM)
    accept:DockMargin(ScreenScaleMulti(48), ScreenScaleMulti(2), ScreenScaleMulti(48), ScreenScaleMulti(2))
    accept:SetContentAlignment(5)

    accept.OnMousePressed = function(spaa, kc)
        SaveBlacklist()

        blacklistWindow:Close()
        blacklistWindow:Remove()
    end

    accept.Paint = function(spaa, w, h)
        local hovered = spaa:IsHovered()

        local Bfg_col = hovered and color_black or color_white
        local Bbg_col = hovered and color_white or color_arccwdtbl

        srf.SetDrawColor(Bbg_col)
        srf.DrawRect(0, 0, w, h)

        srf.SetTextColor(Bfg_col)
        srf.SetTextPos(ScreenScaleMulti(4), ScreenScaleMulti(4))
        srf.SetFont("ArcCW_12")
        srf.DrawText("Save")
    end

    -- Perhaps unoptimized, but it's client
    -- client_side_calculations_is_not_expensive.png
    function attList:GenerateButtonsToList()
        self:GetCanvas():Clear()

        for attName, attTbl in SortedPairsByMemberValue(ArcCW.AttachmentTable, "PrintName") do
            if attTbl.Hidden then continue end

            if attTbl.Blacklisted then blacklistTbl[attName] = true end

            if onlyblacklisted and !(attTbl.Blacklisted or blacklistTbl[attName]) then continue end

            if filter != "" and !(string.find((attTbl.PrintName):lower(), filter) or string.find((attName):lower(), filter)) then continue end

            --if attTbl.Slot == "charm" then continue end why the fuck would you do this

            CreateAttButton(self, attName, attTbl)
        end
    end

    attList:GenerateButtonsToList()
end

concommand.Add("arccw_blacklist", function()
    if LocalPlayer():IsAdmin() then ArcCW.MakeBlacklistWindow() end
end)
--addons/[binbon]arccw_modify/lua/arccw/client/cl_hud.lua:
return gluapack()()
--addons/ashop/lua/ashop/code/giveaway/cl_init.lua:
return gluapack()()
--addons/ashop/lua/ashop/code/object_types/badges/sh_b.lua:
local OBJECT_TYPE = {}

OBJECT_TYPE.Name = "Badges"
OBJECT_TYPE.UniqueIdentifier = "Badges"

OBJECT_TYPE.ItemParameters = {
    [1] = {
        name = ashop.L('KillCard_1'),
        type = TYPE_STRING,
        options = {
            required = true
        }
    },

    [2] = {
        name = ashop.L('Description'),
        type = TYPE_STRING,
        options = {
            required = true
        }
    },
}

OBJECT_TYPE.DefaultRender = "Accessories"
OBJECT_TYPE.SlotDefault = 10

ashop.RegisterObjectType(OBJECT_TYPE)
--addons/ashop/lua/ashop/code/object_types/car_dealer/sh_cd.lua:
return gluapack()()
--addons/ashop/lua/ashop/code/object_types/car_skins/cl_carskin.lua:
local OBJECT_TYPE = {}

OBJECT_TYPE.Name = ashop.L('CarSkins')
OBJECT_TYPE.UniqueIdentifier = "CarSkin"

function OBJECT_TYPE.UI_FILL(plyItem, item, pnl, parent, w, h, noCircle, fullSize)
    local circleParent = vgui.Create("EditablePanel", pnl)
    circleParent:SetSize(w, h)
    circleParent:SetMouseInputEnabled(false)

    local c = fullSize and math.max(w, h) or math.max(w, h) * 0.4

    // What an hack...
    local SpawnI = vgui.Create( "DPanel" , circleParent ) -- SpawnIcon
    SpawnI:SetSize(c, c)
    SpawnI:Center()
    
    local r1
    function SpawnI:Paint(w, h)
        if !r1 then
            r1 = ashop.ui.RoundedBox(ashop.Config.round, 0, 0, w, h)
        end

        ashop.StartStencil()
            surface.SetDrawColor(1,1,1,1)
            draw.NoTexture()
            surface.DrawPoly(r1)
        ashop.ReplaceStencil(1)
            surface.SetDrawColor(255, 255, 255)
            surface.SetTexture(surface.GetTextureID(item.metadata[1]))
            surface.DrawTexturedRect(0, 0, w, h)
        ashop.EndStencil()
    end
end

function OBJECT_TYPE.OnEquip(ply, plyItem, item)
    if !item.metadata[1] then return end
    ply.ashop_carskin = item.metadata[1]
end

function OBJECT_TYPE.OnRemove(ply, plyItem, item)
    ply.ashop_carskin = nil
end


ashop.vehiclesSkinTrack = ashop.vehiclesSkinTrack or {}
hook.Add("PostRender", "ashop_setVehicleSkin", function()
    if table.IsEmpty(ashop.vehiclesSkinTrack) then return end

    for k, v in pairs(ashop.vehiclesSkinTrack) do
        v()
    end
end)

hook.Add('EntityRemoved', 'ashop_clearVehicleSkin', function(ent)
    ashop.vehiclesSkinTrack[ent] = nil
end)

net.Receive('ashop_CarMaterial_Ping', function()
    local ply = net.ReadEntity()
    local vehIndex = net.ReadUInt(13)
    local vehClass = net.ReadString()
    local n = 'ashop_waitveh_' .. ply:EntIndex()

    timer.Create(n, 0.25, 20, function()
        if !IsValid(ply) then
            timer.Remove(n)
            return
        end

        local veh = Entity(vehIndex)
        if IsValid(veh) and ashop.carmaterials then
            local vehSkinTable = ashop.carmaterials[vehClass]
            if !vehSkinTable then return end

            local b = ashop.GetObjectTypeIDByUID('CarSkin')
            local equipped = ply:AShop_SlotStateGet(b)
            local plyitemID = -1

            for k, v in pairs(equipped or {}) do
                local plyItem = ply.ashop_data.items[v]
                local item = ashop.items[plyItem.item_id]
    
                if !item.metadata[2] or table.IsEmpty(item.metadata[2]) then
                    plyitemID = v
                    break
                else
                    for _, d in ipairs(item.metadata[2]) do
                        if d[1] != vehClass then continue end
                        plyitemID = v
                        break
                    end
                end
            end

            // 76561198314224632
            local matToSet = plyitemID != -1 and ashop.items[ply.ashop_data.items[plyitemID].item_id].metadata[1] or ""

            if string.StartWith(matToSet, "ht") then
                ashop.ui.setMaterialByLink(matToSet, nil, function(m)
                    if isfunction(m) then
                        local oldMat

                        ashop.vehiclesSkinTrack[veh] = function()
                            local newMat = m()

                            if oldMat == newMat then return end

                            oldMat = newMat
                            local n = newMat:GetName()

                            for k, v in pairs(vehSkinTable) do
                                veh:SetSubMaterial(k, "!" .. n)
                            end
                        end
                    else
                        for i = 1, #veh:GetMaterials() do
                            veh:SetSubMaterial(i-1, vehSkinTable[i-1] and "!" .. m:GetName() or "")
                        end
                    end
                end, 'VertexLitGeneric')
            else
                for i = 1, #veh:GetMaterials() do
                    veh:SetSubMaterial(i-1, vehSkinTable[i-1] and matToSet or "")
                end
            end

            timer.Remove(n)
            return
        end
    end)
end)

ashop.RegisterObjectType(OBJECT_TYPE)
--addons/ashop/lua/ashop/code/object_types/car_skins/sh_carskin.lua:
return gluapack()()
--addons/ashop/lua/ashop/code/object_types/case_opening/sh_caseopening.lua:
local OBJECT_TYPE = {}

OBJECT_TYPE.Name = "Case Opening"
OBJECT_TYPE.DefaultRender = "Consumables"

OBJECT_TYPE.ItemParameters = {
    [1] = {
        name = "Model",
        type = 'SELECT',
        options = {
            selects = {
                {"Weapon case Crate", 'models/akulla/case/weapon-case.mdl'},
                {"Sci-Fi Crate", 'models/akulla/case/sci-fi.mdl'},
                {"Military Crate", 'models/akulla/case/military.mdl'}
            },

            outputType = TYPE_STRING,
            required = true,
        },
    },

    [2] = {
        name = "List of objects",
        type = 'LIST',
        options = {
            listObjects = {
                {"ITEMID", 'Item'},
                {"FLOAT", 'Drop rate'}
            },
            required = true
        },
    },

    [3] = {
        name = "Description",
        type = TYPE_STRING,
        options = {
            required = true,
            lineMultiplySize = 3
        }
    },

    [4] = {
        name = "Picture logo",
        type = TYPE_STRING
    },

    [5] = {
        name = "Color",
        type = TYPE_COLOR
    },

    [6] = {
        name = "Color 2",
        type = TYPE_COLOR
    },

    [7] = {
        name = "Picture override for first color",
        type = TYPE_STRING
    },

    [8] = {
        name = "Picture override for second color",
        type = TYPE_STRING
    },
}

OBJECT_TYPE.UniqueIdentifier = "CaseOpening"

ashop.RegisterObjectType(OBJECT_TYPE)
--addons/ashop/lua/ashop/code/object_types/pets/cl_pets.lua:
return gluapack()()
--addons/ashop/lua/ashop/code/object_types/title_code/color/sh_text.lua:
local OBJECT_TYPE = {}

OBJECT_TYPE.Name = ashop.L('ColorClass')
OBJECT_TYPE.DefaultRender = "Titles"
OBJECT_TYPE.UniqueIdentifier = "TitleColor"

// Name, and extra data
OBJECT_TYPE.ItemParameters = {
    [1] = {
        name = ashop.L('Color_1'),
        type = TYPE_COLOR,
    },

    [2] = {
        name = ashop.L('Color_2'),
        type = "UInt8"
    }
}

OBJECT_TYPE.SlotDefault = 1
OBJECT_TYPE.NoChild = true
OBJECT_TYPE.BlockSlotEdit = true

ashop.RegisterObjectType(OBJECT_TYPE)
--addons/ashop/lua/ashop/code/players/sync_datas/sh_sync.lua:
return gluapack()()
--addons/ashop/lua/ashop/code/ui/panels/cl_adjustablemodelpanel.lua:
local PANEL = {}

local vec40 = Vector( 0, 0, 40 )
local clr50 = Color( 50, 50, 50 )

function PANEL:Init()
	self.Entity = nil

	self.LastPaint = 0
	self.DirectionalLight = {}
	self.FarZ = 4096*10

	self:SetLookAt( vec40 )
	self:SetFOV( 70 )

	self:SetText( "" )
	self:SetAnimSpeed( 0.5 )
	self:SetAnimated( false )

	self:SetAmbientLight( clr50 )

	self:SetDirectionalLight( BOX_TOP, color_white )
	self:SetDirectionalLight( BOX_FRONT, color_white )

	self:SetColor( color_white )

    self:DoClick()

    local marginVertical = ashop.GetSize(20)
    local hFont = ashop.GetFontHeight('ashop_icon_20')
    local modeltoolbox = vgui.Create('EditablePanel', self)
    modeltoolbox:Dock(TOP)
    modeltoolbox:SetTall(hFont)
    modeltoolbox:SetMouseInputEnabled(true)
    modeltoolbox:DockMargin(modeltoolbox:GetTall()/4, modeltoolbox:GetTall()/4, 0, 0)

    local modelBG = vgui.Create('DButton', modeltoolbox)
    modelBG:Dock(LEFT)
    modelBG:SetFont('ashop_icon_16')
    modelBG:SetTextColor(color_white)
    modelBG:SetText("*")
    modelBG:SetWide(modeltoolbox:GetTall())

    local stateOn = ashop.GetColor('StateOn')
    local stateOff = ashop.GetColor('blurpleBg')
    local blurpleBg = ashop.GetColor('blurpleBg')

    function modelBG:Paint(w, h)
        draw.RoundedBox(4, 0, 0, w, h, self.toggled and stateOn or stateOff)
    end

    modelBG.DoClick = function()
        self.colorBgOverride = !self.colorBgOverride and Color(200, 200, 200) or nil
        modelBG.toggled = !modelBG.toggled
    end

    local modelHeadFocus = vgui.Create('DButton', modeltoolbox)
    modelHeadFocus:Dock(LEFT)
    modelHeadFocus:SetFont('ashop_icon_16')
    modelHeadFocus:SetTextColor(color_white)
    modelHeadFocus:SetText(",")
    modelHeadFocus:SetWide(modeltoolbox:GetTall())
    modelHeadFocus:DockMargin(modeltoolbox:GetTall()/4, 0, 0, 0)

    function modelHeadFocus:Paint(w, h)
        draw.RoundedBox(4, 0, 0, w, h, self.toggled and stateOn or blurpleBg)
    end

    modelHeadFocus.DoClick = function(s)
        s.toggled = !s.toggled

        if s.toggled then
            self:BoneFocus('ValveBiped.Bip01_Head1', 0.33)
        else
            self:BoneFocus('ValveBiped.Bip01_Spine2')
        end
    end
end

local mdlpnlBg = ashop.GetColor('Grad2_0')
local blurpleOutline = ashop.GetColor('blurple')
local blurpleOutlineR, blurpleOutlineG, blurpleOutlineB = blurpleOutline:Unpack()

local mdlpnlGradBg = ashop.GetColor('Grad2_1')
local mdlpnlGradBgR, mdlpnlGradBgG, mdlpnlGradBgB = mdlpnlGradBg:Unpack()
local grad = Material('akulla/gradient-d')

function PANEL:Paint(w, h)
    if !self.displayerContainerPaint then
        self.displayerContainerPaint, self.polyPaint = ashop.ui.RoundedBoxOutlined(ashop.Config.round, 0, 0, w, h, mdlpnlBg, blurpleOutline, 2, function()
            surface.SetMaterial(grad)
            surface.SetDrawColor(mdlpnlGradBgR, mdlpnlGradBgG, mdlpnlGradBgB)
            surface.DrawTexturedRectRotated( w/2, h/2, w*1.5, h*1.05, 5 )
        end, true)
    end

	if ( !IsValid( self.Entity ) ) then
        ashop.EndStencil()
        return
    end

    render.SetStencilPassOperation( STENCIL_KEEP )
    self.displayerContainerPaint(nil, self.colorBgOverride)

	local x, y = self:LocalToScreen( 0, 0 )

	self:LayoutEntity( self.Entity )

	local ang = self.aLookAngle
	if ( !ang ) then
		ang = ( self.vLookatPos - self.vCamPos ):Angle()
	end

	cam.Start3D( self.vCamPos, ang, self.fFOV, x, y, w, h, 5, self.FarZ )
        local blend = render.GetBlend()
        local old_r, old_g, old_b = render.GetColorModulation()

        render.SuppressEngineLighting( true )
        render.SetColorModulation( self.colColor.r / 255, self.colColor.g / 255, self.colColor.b / 255 )
        render.SetBlend( ( self:GetAlpha() / 255 ) * ( self.colColor.a / 255 ) ) -- * surface.GetAlphaMultiplier()

        for i = 0, 6 do
            local col = self.DirectionalLight[ i ]
            if ( col ) then
                render.SetModelLighting( i, col.r / 255, col.g / 255, col.b / 255 )
            end
        end

        self:DrawModel()

        render.SuppressEngineLighting( false )
        render.SetColorModulation( old_r, old_g, old_b )
        render.SetBlend( blend )
	cam.End3D()

    // Redraw the bar

    surface.SetDrawColor(blurpleOutlineR, blurpleOutlineG, blurpleOutlineB)
    surface.DrawRect(0, h-2, w, 2)
    ashop.EndStencil()

	self.LastPaint = RealTime()
end

function PANEL:CreateUserEntry(plyItem, itemParamTable, itemParamID)
    local oldValue = (plyItem.metadata or {})[itemParamID]

    if oldValue then
        if itemParamTable.type == TYPE_VECTOR then
            oldValue = Vector(oldValue)
        elseif itemParamTable.type == TYPE_ANGLE then
            oldValue = Angle(oldValue)
        end
    end

    if IsValid(self.bonusPanel) then
        self.bonusPanel:Remove()
    end

    local realItem = ashop.items[plyItem.item_id]
    local object_data = ashop.object_types[realItem.object_types]

    local p = vgui.Create('AShop_Entry', self)
    p:Dock(BOTTOM)
    p.SmallVersion = true
    p:SetTall(0)
    p:DockMargin(ashop.GetSize(ashop.Config.round*2), 0, ashop.GetSize(ashop.Config.round*2), ashop.GetSize(ashop.Config.round*2))
    p:SetInput(itemParamTable.name, itemParamTable.type, oldValue, itemParamTable.options)

    local c = ashop.GetColor('entryColor')
    function p:Paint(w, h)
        draw.RoundedBox(8, 0, 0, w, h, c)
    end

    p.OnValueChanged = function(_, newVal)
        local tbl = self.Entity.ashop_data.items[plyItem.id].metadata
        if itemParamTable.type == TYPE_VECTOR or itemParamTable.type == TYPE_ANGLE then
            local cpy = tbl[itemParamID] and Vector(tbl[itemParamID]) or nil
            tbl[itemParamID] = newVal

            object_data.OnMetadataUpdate(self.Entity, self.Entity.ashop_data.items[plyItem.id],
                realItem, itemParamID, cpy, tbl[itemParamID])
        else
            object_data.OnMetadataUpdate(self.Entity, self.Entity.ashop_data.items[plyItem.id],
                realItem, itemParamID, tbl[itemParamID], tbl[itemParamID])
        end
    end

    p.OnSave = function(_, value)
        p:Remove()

        net.Start('ashop_PlayerItem_MetaDataUpdate')
            net.WriteUInt(plyItem.id, ashop.Config.BitsPlyItemID)
            net.WriteUInt(itemParamID, 8)

            ashop.Network.GetWriteFunction(itemParamTable.type,
                value, p.options)
        net.SendToServer()
    end

    p.OnCancel = function()
        p:Remove()
    
        self.Entity.ashop_data.items[plyItem.id].metadata = self.Entity.ashop_data.items[plyItem.id].metadata or {}
        self.Entity.ashop_data.items[plyItem.id].metadata[itemParamID] = oldValue
    
        object_data.OnMetadataUpdate(self.Entity, self.Entity.ashop_data.items[plyItem.id],
            realItem, itemParamID, cpy, self.Entity.ashop_data.items[plyItem.id].metadata)
    end

    self.bonusPanel = p
end

function PANEL:LayoutEntity( ent )
    local c = self.progressCam

    if !c or c >= 1 then return end

    c = c + (FrameTime() * 1.5)
    c = c > 1 and 1 or c

    self.progressCam = c

    oldCamPos(self, LerpVector(c, self.oldPos, self.targetPos))
    oldLookAt(self, LerpVector(c, self.oldLook, self.targetLook))
end

function PANEL:BoneFocus(bone, ratio, offset)
    local b = self.Entity:LookupBone(bone)
    local r = (self.Entity:GetModelRadius()  * (ratio or 1)) * 0.75

    if !b then return end

    self:SetCamPos(self.Entity:GetBonePosition(b) + Vector(r, r, 5))
    self:SetLookAt(self.Entity:GetBonePosition(b))
end

function PANEL:InitItems(c)
    local lp = LocalPlayer()
    self.Entity.ashop_oldmodel = lp.ashop_oldmodel
    self.Entity.ashop_data = {items = c and c.items or {}, equipped = {}}
    self.Entity.DModelPanel = self

    for object_type, v in pairs((c or lp.ashop_data or {}).equipped or {}) do
        for sub_type, data in pairs(v) do
            for slot, plyItemID in pairs(data) do
                self:EquipItem(plyItemID, slot)
            end
        end
    end
end

function PANEL:PreDrawModel(ent)
    local ang = self.aLookAngle
    if ( !ang ) then
        ang = ( self.vLookatPos - self.vCamPos ):Angle()
    end

    local ent = self:GetEntity()

    if ent.RemovePACPart then
        pac.ForceRendering(true)
        pac.ShowEntityParts(ent)
    end

    ent:DrawModel()

    if self.WeaponModel then
        self.WeaponModel:DrawModel()

        if self.WeaponModel.WMAng && self.WeaponModel.WMPos then
            local b = ent:LookupBone("ValveBiped.Bip01_R_Hand")

            if !b then return end
            pos, ang = ent:GetBonePosition(b)
        
            if pos and ang then
                ang:RotateAroundAxis(ang:Right(), self.WeaponModel.WMAng[1])
                ang:RotateAroundAxis(ang:Up(), self.WeaponModel.WMAng[2])
                ang:RotateAroundAxis(ang:Forward(), self.WeaponModel.WMAng[3])

                pos = pos + self.WeaponModel.WMPos[1] * ang:Right() 
                pos = pos + self.WeaponModel.WMPos[2] * ang:Forward()
                pos = pos + self.WeaponModel.WMPos[3] * ang:Up()
                
                self.WeaponModel:SetRenderOrigin(pos)
                self.WeaponModel:SetRenderAngles(ang)
                self.WeaponModel:DrawModel()
            end
        end
    end

    ashop.PostPlayerDraw(ent, nil, self)

    if ent.RemovePACPart then
        pac.RenderOverride(ent, "opaque")
        pac.RenderOverride(ent, "translucent")
        pac.ForceRendering(false)
    end

    return true
end

local uid = -1
function PANEL:EquipItem(plyItem, slot, itemID)
    local is_remove = false
    local plyItemTable = self.Entity.ashop_data.items[plyItem]
    local returnValue

    if !plyItemTable then
        local lp = LocalPlayer()
        if lp.ashop_data.items[plyItem] then
            local t = lp.ashop_data.items[plyItem]

            // Since some object_types hold variable inside the plyItem, we need to recreate a clean one
            self.Entity.ashop_data.items[plyItem] = {
                id = t.id,
                item_id = t.item_id,
                metadata = t.metadata,
                premium_buy = t.premium_buy,
                price_buy = t.price_buy,
                when = t.when
            }
        else
            self.Entity.ashop_data.items[uid] = {
                id = uid,
                item_id = itemID or plyItem,
            }

            plyItem = uid
            returnValue = uid
            uid = uid - 1
        end
    else
        local itemTable = ashop.items[plyItemTable.item_id]

        if itemTable and (self.Entity.Entity.ashop_data.equipped[itemTable.object_types] or {})[itemTable.sub_types or 0] then
            for key, v in ipairs(self.Entity.Entity.ashop_data.equipped[itemTable.object_types][itemTable.sub_types or 0] or {}) do
                if plyItem == v then
                    slot = key
                    is_remove = true
                    break
                end
            end
        end
    end

    ashop.EquipChange(self.Entity, plyItem, slot, is_remove)
    return returnValue, uid
end

function PANEL:OnRemove()
    ashop.UnequipAll(self.Entity)

    if IsValid(self.WeaponModel) then
        self.WeaponModel:Remove()
    end

    if IsValid(self.Entity) then
        self.Entity:Remove()
    end
end

function PANEL:EquipWeapon(wepClass)
    if IsValid(self.WeaponModel) then
        self.WeaponModel:Remove()
    end

    local wep
    local stored = weapons.Get(wepClass or ashop.Config.modelPanelDisplayWeapon)
    if stored then
        wep = stored.WorldModel
    end

    if !wep then
        wep = "models/weapons/w_357.mdl"
    end

    local wep = ClientsideModel(wep)

    wep:Spawn()
    wep:SetNoDraw(true)
    wep:SetParent(self:GetEntity(), self:GetEntity():LookupAttachment("anim_attachment_RH"))
    wep:AddEffects(EF_BONEMERGE)

    if stored then
        wep.WMAng = stored.WMAng
        wep.WMPos = stored.WMPos
    end

    self.WeaponModel = wep
    self.Entity.Weapon = wep
    wep.ashop_WepClass = ashop.Config.modelPanelDisplayWeapon
end

function PANEL:SetModel( strModelName )

	-- Note - there's no real need to delete the old
	-- entity, it will get garbage collected, but this is nicer.

    local c = IsValid(self.Entity) and self.Entity.ashop_data or nil

	if ( IsValid( self.Entity ) ) then
        ashop.UnequipAll(self.Entity)
		self.Entity:Remove()
		self.Entity = nil
	end

	-- Note: Not in menu dll
	if ( !ClientsideModel ) then return end

	self.Entity = ClientsideModel( strModelName, RENDERGROUP_OTHER )
	if ( !IsValid( self.Entity ) ) then return end

	self.Entity:SetNoDraw( true )
	self.Entity:SetIK( false )

	-- Try to find a nice sequence to play
	local iSeq = self.Entity:LookupSequence( "walk_all" )
	if ( iSeq <= 0 ) then iSeq = self.Entity:LookupSequence( "WalkUnarmed_all" ) end
	if ( iSeq <= 0 ) then iSeq = self.Entity:LookupSequence( "walk_all_moderate" ) end

	if ( iSeq > 0 ) then self.Entity:ResetSequence( iSeq ) end

    self:InitItems(c)

    if self.WeaponModel then
        self.Entity.Weapon = self.WeaponModel
        self.WeaponModel:SetParent(self:GetEntity(), self:GetEntity():LookupAttachment("anim_attachment_RH"))
        self.WeaponModel:AddEffects(EF_BONEMERGE)
    end

    self.Entity:SetSequence("idle_passive")
end

local startFov, startAng, StartPosX
function PANEL:OnMousePressed(mousecode)
    ashop.menu.noquit = true
end

function PANEL:OnMouseReleased(mousecode)
    ashop.menu.noquit = false
end

function PANEL:Think()
    if not self:IsHovered() and not isnumber(startFov) and not isnumber(startAng) then return end

    local CurX, CurY = self:ScreenToLocal(gui.MouseX(), gui.MouseY())
    
    if input.IsMouseDown(MOUSE_RIGHT) then
        if not isnumber(startFov) then startFov = CurY end
        
        local newFov = self:GetFOV() - (((startFov - CurY)/self:GetTall())*1.5)
        if newFov >= 20 and newFov <= 50 then
            self:SetFOV(newFov)
        end
    else
        startFov = nil
    end

    if input.IsMouseDown(MOUSE_LEFT) then 
        if not isnumber(startAng) then startAng = CurX end
        if not isnumber(startY) then startY = CurY end
        
        local newAng = self.Entity:GetAngles().yaw - (((startAng - CurX)/self:GetWide())*4)
        local newY = (startY - CurY)*0.001
        
        local currentLook = self:GetLookAt()

        local newLookAt = (currentLook.z-newY)
        if newLookAt > -20 && newLookAt < 70 then
            self:SetLookAt(Vector(0, 0, newLookAt))
        end
        
        self.Entity:SetAngles(Angle(0, newAng, 0))
    else
        startAng = nil
        startY = nil
    end
end

derma.DefineControl( "AShop_DModelPanel", "", PANEL, "DModelPanel")
--addons/ashop/lua/ashop/code/ui/panels/cl_config.lua:
return gluapack()()
--addons/ashop/lua/ashop/code/ui/panels/cl_entry.lua:
local c = ashop.GetColor('entryColor')
local r = ashop.Config.round

local stateOn2 = ashop.GetColor('StateOn')
local stateOn2R, stateOn2G, stateOn2B = stateOn2:Unpack()

local stateOn = ashop.GetColor('StateOff')
local stateOnR, stateOnG, stateOnB = stateOn:Unpack()

local stateOff = ashop.GetColor('Grad1_0')
local stateOffR, stateOffG, stateOffB = stateOff:Unpack()

local invalidClr = ashop.GetColor('badInput')
local invalidClrBg = ashop.GetColor('badInputBg')

local PANEL = {}

function PANEL:Init()
end

function PANEL:IsRequired(b)
    self.isRequired = b

    self.options = self.options or {}
    self.options.required = b
    return self
end

function PANEL:GetRequired()
    return self.isRequired
end

function PANEL:ValidInput()
    local good, msg = ashop.VerifyInput(self.currentValue, self.type,
        self.options)

    self.invalidAlert = msg

    if msg then
        self.errDisplayer:SetText(msg)
        self.errDisplayer:SetWide(self.errDisplayer:GetContentSize() + ashop.GetSize(20))
    else
        self.errDisplayer:SetWide(0)
    end

    return good
end

local function getDaysInMonth(month, year)
    local isLeapYear = !((year % 4) or ((year % 100 == 0) and (year % 400 != 0))) and 1 or 0
    return 31 - ((month == 2) and (3 - isLeapYear) or ((month - 1) % 7 % 2))
end

function PANEL:SetInput(name, type, currentInput, options)
    self:InvalidateLayout(true)
    self:InvalidateParent(true)

    options = options or {}
    local m = ashop.GetSize(16)
    self:DockPadding(m, m, m, m)
    self.type = type

    self.options = options

    local bonusPanelName = vgui.Create("DLabel", self)
    bonusPanelName:Dock(TOP)
    bonusPanelName:DockMargin(0, 0, 0, m/2)
    bonusPanelName:SetText(name .. (self.isRequired and "*" or ""))
    bonusPanelName:SetFont("ashop_14_600")
    bonusPanelName:SetMouseInputEnabled(true)
    bonusPanelName:SetKeyboardInputEnabled(true)
    bonusPanelName:SetTall(select(2, bonusPanelName:GetContentSize()) * 1.5)
    bonusPanelName:SetContentAlignment(4)
    bonusPanelName:SetTextColor(color_white)

    local inputContainer = vgui.Create('EditablePanel', self)
    inputContainer:Dock(TOP)
    inputContainer:SetTall(0)

    local buttonsContainer = vgui.Create("EditablePanel", bonusPanelName)
    buttonsContainer:Dock(TOP)
    buttonsContainer:SetTall(bonusPanelName:GetTall())
    local saveButton, nullButton

    if !options.locked and !options.hideSave then
        saveButton = vgui.Create('DButton', buttonsContainer)
        saveButton:Dock(RIGHT)
        saveButton:SetText(ashop.L('Save'))
        saveButton:SetFont('ashop_14')
        saveButton:SetPaintBackground(false)
        saveButton:SetWide(saveButton:GetContentSize() + ashop.GetSize(20))
        saveButton:SetTextColor(color_white)
        //ashop.ui.WhiteHover(saveButton, 40)
        
        saveButton.DoClick = function()
            if !self.OnSave then return end
            if IsValid(nullButton) and !nullButton.toggled then
                self:OnSave()
            else
                self:OnSave(self.currentValue)
            end
        end
        
        function saveButton:Paint(w, h)
            draw.RoundedBox(4, 0, 0, w, h, self:IsHovered() and stateOn2 or stateOn)
        end
    end

    if (!options or !options.required) and !self:GetRequired() then
        nullButton = vgui.Create('DButton', buttonsContainer)
        nullButton:Dock(RIGHT)
        nullButton:SetText('')
        nullButton:SetFont('ashop_14')
        nullButton:SetPaintBackground(false)
        nullButton:SetWide(buttonsContainer:GetTall())
        nullButton:SetTextColor(color_white)
        nullButton:DockMargin(0, 0, m/2, 0)
        nullButton.toggled = tobool(currentInput)
        nullButton.oldHeight = 0

        nullButton.DoClick = function(s)
            local curHeight = inputContainer:GetTall()
            inputContainer:SetTall(s.oldHeight)
            s.oldHeight = curHeight
            s.toggled = !s.toggled

            if !s.toggled then
                self:OnValueChanged()
            else
                if istable(self.currentValue) then
                    self:OnValueChanged(unpack(self.currentValue))
                else
                    self:OnValueChanged(self.currentValue)
                end
            end
            self:SetTall(self:GetTall() + (inputContainer:GetTall() - s.oldHeight))
        end

        function nullButton:Paint(w, h)
            draw.RoundedBox(4, 0, 0, w, h, self.toggled and stateOn2 or stateOn)
        end

        self.nullButton = nullButton
    end

    local errDisplayer = vgui.Create('DButton', buttonsContainer)
    errDisplayer:Dock(RIGHT)
    errDisplayer:DockMargin(0, 0, m/2, 0)
    errDisplayer:SetWide(0)
    errDisplayer:SetFont("ashop_14")
    errDisplayer:SetTextColor(color_white)
    self.errDisplayer = errDisplayer

    function errDisplayer:Paint(w, h)
        draw.RoundedBox(4, 0, 0, w, h, invalidClr)
    end

    // Hard one
    self.typeAct = type

    if type == 'DATE' then
        self.currentValue = currentInput

        inputContainer:SetTall(ashop.GetFontHeight('ashop_14') * 1.5)

        // Date
        local empty = vgui.Create("DButton", inputContainer)
        empty:SetText(ashop.L('Reset'))
        empty:SetFont('ashop_14')
        empty:SetWide(empty:GetContentSize() + ashop.GetSize(20))
        empty:SetTextColor(color_white)
        empty:Dock(RIGHT)
        empty:DockMargin(0, 0, 0, 0)

        function empty:Paint(w, h)
            draw.RoundedBox(4, 0, 0, w, h, self:IsHovered() and stateOn2 or stateOn)
        end

        local year = vgui.Create('AShop_DComboBox', inputContainer)
        year:Dock(RIGHT)
        year:SetSortItems(false)
        year:DockMargin(0, 0, m/2, 0)
        for i=0, 2 do year:AddChoice(2023 + i) end
        year:ChooseOptionID(1)

        local month = vgui.Create('AShop_DComboBox', inputContainer)
        month:Dock(RIGHT)
        month:SetSortItems(false)
        month:DockMargin(0, 0, m/2, 0)
        for i=1, 12 do month:AddChoice(i) end
        month:ChooseOptionID(1)

        local day = vgui.Create('AShop_DComboBox', inputContainer)
        day:Dock(RIGHT)
        day:SetSortItems(false)
        day:DockMargin(0, 0, m/2, 0)
        for i=1, getDaysInMonth(1, 2023) do day:AddChoice(i) end
        day:ChooseOptionID(1)

        // Hour
        local hour = vgui.Create('AShop_DComboBox', inputContainer)
        hour:Dock(RIGHT)
        hour:DockMargin(0, 0, m*2, 0)
        hour:SetSortItems(false)
        for i=0, 23 do hour:AddChoice(i) end

        local function refreshCurrentValue()
            self.currentValue = os.time({
                day = tonumber(day:GetValue()) or 1,
                hour = tonumber(hour:GetValue()) or 0,
                month = tonumber(month:GetValue()) or 1,
                year = tonumber(year:GetValue()) or 2023,
            })
        end

        function month:OnSelect()
            local days = getDaysInMonth(tonumber(month:GetValue()), tonumber(year:GetValue()))
            local daySelected = tonumber(day:GetValue())

            // Refresh it, anyway, since numbers would change
            if daySelected and daySelected > days then
                daySelected = days
            end

            day:Clear()

            for i = 1, days do
                day:AddChoice(i)
            end

            if daySelected then
                day:ChooseOptionID(daySelected)
            end

            refreshCurrentValue()
        end
        year.OnSelect = month.OnSelect

        function hour:OnSelect() refreshCurrentValue() end
        function day:OnSelect() refreshCurrentValue() end

        function empty:DoClick()
            day:SetValue('1')
            month:SetValue('1')
            year:SetValue('2023')
            hour:SetValue('1')
            self.currentValue = nil
        end

        if self.currentValue then
            local t = os.date("*t", self.currentValue)
            year:ChooseOptionID(t.year - 2023 + 1)
            month:ChooseOptionID(t.month)
            day:ChooseOptionID(t.day)

            hour:ChooseOptionID(t.hour + 1)
        end
    elseif type == 'LIST' then
        self.currentValue = currentInput or {}

        assert(options.listObjects, 'No listObjects for a LIST entry type')
        local l = vgui.Create("DListView", inputContainer)
        l:SetTall(draw.GetFontHeight('ashop_16_600') * 10)
        l:DockMargin(0, m/2, 0, 0)
        l:Dock(FILL)

        inputContainer:SetTall(inputContainer:GetTall() + l:GetTall())

        function l:Paint(w, h)
            surface.SetDrawColor(stateOffR, stateOffG, stateOffB)
            surface.DrawRect(0, 0, w, h)

            surface.SetDrawColor(stateOnR, stateOnG, stateOnB)
            surface.DrawOutlinedRect(0, 0, w, h)
        end

        local vbar = l.VBar
        ashop.ui.SkinScrollPanel(l)
        l.VBar.Enabled = false

        // This is so dumb
        function l:PerformLayout()
            local Wide = self:GetWide()
            local YPos = 0
        
            if ( IsValid( self.VBar ) ) then
                self.VBar:SetPos( self:GetWide() - 16, self:GetHeaderHeight() )
                self.VBar:SetSize( 4, self:GetTall() - self:GetHeaderHeight() )
                self.VBar:SetUp( self.VBar:GetTall() - self:GetHeaderHeight()*2, self.pnlCanvas:GetTall() - self:GetHeaderHeight() )
                YPos = self.VBar:GetOffset()
            end
        
            if ( self.m_bHideHeaders ) then
                self.pnlCanvas:SetPos( 0, YPos )
            else
                self.pnlCanvas:SetPos( 0, YPos + self:GetHeaderHeight() )
            end

            self.pnlCanvas:SetSize( Wide, self.pnlCanvas:GetTall() )

            self:FixColumnsLayout()

            if ( self:GetDirty() ) then
                self:SetDirty( false )
                local y = self:DataLayout()
                self.pnlCanvas:SetTall( y )
                self:InvalidateLayout( true )
            end
        end

        local clrw = ColorAlpha(color_white, 40)
        function vbar:Paint(w, h)
            draw.RoundedBox(2, w - 2, 8, 2, h-16, clrw)
        end

        local addButton = vgui.Create('DButton', buttonsContainer)
        addButton:Dock(RIGHT)
        addButton:SetText(ashop.L('AddNewValue'))
        addButton:SetFont('ashop_14')
        addButton:SetPaintBackground(false)
        addButton:SetWide(addButton:GetContentSize() + ashop.GetSize(20))
        addButton:DockMargin(m/2, 0, 0, 0)
        addButton:SetTextColor(color_white)
        //ashop.ui.WhiteHover(saveButton, 40)

        for k, v in pairs(options.listObjects) do
            local c = l:AddColumn(v[2])
            c.Header:SetPaintBackground(false)
            c.Header:SetTextColor(color_white)
            c.Header:SetFont('ashop_14')

            function c:Paint(w, h)
                surface.SetDrawColor(stateOnR, stateOnG, stateOnB)
                surface.DrawRect(0, 0, w, h)
            end
        end

        local s = self
        function l:OnRowRightClick(id, pnl)
            local menu = vgui.Create( "AShop_DMenu", pnl )

            menu:AddOption( ashop.L('RemoveThisValue'), function()
                //table.RemoveByValue(s.currentValue, realData)
                l:RemoveLine(id)
                table.remove(s.currentValue, id)
            end)

            menu:Open()
        end

        local function addToDListView(data)
            local postTreatment = {}

            for k, v in pairs(options.listObjects) do
                if !data[k] then
                    table.insert(postTreatment, "")
                else
                    if v[1] == "ITEMID" then
                        table.insert(postTreatment, ashop.items[data[k]].name)
                    else
                        table.insert(postTreatment, data[k])
                    end
                end
            end

            local p = l:AddLine(unpack(postTreatment))
            
            for k, v in ipairs(p.Columns) do
                v:SetTextColor(color_white)
            end
            p.realData = data
        end
        
        addButton.DoClick = function()
            local a = vgui.Create('AShop_Form', ashop.menu)
            a:SetTitle(ashop.L('AddNewValue'))
            a:Center()
            for k, v in ipairs(options.listObjects) do
                a:CreateEntry(v[3] == nil and true or v[3], v[2], v[1], v[4])
            end

            a.OnSend = function(_, ...)
                table.insert(self.currentValue, {...})
                addToDListView({...})
            end
        end
        
        function addButton:Paint(w, h)
            draw.RoundedBox(4, 0, 0, w, h, self:IsHovered() and stateOn2 or stateOn)
        end

        for k, v in pairs(self.currentValue) do
            addToDListView(v)
        end
    elseif type == TYPE_VECTOR or type == TYPE_ANGLE then
        if type == TYPE_VECTOR then
            assert(options.maxVar, "Missing maxVar for Vector input: " .. name)
        end

        local copyCurrentValue = (type == TYPE_ANGLE) and Angle(currentInput) or Vector(currentInput)
        self.currentValue = copyCurrentValue

        for i = 1, 3 do
            local container = vgui.Create("EditablePanel", inputContainer)
            container:Dock(TOP)
            container:DockMargin(0, 0, 0, i == 3 and 0 or m/4)

            local currentNumber = vgui.Create("DLabel", container)
            currentNumber:Dock(RIGHT)
            currentNumber:SetText("-00.000")
            currentNumber:SetFont('ashop_14')
            currentNumber:SetContentAlignment(6)
            currentNumber:SetWide(currentNumber:GetContentSize())
            currentNumber:DockMargin(m, 0, 0, 0)
            currentNumber:SetTextColor(color_white)

            local text = vgui.Create("DLabel", container)
            text:Dock(LEFT)
            text:SetFont('ashop_14')
            text:DockMargin(0, 0, m, 0)
            text:SetTextColor(color_white)

            if i == 1 then
                text:SetText('Axe X')
            elseif i == 2 then
                text:SetText('Axe Y')
            elseif i == 3 then
                text:SetText('Axe Z')
            end

            text:SetWide(text:GetContentSize())

            local slider = vgui.Create("AShop_DSlider", container)
            slider:Dock(FILL)

            local diff = options.maxVar - (options.minVar or -options.maxVar)

            currentNumber:SetText(math.Round(self.currentValue[i], 3))
            slider:SetSlideX((self.currentValue[i] - (options.minVar or -options.maxVar)) / diff)

            container:SetTall(select(2, text:GetContentSize()))
            inputContainer:SetTall(inputContainer:GetTall() + container:GetTall() + m/4)

            slider.OnValueChanged = function(_, x, y)
                local amt = (diff * x) + (options.minVar or -options.maxVar)
                self.currentValue = self.currentValue or self.currentValue
                self.currentValue[i] = amt

                currentNumber:SetText(math.Round(amt, (type == TYPE_VECTOR and 3 or 0)))
                self.wasEdited = true
                self:OnValueChanged(self.currentValue)
            end
        end
    elseif type == TYPE_COLOR then
        local copyCurrentValue = ColorAlpha((currentInput and Color(currentInput:Unpack()) or color_white), 255)

        self.currentValue = copyCurrentValue
        self:InvalidateParent(true)
        self:InvalidateLayout(true)
        inputContainer:InvalidateLayout(true)
        inputContainer:InvalidateParent(true)
        inputContainer:SetTall(inputContainer:GetTall() + ashop.GetFontHeight('ashop_14')*1.5)

        local sliderSize = self:GetWide()/6
        local holder = vgui.Create("EditablePanel", inputContainer)
        holder:Dock(RIGHT)
        holder:SetWide(sliderSize*3 + m*4)

        for k, v in ipairs({"r", "g", "b"}) do
            local container = vgui.Create("EditablePanel", holder)
            container:Dock(LEFT)
            container:SetWide(sliderSize)
            container:DockMargin(0, 0, m*2, 0)

            local text = vgui.Create("DLabel", container)
            text:Dock(LEFT)
            text:SetFont('ashop_14')
            text:DockMargin(0, 0, m/2, 0)
            text:SetText(string.upper(v))
            text:SetWide(text:GetContentSize())
            text:SetTextColor(color_white)

            local slider = vgui.Create("AShop_DSlider", container)
            slider:Dock(FILL)
            slider:SetSlideX(self.currentValue[v] / 255)

            slider.OnValueChanged = function(_, x, y)
                self.currentValue = self.currentValue
                self.currentValue[v] = 255 * x
                self.wasEdited = true
                self:OnValueChanged(self.currentValue)
            end

            slider.Paint = function(_, w, h)
                draw.RoundedBox(2, 0, h/2-2, w, 4, self.currentValue)
            end
        end
    elseif type == TYPE_STRING or string.find(type, 'UInt') or type == "FLOAT" then
        self.currentValue = TYPE_STRING != type and tonumber(currentInput) or currentInput

        inputContainer:SetTall(ashop.GetFontHeight('ashop_14') * 1.5)

        local t = vgui.Create('AShop_DTextEntry', inputContainer)
        t:Dock(((options.lineMultiplySize and options.lineMultiplySize > 1) or self.SmallVersion) and TOP or RIGHT)
        t:SetFont('ashop_14')
        t:SetTextColor(ashop.GetColor('White'))
        t:SetText(self.currentValue or "")
        t.boxcolor = stateOff
        t.outlineColor = stateOn
        t:SetNumeric(type != TYPE_STRING)
        t:SetMultiline(options.lineMultiplySize and options.lineMultiplySize > 1)
        t:SetContentAlignment(6)

        if options.locked then
            t:SetDisabled(true)
            t.boxcolor = ashop.GetColor('Grad1_1')
            t:SetEditable(false)
        end

        t.OnChange = function()
            local text = t:GetText() or ""

            if options.maxLength and string.len(text) > options.maxLength then
                t:SetText(self.currentValue or "")
                return
            end

            self.wasEdited = true
            self.currentValue = TYPE_STRING != type and (tonumber(text) or 0) or text
            self:OnValueChanged(self.currentValue)

            if !self:ValidInput() then
                t.normalOutline = invalidClr
                t.normalColor = invalidClrBg
                t.focusOutline = invalidClr
                t.focusColor = invalidClrBg
            else
                t.normalOutline = nil
                t.normalColor = nil
                t.focusOutline = nil
                t.focusColor = nil
            end
        end

        if options.lineMultiplySize then
            t:Dock(TOP)
            t:SetTall((options.lineMultiplySize + 1) * ashop.GetFontHeight('ashop_14'))
            inputContainer:SetTall(t:GetTall())
        else
            t:SetWide(ashop.GetSize(300))
        end
    elseif type == TYPE_BOOL then
        self.currentValue = currentInput or false

        local t

        if IsValid(nullButton) then
            t = nullButton
        else
            t = vgui.Create("DButton", buttonsContainer)
        end

        t.toggled = true

        t:Dock(RIGHT)
        t:SetWide(bonusPanelName:GetTall())
        t:SetText('')

        local stateOn = ashop.GetColor('StateOn')
        local stateOff = ashop.GetColor('StateOff')

        t.DoClick = function()
            self.currentValue = !self.currentValue
            self.wasEdited = true
            self:OnValueChanged(self.currentValue)
        end

        if options.locked then
            t:SetDisabled(true)
            stateOn = ashop.GetColor('premiumMoneyLogo')
            stateOff = ashop.GetColor('pink')
        end

        t.Paint = function (_, w, h)
            draw.RoundedBox(r/2, 0, 0, w, h, self.currentValue and stateOn or stateOff)
        end
    elseif type == "SELECT" or type == "ITEMID" then
        if type == "ITEMID" then
            options.selects = {}
            for k, v in pairs(ashop.items) do
                table.insert(options.selects, {v.name, k})
            end
        end

        assert(options and options.selects, "Missing select for Select Type entry: " .. name)
        self.currentValue = options.default or currentInput or (options.selects[1] and options.selects[1][2] or nil)
        inputContainer:SetTall(ashop.GetFontHeight('ashop_14') * 1.5)
        local t = vgui.Create("DComboBox", inputContainer)
        t:Dock(RIGHT)
        t:SetFont('ashop_14')
        t:SetTextColor(ashop.GetColor('White'))

        for k, v in pairs(options.selects) do
            if isnumber(k) and isnumber(currentInput) then
                t:AddChoice(v[1], v[2], options.default and v[2] == options.default or (!options.default and (k == 1 or k == currentInput)))
            else
                t:AddChoice(v[1], v[2], options.default and v[2] == options.default or (!options.default and (k == 1 or v[1] == currentInput)))
            end
        end

        t.OnSelect = function(_, index, value, data)
            self.currentValue = data
            self.wasEdited = true
            self:OnValueChanged(data, value)
        end

        if options.locked then
            t:SetDisabled(true)
            stateOn = ashop.GetColor('premiumMoneyLogo')
            stateOff = ashop.GetColor('pink')
        end

        t:SetWide(ashop.GetSize(200))

        t.Paint = function (_, w, h)
            draw.RoundedBox(r/2, 0, 0, w, h, self.currentValue and stateOn or stateOff)
        end
    end

    if self.SmallVersion then
        buttonsContainer:SetParent()
        buttonsContainer:SetParent(self)
    end

    self:InvalidateLayout(true)
    self:SizeToChildren(false, true)

    if IsValid(nullButton) and !nullButton.toggled then
        nullButton.oldHeight = inputContainer:GetTall()
        inputContainer:SetTall(0)
        self:SetTall(self:GetTall() + (inputContainer:GetTall() - nullButton.oldHeight))
    end

    return bonusPanel
end

function PANEL:Paint(w, h)
    if self:IsHovered() or self:IsChildHovered() then
        surface.SetDrawColor(stateOn2R, stateOn2G, stateOn2B)
        surface.DrawRect(0, 0, w, h)

        surface.SetDrawColor(self.boxcolor or c)
        surface.DrawRect(1, 1, w-2, h-2)
    end
end

function PANEL:GetValue()
    return self.currentValue
end

function PANEL:OnValueChanged()
end

local sepR, sepG, sepB = ashop.GetColor('Separator', 125):Unpack()
function PANEL:AddSeparator()
    local p = vgui.Create('EditablePanel', self:GetParent())
    p:Dock(TOP)
    p:SetTall(1)

    local m = ashop.GetSize(16)

    function p:Paint(w, h)
        surface.SetDrawColor(sepR, sepG, sepB)
        surface.DrawLine(m/2, 0, w - m/2, 0)
    end
end

derma.DefineControl( "AShop_Entry", "", PANEL, "EditablePanel" )
--addons/ashop/lua/ashop/code/ui/panels/cl_tooltip.lua:
return gluapack()()
--addons/ashop/lua/ashop/code/ui/panels_settings/cl_currencies.lua:
return gluapack()()
--addons/ashop/lua/ashop/code/ui/panels_settings/cl_object_types.lua:
return gluapack()()
--addons/ashop/lua/ashop/code/ui/panels_settings/cl_rankspromo.lua:
return gluapack()()
--addons/ashop/lua/ashop/code/ui/panels_settings/cl_weaponskins.lua:
local TEX_SIZE = 512

-- Create the RT
local tex = GetRenderTarget( "AShopWhite", TEX_SIZE, TEX_SIZE )

-- Create a render-able material for our render target
local myMat = CreateMaterial( "ashop_white", "UnlitGeneric", {
	["$basetexture"] = tex:GetName() -- Make the material use our render target texture
} )

function ashop.GetRT()
    return tex, myMat
end

local function DrawInterior(editor, wepKey, value, parent)
    local horizontalMargin = ashop.GetSize(64)
    local round = ashop.Config.round
    local wep = weapons.Get(wepKey) or ashop.DefaultWeaponsHL2[wepKey]
    local marginVertical = ashop.GetSize(20)
    local clr = ashop.GetColor('Grad2_0')
    local clr2 = ashop.GetColor('Grad2_1')

    for i = 1, 2 do
        local key

        if string.find(wepKey, 'fas2') then
            key = i == 1 and "WM" or "VM"
        elseif string.find(wepKey, 'mg_') then
            key = i == 1 and "WorldModel" or "VModel"
        elseif ashop.DefaultWeaponsHL2[wepKey] then
            key = i
        else
            key = i == 1 and "WorldModel" or "ViewModel"
        end
        local key2 = i == 1 and "wm" or "vm"

        local p = vgui.Create("DPanel", editor)
        p:Dock(TOP)
        p:SetTall(editor:GetTall()/2 - horizontalMargin/2)
        p:DockMargin(0, 0, 0, horizontalMargin)
        p:DockPadding(marginVertical, marginVertical, marginVertical, marginVertical)
        function p:Paint(w, h)
            local c = HSVToColor(CurTime()*100, 1, 1)
            render.PushRenderTarget( tex )
            cam.Start2D()
                surface.SetDrawColor( c )
                surface.DrawRect( 0, 0, TEX_SIZE, TEX_SIZE )
            cam.End2D()
            render.PopRenderTarget()
        end

        local modelContainer = vgui.Create("DPanel", p)
        modelContainer:Dock(RIGHT)
        modelContainer:SetWide(p:GetTall() - marginVertical)
        modelContainer:DockMargin(marginVertical, 0, 0, 0)

        function modelContainer:Paint(w, h)
            draw.RoundedBox(round, 0, 0, w, h, clr2)
        end

        modelContainer:InvalidateLayout(true)

        local model = vgui.Create("DAdjustableModelPanel", modelContainer)
        model:Dock(FILL)
        model:SetModel(wep[key])
        function model:LayoutEntity()
            self:RunAnimation()
        end

        //
        timer.Simple(0, function()
            local mX, mY = input.GetCursorPos()
            //input.SetCursorPos(model:GetWide()/2-2, model:GetTall()/2-2)
            
            timer.Simple(0, function()
                model:OnMousePressed( MOUSE_FIRST )
                timer.Simple(0.01, function()
                    model:OnMouseReleased(MOUSE_FIRST)
                    input.SetCursorPos(mX, mY)
                end)
            end)
        end)

        local oldPress = model.OnMousePressed
        local oldOnMouseReleased = model.OnMouseReleased

        function model:OnMousePressed(mousecode)
            ashop.menu.noquit = true
            oldPress(self, mousecode)
        end

        function model:OnMouseReleased(mousecode)
            oldOnMouseReleased(self, mousecode)
            ashop.menu.noquit = false
        end

        local title = vgui.Create("DLabel", p)
        title:Dock(TOP)
        title:SetFont("ashop_14_600")
        title:SetText(key)
        title:SetTall(select(2, title:GetContentSize()))
        title:SetTextColor(color_white)

        local scroll = vgui.Create("DScrollPanel", p)
        scroll:Dock(FILL)
        ashop.ui.SkinScrollPanel(scroll)

        local r = ashop.Config.round

        for k, v in ipairs(model.Entity:GetMaterials()) do
            local c = vgui.Create('AShop_Entry', scroll)
            c:Dock(TOP)
            c:SetTall(0)
            c:DockMargin(0, marginVertical, 0, 0)
            c:SetInput(v .. "(ID: " .. (k-1) .. ")", TYPE_BOOL, value[key2][k-1], {required = true})
            c.boxcolor = ashop.GetColor('entryColor')

            function c:OnValueChanged(b)
                model.Entity:SetSubMaterial(k-1, b and "!ashop_white" or "")
            end

            function c:Paint(w, h)
                draw.RoundedBox(r, 0, 0, w, h, self.boxcolor)
            end
        
            function c:OnSave(value)
                net.Start('ashop_WeaponMaterial_EditBulk')
                    net.WriteString(wepKey)
                    net.WriteBool(value)
                    net.WriteBool(i == 1)
                    net.WriteUInt(k-1, 8)
                net.SendToServer()
            end

            c:OnValueChanged(value[key2][k-1])
        end
    end
end

ashop.registerParameter(ashop.L('WeaponSkins'), DrawInterior, function()
    local o = {}

    for k, v in pairs(ashop.weaponmaterials) do
        table.insert(o, {k, k, v})
    end

    return o
end, function()
    local a = vgui.Create('AShop_Form', ashop.menu)
    a:SetTitle(ashop.L('CreateAWepClassSkin'))
    a:CreateEntry(true, ashop.L('TempWeapon_1'), TYPE_STRING, {
        maxLength = 64,
        minLength = 4
    })

    function a:OnSend(wep, ...)
        if ashop.weaponmaterials[wep] then
            ashop.DermaNotify(ashop.L('AWeaponWithThisClass'), 1, 3)
            return
        end

        local t = {...}

        net.Start('ashop_WeaponMaterial_Create')
            net.WriteString(wep)
        net.SendToServer()
    end
    a:Center()
end, function(but, settingButton, objectTarget, completeObject)
    function but:DoRightClick()
        CloseDermaMenus()
        local menu = vgui.Create( "AShop_DMenu", but )
        menu:AddOption(ashop.L('Remove'), function()
            ashop.ui.popAskbox(ashop.L('DeleteWeaponClassSkin', completeObject[1]), ashop.L('CantUndoOperation'), function()
                net.Start('ashop_WeaponMaterial_Delete')
                    net.WriteString(completeObject[1])
                net.SendToServer()
            end)
        end)

        menu:Open()
    end
end)
--addons/ashop/lua/ashop/code/ui/panels_settings/premades/cl_ashop_wepskin_static.lua:
return gluapack()()
--addons/ashop/lua/ashop/code/ui/panels_settings/premades/cl_tf2anims.lua:
return gluapack()()
--addons/ashop/lua/ashop/code/ui/panels_settings/premades/cl_ura_titlecolors.lua:
return gluapack()()
--addons/sh_reports/lua/reports/lib_easynet.lua:
/************************
	easynet by Shendow
	http://steamcommunity.com/id/shendow/

	Copyright (c) 2017

	Permission is hereby granted, free of charge, to any person obtaining a copy
	of this software and associated documentation files (the "Software"), to deal
	in the Software without restriction, including without limitation the rights
	to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	copies of the Software, and to permit persons to whom the Software is
	furnished to do so, subject to the following conditions:

	The above copyright notice and this permission notice shall be included in all
	copies or substantial portions of the Software.

	THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
	SOFTWARE.
************************/

AddCSLuaFile()

EASYNET_STRING = 1
EASYNET_FLOAT = 2
EASYNET_BOOL = 3
EASYNET_UINT8 = 4
EASYNET_UINT16 = 5
EASYNET_UINT32 = 6
EASYNET_STRUCTURES = 7
EASYNET_PLAYER = 8

module("easynet", package.seeall)

local Structures = {}
local Creating

function Start(id)
	Creating = {
		id = id,
		nid = #Structures + 1,
		args = {},
	}
end

function Add(name, type)
	Creating.args[name] = {id = table.Count(Creating.args) + 1, type = type}
end

function Register()
	local id = Creating.id
	Structures[id] = table.Copy(Creating)

	if (SERVER) then
		util.AddNetworkString(id)
	end
end

local function read(typ, name)
	if (typ == EASYNET_STRING) then
		return net.ReadString()
	elseif (typ == EASYNET_FLOAT) then
		return net.ReadFloat()
	elseif (typ == EASYNET_BOOL) then
		return net.ReadBool()
	elseif (typ == EASYNET_UINT8) then
		return net.ReadUInt(8)
	elseif (typ == EASYNET_UINT16) then
		return net.ReadUInt(16)
	elseif (typ == EASYNET_UINT32) then
		return net.ReadUInt(32)
	elseif (typ == EASYNET_STRUCTURES) then
		local t = {}
		local struct = Structures[name]

		for i = 1, net.ReadUInt(16) do
			t[i] = {}

			for n, arg in SortedPairsByMemberValue (struct.args, "id") do
				t[i][n] = read(arg.type, n)
			end
		end

		return t
	elseif (typ == EASYNET_PLAYER) then
		return Player(net.ReadUInt(16))
	end
end

function Callback(id, cb)
	net.Receive(id, function(len, ply)
		if (_EASYNET_DEBUG) then
			print("[EasyNet][Rcv][" .. id .. "] " .. (len / 8) .. " bytes")
		end

		local struct = Structures[id]

		local data = {}
		for name, arg in SortedPairsByMemberValue (struct.args, "id") do
			data[name] = read(arg.type, name)
		end

		cb(data, ply)
	end)
end

local function write(val, typ, name)
	if (typ == EASYNET_STRING) then
		net.WriteString(val)
	elseif (typ == EASYNET_FLOAT) then
		net.WriteFloat(val)
	elseif (typ == EASYNET_BOOL) then
		net.WriteBool(val)
	elseif (typ == EASYNET_UINT8) then
		if (isstring(val)) then
			val = tonumber(val) or 0
		end

		net.WriteUInt(val, 8)
	elseif (typ == EASYNET_UINT16) then
		net.WriteUInt(val, 16)
	elseif (typ == EASYNET_UINT32) then
		net.WriteUInt(val, 32)
	elseif (typ == EASYNET_STRUCTURES) then
		local struct = Structures[name]

		net.WriteUInt(table.Count(val), 16)

		for k, v in pairs (val) do
			for n, arg in SortedPairsByMemberValue (struct.args, "id") do
				write(v[n], arg.type, n)
			end
		end
	elseif (typ == EASYNET_PLAYER) then
		net.WriteUInt(IsValid(val) and val:UserID() or 0, 16)
	end
end

local function prepare(id, data)
	local struct = Structures[id]

	net.Start(id)
		for name, arg in SortedPairsByMemberValue (struct.args, "id") do
			write(data[name], arg.type, name)
		end

		if (_EASYNET_DEBUG) then
			print("[EasyNet][Send][" .. id .. "] " .. net.BytesWritten() .. " bytes")
		end
end

if (SERVER) then
	function Send(rec, id, data)
		prepare(id, data)
		net.Send(rec)
	end
else
	function SendToServer(id, data)
		prepare(id, data)
		net.SendToServer()
	end
end
--addons/sh_reports/lua/reports/lib_loungeui.lua:
/*
* About time I made a library for general use!
* You can copy this file for your own server/personal use.
* What you can't do is use it in a commercial project without my approval (add me at http://steamcommunity.com/id/shendow/)
* I won't provide much support if you run into trouble editing this file.
*/

local base_table = SH_REPORTS
local font_prefix = "SH_REPORTS."

--
local matClose = Material("shenesis/general/close.png", "noclamp smooth")

local function get_scale()
	local sc = math.Clamp(ScrH() / 1080, 0.75, 1)
	if (!th) then
		th = 48 * sc
		m = th * 0.25
	end

	return sc
end

function base_table:L(s, ...)
	return string.format(self.Language[s] or s, ...)
end

function base_table:GetPadding()
	return th
end

function base_table:GetMargin()
	return m
end

function base_table:GetScreenScale()
	return get_scale()
end

function base_table:CreateFonts(scale)
	local font = self.Font
	local font_bold = self.FontBold

	local sizes = {
		[12] = "Small",
		[16] = "Medium",
		[20] = "Large",
		[24] = "Larger",
		[32] = "Largest",
		[200] = "3D",
	}

	for s, n in pairs (sizes) do
		surface.CreateFont(font_prefix .. n, {font = font, extended = true, size = s * scale})
		surface.CreateFont(font_prefix .. n .. "B", {font = font_bold, extended = true, size = s * scale})
	end
end

hook.Add("InitPostEntity", font_prefix .. "CreateFonts", function()
	base_table:CreateFonts(get_scale())
end)

function base_table:MakeWindow(title)
	local scale = get_scale()
	local styl = self.Style

	local pnl = vgui.Create("EditablePanel")
	pnl.m_bDraggable = true
	pnl.SetDraggable = function(me, b)
		me.m_bDraggable = b
	end
	pnl.Paint = function(me, w, h)
		if (me.m_fCreateTime) then
			Derma_DrawBackgroundBlur(me, me.m_fCreateTime)
		end

		draw.RoundedBox(4, 0, 0, w, h, styl.bg)
	end
	pnl.OnClose = function() end
	pnl.Close = function(me)
		if (me.m_bClosing) then
			return end

		me.m_bClosing = true
		me:AlphaTo(0, 0.1, 0, function()
			me:Remove()
		end)
		me:OnClose()
	end

		local header = vgui.Create("DPanel", pnl)
		header:SetTall(th)
		header:Dock(TOP)
		header.Paint = function(me, w, h)
			draw.RoundedBoxEx(4, 0, 0, w, h, styl.header, true, true, false, false)
		end
		header.Think = function(me)
			if (me.Hovered and pnl.m_bDraggable) then
				me:SetCursor("sizeall")
			end

			local drag = me.m_Dragging
			if (drag) then
				local mx, my = math.Clamp(gui.MouseX(), 1, ScrW() - 1), math.Clamp(gui.MouseY(), 1, ScrH() - 1)
				local x, y = mx - drag[1], my - drag[2]

				pnl:SetPos(x, y)
			end
		end
		header.OnMousePressed = function(me)
			if (pnl.m_bDraggable) then
				me.m_Dragging = {gui.MouseX() - pnl.x, gui.MouseY() - pnl.y}
				me:MouseCapture(true)
			end
		end
		header.OnMouseReleased = function(me)
			me.m_Dragging = nil
			me:MouseCapture(false)
		end
		pnl.m_Header = header

			local titlelbl = self:QuickLabel(title, font_prefix .. "Larger", styl.text, header)
			titlelbl:Dock(LEFT)
			titlelbl:DockMargin(m, 0, 0, 0)
			pnl.m_Title = titlelbl

			local close = vgui.Create("DButton", header)
			close:SetText("")
			close:SetWide(th)
			close:Dock(RIGHT)
			close.Paint = function(me, w, h)
				if (me.Hovered) then
					draw.RoundedBoxEx(4, 0, 0, w, h, styl.close_hover, false, true, false, false)
				end

				if (me:IsDown()) then
					draw.RoundedBoxEx(4, 0, 0, w, h, styl.hover, false, true, false, false)
				end

				surface.SetDrawColor(me:IsDown() and styl.text_down or styl.text)
				surface.SetMaterial(matClose)
				surface.DrawTexturedRectRotated(w * 0.5, h * 0.5, 16 * scale, 16 * scale, 0)
			end
			close.DoClick = function(me)
				pnl:Close()
			end
			pnl.m_Close = close

	pnl.AddHeaderButton = function(me, icon, callback)
		local btn = vgui.Create("DButton", header)
		btn:SetText("")
		btn:SetWide(self:GetPadding())
		btn:Dock(RIGHT)
		btn.Paint = function(me, w, h)
			if (me.Hovered) then
				surface.SetDrawColor(styl.hover)
				surface.DrawRect(0, 0, w, h)
			end

			surface.SetMaterial(icon)
			surface.SetDrawColor(styl.text)
			surface.DrawTexturedRect(w * 0.5 - 8, h * 0.5 - 8, 16, 16)
		end
		btn.DoClick = function()
			callback()
		end

		return btn
	end

	return pnl
end

function base_table:QuickLabel(t, f, c, p)
	local l = vgui.Create("DLabel", p)
	l:SetText(t)
	l:SetFont(f:Replace("{prefix}", font_prefix))
	l:SetColor(c)
	l:SizeToContents()

	return l
end

function base_table:QuickButton(t, cb, p, f, c)
	p:SetMouseInputEnabled(true)

	local styl = self.Style

	local b = vgui.Create("DButton", p)
	b:SetText(t)
	b:SetFont((f or "{prefix}Medium"):Replace("{prefix}", font_prefix))
	b:SetColor(c or styl.text)
	b:SizeToContents()
	b.DoClick = function(me)
		cb(me)
	end
	b.Paint = function(me, w, h)
		local r = me.m_iRound or 4

		draw.RoundedBox(r, 0, 0, w, h, me.m_Background or styl.inbg)

		if (!me.m_bNoHover and me.Hovered) then
			draw.RoundedBox(r, 0, 0, w, h, styl.hover)
		end

		if (me.IsDown and me:IsDown()) then
			draw.RoundedBox(r, 0, 0, w, h, styl.hover)
		end
	end

	return b
end

function base_table:ButtonStyle(b, f, c)
	local styl = self.Style

	b:SetFont((f or "{prefix}Medium"):Replace("{prefix}", font_prefix))
	b:SetContentAlignment(5)
	b:SetColor(c or styl.text)
	b.Paint = function(me, w, h)
		local r = me.m_iRound or 4

		draw.RoundedBox(r, 0, 0, w, h, me.m_Background or styl.inbg)

		if (!me.m_bNoHover and me.Hovered) then
			draw.RoundedBox(r, 0, 0, w, h, styl.hover)
		end

		if (me.IsDown and me:IsDown()) then
			draw.RoundedBox(r, 0, 0, w, h, styl.hover)
		end
	end
end

function base_table:LineStyle(l)
	local styl = self.Style

	for _, v in pairs (l.Columns) do
		if (v.SetFont) then
			v:SetContentAlignment(5)
			v:SetFont(font_prefix .. "Medium")
			v:SetTextColor(styl.text)
		end
	end

	l.Paint = function(me, w, h)
		if (!me:GetAltLine()) then
			surface.SetAlphaMultiplier(math.min(me:GetAlpha() / 255, 0.5))
				surface.SetDrawColor(styl.inbg)
				surface.DrawRect(0, 0, w, h)
			surface.SetAlphaMultiplier(me:GetAlpha() / 255)
		end

		if (me:IsSelectable() and me:IsLineSelected()) then
			surface.SetDrawColor(styl.hover)
			surface.DrawRect(0, 0, w, h)
		elseif (me.Hovered or me:IsChildHovered()) then
			surface.SetDrawColor(styl.hover2)
			surface.DrawRect(0, 0, w, h)
		end
	end
end

function base_table:QuickEntry(tx, parent)
	parent:SetMouseInputEnabled(true)
	parent:SetKeyboardInputEnabled(true)

	local styl = self.Style

	local entry = vgui.Create("DTextEntry", parent)
	entry:SetText(tx or "")
	entry:SetFont(font_prefix .. "Medium")
	entry:SetDrawLanguageID(false)
	entry:SetUpdateOnType(true)
	entry:SetTextColor(styl.text)
	entry:SetHighlightColor(styl.header)
	entry:SetCursorColor(styl.text)
	entry.Paint = function(me, w, h)
		draw.RoundedBox(4, 0, 0, w, h, styl.textentry)
		me:DrawTextEntryText(me:GetTextColor(), me:GetHighlightColor(), me:GetCursorColor())
	end

	return entry
end

function base_table:QuickComboBox(parent)
	parent:SetMouseInputEnabled(true)

	local combo = vgui.Create("DComboBox", parent)
	combo.m_bNoHover = true
	self:ButtonStyle(combo)

	combo.OldDoClick = combo.DoClick
	combo.DoClick = function(me)
		me:OldDoClick()

		if (IsValid(me.Menu)) then
			for _, v in pairs (me.Menu:GetChildren()[1]:GetChildren()) do -- sdfdsfzz
				self:ButtonStyle(v)
				v.m_iRound = 0
			end
		end
	end

	return combo
end

function base_table:PaintScroll(panel)
	local styl = self.Style

	local scr = panel.VBar or panel:GetVBar()
	scr.Paint = function(_, w, h)
		draw.RoundedBox(4, 0, 0, w, h, /* 76561198347218033 styl.header */ styl.bg)
	end

	scr.btnUp.Paint = function(_, w, h)
		draw.RoundedBox(4, 2, 0, w - 4, h - 2, styl.inbg)
	end
	scr.btnDown.Paint = function(_, w, h)
		draw.RoundedBox(4, 2, 2, w - 4, h - 2, styl.inbg)
	end

	scr.btnGrip.Paint = function(me, w, h)
		draw.RoundedBox(4, 2, 0, w - 4, h, styl.inbg)

		if (me.Hovered) then
			draw.RoundedBox(4, 2, 0, w - 4, h, styl.hover2)
		end

		if (me.Depressed) then
			draw.RoundedBox(4, 2, 0, w - 4, h, styl.hover2)
		end
	end
end

function base_table:PaintList(ilist)
	for _, v in pairs (ilist.Columns) do
		self:ButtonStyle(v.Header)
		v.DraggerBar:SetVisible(false)
	end

	self:PaintScroll(ilist)
end

function base_table:StringRequest(title, text, callback)
	local styl = self.Style

	if (IsValid(_LOUNGE_STRREQ)) then
		_LOUNGE_STRREQ:Remove()
	end

	local scale = get_scale()
	local wi, he = 600 * scale, 160 * scale

	local cancel = vgui.Create("DPanel")
	cancel:SetDrawBackground(false)
	cancel:StretchToParent(0, 0, 0, 0)
	cancel:MoveToFront()
	cancel:MakePopup()

	local pnl = self:MakeWindow(title)
	pnl:SetSize(wi, he)
	pnl:Center()
	pnl:MakePopup()
	pnl.m_fCreateTime = SysTime()
	_LOUNGE_STRREQ = pnl

	cancel.OnMouseReleased = function(me, mc)
		if (mc == MOUSE_LEFT) then
			pnl:Close()
		end
	end
	cancel.Think = function(me)
		if (!IsValid(pnl)) then
			me:Remove()
		end
	end

		local body = vgui.Create("DPanel", pnl)
		body:SetDrawBackground(false)
		body:Dock(FILL)
		body:DockPadding(m, m, m, m)

			local tx = self:QuickLabel(text, font_prefix .. "Large", styl.text, body)
			tx:SetContentAlignment(5)
			tx:SetWrap(tx:GetWide() > wi - m * 2)
			tx:Dock(FILL)

			local apply = vgui.Create("DButton", body)
			apply:SetText("OK")
			apply:SetColor(styl.text)
			apply:SetFont(font_prefix .. "Medium")
			apply:Dock(BOTTOM)
			apply.Paint = function(me, w, h)
				draw.RoundedBox(4, 0, 0, w, h, styl.inbg)

				if (me.Hovered) then
					draw.RoundedBox(4, 0, 0, w, h, styl.hover)
				end

				if (me:IsDown()) then
					draw.RoundedBox(4, 0, 0, w, h, styl.hover)
				end
			end

			local entry = vgui.Create("DTextEntry", body)
			entry:RequestFocus()
			entry:SetFont(font_prefix .. "Medium")
			entry:SetDrawLanguageID(false)
			entry:Dock(BOTTOM)
			entry:DockMargin(0, m, 0, m)
			entry.Paint = function(me, w, h)
				draw.RoundedBox(4, 0, 0, w, h, styl.textentry)
				me:DrawTextEntryText(me:GetTextColor(), me:GetHighlightColor(), me:GetCursorColor())
			end
			entry.OnEnter = function()
				apply:DoClick()
			end

			apply.DoClick = function()
				pnl:Close()
				callback(entry:GetValue())
			end

	pnl.OnFocusChanged = function(me, gained)
		if (!gained) then
			timer.Simple(0, function()
				if (!IsValid(me) or vgui.GetKeyboardFocus() == entry) then
					return end

				me:Close()
			end)
		end
	end

	pnl:SetWide(math.max(math.min(tx:GetWide() + m * 2, pnl:GetWide()), th * 2))
	pnl:CenterHorizontal()

	pnl:SetAlpha(0)
	pnl:AlphaTo(255, 0.1)
end

function base_table:Menu()
	local styl = self.Style

	if (IsValid(_LOUNGE_MENU)) then
		_LOUNGE_MENU:Remove()
	end

	local cancel = vgui.Create("DPanel")
	cancel:SetDrawBackground(false)
	cancel:StretchToParent(0, 0, 0, 0)
	cancel:MoveToFront()
	cancel:MakePopup()

	local pnl = vgui.Create("DPanel")
	pnl:SetDrawBackground(false)
	pnl:SetSize(20, 1)
	pnl.AddOption = function(me, text, callback)
		surface.SetFont(font_prefix .. "MediumB")
		local wi, he = surface.GetTextSize(text)
		wi = wi + m * 2
		he = he + m

		me:SetWide(math.max(wi, me:GetWide()))
		me:SetTall(pnl:GetTall() + he)

		local btn = vgui.Create("DButton", me)
		btn:SetText(self:L(text))
		btn:SetFont(font_prefix .. "MediumB")
		btn:SetColor(styl.text)
		btn:Dock(TOP)
		btn:SetSize(wi, he)
		btn.Paint = function(me, w, h)
			surface.SetDrawColor(styl.menu)
			surface.DrawRect(0, 0, w, h)

			if (me.Hovered) then
				surface.SetDrawColor(styl.hover)
				surface.DrawRect(0, 0, w, h)
			end

			if (me:IsDown()) then
				surface.SetDrawColor(styl.hover)
				surface.DrawRect(0, 0, w, h)
			end
		end
		btn.DoClick = function(me)
			if (callback) then
				callback()
			end
			pnl:Close()
		end

		return btn
	end
	pnl.Open = function(me)
		me:SetPos(gui.MouseX(), math.min(math.max(0, ScrH() - me:GetTall()), gui.MouseY()))
		me:MakePopup()
	end
	pnl.Close = function(me)
		if (me.m_bClosing) then
			return end

		me.m_bClosing = true
		me:AlphaTo(0, 0.1, 0, function()
			me:Remove()
		end)
	end
	_LOUNGE_MENU = pnl

	cancel.OnMouseReleased = function(me, mc)
		pnl:Close()
	end
	cancel.Think = function(me)
		if (!IsValid(pnl)) then
			me:Remove()
		end
	end

	return pnl
end

function base_table:PanelPaint(name)
	local styl = self.Style
	local col = styl[name] or styl.bg

	return function(me, w, h)
		draw.RoundedBox(4, 0, 0, w, h, col)
	end
end

// https://facepunch.com/showthread.php?t=1522945&p=50524545&viewfull=1#post50524545|76561198347218024
local sin, cos, rad = math.sin, math.cos, math.rad
local rad0 = rad(0)
local function DrawCircle(x, y, radius, seg)
	local cir = {
		{x = x, y = y}
	}

	for i = 0, seg do
		local a = rad((i / seg) * -360)
		table.insert(cir, {x = x + sin(a) * radius, y = y + cos(a) * radius})
	end

	table.insert(cir, {x = x + sin(rad0) * radius, y = y + cos(rad0) * radius})
	surface.DrawPoly(cir)
end

function base_table:Avatar(ply, siz, par)
	if (type(ply) == "Entity" and !IsValid(ply)) then
		return end

	if (isnumber(ply)) then
		ply = tostring(ply)
	end

	siz = siz or 32
	local hsiz = siz * 0.5

	local url = "http://steamcommunity.com/profiles/" .. (isstring(ply) and ply or ply:SteamID64() or "")

	par:SetMouseInputEnabled(true)

	local pnl = vgui.Create("DPanel", par)
	pnl:SetSize(siz, siz)
	pnl:SetDrawBackground(false)
	pnl.Paint = function() end

		local av = vgui.Create("AvatarImage", pnl)
		if (isstring(ply)) then
			av:SetSteamID(ply, siz)
		else
			av:SetPlayer(ply, siz)
		end
		av:SetPaintedManually(true)
		av:SetSize(siz, siz)

			local btn = vgui.Create("DButton", av)
			btn:SetToolTip("Click here to view " .. (isstring(ply) and "their" or ply:Nick() .. "'s") .. " Steam Profile")
			btn:SetText("")
			btn:Dock(FILL)
			btn.Paint = function() end
			btn.DoClick = function(me)
				gui.OpenURL(url)
			end

	pnl.SetSteamID = function(me, s)
		av:SetSteamID(s, siz)
		url = "http://steamcommunity.com/profiles/" .. s
	end
	pnl.SetPlayer = function(me, p)
		av:SetPlayer(p, siz)
		url = "http://steamcommunity.com/profiles/" .. p:SteamID64()
	end
	pnl.Paint = function(me, w, h)
		render.ClearStencil()
		render.SetStencilEnable(true)

		render.SetStencilWriteMask(1)
		render.SetStencilTestMask(1)

		render.SetStencilFailOperation(STENCILOPERATION_REPLACE)
		render.SetStencilPassOperation(STENCILOPERATION_ZERO)
		render.SetStencilZFailOperation(STENCILOPERATION_ZERO)
		render.SetStencilCompareFunction(STENCILCOMPARISONFUNCTION_NEVER)
		render.SetStencilReferenceValue(1)

		draw.NoTexture()
		surface.SetDrawColor(color_black)
		DrawCircle(hsiz, hsiz, hsiz, hsiz)

		render.SetStencilFailOperation(STENCILOPERATION_ZERO)
		render.SetStencilPassOperation(STENCILOPERATION_REPLACE)
		render.SetStencilZFailOperation(STENCILOPERATION_ZERO)
		render.SetStencilCompareFunction(STENCILCOMPARISONFUNCTION_EQUAL)
		render.SetStencilReferenceValue(1)

		av:PaintManual()

		render.SetStencilEnable(false)
		render.ClearStencil()
	end

	return pnl
end

local c = {}
function base_table:GetName(sid, cb)
	if (c[sid]) then
		cb(c[sid])
		return
	end

	for _, v in pairs (player.GetAll()) do
		if (v:SteamID64() == sid) then
			c[sid] = v:Nick()
			cb(v:Nick())
			return
		end
	end

	steamworks.RequestPlayerInfo(sid)
	timer.Simple(1, function()
		local n = steamworks.GetPlayerName(sid)
		c[sid] = n
		cb(n)
	end)
end

function base_table:Notify(msg, dur, bg, parent)
	if (IsValid(_SH_NOTIFY)) then
		_SH_NOTIFY:Close()
	end

	dur = dur or 3
	bg = bg or self.Style.header

	local fnt = font_prefix .. "Larger"

	local w, h = ScrW(), ScrH()
	if (IsValid(parent)) then
		w, h = parent:GetSize()
		fnt = font_prefix .. "Large"
	end

	local p = vgui.Create("DButton", parent)
	p:MoveToFront()
	p:SetText(self.Language[msg] or msg)
	p:SetFont(fnt)
	p:SetColor(self.Style.text)
	p:SetSize(w, draw.GetFontHeight(fnt) + self:GetMargin() * 2)
	p:AlignTop(h)
	p.Paint = function(me, w, h)
		surface.SetDrawColor(bg)
		surface.DrawRect(0, 0, w, h)
	end
	p.Close = function(me)
		if (me.m_bClosing) then
			return end

		me.m_bClosing = true
		me:Stop()
		me:MoveTo(0, h, 0.2, 0, -1, function()
			me:Remove()
		end)
	end
	p.DoClick = p.Close
	_SH_NOTIFY = p

	p:MoveTo(0, h - p:GetTall(), 0.2, 0, -1, function()
		p:MoveTo(0, h, 0.2, dur, -1, function()
			p:Remove()
		end)
	end)
end

function base_table:LerpColor(frac, from, to)
	return Color(Lerp(frac, from.r, to.r), Lerp(frac, from.g, to.g), Lerp(frac, from.b, to.b), Lerp(frac, from.a, to.a))
end
--lua/autorun/bankguards.lua:
return gluapack()()
--addons/yere_oturma/lua/autorun/binbon_yereoturma.lua:
return gluapack()()
--addons/bodygroupr/lua/bodyman/bodyman_config.lua:


BODYMAN.HelpText = [[]] -- edit this to your liking.

BODYMAN.HelpText_Fr =[[]] 

BODYMAN.ClosetViewDistance = 256 -- how far the text can be seen on the closet
BODYMAN.ClosetName = "Gardırop" -- what should the closet be called?
BODYMAN.ClosetHelpText = [[Açmak için [E] tuşuna basın.]]

BODYMAN.ClosetName_Fr = "Gardırop"
BODYMAN.ClosetHelpText_Fr = [[Açmak için [E] tuşuna basın.]]

BODYMAN.ClosetsOnly = false -- set this to true if you think players MUST use a closet. They will not be able to access the interface normally.

BODYMAN.strings = {
	Appearance = "Görünüm",
	Playermodels = "Oyuncu Modeli",
	Skins = "Skin",
	Bodygroups = "Vücut Grupları",
	Save = "Kaydet",
	Load = "Yükle",
	Remove_All = "Hepsini Sil",
	Without_Saving = "Kaydetme",
	Spawn_a = "Spawn",
}
BODYMAN.strings_fr = {
	Appearance = "Görünüm",
	Playermodels = "Oyuncu Modeli",
	Skins = "Skin",
	Bodygroups = "Vücut Grupları",
	Save = "Kaydet",
	Load = "Yükle",
	Remove_All = "Hepsini Sil",
	Without_Saving = "Kaydetme",
	Spawn_a = "Spawn",
}

BODYMAN.French = false -- Set this to true if your server speaks french.

BODYMAN.ClosetsCanBreak = false -- set this to true if you want closets to be destroyable with guns
BODYMAN.ClosetHealth = 100 -- default HP of closets. increase this if you want to take more shots to destroy them.


--addons/bodygroupr/lua/bodyman/arizard_derma.lua:
return gluapack()()
--lua/autorun/cf_gunslinger_gr.lua:
player_manager.AddValidModel( "CF_Gunslinger_GR", "models/CF_Gunslinger_GR/CF_Gunslinger_GR.mdl" );

local Category = "CrossFire"

local NPC = { 	Name = "CF_Gunslinger_GR - Friendly", 
				Class = "npc_citizen",
				Model = "models/CF_Gunslinger_GR/CF_Gunslinger_GR.mdl",
				Health = "100",
				KeyValues = { citizentype = 4 },
				Weapons = { "weapons_smg1" },
				Category = Category	}

list.Set( "NPC", "CF_Gunslinger_GR_f", NPC )

local Category = "CrossFire"

local NPC = { 	Name = "CF_Gunslinger_GR - Hostile", 
				Class = "npc_combine_s",
				Model = "models/CF_Gunslinger_GR/CF_Gunslinger_GR.mdl",
				Squadname = "CF_Gunslinger_GR",
				Numgrenades = "3",
				Health = "100",
				Weapons = { "" },
				Category = Category	}

list.Set( "NPC", "CF_Gunslinger_GR_h", NPC )
--lua/autorun/cfm_sparrow_bl.lua:
return gluapack()()
--lua/autorun/cfm_sparrow_gr.lua:
player_manager.AddValidModel( "CFM_Sparrow_GR", "models/cfmsparrowgr/cfmsparrowgr.mdl" );


local Category = "CrossFire Mobile"

local NPC = { 	Name = "CFM_Sparrow_GR - Friendly", 
				Class = "npc_citizen",
				Model = "models/cfmsparrowgr/cfmsparrowgr.mdl",
				Health = "100",
				KeyValues = { citizentype = 4 },
				Weapons = { "weapons_smg1" },
				Category = Category	}

list.Set( "NPC", "CFM_Sparrow_GR_f", NPC )

local Category = "CrossFire Mobile"

local NPC = { 	Name = "CFM_Sparrow_GR - Hostile", 
				Class = "npc_combine_s",
				Model = "models/cfmsparrowgr/cfmsparrowgr.mdl",
				Squadname = "CFM_Sparrow_GR",
				Numgrenades = "3",
				Health = "100",
				Category = Category	}

list.Set( "NPC", "CFM_Sparrow_GR_h", NPC )
--addons/ch_atm/lua/ch_atm/shared/currencies/helix.lua:
return gluapack()()
--addons/ch_atm/lua/ch_atm/shared/currencies/mtokens.lua:
CH_ATM.Currencies[ "mtokens" ] = {
	Name = "mTokens",
	
	AddMoney = function( ply, amount )
		mTokens.AddPlayerTokens( ply, amount )
	end,
	
	TakeMoney = function( ply, amount )
		mTokens.TakePlayerTokens( ply, amount )
	end,
	
	GetMoney = function( ply )
		return mTokens.GetPlayerTokens( ply )
	end,
	
	CanAfford = function( ply, amount )
		return mTokens.CanPlayerAfford( ply, amount )
	end,
	
	FormatMoney = function( amount )
		return string.Comma( amount ) .. " token" .. (amount > 1 and "s" or "")
	end,
	
	CurrencyAbbreviation = function()
		return "TOK"
	end,
}
--addons/ch_atm/lua/ch_atm/shared/currencies/pointshop2_premium.lua:
CH_ATM.Currencies[ "pointshop2_premium" ] = {
	Name = "PointShop 2 Premium Points",
	
	AddMoney = function( ply, amount )
		ply:PS2_AddPremiumPoints( amount )
	end,
	
	TakeMoney = function( ply, amount )
		ply:PS2_AddPremiumPoints( -amount )
	end,
	
	GetMoney = function( ply )
		return ply.PS2_Wallet.premiumPoints
	end,
	
	CanAfford = function( ply, amount )
		return ply.PS2_Wallet.premiumPoints >= amount
	end,
	
	FormatMoney = function( amount )
		return string.Comma( amount ) .. " point" .. (amount > 1 and "s" or "")
	end,
	
	CurrencyAbbreviation = function()
		return "PTS"
	end,
}
--addons/ch_atm/lua/ch_atm/shared/currencies/santosrp.lua:
return gluapack()()
--addons/ch_bitminers_dlc/lua/ch_bitminers_dlc/shared/bitminers_dlc_config.lua:
CH_Bitminers_DLC = CH_Bitminers_DLC or {}
CH_Bitminers_DLC.Config = CH_Bitminers_DLC.Config or {}

-- Remote Tablet
CH_Bitminers_DLC.Config.BitminerLinkDistance = 5000 -- Distance between player with tablet and bitminer before they're allowed to connect.
CH_Bitminers_DLC.Config.UseIdleAnimation = false -- Should the tablet swep use the IDLE animation after equipped (wobs a bit on the screen when you stand still)

CH_Bitminers_DLC.Config.DisableWithdrawWhenHacked = false -- Should we disable withdrawing money via tablet when the bitminer is hacked?
CH_Bitminers_DLC.Config.DisablePowerOnOffWhenHacked = false -- -- Should we disable powering on/off via tablet when the bitminer is hacked?

-- Bitminer Hacking
CH_Bitminers_DLC.Config.HackingUSBHealth = 25 -- Amount of health for the usb entity.
CH_Bitminers_DLC.Config.BitminerHackingTime = 7 -- Amount of seconds it takes to hack into a bitminer and gain access to the screen.
CH_Bitminers_DLC.Config.BitminerHackingDistance = 10000 -- Max distance between bitminer shelf and hacker to succeed hacking attempt.

CH_Bitminers_DLC.Config.HackingFailChance = 25 -- How high is the chance that a hacking attempt will fail? 25% fail chance by default.

-- Bitminer Repair Wrench
CH_Bitminers_DLC.Config.RepairMinHealth = 5 -- Minimum amount of health to heal when reparing a bitminer entity (left click)
CH_Bitminers_DLC.Config.RepairMaxHealth = 15 -- Maximum amount of health to heal when reparing a bitminer entity (THE VALUE IS RANDOMIZED) (left click)

CH_Bitminers_DLC.Config.ShowHealthDistance = 100 -- Distance between player with wrench and bitminer entities before health shows above ent.

-- Antivirus USB
CH_Bitminers_DLC.Config.AntivirusUSBHealth = 25 -- Amount of health for the usb entity.
CH_Bitminers_DLC.Config.AntivirusSecureTime = 10 -- How many seconds does it take the antivirus to secure the bitminer?

-- XP System Support
CH_Bitminers_DLC.Config.DarkRPLevelSystemEnabled = false -- DARKRP LEVEL SYSTEM BY vrondakis https://github.com/uen/Leveling-System
CH_Bitminers_DLC.Config.SublimeLevelSystemEnabled = false -- Sublime Levels by HIGH ELO CODERS https://www.gmodstore.com/market/view/6431
CH_Bitminers_DLC.Config.EXP2SystemEnabled = false -- Elite XP System (EXP2) by Axspeo https://www.gmodstore.com/market/view/4316

CH_Bitminers_DLC.Config.XPHackingReward = 25 -- Amount of experience to give on successfully hacking a bitminer.
--addons/ch_bitminers/lua/ch_bitminers/shared/bitminers_config.lua:
return gluapack()()
--addons/ch_mayor/lua/ch_adv_mayor/shared/config/upgrades/upgrade_health.lua:
CH_Mayor.Upgrades_HealthAmount = 0

CH_Mayor.Upgrades["upgrade_health"] = {
	Name = "Sağlık Sigortası",
	Icon = Material( "materials/craphead_scripts/advanced_mayor/gui/upgrades/health.png", "noclamp smooth" ),
	Description = "Resmi görevlilerin sağlık sigortasını yükseltir.",
	Levels = {
		[1] = {
			Price = 75000,
			Description = "Tüm hükümet takımlarına 10 ekstra HP verir.",
			UpgradeFunction = function( ply )
				CH_Mayor.Upgrades_HealthAmount = 10

				hook.Add( "PlayerSpawn", "CH_Mayor_Upgrades_Health", function( ply )
					timer.Simple( 0.1, function()
						if ply:CH_Mayor_IsGovTeam() then
							ply:SetHealth( ply:Health() + CH_Mayor.Upgrades_HealthAmount )
						end
					end )
				end )
			end,
		},
		[2] = {
			Price = 150000,
			Description = "Tüm hükümet takımlarına 20 ekstra HP verir.",
			UpgradeFunction = function( ply )
				CH_Mayor.Upgrades_HealthAmount = 20
			end,
		},
		[3] = {
			Price = 210000,
			Description = "Tüm hükümet takımlarına 30 ekstra HP verir.",
			UpgradeFunction = function( ply )
				CH_Mayor.Upgrades_HealthAmount = 30
			end,
		},
		[4] = {
			Price = 280000,
			Description = "Tüm hükümet takımlarına 40 ekstra HP verir.",
			UpgradeFunction = function( ply )
				CH_Mayor.Upgrades_HealthAmount = 40
			end,
		},
		[5] = {
			Price = 350000,
			Description = "Tüm hükümet takımlarına 50 ekstra HP verir.",
			UpgradeFunction = function( ply )
				CH_Mayor.Upgrades_HealthAmount = 50
			end,
		},
	},
	RemoveFunction = function( ply )
		hook.Remove( "PlayerSpawn", "CH_Mayor_Upgrades_Health" )
		
		CH_Mayor.Upgrades_HealthAmount = 0
	end,
}

--addons/ch_mayor/lua/ch_adv_mayor/shared/config/upgrades/upgrade_kevlar.lua:
CH_Mayor.Upgrades_ArmorAmount = 0

CH_Mayor.Upgrades["upgrade_kevlar"] = {
	Name = "Zırh",
	Icon = Material( "materials/craphead_scripts/advanced_mayor/gui/upgrades/kevlar.png", "noclamp smooth" ),
	Description = "Polis memurlarınızı ekstra kurşun geçirmez kevlar ile donatın.",
	Levels = {
		[1] = {
			Price = 250000,
			Description = "Hükümet takımlarına 50 ekstra kevlar verir.",
			UpgradeFunction = function( ply )
				CH_Mayor.Upgrades_ArmorAmount = 50

				hook.Add( "PlayerSpawn", "CH_Mayor_Upgrades_Kevlar", function( ply )
					timer.Simple( 0.1, function()
						if ply:CH_Mayor_IsPoliceTeam() then
							ply:SetArmor( ply:Armor() + CH_Mayor.Upgrades_ArmorAmount )
						end
					end )
				end )
			end,
		},
		[2] = {
			Price = 270000,
			Description = "Hükümet takımlarına 60 ekstra kevlar verir.",
			UpgradeFunction = function( ply )
				CH_Mayor.Upgrades_ArmorAmount = 60
			end,
		},
		[3] = {
			Price = 290000,
			Description = "Hükümet takımlarına 70 ekstra kevlar verir.",
			UpgradeFunction = function( ply )
				CH_Mayor.Upgrades_ArmorAmount = 70
			end,
		},
		[4] = {
			Price = 320000, -- 1350 yerine mantıken 13500 olmalı (kontrol edebilirsin)
			Description = "Hükümet takımlarına 80 ekstra kevlar verir.",
			UpgradeFunction = function( ply )
				CH_Mayor.Upgrades_ArmorAmount = 80
			end,
		},
		[5] = {
			Price = 350000,
			Description = "Hükümet takımlarına 90 ekstra kevlar verir.",
			UpgradeFunction = function( ply )
				CH_Mayor.Upgrades_ArmorAmount = 90
			end,
		},
	},
	RemoveFunction = function( ply )
		hook.Remove( "PlayerSpawn", "CH_Mayor_Upgrades_Kevlar" )
		
		CH_Mayor.Upgrades_ArmorAmount = 0
	end,
}

--addons/ch_mayor/lua/ch_adv_mayor/client/ch_mayor_upgrades.lua:
return gluapack()()
--addons/ch_mayor/lua/ch_adv_mayor/client/ch_mayor_vault.lua:
CH_Mayor.DepositAmount = 0
CH_Mayor.DepositLimit = CH_Mayor.Config.DepositMaximumPerMayor

CH_Mayor.WithdrawAmount = 0
CH_Mayor.WithdrawLimit = CH_Mayor.Config.WithdrawMaximumPerMayor

net.Receive( "CH_Mayor_Net_NetworkWithdrawDepositLimit", function( length, ply )
	local deposit = net.ReadUInt( 32 )
	local deposit_max = net.ReadUInt( 32 )
	
	local withdraw = net.ReadUInt( 32 )
	local withdraw_max = net.ReadUInt( 32 )
	
	CH_Mayor.DepositAmount = deposit
	CH_Mayor.DepositLimit = deposit_max

	CH_Mayor.WithdrawAmount = withdraw
	CH_Mayor.WithdrawLimit = withdraw_max
end )
--addons/ch_mayor/lua/ch_adv_mayor/client/vgui/ch_mayor_menu_dashboard.lua:
return gluapack()()
--addons/ch_mayor/lua/ch_adv_mayor/client/vgui/ch_mayor_menu_statistics.lua:
--[[
	MAYOR DASHBOARD MENU
--]]
function CH_Mayor.StatisticsMenu()
	local ply = LocalPlayer()

	local GUI_StatisticsFrame = vgui.Create( "DFrame" )
	GUI_StatisticsFrame:SetTitle( "" )
	GUI_StatisticsFrame:SetSize( CH_Mayor.ScrW * 0.6, CH_Mayor.ScrH * 0.665 )
	GUI_StatisticsFrame:Center()
	GUI_StatisticsFrame.Paint = function( self, w, h )
		-- Draw frame
		surface.SetDrawColor( CH_Mayor.Colors.GrayFront )
		surface.DrawRect( 0, 0, w, h )
		
		-- Draw top
		surface.SetDrawColor( CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h * 0.059 )
		
		-- Draw the top title.
		draw.SimpleText( CH_Mayor.LangString( "City Management" ), "CH_Mayor_Font_Size10", w / 2, h * 0.03, color_white, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER )
	end
	GUI_StatisticsFrame:MakePopup()
	GUI_StatisticsFrame:SetDraggable( false )
	GUI_StatisticsFrame:ShowCloseButton( false )
	
	local GUI_CloseMenu = vgui.Create( "DButton", GUI_StatisticsFrame )
	GUI_CloseMenu:SetPos( CH_Mayor.ScrW * 0.582, CH_Mayor.ScrH * 0.01 )
	GUI_CloseMenu:SetSize( CH_Mayor.ScrW * 0.0125, CH_Mayor.ScrH * 0.02223 )
	GUI_CloseMenu:SetText( "" )
	GUI_CloseMenu.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mayor.Colors.Red or color_white )
		surface.SetMaterial( CH_Mayor.Materials.CloseIcon )
		surface.DrawTexturedRect( 0, 0, CH_Mayor.ScrW * 0.0125, CH_Mayor.ScrH * 0.02223 )
	end
	GUI_CloseMenu.DoClick = function()
		GUI_StatisticsFrame:Remove()
	end
	
	local GUI_DashboardFrameBtn = vgui.Create( "DButton", GUI_StatisticsFrame )
	GUI_DashboardFrameBtn:SetSize( CH_Mayor.ScrW * 0.1, CH_Mayor.ScrH * 0.04 )
	GUI_DashboardFrameBtn:SetPos( CH_Mayor.ScrW * 0.005, CH_Mayor.ScrH * 0.0475 )
	GUI_DashboardFrameBtn:SetText( "" )
	GUI_DashboardFrameBtn.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mayor.Colors.GMSBlue or CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h )

		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mayor.Materials.Icon_Dashboard )
		surface.DrawTexturedRect( w * 0.065, h * 0.18, CH_Mayor.ScrW * 0.014065, CH_Mayor.ScrH * 0.025 )
		
		draw.SimpleText( CH_Mayor.LangString( "Dashboard" ), "CH_Mayor_Font_Size9", w * 0.25, h / 2, self:IsHovered() and color_white or CH_Mayor.Colors.WhiteAlpha2, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
	end
	GUI_DashboardFrameBtn.DoClick = function()
		GUI_StatisticsFrame:Remove()
		
		CH_Mayor.DashboardMenu()
	end

	local GUI_UpgradesFrameBtn = vgui.Create( "DButton", GUI_StatisticsFrame )
	GUI_UpgradesFrameBtn:SetSize( CH_Mayor.ScrW * 0.1, CH_Mayor.ScrH * 0.04 )
	GUI_UpgradesFrameBtn:SetPos( CH_Mayor.ScrW * 0.005, CH_Mayor.ScrH * 0.095 )
	GUI_UpgradesFrameBtn:SetText( "" )
	GUI_UpgradesFrameBtn.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mayor.Colors.GMSBlue or CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h )

		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mayor.Materials.Icon_Upgrades )
		surface.DrawTexturedRect( w * 0.065, h * 0.18, CH_Mayor.ScrW * 0.014065, CH_Mayor.ScrH * 0.025 )
		
		draw.SimpleText( CH_Mayor.LangString( "Upgrades" ), "CH_Mayor_Font_Size9", w * 0.25, h / 2, self:IsHovered() and color_white or CH_Mayor.Colors.WhiteAlpha2, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
	end
	GUI_UpgradesFrameBtn.DoClick = function()
		GUI_StatisticsFrame:Remove()
		
		CH_Mayor.UpgradesMenu()
	end
	
	local GUI_TaxesFrameBtn = vgui.Create( "DButton", GUI_StatisticsFrame )
	GUI_TaxesFrameBtn:SetSize( CH_Mayor.ScrW * 0.1, CH_Mayor.ScrH * 0.04 )
	GUI_TaxesFrameBtn:SetPos( CH_Mayor.ScrW * 0.005, CH_Mayor.ScrH * 0.1425 )
	GUI_TaxesFrameBtn:SetText( "" )
	GUI_TaxesFrameBtn.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mayor.Colors.GMSBlue or CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h )

		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mayor.Materials.Icon_Taxes )
		surface.DrawTexturedRect( w * 0.065, h * 0.18, CH_Mayor.ScrW * 0.014065, CH_Mayor.ScrH * 0.025 )
		
		draw.SimpleText( CH_Mayor.LangString( "Taxes" ), "CH_Mayor_Font_Size9", w * 0.25, h / 2, self:IsHovered() and color_white or CH_Mayor.Colors.WhiteAlpha2, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
	end
	GUI_TaxesFrameBtn.DoClick = function()
		GUI_StatisticsFrame:Remove()
		
		CH_Mayor.TaxesMenu()
	end

	local GUI_CatalogFrameBtn = vgui.Create( "DButton", GUI_StatisticsFrame )
	GUI_CatalogFrameBtn:SetSize( CH_Mayor.ScrW * 0.1, CH_Mayor.ScrH * 0.04 )
	GUI_CatalogFrameBtn:SetPos( CH_Mayor.ScrW * 0.005, CH_Mayor.ScrH * 0.19 )
	GUI_CatalogFrameBtn:SetText( "" )
	GUI_CatalogFrameBtn.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mayor.Colors.GMSBlue or CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h )

		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mayor.Materials.Icon_Catalog )
		surface.DrawTexturedRect( w * 0.065, h * 0.18, CH_Mayor.ScrW * 0.014065, CH_Mayor.ScrH * 0.025 )
		
		draw.SimpleText( CH_Mayor.LangString( "Catalog" ), "CH_Mayor_Font_Size9", w * 0.25, h / 2, self:IsHovered() and color_white or CH_Mayor.Colors.WhiteAlpha2, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
	end
	GUI_CatalogFrameBtn.DoClick = function()
		GUI_StatisticsFrame:Remove()
		
		CH_Mayor.CatalogMenu()
	end
	
	local GUI_LawsFrameBtn = vgui.Create( "DButton", GUI_StatisticsFrame )
	GUI_LawsFrameBtn:SetSize( CH_Mayor.ScrW * 0.1, CH_Mayor.ScrH * 0.04 )
	GUI_LawsFrameBtn:SetPos( CH_Mayor.ScrW * 0.005, CH_Mayor.ScrH * 0.2375 )
	GUI_LawsFrameBtn:SetText( "" )
	GUI_LawsFrameBtn.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mayor.Colors.GMSBlue or CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h )
		
		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mayor.Materials.Icon_Laws )
		surface.DrawTexturedRect( w * 0.065, h * 0.18, CH_Mayor.ScrW * 0.014065, CH_Mayor.ScrH * 0.025 )
		
		draw.SimpleText( CH_Mayor.LangString( "Laws" ), "CH_Mayor_Font_Size9", w * 0.25, h / 2, self:IsHovered() and color_white or CH_Mayor.Colors.WhiteAlpha2, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
	end
	GUI_LawsFrameBtn.DoClick = function()
		GUI_StatisticsFrame:Remove()
		
		CH_Mayor.LawsMenu()
	end
	
	local GUI_LicensesFrameBtn = vgui.Create( "DButton", GUI_StatisticsFrame )
	GUI_LicensesFrameBtn:SetSize( CH_Mayor.ScrW * 0.1, CH_Mayor.ScrH * 0.04 )
	GUI_LicensesFrameBtn:SetPos( CH_Mayor.ScrW * 0.005, CH_Mayor.ScrH * 0.285 )
	GUI_LicensesFrameBtn:SetText( "" )
	GUI_LicensesFrameBtn.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mayor.Colors.GMSBlue or CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h )

		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mayor.Materials.Icon_Licenses )
		surface.DrawTexturedRect( w * 0.065, h * 0.18, CH_Mayor.ScrW * 0.014065, CH_Mayor.ScrH * 0.025 )
		
		draw.SimpleText( CH_Mayor.LangString( "Licenses" ), "CH_Mayor_Font_Size9", w * 0.25, h / 2, self:IsHovered() and color_white or CH_Mayor.Colors.WhiteAlpha2, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
	end
	GUI_LicensesFrameBtn.DoClick = function()
		GUI_StatisticsFrame:Remove()
		
		CH_Mayor.LicensesMenu( )
	end
	
	local GUI_OfficialsManagementFrameBtn = vgui.Create( "DButton", GUI_StatisticsFrame )
	GUI_OfficialsManagementFrameBtn:SetSize( CH_Mayor.ScrW * 0.1, CH_Mayor.ScrH * 0.04 )
	GUI_OfficialsManagementFrameBtn:SetPos( CH_Mayor.ScrW * 0.005, CH_Mayor.ScrH * 0.3325 )
	GUI_OfficialsManagementFrameBtn:SetText( "" )
	GUI_OfficialsManagementFrameBtn.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mayor.Colors.GMSBlue or CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h )

		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mayor.Materials.Icon_OfficialsManagement )
		surface.DrawTexturedRect( w * 0.065, h * 0.18, CH_Mayor.ScrW * 0.014065, CH_Mayor.ScrH * 0.025 )
		
		draw.SimpleText( CH_Mayor.LangString( "Officials" ), "CH_Mayor_Font_Size9", w * 0.25, h / 2, self:IsHovered() and color_white or CH_Mayor.Colors.WhiteAlpha2, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
	end
	GUI_OfficialsManagementFrameBtn.DoClick = function()
		GUI_StatisticsFrame:Remove()
		
		CH_Mayor.OfficialsMenu()
	end
	
	local GUI_CiviliansManagementFrameBtn = vgui.Create( "DButton", GUI_StatisticsFrame )
	GUI_CiviliansManagementFrameBtn:SetSize( CH_Mayor.ScrW * 0.1, CH_Mayor.ScrH * 0.04 )
	GUI_CiviliansManagementFrameBtn:SetPos( CH_Mayor.ScrW * 0.005, CH_Mayor.ScrH * 0.38 )
	GUI_CiviliansManagementFrameBtn:SetText( "" )
	GUI_CiviliansManagementFrameBtn.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mayor.Colors.GMSBlue or CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h )

		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mayor.Materials.Icon_CivilianManagement )
		surface.DrawTexturedRect( w * 0.065, h * 0.18, CH_Mayor.ScrW * 0.014065, CH_Mayor.ScrH * 0.025 )
		
		draw.SimpleText( CH_Mayor.LangString( "Civilians" ), "CH_Mayor_Font_Size9", w * 0.25, h / 2, self:IsHovered() and color_white or CH_Mayor.Colors.WhiteAlpha2, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
	end
	GUI_CiviliansManagementFrameBtn.DoClick = function()
		GUI_StatisticsFrame:Remove()
		
		CH_Mayor.CiviliansMenu()
	end
	
	local GUI_WantedFrameBtn = vgui.Create( "DButton", GUI_StatisticsFrame )
	GUI_WantedFrameBtn:SetSize( CH_Mayor.ScrW * 0.1, CH_Mayor.ScrH * 0.04 )
	GUI_WantedFrameBtn:SetPos( CH_Mayor.ScrW * 0.005, CH_Mayor.ScrH * 0.4275 )
	GUI_WantedFrameBtn:SetText( "" )
	GUI_WantedFrameBtn.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mayor.Colors.GMSBlue or CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h )

		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mayor.Materials.Icon_Wanted )
		surface.DrawTexturedRect( w * 0.065, h * 0.18, CH_Mayor.ScrW * 0.014065, CH_Mayor.ScrH * 0.025 )
		
		draw.SimpleText( CH_Mayor.LangString( "Wanted" ), "CH_Mayor_Font_Size9", w * 0.25, h / 2, self:IsHovered() and color_white or CH_Mayor.Colors.WhiteAlpha2, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
	end
	GUI_WantedFrameBtn.DoClick = function()
		GUI_StatisticsFrame:Remove()
		
		CH_Mayor.WantedMenu()
	end
	
	local GUI_WarrantFrameBtn = vgui.Create( "DButton", GUI_StatisticsFrame )
	GUI_WarrantFrameBtn:SetSize( CH_Mayor.ScrW * 0.1, CH_Mayor.ScrH * 0.04 )
	GUI_WarrantFrameBtn:SetPos( CH_Mayor.ScrW * 0.005, CH_Mayor.ScrH * 0.475 )
	GUI_WarrantFrameBtn:SetText( "" )
	GUI_WarrantFrameBtn.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mayor.Colors.GMSBlue or CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h )

		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mayor.Materials.Icon_Warrant )
		surface.DrawTexturedRect( w * 0.065, h * 0.18, CH_Mayor.ScrW * 0.014065, CH_Mayor.ScrH * 0.025 )
		
		draw.SimpleText( CH_Mayor.LangString( "Warrant" ), "CH_Mayor_Font_Size9", w * 0.25, h / 2, self:IsHovered() and color_white or CH_Mayor.Colors.WhiteAlpha2, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
	end
	GUI_WarrantFrameBtn.DoClick = function()
		GUI_StatisticsFrame:Remove()
		
		CH_Mayor.WarrantMenu()
	end
	
	local GUI_AnnouncementFrameBtn = vgui.Create( "DButton", GUI_StatisticsFrame )
	GUI_AnnouncementFrameBtn:SetSize( CH_Mayor.ScrW * 0.1, CH_Mayor.ScrH * 0.04 )
	GUI_AnnouncementFrameBtn:SetPos( CH_Mayor.ScrW * 0.005, CH_Mayor.ScrH * 0.5225 )
	GUI_AnnouncementFrameBtn:SetText( "" )
	GUI_AnnouncementFrameBtn.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mayor.Colors.GMSBlue or CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h )

		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mayor.Materials.Icon_Announcement )
		surface.DrawTexturedRect( w * 0.065, h * 0.18, CH_Mayor.ScrW * 0.014065, CH_Mayor.ScrH * 0.025 )
		
		draw.SimpleText( CH_Mayor.LangString( "Announcement" ), "CH_Mayor_Font_Size9", w * 0.25, h / 2, self:IsHovered() and color_white or CH_Mayor.Colors.WhiteAlpha2, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
	end
	GUI_AnnouncementFrameBtn.DoClick = function()
		GUI_StatisticsFrame:Remove()
		
		CH_Mayor.AnnouncementMenu()
	end
	
	local GUI_LockdownFrameBtn = vgui.Create( "DButton", GUI_StatisticsFrame )
	GUI_LockdownFrameBtn:SetSize( CH_Mayor.ScrW * 0.1, CH_Mayor.ScrH * 0.04 )
	GUI_LockdownFrameBtn:SetPos( CH_Mayor.ScrW * 0.005, CH_Mayor.ScrH * 0.57 )
	GUI_LockdownFrameBtn:SetText( "" )
	GUI_LockdownFrameBtn.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mayor.Colors.GMSBlue or CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h )

		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mayor.Materials.Icon_Lockdown )
		surface.DrawTexturedRect( w * 0.065, h * 0.18, CH_Mayor.ScrW * 0.014065, CH_Mayor.ScrH * 0.025 )
		
		draw.SimpleText( CH_Mayor.LangString( "Lockdown" ), "CH_Mayor_Font_Size9", w * 0.25, h / 2, self:IsHovered() and color_white or CH_Mayor.Colors.WhiteAlpha2, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
	end
	GUI_LockdownFrameBtn.DoClick = function()
		GUI_StatisticsFrame:Remove()
		
		CH_Mayor.LockdownMenu()
	end
	
	local GUI_StatsFrameBtn = vgui.Create( "DButton", GUI_StatisticsFrame )
	GUI_StatsFrameBtn:SetSize( CH_Mayor.ScrW * 0.1, CH_Mayor.ScrH * 0.04 )
	GUI_StatsFrameBtn:SetPos( CH_Mayor.ScrW * 0.005, CH_Mayor.ScrH * 0.6175 )
	GUI_StatsFrameBtn:SetText( "" )
	GUI_StatsFrameBtn.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mayor.Colors.GMSBlue or CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h )

		surface.SetDrawColor( CH_Mayor.Colors.GMSBlue )
		surface.DrawRect( 0, 0, 2, h )
		
		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mayor.Materials.Icon_Economy )
		surface.DrawTexturedRect( w * 0.065, h * 0.18, CH_Mayor.ScrW * 0.014065, CH_Mayor.ScrH * 0.025 )
		
		draw.SimpleText( CH_Mayor.LangString( "Statistics" ), "CH_Mayor_Font_Size9", w * 0.25, h / 2, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
	end
	GUI_StatsFrameBtn.DoClick = function()
		GUI_StatisticsFrame:Remove()
		
		CH_Mayor.StatisticsMenu()
	end
	
	-- The statistics panel
	local GUI_StatsPanel = vgui.Create( "DPanel", GUI_StatisticsFrame )
	GUI_StatsPanel:SetSize( CH_Mayor.ScrW * 0.487, CH_Mayor.ScrH * 0.6 )
	GUI_StatsPanel:SetPos( CH_Mayor.ScrW * 0.109, CH_Mayor.ScrH * 0.0475 )
	GUI_StatsPanel.Paint = function( self, w, h )
		-- Background
		surface.SetDrawColor( color_transparent )
		surface.DrawRect( 0, 0, w, h )
		
		-- Top box with info
		surface.SetDrawColor( CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h * 0.146 )
		
		surface.SetFont( "CH_Mayor_Font_Size14" )
		local welcome_back = CH_Mayor.LangString( "Hey" ) ..", ".. ply:Nick()
		local x, y = surface.GetTextSize( welcome_back )

		draw.SimpleText( welcome_back, "CH_Mayor_Font_Size14", w * 0.01, h * 0.04, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )

		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mayor.Materials.WavingHand )
		surface.DrawTexturedRect( w * 0.01 + ( x + CH_Mayor.ScrW * 0.005 ), h * 0.0225, 28, 28 )

		draw.SimpleText( CH_Mayor.LangString( "Here are your overall personal mayor statistics." ), "CH_Mayor_Font_Size9", w * 0.01, h * 0.1, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
		
		-- Make sure stats are loaded
		if not ply.CH_Mayor_Stats then
			return
		end
		
		-- Stat 1
		surface.SetDrawColor( CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, CH_Mayor.ScrH * 0.095, w, CH_Mayor.ScrH * 0.04 )

		draw.SimpleText( CH_Mayor.LangString( "Total warrants placed" ), "CH_Mayor_Font_Size10", w * 0.01, h * 0.189, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
		draw.SimpleText( string.Comma( ply.CH_Mayor_Stats[ "WarrantsPlaced" ] ) .." ".. CH_Mayor.LangString( "warrants" ), "CH_Mayor_Font_Size10", w * 0.99, h * 0.189, color_white, TEXT_ALIGN_RIGHT, TEXT_ALIGN_CENTER )
		
		-- Stat 2
		surface.SetDrawColor( CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, CH_Mayor.ScrH * 0.1425, w, CH_Mayor.ScrH * 0.04 )
		
		draw.SimpleText( CH_Mayor.LangString( "Total players wanted" ), "CH_Mayor_Font_Size10", w * 0.01, h * 0.267, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
		draw.SimpleText( string.Comma( ply.CH_Mayor_Stats[ "PlayersWanted" ] ) .." ".. CH_Mayor.LangString( "players" ), "CH_Mayor_Font_Size10", w * 0.99, h * 0.267, color_white, TEXT_ALIGN_RIGHT, TEXT_ALIGN_CENTER )

		-- Stat 3
		surface.SetDrawColor( CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, CH_Mayor.ScrH * 0.19, w, CH_Mayor.ScrH * 0.04 )
		
		draw.SimpleText( CH_Mayor.LangString( "Total times elected as mayor" ), "CH_Mayor_Font_Size10", w * 0.01, h * 0.35, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
		draw.SimpleText( string.Comma( ply.CH_Mayor_Stats[ "TimesElected" ] ) .." ".. CH_Mayor.LangString( "times" ), "CH_Mayor_Font_Size10", w * 0.99, h * 0.35, color_white, TEXT_ALIGN_RIGHT, TEXT_ALIGN_CENTER )
		
		-- Stat 4
		surface.SetDrawColor( CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, CH_Mayor.ScrH * 0.2375, w, CH_Mayor.ScrH * 0.04 )
		
		draw.SimpleText( CH_Mayor.LangString( "Total successful vault robbies during your period" ), "CH_Mayor_Font_Size10", w * 0.01, h * 0.427, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
		draw.SimpleText( string.Comma( ply.CH_Mayor_Stats[ "VaultRobbed" ] ) .." ".. CH_Mayor.LangString( "robberies" ), "CH_Mayor_Font_Size10", w * 0.99, h * 0.427, color_white, TEXT_ALIGN_RIGHT, TEXT_ALIGN_CENTER )
		
		-- Stat 5
		surface.SetDrawColor( CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, CH_Mayor.ScrH * 0.285, w, CH_Mayor.ScrH * 0.04 )
		
		draw.SimpleText( CH_Mayor.LangString( "Total playtime as mayor" ), "CH_Mayor_Font_Size10", w * 0.01, h * 0.505, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
		draw.SimpleText( CH_Mayor.FormatPlaytime( ply.CH_Mayor_Stats[ "TotalPlaytime" ] ), "CH_Mayor_Font_Size10", w * 0.99, h * 0.505, color_white, TEXT_ALIGN_RIGHT, TEXT_ALIGN_CENTER )
		
		-- Stat 6
		surface.SetDrawColor( CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, CH_Mayor.ScrH * 0.3325, w, CH_Mayor.ScrH * 0.04 )
		
		draw.SimpleText( CH_Mayor.LangString( "Total players demoted" ), "CH_Mayor_Font_Size10", w * 0.01, h * 0.585, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
		draw.SimpleText( string.Comma( ply.CH_Mayor_Stats[ "PlayersDemoted" ] ) .." ".. CH_Mayor.LangString( "players" ), "CH_Mayor_Font_Size10", w * 0.99, h * 0.585, color_white, TEXT_ALIGN_RIGHT, TEXT_ALIGN_CENTER )
		
		-- Stat 7
		surface.SetDrawColor( CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, CH_Mayor.ScrH * 0.38, w, CH_Mayor.ScrH * 0.04 )
		
		draw.SimpleText( CH_Mayor.LangString( "Total players promoted" ), "CH_Mayor_Font_Size10", w * 0.01, h * 0.665, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
		draw.SimpleText( string.Comma( ply.CH_Mayor_Stats[ "PlayersPromoted" ] ) .." ".. CH_Mayor.LangString( "players" ), "CH_Mayor_Font_Size10", w * 0.99, h * 0.665, color_white, TEXT_ALIGN_RIGHT, TEXT_ALIGN_CENTER )
		
		-- Stat 8
		surface.SetDrawColor( CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, CH_Mayor.ScrH * 0.4275, w, CH_Mayor.ScrH * 0.04 )
		
		draw.SimpleText( CH_Mayor.LangString( "Total capital added to the mayor vault yourself" ), "CH_Mayor_Font_Size10", w * 0.01, h * 0.7425, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
		draw.SimpleText( DarkRP.formatMoney( ply.CH_Mayor_Stats[ "CapitalAdded" ] ), "CH_Mayor_Font_Size10", w * 0.99, h * 0.7425, color_white, TEXT_ALIGN_RIGHT, TEXT_ALIGN_CENTER )
		
		-- Stat 8
		surface.SetDrawColor( CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, CH_Mayor.ScrH * 0.475, w, CH_Mayor.ScrH * 0.04 )
		
		draw.SimpleText( CH_Mayor.LangString( "Total lockdowns initiated" ), "CH_Mayor_Font_Size10", w * 0.01, h * 0.8225, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
		draw.SimpleText( string.Comma( ply.CH_Mayor_Stats[ "LockdownsInitiated" ] ) .." ".. CH_Mayor.LangString( "lockdowns" ), "CH_Mayor_Font_Size10", w * 0.99, h * 0.8225, color_white, TEXT_ALIGN_RIGHT, TEXT_ALIGN_CENTER )
		
		-- Stat 9
		surface.SetDrawColor( CH_Mayor.Colors.GrayBG )
		surface.DrawRect( 0, CH_Mayor.ScrH * 0.5225, w, CH_Mayor.ScrH * 0.04 )
		
		draw.SimpleText( CH_Mayor.LangString( "Total lotteries started" ), "CH_Mayor_Font_Size10", w * 0.01, h * 0.902, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
		draw.SimpleText( string.Comma( ply.CH_Mayor_Stats[ "LotteriesStarted" ] ) .." ".. CH_Mayor.LangString( "lotteries" ), "CH_Mayor_Font_Size10", w * 0.99, h * 0.902, color_white, TEXT_ALIGN_RIGHT, TEXT_ALIGN_CENTER )
	end
end
--addons/ch_mining/lua/ch_mining/shared/config/ch_mining_config_rocks.lua:
CH_Mining.Rocks = CH_Mining.Rocks or {}

--[[
    READ THIS ARTICLE HOW TO EDIT THIS FILE
    
    YOU CANNOT ADD NEW ROCKS! ONLY MODIFY EXISTING ONES
    
    https://www.gmodstore.com/help/addon/mining/configuration-16/topics/rocks
--]]

CH_Mining.Rocks["Gold"] = {
    Name = "Gold",
    Color = Color( 255, 215, 0, 255 ),
    BasePrice = 100,
    MaxPriceAdjust = 1,
    MinimumLevel = 1,
}

CH_Mining.Rocks["Stone"] = {
    Name = "Stone",
    Color = Color( 136, 140, 141, 255 ),
    BasePrice = 50,
    MaxPriceAdjust = 1,
    MinimumLevel = 1,
}

CH_Mining.Rocks["Iron"] = {
    Name = "Iron",
    Color = Color( 161, 157, 178, 255 ),
    BasePrice = 80,
    MaxPriceAdjust = 1,
    MinimumLevel = 1,
}

CH_Mining.Rocks["Diamond"] = {
    Name = "Diamond",
    Color = Color( 185, 242, 255, 255 ),
    BasePrice = 150,
    MaxPriceAdjust = 1,
    MinimumLevel = 5,
}

CH_Mining.Rocks["Ruby"] = {
    Name = "Ruby",
    Color = Color( 155, 17, 30, 255 ),
    BasePrice = 60,
    MaxPriceAdjust = 1,
    MinimumLevel = 1,
}

CH_Mining.Rocks["Amethyst"] = {
    Name = "Amethyst",
    Color = Color( 153, 102, 204, 255 ),
    BasePrice = 50,
    MaxPriceAdjust = 1,
    MinimumLevel = 1,
}

CH_Mining.Rocks["Rare"] = {
    Name = "Rare",
    Color = Color( 241, 145, 155, 255 ),
    BasePrice = 80,
    MaxPriceAdjust = 1,
    MinimumLevel = 1,
}

CH_Mining.Rocks["Emerald"] = {
    Name = "Emerald",
    Color = Color( 31, 78, 47, 255 ),
    BasePrice = 100,
    MaxPriceAdjust = 1,
    MinimumLevel = 5,
}

CH_Mining.Rocks["Bloodstone"] = {
    Name = "Bloodstone",
    Color = Color( 112, 8, 8, 255 ),
    BasePrice = 70,
    MaxPriceAdjust = 1,
    MinimumLevel = 1,
}
--addons/ch_mining/lua/ch_mining/shared/ch_mining_xp.lua:
return gluapack()()
--addons/ch_mining/lua/ch_mining/shared/currencies/pointshop2.lua:
CH_Mining.Currencies[ "pointshop2" ] = {
	Name = "PointShop 2 Points",
	
	AddMoney = function( ply, amount )
		ply:PS2_AddStandardPoints( amount )
	end,
	
	TakeMoney = function( ply, amount )
		ply:PS2_AddStandardPoints( -amount )
	end,
	
	GetMoney = function( ply )
		return ply.PS2_Wallet.points
	end,
	
	CanAfford = function( ply, amount )
		return ply.PS2_Wallet.points >= amount
	end,
	
	FormatMoney = function( amount )
		return string.Comma( amount ) .. " point" .. (amount > 1 and "s" or "")
	end,
}
--addons/ch_mining/lua/ch_mining/shared/currencies/sh_pointshop.lua:
return gluapack()()
--addons/ch_mining/lua/ch_mining/client/ch_mining_client.lua:
--[[
	This is a method of ensuring that the player is loaded in, so we can network stuff to them (PlayerInitialSpawn is unreliable)
	-- 76561198314224586
--]]
function CH_Mining.IsPlayerLoadedIn()
	if IsValid( LocalPlayer() ) then
		net.Start( "CH_Mining_Net_HUDPaintLoad" )
		net.SendToServer()
		
		hook.Remove( "HUDPaint", "CH_Mining.IsPlayerLoadedIn" )
	end
end
hook.Add( "HUDPaint", "CH_Mining.IsPlayerLoadedIn", CH_Mining.IsPlayerLoadedIn )
--addons/ch_mining/lua/ch_mining/client/vgui/ch_mining_menu_options.lua:
return gluapack()()
--addons/ch_mining/lua/ch_mining/client/vgui/ch_mining_menu_options.lua:
--[[
	OPTIONS MENU
--]]
function CH_Mining.OptionsMenu()
	local ply = LocalPlayer()

	local GUI_OptionsFrame = vgui.Create( "DFrame" )
	GUI_OptionsFrame:SetTitle( "" )
	GUI_OptionsFrame:SetSize( CH_Mining.ScrW * 0.6, CH_Mining.ScrH * 0.6875 )
	GUI_OptionsFrame:Center()
	GUI_OptionsFrame.Paint = function( self, w, h )
		-- Draw frame
		surface.SetDrawColor( CH_Mining.Colors.GrayFront )
		surface.DrawRect( 0, 0, w, h )
		
		-- Draw top
		surface.SetDrawColor( CH_Mining.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h * 0.059 )
		
		-- Draw the top title.
		draw.SimpleText( CH_Mining.LangString( "Options" ), "CH_Mining_Font_Size10", w / 2, h * 0.03, color_white, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER )
	end
	GUI_OptionsFrame:MakePopup()
	GUI_OptionsFrame:SetDraggable( false )
	GUI_OptionsFrame:ShowCloseButton( false )
	
	local GUI_CloseMenu = vgui.Create( "DButton", GUI_OptionsFrame )
	GUI_CloseMenu:SetPos( CH_Mining.ScrW * 0.582, CH_Mining.ScrH * 0.01 )
	GUI_CloseMenu:SetSize( 24, 24 )
	GUI_CloseMenu:SetText( "" )
	GUI_CloseMenu.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mining.Colors.Red or color_white )
		surface.SetMaterial( CH_Mining.Materials.CloseIcon )
		surface.DrawTexturedRect( 0, 0, CH_Mining.ScrW * 0.0125, CH_Mining.ScrH * 0.02223 )
	end
	GUI_CloseMenu.DoClick = function()
		GUI_OptionsFrame:Remove()
	end
	
	local GUI_OptionsFrameBtn = vgui.Create( "DButton", GUI_OptionsFrame )
	GUI_OptionsFrameBtn:SetSize( CH_Mining.ScrW * 0.1, CH_Mining.ScrH * 0.04 )
	GUI_OptionsFrameBtn:SetPos( CH_Mining.ScrW * 0.005, CH_Mining.ScrH * 0.0475 )
	GUI_OptionsFrameBtn:SetText( "" )
	GUI_OptionsFrameBtn.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mining.Colors.GMSBlue or CH_Mining.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h )

		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mining.Materials.MenuDashboard )
		surface.DrawTexturedRect( w * 0.065, h * 0.2, CH_Mining.ScrW * 0.014065, CH_Mining.ScrH * 0.025 )
		
		draw.SimpleText( CH_Mining.LangString( "Dashboard" ), "CH_Mining_Font_Size9", w * 0.25, h / 2, self:IsHovered() and color_white or CH_Mining.Colors.WhiteAlpha2, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
	end
	GUI_OptionsFrameBtn.DoClick = function()
		GUI_OptionsFrame:Remove()
		
		CH_Mining.DashboardMenu()
	end

	local GUI_InventoryFrameBtn = vgui.Create( "DButton", GUI_OptionsFrame )
	GUI_InventoryFrameBtn:SetSize( CH_Mining.ScrW * 0.1, CH_Mining.ScrH * 0.04 )
	GUI_InventoryFrameBtn:SetPos( CH_Mining.ScrW * 0.005, CH_Mining.ScrH * 0.095 )
	GUI_InventoryFrameBtn:SetText( "" )
	GUI_InventoryFrameBtn.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mining.Colors.GMSBlue or CH_Mining.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h )

		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mining.Materials.MenuInventory )
		surface.DrawTexturedRect( w * 0.065, h * 0.2, CH_Mining.ScrW * 0.014065, CH_Mining.ScrH * 0.025 )
		
		draw.SimpleText( CH_Mining.LangString( "Inventory" ), "CH_Mining_Font_Size9", w * 0.25, h / 2, self:IsHovered() and color_white or CH_Mining.Colors.WhiteAlpha2, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
	end
	GUI_InventoryFrameBtn.DoClick = function()
		GUI_OptionsFrame:Remove()
		
		CH_Mining.InventoryMenu()
	end
	
	local GUI_SkillsFrameBtn = vgui.Create( "DButton", GUI_OptionsFrame )
	GUI_SkillsFrameBtn:SetSize( CH_Mining.ScrW * 0.1, CH_Mining.ScrH * 0.04 )
	GUI_SkillsFrameBtn:SetPos( CH_Mining.ScrW * 0.005, CH_Mining.ScrH * 0.1425 )
	GUI_SkillsFrameBtn:SetText( "" )
	GUI_SkillsFrameBtn.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mining.Colors.GMSBlue or CH_Mining.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h )

		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mining.Materials.MenuSkills )
		surface.DrawTexturedRect( w * 0.065, h * 0.2, CH_Mining.ScrW * 0.014065, CH_Mining.ScrH * 0.025 )
		
		draw.SimpleText( CH_Mining.LangString( "Skills" ), "CH_Mining_Font_Size9", w * 0.25, h / 2, self:IsHovered() and color_white or CH_Mining.Colors.WhiteAlpha2, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
	end
	GUI_SkillsFrameBtn.DoClick = function()
		GUI_OptionsFrame:Remove()
		
		CH_Mining.SkillsMenu()
	end

	local GUI_CraftingFrameBtn = vgui.Create( "DButton", GUI_OptionsFrame )
	GUI_CraftingFrameBtn:SetSize( CH_Mining.ScrW * 0.1, CH_Mining.ScrH * 0.04 )
	GUI_CraftingFrameBtn:SetPos( CH_Mining.ScrW * 0.005, CH_Mining.ScrH * 0.19 )
	GUI_CraftingFrameBtn:SetText( "" )
	GUI_CraftingFrameBtn.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mining.Colors.GMSBlue or CH_Mining.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h )

		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mining.Materials.MenuCrafting )
		surface.DrawTexturedRect( w * 0.065, h * 0.2, CH_Mining.ScrW * 0.014065, CH_Mining.ScrH * 0.025 )
		
		draw.SimpleText( CH_Mining.LangString( "Crafting" ), "CH_Mining_Font_Size9", w * 0.25, h / 2, self:IsHovered() and color_white or CH_Mining.Colors.WhiteAlpha2, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
	end
	GUI_CraftingFrameBtn.DoClick = function()
		GUI_OptionsFrame:Remove()
		
		CH_Mining.CraftingMenu()
	end

	local GUI_TransactionsFrameBtn = vgui.Create( "DButton", GUI_OptionsFrame )
	GUI_TransactionsFrameBtn:SetSize( CH_Mining.ScrW * 0.1, CH_Mining.ScrH * 0.04 )
	GUI_TransactionsFrameBtn:SetPos( CH_Mining.ScrW * 0.005, CH_Mining.ScrH * 0.2375 )
	GUI_TransactionsFrameBtn:SetText( "" )
	GUI_TransactionsFrameBtn.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mining.Colors.GMSBlue or CH_Mining.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h )

		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mining.Materials.MenuTransactions )
		surface.DrawTexturedRect( w * 0.065, h * 0.2, CH_Mining.ScrW * 0.014065, CH_Mining.ScrH * 0.025 )
		
		draw.SimpleText( CH_Mining.LangString( "Transactions" ), "CH_Mining_Font_Size9", w * 0.25, h / 2, self:IsHovered() and color_white or CH_Mining.Colors.WhiteAlpha2, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
	end
	GUI_TransactionsFrameBtn.DoClick = function()
		GUI_OptionsFrame:Remove()
		
		CH_Mining.TransactionsMenu()
	end
	
	local GUI_LeaderboardsFrameBtn = vgui.Create( "DButton", GUI_OptionsFrame )
	GUI_LeaderboardsFrameBtn:SetSize( CH_Mining.ScrW * 0.1, CH_Mining.ScrH * 0.04 )
	GUI_LeaderboardsFrameBtn:SetPos( CH_Mining.ScrW * 0.005, CH_Mining.ScrH * 0.285 )
	GUI_LeaderboardsFrameBtn:SetText( "" )
	GUI_LeaderboardsFrameBtn.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mining.Colors.GMSBlue or CH_Mining.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h )
		
		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mining.Materials.MenuLeaderboard )
		surface.DrawTexturedRect( w * 0.065, h * 0.2, CH_Mining.ScrW * 0.014065, CH_Mining.ScrH * 0.025 )
		
		draw.SimpleText( CH_Mining.LangString( "Leaderboards" ), "CH_Mining_Font_Size9", w * 0.25, h / 2, self:IsHovered() and color_white or CH_Mining.Colors.WhiteAlpha2, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
	end
	GUI_LeaderboardsFrameBtn.DoClick = function()
		GUI_OptionsFrame:Remove()
		
		CH_Mining.LeaderboardsMenu( "MineralsMined" )
	end
	
	local GUI_StatsFrameBtn = vgui.Create( "DButton", GUI_OptionsFrame )
	GUI_StatsFrameBtn:SetSize( CH_Mining.ScrW * 0.1, CH_Mining.ScrH * 0.04 )
	GUI_StatsFrameBtn:SetPos( CH_Mining.ScrW * 0.005, CH_Mining.ScrH * 0.3325 )
	GUI_StatsFrameBtn:SetText( "" )
	GUI_StatsFrameBtn.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mining.Colors.GMSBlue or CH_Mining.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h )
		
		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mining.Materials.MenuStats )
		surface.DrawTexturedRect( w * 0.065, h * 0.2, CH_Mining.ScrW * 0.014065, CH_Mining.ScrH * 0.025 )
		
		draw.SimpleText( CH_Mining.LangString( "Statistics" ), "CH_Mining_Font_Size9", w * 0.25, h / 2, self:IsHovered() and color_white or CH_Mining.Colors.WhiteAlpha2, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
	end
	GUI_StatsFrameBtn.DoClick = function()
		GUI_OptionsFrame:Remove()
		
		CH_Mining.StatsMenu()
	end
	
	local GUI_OptionsFrameBtn = vgui.Create( "DButton", GUI_OptionsFrame )
	GUI_OptionsFrameBtn:SetSize( CH_Mining.ScrW * 0.1, CH_Mining.ScrH * 0.04 )
	GUI_OptionsFrameBtn:SetPos( CH_Mining.ScrW * 0.005, CH_Mining.ScrH * 0.38 )
	GUI_OptionsFrameBtn:SetText( "" )
	GUI_OptionsFrameBtn.Paint = function( self, w, h )
		surface.SetDrawColor( self:IsHovered() and CH_Mining.Colors.GMSBlue or CH_Mining.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h )
		
		surface.SetDrawColor( CH_Mining.Colors.GMSBlue )
		surface.DrawRect( 0, 0, 2, h )
		
		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mining.Materials.MenuOptions )
		surface.DrawTexturedRect( w * 0.065, h * 0.2, CH_Mining.ScrW * 0.014065, CH_Mining.ScrH * 0.025 )
		
		draw.SimpleText( CH_Mining.LangString( "Options" ), "CH_Mining_Font_Size9", w * 0.25, h / 2, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
	end
	GUI_OptionsFrameBtn.DoClick = function()
		GUI_OptionsFrame:Remove()
		
		CH_Mining.OptionsMenu()
	end
	
	-- Options
	local should_show_inventory = GetConVar( "CH_Mining_DrawMiningInventory" ):GetInt()
	local should_show_level = GetConVar( "CH_Mining_DrawMiningLevel" ):GetInt()
	
	-- The options panel
	local GUI_OptionsPanel = vgui.Create( "DPanel", GUI_OptionsFrame )
	GUI_OptionsPanel:SetSize( CH_Mining.ScrW * 0.487, CH_Mining.ScrW * 0.356 )
	GUI_OptionsPanel:SetPos( CH_Mining.ScrW * 0.109, CH_Mining.ScrH * 0.0475 )
	GUI_OptionsPanel.Paint = function( self, w, h )
		-- Background
		surface.SetDrawColor( color_transparent )
		surface.DrawRect( 0, 0, w, h )
		
		-- Top box with info
		surface.SetDrawColor( CH_Mining.Colors.GrayBG )
		surface.DrawRect( 0, 0, w, h * 0.14 )
		
		surface.SetFont( "CH_Mining_Font_Size14" )
		local welcome_back = CH_Mining.LangString( "Hey" ) ..", ".. ply:Nick()
		local x, y = surface.GetTextSize( welcome_back )

		draw.SimpleText( welcome_back, "CH_Mining_Font_Size14", w * 0.01, h * 0.04, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )

		surface.SetDrawColor( color_white )
		surface.SetMaterial( CH_Mining.Materials.WavingHand )
		surface.DrawTexturedRect( w * 0.01 + ( x + CH_Mining.ScrW * 0.005 ), h * 0.0225, CH_Mining.ScrW * 0.014065, CH_Mining.ScrH * 0.025 )

		draw.SimpleText( CH_Mining.LangString( "These options allow you to customize your mining experience." ), "CH_Mining_Font_Size10", w * 0.01, h * 0.1, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
		
		-- Show inventory option box
		surface.SetDrawColor( CH_Mining.Colors.GrayBG )
		surface.DrawRect( 0, h * 0.15, w, h * 0.065 )
		
		draw.SimpleText( "Display mineral inventory on HUD?", "CH_Mining_Font_Size10", w * 0.01, h * 0.18, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
		
		-- Show inventory option box
		surface.SetDrawColor( CH_Mining.Colors.GrayBG )
		surface.DrawRect( 0, h * 0.2255, w, h * 0.065 )
		
		draw.SimpleText( "Display level progress on HUD?", "CH_Mining_Font_Size10", w * 0.01, h * 0.255, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
		
		-- Show inventory HUD x pos
		surface.SetDrawColor( CH_Mining.Colors.GrayBG )
		surface.DrawRect( 0, h * 0.3005, w, h * 0.065 )
		
		draw.SimpleText( "X position for the inventory HUD", "CH_Mining_Font_Size10", w * 0.01, h * 0.33, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
		
		-- Show inventory HUD y pos
		surface.SetDrawColor( CH_Mining.Colors.GrayBG )
		surface.DrawRect( 0, h * 0.376, w, h * 0.065 )
		
		draw.SimpleText( "Y position for the inventory HUD", "CH_Mining_Font_Size10", w * 0.01, h * 0.405, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
		
		-- Show level HUD x pos
		surface.SetDrawColor( CH_Mining.Colors.GrayBG )
		surface.DrawRect( 0, h * 0.451, w, h * 0.065 )
		
		draw.SimpleText( "X position for the level HUD", "CH_Mining_Font_Size10", w * 0.01, h * 0.48, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
		
		-- Show level HUD y pos
		surface.SetDrawColor( CH_Mining.Colors.GrayBG )
		surface.DrawRect( 0, h * 0.52575, w, h * 0.065 )
		
		draw.SimpleText( "Y position for the level HUD", "CH_Mining_Font_Size10", w * 0.01, h * 0.555, color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
	end

	local GUI_Option_ShowInventoryHUD = vgui.Create( "DCheckBox", GUI_OptionsPanel )
	GUI_Option_ShowInventoryHUD:SetPos( CH_Mining.ScrW * 0.46, CH_Mining.ScrW * 0.055 )
	GUI_Option_ShowInventoryHUD:SetSize( CH_Mining.ScrW * 0.032, CH_Mining.ScrW * 0.02 )
	if should_show_inventory == 1 then
		GUI_Option_ShowInventoryHUD:SetValue( true )
	else
		GUI_Option_ShowInventoryHUD:SetValue( false )
	end
	GUI_Option_ShowInventoryHUD.Paint = function( self, w, h )
		if self:GetChecked() then
			surface.SetDrawColor( CH_Mining.Colors.Green )
			surface.SetMaterial( CH_Mining.Materials.CheckmarkIcon )
		else
			surface.SetDrawColor( CH_Mining.Colors.Red )
			surface.SetMaterial( CH_Mining.Materials.CloseIcon )
		end
		surface.DrawTexturedRect( w / 2 - (CH_Mining.ScrW * 0.00625), h / 2 - (CH_Mining.ScrH * 0.011115), CH_Mining.ScrW * 0.0125, CH_Mining.ScrH * 0.02223 )
	end
	GUI_Option_ShowInventoryHUD.OnChange = function( self, checked )
		if checked then
			ply:ConCommand( "CH_Mining_DrawMiningInventory 1" )
		else
			ply:ConCommand( "CH_Mining_DrawMiningInventory 0" )
		end
	end
	
	local GUI_Option_ShowLevelHUD = vgui.Create( "DCheckBox", GUI_OptionsPanel )
	GUI_Option_ShowLevelHUD:SetPos( CH_Mining.ScrW * 0.46, CH_Mining.ScrW * 0.082 )
	GUI_Option_ShowLevelHUD:SetSize( CH_Mining.ScrW * 0.032, CH_Mining.ScrW * 0.02 )
	if should_show_level == 1 then
		GUI_Option_ShowLevelHUD:SetValue( true )
	else
		GUI_Option_ShowLevelHUD:SetValue( false )
	end
	GUI_Option_ShowLevelHUD.Paint = function( self, w, h )
		if self:GetChecked() then
			surface.SetDrawColor( CH_Mining.Colors.Green )
			surface.SetMaterial( CH_Mining.Materials.CheckmarkIcon )
		else
			surface.SetDrawColor( CH_Mining.Colors.Red )
			surface.SetMaterial( CH_Mining.Materials.CloseIcon )
		end
		surface.DrawTexturedRect( w / 2 - (CH_Mining.ScrW * 0.00625), h / 2 - (CH_Mining.ScrH * 0.011115), CH_Mining.ScrW * 0.0125, CH_Mining.ScrH * 0.02223 )
	end
	GUI_Option_ShowLevelHUD.OnChange = function( self, checked )
		if checked then
			ply:ConCommand( "CH_Mining_DrawMiningLevel 1" )
		else
			ply:ConCommand( "CH_Mining_DrawMiningLevel 0" )
		end
	end
	
	local GUI_Slider_InvX = vgui.Create( "DNumSlider", GUI_OptionsPanel )
	GUI_Slider_InvX:SetPos( CH_Mining.ScrW * 0.295, CH_Mining.ScrH * 0.195 )
	GUI_Slider_InvX:SetSize( CH_Mining.ScrW * 0.2, CH_Mining.ScrW * 0.02 )
	GUI_Slider_InvX:SetText( "" )
	GUI_Slider_InvX:SetMin( 0 )
	GUI_Slider_InvX:SetMax( 1 )
	GUI_Slider_InvX:SetDecimals( 2 )
	GUI_Slider_InvX:SetConVar( "CH_Mining_InventoryHUD_X" )
	
	local GUI_Slider_InvY = vgui.Create( "DNumSlider", GUI_OptionsPanel )
	GUI_Slider_InvY:SetPos( CH_Mining.ScrW * 0.295, CH_Mining.ScrH * 0.24 )
	GUI_Slider_InvY:SetSize( CH_Mining.ScrW * 0.2, CH_Mining.ScrW * 0.02 )
	GUI_Slider_InvY:SetText( "" )
	GUI_Slider_InvY:SetMin( 0 )
	GUI_Slider_InvY:SetMax( 1 )
	GUI_Slider_InvY:SetDecimals( 2 )
	GUI_Slider_InvY:SetConVar( "CH_Mining_InventoryHUD_Y" )
	
	local GUI_Slider_LevelX = vgui.Create( "DNumSlider", GUI_OptionsPanel )
	GUI_Slider_LevelX:SetPos( CH_Mining.ScrW * 0.295, CH_Mining.ScrH * 0.29 )
	GUI_Slider_LevelX:SetSize( CH_Mining.ScrW * 0.2, CH_Mining.ScrW * 0.02 )
	GUI_Slider_LevelX:SetText( "" )
	GUI_Slider_LevelX:SetMin( 0 )
	GUI_Slider_LevelX:SetMax( 1 )
	GUI_Slider_LevelX:SetDecimals( 2 )
	GUI_Slider_LevelX:SetConVar( "CH_Mining_LevelHUD_X" )
	
	local GUI_Slider_LevelY = vgui.Create( "DNumSlider", GUI_OptionsPanel )
	GUI_Slider_LevelY:SetPos( CH_Mining.ScrW * 0.295, CH_Mining.ScrH * 0.335 )
	GUI_Slider_LevelY:SetSize( CH_Mining.ScrW * 0.2, CH_Mining.ScrW * 0.02 )
	GUI_Slider_LevelY:SetText( "" )
	GUI_Slider_LevelY:SetMin( 0 )
	GUI_Slider_LevelY:SetMax( 1 )
	GUI_Slider_LevelY:SetDecimals( 2 )
	GUI_Slider_LevelY:SetConVar( "CH_Mining_LevelHUD_Y" )
end
--addons/cityworker/lua/autorun/cityworker_config.lua:
CITYWORKER = CITYWORKER or {}

CITYWORKER.Config = CITYWORKER.Config or {}

--[[
  /$$$$$$  /$$   /$$                     /$$      /$$                     /$$                          
 /$$__  $$|__/  | $$                    | $$  /$ | $$                    | $$                          
| $$  \__/ /$$ /$$$$$$   /$$   /$$      | $$ /$$$| $$  /$$$$$$   /$$$$$$ | $$   /$$  /$$$$$$   /$$$$$$ 
| $$      | $$|_  $$_/  | $$  | $$      |M $$/$$ $$ $$ /$$__  $$ /$$__  $$| $$  /$$/ /$$__  $$ /$$__  $$
| $$      | $$  | $$    | $$  | $$      | $$$$_  $$$$| $$  \ $$| $$  \__/| $$$$$$/ | $$$$$$$$| $$  \__/
| $$    $$| $$  | $$ /$$| $$  | $$      | $$$/ \  $$$| $$  | $$| $$      | $$_  $$ | $$_____/| $$      
|  $$$$$$/| $$  |  $$$$/|  $$$$$$$      | $$/   \  $$|  $$$$$$/| $$      | $$ \  $$|  $$$$$$$| $$      
 \______/ |__/   \___/   \____  $$      |__/     \__/ \______/ |__/      |__/  \__/ \_______/|__/      
                         /$$  | $$                                                                     
                        |  $$$$$$/                                                                     
                         \______/                                                                      
                                
                                                v1.0.1
                                    By: Silhouhat (76561198072551027)
                                      Licensed to: 76561198401674027

--]]

-- How often should we check (in seconds) for City Workers with no assigned jobs, so we can give them?
CITYWORKER.Config.Time = 1

-- Configuration for the DarkRP job.
CITYWORKER.Config.Job = {
    name = "Kamu İşçisi",
    color = Color( 20, 150, 20, 255 ),
    model = {
        "models/player/engieplayer/engie.mdl"
    },
    description = "Herhangibir illegal aktivitede bulunmaktan korkan birisin, Ailene ekmek parası yetiştirmek için etraftaki hasar görmüş yerleri tamir edebilirsin, sana kötü şeyler yapmaya çalışanlar karşısında bıçak ve pistol kullanarak kendini savunabilirsin. İllegal aktivitede bulunamaz!!",
	weapons = { "cityworker_pliers", "cityworker_shovel", "cityworker_wrench" },
    command = "sehirtamircisi",
    max = 0,
    salary = 1,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = false,
    category = "Sivil",
}

------------
-- RUBBLE --
------------

CITYWORKER.Config.Rubble = {}

-- Whether or not rubble is enabled or disabled.
CITYWORKER.Config.Rubble.Enabled = true

-- Rubble models and the range of time (in seconds) it takes to clear them.
CITYWORKER.Config.Rubble.Models = {
    ["models/props_debris/concrete_debris128pile001a.mdl"] = { min = 90, max = 250 },
    ["models/props_debris/concrete_debris128pile001b.mdl"] = { min = 90, max = 250 },
    ["models/props_debris/concrete_floorpile01a.mdl"] = { min = 90, max = 250 },
    ["models/props_debris/concrete_cornerpile01a.mdl"] = { min = 90, max = 250 },
    ["models/props_debris/concrete_spawnplug001a.mdl"] = { min = 90, max = 250 },
    ["models/props_debris/plaster_ceilingpile001a.mdl"] = { min = 90, max = 250 },
}

-- Payout per second it takes to clear a given pile of rubble.
-- (i.e. 10 seconds = 10 * 30 = 300)
CITYWORKER.Config.Rubble.Payout = 10

-------------------
-- FIRE HYDRANTS --
-------------------

CITYWORKER.Config.FireHydrant = {}

-- Whether or not fire hydrants are enabled or disabled.
CITYWORKER.Config.FireHydrant.Enabled = false

-- The range for how long it takes to fix a fire hydrant.
-- Maximum value: 255 seconds.
CITYWORKER.Config.FireHydrant.Time = { min = 10, max = 60 }

-- Payout per second it takes to fix a fire hydrant.
CITYWORKER.Config.FireHydrant.Payout = 10

-----------
-- LEAKS --
-----------

CITYWORKER.Config.Leak = CITYWORKER.Config.Leak or {}

-- Whether or not leaks are enabled or disabled.
CITYWORKER.Config.Leak.Enabled = true

-- The range for how long it takes to fix a leak.
-- Maximum value: 255 seconds.
CITYWORKER.Config.Leak.Time = { min = 10, max = 40 }

-- Payout per second it takes to fix a leak.
CITYWORKER.Config.Leak.Payout = 10

--------------
-- ELECTRIC --
--------------

CITYWORKER.Config.Electric = CITYWORKER.Config.Electric or {}

-- Whether or not electrical problems are enabled or disabled.
CITYWORKER.Config.Electric.Enabled = true

-- The range for how long it takes to fix an electrical problem.
-- Maximum value: 255 seconds.
CITYWORKER.Config.Electric.Time = { min = 20, max = 40 }

-- Payout per second it takes to fix an electrical problem.
CITYWORKER.Config.Electric.Payout = 10

----------------------------
-- LANGUAGE CONFIGURATION --
----------------------------

CITYWORKER.Config.Language = {
    ["FireHydrant"]         = "Yangın musluğunu tamir ediliyor...",
    ["Leak"]                = "Sızıntıyı düzeltiliyor",
    ["Electric"]            = "Elektrik sorunu gideriliyor...",
    ["Rubble"]              = "Molozların temizleniyor",

    ["CANCEL"]              = "Eylemi iptal etmek için F2 tuşuna basın.",
    ["PAYOUT"]              = "İşinizden %s kazandınız!",
    ["CANCELLED"]           = "Eylemini iptal ettin!",
    ["NEW_JOB"]             = "Yapacak yeni bir işin var!",
    ["NOT_CITY_WORKER"]     = "Sen şehir işçisi değilsin!",
    ["JOB_WORKED"]          = "Bu iş zaten çalışıyor!",
    ["ASSIGNED_ELSE"]       = "Bu iş başkasına verildi!",
}
--addons/eprotect_1.5.24/lua/autorun/eprotect_loader.lua:
return gluapack()()
--addons/executioner_v2/lua/executioner_v2/ui/executioner_v2_ui.lua:
return gluapack()()
--lua/autorun/french_police.lua:
player_manager.AddValidModel( "MBekci 1", "models/erays/player/egmbekci/male_01.mdl" )
list.Set( "PlayerOptionsModel", "MBekci 1", "models/erays/player/egmbekci/male_01.mdl" )

player_manager.AddValidModel( "MBekci 2", "models/erays/player/egmbekci/male_02.mdl" )
list.Set( "PlayerOptionsModel", "MBekci 2", "models/erays/player/egmbekci/male_02.mdl" )

player_manager.AddValidModel( "MBekci 3", "models/erays/player/egmbekci/male_03.mdl" )
list.Set( "PlayerOptionsModel", "MBekci 3", "models/erays/player/egmbekci/male_03.mdl" )

player_manager.AddValidModel( "MBekci 4", "models/erays/player/egmbekci/male_04.mdl" )
list.Set( "PlayerOptionsModel", "MBekci 4", "models/erays/player/egmbekci/male_04.mdl" )

player_manager.AddValidModel( "MBekci 5", "models/erays/player/egmbekci/male_05.mdl" )
list.Set( "PlayerOptionsModel", "MBekci 5", "models/erays/player/egmbekci/male_05.mdl" )

player_manager.AddValidModel( "MBekci 6", "models/erays/player/egmbekci/male_06.mdl" )
list.Set( "PlayerOptionsModel", "MBekci 6", "models/erays/player/egmbekci/male_06.mdl" )

player_manager.AddValidModel( "MBekci 7", "models/erays/player/egmbekci/male_07.mdl" )
list.Set( "PlayerOptionsModel", "MBekci 7", "models/erays/player/egmbekci/male_07.mdl" )

player_manager.AddValidModel( "MBekci 8", "models/erays/player/egmbekci/male_08.mdl" )
list.Set( "PlayerOptionsModel", "MBekci 8", "models/erays/player/egmbekci/male_08.mdl" )

player_manager.AddValidModel( "MBekci 9", "models/erays/player/egmbekci/male_09.mdl" )
list.Set( "PlayerOptionsModel", "MBekci 9", "models/erays/player/egmbekci/male_09.mdl" )


--lua/autorun/gmodadminsuite.lua:
if (CLIENT and not file.Exists("gmodadminsuite/sh_networking.lua", "LUA")) then
	-- serverside code failed for some reason, abort loading GAS
	return
end

if (CLIENT and GAS) then
	if (IsValid(GAS.Menu)) then
		GAS.Menu:Close()
	end
	if (IsValid(GAS.ModuleFrame)) then
		GAS.ModuleFrame:Close()
	end
end

if (not file.IsDir("gmodadminsuite", "DATA")) then
	file.CreateDir("gmodadminsuite", "DATA")
end

GAS = {}

--######## sv_hibernate_think ########--

if (SERVER) then
	RunConsoleCommand("sv_hibernate_think", "1")
end

--######## Clientside Lua Files ########--

AddCSLuaFile("gmodadminsuite_lua_functions.lua")
AddCSLuaFile("gmodadminsuite_config.lua")

AddCSLuaFile("gmodadminsuite/cl_contextmenu.lua")
AddCSLuaFile("gmodadminsuite/cl_menubar.lua")
AddCSLuaFile("gmodadminsuite/sh_teams.lua")
AddCSLuaFile("gmodadminsuite/sh_modules.lua")
AddCSLuaFile("gmodadminsuite/sh_language.lua")
AddCSLuaFile("gmodadminsuite/sh_afk.lua")
AddCSLuaFile("gmodadminsuite/cl_selection_prompts.lua")
AddCSLuaFile("gmodadminsuite/cl_menu.lua")
AddCSLuaFile("gmodadminsuite/cl_country_codes.lua")

AddCSLuaFile("gmodadminsuite/thirdparty/pon.lua")
AddCSLuaFile("gmodadminsuite/thirdparty/spon.lua")
AddCSLuaFile("gmodadminsuite/thirdparty/von.lua")

--######## PRINTING ########--

GAS_COLOR_WHITE = Color(255,255,255)

GAS_PRINT_COLOR_GOOD    = Color(0,255,0)
GAS_PRINT_COLOR_BAD     = Color(255,0,0)
GAS_PRINT_COLOR_NEUTRAL = Color(0,255,255)

GAS_PRINT_TYPE_INFO  = "[INFO]"
GAS_PRINT_TYPE_WARN  = "[WARN]"
GAS_PRINT_TYPE_FAIL  = "[FAIL]"
GAS_PRINT_TYPE_DEBUG = "[DEBUG]"
function GAS:print(print_text, print_status_or_type, print_type)
	local type_str = ""
	local print_status = GAS_PRINT_COLOR_NEUTRAL
	if (print_type) then
		print_status = print_status_or_type
		type_str = print_type .. " "
	else
		if (type(print_status_or_type) == "string") then
			type_str = print_status_or_type .. " "
		end
		if (type(print_status_or_type) == "table") then
			print_status = print_status_or_type
		end
	end
	MsgC(print_status, "[GmodAdminSuite] ", type_str, GAS_COLOR_WHITE, print_text .. "\n")
end
if (CLIENT) then
	function GAS:chatPrint(print_text, print_status_or_type, print_type)
		local type_str = ""
		local print_status = GAS_PRINT_COLOR_NEUTRAL
		if (print_type) then
			print_status = print_status_or_type
			type_str = print_type .. " "
		else
			if (type(print_status_or_type) == "string") then
				type_str = print_status_or_type .. " "
			end
			if (type(print_status_or_type) == "table") then
				print_status = print_status_or_type
			end
		end
		chat.AddText(print_status, "[GmodAdminSuite] ", type_str, GAS_COLOR_WHITE, print_text)
	end
end

local first_header = true
local header_space_len = 85
local header_padding = 3
function GAS:StartHeader(header)
	if (first_header) then
		first_header = false
	else
		GAS:print("")
	end
	local header_len = #header + (header_padding * 2)
	GAS:print("[" .. ("="):rep(math.floor(header_space_len / 2 - header_len / 2)) .. (" "):rep(header_padding) .. header .. (" "):rep(header_padding) .. ("="):rep(math.ceil(header_space_len / 2 - header_len / 2)) .. "]")
end
function GAS:HeaderPrint(str, print_status_or_type, print_type)
	local str_len = utf8.len(str)

	local type_str = ""
	local print_status = GAS_PRINT_COLOR_NEUTRAL
	if (print_type) then
		print_status = print_status_or_type
		type_str = print_type .. " "
	else
		if (type(print_status_or_type) == "string") then
			type_str = print_status_or_type .. " "
		end
		if (type(print_status_or_type) == "table") then
			print_status = print_status_or_type
		end
	end

	local header_space_len_padded = header_space_len - 2 - #type_str
	if (str_len > header_space_len_padded) then
		for i = 1, math.ceil(str_len / header_space_len_padded) do
			GAS:HeaderPrint(str:sub(((i - 1) * header_space_len_padded) + 1, i * header_space_len_padded), print_status_or_type, print_type)
		end
		return
	else
		MsgC(print_status, "[GmodAdminSuite] ", GAS_COLOR_WHITE, "[ ", print_status, type_str, GAS_COLOR_WHITE, str .. (" "):rep(header_space_len - str_len - #type_str - 2) .. " ]\n")
	end
end
function GAS:EndHeader()
	GAS:print("[" .. ("="):rep(header_space_len) .. "]")
end

--######## InitPostEntity ########--

GAS.InitPostEntity_hooks = {}
function GAS:InitPostEntity(func)
	if (GAS_InitPostEntity) then
		func()
	else
		table.insert(GAS.InitPostEntity_hooks, func)
	end
end
function GAS:InitPostEntity_Run()
	hook.Remove("InitPostEntity", "gmodadminsuite:InitPostEntity_Loader")
	if GAS_InitPostEntity then return end

	GAS:print("InitPostEntity")
	GAS_InitPostEntity = true
	for _,v in ipairs(GAS.InitPostEntity_hooks) do v() end
end
if (SERVER) then
	util.AddNetworkString("GAS.InitPostEntityNetworking")

	net.Receive("GAS.InitPostEntityNetworking", function(_, ply)
		if (not ply.GAS_InitPostEntityNetworking) then
			ply.GAS_InitPostEntityNetworking = true
			net.Start("GAS.InitPostEntityNetworking")
			net.Send(ply)
		end
	end)
end

if (not GAS_InitPostEntity) then
	if (SERVER) then
		hook.Add("InitPostEntity", "gmodadminsuite:InitPostEntity_Loader", GAS.InitPostEntity_Run)
		timer.Simple(0.1, GAS.InitPostEntity_Run)
	else
		hook.Add("InitPostEntity", "gmodadminsuite:InitPostEntity_Loader", function()
			net.Receive("GAS.InitPostEntityNetworking", function()
				timer.Remove("GAS.InitPostEntityNetworking")
				GAS:InitPostEntity_Run()
			end)
			local function DoPing()
				net.Start("GAS.InitPostEntityNetworking")
				net.SendToServer()
			end
			DoPing()
			timer.Create("GAS.InitPostEntityNetworking", 2, 0, DoPing)
		end)
	end
else
	GAS:InitPostEntity_Run()
end

--######## Initialize ########--

GAS_GMInitialize = GAS_GMInitialize == true or GM ~= nil or GAMEMODE ~= nil
GAS.GMInitialize_hooks = {}
function GAS:GMInitialize(func)
	if (GAS_GMInitialize) then
		func()
	else
		table.insert(GAS.GMInitialize_hooks, func)
	end
end
if (not GAS_GMInitialize) then
	local function GMInitialize()
		GAS_GMInitialize = true
		for _,v in ipairs(GAS.GMInitialize_hooks) do v() end
		GAS.GMInitialize_hooks = {}

		timer.Remove("gmodadminsuite:GMInitialize_Loader")
		hook.Remove("Initialize", "gmodadminsuite:GMInitialize_Loader")
	end
	hook.Add("Initialize", "gmodadminsuite:GMInitialize_Loader", function()
		timer.Remove("gmodadminsuite:GMInitialize_Loader")

		GAS:print("Gamemode initialized")

		GAS_GMInitialize = true
		for _,v in ipairs(GAS.GMInitialize_hooks) do v() end
		GAS.GMInitialize_hooks = {}
	end)
	timer.Simple(0, function()
		if (GM or GAMEMODE) then
			GMInitialize()
		else
			timer.Create("gmodadminsuite:GMInitialize_Loader", 1, 0, function()
				if (GM or GAMEMODE) then
					GAS:print("Gamemode initialized (late/did not fire)", GAS_PRINT_TYPE_WARN)
					GMInitialize()
				end
			end)
		end
	end)
end

--######## PRINT INFO ########--

GAS:StartHeader("GmodAdminSuite")

GAS.Version = "v1"
GAS:HeaderPrint("Version: " .. GAS.Version, GAS_PRINT_COLOR_GOOD)

--######## BillysErrors ########--

require("billyserrors")
if (SERVER) then
	GAS.BillysErrors = BillysErrors:AddAddon({
		Name  = "GmodAdminSuite",
		Color = Color(0,125,255),
		Icon  = "icon16/shield.png"
	})
end

--######## INITIALIZE ########--

include("gmodadminsuite/sh_core.lua")

--######## RELOADER ########--

concommand.Add("gas_reload", function(ply)
	if (SERVER and IsValid(ply)) then return end
	include("autorun/gmodadminsuite.lua")
end)
--lua/gmodadminsuite/lang/french.lua:
return gluapack()()
--lua/gmodadminsuite/lang/french.lua:
return {
	Name = "French",
	Flag = "flags16/fr.png",
	Phrases = function() return {

		open_menu                 = "Ouvrir Menu",
		menu_nopermission         = "Désolé, mais vous n'avez pas la permission d'accéder au menu GmodAdminSuite.",
		menu_unknown_module       = "Désolé, mais le module spécifié n'est pas installé ou n'existe pas.",
		menu_disabled_module      = "Désolé, mais ce module est désactivé.",
		menu_module_nopermission  = "Désolé, mais vous n'avez pas la permission d'accéder à ce module.",
		open_gas                  = "Ouvrir GmodAdminSuite",
		module_shortcut           = "Raccourci Module",
		module_shortcut_info      = [[You can quickly access this GmodAdminSuite module through console and chat commands.

		To access the module through your console, type: %s
		To access the module through chat, type: %s

		Additionally, you can bind a key on your keyboard to a specific module.
		To do this, in your console, type: %s

		Make sure to replace KEY with a key on your keyboard of your choice.
		%s]],
		close                     = "Fermer",
		wiki                      = "Wiki",
		licensee                  = "Licencié",
		support                   = "Support",
		module_shop               = "Boutique de Modules",
		welcome                   = "Bienvenue",
		operator                  = "Opérateur",
		script_page               = "Page du Script",
		wiki                      = "Wiki",
		no_modules_available      = "Aucuns modules disponnibles!",
		no_modules_available_info = [[Désolé, but there aren't any GmodAdminSuite modules available for you to use.
		You may have insufficient permissions to use any, or none are enabled.]],
		custom_ellipsis           = "Custom...",
		usergroup_ellipsis        = "Groupe d'Utilisateurs...",
		steamid_ellipsis          = "SteamID...",
		enter_steamid_ellipsis    = "Entrez SteamID...",
		by_distance               = "Par Distance",
		by_usergroup              = "Par Groupes d'Utilisateurs",
		by_team                   = "Par Equipe",
		by_name                   = "Par Nom",
		right_click_to_focus      = "Clic Droit pour faire le focus",
		unknown                   = "Inconnu",
		utilities                 = "Utilitaires",
		player_management         = "Gestion Joueurs",
		administration            = "Administration",
		s_second                  = "1 seconde",
		s_seconds                 = "%d secondes",
		s_minute                  = "1 minute",
		s_minutes                 = "%d minutes",
		s_hour                    = "1 heure",
		s_hours                   = "%d heures",
		second_ago                = "il y a 1 seconde",
		seconds_ago               = "il y a %d secondes",
		minute_ago                = "il y a 1 minute",
		minutes_ago               = "il y a %d minutes",
		hour_ago                  = "il y a 1 heure",
		hours_ago                 = "il y a %d heures",
		just_now                  = "A l'instant",
		click_to_focus            = "Clic pour faire le focus",
		add_steamid               = "SteamID Custom",
		copied                    = "Copié !",
		settings                  = "Paramètres",
		add_steamid_help          = [[Entrez un SteamID ou SteamID64. Exemples:
		SteamID: %s
		SteamID64: %s]],

		setting_default_module = "Module par Défaut",
		setting_default_module_tip = "Quel module doit être ouvert lorsque le menu principal GmodAdminSuite est ouvert ?",
		none = "Aucun",
		general = "Général",
		localization = "Localisation",
		setting_menu_voicechat = "Autoriser Chat Vocal\nlorsque les menu GAS sont ouverts",
		setting_menu_voicechat_tip = "Les menu GmodAdminSuite ne vous empêchent pas de communiquer en jeu lorsqu'ils sont ouverts. Si cette option est active, appuyez simplement sur votre touche désignée à cet effet pour parler.",
		use_gas_language = "Utiliser le langage GmodAdminSuite",
		default_format = "Format par Défaut",
		short_date_format = "Format Date Abrégée",
		long_date_format = "Format Date Entière",
		short_date_format_tip = "Date format used for shorter date formats\n\nThe default format automatically matches the date format of your region (North America, Europe, etc.)",
		long_date_format_tip = "Date format used for longer date formats",
		permissions = "Permissions",
		module_enable_switch_tip = "Changes to this will only apply after a server restart/map change",
		enabled = "Activé",
		modules = "Modules",
		permissions_help = [[GmodAdminSuite utilise une librairie de permission open-sources nommée OpenPermissions, développée par Billy pour GAS. Elle fournit une gestion optimisée des permissions pour les systèmes avancées fonctionnant sur des serveurs de tous types.
		
		OpenPermissions est l'addon depuis lequel vous contrôlerez quels groupes peuvent accéder à quels modules, et ce qu'ils peuvent faire avec ces modules.
		Il peut être ouvert ouvert n'importe quand en écrivant "!openpermissions" dans le chat, ou "openpermissions" dans la console en jeu.

		Pour obtenir de l'aide, ou des informations, cliquez sur l'onglet "Aide" dans le menu OpenPermissions.]],
		website = "Site Web",
		fun = "Fun",

		bvgui_copied               = "Copié !",
		bvgui_open_context_menu    = "Ouvrir Menu Contextuel",
		bvgui_open_steam_profile   = "Afficher Profil Steam",
		bvgui_right_click_to_focus = "Clic Droit pour faire le focus",
		bvgui_click_to_focus       = "Clic pour faire le focus",
		bvgui_unknown              = "Inconnu",
		bvgui_no_data              = "Aucune Données",
		bvgui_no_results_found     = "Aucun résultat trouvé",
		bvgui_done                 = "Terminé",
		bvgui_enter_text_ellipsis  = "Entrez texte...",
		bvgui_loading_ellipsis     = "Chargement...",
		bvgui_pin_tip              = "Appuyez sur ECHAP pour pouvoir de nouveau intéragir avec le menu",

} end }
--lua/gmodadminsuite/modules/commands/lang/chinese.lua:
return {
    Name = "Chinese",
    Flag = "flags16/cn.png",
    Phrases = function()
        return {
            module_name = "命令管理器",

            no_permission = "对不起，您没有使用这个命令的权限。",
            commands = "命令",
            command = "命令",
            action = "操作",
            help = "帮助",
            new_command = "+ 新命令",
            wiki = "维基",
            run_command = "运行命令",
            edit_command = "编辑命令",
            form_help = "帮助文本...（可选）",
            form_help_tip = "这是在命令菜单的“帮助”列中显示的文本。",
            select_action = "选择操作...",
            hide_in_chat = "在聊天中隐藏？",
            hide_in_chat_tip = "如果选中，当有人输入时命令将不会在聊天中显示。",
            finished = "完成",
            commands_case_insensitive = "所有命令都不区分大小写。",
            ok = "确定",
            cannot_create_command = "无法创建命令！",
            cancel = "取消",
            delete_command = "删除命令",
            copy_command = "复制命令",
            permissions = "权限",
            permissions_editor = "打开权限编辑器",
            permissions_tip = "允许您对用户组和团队/职业进行白名单和黑名单设置。",
            can_access_command = "可以访问命令",
            teams = "团队",
            usergroups = "用户组",
            anyone_can_access = "任何人都可以访问这个命令",
            whitelisted_only = "只有白名单中的人可以访问这个命令",
            non_blacklisted_only = "只有非黑名单中的人可以访问这个命令",
            whitelisted_and_blacklisted = "只有白名单中的人（除了黑名单中的人）可以访问这个命令",
            custom_usergroup = "+ 自定义用户组",
            custom_usergroup_text = "输入用户组",
            custom_usergroup_placeholder = "用户组...",
            reason_usergroup_blacklisted = "您的用户组被禁止使用这个命令。",
            reason_usergroup_not_whitelisted = "您的用户组没有被列入这个命令的白名单。",
            reason_team_blacklisted = "您的团队被禁止使用这个命令。",
            reason_team_not_whitelisted = "您的团队没有被列入这个命令的白名单。",
            saved_exclamation = "已保存！",
            set_position = "设置位置",
            position_set = "位置已设置！",
            set_position_instruction = "前往期望的位置并面向期望的方向",
            set_position_instruction_2 = "完成后，取消固定菜单，然后位置和角度将被保存",

            action_open_commands_menu = "打开命令菜单",
            action_command = "运行控制台命令",
            action_chat = "说出聊天消息",
            action_website = "打开网站",
            action_lua_function_sv = "运行服务器端Lua函数",
            action_lua_function_cl = "运行客户端Lua函数",
            action_gas_module = "打开GAS模块",
            action_teleport = "传送",

            form_action_command = "要运行的控制台命令",
            form_action_chat = "要说的聊天消息",
            form_action_website = "要打开的网站",
            form_action_lua_function_sv = "要运行的服务器端Lua函数",
            form_action_lua_function_cl = "要运行的客户端Lua函数",
            form_action_gas_module = "要打开的GAS模块",
            form_action_teleport = "传送",

            error_command_exists = "这个名称的命令已经存在！",
            error_no_command = "您没有输入命令。",
            error_no_command_execute = "您没有输入要执行的命令。",
            error_no_action = "您没有为这个命令选择一个操作。",
            error_invalid_website = "您输入的网站不是一个有效的URL。",
            error_no_lua_function = "您没有选择要执行的Lua函数。",
            error_no_gas_module = "您没有选择要打开的GAS模块。",
            error_no_position_set = "您没有为这个传送设置位置和角度。",
        }
    end
}

--lua/gmodadminsuite/modules/commands/lang/english.lua:
return gluapack()()
--addons/gmodadminsuite-jobwhitelist-1.3.4/lua/gmodadminsuite/modules/jobwhitelist/lang/english.lua:
return {
	Name = "English",
	Flag = "flags16/gb.png",
	Phrases = function() return {

		module_name = "Billy's Whitelist",

		insufficient_permissions_jobwhitelist = "The whitelist/blacklist is not enabled for this job,\nand you have insufficient permissions to enable them.",
		no_data                               = "No data",
		type                                  = "Type",
		value                                 = "Value",
		name                                  = "Name",
		added_by                              = "Added by",
		click_delete_entry_tip                = "Click on an entry to delete it!",
		copied                                = "Copied!",
		delete_entry                          = "Delete Entry",
		add_player                            = "Add Player",
		add_usergroup                         = "Add Usergroup",
		add_lua_function                      = "Add Lua Function",
		lua_function                          = "Lua Function",
		script_page                           = "Script Page",
		wiki                                  = "Wiki",
		jobs                                  = "Jobs",
		whitelist                             = "Whitelist",
		blacklist                             = "Blacklist",
		settings                              = "Settings",
		enable_whitelist                      = "Enable Whitelist",
		enable_blacklist                      = "Enable Blacklist",
		default_whitelisted                   = "Whitelisted to by default",
		default_blacklisted                   = "Blacklisted from by default",
		disable_autoswitch                    = "Disable AutoSwitch for this job",
		players                               = "Players",
		job                                   = "Job",
		usergroup                             = "Usergroup",
		distance                              = "Distance",
		click_for_options_tip                 = "Click for options!",
		refreshing_ellipsis                   = "Refreshing...",
		refreshing_in_1_second                = "Refreshing in 1 second",
		refreshing_in_seconds                 = "Refreshing in %s seconds",
		operator                              = "Operator",
		OperatorsSkipWhitelists_help          = "If this is on, Operators will skip whitelists.",
		OperatorsSkipBlacklists_help          = "If this is on, Operators will skip blacklists.",
		ShowUnjoinableJobs_help               = "If off, players won't see the jobs they're blacklisted from/not whitelisted to in the F4 menu.\nIf on, players will see the default state of the F4 menu.",
		ContextMenu_help                      = "If on, then players can interact with bWhitelist through the context menu (recommended)\nIf off, then this feature is disabled.",
		off                                   = "Off",
		FunctionMenuKey_help                  = "Allows you to assign a function key to the bWhitelist menu (F1/F2/F3/F4)",
		AutoSwitch_help                       = "If on, when a player is whitelisted to a job, they will be automatically switched to it. (Only works with SteamIDs)",
		SwitchJobOnUnwhitelist_help           = "If on, when a player is unwhitelisted from their job, they'll be switched back to the default team. (Only works with SteamIDs)",
		SwitchJobOnBlacklist_help             = "If on, when a player is blacklisted from their job, they'll be switched back to the default team. (Only works with SteamIDs)",
		NotWhitelistedMsg_help                = "This is the message the player will see in the bottom right corner when they try to join a job they are not whitelisted to.",
		BlacklistedMsg_help                   = "This is the message the player will see in the bottom right corner when they try to join a job they are blacklisted from.",
		NotifyWhitelisted_help                = "Turn on to notify players when they have been whitelisted to a job. (Only works with SteamIDs)",
		NotifyWhitelisted_Msg_help            = "This is the message the player will see in chat when they are notified of being whitelisted to a job.",
		NotifyUnwhitelisted_help              = "Turn on to notify players when they have been unwhitelisted from a job. (Only works with SteamIDs)",
		NotifyUnwhitelisted_Msg_help          = "This is the message the player will see in chat when they are notified of being unwhitelisted from a job.",
		NotifyBlacklisted_help                = "Turn on to notify players when they have been blacklisted from a job. (Only works with SteamIDs)",
		NotifyBlacklisted_Msg_help            = "This is the message the player will see in chat when they are notified of being blacklisted from a job.",
		NotifyUnblacklisted_help              = "Turn on to notify players when they have been unblacklisted from a job. (Only works with SteamIDs)",
		NotifyUnblacklisted_Msg_help          = "This is the message the player will see in chat when they are notified of being unblacklisted from a job.",
		permissions                           = "Permissions",
		modify_whitelist                      = "Modify Whitelist",
		modify_blacklist                      = "Modify Blacklist",
		enable_disable_whitelist              = "Enable/Disable Whitelist",
		enable_disable_blacklist              = "Enable/Disable Blacklist",
		job_category                          = "Job Category",
		steamid                               = "SteamID",
		all_jobs                              = "ALL JOBS",
		save                                  = "Save",
		all_jobs_in_category                  = "All jobs in category",
		job_categories                        = "Job Categories",
		usergroups                            = "Usergroups",
		steamids                              = "SteamIDs",
		lua_functions                         = "Lua Functions",
		usergroup_ellipsis                    = "Usergroup...",
		steamid_ellipsis                      = "SteamID...",
		enter_steamid_ellipsis                = "Enter SteamID...",
		resets                                = "Resets",
		enable_buttons                        = "Enable Buttons",
		reset_config                          = "Reset Config",
		done_exclamation                      = "Done!",
		reset_permissions_config              = "Reset Permissions Config",
		disable_all_whitelists                = "Disable All Whitelists",
		disable_all_blacklists                = "Disable All Blacklists",
		destroy_whitelist                     = "Destroy Whitelist Data...",
		destroy_blacklist                     = "Destroy Blacklist Data...",
		destroy_all_data                      = "Destroy All Data",
		destroy_all_data_help                 = "Destroys all whitelist and blacklist data, disables all whitelists and blacklists but does NOT reset your configuration.",
		reset_everything                      = "Reset Everything",
		reset_everything_help                 = "Destroys all whitelist and blacklist data, disables all whitelists and blacklists and resets your configuration.",
		disable_buttons                       = "Disable Buttons",
		open_menu                             = "Open Menu",
		add_to_whitelist                      = "Add to Whitelist",
		loading_ellipsis                      = "Loading...",
		no_whitelists_available               = "No whitelists available!",
		add_to_blacklist                      = "Add to Blacklist",
		no_blacklists_available               = "No blacklists available!",
		click_to_focus                        = "Click to focus",
		right_click_to_focus                  = "Right click to focus",
		copy_steamid                          = "Copy SteamID",
		copy_steamid64                        = "Copy SteamID64",
		copy                                  = "Copy",
		default_team_error                    = "You cannot whitelist/blacklist this job because it is the default job.",
		saved_exclamation                     = "Saved!",
		whitelisted                           = "Whitelisted",
		blacklisted                           = "Blacklisted",
		choose_faction                        = "Choose a faction",
		faction_not_permitted                 = "(You are not permitted to join this faction)",
		factions                              = "Factions",
		new_faction                           = "New Faction",
		destroy_faction_data                  = "Destroy Faction Data",
		destroy_faction_data_help             = "Destroys all faction data (e.g. what factions players have chosen)",
		reset_factions_config                 = "Reset Factions Config",
		logo_url                              = "Logo URL... (PNG)",
		faction_name                          = "Faction Name",
		faction_name_tip                      = "The name of this faction",
		description                           = "Description",
		faction_description_tip               = "Players will see the description after hovering over the faction",
		ShowIfNotPermitted                    = "Show even if not permitted",
		ShowIfNotPermitted_help               = "If the player is not permitted to join the faction, should it be shown?",
		SetTeam                               = "Job to set player to",
		SetTeam_help                          = "What job should the player be set to after choosing the faction?",
		WhitelistedTo                         = "Whitelist to",
		WhitelistedTo_help                    = "What jobs should the player be whitelisted to as this faction?",
		BlacklistedFrom                       = "Blacklist from",
		BlacklistedFrom_help                  = "What jobs should the player be blacklisted from as this faction?",
		delete_faction_confirm                = "Are you sure you want to delete this faction?",
		confirm_action                        = "Confirm Action",
		yes                                   = "Yes",
		no                                    = "No",
		save_faction                          = "Save Faction",
		delete_faction                        = "Delete Faction",
		factions_ShowOnFirstJoin              = "Show on first join",
		factions_ShowOnFirstJoin_help         = "Show the factions selector when a player first joins?",
		factions_ShowOnEveryJoin              = "Show on every join",
		factions_ShowOnEveryJoin_help         = "Show the factions selector whenever a player joins?",
		factions_ShowOnEverySpawn             = "Show on every spawn",
		factions_ShowOnEverySpawn_help        = "Show the factions selector whenever a player spawns?",
		factions_HelpText                     = "Help Tip",
		factions_HelpText_help                = "Text to display when no factions are being hovered over",
		factions_OnPopupSound                 = "Popup Sound",
		factions_OnPopupSound_help            = "Sound to play when the factions selector is opened",
		factions_OnHoverSound                 = "Hover Sound",
		factions_OnHoverSound_help            = "Sound to play when a faction is hovered over",
		factions_OnSelectionSound             = "Selection Sound",
		factions_OnSelectionSound_help        = "Sound to play when a faction is selected",
		factions_PermissionDeniedSound        = "Permission Denied Sound",
		factions_PermissionDeniedSound_help   = "Sound to play when a forbidden faction is selected",
		enable_factions                       = "Enable Factions",
		edit_factions                         = "Edit Factions",
		chat_command                          = "Chat Command",
		console_command                       = "Console Command",
		blank_to_disable                      = "Set to blank to disable",
		add_to_all_whitelists                 = "ADD to all whitelists",
		add_to_all_blacklists                 = "ADD to all blacklists",
		remove_from_all_whitelists            = "REMOVE from all whitelists",
		remove_from_all_blacklists            = "REMOVE from all blacklists",
		bulk_actions                          = "Bulk actions",
		add                                   = "Add",
		remove                                = "Remove",
		remove_player                         = "Remove Player",
		remove_usergroup                      = "Remove Usergroup",
		remove_lua_function                   = "Remove Lua Function",
		convert_old_data                      = "Convert old bWhitelist data",
		offline                               = "Offline",
		no_permission_action                  = "You do not have permission to do this!",
		clear_whitelist                       = "Clear Whitelist",
		clear_whitelist_confirm               = "Are you sure you want to clear this whitelist?",
		clear_blacklist                       = "Clear Blacklist",
		clear_blacklist_confirm               = "Are you sure you want to clear this blacklist?",
		enable_all_whitelists                 = "Enable All Whitelists",
		enable_all_blacklists                 = "Enable All Blacklists",
		spawn_as_job                          = "Spawn as job",
		spawn_as_job_tip                      = "The jobs nearer the bottom of your DarkRP jobs.lua file will be prioritized",

} end }
--lua/gmodadminsuite/modules/playerdatabase/lang/french.lua:
return {
	Name = "French",
	Flag = "flags16/fr.png",
	Phrases = function() return {

		module_name = "Player Database",

		right_click_to_focus    = "Clic Droit pour faire le focus",
		steamid                 = "SteamID",
		name                    = "Nom",
		usergroup               = "Groupe",
		ip_address              = "Adresse IP",
		last_seen               = "Dernière Connexion",
		copy_steamid            = "Copier SteamID",
		copy_steamid64          = "Copier SteamID64",
		copy_usergroup          = "Copier Groupe d'Utilisateurs",
		copy_ip_address         = "Copier IP Address",
		copy_name               = "Copier Nom",
		copy_steam_profile_link = "Copier Lien de Page de Profil Steam",
		search                  = "Chercher",
		country                 = "Pays",
		copy_country            = "Copier Country",
		search_usergroup        = "Chercher Groupe d'Utilisateurs",
		search_ip_address       = "Chercher Adresse IP",
		search_country          = "Chercher Pays",
		search_name             = "Chercher Nom",
		none                    = "< none >",
		cancel                  = "Annuler",
		steamid                 = "SteamID",

} end }
--lua/gmodadminsuite/modules/secondaryusergroups/lang/chinese.lua:
return {
    Name = "Chinese",
    Flag = "flags16/cn.png",
    Phrases = function()
        return {
            module_name = "次要用户组",

            open_menu = "打开菜单",
            custom_ellipsis = "自定义...",
            usergroup_ellipsis = "用户组...",
            players = "玩家",
            settings = "设置",
            give_usergroup = "赋予用户组",
            usergroup_is_main = "这是用户的主用户组，不能被赋予或撤销。",
            help = "帮助",
            offline_btn = "新玩家...",
            loading_ellipsis = "加载中...",
            unknown = "未知",
        }
    end
}
--lua/gmodadminsuite/modules/fpsbooster/sh_init.lua:
return gluapack()()
--lua/gmodadminsuite/modules/secondaryusergroups/sh_init.lua:
if (SERVER) then
	AddCSLuaFile("sh_core.lua")
	AddCSLuaFile("cl_menu.lua")
end

GAS:hook("gmodadminsuite:LoadModule:secondaryusergroups", "LoadModule:secondaryusergroups", function()
	include("gmodadminsuite/modules/secondaryusergroups/sh_core.lua")
	if (SERVER) then
		include("gmodadminsuite/modules/secondaryusergroups/sv_secondaryusergroups.lua")
		include("gmodadminsuite/modules/secondaryusergroups/sv_permissions.lua")
	else
		include("gmodadminsuite/modules/secondaryusergroups/cl_menu.lua")
	end
end)
--lua/gmodadminsuite/cl_menu.lua:
local function L(phrase, ...)
	if (#({...}) == 0) then
		return GAS:Phrase(phrase)
	else
		return GAS:PhraseFormat(phrase, nil, ...)
	end
end

GAS.LocalConfig = GAS:GetLocalConfig("gas", {
	AllowVoiceChat = true,
	DefaultModule = false,
	ClosePlayerPopups = false
})

GAS:netReceive("menu_nopermission", function()
	GAS:PlaySound("error")
	GAS:chatPrint(L"menu_nopermission", GAS_PRINT_COLOR_BAD, GAS_PRINT_TYPE_FAIL)
end)
GAS:netReceive("menu_unknown_module", function()
	GAS:PlaySound("error")
	GAS:chatPrint(L"menu_unknown_module", GAS_PRINT_COLOR_BAD, GAS_PRINT_TYPE_FAIL)
end)
GAS:netReceive("menu_disabled_module", function()
	GAS:PlaySound("error")
	GAS:chatPrint(L"menu_disabled_module", GAS_PRINT_COLOR_BAD, GAS_PRINT_TYPE_FAIL)
end)
GAS:netReceive("menu_module_nopermission", function()
	GAS:PlaySound("error")
	GAS:chatPrint(L"menu_module_nopermission", GAS_PRINT_COLOR_BAD, GAS_PRINT_TYPE_FAIL)
end)

concommand.Add("gmodadminsuite", function(_, __, args)
	if (#args == 0) then
		GAS:netStart("menu_open")
			net.WriteString("")
		net.SendToServer()
	else
		if (args[1] == "reload") then
			GAS:Init()
		elseif (args[1] == "screenclicker") then
			gui.EnableScreenClicker(true)
		else
			GAS:netStart("menu_open")
				net.WriteString(args[1])
			net.SendToServer()
		end
	end
end, function(cmd, args)
	local arg = string.TrimLeft(args)
	local tbl = {}
	local is_operator = OpenPermissions:IsOperator(LocalPlayer())
	for module_name, module_data in pairs(GAS.Modules.Info) do
		if (module_data.OperatorOnly and not is_operator) then continue end
		if (arg and #string.Trim(arg) > 0) then
			if (not module_name:lower():find(string.Trim(arg):lower())) then
				continue
			end
		end
		table.insert(tbl, cmd .. " " .. module_name)
	end
	table.sort(tbl)
	table.insert(tbl, 1, cmd .. " reload")
	table.insert(tbl, 2, cmd .. " screenclicker")
	return tbl
end)

function GAS:OpenModuleFrame(module_name)
	if (IsValid(GAS.ModuleFrame)) then
		GAS.ModuleFrame:Close()
	end

	if (IsValid(GAS.Menu)) then
		if (GAS.Menu.Modules.IndexedItems[module_name]) then
			GAS.Menu.Modules.IndexedItems[module_name]:SetActive(true)
		end
	end

	GAS.ModuleFrame = vgui.Create("bVGUI.Frame")
	GAS.ModuleFrame.ModuleName = module_name
	local w, h = 1200, 700
	if (ScrW() < w or ScrH() < h) then
		w = ScrW()
		h = ScrH()
	end
	GAS.ModuleFrame:SetSize(w,h)
	GAS.ModuleFrame:MakePopup()
	GAS.ModuleFrame:SetTitle(GAS.Modules:GetFriendlyName(module_name))
	GAS.ModuleFrame:SetVisible(false)

	GAS.ModuleFrame.DragThink = GAS.ModuleFrame.Think
	function GAS.ModuleFrame:Think()
		self:DragThink()
		if (IsValid(GAS.Menu)) then
			self.bVGUI_FullscreenButton.OffsetX = 200

			local x_1, y_1, w_1, h_1 = self:GetBounds()
			GAS.Menu:SetPos(x_1 - 200 + 1, y_1)
			GAS.Menu:SetSize(200, h_1)
		else
			self.bVGUI_FullscreenButton.OffsetX = nil
		end
	end

	function GAS.ModuleFrame:OnClose()
		local x, y = self:GetPos()
		cookie.Set("gmodadminsuite_module_" .. self.ModuleName .. "_x_" .. ScrW(), x)
		cookie.Set("gmodadminsuite_module_" .. self.ModuleName .. "_y_" .. ScrH(), y)
	end

	function GAS.ModuleFrame:DermaMenuOptions(menu)
		if (not IsValid(GAS.Menu)) then
			menu:AddOption(L"open_gas", function()
				GAS:PlaySound("jump")
				GAS:OpenMenu()
			end):SetIcon("icon16/application_home.png")
		end

		menu:AddOption(L"close", function()
			if IsValid(self) then
				GAS.ModuleFrame:Remove()
			end
		end):SetIcon("icon16/cancel.png")

		menu:AddOption(L"module_shortcut", function()
			GAS:PlaySound("flash")
			bVGUI.RichMessage({
				title = L"module_shortcut",
				button = "OK",
				textCallback = function(richtext)
					local highlight_col = {0,255,255,255}
					local phrase = string.Explode("%s", GAS:Phrase("module_shortcut_info"))
					richtext:AppendText(phrase[1])

					richtext:InsertColorChange(unpack(highlight_col))
					richtext:AppendText("gmodadminsuite " .. module_name)

					richtext:InsertColorChange(255,255,255,255)
					richtext:AppendText(phrase[2])

					richtext:InsertColorChange(unpack(highlight_col))
					richtext:AppendText(GAS.Config.ChatCommand .. " " .. module_name)

					richtext:InsertColorChange(255,255,255,255)
					richtext:AppendText(phrase[3])

					richtext:InsertColorChange(unpack(highlight_col))
					richtext:AppendText("bind KEY \"gmodadminsuite " .. module_name .. "\"")

					richtext:InsertColorChange(255,255,255,255)
					richtext:AppendText(phrase[4])

					richtext:InsertColorChange(unpack(highlight_col))
					richtext:AppendText("https://developer.valvesoftware.com/wiki/Bind#Special_Keys")
				end
			})
		end):SetIcon("icon16/star.png")

		menu:AddOption(L"module_reset_data", function()
			GAS:PlaySound("flash")
			if IsValid(self) then
				self:SetSize(self.RealSize[1], self.RealSize[2])
				self:Center()
				local x, y = self:GetPos()
				cookie.Set("gmodadminsuite_module_" .. self.ModuleName .. "_x_" .. ScrW(), x)
				cookie.Set("gmodadminsuite_module_" .. self.ModuleName .. "_y_" .. ScrH(), y)
				cookie.Set("gmodadminsuite_module_" .. module_name .. "_w", self:GetWide())
				cookie.Set("gmodadminsuite_module_" .. module_name .. "_h", self:GetTall())
			end
		end):SetIcon("icon16/arrow_rotate_clockwise.png")

		if (GAS.Modules.Info[module_name].ScriptPage) then
			menu:AddOption(L"script_page", function()
				GAS:OpenURL(GAS.Modules.Info[module_name].ScriptPage)
			end):SetIcon("icon16/page_code.png")
		end

		if (GAS.Modules.Info[module_name].Wiki) then
			menu:AddOption(L"wiki", function()
				GAS:OpenURL(GAS.Modules.Info[module_name].Wiki)
			end):SetIcon("icon16/book.png")
		end

		if (GAS.ModuleFrame.Extra_DermaMenuOptions) then
			GAS.ModuleFrame:Extra_DermaMenuOptions(menu)
		end
	end

	-- would use file.IsDir, but: https://github.com/Facepunch/garrysmod-issues/issues/3592
	local _,d = file.Find("gmodadminsuite/modules/*", "LUA")
	if (table.HasValue(d, module_name) and not GAS.Modules:IsModuleLoaded(module_name)) then
		GAS.Modules:LoadModule(module_name)
	end

	local real_w, real_h = hook.Run("gmodadminsuite:ModuleSize:" .. module_name)

	w = math.min(cookie.GetNumber("gmodadminsuite_module_" .. module_name .. "_w", real_w), ScrW())
	h = math.min(cookie.GetNumber("gmodadminsuite_module_" .. module_name .. "_h", real_h), ScrH())

	GAS.ModuleFrame:SetSize(w,h)
	GAS.ModuleFrame:SetMinimumSize(real_w, real_h)
	GAS.ModuleFrame:Center()
	GAS.ModuleFrame:SetVisible(true)

	local new_x = cookie.GetNumber("gmodadminsuite_module_" .. module_name .. "_x_" .. ScrW(), false)
	local new_y = cookie.GetNumber("gmodadminsuite_module_" .. module_name .. "_y_" .. ScrH(), false)
	local cur_x, cur_y = GAS.ModuleFrame:GetPos()

	GAS.ModuleFrame:SetPos(new_x or cur_x, new_y or cur_y)

	GAS.ModuleFrame.OpenModule = module_name
	GAS.ModuleFrame.RealSize = {
		real_w,
		real_h
	}

	hook.Run("gmodadminsuite:ModuleFrame:" .. module_name, GAS.ModuleFrame)

	GAS.ModuleFrame:EnableUserResize()

	function GAS.ModuleFrame:OnResize(new_w, new_h)
		cookie.Set("gmodadminsuite_module_" .. module_name .. "_w", new_w)
		cookie.Set("gmodadminsuite_module_" .. module_name .. "_h", new_h)
	end

	return GAS.ModuleFrame
end

local logo_mat = Material("gmodadminsuite/gmodadminsuite.vtf")
local function OpenMenu()
	local is_operator = OpenPermissions:IsOperator(LocalPlayer())

	GAS.Menu = vgui.Create("bVGUI.Frame")
	GAS.Menu:ShowFullscreenButton(false)
	GAS.Menu:SetSize(800,500)
	GAS.Menu:SetTitle("GmodAdminSuite " .. GAS.Version)
	GAS.Menu:Center()
	GAS.Menu:MakePopup()

	if (IsValid(GAS.ModuleFrame) and GAS.ModuleFrame.Fullscreened) then
		GAS.ModuleFrame.bVGUI_FullscreenButton.OffsetX = 200
		GAS.ModuleFrame:Stop()
		GAS.ModuleFrame:SizeTo(ScrW() - 200, ScrH(), 0.5, 0, 0.5)
		GAS.ModuleFrame:MoveTo(200,0, 0.5, 0, 0.5)
	end
	function GAS.Menu:OnClose()
		if (IsValid(GAS.ModuleFrame) and GAS.ModuleFrame.Fullscreened) then
			GAS.ModuleFrame:Stop()
			GAS.ModuleFrame:SizeTo(ScrW(), ScrH(), 0.5, 0, 0.5)
			GAS.ModuleFrame:MoveTo(0, 0, 0.5, 0, 0.5)
		end
	end

	GAS.Menu.Modules = vgui.Create("bVGUI.Categories", GAS.Menu)
	GAS.Menu.Modules:Dock(LEFT)
	GAS.Menu.Modules:SetWide(200)
	GAS.Menu.Modules:SetDrawBackground(false)
	GAS.Menu.Modules.IndexedItems = {}

	GAS.Menu.Content = vgui.Create("bVGUI.BlankPanel", GAS.Menu)
	GAS.Menu.Content:Dock(FILL)
	function GAS.Menu.Content:PaintOver(w,h)
		surface.SetDrawColor(255,255,255,255)
		surface.SetMaterial(bVGUI.MATERIAL_SHADOW)
		surface.DrawTexturedRect(0,0,10,h)
	end

	GAS.Menu.DragThink = GAS.Menu.Think
	function GAS.Menu:Think()
		self:DragThink()
		if (IsValid(GAS.ModuleFrame)) then
			self:SetTall(GAS.ModuleFrame:GetTall())
			if (self.Dragging) then
				local x,y = self:GetPos()
				GAS.ModuleFrame:SetPos(x + self:GetWide() - 1, y)
			end
		elseif (GAS.Menu:GetWide() ~= 800 or GAS.Menu:GetTall() ~= 500) then
			GAS.Menu:SetSize(800,500)
			GAS.Menu:Center()
			GAS.Menu.Modules:ClearActive()
		end
	end

	function GAS.Menu:DermaMenuOptions(menu)
		menu:AddOption(L"close", function()
			GAS.Menu:Close()
		end):SetIcon("icon16/cancel.png")
		menu:AddOption(L"website", function()
			GAS:OpenURL("https://gmodadminsuite.com")
		end):SetIcon("icon16/monitor.png")
		menu:AddOption(L"wiki", function()
			GAS:OpenURL("https://gmodsto.re/gmodadminsuite-wiki")
		end):SetIcon("icon16/book.png")
		-- menu:AddOption("Discord", function()
		-- 	GAS:OpenURL("https://gmodsto.re/gmodadminsuite-discord")
		-- end):SetIcon("materials/gmodadminsuite/discord.png")
	end

	local function SizeAndPosition(size_w, size_h, pos_x, pos_y)
		size_w = size_w + 200
		size_h = size_h + 24

		GAS.Menu:Stop()

		local anim = GAS.Menu:NewAnimation(0.5)
		anim.Size  = Vector(size_w, size_h, 0)
		anim.Think = function(anim, panel, fraction)
			if (not anim.StartSize) then
				local w, h = panel:GetSize()
				anim.StartSize = Vector(w, h, 0)
			end

			local size = LerpVector(fraction, anim.StartSize, anim.Size)
			panel:SetSize(size.x, size.y)
		end

		local anim = GAS.Menu:NewAnimation(0.5)
		anim.Pos   = Vector(pos_x or ((ScrW() / 2) - (size_w / 2)), pos_y or ((ScrH() / 2) - (size_h / 2)))
		anim.Think = function(anim, panel, fraction)
			if (not anim.StartPos) then
				local w, h = panel:GetPos()
				anim.StartPos = Vector(w, h, 0)
			end

			local size = LerpVector(fraction, anim.StartPos, anim.Pos)
			panel:SetPos(size.x, size.y)
		end
	end

	GAS.Menu.Tabs = vgui.Create("bVGUI.Tabs", GAS.Menu.Content)
	GAS.Menu.Tabs:Dock(TOP)
	GAS.Menu.Tabs:SetTall(40)

	local welcome_content = GAS.Menu.Tabs:AddTab(L"welcome", Color(76,216,76))

	GAS.Menu.Info = vgui.Create("bVGUI.BlankPanel", welcome_content)
	GAS.Menu.Info:Dock(FILL)

	GAS.Menu.Info.Logo = vgui.Create("DImage", GAS.Menu.Info)
	GAS.Menu.Info.Logo:SetMaterial(logo_mat)
	GAS.Menu.Info.Logo:SetSize(256,256)

	GAS.Menu.Info.ButtonContainer = vgui.Create("bVGUI.BlankPanel", GAS.Menu.Info)
	GAS.Menu.Info.ButtonContainer:SetSize(150,(30 * 3) + (10 * 2))

	local btn1 = vgui.Create("bVGUI.Button", GAS.Menu.Info.ButtonContainer)
	btn1:Dock(TOP)
	btn1:DockMargin(0,0,0,10)
	btn1:SetColor(bVGUI.BUTTON_COLOR_RED)
	btn1:SetText(L"website")
	function btn1:DoClick()
		GAS:OpenURL("https://gmodadminsuite.com")
	end

	local btn2 = vgui.Create("bVGUI.Button", GAS.Menu.Info.ButtonContainer)
	btn2:Dock(TOP)
	btn2:DockMargin(0,0,0,10)
	btn2:SetColor(bVGUI.BUTTON_COLOR_GREEN)
	btn2:SetText(L"wiki")
	function btn2:DoClick()
		GAS:OpenURL("https://gmodsto.re/gmodadminsuite-wiki")
	end

	local btn3 = vgui.Create("bVGUI.Button", GAS.Menu.Info.ButtonContainer)
	btn3:Dock(TOP)
	btn3:SetColor(Color(114, 137, 218))
	btn3:SetText("Discord")
	function btn3:DoClick()
		GAS:OpenURL("https://gmodsto.re/gmodadminsuite-discord")
	end

	GAS.Menu.Info.Copyright = vgui.Create("DLabel", GAS.Menu.Info)
	GAS.Menu.Info.Copyright:SetText("Copyright © " .. os.date("%Y") .. " Billy Venner")
	GAS.Menu.Info.Copyright:SetFont(bVGUI.FONT(bVGUI.FONT_CIRCULAR, "REGULAR", 14))
	GAS.Menu.Info.Copyright:SizeToContents()
	GAS.Menu.Info.Copyright:SetMouseInputEnabled(true)
	GAS.Menu.Info.Copyright:SetCursor("hand")
	GAS.Menu.Info.Copyright:SetTextColor(Color(255,255,255,10))
	function GAS.Menu.Info.Copyright:DoClick()
		GAS:OpenURL("https://steamcommunity.com/profiles/76561198040894045")
	end

	function GAS.Menu.Info:PerformLayout()
		self.Logo:SetPos(self:GetWide() / 2 - self.Logo:GetWide() / 2, self:GetTall() / 2 - self.Logo:GetTall() / 2 - 150 / 2 - 5)
		self.ButtonContainer:SetPos(self:GetWide() / 2 - self.ButtonContainer:GetWide() / 2, self:GetTall() / 2 + 5)
		self.Copyright:CenterHorizontal()
		self.Copyright:AlignBottom(10)
	end

	local settings_content, settings_tab = GAS.Menu.Tabs:AddTab(L"settings", Color(76,76,216))
	settings_tab:SetFunction(function()
		if (settings_content.Content) then
			PrintTable(settings_content.Content)
			for _,v in ipairs(settings_content.Content) do
				v:Remove()
			end
			settings_content.Content = {}
		else
			settings_content.Content = {}
		end

		local tabs = vgui.Create("bVGUI.Tabs", settings_content)
		tabs:Dock(TOP)
		tabs:SetTall(40)
		table.insert(settings_content.Content, tabs)

		local general_settings = tabs:AddTab(L"general", Color(216,76,76))
		local language_settings = tabs:AddTab(L"localization", Color(76,216,76))

		local general_settings_form = vgui.Create("bVGUI.Form", general_settings)
		general_settings_form:Dock(FILL)
		general_settings_form:DockMargin(15,15,15,15)
		general_settings_form:SetPaddings(15,15)

		local _,combobox = general_settings_form:AddComboBox(L"setting_default_module", nil, L"setting_default_module_tip", function(index, val, data)
			GAS.LocalConfig.DefaultModule = data
			GAS:SaveLocalConfig("gas", GAS.LocalConfig)
		end)
		combobox:SetSortItems(false)
		combobox:AddChoice(L"none", false, not GAS.LocalConfig.DefaultModule, "icon16/cross.png")

		general_settings_form:AddSwitch(L"setting_menu_voicechat", GAS.LocalConfig.AllowVoiceChat, L"setting_menu_voicechat_tip", function(val)
			GAS.LocalConfig.AllowVoiceChat = val
			GAS:SaveLocalConfig("gas", GAS.LocalConfig)
		end)

		general_settings_form:AddSwitch(L"settings_player_popup_close", GAS.LocalConfig.ClosePlayerPopups, L"settings_player_popup_close_tip", function(val)
			GAS.LocalConfig.ClosePlayerPopups = val
			GAS:SaveLocalConfig("gas", GAS.LocalConfig)
		end)

		local language_settings_form = vgui.Create("bVGUI.Form", language_settings)
		language_settings_form:Dock(FILL)
		language_settings_form:DockMargin(15,15,15,15)
		language_settings_form:SetPaddings(15,15)

		language_settings_form:AddTextEntry(L"short_date_format", GAS.Languages.Config.ShortDateFormat or "", L"short_date_format_tip", function(val)
			if (#val == 0) then
				GAS.Languages.Config.ShortDateFormat = false
			else
				GAS.Languages.Config.ShortDateFormat = val
			end
		end, nil, L"default_format")

		language_settings_form:AddTextEntry(L"long_date_format", GAS.Languages.Config.LongDateFormat or "", L"long_date_format_tip", function(val)
			if (#val == 0) then
				GAS.Languages.Config.LongDateFormat = false
			else
				GAS.Languages.Config.LongDateFormat = val
			end
		end, nil, L"default_format")

		language_settings_form:AddSpacing(15)

		local function create_language_setting(module_name, info)
			local _,language_combobox = language_settings_form:AddComboBox(info.Name, nil, "", function(index, value, data)
				if (not data) then
					GAS.Languages.Config.SelectedLanguages[module_name] = nil
				else
					GAS.Languages.Config.SelectedLanguages[module_name] = data
				end
				GAS:SaveLocalConfig("languages", GAS.Languages.Config)
			end, info.Icon)
			language_combobox:SetSortItems(false)
			if (module_name ~= "GAS") then
				language_combobox:AddChoice(L"use_gas_language", false, GAS.Languages.Config.SelectedLanguages[module_name] == nil, "icon16/wand.png")
			end
			for language_name, language_info in pairs(GAS.Languages.LanguageData[module_name]) do
				local selected = false
				if (GAS.Languages.Config.SelectedLanguages[module_name] and GAS.Languages.Config.SelectedLanguages[module_name] == language_name) then
					selected = true
				end
				language_combobox:AddChoice(language_info.Name, language_name, selected, language_info.Flag)
			end
		end
		create_language_setting("GAS", {
			Name = "GmodAdminSuite",
			Icon = "icon16/shield.png",
		})
		for module_name, info in pairs(GAS.Modules.Info) do
			if (info.NoMenu or info.Hidden) then continue end
			combobox:AddChoice(info.Name, module_name, GAS.LocalConfig.DefaultModule == module_name, info.Icon)
			create_language_setting(module_name, info)
		end
	end)

	if (is_operator) then
		local operator_content = GAS.Menu.Tabs:AddTab(L"operator", Color(216,76,76))

		local operator_tabs = vgui.Create("bVGUI.Tabs", operator_content)
		operator_tabs:Dock(TOP)
		operator_tabs:SetTall(40)

		local modules_tab_content = operator_tabs:AddTab(L"modules", Color(76,216,76))
		function modules_tab_content:PaintOver(w,h)
			surface.SetDrawColor(255,255,255,255)
			surface.SetMaterial(bVGUI.MATERIAL_SHADOW)
			surface.DrawTexturedRect(175,0,10,h)
		end

		local modules_categories = vgui.Create("bVGUI.Categories", modules_tab_content)
		modules_categories:Dock(LEFT)
		modules_categories:SetWide(175)

		local modules_content

		modules_categories:AddItem(L"permissions", function()
			if (IsValid(modules_content)) then
				modules_content:Remove()
			end
			modules_content = vgui.Create("bVGUI.BlankPanel", modules_tab_content)
			modules_content:Dock(FILL)

			local permissions_btn_c = vgui.Create("bVGUI.ButtonContainer", modules_content)
			permissions_btn_c:DockMargin(10,10,10,10)
			permissions_btn_c:Dock(TOP)
			permissions_btn_c:SetTall(25)

			local permissions_btn = permissions_btn_c.Button
			permissions_btn:SetColor(bVGUI.BUTTON_COLOR_ORANGE)
			permissions_btn:SetText("OpenPermissions")
			permissions_btn:SetSize(150,25)
			function permissions_btn:DoClick()
				GAS:PlaySound("flash")
				RunConsoleCommand("openpermissions", "gmodadminsuite")
			end

			local text = vgui.Create("DLabel", modules_content)
			text:SetFont(bVGUI.FONT(bVGUI.FONT_CIRCULAR, "REGULAR", 14))
			text:Dock(FILL)
			text:SetContentAlignment(8)
			text:DockMargin(10,0,10,10)
			text:SetTextColor(bVGUI.COLOR_WHITE)
			text:SetText(L"permissions_help")
			text:SetWrap(true)
		end, Color(255,150,50))

		for category, modules in pairs(GAS.Modules.Organised) do
			local category_vgui
			local category_col
			if (category == GAS.MODULE_CATEGORY_ADMINISTRATION) then
				category_col = Color(255,35,35)
				category_vgui = modules_categories:AddCategory(L"administration", category_col)
			elseif (category == GAS.MODULE_CATEGORY_PLAYER_MANAGEMENT) then
				category_col = Color(0,130,255)
				category_vgui = modules_categories:AddCategory(L"player_management", category_col)
			elseif (category == GAS.MODULE_CATEGORY_UTILITIES) then
				category_col = Color(255,75,0)
				category_vgui = modules_categories:AddCategory(L"utilities", category_col)
			elseif (category == GAS.MODULE_CATEGORY_FUN) then
				category_col = Color(190,0,255)
				category_vgui = modules_categories:AddCategory(L"fun", category_col)
			end
			for module_name, info in pairs(modules) do
				local icon = "icon16/delete.png"
				if (GAS.Modules.Config.Enabled[module_name]) then
					icon = "icon16/accept.png"
				end
				local friendly_name = GAS.Modules:GetFriendlyName(module_name)
				local module_item
				module_item = category_vgui:AddItem(friendly_name, function()
					if (IsValid(modules_content)) then
						modules_content:Remove()
					end
					modules_content = vgui.Create("bVGUI.BlankPanel", modules_tab_content)
					modules_content:Dock(FILL)

					local header = vgui.Create("bVGUI.Header", modules_content)
					header:Dock(TOP)
					header:SetText(friendly_name)
					header:SetColor(category_col)
					header:DockMargin(0,0,0,10)

					if (info.Icon) then
						local icon1 = vgui.Create("DImage", header)
						icon1:SetSize(16,16)
						icon1:SetImage(info.Icon)

						local icon2 = vgui.Create("DImage", header)
						icon2:SetSize(16,16)
						icon2:SetImage(info.Icon)

						function header:PerformLayout()
							icon1:AlignLeft(5)
							icon1:CenterVertical()

							icon2:AlignRight(5)
							icon2:CenterVertical()
						end
					end

					local switch_container = vgui.Create("bVGUI.BlankPanel", modules_content)
					switch_container:Dock(TOP)
					switch_container:SetTall(40)
					switch_container:DockMargin(0,0,0,10)

					local switch = vgui.Create("bVGUI.Switch", switch_container)
					switch:SetChecked(GAS.Modules.Config.Enabled[module_name] or false)
					switch:SetText(L"enabled")
					function switch:OnChange()
						if (self:GetChecked()) then
							module_item:SetIcon("icon16/accept.png")
						else
							module_item:SetIcon("icon16/delete.png")
						end
						GAS.Modules.Config.Enabled[module_name] = self:GetChecked() or nil
						GAS:netStart("SetModuleEnabled")
							net.WriteString(module_name)
							net.WriteBool(self:GetChecked())
						net.SendToServer()
					end
					bVGUI.AttachTooltip(switch.ClickableArea, {Text = L"module_enable_switch_tip"})

					function switch_container:PerformLayout()
						switch:Center()
					end

					local script_buttons_container
					local script_buttons = {}
					if (info.GmodStore or info.CridentStore) then
						script_buttons_container = vgui.Create("bVGUI.BlankPanel", modules_content)
						script_buttons_container:Dock(TOP)
						script_buttons_container:SetTall(25)
						script_buttons_container:DockMargin(0,0,0,10)
						function script_buttons_container:PerformLayout(_w)
							local w = (_w - (#script_buttons * (125 + 10)) + 10) / 2
							for i,v in ipairs(script_buttons) do
								v:AlignLeft(w + ((i - 1) * (10 + 125)))
							end
						end
					end

					if (info.GmodStore) then
						local gms = vgui.Create("bVGUI.Button", script_buttons_container)
						table.insert(script_buttons, gms)
						gms:SetSize(125,25)
						gms:SetColor(Color(0,152,234))
						gms:SetText("GmodStore")
						function gms:DoClick()
							GAS:OpenURL("https://gmodstore.com/market/view/" .. info.GmodStore)
						end
					end

					if (info.CridentStore) then
						local crs = vgui.Create("bVGUI.Button", script_buttons_container)
						table.insert(script_buttons, crs)
						crs:SetSize(125,25)
						crs:SetColor(Color(255,40,0))
						crs:SetText("Crident Store")
						function crs:DoClick()
							GAS:OpenURL("https://crident.store/market/products/" .. info.CridentStore)
						end
					end

					if (info.Wiki) then
						local wiki_c = vgui.Create("bVGUI.ButtonContainer", modules_content)
						wiki_c:Dock(TOP)
						wiki_c:SetTall(25)
						wiki_c:DockMargin(0,0,0,10)

						wiki_c.Button:SetColor(bVGUI.BUTTON_COLOR_GREEN)
						wiki_c.Button:SetText(L"wiki")
						wiki_c.Button:SetSize(125,25)
						function wiki_c.Button:DoClick()
							GAS:OpenURL(info.Wiki)
						end
					end
				end, nil, icon)
			end
		end
	end

	local created_anything = false
	for category, modules in pairs(GAS.Modules.Organised) do
		local category_vgui
		for module_name, info in pairs(modules) do
			if (info.NoMenu or info.Hidden) then continue end
			if (info.DarkRP == true and DarkRP == nil) then continue end
			if (GAS.Modules:IsModuleEnabled(module_name) ~= GAS.Modules.MODULE_ENABLED) then continue end
			if (info.OperatorOnly and not is_operator) then continue end
			if (not is_operator and not OpenPermissions:HasPermission(LocalPlayer(), "gmodadminsuite/" .. module_name)) then continue end
			created_anything = true
			if (not category_vgui) then
				if (category == GAS.MODULE_CATEGORY_ADMINISTRATION) then
					category_vgui = GAS.Menu.Modules:AddCategory(L"administration", Color(255,35,35))
				elseif (category == GAS.MODULE_CATEGORY_PLAYER_MANAGEMENT) then
					category_vgui = GAS.Menu.Modules:AddCategory(L"player_management", Color(0,130,255))
				elseif (category == GAS.MODULE_CATEGORY_UTILITIES) then
					category_vgui = GAS.Menu.Modules:AddCategory(L"utilities", Color(255,75,0))
				elseif (category == GAS.MODULE_CATEGORY_FUN) then
					category_vgui = GAS.Menu.Modules:AddCategory(L"fun", Color(190,0,255))
				end
			end
			local item = category_vgui:AddItem(GAS.Modules:GetFriendlyName(module_name), function()
				GAS.Menu.ModuleOpen = module_name

				GAS:OpenModuleFrame(module_name)
				
				GAS.Menu.Fullscreened = false

				local _,h = GAS.ModuleFrame:GetSize()
				GAS.Menu:SetTall(h)
			end, nil, info.Icon)
			if (IsValid(GAS.ModuleFrame)) then
				if (GAS.ModuleFrame.ModuleName == module_name) then
					item:SetActive(true)
				end
			elseif (GAS.LocalConfig.DefaultModule == module_name) then
				item:OnMouseReleased(MOUSE_LEFT)
			end

			GAS.Menu.Modules.IndexedItems[module_name] = item
		end
	end
	if (not created_anything) then
		if (not is_operator) then
			GAS:PlaySound("error")
			bVGUI.RichMessage({
				title = L"no_modules_available",
				text = L"no_modules_available_info",
				button = "OK"
			})
			GAS.Menu:Close()
		else
			GAS.Menu.Modules:SetWide(0)
		end
	else
		GAS.Menu:SetVisible(true)
	end
end

function GAS:OpenMenu()
	if (not GAS_InitPostEntity) then GAS:InitPostEntity_Run() end
	if (IsValid(GAS.Menu)) then GAS.Menu:Close() end

	if (not GAS.Modules.Config) then
		GAS:GetConfig("modules", function(config)
			GAS.Modules.Config = config
			for module_name, enabled in pairs(GAS.Modules.Config.Enabled) do
				if (not enabled) then continue end
				GAS.Modules:LoadModule(module_name, true)
			end
			OpenMenu()
		end)
	else
		OpenMenu()
	end
end

GAS:netReceive("menu", function()
	local selected_module = net.ReadString()
	if (#selected_module == 0) then
		selected_module = false
	end
	if (not selected_module or not hook.Run("gmodadminsuite:ModuleMenu:" .. selected_module)) then
		if (selected_module) then
			GAS:OpenModuleFrame(selected_module)
		else
			GAS:OpenMenu()
		end
	end
end)
--addons/gprofiler/lua/gprofiler/cl_language.lua:
return gluapack()()
--addons/gprofiler/lua/gprofiler/profilers/net/sh_net.lua:
GProfiler.Net = GProfiler.Net or {}
GProfiler.Net.IsDetoured = GProfiler.Net.IsDetoured or false
GProfiler.Net.ProfileData = GProfiler.Net.ProfileData or {}

local netReadHeader = net.ReadHeader
local util = util

function GProfiler.Net:StartProfiler(ply)
	if not GProfiler.Access.HasAccess(ply or LocalPlayer()) or GProfiler.Net.IsDetoured then return end

	GProfiler.Log((SERVER and "Server" or "Client") .. " net profiler started!", 2)
	GProfiler.Net.ProfileData = {}
	GProfiler.Net.IsDetoured = true
	GProfiler.Net.ProfileStarted = SysTime()

	GProfiler.Net.OriginalIncoming = GProfiler.Net.OriginalIncoming or net.Incoming

	function net.Incoming(len, client)
		local i = netReadHeader()
		local strName = util.NetworkIDToString(i)

		if not strName then return end

		if not GProfiler.Net.ProfileData[strName] then
			GProfiler.Net.ProfileData[strName] = {0, 0, 0, nil, nil, nil, 0, 0, 0}
		end

		len = len - 16

		local d = GProfiler.Net.ProfileData[strName]
		d[1] = d[1] + 1
		d[2] = math.max(d[2], len)
		d[3] = d[3] + len

		local func = net.Receivers[strName:lower()]
		if not func then return end

		if not d[4] then
			local Source = debug.getinfo(func, "S")
			if Source then
				d[4] = Source.short_src
				d[5] = Source.linedefined
				d[6] = Source.lastlinedefined
			end
		end

		local start = SysTime()
		func(len, client)
		local endT = SysTime()
		d[7] = d[7] + (endT - start)
		d[8] = math.max(d[8], endT - start)
		d[9] = d[7] / d[1]
	end
end

function GProfiler.Net:RestoreNet(ply)
	if not GProfiler.Access.HasAccess(ply or LocalPlayer()) or not GProfiler.Net.IsDetoured then return end

	GProfiler.Log((SERVER and "Server" or "Client") .. " net profile stopped, sending data!", 2)
	GProfiler.Net.IsDetoured = false
	GProfiler.Net.ProfileStarted = nil

	net.Incoming = GProfiler.Net.OriginalIncoming

	if SERVER then
		net.Start("GProfiler_Net_SendData")
		net.WriteUInt(table.Count(GProfiler.Net.ProfileData), 32)
		for name, data in pairs(GProfiler.Net.ProfileData) do
			net.WriteString(name)
			net.WriteUInt(data[1], 32)
			net.WriteUInt(data[2], 32)
			net.WriteUInt(data[3], 32)
			net.WriteString(data[4] or "")
			net.WriteUInt(data[5] or 0, 16)
			net.WriteUInt(data[6] or 0, 16)
			net.WriteFloat(data[7])
			net.WriteFloat(data[8])
			net.WriteFloat(data[9])
		end
		net.Send(ply)
	end
end

if SERVER then
	util.AddNetworkString("GProfiler_Net_ToggleServerProfile")
	util.AddNetworkString("GProfiler_Net_ServerProfileStatus")
	util.AddNetworkString("GProfiler_Net_SendData")
	util.AddNetworkString("GProfiler_Net_ReceiverTbl")

	net.Receive("GProfiler_Net_ToggleServerProfile", function(len, ply)
		if not GProfiler.Access.HasAccess(ply) then return end

		local startStop = net.ReadBool()
		if startStop then
			GProfiler.Net:StartProfiler(ply)
			net.Start("GProfiler_Net_ServerProfileStatus")
			net.WriteBool(true)
			net.WriteEntity(ply)
			net.Broadcast()
		else
			GProfiler.Net:RestoreNet(ply)
			net.Start("GProfiler_Net_ServerProfileStatus")
			net.WriteBool(false)
			net.WriteEntity(ply)
			net.Broadcast()
		end
	end)

	net.Receive("GProfiler_Net_ReceiverTbl", function(len, ply)
		if not GProfiler.Access.HasAccess(ply) then return end

		net.Start("GProfiler_Net_ReceiverTbl")
		net.WriteUInt(table.Count(net.Receivers), 32)
		for name, func in pairs(net.Receivers) do
			local Source = debug.getinfo(func, "S") or {}
			net.WriteString(name)
			net.WriteString(string.format("%s (%s)", tostring(func), GProfiler.GetFunctionLocation(func)))
			net.WriteString(Source.short_src or "")
			net.WriteUInt(Source.linedefined or 0, 16)
			net.WriteUInt(Source.lastlinedefined or 0, 16)
		end
		net.Send(ply)
	end)
end

--addons/gprofiler/lua/gprofiler/profilers/timers/sh_timers.lua:
return gluapack()()
--addons/status_do/lua/holo_config.lua:
return gluapack()()
--lua/autorun/init_improvedstacker.lua:
return gluapack()()
--addons/minigame-tool-assistant/lua/minigames/configuration.lua:
return gluapack()()
--addons/minigame-tool-assistant/lua/minigames/cl_init.lua:
return gluapack()()
--addons/minigame-tool-assistant/lua/minigames/vgui/gameconfig.lua:
return gluapack()()
--addons/minigame-tool-assistant/lua/minigames/vgui/rewardconfig.lua:
--[[--------------------------------------------
        Minigame Setup Menu - Rewards Config
--------------------------------------------]]--

-- local MAX_REWARDS = 8
local Background = Color(30, 30, 30, 180)

local ButtonStyleBackground = Color(82, 82, 82, 150)
local BlackBackground = Color(0, 0, 0, 40)

local ShadingColor = {}
for i = 1, 16 do
    ShadingColor[i] = Color(0, 158, 185, (i * 160) / 16)
end

local ButtonStyle = function(SelfButton, w, h)
    if not SelfButton:IsEnabled() then
        draw.RoundedBox(4, 0, 0, w, h, Color(0, 0, 0, 100))
    else
        draw.RoundedBox(4, 0, 0, w, h, ButtonStyleBackground)

        if SelfButton:IsHovered() then
            draw.RoundedBox(4, 0, 0, w, h, BlackBackground)

            for i = 1, 16 do
                draw.RoundedBox(0, 0, h + i - 16, w, 1, ShadingColor[i])
            end
        end
    end
end



--[[----------------------------
         Reward Settings
----------------------------]]--

local REWARDSETTINGS = {}

function REWARDSETTINGS:Init()
    self.RewardID = nil

    self.Title = self:Add("DLabel")
    self.Title:SetText( Minigames.GetPhrase("reward.select") )
    self.Title:SetFont("Minigames.Text")
    self.Title:SetTextColor(color_white)
    self.Title:SetContentAlignment(5)
    self.Title:Dock(TOP)
    self.Title:DockMargin(5, 5, 5, 5)
    self.Title:SetWrap(true)
    self.Title:SetAutoStretchVertical(true)

    self.Input = self:Add("DPanel")
    self.Input:Dock(FILL)
    self.Input:DockMargin(5, 5, 5, 5)
    self.Input.Reward = {}
    self.Input.Paint = function(_, w, h)
        draw.RoundedBox(4, 0, 0, w, h, ButtonStyleBackground)
    end

    self.Submit = self:Add("DButton")
    self.Submit:SetText( Minigames.GetPhrase("reward.add") )
    self.Submit:SetTextColor(color_white)
    self.Submit:Dock(BOTTOM)
    self.Submit:DockMargin(5, 5, 5, 5)
    self.Submit:SetDisabled(true)
    self.Submit.Paint = ButtonStyle

    self.Submit.DoClick = function()
        local Reward = Minigames.GetReward(self.RewardID)

        for _, Argument in ipairs(self.Input.Reward) do
            if Argument.InputType == "text" then
                if Argument:GetNumeric() then
                    Reward:AddValue( Argument:GetInt() )
                else
                    Reward:AddValue( Argument:GetText() )
                end
            elseif Argument.InputType == "slider" then
                Reward:AddValue( math.floor( Argument:GetValue() ) )
            elseif Argument.InputType == "list" then
                local _, data = Argument:GetSelected()
                Reward:AddValue( data )
            end
        end

        Reward:AddReward()
    end
end

function REWARDSETTINGS:SetReward(RewardID)
    if not Minigames.GetReward(RewardID) then return end

    self.RewardID = RewardID
    self.Submit:SetDisabled(false)

    -- Remove old input
    self.Input:Clear()
    self.Input.Reward = {}

    local RewardData = Minigames.GetReward(RewardID)

    self.Title:SetText( RewardData["Name"] )

    for _, ArgumentTbl in ipairs(RewardData["Arguments"]) do
        local ArgumentPanel = self.Input:Add("DPanel")
        ArgumentPanel:Dock(TOP)
        ArgumentPanel:DockMargin(5, 5, 5, 5)
        ArgumentPanel:DockPadding(10, 0, 10, 0)
        ArgumentPanel:SetTall(52)
        ArgumentPanel.Paint = function(_, w, h)
            draw.RoundedBox(4, 0, 0, w, h, ButtonStyleBackground)
        end

        local ArgumentLabel = ArgumentPanel:Add("DLabel")
        ArgumentLabel:SetText( ArgumentTbl["Name"] )
        ArgumentLabel:SetFont("Minigames.Text")
        ArgumentLabel:SetTextColor(color_white)
        ArgumentLabel:Dock(TOP)
        ArgumentLabel:DockMargin(5, 3, 5, 3)
        ArgumentLabel:SetWide(100)
        ArgumentLabel:SetContentAlignment(5)

        if ArgumentTbl["Type"] == "text" then
            local ArgumentText = ArgumentPanel:Add("DTextEntry")
            ArgumentText:SetText( ArgumentTbl["Default"] )
            ArgumentText:SetPlaceholderText( ArgumentTbl["Placeholder"] )
            ArgumentText:Dock(FILL)
            ArgumentText:SetNumeric( ArgumentTbl["Numeric"] or false )
            ArgumentText.InputType = "text"

            table.insert(self.Input.Reward, ArgumentText)

        elseif ArgumentTbl["Type"] == "slider" then
            ArgumentLabel:Remove()

            local ArgumentSlider = ArgumentPanel:Add("DNumSlider")
            ArgumentSlider:SetText( ArgumentTbl["Name"] )
            ArgumentSlider:SetMin( ArgumentTbl["Min"] )
            ArgumentSlider:SetMax( ArgumentTbl["Max"] )
            ArgumentSlider:SetValue( ArgumentTbl["Default"] )
            ArgumentSlider:SetDecimals(0)
            ArgumentSlider:Dock(FILL)
            ArgumentSlider.InputType = "slider"

            table.insert(self.Input.Reward, ArgumentSlider)

        elseif ArgumentTbl["Type"] == "list" then
            local ArgumentList = ArgumentPanel:Add("DComboBox")
            ArgumentList:Dock(FILL)
            ArgumentList:SetValue( ArgumentTbl["Default"] )
            ArgumentList.InputType = "list"

            if ArgumentTbl["IsDictionary"] then
                for Value, Option in pairs(ArgumentTbl["Options"]) do
                    ArgumentList:AddChoice(Option, Value, Value == ArgumentTbl["Default"])
                end
            else
                for _, Option in ipairs(ArgumentTbl["Options"]) do
                    ArgumentList:AddChoice(Option, Option, Option == ArgumentTbl["Default"])
                end
            end

            ArgumentList.OnSelect = function(_, _, value)
                ArgumentList:SetValue(value)
            end

            table.insert(self.Input.Reward, ArgumentList)

        elseif ArgumentTbl["Type"] == "none" then
            ArgumentLabel:Dock(FILL)
            ArgumentLabel:SetText( ArgumentTbl["Name"] )
        end
    end
end

function REWARDSETTINGS:Paint()
    -- Nothing
end

vgui.Register("Minigames.RewardSettings", REWARDSETTINGS, "DPanel")



--[[----------------------------
           Reward Menu
----------------------------]]--

local PANEL = {}

function PANEL:AddReward(Reward)
    local RewardPanel = self.Container:Add("DButton")
    RewardPanel:SetText(Reward:GetNameAmount() or Minigames.GetPhrase("reward.nothing"))
    RewardPanel:SetTextColor(color_white)

    if Reward:GetIcon() then
        RewardPanel:SetImage( Reward:GetIcon() )
    end

    RewardPanel:Dock(TOP)
    RewardPanel:DockMargin(3, 3, 3, 3)
    RewardPanel:SetTall(24)
    RewardPanel.Paint = ButtonStyle

    RewardPanel.DoClick = function(SubSelf)
        Reward:RemoveReward()
    end

    return RewardPanel
end

function PANEL:GetRewards()
    if not Minigames.ActiveGames[ LocalPlayer() ] then return {} end

    return Minigames.ActiveGames[ LocalPlayer() ]:GetRewards()
end

function PANEL:QueryReward()
    self.RewardSelected = {}

    self.PopUp = vgui.Create("DFrame")
    self.PopUp:SetSize( math.max(ScrW() * .36, 400), math.max(ScrH() * .71, 240))
    self.PopUp:Center()
    self.PopUp:SetTitle(Minigames.GetPhrase("reward.title"))
    self.PopUp:MakePopup()
    self.PopUp.Paint = Minigames.Paint

    self.List = self.PopUp:Add("DScrollPanel")
    self.List:Dock(LEFT)
    self.List:SetWide(200)
    self.List:DockMargin(5, 5, 5, 5)
    self.List.Paint = function(_, w, h)
        draw.RoundedBox(4, 0, 0, w, h, Background)
    end
    self.List.VBar.Paint = nil

    self.PopUp.Buttons = self.PopUp:Add("Minigames.RewardSettings")
    self.PopUp.Buttons:Dock(FILL)
    self.PopUp.Buttons:DockMargin(5, 5, 5, 5)

    local EmptySpace = self.List:Add("Panel")
    EmptySpace:Dock(TOP)
    EmptySpace:SetTall(2)
    EmptySpace.Paint = nil

    for RewardID, RewardData in pairs(Minigames.GetRewards()) do
        local RewardPanel = self.List:Add("DButton")
        RewardPanel:SetText( RewardData["Name"] )
        RewardPanel:SetTextColor(color_white)
        RewardPanel:SetIcon( RewardData["Icon"] )
        RewardPanel:Dock(TOP)
        RewardPanel:DockMargin(5, 2, 5, 2)
        RewardPanel:SetTall(24)
        RewardPanel.Paint = ButtonStyle

        RewardPanel.DoClick = function()
            self.PopUp.Buttons:SetReward(RewardID)
        end
    end
end

function PANEL:ClosePopUp()
    if IsValid(self.PopUp) then
        self.PopUp:Remove()
    end
end

function PANEL:AddAllRewards()
    self.Container:Clear()

    local Rewards = self:GetRewards()
    for _, Reward in ipairs(Rewards) do
        self:AddReward( Reward )
    end
end

function PANEL:Init()
    self.Title = self:Add("DLabel")
    self.Title:SetText( Minigames.GetPhrase("reward.title") )
    self.Title:SetFont("Minigames.Title")
    self.Title:SetTextColor(color_white)
    self.Title:Dock(TOP)
    self.Title:DockMargin(5, 5, 5, 5)

    self.Container = self:Add("DScrollPanel")
    self.Container:Dock(FILL)
    self.Container:DockMargin(5, 5, 5, 5)
    self.Container.Paint = function(_, w, h)
        draw.RoundedBox(4, 0, 0, w, h, Background)
    end

    self:AddAllRewards()

    self.Buttons = self:Add("Panel")
    self.Buttons:Dock(RIGHT)
    self.Buttons:DockMargin(5, 5, 5, 5)
    self.Buttons:SetWide(50)

    self.AddButton = self.Buttons:Add("DButton")
    self.AddButton:SetText("+")
    self.AddButton:Dock(TOP)
    self.AddButton:DockMargin(0, 0, 0, 5)
    self.AddButton:SetTextColor(color_white)
    self.AddButton.Paint = ButtonStyle
    self.AddButton.DoClick = function()
        -- self:AddReward()
        self:QueryReward()
    end

    self.AddButton:SetEnabled( Minigames.GetOwnerGame( LocalPlayer() ) ~= nil )
    if not self.AddButton:IsEnabled() then
        self.AddButton:SetTooltip( Minigames.GetPhrase("reward.disabled") )
    end
end

function PANEL:Paint()
    -- Nothing
end

vgui.Register("Minigames.RewardConfig", PANEL, "DPanel")
--addons/minigame-tool-assistant/lua/minigames/games/cigarrillo43.lua:
--[[--------------------------------------------
            Red Light Green Light
--------------------------------------------]]--

local MainOffset = 160.3

local ColorRed = Color(255, 0, 0)
local ColorGreen = Color(0, 255, 0)
local KillBoxHeight = Vector(0, 0, 60)
local KillBoxHeightMax = Vector(0, 0, -120)
local KillBoxOffset = Vector(500, -500, 0)
local WinningBoxHeight = Vector(0, 0, 140)
local LookingForward = Angle(0, 90, 0)

local ScreenOffset = Vector(0, 100, 150)
local ScreenAngle = Angle(0, 0, 90)

local GhostBoxOffset = Vector(0, 0, -11)

--[[----------------------------
       Initial Game Config
----------------------------]]--

local GameScript = Minigames.CreateNewGame()

GameScript:SetGameName("Cigarrillo 43")

GameScript:AddHeader("!gameconfig")
GameScript:AddConfig("Safetime", {
    min = 0.1,
    max = 2,
    dec = 1,
    def = 0.4
})

GameScript:AddHeader("!playzoneconfig")
GameScript:AddConfig("SizeX", {
    min = 2,
    max = 60,
    def = 4
})

GameScript:AddConfig("SizeY", {
    min = 4,
    max = 60,
    def = 8
})
GameScript:AddConfig("Height", {
    min = 150,
    max = 4096,
    def = 150
})

GameScript.KeyPressKill = {
    [IN_BACK] = true,
    [IN_FORWARD] = true,
    [IN_MOVELEFT] = true,
    [IN_MOVERIGHT] = true,
}

--[[----------------------------
        Trigger Events
----------------------------]]--

GameScript:AddHook( "STOP_ONNOBODY PostPlayerDeath" )
GameScript:AddHook( "KILL_ONKEYPRESS KeyPress" )
GameScript:AddHook( "GetFallDamage" )

--[[----------------------------
          Game Events
----------------------------]]--

GameScript:AddNewVar("LookingBack", "bool", false)

function GameScript:SpawnGame( trace )

    --[[--------------------------------
            Initial Configuration
    --------------------------------]]--
    self.SizeX = self:GetOwnerConfig("SizeX")
    self.SizeY = self:GetOwnerConfig("SizeY")

    local SizeX = self.SizeX
    local SizeY = self.SizeY

    local WinningBoxMax, WinningBoxMin = vector_origin, vector_origin

    --[[--------------------------------
              Initial Game Pos
    --------------------------------]]--
    local Pos = trace.HitPos + ( trace.HitNormal * self:GetOwnerConfig("Height") )
    local PosOffset = Vector(
        math.Round( ( MainOffset * ( SizeX - 1 ) ) / 2, 0 ),
        math.Round( ( -MainOffset * ( SizeY - 1 ) ) / 2, 0 ),
        0
    )

    Pos:Sub( PosOffset )

    --[[--------------------------------
              Creation of Game
    --------------------------------]]--

    --[[------------------------
              Play Zone
    ------------------------]]--

    for i = 0, SizeX - 1 do
        local square = self:CreateEntity("minigame_bigsquare", "Floor")
        square:SetPos( Pos + Vector( MainOffset * i, 0, 0 ) )
        square:SetState(1)
        square:Spawn()

        local screen = self:CreateEntity("minigame_bigsquare", "Screen")
        screen:SetPos( square:GetPos() + ScreenOffset )
        screen:SetAngles( ScreenAngle )
        screen:SetState(2)
        screen:Spawn()

        if ( i == 0 ) then
            local FirstValue = square:GetModelBounds()
            WinningBoxMin = FirstValue + square:GetPos()

        elseif ( i == ( SizeX - 1 ) ) then
            local _, SecondValue = square:GetModelBounds()
            WinningBoxMax = SecondValue + square:GetPos() + WinningBoxHeight

        end

        for y = 1, SizeY - 1 do
            local g_square = self:CreateEntity("minigame_bigsquare", "Floor")
            g_square:SetPos( square:GetPos() + Vector(0, -MainOffset * y ) )
            g_square:SetState(-2)

            -- Last Line
            if ( y == ( SizeY - 1 ) ) then
                g_square:SetState(2)

                table.insert(self.DefaultTeleportEntities, g_square)

                if ( i == 0 ) then
                    self.StartPos = g_square:GetPos()["X"]
                    self.StartPosMin = g_square:GetPos()
                    self.StartPosMin["Z"] = self.StartPosMin["Z"] + 25

                elseif ( i == ( SizeX - 1 ) ) then
                    local ps = g_square:GetPos()

                    self.StartPos = Vector(self.StartPos, ps["Y"], ps["Z"] + 40)
                    self.StartPosMax = g_square:GetPos()
                    self.StartPosMax["Z"] = self.StartPosMax["Z"] + 25
                end
            end

            g_square:Spawn()
        end
    end

    --[[------------------------
              Kill Box
    ------------------------]]--
    local KillBoxPos = trace.HitPos + ( trace.HitNormal * self:GetOwnerConfig("Height") ) - KillBoxHeight
    local KillBoxX = ( MainOffset - 1 ) * SizeX
    local KillBoxY = ( MainOffset - 1 ) * SizeY
    local KillBoxBounds = Vector( KillBoxX - ( KillBoxX / 2 ), -KillBoxY - ( -( KillBoxY * 2 ) / 2 ), 1.5 ) + KillBoxOffset

    self.KillZone = self:CreateTrigger(KillBoxPos + KillBoxBounds, KillBoxPos + -KillBoxBounds, Minigames.Enum["KILL_ONTOUCH"])
    self.WinZone = self:CreateTrigger(WinningBoxMin, WinningBoxMax, Minigames.Enum["WIN_ONTOUCHTRIGGER"])
    self:SpawnPlayZone()

    self.TeleportOffset = Vector(0, 0, 50)
    self.DefaultTeleportEntities = self:GetAllEntities("Floor")

    return true
end

--[[----------------------------
            Game State
----------------------------]]--

function GameScript:StartGame()

    --[[------------------------
            Settings
    ------------------------]]--
    local Players = self:GetPlayers(true)

    if Minigames.Config["TeleportToGame"] and ( not table.IsEmpty( Players ) ) then
        local pos = 1 / #Players
        for i, ply in ipairs( Players ) do
            ply:SetNWInt( "Minigames.LastCollision", ply:GetCollisionGroup() )
            ply:SetCollisionGroup( COLLISION_GROUP_WEAPON )
            ply:SetEyeAngles( LookingForward )

            ply:SetVelocity( ply:GetVelocity() * -1 )
            ply:Freeze( true )

            ply:SetPos( LerpVector( i * pos, self.StartPosMin, self.StartPosMax ) )
        end
    end

    --[[------------------------
             PostGame
    ------------------------]]--
    self.TimerPreGame = self:CreateChronometer("PreGame")
    self.TimerPreGame:Wait(4)
    self.TimerPreGame:AddAction(function()
        local all = self:GetPlayers(true)
        table.insert(all, self:GetOwner())
        self:PlaySound(all, Minigames.Config["GreenLight"])

        for _, ply in ipairs( Players ) do
            ply:SetMoveType( MOVETYPE_WALK )
            ply:Freeze( false )
        end

        for _, screen in ipairs( self:GetAllEntities("Screen") ) do
            screen:SetState(1)
        end

        self.TimerPreGame:Stop()
    end)
    self.TimerPreGame:Start()

    self:PostPlayerDeath(function(ply)
        ply:SetCollisionGroup( ply:GetNWInt("Minigames.LastCollision", COLLISION_GROUP_PLAYER) )
    end)

    self:SetLookingBack(false)
    self:PlayGameStartSound()

    return Minigames.GameStart( self )
end

function GameScript:StopGame()
    self:RemoveChronometer("PreGame")
    self:RemoveChronometer("SafeTime")

    for _, ply in ipairs( self:GetPlayers(true) ) do
        ply:SetCollisionGroup( ply:GetNWInt("Minigames.LastCollision", COLLISION_GROUP_PLAYER) )
        ply:Freeze(false)
    end

    for _, screen in ipairs( self:GetAllEntities("Screen") ) do
        screen:SetState(2)
    end

    self:SetLookingBack(false)

    return Minigames.GameStop( self )
end

function GameScript:ToggleGame()
    local Result = false

    self.Safetime = self:GetOwnerConfig("Safetime")

    if self:IsActive() then
        Result = self:StopGame()
    else
        Result = self:StartGame()
    end

    return Result
end

function GameScript:ToggleRun()
    local LookingBack = self:IsLookingBack()

    local Players = self:GetPlayers(true)
    table.insert(Players, self:GetOwner())

    --[[------------------------
        Case: Early Start
    ------------------------]]--
    if ( self.TimerPreGame ~= nil and self.TimerPreGame:IsRunning() ) then
        self.TimerPreGame:Stop()
        self:PlaySound(Players, Minigames.Config["GreenLight"])

        for _, ply in ipairs( self:GetPlayers(true) ) do
            ply:Freeze( false )
        end

        for _, screen in ipairs( self:GetAllEntities("Screen") ) do
            screen:SetState(1)
        end

    --[[------------------------
        Case: Is Looking Back  OR  Early Safe Time
    ------------------------]]--
    elseif LookingBack or ( self.TimerSafeTime ~= nil and self.TimerSafeTime:IsRunning() ) then
        self:SetLookingBack(false)
        self.TimerSafeTime:Stop()
        self:PlaySound(Players, Minigames.Config["GreenLight"])

        for _, Screen in ipairs( self:GetAllEntities("Screen") ) do
            Screen:SetState(1)
        end

    --[[------------------------
        Case: Is not Looking Back
    ------------------------]]--
    else
        self:PlaySound(Players, Minigames.Config["RedLight"])

        for _, Screen in ipairs( self:GetAllEntities("Screen") ) do
            Screen:SetState(2)
        end

        if self.TimerSafeTime ~= nil then
            self:RemoveChronometer("SafeTime")
        end

        self.TimerSafeTime = self:CreateChronometer("SafeTime")
        self.TimerSafeTime:Wait( self.Safetime )
        self.TimerSafeTime:AddAction(function()
            self:SetLookingBack(true)
            local KillKeys = table.GetKeys( self.KeyPressKill )

            for _, ply in ipairs( self:GetPlayers(true) ) do
                for _, key in ipairs( KillKeys ) do
                    if ply:KeyDown( key ) then
                        ply:Kill()
                        break
                    end
                end
            end
        end)
        self.TimerSafeTime:Start()
    end

    return true
end

--[[----------------------------
        Pre-render Game
----------------------------]]--


function GameScript:PreRenderGame( trace, owner )
    local SizeX = MainOffset * self:GetOwnerConfig("SizeX")
    local SizeY = MainOffset * self:GetOwnerConfig("SizeY")
    local Height = self:GetOwnerConfig("Height")

    local VectorOrigin = trace.HitPos + ( trace.HitNormal * Height )
    local Bounds = Vector( SizeX - ( SizeX / 2 ), -SizeY - ( -SizeY / 2 ), 6 )

    local WinningBoxMin = VectorOrigin - ( Bounds + GhostBoxOffset )
    local WinningBoxMax = WinningBoxMin + Vector(SizeX, -MainOffset, 140)

    local KillBoxMax = Bounds + KillBoxOffset - KillBoxHeight
    local KillBoxMin = -KillBoxMax + KillBoxHeightMax


    if ( not trace.Hit or IsValid( trace.Entity ) and trace.Entity:IsPlayer() ) then
        hook.Remove("PostDrawTranslucentRenderables", "Minigames.DrawBox")
    else
        hook.Add("PostDrawTranslucentRenderables", "Minigames.DrawBox", function()
            render.DrawWireframeBox( VectorOrigin, angle_zero, KillBoxMax, KillBoxMin, ColorRed, true )
            render.DrawWireframeBox( VectorOrigin, angle_zero, Bounds, -Bounds, color_white, true )
            render.DrawWireframeBox( vector_up, angle_zero, WinningBoxMin, WinningBoxMax, ColorGreen, true )
        end)
    end
end


--[[----------------------------
          Main Functions
----------------------------]]--


function GameScript:LeftClick( trace, owner, FirstTime )
    local Response = false

    if FirstTime then
        Response = self:SpawnGame( trace, owner )
    else
        if IsValid( trace.Entity ) and trace.Entity:IsPlayer() then
            Response = self:TogglePlayer( trace.Entity )
        end
    end

    return Response
end


function GameScript:RightClick( trace, owner )
    return self:ToggleGame()
end


function GameScript:Reload( trace, owner )
    if CLIENT then return end

    local Result = false

    if self:IsActive() then
        Result = self:ToggleRun()
    end

    return Result
end

function GameScript:Think( trace, owner )
    if CLIENT then
        if Minigames.GetOwnerGame( LocalPlayer() ) then
            hook.Remove("PostDrawTranslucentRenderables", "Minigames.DrawBox")
        else
            self:PreRenderGame( trace )
        end
    end
end

function GameScript:RollUp( trace, owner )
    if CLIENT then
        hook.Remove("PostDrawTranslucentRenderables", "Minigames.DrawBox")
    end
end

Minigames.RegisterNewGame(GameScript)
--addons/minigame-tool-assistant/lua/minigames/games/plataforms.lua:
--[[--------------------------------------------
                Minigame Plataforms
--------------------------------------------]]--

local MainOffset = 94.89968

local RedColor = Color(255, 0, 0)
local KillBoxOffset = Vector(300, -300, 0)
local KillBoxHeight = Vector(0, 0, 60)

local LOOP_MUSIC = true

--[[----------------------------
       Initial Game Config
----------------------------]]--

local GameScript = Minigames.CreateNewGame()

GameScript:SetGameName("Plataforms")
GameScript:AddHeader("!gameconfig")

GameScript:AddConfig("Min", {
    min = 0,
    max = 0.99,
    def = 0.5,
    dec = 2,
})

GameScript:AddConfig("Max", {
    min = 0.01,
    max = 1,
    def = 1,
    dec = 2
})

GameScript:AddConfig("Increment", {
    min = 1,
    max = 20,
    def = 5,
})

GameScript:AddConfig("TimeReaction", {
    min = 0.1,
    max = 3,
    dec = 1,
    def = 0.8
})

GameScript:AddConfig("Delay", {
    min = 0.1,
    max = 10,
    dec = 1,
    def = 0.8
})

GameScript:AddHeader("!playzoneconfig")

GameScript:AddConfig("SizeX", {
    min = 1,
    max = 20,
    def = 5,
})

GameScript:AddConfig("SizeY", {
    min = 1,
    max = 20,
    def = 5,
})

GameScript:AddConfig("Height", {
    min = 150,
    max = 2048,
    def = 300,
})

GameScript:AddConfig("Offset", {
    min = 0,
    max = 200,
    dec = 1,
    def = 0,
})

--[[----------------------------
           Custom Vars
----------------------------]]--

GameScript.TeleportOffset = Vector(0, 0, 50)
GameScript.FullyStarted = false

--[[----------------------------
         Trigger Events
----------------------------]]--

GameScript:AddHook( "PostPlayerDeath", "GetFallDamage" )

function GameScript:OnPlayerChanged(ply, Joined)
    if not self:IsActive() then return end

    local CurrentPlayers = self:GetPlayers(true)

    if #CurrentPlayers == 1 then
        self:SetPlayerWinner( CurrentPlayers[1] )
        self:StopGame()
    end

    -- Is very uncanny to see IsActive after check the game isn't active
    if
        Minigames.Config["PlayMusic"] and
        self:IsActive() and
        #CurrentPlayers <= Minigames.Config["PlayersToFastMusic"]
    then
        self:PlayWorldSound( "sound/" .. Minigames.Config["BackgroundMusicFast"], LOOP_MUSIC )
    end
end


--[[----------------------------
           Game Events
----------------------------]]--

GameScript:AddNewVar("GamePaused", "bool", false)

function GameScript:Pause()
    if not self:IsActive() then return false end

    local State = self:ToggleGamePaused()

    if self.MainTimer then
        self.MainTimer:Pause(State)
    elseif self.BeginTimer then
        self.BeginTimer:Pause(State)
    end

    return true
end


--[[----------------------------
        Plataforms Manager
----------------------------]]--

function GameScript:FirstStage(Amount)
    local Entities = self:GetAllEntities("Floor")
    local RandomEntities = {}

    for i = 1, Amount do
        local ent = table.remove( Entities, math.random(1, #Entities) )
        table.insert( RandomEntities, ent )
    end

    return RandomEntities
end

function GameScript:SecondStage(Entities, State)
    for _, ent in ipairs( Entities ) do
        ent:SetState( State )
    end
end


--[[----------------------------
            Main Game
----------------------------]]--

function GameScript:FullyStartGame()
    local Start = math.max( self.Min, 0 ) + self.Increment

    self.MainTimer = self:CreateChronometer("Main")
    self.MainTimer:SetLoop(true)
    self.MainTimer:SetVariable({["Start"] = Start, Entities = {}})

    self.MainTimer:Wait( self.Delay )
    self.MainTimer:AddAction(function(Var)
        Var["Entities"] = self:FirstStage(Var["Start"])

        self:SecondStage( Var["Entities"], 2 )
    end)

    self.MainTimer:Wait( self.TimeReaction )
    self.MainTimer:AddAction(function(Var)
        self:SecondStage( Var["Entities"], 0 )
    end)

    self.MainTimer:Wait(1.5)
    self.MainTimer:AddAction(function(Var)
        self:SecondStage( self:GetAllEntities("Floor"), 1 )

        Var["Start"] = math.min( Var["Start"] + self.Increment, self.Max )
    end)

    self.MainTimer:Start()

    if Minigames.Config["PlayMusic"] then
        self:PlayWorldSound( "sound/" .. Minigames.Config["BackgroundMusic"], LOOP_MUSIC )
    end

    self.FullyStarted = true

    return true
end

function GameScript:StartGame()
    self:TeleportPlayers(self:GetAllEntities("Floor"))

    self.BeginTimer = self:CreateChronometer("Begin")
    self.BeginTimer:SetLoop(7)
    self.BeginTimer:SetVariable({["Start"] = 0, ["Entities"] = self:GetAllEntities("Floor")})

    self.BeginTimer:AddAction(function(Var)
        if ( Var["Start"] % 2 == 0 ) then
            self:SecondStage( Var["Entities"], 11 )
        else
            self:SecondStage( Var["Entities"], 1 )
        end

        if Var["Start"] == 7 then
            self:FullyStartGame()
        end

        Var["Start"] = Var["Start"] + 1
    end)
    self.BeginTimer:Wait(0.5)
    self.BeginTimer:Start()

    self:PlayGameStartSound()

    return Minigames.GameStart( self )
end

function GameScript:StopGame()
    self:RemoveChronometer("Begin")
    self:RemoveChronometer("Main")

    self:SecondStage( self:GetAllEntities("Floor"), 1 )

    self.FullyStarted = false

    return Minigames.GameStop( self )
end

function GameScript:ToggleGame()
    local Result = false

    self.TimeReaction = self:GetOwnerConfig("TimeReaction")
    self.Increment = self:GetOwnerConfig("Increment")
    self.Delay = self:GetOwnerConfig("Delay")
    self.Min = math.Round( self.TotalSize * self:GetOwnerConfig("Min"), 0 )
    self.Max = math.Round( self.TotalSize * self:GetOwnerConfig("Max"), 0 )

    if self.Min >= self.Max then
        return false
    end

    if self:IsActive() then
        Result = self:StopGame()
    else
        Result = self:StartGame()
    end

    return Result
end


function GameScript:SpawnGame( trace, owner )

    --[[--------------------------------
              Initial Prefabs
    --------------------------------]]--
    local SizeX = self:GetOwnerConfig("SizeX")
    local SizeY = self:GetOwnerConfig("SizeY")
    local Offset = self:GetOwnerConfig("Offset")

    self.TotalSize = SizeX * SizeY

    --[[--------------------------------
              Initial Game Pos
    --------------------------------]]--
    local MiddlePos = trace.HitPos + trace.HitNormal * self:GetOwnerConfig("Height")
    local Pos = MiddlePos + vector_origin
    local PosOffset = Vector(
        math.Round( ( ( Offset + MainOffset ) * ( SizeX - 1 ) ) / 2, 0 ),
        math.Round( ( -( Offset + MainOffset ) * ( SizeY - 1 ) ) / 2, 0 ),
        0
    )
    Pos:Sub( PosOffset )

    local OwnerAng = owner:EyeAngles()
    OwnerAng.p = 0

    -- Size are pairs
    if ( SizeX % 2 == 0 ) then
        MiddlePos.x = MiddlePos.x + ( Offset + MainOffset ) / 2
    end

    if ( SizeY % 2 == 0 ) then
        MiddlePos.y = MiddlePos.y - ( Offset + MainOffset ) / 2
    end

    --[[------------------------
              Plataforms
    ------------------------]]--

    for X = 0, SizeX - 1 do
        local square = self:CreateEntity("minigame_square", "Floor")
        square:SetPos( Pos + Vector( (Offset + MainOffset) * X, 0, 0 ) )
        square:SetState(1)
        square:Spawn()
        square.InitialPosition = square:GetPos()
        square.InitialAngles = square:GetAngles()

        for Y = 1, SizeY - 1 do
            local g_square = self:CreateEntity("minigame_square", "Floor")
            g_square:SetPos( square:GetPos() + Vector(0, -( Offset + MainOffset ) * Y ) )
            g_square:SetState(1)
            g_square:Spawn()
            g_square.InitialPosition = g_square:GetPos()
            g_square.InitialAngles = g_square:GetAngles()
        end
    end

    --[[------------------------
              Kill Box
    ------------------------]]--
    local KillBoxPos = trace.HitPos + trace.HitNormal * ( self:GetOwnerConfig("Height") + 3 ) - KillBoxHeight
    local KillBoxX = ( Offset + MainOffset - 1 ) * SizeX
    local KillBoxY = ( Offset + MainOffset - 1 ) * SizeY
    local KillBoxBounds = Vector( KillBoxX - ( KillBoxX / 2 ), -KillBoxY - ( -KillBoxY / 2 ), 1.5 ) + KillBoxOffset

    self:CreateTrigger(KillBoxPos + KillBoxBounds, KillBoxPos + -KillBoxBounds, Minigames.Enum.KILL_ONTOUCH)
    self:SpawnPlayZone()

    self.DefaultTeleportEntities = self:GetAllEntities("Floor")

    return true
end


--[[----------------------------
           Pre-Render
----------------------------]]--

function GameScript:UpdateBoxGame( trace )
    if Minigames.GetOwnerGame( LocalPlayer() ) then
        hook.Remove("PostDrawTranslucentRenderables", "Minigames.DrawBox")
        return
    end

    local Offset = MainOffset + self:GetOwnerConfig("Offset")
    local SizeX = Offset * ( self:GetOwnerConfig("SizeX") ) - self:GetOwnerConfig("Offset")
    local SizeY = Offset * ( self:GetOwnerConfig("SizeY") ) - self:GetOwnerConfig("Offset")
    local HitPos = trace.HitPos + trace.HitNormal * ( self:GetOwnerConfig("Height") + 3 )

    local Bounds = Vector( SizeX - ( SizeX / 2 ), -SizeY - ( -SizeY / 2 ), 1.5 )
    local KillBox = Bounds + KillBoxOffset

    if trace.Entity:IsPlayer() then
        hook.Remove("PostDrawTranslucentRenderables", "Minigames.DrawBox")
    else
        hook.Add("PostDrawTranslucentRenderables", "Minigames.DrawBox", function()
            render.DrawWireframeBox( HitPos - KillBoxHeight, angle_zero, KillBox, -KillBox, RedColor, true )
            render.DrawWireframeBox( HitPos, angle_zero, Bounds, -Bounds, color_white, true )
        end)
    end
end


--[[----------------------------
            Spawn Game
----------------------------]]--

function GameScript:LeftClick( trace, owner, FirstTime )
    local Response = false

    if FirstTime then
        Response = self:SpawnGame( trace, owner )
    else
        if IsValid( trace.Entity ) and trace.Entity:IsPlayer() then
            Response = self:TogglePlayer( trace.Entity )
        end
    end

    return Response
end


function GameScript:RightClick( trace, owner )
    return self:ToggleGame()
end

function GameScript:Reload( trace, owner )
    if SERVER then
        return self:Pause()
    end
end

function GameScript:Think( trace, owner )
    if CLIENT then
        self:UpdateBoxGame( trace )
    end
end

function GameScript:RollUp( trace, owner )
    if CLIENT then
        hook.Remove("PostDrawTranslucentRenderables", "Minigames.DrawBox")
    end
end

Minigames.RegisterNewGame(GameScript)
--addons/minigame-tool-assistant/lua/minigames/rewards/rewardbase.lua:
--[[--------------------------------------------
             Minigame Reward Module
--------------------------------------------]]--

local REWARDS_REGISTERED = {}
local MAX_ARGUMENTS = 3
local MAX_SIZEUINT = 8


--[[----------------------------
          Reward Object
----------------------------]]--

local REWARD = {}

function REWARD:SetName(Name)
    Minigames.Checker(Name, "string", 1)

    self.Name = Name
end

function REWARD:SetNameAmount(NameAmount)
    Minigames.Checker(NameAmount, "string/function", 1)

    self.NameAmount = NameAmount
end

function REWARD:SetIcon(Icon)
    Minigames.Checker(Icon, "string", 1)

    if not file.Exists("materials/" .. Icon, "GAME") then return end

    self.Icon = Icon
end

function REWARD:SetRewardID(RewardID)
    Minigames.Checker(RewardID, "string", 1)

    self.RewardID = RewardID
end

function REWARD:GetName()
    return self.Name
end

function REWARD:GetNameAmount()
    if isfunction(self.NameAmount) then
        return self.NameAmount( unpack(self.Values) )
    else
        return self.NameAmount
    end
end

function REWARD:GetIcon()
    return self.Icon
end

function REWARD:GetRewardID()
    return self.RewardID
end

function REWARD:SetFunctionReward(Reward)
    Minigames.Checker(Reward, "function", 1)

    self.Reward = Reward
end

function REWARD:AddArgument(Argument)
    Minigames.Checker(Argument, "table", 1)

    --[[ Argument schema:
        @none: {}

        @text: {
            @Default: string,
            @Placeholder: string,
            @Convert: function = nil
        }

        @slider: {
            @Min: number,
            @Max: number,
            @Default: number,
            @Convert: function = nil
        }

        @list: {
            @Options: table[str],
            @Default: any,
            @Convert: function = nil
        }

        @list: {
            @Options: table[str: str],
            @Default: any,
            @Convert: function = nil
        }
    --]]

    if not isstring(Argument["Type"]) then
        Minigames.ThrowError("The type value of REWARD:AddArgument() is not a string", Argument["Type"], "table[Type: string]")
    else
        Argument["Type"] = string.lower(Argument["Type"])
    end

    if Argument["Type"] ~= "none" then

        if Argument["Default"] == nil then
            Argument["Default"] = ""
        end

        if Argument["Convert"] == nil then
            Argument["Convert"] = function(v) return v end
        elseif not isfunction(Argument["Convert"]) then
            Minigames.ThrowError("The function value of REWARD:AddArgument() is not a function", Argument["Convert"], "table[Convert: function]")
        end

    end

    if Argument["Type"] == "slider" then

        if not isnumber(Argument["Min"]) then
            Minigames.ThrowError("The min value of REWARD:AddArgument() is not a number", Argument["Min"], "table[Min: number]")
        end

        if not isnumber(Argument["Max"]) then
            Minigames.ThrowError("The max value of REWARD:AddArgument() is not a number", Argument["Max"], "table[Max: number]")
        end

        if Argument["Min"] > Argument["Max"] then
            Minigames.ThrowError("The min value of REWARD:AddArgument() is greater than the max value", Argument, "Min < Max")
        end

    elseif Argument["Type"] == "list" then
        if not istable(Argument["Options"]) then
            Minigames.ThrowError("The options value of REWARD:AddArgument() is not a table", Argument["Options"], "table[Options: table]")
        end

        local k, v = next(Argument["Options"])
        Argument["IsDictionary"] = isstring(k) and isstring(v)

    elseif Argument["Type"] == "text" then
        if not isstring(Argument["Placeholder"]) then
            Minigames.ThrowError("The placeholder value of REWARD:AddArgument() is not a string", Argument["Placeholder"], "table[Placeholder: string]")
        end

    elseif Argument["Type"] == "none" then
        Argument["Default"] = nil
    else
        Minigames.ThrowError("The first argument value of REWARD:AddArgument() is not allowed", Argument, "table")
    end

    table.insert(self.Arguments, Argument)
end

function REWARD:SetEnabled(Enabled)
    Minigames.Checker(Enabled, "function", 1)

    self.Enabled = Enabled
end

REWARD.__index = REWARD



--[[----------------------------
          Values Reward
----------------------------]]--

local function AddValue(self, Value)
    table.insert(self.Values, Value)
end

local function ClearValues(self)
    self.Values = {}
end

local function AddReward(self)
    if SERVER then return end
    if not Minigames.IsAllowed( LocalPlayer() ) then return end

   net.Start("Minigames.AddReward")
       net.WriteString(self.RewardID)

       net.WriteUInt(#self.Values, MAX_ARGUMENTS)
       for _, Value in ipairs(self.Values) do
           net.WriteType(Value)
       end

    net.SendToServer()
end

local function GiveReward(self, owner, ply)
    if not self.Enabled() then return end

    self.Reward(owner, ply, unpack(self.Values))
end

local function RemoveReward(self)
    if SERVER then return end
    if not Minigames.IsAllowed( LocalPlayer() ) then return end

    net.Start("Minigames.RemoveReward")
        net.WriteUInt(self.Index, MAX_SIZEUINT)
    net.SendToServer()
end



--[[----------------------------
         Reward Creation
----------------------------]]--

function Minigames.CreateNewReward()
    local o = {}
    o.Name = ""
    o.NameAmount = ""
    o.Icon = nil
    o.Arguments = {}
    o.Values = {}
    o.RewardID = ""
    o.Reward = function(owner, ply, ...) end
    o.ModuleIDHash = "76561199171700434"

    return setmetatable(o, REWARD)
end

function Minigames.RegisterReward(Reward)
    Minigames.Checker(Reward, "table", 1)

    if not Reward.Name then
        Minigames.ThrowError("The Name value of Minigames.RegisterReward() is not a string", Reward, "table[Name: string]")
    end

    -- Strip all spaces and special characters and make it lowercase
    Reward.RewardID = string.lower( string.gsub(Reward.Name, "[^%w]", "") )

    if not Reward.NameAmount then
        Minigames.ThrowError("The NameAmount value of Minigames.RegisterReward() is not a string/function", Reward, "table[NameAmount: string/function]")
    end

    if not Reward.RewardID then
        Minigames.ThrowError("The RewardID value of Minigames.RegisterReward() is not a string", Reward, "table[RewardID: string]")
    end

    if Reward.Enabled == nil then
        Reward.Enabled = function() return true end
    end

    local Result = Reward.Enabled()
    if ( Result ~= true ) or ( Result == nil) then
        return
    end

    if #Reward.Arguments == 0 then
        Reward:AddArgument({
            Name = Minigames.StringFormat( Minigames.GetPhrase("reward.onlyone"), Reward.Name ),
            Type = "none"
        })
    end

    Reward.AddValue = AddValue
    Reward.ClearValues = ClearValues
    Reward.AddReward = AddReward
    Reward.GiveReward = GiveReward
    Reward.RemoveReward = RemoveReward

    REWARDS_REGISTERED[Reward.RewardID] = Reward
end


--[[----------------------------
         Rewards Methods
----------------------------]]--

function Minigames.GetReward(RewardID)
    return table.Copy(REWARDS_REGISTERED[ RewardID ])
end

function Minigames.GetRewards()
    return REWARDS_REGISTERED
end

function Minigames.ClearRewards()
    REWARDS_REGISTERED = {}
end
--addons/minigame-tool-assistant/lua/minigames/rewards/darkrp.lua:
local Reward = Minigames.CreateNewReward()

Reward:SetName("DarkRP Money")
Reward:SetNameAmount(function(amount)
    return "$" .. string.Comma( amount )
end)
Reward:SetIcon("icon16/money.png")

Reward:SetFunctionReward(function(owner, ply, amount)
    local money = isnumber( amount ) and math.Round( amount, 0 ) or 0

    owner:ConCommand("darkrp addmoney " .. ply:Nick() .. " " .. money)
end)

Reward:SetEnabled(function()
    return DarkRP and DarkRP.createMoneyBag
end)

Reward:AddArgument({ --> Amount
    ["Name"] = "Money",
    ["Type"] = "Text",
    ["Default"] = 10000,
    ["Placeholder"] = "$10000",
    ["Numeric"] = true
})

Minigames.RegisterReward(Reward)
--addons/minigame-tool-assistant/lua/minigames/rewards/voidcases.lua:
return gluapack()()
--addons/turkish_food_mod-main/lua/autorun/ltrr.lua:
--
--addons/mayor_voting/lua/cl_mayorvoting.lua:
return gluapack()()
--addons/media_player_fixed_edition/lua/autorun/includes/modules/spritesheet.lua:
local surface = surface
local table = table

_G.spritesheet = {}

local icons = {}

--[[
	Icon format example:
	{
		name 	= "example-icon",  -- icon name
		mat 	= Material( "path/spritesheet.png" ), -- material for spritesheet
		w 		= 32, 	-- icon width
		h 		= 32, 	-- icon height
		xoffset = 64, 	-- x-axis offset relative to the texture (optional)
		yoffset = 128 	-- y-axis offset relative to the texture (optional)
	}
]]

local function registerIcon( icon )
	local name = icon.name
	if not name then
		MsgN( "Icon has no name" )
		return false
	end

	local mat = icon.mat
	if not mat or mat:IsError() then
		MsgN( "Icon '" .. name .. "' uses an invalid material '" .. mat:GetName() .. "'" )
		return false
	end

	-- calculate texture UV min/max coordinates
	local mw, mh = mat:Width(), mat:Height()
	local xoffset, yoffset = icon.xoffset or 0, icon.yoffset or 0
	local umin, vmin = xoffset / mw, yoffset / mh
	local umax, vmax = umin + (icon.w / mw), vmin + (icon.h / mh)

	icon.umin = umin
	icon.umax = umax
	icon.vmin = vmin
	icon.vmax = vmax

	-- remove unneeded properties
	icon.xoffset = nil
	icon.yoffset = nil

	return true
end

---
-- Registers a single or list of icons.
--
function spritesheet.Register( iconTbl )
	iconTbl = table.Copy( iconTbl or {} )

	-- passed in single icon; wrap inside table for iteration
	if #iconTbl == 0 then
		iconTbl = { iconTbl }
	end

	-- register all icons
	for _, icon in ipairs(iconTbl) do
		local valid = registerIcon( icon )
		if valid then
			icons[icon.name] = icon
		end
	end

	return true
end

---
-- Gets the icon's width and height
--
function spritesheet.GetIconSize( name )
	local icon = icons[name]
	if not icon then
		MsgN( "Invalid icon '" .. tostring(name) .. "' passed into spritesheet.GetIconSize!" )
		return
	end

	return icon.w, icon.h
end

function spritesheet.DrawIcon( name, x, y, w, h, color )
	local icon = icons[name]
	if not icon then
		MsgN( "Invalid icon '" .. tostring(name) .. "' passed into spritesheet.DrawIcon!" )
		return
	end

	if color then surface.SetDrawColor(color) end
	surface.SetMaterial(icon.mat)
	surface.DrawTexturedRectUV( x, y, w, h,
		icon.umin, icon.vmin, icon.umax, icon.vmax )
end

--addons/media_player_fixed_edition/lua/mediaplayer/players/base/cl_init.lua:
return gluapack()()
--addons/media_player_fixed_edition/lua/mediaplayer/players/base/cl_draw.lua:
return gluapack()()
--addons/media_player_fixed_edition/lua/mediaplayer/players/entity/sh_meta.lua:
return gluapack()()
--addons/media_player_fixed_edition/lua/mediaplayer/sh_services.lua:
MediaPlayer.Services = {}

function MediaPlayer.RegisterService( service )

	local base

	if service.Base then
		base = MediaPlayer.Services[service.Base]
	elseif MediaPlayer.Services.base then
		base = MediaPlayer.Services.base
	end

	-- Inherit base service
	setmetatable( service, { __index = base } )

	-- Create base class for service
	baseclass.Set( "mp_service_" .. service.Id, service )

	-- Store service
	MediaPlayer.Services[ service.Id ] = service

	if MediaPlayer.DEBUG then
		print( "MediaPlayer.RegisterService", service.Name )
	end

end

function MediaPlayer.GetValidServiceNames( whitelist )
	local tbl = {}

	for _, service in pairs(MediaPlayer.Services) do
		if not rawget(service, "Abstract") then
			if whitelist then
				if table.HasValue( whitelist, service.Id ) then
					table.insert( tbl, service.Name )
				end
			else
				table.insert( tbl, service.Name )
			end
		end
	end

	return tbl
end

function MediaPlayer.GetSupportedServiceIDs()
	local tbl = {}

	for _, service in pairs(MediaPlayer.Services) do
		if not rawget(service, "Abstract") then
			table.insert( tbl, service.Id )
		end
	end

	return tbl
end

function MediaPlayer.ValidUrl( url )

	for id, service in pairs(MediaPlayer.Services) do
		if service:Match( url ) then
			return true
		end
	end

	return false

end

function MediaPlayer.GetMediaForUrl( url, webpageFallback )

	local service

	for id, s in pairs(MediaPlayer.Services) do
		if s:Match( url ) then
			service = s
			break
		end
	end

	if not service then
		if webpageFallback then
			service = MediaPlayer.Services.www
		else
			service = MediaPlayer.Services.base
		end
	end

	return service:New( url )

end

-- Load services
do
	local path = "services/"

	local fullpath = "mediaplayer/" .. path

	local services = {
		"base", -- MUST LOAD FIRST!

		-- Browser
		"browser", -- base
		"youtube",
		"twitch",
		"dailymotion",
		"archive",

		-- HTML Resources
		"resource", -- base
		"image",
		"html5_video",
		"webpage",

		-- IGModAudioChannel
		"audiofile",
	}

	for _, name in ipairs(services) do
		local clfile = path .. name .. "/cl_init.lua"
		local svfile = path .. name .. "/init.lua"
		local shfile = fullpath .. name .. ".lua"

		if file.Exists(shfile, "LUA") then
			clfile = shfile
			svfile = shfile
		end

		SERVICE = {}

		if SERVER then
			AddCSLuaFile(clfile)
			include(svfile)
		else
			include(clfile)
		end

		MediaPlayer.RegisterService( SERVICE )
		SERVICE = nil
	end
end

--addons/media_player_fixed_edition/lua/mediaplayer/services/base/cl_init.lua:
return gluapack()()
--addons/media_player_fixed_edition/lua/mediaplayer/services/youtube/cl_init.lua:
return gluapack()()
--addons/media_player_fixed_edition/lua/mediaplayer/services/archive/shared.lua:
DEFINE_BASECLASS( "mp_service_base" )

SERVICE.Name 	= "Internet Archive"
SERVICE.Id 		= "ia"
SERVICE.Base 	= "browser"

function SERVICE:New( url )
	local obj = BaseClass.New(self, url)
	obj._data = obj:GetArchiveVideoId()
	return obj
end

function SERVICE:Match( url )
	return string.find( url, "archive.org" )
end

function SERVICE:GetArchiveVideoId()

	local videoId

	if self.videoId then

		videoId = self.videoId

	elseif self.urlinfo then

		local url = self.urlinfo

		local identifier = url.path:match("^/details/([%w%-%._]+)")
		if identifier then
			local file = ("^/details/%s/([%%w%%-%%.%%/%%+%%&_]+)"):format(identifier)
			file = url.path:match(file)

			self.videoId = ("%s%s"):format(identifier, file and "," .. file or "")
		end

	end

	return videoId

end

--addons/media_player_fixed_edition/lua/mediaplayer/services/image.lua:
SERVICE.Name 	= "Image"
SERVICE.Id 		= "img"
SERVICE.Base 	= "res"

SERVICE.FileExtensions = { "png", "jpg", "jpeg", "gif", "webp", "avif", "apng" }

if CLIENT then

	local EmbedHTML = [[
<div style="background-image: url(%s);
			background-repeat: no-repeat;
			background-size: contain;
			background-position: center center;
			width: 100%%;
			height: 100%%;">
</div>
]]

	function SERVICE:GetHTML()
		return EmbedHTML:format( self.url )
	end

end
--addons/media_player_fixed_edition/lua/mediaplayer/services/html5_video.lua:
SERVICE.Name	= "HTML5 Video"
SERVICE.Id		= "h5v"
SERVICE.Base	= "res"

SERVICE.PrefetchMetadata = true

SERVICE.FileExtensions = {
	"webm",
	"mp4",
}

DEFINE_BASECLASS( "mp_service_base" )

function SERVICE:IsTimed()
	if self._istimed == nil then
		self._istimed = self:Duration() > 0
	end

	return self._istimed
end

if CLIENT then

	local JS_Pause = "if(window.MediaPlayer) MediaPlayer.pause();"
	local JS_Play = "if(window.MediaPlayer) MediaPlayer.play();"
	local JS_Volume = "if(window.MediaPlayer) MediaPlayer.volume = %s;"
	local JS_Seek = [[
		if (window.MediaPlayer) {
			var seekTime = %s;
			var curTime = window.MediaPlayer.currentTime;

			var diffTime = Math.abs(curTime - seekTime);
			if (diffTime > 5) {
				window.MediaPlayer.currentTime = seekTime
			}
		}
	]]

	local MimeTypes = {
		webm = "video/webm",
		mp4 = "video/mp4",
	}

	local EmbedHTML = [[
		<video id="player" autoplay loop style="
				width: 100%%;
				height: 100%%;">
			<source src="%s" type="%s">
		</video>

		<script>
			var checkerInterval = setInterval(function() {
				var player = document.getElementsByTagName("VIDEO")[0]
				if (!!player) {
					if (player.paused) {player.play();}
					if (player.paused === false && player.readyState === 4) {
						clearInterval(checkerInterval);

						window.MediaPlayer = player;
						player.style = "width:100%%; height: 100%%;";
					}
				}
			}, 50);
		</script>
	]]

	function SERVICE:GetHTML()
		local url = self.url

		local path = self.urlinfo.path
		local ext = path:match("[^/]+%.(%S+)$")

		local mime = MimeTypes[ext]

		return EmbedHTML:format(url, mime)
	end

	function SERVICE:Pause()
		BaseClass.Pause( self )

		if IsValid(self.Browser) then
			self.Browser:RunJavascript(JS_Pause)
		end

	end

	function SERVICE:SetVolume( volume )
		local js = JS_Volume:format( MediaPlayer.Volume() )
		self.Browser:RunJavascript(js)
	end

	function SERVICE:Sync()

		local seekTime = self:CurrentTime()
		if self:IsTimed() and seekTime > 0 then
			self.Browser:RunJavascript(JS_Seek:format(seekTime))
		end
	end

	function SERVICE:IsMouseInputEnabled()
		return IsValid( self.Browser )
	end

	function SERVICE:PreRequest( callback )
		MediaPlayerUtils.GatherVideoDuration( self.url, function(success, response)

			if success then
				self._metaDuration = response
				callback()

				return
			end

			callback(response)
		end )
	end

	function SERVICE:NetWriteRequest()
		net.WriteUInt( self._metaDuration, 16 )
	end

end

if SERVER then
	function SERVICE:GetMetadata( callback )

		if self._metadata then
			callback( self._metadata )
			return
		end

		local cache = MediaPlayer.Metadata:Query(self)

		if MediaPlayer.DEBUG then
			print("MediaPlayer.GetMetadata Cache results:")
			PrintTable(cache or {})
		end

		if cache then

			local metadata = {}
			metadata.title = cache.title
			metadata.duration = tonumber(cache.duration)
			metadata.thumbnail = cache.thumbnail

			self:SetMetadata(metadata)
			MediaPlayer.Metadata:Save(self)

			callback(self._metadata)

		else
			local metadata = {}

			metadata.title = self.url
			metadata.duration = self._metaDuration

			self:SetMetadata(metadata, true)
			MediaPlayer.Metadata:Save(self)

			callback(self._metadata)
		end
	end

	function SERVICE:NetReadRequest()

		if not self.PrefetchMetadata then return end

		self._metaDuration = net.ReadUInt( 16 )

	end
end
--addons/media_player_fixed_edition/lua/autorun/menubar/mp_options.lua:
hook.Add( "PopulateMenuBar", "MediaPlayerOptions_MenuBar", function( menubar )

	local m = menubar:AddOrGetMenu( "▶  Media Player" )

	m:AddCVar( "Fullscreen", "mediaplayer_fullscreen", "1", "0" )

	m:AddSpacer()

	m:AddOption( "Turn Off All", function()
		for _, mp in ipairs(MediaPlayer.GetAll()) do
			MediaPlayer.RequestListen( mp )
		end

		MediaPlayer.HideSidebar()
	end )

end )

--addons/media_player_fixed_edition/lua/mp_menu/cl_init.lua:
return gluapack()()
--addons/media_player_fixed_edition/lua/mp_menu/playback.lua:
return gluapack()()
--addons/media_player_fixed_edition/lua/mp_menu/playback.lua:
local math = math
local ceil = math.ceil
local clamp = math.Clamp

local surface = surface
local color_white = color_white

local PANEL = {}

PANEL.Height = 72

-- ONYX Hud benzeri renkler
PANEL.BgColor = Color(20, 22, 30, 230) -- Daha koyu, şık arka plan
PANEL.AccentColor = Color(65, 105, 225) -- Mavi vurgu rengi
PANEL.Padding = 12
PANEL.BtnSpacing = 4

PANEL.SeekbarHeight = 8

PANEL.TitleMaxWidth = 335

PANEL.KnobSize = 8
PANEL.BorderRadius = 6 -- Köşe yuvarlatma değeri

function PANEL:Init()

	self.PlayPauseBtn = vgui.Create( "MP.PlayPauseButton", self )

	self.MediaTitle = vgui.Create( "MP.MediaTitle", self )
	self.MediaTitle:SetText( "Herkesin Nefret Ettiği Çok Kötü Video İçerildi" )

	self.MediaTime = vgui.Create( "MP.MediaTime", self )
	self.MediaTime:SetShowCurrentTime( true )
	self.MediaTime:SetListenForSeekEvents( true )

	self.BtnList = vgui.Create( "DHorizontalList", self )
	self.BtnList:SetSpacing( self.BtnSpacing )

	self.FavBtn = vgui.Create( "MP.FavoriteButton", self )

	hook.Run( MP.EVENTS.UI.SETUP_PLAYBACK_PANEL, self )

	if hook.Run( MP.EVENTS.UI.PRIVILEGED_PLAYER ) then
		self.SkipBtn = vgui.Create( "MP.SkipButton" )
		self:AddButton( self.SkipBtn )
	end

	self.AddedByLbl = vgui.Create( "MP.AddedBy", self )

	self.Seekbar = vgui.Create( "MP.Seekbar", self )

	self.NextThink = 0

end

function PANEL:AddButton( panel )
	self.BtnList:AddItem( panel )
end

function PANEL:Think()

	local rt = RealTime()

	if rt > self.NextThink then
		-- Perform layout every second for when the media label changes width
		self:InvalidateLayout()
		self.NextThink = rt + 1
	end

end

function PANEL:OnMediaChanged( media )

	self._Media = media

	if media then
		local title = media:Title()
		self.MediaTitle:SetText( title )
		self.MediaTitle:SetTooltip( title )

		self.AddedByLbl:SetPlayer( media:GetOwner(), media:OwnerName(), media:OwnerSteamID() )

		self.AddedByLbl:Show()
		self.FavBtn:Hide()
		self.BtnList:Show()
	else
		self.MediaTitle:SetText( "Bir Medya Oynatılmıyor" )
		self.MediaTitle:SetTooltip( "" )

		self.AddedByLbl:Hide()
		self.FavBtn:Hide()
		self.BtnList:Hide()
	end

	if media and media:IsTimed() then
		self.MediaTime:SetMedia( media )

		self.Seekbar:SetMedia( media )
		self.Seekbar:Show()
	else
		self.MediaTime:SetMedia( nil )
		self.MediaTime:Hide()

		self.Seekbar:SetMedia( nil )
		self.Seekbar:Hide()
	end

	-- apply media for all buttons
	for _, btn in pairs( self.BtnList:GetItems() ) do
		if IsValid(btn) and isfunction(btn.SetMedia) then
			btn:SetMedia( media )
		end
	end

	self:InvalidateLayout()

end

function PANEL:OnPlayerStateChanged( playerState )

	self.PlayPauseBtn:SetPlayerState( playerState )

end

function PANEL:Paint( w, h )
    -- ONYX Hud benzeri modern tasarım
    draw.RoundedBox(self.BorderRadius, 0, 0, w, h - self.SeekbarHeight / 2, self.BgColor)
    
    -- Üst kısım için gradient efekti
    surface.SetDrawColor(self.AccentColor.r, self.AccentColor.g, self.AccentColor.b, 40)
    surface.DrawRect(0, 0, w, 3)
    
    -- Kenar vurgusu
    surface.SetDrawColor(self.AccentColor)
    surface.DrawRect(0, 0, w, 2)
end

function PANEL:PerformLayout()

	local w, h = self:GetSize()

	self:SetTall( self.Height )

	self.PlayPauseBtn:CenterVertical()
	self.PlayPauseBtn:AlignLeft( self.Padding )

	self.MediaTitle:SizeToContents()
	self.MediaTitle:MoveRightOf( self.PlayPauseBtn, self.Padding )

	if self._Media then
		self.MediaTitle:AlignTop( self.Padding )
	else
		self.MediaTitle:CenterVertical()
	end

	self.MediaTime:InvalidateLayout()
	self.MediaTime:MoveRightOf( self.PlayPauseBtn, self.Padding )
	self.MediaTime:AlignBottom( self.Padding - 2 )

	self.FavBtn:AlignTop( self.Padding )
	self.FavBtn:AlignRight( self.Padding )

	self.BtnList:InvalidateLayout(true)
	self.BtnList:AlignBottom( self.Padding )
	self.BtnList:AlignRight( self.Padding )

	-- 'ADDED BY Name' needs to fit between the media time and the rightmost
	-- buttons.
	local addedByMaxWidth = ( self.BtnList:GetPos() - self.BtnSpacing ) -
		( self.MediaTime:GetPos() + self.MediaTime:GetWide() + self.Padding )

	self.AddedByLbl:SetMaxWidth( addedByMaxWidth )
	self.AddedByLbl:AlignBottom( self.Padding )
	self.AddedByLbl:MoveLeftOf( self.BtnList, self.BtnSpacing )

	local maxTitleWidth = ( self.FavBtn:GetPos() - self.BtnSpacing ) -
		( self.MediaTitle:GetPos() )

	if self.MediaTitle:GetWide() > maxTitleWidth then
		self.MediaTitle:SetWide( maxTitleWidth )
	end

	self.Seekbar:SetSize( w, self.SeekbarHeight )
	self.Seekbar:SetPos( 0, h - self.SeekbarHeight )

	self:SetTall( self.Height + self.SeekbarHeight / 2 )

end

derma.DefineControl( "MP.Playback", "", PANEL, "Panel" )


local PLAYPAUSE_BTN = {
    StateIcons = {
        [1] = nil, -- MP_STATE_ENDED
        [2] = "mp-pause", -- MP_STATE_PLAYING
        [3] = "mp-play" -- MP_STATE_PAUSED
    }
}

function PLAYPAUSE_BTN:Init()
    self.BaseClass.Init( self )

    self:SetSize( 24, 27 ) -- Biraz daha büyük butonlar
    self:SetHighlighted( true )
end

function PLAYPAUSE_BTN:SetPlayerState( playerState )

	self.PlayerState = playerState

	playerState = (playerState or 0) + 1 -- Lua can't index 0

	local icon = self.StateIcons[ playerState ]

	if icon then
		self:SetIcon( icon )
		self:SetIconVisible(true)
	else
		self:SetIconVisible(false)
	end

	-- Set cursor type depending on whether player is admin/owner
	if hook.Run( MP.EVENTS.UI.PRIVILEGED_PLAYER ) then
		self:SetCursor( "hand" )
	else
		self:SetCursor( "arrow" )
	end

end

function PLAYPAUSE_BTN:DoClick()

	hook.Run( MP.EVENTS.UI.TOGGLE_PAUSE )

end

-- Butonlar için modern görünüm
function PLAYPAUSE_BTN:Paint(w, h)
    local col = self:IsHovered() and Color(65, 105, 225) or Color(45, 85, 205)
    draw.RoundedBox(4, 0, 0, w, h, col)
    return true
end

derma.DefineControl( "MP.PlayPauseButton", "", PLAYPAUSE_BTN, "MP.SidebarButton" )


local SEEKBAR = {}

SEEKBAR.KnobSize = 10 -- Biraz daha büyük kaydırıcı topuzu
SEEKBAR.BarHeight = 3 -- Biraz daha kalın çubuk

-- ONYX Hud benzeri renkler
SEEKBAR.ProgressColor = Color(65, 105, 225) -- Accent color
SEEKBAR.BackgroundColor = Color(40, 42, 50, 120) -- İlerleme çubuğu arka planı

AccessorFunc( SEEKBAR, "m_Media", "Media" )

function SEEKBAR:Init()

	self.BaseClass.Init( self )

	self.Knob:SetSize( self.KnobSize, self.KnobSize )
	self.Knob.Paint = self.PaintKnob

	self.Knob.OnMousePressed = function( panel, mousecode )
			self:OnStartEditing( self )
			DButton.OnMousePressed( panel, mousecode )
		end
	self.Knob.OnMouseReleased = function( panel, mousecode )
			self:OnStopEditing( self )
			DButton.OnMouseReleased( panel, mousecode )
		end

	-- Remove some hidden panel child from the inherited DSlider control; I have
	-- no idea where it's being created...
	for _, child in pairs( self:GetChildren() ) do
		if child ~= self.Knob then
			child:Remove()
		end
	end

end

function SEEKBAR:OnStartEditing()

	-- only allow admins/owners to control seeking
	if not hook.Run( MP.EVENTS.UI.PRIVILEGED_PLAYER ) then return end

	hook.Run( MP.EVENTS.UI.START_SEEKING, self )

end

function SEEKBAR:OnStopEditing()

	-- only allow admins/owners to control seeking
	if not hook.Run( MP.EVENTS.UI.PRIVILEGED_PLAYER ) then return end

	hook.Run( MP.EVENTS.UI.STOP_SEEKING, self )

	if self.m_Media then
		local seekTime = ceil(self.m_fSlideX * self.m_Media:Duration())
		hook.Run( MP.EVENTS.UI.SEEK, seekTime )
	end

end

function SEEKBAR:OnMousePressed( mcode )
	self:OnStartEditing()
	self.BaseClass.OnMousePressed( self, mcode )
end

function SEEKBAR:OnMouseReleased( mcode )
	self:OnStopEditing()
	self.BaseClass.OnMouseReleased( self, mcode )
end

function SEEKBAR:Think()

	local media = self.m_Media

	if media and not self:IsEditing() then
		local progress = media:CurrentTime() / media:Duration()
		progress = clamp(progress, 0, 1)

		self:SetSlideX( progress )
		self:InvalidateLayout()
	end

end

function SEEKBAR:Paint( w, h )
    local midy = ceil( h / 2 )
    local bary = ceil(midy - (self.BarHeight / 2))
    local progress = self:GetSlideX()
    
    -- Arka plan çubuğu (boş kısım)
    draw.RoundedBox(2, 0, bary, w, self.BarHeight, self.BackgroundColor)
    
    -- İlerleme çubuğu
    draw.RoundedBox(2, 0, bary, ceil(w * progress), self.BarHeight, self.ProgressColor)
    
    -- Parlaklık efekti
    surface.SetDrawColor(255, 255, 255, 15)
    surface.DrawRect(0, bary, ceil(w * progress), self.BarHeight / 2)
end

function SEEKBAR:PaintKnob( w, h )
    -- Modern yuvarlak topuz
    local whiteColor = Color(255, 255, 255, 255)
    local progressColor = self.ProgressColor or Color(65, 105, 225)
    
    -- Dış kısım (beyaz halka)
    draw.RoundedBox(h/2, 0, 0, w, h, whiteColor)
    -- İç kısım (mavi dolgu)
    draw.RoundedBox(h/2-2, 2, 2, w-4, h-4, progressColor)
end

derma.DefineControl( "MP.Seekbar", "", SEEKBAR, "DSlider" )

--addons/onyx_framework_2/lua/onyx/framework/libs/thirdparty/data/utf8_chunk_1.lua:
return gluapack()()
--addons/onyx_framework_2/lua/onyx/ui/libs/cl_gui.lua:
--[[

Author: tochnonement
Email: tochnonement@gmail.com

15/04/2022

--]]

onyx.gui = {}
onyx.gui.funcs = {}

local gui = onyx.gui

function gui.Register(name, metatable, parent)
    gui.Extend(metatable)
    vgui.Register(name, metatable, parent)
end

function gui.Extend(obj)
    for name, fn in pairs(onyx.gui.funcs) do
        obj[name] = fn
    end
end

function gui.RegisterFunc(name, fn)
    onyx.gui.funcs[name] = fn
end

-- Events

function gui.AddEvent(panel, name, fn)
    panel.onyxEvents = panel.onyxEvents or {}
    panel.onyxEvents[name] = panel.onyxEvents[name] or {
        count = 0
    }

    local storage = panel.onyxEvents[name]
    local index = storage.count + 1

    storage.count = index
    storage[index] = fn

    return index
end

function gui.RemoveEvent(panel, name, index)
    if (not panel.onyxEvents) then return false end

    local cache = panel.onyxEvents[name]
    if (not cache) then return false end

    local func = cache[index]
    if (not func) then return false end

    cache[index] = nil

    return true
end

function gui.CallEvent(panel, name, ignoreRaw, ...)
    local events = panel.onyxEvents or {}

    if not ignoreRaw and panel[name] then
        local val = panel[name](panel, ...)
        if val then
            return val
        end
    end

    local storage = events[name]
    if storage then
        for i = 1, storage.count do
            local fn = storage[i]
            if fn then
                local val = fn(panel, ...)
                if val then
                    return val
                end
            end
        end
    end
end

function gui.InjectEventHandler(panel, fnName)
    panel.onyxEventHandlers = panel.onyxEventHandlers or {}

    if panel.onyxEventHandlers[fnName] then
        return false
    end

    local oldFn = panel[fnName]

    panel[fnName] = function(self, a1, a2, a3, a4, a5, a6)
        if oldFn then
            oldFn(self, a1, a2, a3, a4, a5, a6)
        end

        -- call all events except the old function
        gui.CallEvent(self, fnName, true, a1, a2, a3, a4, a5, a6)
    end

    panel.onyxEventHandlers[fnName] = true

    return true
end

function gui.HasEventHandler(panel, fnName)
    if panel.onyxEventHandlers then
        return panel.onyxEventHandlers[fnName]
    end
end

function gui.Test(class, w, h, fn)
    if IsValid(gui.oldDebugPanel) then
        gui.oldDebugPanel:Remove()
    end

    local pnl = vgui.Create(class)
    if IsValid(pnl) then
        pnl:SetSize(ScrW() * w, ScrH() * h)
        pnl:Center()
        fn(pnl, pnl:GetWide(), pnl:GetTall())
    end
    gui.oldDebugPanel = pnl
end

gui.Register('onyx.Panel', {Init = function() end})
--addons/onyx_framework_2/lua/onyx/ui/elements/cl_category.lua:
return gluapack()()
--addons/onyx_framework_2/lua/onyx/ui/elements/cl_checkbox.lua:
return gluapack()()
--addons/onyx_framework_2/lua/onyx/ui/elements/cl_label.lua:
--[[

Author: tochnonement
Email: tochnonement@gmail.com

05/06/2022

--]]

local PANEL = {}

local fontCommon = onyx.Font('Comfortaa@16')
local colorCommon = Color(235, 235, 235)

function PANEL:Init()
    self:SetTextColor(colorCommon)
    self:SetFont(fontCommon)
end

function PANEL:CenterText()
    self:SetContentAlignment(5)
end

-- Trying to save my time....

function PANEL:Font(...)
    self:SetFont(onyx.Font(...))
end

function PANEL:Color(r, g, b, a)
    if isnumber(r) then
        self:SetTextColor(Color(r, g, b, a))
    else
        self:SetTextColor(r)
    end
end

function PANEL:Shadow(distance, color)
    distance = distance or 1
    color = color and (isnumber(color) and Color(0, 0, 0, color) or color) or Color(0, 0, 0, 100)

    self:SetExpensiveShadow(distance, color)
end

function PANEL:AlignText(a)
    self:SetContentAlignment(a)
end

function PANEL:GetContentWidth()
    surface.SetFont(self:GetFont())
    return select(1, surface.GetTextSize(self:GetText()))
end

onyx.gui.Register('onyx.Label', PANEL, 'DLabel')
--addons/onyx_f4/lua/onyx/modules/f4/sh_init.lua:
return gluapack()()
--addons/onyx_f4/lua/onyx/modules/f4/cfg/cl_tabs.lua:
return gluapack()()
--addons/bb_onyx_hud/lua/onyx/modules/hud/sh_init.lua:
return gluapack()()
--addons/bb_onyx_hud/lua/onyx/modules/hud/languages/cl_german.lua:
--[[

Editor: thestarhd
Dutscher Übersetzer Profil: https://www.gmodstore.com/users/thestarhd
 
05/09/2024
 
--]]
 
local LANG = {}
 
--[[
    .............
    Allgemeine Wörter
]]--
 
LANG[ 'hud_status_wanted' ] = 'Gesucht'
LANG[ 'hud_status_speaking' ] = 'Spricht'
LANG[ 'hud_status_typing' ] = 'Schreibt'
LANG[ 'props' ] = 'Gegenstände'
LANG[ 'close' ] = 'Schließen'
LANG[ 'alert' ] = 'Alarm'
LANG[ 'message' ] = 'Nachricht'
LANG[ 'unknown' ] = 'Unbekannt'
LANG[ 'accept' ] = 'Akzeptieren'
LANG[ 'deny' ] = 'Ablehnen'
LANG[ 'none' ] = 'Keine'
LANG[ 'add' ] = 'Hinzufügen'
LANG[ 'remove' ] = 'Entfernen'
LANG[ 'jobs' ] = 'Jobs'
LANG[ 'door' ] = 'Tür'
LANG[ 'vehicle' ] = 'Fahrzeug'
LANG[ 'door_groups' ] = 'Türgruppen'
LANG[ 'display' ] = 'Anzeigen'
LANG[ 'general' ] = 'Allgemein'
LANG[ 'speedometer' ] = 'Tachometer'
LANG[ 'fuel' ] = 'Benzin'
LANG[ 'vote' ] = 'Abstimmen'
LANG[ 'question' ] = 'Frage'
 
--[[
    .......
    Verbindungsabbruch
]]--
 
LANG[ 'timeout_title' ] = 'VERBINDUNG VERLOREN'
LANG[ 'timeout_info' ] = 'Server ist derzeit nicht verfügbar, wir entschuldigen uns'
LANG[ 'timeout_status' ] = 'Du wirst in %d Sekunden erneut verbunden'
 
--[[
    ......
    Themen
]]--
 
LANG[ 'hud.theme.default.name' ] = 'Standard'
LANG[ 'hud.theme.forest.name' ] = 'Wald'
LANG[ 'hud.theme.violet_night.name' ] = 'Violette Nacht'
LANG[ 'hud.theme.rustic_ember.name' ] = 'Rustikale Glut'
LANG[ 'hud.theme.green_apple.name' ] = 'Grüner Apfel'
LANG[ 'hud.theme.lavender.name' ] = 'Lavendel'
LANG[ 'hud.theme.elegance.name' ] = 'Eleganz'
LANG[ 'hud.theme.mint_light.name' ] = 'Minze'
LANG[ 'hud.theme.gray.name' ] = 'Grau'
LANG[ 'hud.theme.rose_garden.name' ] = 'Rosengarten'
LANG[ 'hud.theme.ocean_wave.name' ] = 'Ozeanwelle'
LANG[ 'hud.theme.sky_blue.name' ] = 'Himmelblau'
LANG[ 'hud.theme.golden_dawn.name' ] = 'Goldene Dämmerung'
 
--[[
    ....
    Hilfe
    - Ganzer Satz: "Gebe <command> ein, um die Einstellungen zu öffnen"
]]--
 
LANG[ 'hud_help_type' ] = 'Gebe ein'
LANG[ 'hud_help_to' ] = 'um die Einstellungen zu öffnen'
 
--[[
    .............
    3D2D Türen
]]--
 
LANG[ 'door_purchase' ] = 'Kaufe {object}'
LANG[ 'door_sell' ] = 'Verkaufe {object}'
LANG[ 'door_addowner' ] = 'Eigentümer hinzufügen'
LANG[ 'door_rmowner' ] = 'Eigentümer entfernen'
LANG[ 'door_rmowner_help' ] = 'Wähle den Spieler, dem du das Eigentum entziehen möchtest'
LANG[ 'door_addowner_help' ] = 'Wähle den Spieler, dem du das Eigentum gewähren möchtest'
LANG[ 'door_title' ] = 'Titel festlegen'
LANG[ 'door_title_help' ] = 'Welchen Titel möchtest du festlegen?'
LANG[ 'door_admin_disallow' ] = 'Kaufen verbieten'
LANG[ 'door_admin_allow' ] = 'Kaufen erlauben'
LANG[ 'door_admin_edit' ] = 'Zugriff bearbeiten'
LANG[ 'door_owned' ] = 'Privatbesitz'
LANG[ 'door_unowned' ] = 'Zu Verkaufen'
 
LANG[ 'hud_door_help' ] = 'Drücke {bind}, um für {price} zu kaufen'
LANG[ 'hud_door_owner' ] = 'Eigentümer: {name}'
LANG[ 'hud_door_allowed' ] = 'Eigentümer erlaubt'
LANG[ 'hud_door_coowners' ] = 'Miteigentümer'
LANG[ 'hud_and_more' ] = 'und mehr...'
 
--[[
    .........
    Großbuchstaben
]]--
 
LANG[ 'reconnect_u' ] = 'ERNEUT VERBINDEN'
LANG[ 'disconnect_u' ] = 'TRENNEN'
LANG[ 'settings_u' ] = 'EINSTELLUNGEN'
LANG[ 'configuration_u' ] = 'KONFIGURATION'
LANG[ 'introduction_u' ] = 'EINFÜHRUNG'
 
--[[
    .........
    Kleinbuchstaben
]]--
 
LANG[ 'seconds_l' ] = 'sekunden'
LANG[ 'minutes_l' ] = 'minuten'
 
--[[
    .............
    Konfiguration
]]--
 
LANG[ 'hud.timeout.name' ] = 'Timeout-Dauer'
LANG[ 'hud.timeout.desc' ] = 'Wie viele Sekunden bis zur automatischen Wiederverbindung'
 
LANG[ 'hud.alert_queue.name' ] = 'Alarm-Warteschlange'
LANG[ 'hud.alert_queue.desc' ] = 'Sollen Alarme in die Warteschlange gestellt werden'
 
LANG[ 'hud.props_counter.name' ] = 'Gegenstandzähler'
LANG[ 'hud.props_counter.desc' ] = 'Gegenstandzähler anzeigen'
 
LANG[ 'hud.main_avatar_mode.name' ] = 'Haupt-Avatar-Typ'
LANG[ 'hud.main_avatar_mode.desc' ] = 'Wähle den Typ'
 
LANG[ 'hud.voice_avatar_mode.name' ] = 'Stimm-Avatar-Typ'
LANG[ 'hud.voice_avatar_mode.desc' ] = 'Wähle den Typ'
 
LANG[ 'hud.restrict_themes.name' ] = 'Themen einschränken'
LANG[ 'hud.restrict_themes.desc' ] = 'Spielern die Themenwahl einschränken'
 
LANG[ 'hud.speedometer_mph.name' ] = 'Meilen verwenden'
LANG[ 'hud.speedometer_mph.desc' ] = 'Einheiten auf Meilen pro Stunde umstellen'
 
LANG[ 'hud.speedometer_max_speed.name' ] = 'Maximale Standardgeschwindigkeit'
LANG[ 'hud.speedometer_max_speed.desc' ] = 'Die maximale Geschwindigkeit für den Tacho'
 
LANG[ 'hud_should_draw' ] = 'Soll das Element gezeichnet werden'
LANG[ 'hud.main.name' ] = 'Haupt-HUD'
LANG[ 'hud.ammo.name' ] = 'Munition'
LANG[ 'hud.agenda.name' ] = 'Agenda'
LANG[ 'hud.alerts.name' ] = 'Alarme'
LANG[ 'hud.pickup_history.name' ] = 'Aufnahmeverlauf'
LANG[ 'hud.level.name' ] = 'Level'
LANG[ 'hud.voice.name' ] = 'Stimm-Panels'
LANG[ 'hud.overhead_health.name' ] = '3D2D Überkopfanzeige für Gesundheit'
LANG[ 'hud.overhead_armor.name' ] = '3D2D Überkopfanzeige für Rüstung'
LANG[ 'hud.vehicle.name' ] = 'Fahrzeug-HUD'
 
--[[
    ........
    Einstellungen
]]--
 
LANG[ 'hud.theme.name' ] = 'Thema'
LANG[ 'hud.theme.desc' ] = 'Wähle das HUD-Thema'
 
LANG[ 'hud.scale.name' ] = 'Skalierung'
LANG[ 'hud.scale.desc' ] = 'Skalierung des HUD anpassen'
 
LANG[ 'hud.roundness.name' ] = 'Rundheit'
LANG[ 'hud.roundness.desc' ] = 'Die Rundheit des HUD anpassen'
 
LANG[ 'hud.margin.name' ] = 'Rand'
LANG[ 'hud.margin.desc' ] = 'Abstand zwischen HUD und den Rändern'
 
LANG[ 'hud.icons_3d.name' ] = '3D-Modelle'
LANG[ 'hud.icons_3d.desc' ] = 'Modell-Icons in 3D rendern'
 
LANG[ 'hud.compact.name' ] = 'Kompaktmodus'
LANG[ 'hud.compact.desc' ] = 'Kompaktmodus aktivieren'
 
LANG[ 'hud.speedometer_blur.name' ] = 'Tacho Unschärfe'
LANG[ 'hud.speedometer_blur.desc' ] = 'Unschärfe für den Tacho aktivieren'
 
LANG[ 'hud.3d2d_max_details.name' ] = 'Maximale 3D2D-Details'
LANG[ 'hud.3d2d_max_details.desc' ] = 'Maximale Menge an detaillierten Informationen rendern'
 
--[[
    ......
    Status
]]--
 
LANG[ 'hud_lockdown' ] = 'LOCKDOWN'
LANG[ 'hud_lockdown_help' ] = 'Bitte kehre in dein Haus zurück!'
 
LANG[ 'hud_wanted' ] = 'GESUCHT'
LANG[ 'hud_wanted_help' ] = 'Grund: {reason}'
 
LANG[ 'hud_arrested' ] = 'VERHAFTET'
LANG[ 'hud_arrested_help' ] = 'Du wirst in {time} freigelassen'
 
onyx.lang:AddPhrases( 'german', LANG )
--addons/bb_onyx_hud/lua/onyx/modules/hud/elements/cl_door_info.lua:
--[[

Author: tochnonement
Email: tochnonement@gmail.com

16/08/2024

--]]

local RANGE = 400
local FONT_NAME = onyx.hud.CreateFont3D2D( 'DoorName', 'Comfortaa SemiBold', 60 )
local FONT_SMALL_NAME = onyx.hud.CreateFont3D2D( 'DoorSmallName', 'Comfortaa SemiBold', 40 )
local FONT_HELP = onyx.hud.CreateFont3D2D( 'DoorHelp', 'Comfortaa', 32 )
local COLOR_GRAY = Color( 200, 200, 200 )
local COLOR_GREEN = Color( 147, 255, 108)
local COLOR_RED = Color( 255, 87, 87)
local L = function( ... ) return onyx.lang:Get( ... ) end

local nearest = {}
local traceOut = {}
local traceIn = { output = traceOut, mask = MASK_SHOT }

local bindKey = ''

-- To get a nice string containing players' name from DarkRP
local function getPlayersStr( players, maxNames )
    local maxNames = maxNames or 2
    local result = {}
    local added = 0
    local limitExceeded = false

    for playerIndex in pairs( players ) do
        local ply = Player( playerIndex )
        if ( IsValid( ply ) ) then
            added = added + 1
            if ( added > maxNames ) then
                limitExceeded = true
                break
            end

            result[ added ] = ply:Name()
        end
    end

    local finalStr = table.concat( result, ', ' )

    if ( limitExceeded ) then
        finalStr = finalStr .. ', ...'
    end

    return finalStr 
end

local function drawInfo( ent, client )
    local screenPos = ent:LocalToWorld( ent:OBBCenter() ) + Vector( 0, 0, 16 )
    
    -- I wish I could put this in a timer, but it would look bad when the door is moving
    traceIn.start = client:GetShootPos()
    traceIn.endpos = screenPos
    traceIn.filter = client
    util.TraceLine( traceIn )

    if ( traceOut.Entity ~= ent ) then return end

    local hitPos = traceOut.HitPos
    local hitNormal = traceOut.HitNormal
    local length = ( hitPos - screenPos ):Length2D()

    if ( length > 6 ) then return end

    local renderPos = hitPos + hitNormal
    local renderAng = hitNormal:Angle() + Angle( 0, 90, 90 )

    local doorTeams = ent:getKeysDoorTeams()
    local doorGroup = ent:getKeysDoorGroup()
    local doorCoowners = ent:getKeysCoOwners() or {}
    local doorPrice = GAMEMODE.Config.doorcost ~= 0 and GAMEMODE.Config.doorcost or 30
    local playerOwned = ent:isKeysOwned() or table.GetFirstValue( doorCoowners ) ~= nil
    local isOwned = playerOwned or doorGroup or doorTeams
    local allowedCoOwn = ent:getKeysAllowedToOwn()

    local title = ''
    local subtitle = ''
    local color = color_white
    local titleFont = FONT_NAME

    if ( isOwned ) then
        local doorOwner = ent:getDoorOwner()
        local ownedByClient = playerOwned and ( doorOwner == client or doorCoowners[ client:UserID() ] )
    
        title = ent:getKeysTitle()

        if ( not title ) then
            if ( playerOwned ) then
                title = L( 'door_owned' )
                color = ownedByClient and COLOR_GREEN or COLOR_RED
            else
                if ( doorGroup ) then
                    title = doorGroup
                    titleFont = FONT_SMALL_NAME
                else
                    title = L( 'door_owned' )
                end
    
                if ( doorTeams ) then
                    for teamIndex in pairs( doorTeams ) do
                        subtitle = subtitle .. team.GetName( teamIndex ) .. '\n'
                    end
                end
            end
        elseif ( not playerOwned ) then
            if ( doorGroup ) then
                subtitle = doorGroup
            elseif ( doorTeams ) then
                for teamIndex in pairs( doorTeams ) do
                    subtitle = subtitle .. team.GetName( teamIndex ) .. '\n'
                end
            end
        end

        if ( playerOwned ) then
            subtitle = L( 'hud_door_owner', { name = IsValid( doorOwner ) and doorOwner:Name() or '' } )

            if ( not table.IsEmpty( doorCoowners ) ) then
                subtitle = subtitle .. Format( '\n%s: %s', L( 'hud_door_coowners' ), getPlayersStr( doorCoowners ) )
            end

            if ( allowedCoOwn and not table.IsEmpty( allowedCoOwn ) ) then
                subtitle = subtitle .. Format( '\n%s: %s', L( 'hud_door_allowed' ), getPlayersStr( allowedCoOwn ) )
            end
        end
    else
        title = L( 'door_unowned' )
        subtitle = L( 'hud_door_help', { bind = bindKey, price = DarkRP.formatMoney( doorPrice ) } )
    end

    cam.Start3D2D( renderPos, renderAng, .085 )

        onyx.hud.DrawShadowText( title, titleFont, 0, 0, color, 1, 0 )
        draw.DrawText( subtitle, FONT_HELP .. '.Blur', 2, 60 + 2, color_black, 1 )
        draw.DrawText( subtitle, FONT_HELP, 0, 60, COLOR_GRAY, 1 )

    cam.End3D2D()
end

do
    local DOORS = {
        [ 'prop_door_rotating' ] = true,
        [ 'func_door_rotating' ] = true,
        [ 'func_door' ] = true,
    }
    timer.Create( 'onyx.hud.CatchNearestDoors', 1 / 5, 0, function()
        local client = LocalPlayer()
        if ( IsValid( client ) ) then
            local entities = ents.FindInCone( client:GetShootPos(), client:GetAimVector(), RANGE, math.cos( math.rad( 45 ) ) )
    
            nearest = {}
            bindKey = input.LookupBinding( 'gm_showteam' ) or ''
    
            for _, ent in ipairs( entities ) do
                if ( IsValid( ent ) and ent:isDoor() and not ent:getKeysNonOwnable() and DOORS[ ent:GetClass() ] and not ent:GetNoDraw() ) then
                    table.insert( nearest, ent )
                end
            end
        end
    end )
end

hook.Add( 'PostDrawTranslucentRenderables', 'onyx.hud.DrawDoors', function()
    local client = LocalPlayer()
    for _, ent in ipairs( nearest ) do
        if ( IsValid( ent ) ) then
            drawInfo( ent, client )
        end
    end
end )
--addons/bb_onyx_hud/lua/onyx/modules/hud/elements/cl_overhead.lua:
return gluapack()()
--addons/bb_onyx_hud/lua/onyx/modules/hud/elements/cl_timeout.lua:
--[[

Author: tochnonement
Email: tochnonement@gmail.com

19/08/2024

--]]

local hud = onyx.hud

local L = function( ... ) return onyx.lang:Get( ... ) end
local WIMG_ICON = onyx.wimg.Create( 'hud_connection_lost', 'smooth mips' )
local COLOR_GRAY = Color( 200, 200, 200 )

-- It is mandatory to run this command as soon as possible
RunConsoleCommand( 'cl_timeout', '99999' )

local function startFadeAnimation( panel, target, callback )
    panel.animAlpha = panel:GetAlpha() / 255
    
    onyx.anim.Create( panel, 1, {
        index = 1,
        target = { animAlpha = target },
        easing = 'inOutSine',
        think = function( _, panel )
            panel:SetAlpha( panel.animAlpha * 255 )
        end,
        onFinished = function( _, panel )
            if ( callback ) then
                callback( panel )
            end
        end
    } )
end

local function createPanel()
    local scrW, scrH = ScrW(), ScrH()
    local x0, y0 = scrW * .5, scrH * .5
    local theme = hud:GetCurrentTheme()
    local colors = theme.colors
    local space = hud.ScaleTall( 30 )

    local btnWide, btnTall = hud.ScaleWide( 200 ), hud.ScaleTall( 30 )
    local btnY = scrH * .75 - btnTall * .5

    local textTitle = L( 'timeout_title' )
    local textInfo = L( 'timeout_info' )
    local textStatus = L( 'timeout_status' )
    local fontInfo = hud.fonts.Medium

    surface.SetFont( fontInfo )
    local textInfoW, textInfoH = surface.GetTextSize( textInfo )
    local textStatusW, textStatusH = surface.GetTextSize( textStatus )

    local frame = vgui.Create( 'Panel' )
    onyx.hud.TimeoutPanel = frame

    frame:SetSize( ScrW(), ScrH() )
    frame:SetDrawOnTop( true )
    frame:SetAlpha( 0 )
    frame.statusFraction = 0
    frame.reconnectTime = 0
    frame.Paint = function( panel, w, h )
        if ( panel.reconnectTime > 0 and panel.reconnectTime <= SysTime() ) then
            RunConsoleCommand( 'retry' )
        end
        
        local alpha = panel:GetAlpha() / 255
        local iconSize = hud.ScaleTall( 128 )
        
        if ( alpha > 0) then
            onyx.DrawBlurExpensive( panel, 6 * alpha )
        end

        surface.SetDrawColor( ColorAlpha( colors.primary, theme.isDark and 230 or 150 ) )
        surface.DrawRect( 0, 0, w, h )

        draw.SimpleText( textTitle, hud.fonts.BigBold, x0, y0, colors.textPrimary, 1, 4 )

        WIMG_ICON:DrawRotated( x0, h * .4, iconSize, iconSize, 0, colors.textPrimary )
    end
    frame.OnRemove = function()
        timer.Remove( 'onyx.hud.TimeoutShowDetails' )
    end
    frame.Close = function( panel )
        if ( not panel.closed ) then
            panel.closed = true
            startFadeAnimation( panel, 0, function( this )
                this:Remove()
            end )
        end
    end

    local lblDesc = frame:Add( 'Panel' )
    lblDesc:SetTall( math.max( textInfoH, textStatusH ) )
    lblDesc:SetWide( scrW )
    lblDesc:SetPos( 0, y0 )
    lblDesc.Paint = function( panel, w, h )
        local statusFraction = frame.statusFraction
        local infoFraction = 1 - statusFraction
        local timeLeft = math.Round( math.max( 0, frame.reconnectTime - SysTime() ) )
        local prevAlpha = surface.GetAlphaMultiplier()

        surface.SetAlphaMultiplier( math.min( infoFraction, prevAlpha ) )
            onyx.hud.DrawCheapText( textInfo, fontInfo, w * .5 - textInfoW * .5, h * statusFraction, colors.textSecondary )
        surface.SetAlphaMultiplier( math.min( statusFraction, prevAlpha ) )
            draw.SimpleText( textStatus:format( timeLeft ), fontInfo, w * .5, -h * infoFraction, colors.negative, 1, 0 )
        surface.SetAlphaMultiplier( prevAlpha )
    end

    local btnReconnect = frame:Add( 'onyx.Button' )
    btnReconnect:SetText( L( 'reconnect_u' ) )
    btnReconnect:SetFont( hud.fonts.Tiny )
    btnReconnect:SetTextColor( colors.textPrimary )
    btnReconnect:SetColorIdle( colors.secondary )
    btnReconnect:SetColorHover( colors.tertiary )
    btnReconnect:SetSize( btnWide, btnTall )
    btnReconnect:SetPos( x0 - btnWide - space / 2, btnY )
    btnReconnect:Hide()
    btnReconnect.DoClick = function() RunConsoleCommand( 'retry' ) end

    local btnDisconnect = frame:Add( 'onyx.Button' )
    btnDisconnect:SetText( L( 'disconnect_u' ) )
    btnDisconnect:SetFont( hud.fonts.Tiny )
    btnDisconnect:SetTextColor( colors.textPrimary )
    btnDisconnect:SetColorIdle( colors.secondary )
    btnDisconnect:SetColorHover( colors.tertiary )
    btnDisconnect:SetSize( btnWide, btnTall )
    btnDisconnect:SetPos( x0 + space / 2, btnY )
    btnDisconnect:Hide()
    btnDisconnect.DoClick = function() RunConsoleCommand( 'disconnect' ) end

    startFadeAnimation( frame, 1 )

    timer.Create( 'onyx.hud.TimeoutShowDetails', 3, 1, function()
        if ( IsValid( frame ) ) then
            frame.reconnectTime = SysTime() + hud:GetOptionValue( 'timeout' )
            frame:MakePopup()
        
            onyx.anim.Create( frame, 1, {
                index = 2,
                target = { statusFraction = 1 },
                easing = 'outQuad',
                think = function( _, panel )
                    if ( IsValid( btnDisconnect ) and IsValid( btnReconnect ) ) then
                        local alpha = panel.statusFraction * 255

                        btnReconnect:SetVisible( true )
                        btnReconnect:SetAlpha( alpha )

                        btnDisconnect:SetVisible( true )
                        btnDisconnect:SetAlpha( alpha )
                    end
                end
            } )
        end
    end )
end

timer.Create( 'onyx.hud.TimeoutController', 2, 0, function()
    local isTimingOut, lastPing = GetTimeoutInfo()
    local panel = onyx.hud.TimeoutPanel
    local isValid = IsValid( panel )

    if ( isTimingOut ) then
        if ( isValid ) then
        else
            createPanel()
        end
    elseif ( isValid ) then
        panel:Close()
    end
end )

concommand.Add( 'onyx_hud_test_timeout', function( ply, _, args )
    if ( ply:IsSuperAdmin() ) then
        local freezeDuration = tonumber( args[ 1 ] ) or 10
        local resetTime = SysTime() + freezeDuration
        local hookName = 'onyx.hud.TimeoutTest'

        ply:ConCommand( 'net_fakeloss 100' )

        hook.Add( 'DrawOverlay', hookName, function()
            if ( resetTime <= SysTime() ) then
                hook.Remove( 'DrawOverlay', hookName )
                ply:ConCommand( 'net_fakeloss 0' )
            end
        end )
    end
end )
--addons/onyx_scoreboard/lua/onyx/modules/scoreboard/languages/cl_turkish.lua:
--[[

Author: maellwoe
Email: maellwoe@hotmail.com

14/03/2024

--]]

local LANG = {}

-- Phrases
LANG['copied_clipboard'] = 'Panoya kopyalandı'
LANG['scoreboard_search'] = 'Ara... (Name/SteamID)'
LANG['you'] = 'Sen'
LANG['friend'] = 'Arkadaş'
LANG['addon_return_u'] = 'GERI'

-- Columns
LANG['scoreboard_col_team'] = 'Takım'
LANG['scoreboard_col_job'] = 'Meslek'
LANG['scoreboard_col_money'] = 'Para'
LANG['scoreboard_col_rank'] = 'Yetki'
LANG['scoreboard_col_karma'] = 'Karma'
LANG['scoreboard_col_playtime'] = 'OynamaSuresi'
LANG['scoreboard_col_health'] = 'Can'
LANG['scoreboard_col_level'] = 'Seviye'
LANG['scoreboard_col_none'] = 'Hicbiri'
LANG['scoreboard_col_gang'] = 'Gang'
LANG['scoreboard_col_ashop_badges'] = 'Rozetler'

-- Name Effects
LANG['scoreboard_eff_default'] = 'Varsayılan'
LANG['scoreboard_eff_glow'] = 'Parıltı'
LANG['scoreboard_eff_rainbow'] = 'Gökkuşağı'
LANG['scoreboard_eff_scanning_vertical'] = 'Taranıyor (Dikey)'
LANG['scoreboard_eff_scanning_horizontal'] = 'Taranıyor (Yatay)'
LANG['scoreboard_eff_gradient_invert'] = 'Gradyan (Rengi Ters Çevir)'
LANG['scoreboard_eff_wavy_dual'] = 'Dalgalı (Çift Renk)'

-- Buttons
LANG['scoreboard_btn_profile'] = 'Profili aç'
LANG['scoreboard_btn_freeze'] = 'Dondur'
LANG['scoreboard_btn_goto'] = 'Git'
LANG['scoreboard_btn_bring'] = 'Getir'
LANG['scoreboard_btn_return'] = 'Geri Gonder'
LANG['scoreboard_btn_respawn'] = 'Yeniden Dogur'
LANG['scoreboard_btn_slay'] = 'Öldür'
LANG['scoreboard_btn_spectate'] = 'İzle'

-- Words
LANG['rank_id'] = 'Yetki Tanımlayıcı'
LANG['name'] = 'İsim'
LANG['effect'] = 'Effekt'
LANG['color'] = 'Renk'
LANG['preview'] = 'Ön izleme'
LANG['creation'] = 'Oluşturum'
LANG['save'] = 'Kayıt'
LANG['dead'] = 'Ölü'
LANG['create_new'] = 'Yeni Oluştur'
LANG['column'] = 'Kolon'

-- Settings
LANG['addon_settings_u'] = 'AYARLAR'
LANG['scoreboard_ranks_u'] = 'YETKILER'
LANG['scoreboard_columns_u'] = 'KOLONLAR'

LANG['scoreboard.title.name'] = 'Başlık'
LANG['scoreboard.title.desc'] = 'Çerçeve için bir başlık gir'

LANG['scoreboard.group_teams.name'] = 'Grup Takımları'
LANG['scoreboard.group_teams.desc'] = '(DarkRP) Grupları iş kategorilerine göre gruplandırın'

LANG['scoreboard.colored_players.name'] = 'Renklendirilmiş Gradyan'
LANG['scoreboard.colored_players.desc'] = 'Oyuncu satırında renklendirilmiş gradyanı göster'

LANG['scoreboard.blur.name'] = 'Blur Teması'
LANG['scoreboard.blur.desc'] = 'Blur temasını etkinleştir'

LANG['scoreboard.scale.name'] = 'Çerçeve Boyutu Ölçeği'
LANG['scoreboard.scale.desc'] = 'Skor tablosunun çerçeve boyutunu ölçeklendirin'

onyx.lang:AddPhrases('turkish', LANG)
--addons/onyx_scoreboard/lua/onyx/modules/scoreboard/core/ranks/sh_ranks.lua:
--[[

Author: tochnonement
Email: tochnonement@gmail.com

04/03/2024

--]]

onyx.scoreboard.ranks = onyx.scoreboard.ranks or {}

function onyx.scoreboard:GetRankData(rank)
    local rankData = onyx.scoreboard.ranks[rank]
    if (rankData) then
        if (CLIENT) then
            local effectID = rankData.effectID
            local effectData, effectIndex = onyx.scoreboard:FindNameEffect(effectID)

            rankData.effect = effectIndex
        end

        return rankData
    end
end
--addons/partysystem/lua/autorun/partysharedfunctions.lua:
local meta = FindMetaTable("Player")

function meta:GetParty()-- Returns the party the player is currently in
local party								
	for v, k in pairs(parties) do
		if table.HasValue(parties[v].members, self:SteamID64()) then
			party = v	
		end
	end
	return party
end

function meta:GetPartyName()							-- Returns the party name
	if self:GetParty() != nil then
		return parties[self:GetParty()].name
	end
end

if CLIENT then
	 concommand.Add( "PrintParty", function(ply,_e,args)
		if ply:GetParty() then
			PrintTable(parties[ply:GetParty()])
		end
	 end )
end


-- hook.Add("CanJoinParty" , "ForceSameTeam" , function (ply, partyid)
	-- if ply:Team() != player.GetBySteamID64(partyid):Team() then
		-- ply:Notify("That's a different team's party!")
		-- return false
	-- end
	-- return true
-- end)

--addons/pcasino/lua/perfectcasino/core/sh_core.lua:
-- The letters bodygroup and width
PerfectCasino.Core.Letter = {
	["a"] = {b = 0, w = 5},
	["b"] = {b = 1, w = 4},
	["c"] = {b = 2, w = 4.2},
	["d"] = {b = 3, w = 4.5},
	["e"] = {b = 4, w = 3.7},
	["f"] = {b = 5, w = 3.6},
	["g"] = {b = 6, w = 5},
	["h"] = {b = 7, w = 5},
	["i"] = {b = 8, w = 2},
	["j"] = {b = 9, w = 3.2},
	["k"] = {b = 10, w = 4.7},
	["l"] = {b = 11, w = 3.7},
	["m"] = {b = 12, w = 6},
	["n"] = {b = 13, w = 5},
	["o"] = {b = 14, w = 5},
	["p"] = {b = 15, w = 4},
	["q"] = {b = 16, w = 5},
	["r"] = {b = 17, w = 4.7},
	["s"] = {b = 18, w = 4},
	["t"] = {b = 19, w = 4.5},
	["u"] = {b = 20, w = 4.5},
	["v"] = {b = 21, w = 5.2},
	["w"] = {b = 22, w = 7.3},
	["x"] = {b = 23, w = 5},
	["y"] = {b = 24, w = 4.7},
	["z"] = {b = 25, w = 4.6},
	["0"] = {b = 26, w = 4.2},
	["1"] = {b = 27, w = 3},
	["2"] = {b = 28, w = 4},
	["3"] = {b = 29, w = 3.8},
	["4"] = {b = 30, w = 4.4},
	["5"] = {b = 31, w = 3.8},
	["6"] = {b = 32, w = 4.1},
	["7"] = {b = 33, w = 4.1},
	["8"] = {b = 34, w = 4.2},
	["9"] = {b = 35, w = 4.1},
	["-"] = {b = 36, w = 2.7},
	["!"] = {b = 37, w = 2},
	["."] = {b = 38, w = 2.3}
}

-- Who has "admin" perms
function PerfectCasino.Core.Access(user)
	if not IsValid(user) then return false end
	return PerfectCasino.Config.AccessGroups[user:GetUserGroup()] or PerfectCasino.Config.AccessGroups[user:SteamID64()] or PerfectCasino.Config.AccessGroups[user:SteamID()]
end

-- Chat messages
function PerfectCasino.Core.Msg(msg, ply)
	if SERVER then
		net.Start("pCasino:Msg")
			net.WriteString(msg)
		if not ply then
			net.Broadcast()
		else
			net.Send(ply)
		end
	else
		chat.AddText(PerfectCasino.Config.PrefixColor, PerfectCasino.Config.Prefix..": ", Color( 255, 255, 255 ), msg)
	end
end


if SERVER then return end

net.Receive("pCasino:Msg", function()
	PerfectCasino.Core.Msg(net.ReadString())
end)


--addons/pcasino/lua/perfectcasino/core/sh_card.lua:
-- Build a deck
local allCards = {}
-- hearts, diamonds, spades, clubs
for _, s in pairs({"h", "d", "s", "c"}) do
	for _, v in pairs{"a", 2, 3, 4, 5, 6, 7, 8, 9, "t", "j", "k", "q"} do -- We use 't' instead of '10' so that we can just check the 2nd value for what the card is worth
		table.insert(allCards, s..v)
	end
end

function PerfectCasino.Cards:GetRandom()
	local card = table.Random(allCards)

	--return "sq"
	return card
end

function PerfectCasino.Cards:GetValue(card, sum)
	local v = card[2]
	if not v then return false end

	if (v == "t") or (v == "j") or (v == "k") or (v == "q") then
		return 10
	elseif v == "a" then
		if sum then -- Check if we're basing it off a current evaluation
			if sum <= 10 then -- If the current sum is less than 11, we can return 11 without going bust
				return 11
			end

			return 1 -- Return 1 as a fallback
		end

		return 11
	else
		return tonumber(v)
	end
end

-- The card var must be a table of cards in the format obtained with PerfectCasino.Cards:GetRandom()
function PerfectCasino.Cards:GetHandValue(cards)
	local totalValue = 0
	local aces = 0

	for k, v in pairs(cards) do
		-- We calculate the aces after we've summmed up the total
		if v[2] == "a" then
			aces = aces + 1
			continue
		end
		totalValue = totalValue + PerfectCasino.Cards:GetValue(v)
	end

	if aces > 0 then
		for i=1, aces do
			totalValue = totalValue + PerfectCasino.Cards:GetValue("ha", totalValue) -- It doesn't matter the card we give it, as long as it's an ace
		end
	end

	return totalValue
end

local skins = {["h"] = 0, ["d"] = 1, ["c"] = 2, ["s"] = 3}
local bodygroups = {["a"] = 0, ["2"] = 1, ["3"] = 2, ["4"] = 3, ["5"] = 4, ["6"] = 5, ["7"] = 6, ["8"] = 7, ["9"] = 8, ["t"] = 9, ["j"] = 10, ["q"] = 11, ["k"] = 12}
function PerfectCasino.Cards:GetFaceData(card)
	if not card then return end

	return skins[card[1]] or 0, bodygroups[card[2]] or 0
end
--lua/autorun/pd2_bulldozer_zeal_player_npc.lua:
-- player model selector anim
list.Set( "PlayerOptionsAnimations", "PD2_bulldozer_zeal", { "idle_all_angry", "idle_all_01", "menu_walk" } )
player_manager.AddValidModel( "PD2_bulldozer_Zeal", "models/mark2580/payday2/pd2_bulldozer_zeal_player.mdl" )
player_manager.AddValidHands( "PD2_bulldozer_Zeal", "models/mark2580/payday2/pd2_bulldozer_zeal_c_arms.mdl", 0, "00000000" )
-- c_arms skin changer
local CBB = {}
function CBB.DrawRottenHands( vm, ply, weapon )
	if CLIENT then
		hskin = LocalPlayer():GetSkin()
		local hands = LocalPlayer():GetHands()
		if ( weapon.UseHands || !weapon:IsScripted() ) then
			if ( IsValid( hands ) ) then
				hands:DrawModel()
				hands:SetSkin(hskin)
			end
		end
	end
end
hook.Add("PostDrawViewModel", "Set player hand skin", CBB.DrawRottenHands)
-- health npc
local function fixHealthAndModelBull( ply, ent )
  if IsValid(ent) then
    if ent:GetModel() == "models/mark2580/payday2/pd2_bulldozer_zeal_combine.mdl" then 
      ent:SetHealth( 1000 )
      ent:SetMaxHealth( 1000 )
    elseif ent:GetModel() == "models/mark2580/payday2/pd2_bulldozer_zeal_rebel.mdl" then 
      ent:SetHealth( 1000 )
      ent:SetMaxHealth( 1000 )
    end
  end
end
-- npc menu combine / rebel
local Category = "PAYDAY 2 NPCs"

local NPC = {
  Name = "PD2 Bulldozer Zeal (Enemy)", 
  Class = "npc_combine_s",
  Model = "models/mark2580/payday2/pd2_bulldozer_zeal_combine.mdl",
  Weapons = { "weapon_smg1", "weapon_ar2", "weapon_shotgun" },
  Health = 100,
  KeyValues = {
    SquadName = "ZealTeam",
    Numgrenades = 5
  },
  Category = Category
}

list.Set( "NPC", "pd2_bulldozer_zeal_combine", NPC )

local NPC = {
  Name = "PD2 Bulldozer Zeal (Friendly)", 
  Class = "npc_citizen",
  Model = "models/mark2580/payday2/pd2_bulldozer_zeal_rebel.mdl",
  Health = 300,
  KeyValues = {
    citizentype = CT_UNIQUE
  },
  Weapons = { "weapon_pistol", "weapon_ar2", "weapon_smg1", "weapon_ar2", "weapon_shotgun" },
  Category = Category
}

list.Set( "NPC", "pd2_bulldozer_zeal_rebel", NPC )
-- health npc hook
hook.Add( "PlayerSpawnedNPC", "BulldozerZealSpawned", fixHealthAndModelBull )
--addons/[binbon]misc/lua/autorun/pd2_chains.lua:
return gluapack()()
--addons/[binbon]misc/lua/autorun/pd2_dallas.lua:

list.Set( "PlayerOptionsModel", "Dallas", 	"models/player/pd2_dallas_p.mdl" );
--addons/[binbon]misc/lua/autorun/pd2_wolf.lua:

list.Set( "PlayerOptionsModel", "Wolf", 	"models/player/pd2_wolf_p.mdl" );
--lua/autorun/privateplayer.lua:
return gluapack()()
--addons/undertale/lua/autorun/psa_undertale.lua:
return gluapack()()
--addons/tablo_ent/lua/scoresheet/sheets/money/shared.lua:
return gluapack()()
--addons/realisticcardealer/lua/realistic_cardealer/languages/sh_language_de.lua:
return gluapack()()
--addons/realisticcardealer/lua/realistic_cardealer/languages/sh_language_en.lua:
RCD = RCD or {}
RCD.Language = RCD.Language or {}

RCD.Language["en"] = {
	["undefined"] = "undefined",
	["adminMenuConfig"] = "ADMIN MENU - CONFIGURATION",
	["configureGroupsVehicles"] = "Configure groups & vehicles",
	["groups"] = "GROUPS",
	["vehicles"] = "VEHICLES",
	["createGroup"] = "CREATE NEW GROUP",
	["createVehicle"] = "CREATE NEW VEHICLE",
	["dealerConfiguration"] = "DEALER CONFIGURATION",
	["enterDealerName"] = "Enter the cardealer name",
	["groupsConfig"] = "Groups Config",
	["newPlateforms"] = "NEW SPAWN PLATFORMS",
	["deletePlateforms"] = "DELETE ALL PLATFORMS",
	["deleteNPC"] = "DELETE THE NPC",
	["saveInformations"] = "SAVE ALL INFORMATION",
	["configureGroups"] = "Configure groups information",
	["rankAccess"] = "RANKS ACCESS",
	["jobAccess"] = "JOBS ACCESS",
	["enterGroupName"] = "Enter the group name",
	["cancel"] = "CANCEL",
	["validateCreateGroup"] = "VALIDATE AND CREATE GROUP",
	["configureVehicleInformations"] = "Configure vehicles information",
	["preview"] = "PREVIEW",
	["chooseVehicleClass"] = "Choose the vehicle class...",
	["chooseVehicleGroup"] = "Choose the vehicle group...",
	["enterVehicleName"] = "Enter the vehicle name",
	["enterVehiclePrice"] = "Enter the vehicle price",
	["vehicleView"] = "VEHICLE VIEW",
	["generalSettings"] = "GENERAL SETTINGS",
	["priceSettings"] = "PRICE SETTINGS",
	["validateCreateVehicle"] = "VALIDATE AND CREATE VEHICLE",
	["configureAddon"] = "Configure all addon settings",
	["beltConfig"] = "BELT CONFIG",
	["engineConfig"] = "ENGINE CONFIG",
	["speedometerConfig"] = "SPEEDOMETER CONFIG",
	["driveConfig"] = "DRIVE CONFIG",
	["configureCarDealers"] = "CONFIGURE CAR DEALERS",
	["validateSaveSettings"] = "VALIDATE AND SAVE SETTINGS",
	["underglow"] = "Underglow",
	["skins"] = "Skins",
	["bodygroups"] = "Bodygroups",
	["carDealer"] = "Car Dealer",
	["spawnVehicle"] = "SPAWN VEHICLE",
	["bringBack"] = "BRING BACK",
	["testVehicle"] = "TEST VEHICLE",
	["customize"] = "CUSTOMIZE (%s)",
	["sell"] = "SELL",
	["buyVehicle"] = "Purchase",
	["customizationTitle"] = "CUSTOMIZATION",
	["mainMenuTitle"] = "MAIN MENU",
	["modifyVehicle"] = "CUSTOMIZE YOUR VEHICLE",
	["buySaleVehicles"] = "PURCHASE OR SELL VEHICLES",
	["vehicleOwned"] = "VEHICLE OWNED",
	["vehicleForSale"] = "VEHICLE FOR SALE",
	["allowed"] = "ALLOWED",
	["cantCustomizeVehicle"] = "You can't customize this vehicle \n we are sorry for the inconvenience",
	["testDrive"] = "Test Drive",
	["testDriveEnd"] = "The test drive will end in %ss",
	["addonNotInstalled"] = "%s addon is not installed",
	["vehicleTooFar"] = "Your vehicle is too far to customize it",
	["customizeVehicleText"] = "You customized your vehicle for %s",
	["invalidUsergroup"] = "You don't have the right rank to do this",
	["invalidJob"] = "You don't have the right job to do this",
	["cantAfford"] = "You don't have enough money to do this",
	["buyVehicleText"] = "You purchased %s for %s",
	["cantReturnVehicle1"] = "You can't sell your vehicle when it is out",
	["sellVehicleText"] = "You have sold your vehicle %s for %s",
	["testVehicleText"] = "You started the test of the vehicle, you have %ss",
	["vehicleAlreadyExited"] = "This vehicle is already out",
	["maxVehicleLimitReached"] = "You reached the max vehicles spawn",
	["cantSpawnVehicle2"] = "You can take out a vehicle during a test",
	["noPlaceAvailable"] = "There is no place available, come back later",
	["vehicleExitedText2"] = "You just take out the vehicle %s",
	["returnAroundVehicles"] = "You have just put away the vehicles around you",
	["noVehiclesAround"] = "There is no vehicle around you",
	["vehicleTooFarText"] = "Your vehicle is too far to be returned",
	["vehicleReturned2"] = "You just bring back your vehicle",
	["carDealerNotConfigured"] = "The Car-Dealer is not configured, please contact an administrator",
	["npcTooFar"] = "Your are too far from the npc to do this action",
	["npcNotOwnedVehicle"] = "The npc doesn't have this vehicle",
	["cantExitVehicle2"] = "You can't get out of the car because it is not stationary",
	["cantExitVehicle3"] = "You can't get out of the car because you have your seat belt",
	["invalidGroupName"] = "The group name is invalid",
	["vehicleGroupEdited"] = "You modified the group %s",
	["vehicleGroupCreated"] = "You created the vehicle group %s",
	["invalidGroupVehicle"] = "The vehicle group is invalid",
	["vehicleGroupDeleted"] = "You deleted the vehicle group #%s",
	["invalidVehicleClass"] = "The vehicle class is invalid",
	["invalidVehicleName"] = "The vehicle name is invalid",
	["invalidVehiclePrice"] = "The vehicle price is invalid",
	["vehicleEdited"] = "You modified the vehicle %s",
	["vehicleCreated"] = "You created the vehicle %s",
	["vehicleDeleted"] = "You deleted the vehicle #%s",
	["pnjUpdated"] = "You updated the npc %s",
	["pnjDeleted"] = "You deleted the npc #%s",
	["plateformEditMode"] = "You are currently in edit mode to place your platforms",
	["beenSaved"] = "You saved %s platforms",
	["allPlateformsDeleted"] = "You deleted all platforms on your server",
	["serverConfigurationUpdated"] = "You updated the configuration of your server",
	["close"] = "Close",
	["car"] = "Car",
	["returnButton"] = "Return",
	["maxSpeed"] = "Max speed",
	["horsePower"] = "Horsepower",
	["wheelsPerAxles"] = "Wheels per axle",
	["posX"] = "Pos - X",
	["angleX"] = "Angle - X",
	["posY"] = "Pos - Y",
	["AngleY"] = "Angle - Y",
	["posZ"] = "Pos - Z",
	["angleZ"] = "Angle - Z",
	["fov"] = "FOV",
	["useCustomNotification"] = "Use custom notification",
	["enterIntoVehicle"] = "Enter into vehicle",
	["currency"] = "Currency",
	["adminCommand"] = "Admin command",
	["maxVehicle"] = "Max Vehicle",
	["testTime"] = "Test Time",
	["distanceToReturn"] = "Distance to return",
	["underglowKey"] = "Underglow Key",
	["activateBelt"] = "Enable belt module",
	["warningSound"] = "Warning sound",
	["beltKey"] = "Seat Belt Key",
	["activateEngine"] = "Enable engine module",
	["engineKey"] = "Engine Key",
	["timeToLunchVehicle"] = "Time to launch vehicle",
	["cantLeaveVehicleInMotion"] = "Can't leave the vehicle in motion",
	["activateSmallAccident"] = "Enable small accident",
	["activateEjectionAccident"] = "Enable ejection accident",
	["lowerSpeedToExit"] = "Lower speed to exit",
	["minDamageSmallAccident"] = "Min damage for small accident",
	["minDamageEjectionAccident"] = "Min damage for ejection accident",
	["activateSpeedometer"] = "Enable speedometer",
	["activateSimfphysSpeedometer"] = "Enable simfphys speedometer for simfphys vehicles",
	["speedometerSize"] = "Size of speedometer",
	["count"] = "Count",
	["space"] = "Space",
	["defaultSkin"] = "Default skin",
	["choose"] = "Choose",
	["skin"] = "Skin",
	["defaultColor"] = "Default color",
	["chooseColor"] = "Choose color",
	["configureDefaultColor"] = "Configure default color",
	["setDefaultColor"] = "SET DEFAULT COLOR",
	["canModifyBodygroup"] = "Can modify bodygroup",
	["canModifySkin"] = "Can modify skin",
	["canModifyColor"] = "Can modify color",
	["canModifyUngerglow"] = "Can modify underglow",
	["canTestVehicle"] = "Can test the vehicle",
	["canBuyNitro"] = "Can purchase nitro",
	["priceToChangeBodygroups"] = "Price to change bodygroups",
	["priceToChangeSkins"] = "Price to change skins",
	["priceToChangeColors"] = "Price to change colors",
	["colors"] = "Colors",
	["nitro"] = "Nitro",
	["priceToChangeUnderglow"] = "Price to change underglow",
	["priceToBuyNitro"] = "Price to buy nitro",
	["pourcentSell"] = "Percentage of sale",
	["noText"] = "No Text",
	["invalidText"] = "Text Problem",
	["language"] = "Language",
	["speedUnit"] = "Speed unit",
	["free"] = "FREE",
	["buyForFree"] = "PURCHASE FOR FREE",
	["customizePrice"] = "You don't have enough money to cutomize this vehicle",
	["notEnoughtMoney"] = "You don't have enough money to do this",
	["rentVehc"] = "You rented the vehicle %s for %s",
	["cantSwitch"] = "You can't change seats because you have your seatbelt on",
	["canSellWithJob"] = "Can rent the vehicle when you are on cardealer job",
	["brakePower"] = "Braking Power",
	["modifyRentVehicle"] = "You have modified the vehicle information",
	["refundRentVehicle"] = "You have been refunded for %s",
	["turnSpeed"] = "Turn Speed",
	["mass"] = "Mass",
	["owned"] = "OWNED",
	["cardealerJobSettings"] = "CARDEALER JOB CONFIG",
	["cardealerJobDiscount"] = "Percentage price of the vehicle when sold by a player",
	["minCommissionPrice"] = "Minimum commission price",
	["maxCommissionPrice"] = "Maximum commission price",
	["alreadyBought"] = "You can't buy this vehicle because you already own it",
	["notGoodTeam"] = "You don't have the good job to do this",
	["rentPrice"] = "Rent price for the cardealer job",
	["vcmodTransfert"] = "Transfer all data from VCMOD",
	["wcdTransfert"] = "Transfer all data from WCD",
	["advancedTransfert"] = "Transfer all data from ACD",
	["modernTransfert"] = "Transfer all data from MODERN",
	["compatibilities"] = "COMPATIBILITY SETTINGS",
	["transfertStart"] = "You started the data transfer, it can take a litle bit time...",
	["alreadyTransfert"] = "You already transferred this data",
	["problem"] = "A problem has occurred, please try again",
	["invoiceOptions"] = "Option(s)",
	["invoiceCarName"] = "Car Name",
	["invoiceOptionPrice"] = "Option price",
	["invoiceTotalPrice"] = "Total price",
	["sellerSignature"] = "Seller signature",
	["buyerSignature"] = "Buyer signature",
	["invoice"] = "Invoice",
	["seller"] = "Seller : %s",
	["chooseSkin"] = "Choose Skin",
	["chooseVehicle"] = "Choose Vehicle",
	["sign"] = "Sign",
	["print"] = "Print",
	["openAdminConfiguration"] = "OPEN ADMIN CONFIGURATION",
	["selectVehicle"] = "You need to select a vehicle",
	["noVehicles"] = "You don't have any vehicle to customize",
	["toolName"] = "Setup NPC",
	["toolDesc"] = "Place NPC and configure it",
	["toolLeft1"] = "Press Left-Click to spawn the platforms",
	["toolLeft2"] = "Press Left-Click to spawn or modify an NPC",
	["toolRight1"] = "Press Right-Click to delete the last platform placed",
	["toolRight2"] = "Right-click on a NPC to delete it",
	["toolReload1"] = "Press RELOAD to save your platforms",
	["toolReload2"] = "Press RELOAD to reload all NPCs",
	["invoiceLimit"] = "You have reached your invoice limit",
	["stand"] = "STAND",
	["pressE"] = "PRESS E",
	["yourCommission"] = "Your commissions",
	["rentVehicle"] = "Rent the vehicle for %s",
	["saveRentInformation"] = "SAVE INFORMATION",
	["startEngineProblem"] = "There is an engine problem when starting your vehicle",
	["giveVehicle"] = "You gave the vehicle %s to the SteamID %s",
	["carDealerJobConfig"] = "Cardealer job name",
	["areYouSure"] = "ARE YOU SURE ?",
	["reset"] = "RESET",
	["acceptedInvoice"] = "%s just bought the vehicle %s for %s",
	["cantAcceptYourInvoice"] = "You can't accept your own invoice",
	["import"] = "Import",
	["standTitle"] = "CARDEALER",
	["sellVehicle"] = "Sell Vehicle",
	["rentVehicleSpace"] = "You don't have the space to rent the vehicle",
	["nitroKey"] = "Nitro Key",
	["nitroSpeed"] = "Nitro speed multiplier",
	["minSpeedNitro"] = "Min speed to activate nitro",
	["cantSell"] = "Your cannot sell this vehicle",
	["cantSellSetting"] = "Can't sell this vehicle",
	["playersManagement"] = "Players management",
	["open"] = "Open",
	["searchDisconnected"] = "DISCONNECTED PLAYER",
	["connectedPlayers"] = "CONNECTED PLAYERS",
	["selectedPlayer"] = "SELECTED PLAYER",
	["allVehicles"] = "ALL VEHICLES",
	["adminMenuPlayer"] = "ADMIN MENU - PLAYERS",
	["adminMenuPlayerDesc"] = "Manage vehicles bought by your players",
	["modifiedInformation"] = "You have changed the information of %s",
	["searchSteamId2"] = "Search by SteamID / SteamID64",
	["refreshList"] = "REFRESH LIST",
	["searchPlayer"] = "SEARCH PLAYER",
	["savePlayerInfo"] = "SAVE PLAYER INFORMATION",
	["nitroConfig"] = "NITRO CONFIG",
	["nitroDuration"] = "Duration of nitro",
	["nitroCooldowns"] = "Nitro reloading time",
	["cooldownsNitroNotify"] = "Your nitro is not ready next load in %ss",
	["alreadyRented"] = "You already rented this vehicle",
	["sellVehicleRented"] = "You have received %s for the sale of the vehicle %s",
	["boatSettingText"] = "Is the vehicle is a boat ?",
	["disableBeltVehicle"] = "Disable security belt module for this vehicle",
	["disableEngineVehicle"] = "Disable engine module for this vehicle",
}
--addons/realisticcardealer/lua/realistic_cardealer/languages/sh_language_ru.lua:
RCD = RCD or {}
RCD.Language = RCD.Language or {}

RCD.Language["ru"] = {
	["undefined"] = "неизвестно",
	["adminMenuConfig"] = "АДМИН МЕНЮ - НАСТРОЙКА",
	["configureGroupsVehicles"] = "Настроить группы & автомобили",
	["groups"] = "ГРУППЫ",
	["vehicles"] = "АВТОМОБИЛИ",
	["createGroup"] = "СОЗДАТЬ НОВУЮ ГРУППУ",
	["createVehicle"] = "СОЗДАТЬ НОВЫЙ АВТОМОБИЛЬ",
	["dealerConfiguration"] = "НАСТРОЙКА ДИЛЕРА",
	["enterDealerName"] = "Введите название дилера",
	["groupsConfig"] = "Настройка групп",
	["newPlateforms"] = "НОВЫЕ ПЛАТФОРМЫ ДЛЯ СПАВНА",
	["deletePlateforms"] = "УДАЛИТЬ ВСЕ ПЛАТФОРМЫ",
	["deleteNPC"] = "УДАЛИТЬ NPC",
	["saveInformations"] = "СОХРАНИТЬ ВСЮ ИНФОРМАЦИЮ",
	["configureGroups"] = "Настроить информацию о группах",
	["rankAccess"] = "ДОСТУП ПРИВИЛЕГИЯМ",
	["jobAccess"] = "ДОСТУП РАБОТАМ",
	["enterGroupName"] = "Введите название группы",
	["cancel"] = "ОТМЕНИТЬ",
	["validateCreateGroup"] = "ПРОВЕРКА И СОЗДАНИЕ ГРУППЫ",
	["configureVehicleInformations"] = "Настройка информации о машине",
	["preview"] = "ПРЕДПОКАЗ",
	["chooseVehicleClass"] = "Выберите класс автомобиля...",
	["chooseVehicleGroup"] = "Выберите группу автомобиля...",
	["enterVehicleName"] = "Введите название автомобиля",
	["enterVehiclePrice"] = "Введите цену автомобиля",
	["vehicleView"] = "ПОКА АВТОМОБЛИЯ",
	["generalSettings"] = "ОСНОВНЫЕ НАСТРОЙКИ",
	["priceSettings"] = "НАСТРОЙКИ ЦЕН",
	["validateCreateVehicle"] = "ПРОВЕРКА И СОЗДАНИЕ АВТОМОБИЛЯ",
	["configureAddon"] = "Настроить всю информацию аддона",
	["beltConfig"] = "НАСТРОЙКА РЕМНЯ БЕЗОПАСТНОСТИ",
	["engineConfig"] = "НАСТРОЙКА ДВИГАТЕЛЯ",
	["speedometerConfig"] = "НАСТРОЙКА СПИДОМЕТРА",
	["driveConfig"] = "НАСТРОЙКА ДИСОК",
	["configureCarDealers"] = "НАСТРОЙКА АВТОДИЛЕРОВ",
	["validateSaveSettings"] = "ПРОВЕРКА И СОХРАНЕНИЕ НАСТРОЕК",
	["underglow"] = "Подсвечивание",
	["skins"] = "Скины",
	["bodygroups"] = "Бодигруппы",
	["carDealer"] = "АвтоДилер",
	["spawnVehicle"] = "ЗАРЕСПАВНИТЬ АВТОМОБИЛЬ",
	["bringBack"] = "ВЕРНУТЬ",
	["testVehicle"] = "ТЕСТ АВТОМОБИЛЯ",
	["customize"] = "ПРОКАЧАТЬ ",
	["sell"] = "ПРОДАТЬ",
	["buyVehicle"] = "Приобрести",
	["customizationTitle"] = "ПРОКАЧКА",
	["mainMenuTitle"] = "ГЛАВНОЕ МЕНЮ",
	["modifyVehicle"] = "ПРОКАЧКА ВАШЕГО АВТОМОБИЛЯ",
	["buySaleVehicles"] = "ПРИОБРЕСТИ ИЛИ ПРОДАТЬ АВТОМОБИЛИ",
	["vehicleOwned"] = "ПРИОБРЕТЕННЫЕ",
	["vehicleForSale"] = "ДЛЯ ПОКУПКИ",
	["allowed"] = "ДОСТУПНЫЕ",
	["cantCustomizeVehicle"] = "Вы не можете прокачать это авто \n приносим извинения за причиненные неудобства",
	["testDrive"] = "Тест драйв",
	["testDriveEnd"] = "Тест-драйв завершится через %sс",
	["addonNotInstalled"] = "%s аддон не установлен",
	["vehicleTooFar"] = "Ваш автомобиль находится слишком далеко, чтобы настроить его",
	["customizeVehicleText"] = "Вы прокачали своё авто за %s",
	["invalidUsergroup"] = "У вас нет подходящего ранга, чтобы сделать это",
	["invalidJob"] = "У вас неподходящая работа для этого",
	["cantAfford"] = "У вас недостаточно денег, чтобы сделать это",
	["buyVehicleText"] = "Вы приобрели %s за %s",
	["cantReturnVehicle1"] = "Вы не можете продать свой автомобиль, когда он сломан",
	["sellVehicleText"] = "Вы продали свой автомобиль %s за %s",
	["testVehicleText"] = "Вы приступили к тестированию автомобиля, у вас есть %sс",
	["vehicleAlreadyExited"] = "Этот автомобиль уже заспавнен",
	["maxVehicleLimitReached"] = "Вы достигли максимального количества заспавненых авто",
	["cantSpawnVehicle2"] = "Вы можете вывести авто из эксплуатации во время теста",
	["noPlaceAvailable"] = "Свободных мест нет, приходите позже",
	["vehicleExitedText2"] = "Вы заспавнили авто %s",
	["returnAroundVehicles"] = "Вы только что убрали авто вокруг вас",
	["noVehiclesAround"] = "Вокруг вас нет никакого автомобиля",
	["vehicleTooFarText"] = "Ваш автомобиль находится слишком далеко, чтобы его можно было вернуть",
	["vehicleReturned2"] = "Вы просто вернули свой автомобиль",
	["carDealerNotConfigured"] = "Автодилер не настроен, пожалуйста, обратитесь к администратору",
	["npcTooFar"] = "Вы находитесь слишком далеко от NPC, чтобы выполнить это действие",
	["npcNotOwnedVehicle"] = "У NPC нет этого транспортного средства",
	["cantExitVehicle2"] = "Вы не можете выйти из машины, потому что она не стоит на месте",
	["cantExitVehicle3"] = "Вы не можете выйти из машины, потому что пристегнуты ремнем безопасности",
	["invalidGroupName"] = "Название группы недействительно",
	["vehicleGroupEdited"] = "Вы изменили группу %s",
	["vehicleGroupCreated"] = "Вы создали группу автомобилей %s",
	["invalidGroupVehicle"] = "Группа автомобилей недействительна",
	["vehicleGroupDeleted"] = "Вы удалили группу автомобилей #%s",
	["invalidVehicleClass"] = "Класс автомобиля недействителен",
	["invalidVehicleName"] = "Название автомобиля неверен",
	["invalidVehiclePrice"] = "Цена автомобиля недействительна",
	["vehicleEdited"] = "Вы модифицировали автомобиль %s",
	["vehicleCreated"] = "Вы создали автомобиль %s",
	["vehicleDeleted"] = "Вы удалили автомобиль #%s",
	["pnjUpdated"] = "Вы обновили NPC %s",
	["pnjDeleted"] = "Вы удалили NPC #%s",
	["plateformEditMode"] = "В настоящее время вы находитесь в режиме редактирования, размещая платформы для спавна",
	["beenSaved"] = "Вы сохранили %s платформ",
	["allPlateformsDeleted"] = "Вы удалили все платформы на своем сервере",
	["serverConfigurationUpdated"] = "Вы обновили конфигурацию своего сервера",
	["close"] = "Закрыть",
	["car"] = "Автомобиль",
	["returnButton"] = "Вернуться",
	["maxSpeed"] = "Максимальная скорость",
	["horsePower"] = "Лошадиных сил",
	["wheelsPerAxles"] = "Колеса на ось",
	["posX"] = "Позиция - X",
	["angleX"] = "Поворот - X",
	["posY"] = "Позиция - Y",
	["AngleY"] = "Поворот - Y",
	["posZ"] = "Позиция - Z",
	["angleZ"] = "Поворот - Z",
	["fov"] = "FOV",
	["useCustomNotification"] = "Используйте настраиваемое уведомление",
	["enterIntoVehicle"] = "Войти в авто",
	["currency"] = "Валюта",
	["adminCommand"] = "Админ команда",
	["maxVehicle"] = "Максимум авто",
	["testTime"] = "Время тест-драйва",
	["distanceToReturn"] = "Дистанция для возврата",
	["underglowKey"] = "Кнопка подсвечения",
	["activateBelt"] = "Пристегнуть ремень безопастности",
	["warningSound"] = "Звук предупреждения",
	["beltKey"] = "Кнопка ремня безопастности",
	["activateEngine"] = "Завести двигатель",
	["engineKey"] = "Кнопка двигателя",
	["timeToLunchVehicle"] = "Время запуска автомобиля",
	["cantLeaveVehicleInMotion"] = "Нельзя оставлять автомобиль в движении",
	["activateSmallAccident"] = "Включить небольшую аварию",
	["activateEjectionAccident"] = "Включить вылет из машины",
	["lowerSpeedToExit"] = "Более низкая скорость для выхода",
	["minDamageSmallAccident"] = "Минимальный урон при небольшой аварии",
	["minDamageEjectionAccident"] = "Минимальный ущерб при вылете из машины",
	["activateSpeedometer"] = "Включить спидометр",
	["activateSimfphysSpeedometer"] = "Включить simfphys спидометр для авто simfphys",
	["speedometerSize"] = "Размер спидометра",
	["count"] = "Счет",
	["space"] = "Расстояние",
	["defaultSkin"] = "Стандартный скин",
	["choose"] = "Выбор",
	["skin"] = "Скин",
	["defaultColor"] = "Стандартный цвет",
	["chooseColor"] = "Выбор цвета",
	["configureDefaultColor"] = "Настроить стандартный цвет",
	["setDefaultColor"] = "УСТАНОВИТЬ СТАНДАРТНЫЙ ЦВЕТ",
	["canModifyBodygroup"] = "Может изменить бодигруппы",
	["canModifySkin"] = "Может изменять скин",
	["canModifyColor"] = "Может изменять цвет",
	["canModifyUngerglow"] = "Может изменять подсветку",
	["canTestVehicle"] = "Может тестировать авто",
	["canBuyNitro"] = "Может приобрести нитро",
	["priceToChangeBodygroups"] = "Цена за смену бодигруппов",
	["priceToChangeSkins"] = "Цена за смену скинов",
	["priceToChangeColors"] = "Цена за смену цветов",
	["colors"] = "Цвета",
	["nitro"] = "Нитро",
	["priceToChangeUnderglow"] = "Цена за смену подсветки",
	["priceToBuyNitro"] = "Цена покупки нитро",
	["pourcentSell"] = "Процент от продажи",
	["noText"] = "Нет текста",
	["invalidText"] = "Текст проблемы",
	["language"] = "Язык",
	["speedUnit"] = "Единица измерения скорости",
	["free"] = "БЕСПЛАТНО",
	["buyForFree"] = "ПРИОБРЕСТИ БЕСПЛАТНО",
	["customizePrice"] = "У вас недостаточно денег, чтобы прокачать этот автомобиль",
	["notEnoughtMoney"] = "У тебя недостаточно денег, чтобы сделать это",
	["rentVehc"] = "Вы арендовали автомобиль %s за %s",
	["cantSwitch"] = "Вы не можете пересесть, потому что пристегнуты ремнем безопасности",
	["canSellWithJob"] = "Вы можете арендовать автомобиль, когда работаете автодилером",
	["brakePower"] = "Тормозная мощность",
	["modifyRentVehicle"] = "Вы изменили информацию о транспортном средстве",
	["refundRentVehicle"] = "Вам были возвращены деньги за %s",
	["turnSpeed"] = "Скорость поворота",
	["mass"] = "Масса",
	["owned"] = "ПРИОБРЕТЕНО",
	["cardealerJobSettings"] = "НАСТРОИТЬ РАБОТУ АВТОДИЛЕРА",
	["cardealerJobDiscount"] = "Процентная цена автомобиля при продаже игроком",
	["minCommissionPrice"] = "Минимальная комиссионная цена",
	["maxCommissionPrice"] = "Максимальная комиссионная цена",
	["alreadyBought"] = "Вы не можете купить этот автомобиль, потому что он у вас уже есть",
	["notGoodTeam"] = "У тебя нет хорошей работы, чтобы сделать это",
	["rentPrice"] = "Арендная плата за работу автодилера",
	["vcmodTransfert"] = "Перенести все данные из VCMOD",
	["wcdTransfert"] = "Перенести все данные из WCD",
	["advancedTransfert"] = "Перенести все данные из ACD",
	["modernTransfert"] = "Перенести все данные из MODERN",
	["compatibilities"] = "ПАРАМЕТРЫ СОВМЕСТИМОСТИ",
	["transfertStart"] = "Вы начали передачу данных, это может занять немного времени...",
	["alreadyTransfert"] = "Вы уже передали эти данные",
	["problem"] = "Возникла проблема, пожалуйста, повторите попытку",
	["invoiceOptions"] = "Настройка(и)",
	["invoiceCarName"] = "Название автомобиля",
	["invoiceOptionPrice"] = "Цена настройки",
	["invoiceTotalPrice"] = "Итоговая цена",
	["sellerSignature"] = "Подпись продавца",
	["buyerSignature"] = "Подпись покупателя",
	["invoice"] = "Счет-фактура",
	["seller"] = "Продавец: %s",
	["chooseSkin"] = "Выберите скин",
	["chooseVehicle"] = "Выберите автомобиль",
	["sign"] = "Подписать",
	["print"] = "Отпечаток",
	["openAdminConfiguration"] = "ОТКРЫТЬ АДМИН НАСТРОЙКИ",
	["selectVehicle"] = "Вам нужно выбрать автомобиль",
	["noVehicles"] = "У вас нет никакого автомобиля для настройки",
	["toolName"] = "Установить NPC",
	["toolDesc"] = "Поставить NPC и настроить его",
	["toolLeft1"] = "Нажмите ЛКМ, чтобы создать платформу",
	["toolLeft2"] = "Нажмите ЛКМ, чтобы создать или изменить NPC",
	["toolRight1"] = "Нажмите ПКМ, чтобы удалить последнюю созданную платформу",
	["toolRight2"] = "ПКМ по NPC, чтобы удалить его",
	["toolReload1"] = "Нажмите ПЕРЕЗАРЯДКУ, чтобы сохранить платформы",
	["toolReload2"] = "Нажмите ПЕРЕЗАРЯДКУ, чтобы перезапустить всех NPCs",
	["invoiceLimit"] = "Вы достигли лимита вашего счета",
	["stand"] = "ПОЗИЦИЯ",
	["pressE"] = "НАЖМИТЕ E",
	["yourCommission"] = "Ваши комиссионные",
	["rentVehicle"] = "Арендуйте автомобиль для %s",
	["saveRentInformation"] = "СОХРАНИТЬ ИНФОРМАЦИЮ",
	["startEngineProblem"] = "При запуске вашего автомобиля возникает проблема с двигателем",
	["giveVehicle"] = "У вас есть автомобиль %s для SteamID %s",
	["carDealerJobConfig"] = "Название работы автодилера",
	["areYouSure"] = "ВЫ УВЕРЕНЫ?",
	["reset"] = "СБРОСИТЬ",
	["acceptedInvoice"] = "%s приобрел автомобиль %s за %s",
    ["cantAcceptYourInvoice"] = "Вы не можете принять своё предложение",
    ["import"] = "Импорт",
    ["standTitle"] = "Авто Дилер",
    ["sellVehicle"] = "Продать автомобиль",
    ["rentVehicleSpace"] = "У вас нет места, чтобы арендовать автомобиль",
    ["nitroKey"] = "Кнопка нитро",
    ["nitroSpeed"] = "Ускоритель скорости с Нитро",
    ["minSpeedNitro"] = "Минимальная скорость для активации нитро",
    ["cantSell"] = "Вы не можете продать этот автомобиль",
	["cantSellSetting"] = "Не могу продать этот автомобиль",
	["playersManagement"] = "Управление игроками",
    ["open"] = "Открыть",
    ["searchDisconnected"] = "ОТКЛЮЧЕННЫЙ ИГРОК",
    ["connectedPlayers"] = "ПОДКЛЮЧЕННЫЕ ИГРОКИ",
    ["selectedPlayer"] = "ВЫБРАННЫЙ ИГРОК",
    ["allVehicles"] = "ВСЕ АВТОМОБИЛИ",
    ["adminMenuPlayer"] = "АДМИНИСТРАТОР - ИГРОКИ",
    ["adminMenuPlayerDesc"] = "Управление автомобилями, купленными вашими игроками",
    ["modifiedInformation"] = "Вы изменили информацию о %s",
    ["searchSteamId2"] = "Поиск по SteamID / SteamID64",
    ["refreshList"] = "ОБНОВИТЬ СПИСОК",
    ["searchPlayer"] = "ПОИСК ИГРОКА",
    ["savePlayerInfo"] = "СОХРАНИТЬ ИНФОРМАЦИЮ О ИГРОКЕ",
	["nitroConfig"] = "НИТРО КОНФИГ",
	["nitroDuration"] = "Продолжительность нитро",
	["nitroCooldowns"] = "Время перезарядки Nitro",
	["cooldownsNitroNotify"] = "Ваша нитрокраска не готова к следующей загрузке %ss",
	["alreadyRented"] = "Вы уже арендовали этот автомобиль",
	["sellVehicleRented"] = "Вы получили %s за продажу автомобиля %s",
	["boatSettingText"] = "Является ли транспортное средство лодкой?",
	["disableBeltVehicle"] = "Отключить модуль ремней безопасности для данного автомобиля",
	["disableEngineVehicle"] = "Отключить модуль двигателя для данного автомобиля",
}
--addons/realisticcardealer/lua/realistic_cardealer/vgui/cl_toggle.lua:
return gluapack()()
--addons/realisticcardealer/lua/realistic_cardealer/vgui/cl_dmodel.lua:
local PANEL = {}

function PANEL:Init()
    self:SetSize(RCD.ScrW*0.4, RCD.ScrH*0.525)
    self:SetModel("models/airboat.mdl")
    self.RCDZoom = true
    self.RCDCanRotate = true
    self.RCDFocusEnt = nil
    self.RCDLerpFOV = 43
    self.RCDFOVBase = 43
    self.RCDLerpVector = RCD.Constants["vectorOrigin"]
    self.RCDVector = RCD.Constants["vectorOrigin"]
    self.RCDStartAng = 0
    self.MinMaxLerp = {0, 0}
    
    if IsValid(self.Entity) then
        local mn, mx = self.Entity:GetRenderBounds()
        local size = 0
        size = math.max(size, math.abs(mn.x)+math.abs(mx.x))
        size = math.max(size, math.abs(mn.y)+math.abs(mx.y))
        size = math.max(size, math.abs(mn.z)+math.abs(mx.z))
    
        self:SetFOV(43)
        self:SetCamPos(Vector(size, size, 100))
        self:SetLookAt((mn+mx) * 0.3)
    end
end

function PANEL:Zoom()
    self.RCDZoom = !self.RCDZoom
end

function PANEL:CanRotateCamera(bool)
    self.RCDCanRotate = bool
end

function PANEL:SetFocusEntity(ent)
    self.RCDFocusEnt = ent
end

function PANEL:RCDSetFOV(number)
    self.RCDFOV = number
end

function PANEL:RCDSetFOVBase(number)
    self.RCDFOVBase = number
end

function PANEL:Think()
    if isnumber(self.RCDFOV) then
        self.RCDLerpFOV = Lerp(FrameTime()*3, self.RCDLerpFOV, self.RCDFOV)
        self:SetFOV(self.RCDLerpFOV)
    end

    if isvector(self.RCDVector) then
        self.RCDLerpVector = LerpVector(FrameTime()*3, self.RCDLerpVector, self.RCDVector)
    end

    if not self:IsHovered() && not isnumber(self.RCDStartAng) or not IsValid(self.RCDFocusEnt) then return end

    local CurX, CurY = self:ScreenToLocal(gui.MouseX(), gui.MouseY())

    if input.IsMouseDown(MOUSE_LEFT) && self.RCDCanRotate && LocalPlayer():RCDCanAccessVehicle(RCD.ClientTable["vehicleId"]) then 
        if not isnumber(self.RCDStartAng) then self.RCDStartAng = CurX end
        
        local ang = self.RCDFocusEnt:GetAngles()
        local newAng = ang.yaw-((self.RCDStartAng-CurX)/self:GetWide())*2
        
        self.RCDFocusEnt:SetAngles(Angle(ang.pitch, newAng, ang.roll))

    else
        self.RCDStartAng = nil
    end
end

function PANEL:DrawModel()
    if not IsValid(self.Entity) then return end
    
    self.Entity:DrawModel()
    
    for k, wheel in ipairs(self.Entity["wheels"] or {}) do
        if not IsValid(wheel) then continue end

        wheel:DrawModel()
    end
end

function PANEL:RemoveWheels()
    for k, wheel in ipairs(self.Entity["wheels"] or {}) do
        if not IsValid(wheel) then continue end

        wheel:Remove()
    end
end

function PANEL:SetParams(paramsTbl, ent, bool, withoutLerp)
    if not IsValid(ent) then return end
    if not istable(paramsTbl) then return end

    if isnumber(paramsTbl["fov"]) then
        if withoutLerp then
            self:SetFOV(self.RCDFOVBase + paramsTbl["fov"])
        else
            self:RCDSetFOV(self.RCDFOVBase + paramsTbl["fov"])
        end
    end
    if isangle(paramsTbl["angle"]) then
        ent:SetAngles(paramsTbl["angle"]+(!bool and RCD.Constants["angleParams"] or RCD.Constants["angleOrigin"]))
    end
    if isvector(paramsTbl["vector"]) then
        local vector = (paramsTbl["addon"] == "simfphys") and Vector(0, paramsTbl["vector"].y, paramsTbl["vector"].z) or paramsTbl["vector"]

        if withoutLerp then
            self:SetLookAt(vector)
        else
            self.RCDVector = vector
        end
    end
    if istable(paramsTbl["defaultColor"]) then
        ent.RCDColor = paramsTbl["defaultColor"]
        if IsValid(panel) then panel:SetColor(paramsTbl["defaultColor"]) end
    end
    if isnumber(paramsTbl["skin"]) then
        ent:SetSkin(paramsTbl["skin"])
    end

    timer.Simple(0, function()
        if not IsValid(ent) then return end
        ent.RCDVisible = true
    end)
end

 /* 673842fe962cb89d9ec2875cdf06befabb47c13c4355e268dbb54465eea7572e */
function PANEL:LayoutEntity()
    return
end

function PANEL:DoClick()
    self.RCDStartAng = self.Entity:GetAngles().yaw
end

derma.DefineControl("RCD:DModel", "RCD DModel", PANEL, "DModelPanel")
--addons/realisticcardealer/lua/realistic_cardealer/vgui/cl_slider_button.lua:
return gluapack()()
--addons/realisticcardealer/lua/realistic_cardealer/vgui/cl_vehicle_button.lua:
local PANEL = {}

function PANEL:Init()
    self:SetSize(RCD.ScrW*0.1949, RCD.ScrH*0.05)
    self:InclineButton(RCD.ScrW*0.055)
    self:SetText("")
    self:SetIconMaterial(nil)
    self.MinMaxLerp = {15, 5}
    self.VehicleName = RCD.GetSentence("invalidText")
    self.VehiclePrice = 0
    self.RCDSelected = nil
    self.RCDUniqueId = nil
    self.Fake = false
end

function PANEL:SetName(name)
    self.VehicleName = (name or RCD.GetSentence("undefined"))
end

function PANEL:SetPrice(price)
    self.VehiclePrice = (tonumber(price) or 0)
end

function PANEL:SetFake(bool)
    self.Fake = bool
end

function PANEL:SetUniqueId(uniqueId)
    self.RCDUniqueId = uniqueId
end

function PANEL:PaintOver(w,h)
    if self.Fake then return end
    
    local money = LocalPlayer():RCDGetMoney()
    local bought = RCD.ClientTable["vehiclesBought"][self.RCDUniqueId]

    draw.SimpleText(self.VehicleName, "RCD:Font:06", w/2.3, h*0.78, RCD.Colors["white"], TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)

    if bought then
        draw.SimpleText(RCD.GetSentence("owned"), "RCD:Font:08", w/2.3, h*0.9, RCD.Colors["green97"], TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)
    else
        draw.SimpleText((self.VehiclePrice <= 0 and RCD.GetSentence("free") or RCD.formatMoney(self.VehiclePrice)), "RCD:Font:08", w/2.3, h*0.9, (money < self.VehiclePrice) and RCD.Colors["red202"] or RCD.Colors["green97"], TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)
    end

    local bought = RCD.ClientTable["vehiclesBought"][self.RCDUniqueId]
    
    if bought then
        RCD.DrawCircle(w*0.91, h*0.1, h*0.06, 0, 360, RCD.Colors["purple"])

        surface.SetDrawColor(RCD.Colors["white"])
        surface.SetMaterial(RCD.Materials["icon_check"])
        surface.DrawTexturedRect(w*0.91-h*0.07/2, h*0.1-h*0.07/2, h*0.07, h*0.07)
    end

    if not LocalPlayer():RCDCanAccessVehicle(self.RCDUniqueId) then
        if not bought then
            RCD.DrawCircle(w*0.91, h*0.1, h*0.06, 0, 360, RCD.Colors["yellow"])

            surface.SetDrawColor(RCD.Colors["white"])
            surface.SetMaterial(RCD.Materials["icon_star"])
            surface.DrawTexturedRect(w*0.91-h*0.07/2, h*0.1-h*0.07/2, h*0.07, h*0.07)
        end

        surface.SetDrawColor(RCD.Colors["white100"])
        surface.SetMaterial(RCD.Materials["lock"])
        surface.DrawTexturedRect(w*0.845, h*0.07, h*0.07, h*0.07)
    end

    if not IsValid(self.vehicleModel) then return end

    local bool = self.vehicleModel:IsHovered()
    self.ColorLerp = Lerp(FrameTime()*3, self.ColorLerp, (bool or self.RCDSelected) and self.MinMaxLerp[1] or self.MinMaxLerp[2])
end

function PANEL:SetSelectedButton(bool)
    self.RCDSelected = bool
end

function PANEL:SetModel(mdl)
    self.vehicleModel = vgui.Create("RCD:DModel", self)
    self.vehicleModel:Dock(FILL)
    self.vehicleModel:DockMargin(RCD.ScrW*0.025,0,RCD.ScrW*0.03,RCD.ScrH*0.025)
    self.vehicleModel:SetFOV(55)
    self.vehicleModel:SetModel(mdl)
    self.vehicleModel:CanRotateCamera(false)
end

derma.DefineControl("RCD:VehicleButton", "RCD VehicleButton", PANEL, "RCD:SlideButton")
--addons/realisticcardealer/lua/realistic_cardealer/vgui/cl_checkbox.lua:
local PANEL = {}

function PANEL:Init()
    self:SetText("")
    self:SetSize(RCD.ScrW*0.1949, RCD.ScrH*0.05)
    self.RCDLerp = 0
    self.RCDActivate = false
    self.RCDLerpColor = RCD.Colors["white0"]
end

function PANEL:Paint(w,h)
    self.RCDLerp = Lerp(FrameTime()*12, self.RCDLerp, self.RCDActivate and h/2 or 0)

    RCD.DrawCircle(w/2, h/2, h/2, 0, 360, RCD.Colors["grey84"])
    RCD.DrawCircle(w/2, h/2, self.RCDLerp, 0, 360, RCD.Colors["purple"])

    local scale = math.floor(self.RCDLerp)*1.2
    local divisedScale = math.floor(scale/2)

    self.RCDLerpColor = RCD.LerpColor(FrameTime()*12, self.RCDLerpColor, (self.RCDActivate and RCD.Colors["white200"] or RCD.Colors["white0"]))

    surface.SetDrawColor(self.RCDLerpColor)
	surface.SetMaterial(RCD.Materials["icon_check"])
	surface.DrawTexturedRect(w/2-h*0.3, h/2-h*0.3, h*0.6, h*0.6)
end

function PANEL:DoClick()
    self.RCDActivate = !self.RCDActivate

    self:OnChange(self.RCDActivate)
end

function PANEL:GetActive()
    return self.RCDActivate
end

function PANEL:SetActive(bool)
    self.RCDActivate = bool
end

derma.DefineControl("RCD:CheckBox", "RCD CheckBox", PANEL, "DButton")
--addons/realisticcardealer/lua/realistic_cardealer/vgui/cl_dcombobox.lua:
return gluapack()()
--addons/realisticcardealer/lua/realistic_cardealer/vgui/cl_dcombobox.lua:
local PANEL = {}

function PANEL:Init()
    self:SetText("")
    self:SetSize(RCD.ScrW*0.1949, RCD.ScrH*0.05)
    self:SetFont("RCD:Font:13")
    self:SetTextColor(RCD.Colors["white100"])
    self.RCDRounded = 0
end

function PANEL:SetRounded(number)
    self.RCDRounded = (number or 0)
end

function PANEL:Paint(w,h)
    draw.RoundedBox(self.RCDRounded, 0, 0, w, h, RCD.Colors["white5"])
    self:DrawTextEntryText(RCD.Colors["white100"], RCD.Colors["white100"], RCD.Colors["white100"])
end

derma.DefineControl("RCD:DComboBox", "RCD DComboBox", PANEL, "DComboBox")
--addons/bb_isimeklentisi/lua/rpname_enforcer/client/rpname_enforcer_system.lua:
return gluapack()()
--addons/rsc/lua/rsc/client/cl_gallery.lua:

local function CreateMetadataWindow(frame, metadata)
    if frame.metadata then
        frame.metadata:Remove()
    end
    if not metadata or metadata.version ~= RSC.Metadata.CURRENT_VERSION then metadata = {} end

    frame.metadata = vgui.Create("Panel", frame)
    function frame.metadata:PerformLayout()
        local wide, height = 0, RSC.ScreenScale(16)
        for _, layout in ipairs(self:GetChildren()) do
            local marginL, marginT, marginR, marginB = layout:GetDockMargin()
            height = height + marginT + layout:GetTall() + marginB

            for _, entry in ipairs(layout:GetChildren()) do
                if entry:GetName() == "Field" then
                    surface.SetFont(entry:GetFont())
                    local textW = surface.GetTextSize(entry:GetText())

                    wide = math.max( wide, marginL + textW + marginR + RSC.ScreenScale(32) )
                end
            end
        end

        self:SetSize(wide, height)

        self:CenterHorizontal()
        self:SetY( self:GetParent():GetTall() - self:GetTall() )
    end
    function frame.metadata:Paint(w, h)
        surface.SetDrawColor(0, 0, 0, 200)
        surface.DrawRect(0, 0, w, h)
    end

    local function createField(title, value)
        local entryValue = RSC.GetPhrase(title) .. ": " .. value

        local layout = vgui.Create("Panel", frame.metadata)
        layout:Dock(TOP)
        layout:SetTall( RSC.ScreenScale(18) )
        layout:DockMargin( RSC.ScreenScale(8), RSC.ScreenScale(8), RSC.ScreenScale(8), 0 )

        local entry = vgui.Create("DTextEntry", layout, "Field")
        entry:Dock(FILL)
        entry:SetPaintBackground(false)
        entry:SetValue(entryValue)
        entry:SetFont("RSC 18")
        entry:SetTextColor(color_white)
        entry:SetCursorColor(color_white)
        entry:SetUpdateOnType(true)
        function entry:AllowInput() return true end
        function entry:OnChange()
            -- A little hack to prevent text deletion
            self:SetText(entryValue)
        end
    end

    createField("rsc.ui.unique_id", metadata.uniqueID or "<unknown>")
    createField("rsc.ui.captured_by", ("%s (%s)"):format(metadata.takenBy or "unknown", util.SteamIDTo64(metadata.takenByID or "") or "NULL"))
    createField("rsc.ui.user_target", ("%s (%s)"):format(metadata.victim or "unknown", util.SteamIDTo64(metadata.victimID or "") or "NULL"))
    createField("rsc.ui.date", os.date("%d/%m/%y - %H:%M:%S", tonumber(metadata.timestamp) or 0))

    frame.metadata:InvalidateLayout(true)
end

local function CreateTopbar(frame)
    local size24 = RSC.ScreenScale(24)
    local topbar = vgui.Create("Panel", frame)
    topbar:Dock(TOP)
    topbar:SetTall(RSC.ScreenScale(32))

    frame.close = vgui.Create("DButton", topbar)
    do
        local close = frame.close
        close:Dock(RIGHT)
        close:SetWide(topbar:GetTall())
        close:SetText("")
        close.icon = RSC.URLMaterial("https://i.imgur.com/aIZlJWO.png", "smooth")
        function close:Paint(w, h)
            if self.Hovered then
                surface.SetDrawColor(250, 82, 82)
                surface.DrawRect(0, 0, w, h)
            end

            surface.SetDrawColor(255, 255, 255, self.Hovered and 255 or 150)
            surface.SetMaterial(self.icon)
            surface.DrawTexturedRect((w - size24)/2, (h - size24)/2, size24, size24)
        end
        function close:DoClick()
            surface.PlaySound("UI/buttonclick.wav")
            frame:SetMouseInputEnabled(false)
            frame:AlphaTo(0, 0.1, 0, function()
                frame:Remove()
            end)
        end
    end

    frame.delete = vgui.Create("DButton", topbar)
    do
        local delete = frame.delete
        delete:Dock(RIGHT)
        delete:SetWide(topbar:GetTall())
        delete:SetText("")
        delete:SetEnabled(false)
        delete.icon = RSC.URLMaterial("https://i.imgur.com/2KP8vZk.png", "smooth")
        function delete:Paint(w, h)
            surface.SetDrawColor(255, 255, 255, 150)

            if self.Hovered then
                surface.SetDrawColor(255, 255, 255, 255)
            end
            if self.Depressed then
                surface.SetDrawColor(255, 255, 255, 170)
            end
            if not self:IsEnabled() then
                surface.SetDrawColor(255, 255, 255, 10)
            end

            surface.SetMaterial(self.icon)
            surface.DrawTexturedRect((w - size24)/2, (h - size24)/2, size24, size24)
        end
        function delete:DoClick()
            surface.PlaySound("UI/buttonclick.wav")

            file.Delete(self.src)
            frame:RemovePage(frame.currentPage)
            frame:ChangePage(frame.currentPage - 1)
        end
    end

    frame.pageNum = vgui.Create("DLabel", topbar)
    do
        local pageNum = frame.pageNum
        pageNum:Dock(LEFT)
        pageNum:DockMargin(RSC.ScreenScale(8), 0, RSC.ScreenScale(8), 0)
        pageNum:SetFont("RSC 24")
        pageNum:SetColor(color_white)
        pageNum:SetWide(64)
        pageNum:SetContentAlignment(5)
        pageNum:SetText("0/0")
        function pageNum:PerformLayout() self:SizeToContentsX() end
    end

    frame.title = vgui.Create("DLabel", topbar)
    do
        local title = frame.title
        title:Dock(LEFT)
        title:DockMargin(0, 0, RSC.ScreenScale(8), 0)
        title:SetFont("RSC 18")
        title:SetColor(Color(255, 255, 255, 150))
        title:SetText("Gallery")
        title:SetContentAlignment(4)
        function title:PerformLayout() self:SizeToContentsX() end
    end

    frame.description = vgui.Create("DLabel", topbar)
    do
        local description = frame.description
        description:Dock(LEFT)
        description:DockMargin(0, 0, RSC.ScreenScale(8), 0)
        description:SetFont("RSC 16")
        description:SetColor(Color(255, 255, 255, 50))
        description:SetText("Try screengrab someone!")
        description:SetContentAlignment(4)
        function description:PerformLayout() self:SizeToContentsX() end
    end

    frame.info = vgui.Create("DButton", topbar)
    do
        local info = frame.info
        info:Dock(LEFT)
        info:SetWide(topbar:GetTall())
        info:SetText("")
        info.icon = RSC.URLMaterial("https://i.imgur.com/dbdgc3m.png", "smooth")
        function info:Paint(w, h)
            if not self:IsEnabled() then return end

            surface.SetDrawColor(255, 255, 255, 50)

            if self.Hovered then
                surface.SetDrawColor(255, 255, 255, 150)
            end
            if self.Depressed then
                surface.SetDrawColor(255, 255, 255, 100)
            end

            surface.SetMaterial(self.icon)
            surface.DrawTexturedRect((w - size24)/2, (h - size24)/2, size24, size24)
        end
        function info:DoClick()
            if not self:IsEnabled() then return end
            if not self.metadata then return end
            if frame.metadata then
                frame.metadata:AlphaTo(0, 0.1, 0, function(_, self) self:Remove() end)
                frame.metadata = nil
            return end

            CreateMetadataWindow(frame, self.metadata)
            frame.metadata:SetAlpha(0)
            frame.metadata:AlphaTo(255, 0.1)
        end
    end
end

local function CreateImagePanel(parent)
    local pnl = vgui.Create("Panel", parent)
    pnl:Dock(FILL)
    function pnl:SetImage(img)
        self.img = img
        if isstring(img) then self.img_src = img end
    end
    function pnl:GetImage()
        return self.img
    end
    function pnl:PerformLayout(w, h)
        if type(self.img) ~= "IMaterial" then return end
        local texW, texH = self.img:Width(), self.img:Height()
        local imgW, imgH = w, texH * w / texW

        if imgH > h then
            imgW, imgH = texW * h / texH, h
        end

        self._imgW = imgW
        self._imgH = imgH
        self._imgX = w/2 - self._imgW/2
        self._imgY = h/2 - self._imgH/2

        self.imgW = self._imgW
        self.imgH = self._imgH
        self.imgX = self._imgX
        self.imgY = self._imgY
    end
    function pnl:Paint(w, h)
        if not self.img then return end
        if isstring(self.img) then
            self.img = Material(self.img, "smooth")
            self:InvalidateLayout(true)
        end

        surface.SetMaterial(self.img)
        surface.SetDrawColor(255, 255, 255)
        surface.DrawTexturedRect(self.imgX, self.imgY, self.imgW, self.imgH)
    end
    function pnl:Think()
        if not self.img then return end
        local width, height = self:GetSize()
        if not self._imgX then return end

        if not self.pressed then
            self:SetCursor("arrow")

            if not self.zoom then
                self.imgW = self._imgW
                self.imgH = self._imgH
                self.imgY = self._imgY

                local diff = self.imgX - self._imgX
                local maxDiff = RSC.ScrW * 0.3
                if (diff < -maxDiff or diff > maxDiff) and self:OnPageChange(diff > maxDiff) then
                    self.lastClick = nil
                end

                if self.lastClick then
                    self.imgX = Lerp(SysTime() - self.lastClick, self.imgX, self._imgX)
                else
                    self.imgX = self._imgX
                end
            end
        else
            self:SetCursor("sizeall")

            local x, y = gui.MouseX() - self.pressedAt[1], gui.MouseY() - self.pressedAt[2]
            if not self.zoom then
                self.imgX = self._imgX + x
            else
                if self.imgW > width then self.imgX = math.Clamp(self._imgX + x, width - self.imgW, 0) end
                if self.imgH > height then self.imgY = math.Clamp(self._imgY + y, height - self.imgH, 0) end
            end
        end
    end
    function pnl:OnMousePressed(code)
        if code ~= MOUSE_LEFT then return end

        self:MouseCapture(true)
        self.pressed = SysTime()
        self.pressedAt = { gui.MouseX(), gui.MouseY() }
    end
    function pnl:OnMouseReleased(code)
        if code ~= MOUSE_LEFT then return end

        self:MouseCapture(false)
        self.pressed = nil

        if self.lastClick and (self.lastClick + 0.2) > SysTime() then
            self:ToggleZoom()
            self.lastClick = nil
        else
            self.lastClick = SysTime()

            if self.zoom then
                self._imgX = self.imgX
                self._imgY = self.imgY
            end
        end
    end
    function pnl:ToggleZoom()
        self.zoom = not self.zoom

        if self.zoom then
            local width, height = self:GetSize()
            local x, y = self:ScreenToLocal(gui.MouseX(), gui.MouseY())
            if x < 0 or y < 0 then
                x = width/2
                y = height/2
            end


            self.imgW = self._imgW * 2
            self.imgH = self._imgH * 2
            self._imgX = width/2 - self.imgW/2
            self._imgY = height/2 - self.imgH/2

            local centerX, centerY = self._imgX + self.imgW/2, self._imgY + self.imgH/2
            if self.imgW > width then self._imgX = self._imgX - (x - centerX) end
            if self.imgH > height then self._imgY = self._imgY - (y - centerY) end

            self.imgX = self._imgX
            self.imgY = self._imgY
        else
            self:InvalidateLayout(true)
        end
    end
    function pnl:OnPageChange(right)
    end

    return pnl
end

local function CreatePage(frame, index)
    local page = CreateImagePanel(frame)

    if index then
        table.insert(frame.pages, index, page)
    else
        table.insert(frame.pages, page)
    end

    page:SetVisible(false)
    function page:OnPageChange(right)
        frame:ChangePage(frame.currentPage + (right and -1 or 1))
    end

    return page
end

local function CreatePageSwitchers(frame)
    local function create(parent)
        local but = vgui.Create("DButton", parent)
        but:SetText("")
        but.exited = SysTime()
        but.imgW = 0
        but.imgH = 0
        but.alpha = 0
        but._imgW = RSC.ScreenScale(48)
        but._imgH = RSC.ScreenScale(48)
        but.startDefault = SysTime()
        function but:OnCursorEntered()
            self.startHover = SysTime()
        end
        function but:OnCursorExited()
            self.startDefault = SysTime()
        end
        function but:OnDepressed()
            self.startPress = SysTime()
        end
        function but:Think()
            if self.Depressed then
                local t = (SysTime() - self.startPress) / 0.1
                self.imgW = Lerp(t, self.imgW, self._imgW * 0.8)
                self.imgH = Lerp(t, self.imgH, self._imgH * 0.8)
                self.alpha = Lerp(t, self.alpha, 200)
            elseif self.Hovered then
                local t = (SysTime() - self.startHover) / 0.1
                self.imgW = Lerp(t, self.imgW, self._imgW)
                self.imgH = Lerp(t, self.imgH, self._imgH)
                self.alpha = Lerp(t, self.alpha, 100)
            else
                local t = (SysTime() - self.startDefault) / 0.1
                self.imgW = Lerp(t, self.imgW, self._imgW * 0.6)
                self.imgH = Lerp(t, self.imgH, self._imgH * 0.6)
                self.alpha = Lerp(t, self.alpha, 20)
            end
        end
        function but:Paint(w, h)
            if not self.img then return end
            if not self:IsEnabled() then return end

            surface.SetDrawColor(255, 255, 255, self.alpha)

            local imgW, imgH = math.floor(self.imgW), math.floor(self.imgH)
            surface.SetMaterial(self.img)
            surface.DrawTexturedRect(w/2 - imgW/2, h/2 - imgH/2, imgW, imgH)
        end

        return but
    end

    frame.toLeft = create(frame)
    frame.toLeft:Dock(LEFT)
    frame.toLeft:SetWide(RSC.ScreenScale(48))
    frame.toLeft.img = RSC.URLMaterial("https://i.imgur.com/Tk6uMwW.png", "smooth")
    function frame.toLeft:DoClick()
        surface.PlaySound("UI/buttonclick.wav")
        frame:ChangePage(frame.currentPage - 1)
    end

    frame.toRight = create(frame)
    frame.toRight:Dock(RIGHT)
    frame.toRight:SetWide(RSC.ScreenScale(48))
    frame.toRight.img = RSC.URLMaterial("https://i.imgur.com/pXTVrHF.png", "smooth")
    function frame.toRight:DoClick()
        surface.PlaySound("UI/buttonclick.wav")
        frame:ChangePage(frame.currentPage + 1)
    end
end

RSC.GalleryPanel = nil
function RSC.OpenGallery()
    if IsValid(RSC.GalleryPanel) then
        RSC.GalleryPanel:Remove()
        RSC.GalleryPanel = nil
    end

    RSC.GalleryPanel = vgui.Create("EditablePanel")

    local frame = RSC.GalleryPanel
    frame:SetSize(RSC.ScrW, RSC.ScrH)
    frame:SetAlpha(0)
    frame:AlphaTo(255, 0.1, 0)
    frame:MakePopup()
    function frame:Paint(w, h)
        surface.SetDrawColor(0, 0, 0, 230)
        surface.DrawRect(0, 0, w, h)
    end
    function frame:PerformLayout() self:SetSize(RSC.ScrW, RSC.ScrH) end

    frame.pages = {}
    frame.currentPage = 1
    function frame:Update()
        self.delete:SetEnabled(false)
        self.pageNum:SetText(tostring(self.currentPage) .. "/" .. tostring(#self.pages))
        self.toLeft:SetEnabled(self.currentPage ~= 1)
        self.toRight:SetEnabled(self.currentPage ~= #self.pages)
        self.title:SetText("")
        self.description:SetText("")
        self.info:SetEnabled(false)

        for page, pnl in ipairs(self.pages) do
            pnl:SetVisible(page == self.currentPage)

            if pnl:IsVisible() and pnl.img_src then
                self.title:SetText("File: " .. pnl.img_src)

                local path = pnl.img_src
                if file.Exists(path, "GAME") then
                    local time = os.date("%d/%m/%Y - %H:%M:%S", file.Time(path, "GAME"))
                    local size = math.floor(file.Size(path, "GAME") / 1000)

                    self.description:SetText(("%s | %d KB"):format(time, size))
                    self.delete:SetEnabled(true)
                    self.delete.src = path:gsub("data/", "")

                    local metadata = RSC.Metadata.ReadMetadata(self.delete.src)
                    self.info.metadata = metadata
                    self.info:SetEnabled(not not metadata)
                    if self.metadata then CreateMetadataWindow(self, metadata) end
                end
            end
        end
    end
    function frame:CreatePage(img, index)
        local page = CreatePage(frame, index)
        page:SetImage(img)
        frame:Update()

        return page
    end
    function frame:RemovePage(index)
        local page = table.remove(self.pages, index)
        page:Remove()
        frame:Update()
    end
    function frame:ChangePage(position)
        local totalPages = #self.pages
        local oldPage = self.currentPage

        self.currentPage = math.Clamp(position, 1, totalPages)
        local pageChanged = self.currentPage ~= oldPage

        if pageChanged then
            self:Update()
            return true
        end
    end
    function frame:GetCurrentPage()
        for page, pnl in ipairs(self.pages) do
            if page == self.currentPage then return pnl end
        end
    end

    CreateTopbar(frame)
    CreatePageSwitchers(frame)

    for _, img in ipairs(file.Find("rsc/*", "DATA", "datedesc")) do
        frame:CreatePage("data/rsc/" .. img)
    end

    --frame:CreatePage(nil, 1)
end

RSC.Command("rsc_gallery", RSC.OpenGallery)

--lua/autorun/rust_nomad_pm.lua:
return gluapack()()
--addons/sam-159/lua/sam/libs/message_pack/sh_messagepack.lua:
if SAM_LOADED then return end
--
-- lua-MessagePack : <https://fperrad.frama.io/lua-MessagePack/>
--
local SIZEOF_NUMBER = string.pack and #string.pack('n', 0.0) or 8
local maxinteger
local mininteger
local assert = assert
local error = error
local pairs = pairs
local pcall = pcall
local setmetatable = setmetatable
local tostring = tostring
local char = string.char
local format = string.format
local floor = math.floor
local tointeger = floor
local frexp = math.frexp
local ldexp = math.ldexp
local huge = math.huge
local tconcat = table.concat
local type = sam.type
local isnumber = sam.isnumber
local _ENV = nil
local m = {}

--[[ debug only
local function hexadump (s)
	return (s:gsub('.', function (c) return format('%02X ', c:byte()) end))
end
m.hexadump = hexadump
--]]
local function argerror(caller, narg, extramsg)
	error("bad argument #" .. tostring(narg) .. " to " .. caller .. " (" .. extramsg .. ")")
end

local function typeerror(caller, narg, arg, tname)
	argerror(caller, narg, tname .. " expected, got " .. type(arg))
end

local function checktype(caller, narg, arg, tname)
	if type(arg) ~= tname then
		typeerror(caller, narg, arg, tname)
	end
end

local packers = setmetatable({}, {
	__index = function(t, k)
		if k == 1 then return end -- allows ipairs
		error("pack '" .. k .. "' is unimplemented")
	end
})

m.packers = packers

packers["nil"] = function(buffer)
	buffer[#buffer + 1] = char(0xC0) -- nil
end

packers["boolean"] = function(buffer, bool)
	if bool then
		buffer[#buffer + 1] = char(0xC3) -- true
	else
		buffer[#buffer + 1] = char(0xC2) -- false
	end
end

packers["string_compat"] = function(buffer, str)
	local n = #str

	if n <= 0x1F then
		buffer[#buffer + 1] = char(0xA0 + n) -- fixstr
	elseif n <= 0xFFFF then
		buffer[#buffer + 1] = char(0xDA, floor(n / 0x100), n % 0x100) -- str16
	elseif n <= 4294967295.0 then
		buffer[#buffer + 1] = char(0xDB, floor(n / 0x1000000), floor(n / 0x10000) % 0x100, floor(n / 0x100) % 0x100, n % 0x100) -- str32
	else
		error"overflow in pack 'string_compat'"
	end

	buffer[#buffer + 1] = str
end

packers["_string"] = function(buffer, str)
	local n = #str

	if n <= 0x1F then
		buffer[#buffer + 1] = char(0xA0 + n) -- fixstr
	elseif n <= 0xFF then
		buffer[#buffer + 1] = char(0xD9, n) -- str8
	elseif n <= 0xFFFF then
		buffer[#buffer + 1] = char(0xDA, floor(n / 0x100), n % 0x100) -- str16
	elseif n <= 4294967295.0 then
		buffer[#buffer + 1] = char(0xDB, floor(n / 0x1000000), floor(n / 0x10000) % 0x100, floor(n / 0x100) % 0x100, n % 0x100) -- str32
	else
		error("overflow in pack 'string'")
	end

	buffer[#buffer + 1] = str
end

packers["binary"] = function(buffer, str)
	local n = #str

	if n <= 0xFF then
		buffer[#buffer + 1] = char(0xC4, n) -- bin8
	elseif n <= 0xFFFF then
		buffer[#buffer + 1] = char(0xC5, floor(n / 0x100), n % 0x100) -- bin16
	elseif n <= 4294967295.0 then
		buffer[#buffer + 1] = char(0xC6, floor(n / 0x1000000), floor(n / 0x10000) % 0x100, floor(n / 0x100) % 0x100, n % 0x100) -- bin32
	else
		error("overflow in pack 'binary'")
	end

	buffer[#buffer + 1] = str
end

local set_string = function(str)
	if str == "string_compat" then
		packers["string"] = packers["string_compat"]
	elseif str == "string" then
		packers["string"] = packers["_string"]
	elseif str == "binary" then
		packers["string"] = packers["binary"]
	else
		argerror("set_string", 1, "invalid option '" .. str .. "'")
	end
end

m.set_string = set_string

packers["map"] = function(buffer, tbl, n)
	if n <= 0x0F then
		buffer[#buffer + 1] = char(0x80 + n) -- fixmap
	elseif n <= 0xFFFF then
		buffer[#buffer + 1] = char(0xDE, floor(n / 0x100), n % 0x100) -- map16
	elseif n <= 4294967295.0 then
		buffer[#buffer + 1] = char(0xDF, floor(n / 0x1000000), floor(n / 0x10000) % 0x100, floor(n / 0x100) % 0x100, n % 0x100) -- map32
	else
		error("overflow in pack 'map'")
	end

	for k, v in pairs(tbl) do
		packers[type(k)](buffer, k)
		packers[type(v)](buffer, v)
	end
end

packers["array"] = function(buffer, tbl, n)
	if n <= 0x0F then
		buffer[#buffer + 1] = char(0x90 + n) -- fixarray
	elseif n <= 0xFFFF then
		buffer[#buffer + 1] = char(0xDC, floor(n / 0x100), n % 0x100) -- array16
	elseif n <= 4294967295.0 then
		buffer[#buffer + 1] = char(0xDD, floor(n / 0x1000000), floor(n / 0x10000) % 0x100, floor(n / 0x100) % 0x100, n % 0x100) -- array32
	else
		error("overflow in pack 'array'")
	end

	for i = 1, n do
		local v = tbl[i]
		packers[type(v)](buffer, v)
	end
end

local set_array = function(array)
	if array == "without_hole" then
		packers["_table"] = function(buffer, tbl)
			local is_map, n, max = false, 0, 0

			for k in pairs(tbl) do
				if isnumber(k) and k > 0 then
					if k > max then
						max = k
					end
				else
					is_map = true
				end

				n = n + 1
			end

			-- there are holes
			if max ~= n then
				is_map = true
			end

			if is_map then
				packers["map"](buffer, tbl, n)
			else
				packers["array"](buffer, tbl, n)
			end
		end
	elseif array == "with_hole" then
		packers["_table"] = function(buffer, tbl)
			local is_map, n, max = false, 0, 0

			for k in pairs(tbl) do
				if isnumber(k) and k > 0 then
					if k > max then
						max = k
					end
				else
					is_map = true
				end

				n = n + 1
			end

			if is_map then
				packers["map"](buffer, tbl, n)
			else
				packers["array"](buffer, tbl, max)
			end
		end
	elseif array == "always_as_map" then
		packers["_table"] = function(buffer, tbl)
			local n = 0

			for k in pairs(tbl) do
				n = n + 1
			end

			packers["map"](buffer, tbl, n)
		end
	else
		argerror("set_array", 1, "invalid option '" .. array .. "'")
	end
end

m.set_array = set_array

packers["table"] = function(buffer, tbl)
	packers["_table"](buffer, tbl)
end

packers["unsigned"] = function(buffer, n)
	if n >= 0 then
		if n <= 0x7F then
			buffer[#buffer + 1] = char(n) -- fixnum_pos
		elseif n <= 0xFF then
			buffer[#buffer + 1] = char(0xCC, n) -- uint8
		elseif n <= 0xFFFF then
			buffer[#buffer + 1] = char(0xCD, floor(n / 0x100), n % 0x100) -- uint16
		elseif n <= 4294967295.0 then
			buffer[#buffer + 1] = char(0xCE, floor(n / 0x1000000), floor(n / 0x10000) % 0x100, floor(n / 0x100) % 0x100, n % 0x100) -- uint32
		else
			buffer[#buffer + 1] = char(0xCF, 0, floor(n / 0x1000000000000) % 0x100, floor(n / 0x10000000000) % 0x100, floor(n / 0x100000000) % 0x100, floor(n / 0x1000000) % 0x100, floor(n / 0x10000) % 0x100, floor(n / 0x100) % 0x100, n % 0x100) -- uint64 -- only 53 bits from double
		end
	else
		if n >= -0x20 then
			buffer[#buffer + 1] = char(0x100 + n) -- fixnum_neg
		elseif n >= -0x80 then
			buffer[#buffer + 1] = char(0xD0, 0x100 + n) -- int8
		elseif n >= -0x8000 then
			n = 0x10000 + n
			buffer[#buffer + 1] = char(0xD1, floor(n / 0x100), n % 0x100) -- int16
		elseif n >= -0x80000000 then
			n = 4294967296.0 + n
			buffer[#buffer + 1] = char(0xD2, floor(n / 0x1000000), floor(n / 0x10000) % 0x100, floor(n / 0x100) % 0x100, n % 0x100) -- int32
		else
			buffer[#buffer + 1] = char(0xD3, 0xFF, floor(n / 0x1000000000000) % 0x100, floor(n / 0x10000000000) % 0x100, floor(n / 0x100000000) % 0x100, floor(n / 0x1000000) % 0x100, floor(n / 0x10000) % 0x100, floor(n / 0x100) % 0x100, n % 0x100) -- int64 -- only 53 bits from double
		end
	end
end

packers["signed"] = function(buffer, n)
	if n >= 0 then
		if n <= 0x7F then
			buffer[#buffer + 1] = char(n) -- fixnum_pos
		elseif n <= 0x7FFF then
			buffer[#buffer + 1] = char(0xD1, floor(n / 0x100), n % 0x100) -- int16
		elseif n <= 0x7FFFFFFF then
			buffer[#buffer + 1] = char(0xD2, floor(n / 0x1000000), floor(n / 0x10000) % 0x100, floor(n / 0x100) % 0x100, n % 0x100) -- int32
		else
			buffer[#buffer + 1] = char(0xD3, 0, floor(n / 0x1000000000000) % 0x100, floor(n / 0x10000000000) % 0x100, floor(n / 0x100000000) % 0x100, floor(n / 0x1000000) % 0x100, floor(n / 0x10000) % 0x100, floor(n / 0x100) % 0x100, n % 0x100) -- int64 -- only 53 bits from double
		end
	else
		if n >= -0x20 then
			buffer[#buffer + 1] = char(0xE0 + 0x20 + n) -- fixnum_neg
		elseif n >= -0x80 then
			buffer[#buffer + 1] = char(0xD0, 0x100 + n) -- int8
		elseif n >= -0x8000 then
			n = 0x10000 + n
			buffer[#buffer + 1] = char(0xD1, floor(n / 0x100), n % 0x100) -- int16
		elseif n >= -0x80000000 then
			n = 4294967296.0 + n
			buffer[#buffer + 1] = char(0xD2, floor(n / 0x1000000), floor(n / 0x10000) % 0x100, floor(n / 0x100) % 0x100, n % 0x100) -- int32
		else
			buffer[#buffer + 1] = char(0xD3, 0xFF, floor(n / 0x1000000000000) % 0x100, floor(n / 0x10000000000) % 0x100, floor(n / 0x100000000) % 0x100, floor(n / 0x1000000) % 0x100, floor(n / 0x10000) % 0x100, floor(n / 0x100) % 0x100, n % 0x100) -- int64 -- only 53 bits from double
		end
	end
end

local set_integer = function(integer)
	if integer == "unsigned" then
		packers["integer"] = packers["unsigned"]
	elseif integer == "signed" then
		packers["integer"] = packers["signed"]
	else
		argerror("set_integer", 1, "invalid option '" .. integer .. "'")
	end
end

m.set_integer = set_integer

packers["float"] = function(buffer, n)
	local sign = 0

	if n < 0.0 then
		sign = 0x80
		n = -n
	end

	local mant, expo = frexp(n)

	if mant ~= mant then
		buffer[#buffer + 1] = char(0xCA, 0xFF, 0x88, 0x00, 0x00) -- nan
	elseif mant == huge or expo > 0x80 then
		if sign == 0 then
			buffer[#buffer + 1] = char(0xCA, 0x7F, 0x80, 0x00, 0x00) -- inf
		else
			buffer[#buffer + 1] = char(0xCA, 0xFF, 0x80, 0x00, 0x00) -- -inf
		end
	elseif (mant == 0.0 and expo == 0) or expo < -0x7E then
		buffer[#buffer + 1] = char(0xCA, sign, 0x00, 0x00, 0x00) -- zero
	else
		expo = expo + 0x7E
		mant = floor((mant * 2.0 - 1.0) * ldexp(0.5, 24))
		buffer[#buffer + 1] = char(0xCA, sign + floor(expo / 0x2), (expo % 0x2) * 0x80 + floor(mant / 0x10000), floor(mant / 0x100) % 0x100, mant % 0x100)
	end
end

packers["double"] = function(buffer, n)
	local sign = 0

	if n < 0.0 then
		sign = 0x80
		n = -n
	end

	local mant, expo = frexp(n)

	if mant ~= mant then
		buffer[#buffer + 1] = char(0xCB, 0xFF, 0xF8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00) -- nan
	elseif mant == huge or expo > 0x400 then
		if sign == 0 then
			buffer[#buffer + 1] = char(0xCB, 0x7F, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00) -- inf
		else
			buffer[#buffer + 1] = char(0xCB, 0xFF, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00) -- -inf
		end
	elseif (mant == 0.0 and expo == 0) or expo < -0x3FE then
		buffer[#buffer + 1] = char(0xCB, sign, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00) -- zero
	else
		expo = expo + 0x3FE
		mant = floor((mant * 2.0 - 1.0) * ldexp(0.5, 53))
		buffer[#buffer + 1] = char(0xCB, sign + floor(expo / 0x10), (expo % 0x10) * 0x10 + floor(mant / 0x1000000000000), floor(mant / 0x10000000000) % 0x100, floor(mant / 0x100000000) % 0x100, floor(mant / 0x1000000) % 0x100, floor(mant / 0x10000) % 0x100, floor(mant / 0x100) % 0x100, mant % 0x100)
	end
end

local set_number = function(number)
	if number == "float" then
		packers["number"] = function(buffer, n)
			if floor(n) == n and n < maxinteger and n > mininteger then
				packers["integer"](buffer, n)
			else
				packers["float"](buffer, n)
			end
		end
	elseif number == "double" then
		packers["number"] = function(buffer, n)
			if floor(n) == n and n < maxinteger and n > mininteger then
				packers["integer"](buffer, n)
			else
				packers["double"](buffer, n)
			end
		end
	else
		argerror("set_number", 1, "invalid option '" .. number .. "'")
	end
end

m.set_number = set_number

for k = 0, 4 do
	local n = tointeger(2 ^ k)
	local fixext = 0xD4 + k

	packers["fixext" .. tostring(n)] = function(buffer, tag, data)
		assert(#data == n, "bad length for fixext" .. tostring(n))
		buffer[#buffer + 1] = char(fixext, tag < 0 and tag + 0x100 or tag)
		buffer[#buffer + 1] = data
	end
end

packers["ext"] = function(buffer, tag, data)
	local n = #data

	if n <= 0xFF then
		buffer[#buffer + 1] = char(0xC7, n, tag < 0 and tag + 0x100 or tag) -- ext8
	elseif n <= 0xFFFF then
		buffer[#buffer + 1] = char(0xC8, floor(n / 0x100), n % 0x100, tag < 0 and tag + 0x100 or tag) -- ext16
	elseif n <= 4294967295.0 then
		buffer[#buffer + 1] = char(0xC9, floor(n / 0x1000000), floor(n / 0x10000) % 0x100, floor(n / 0x100) % 0x100, n % 0x100, tag < 0 and tag + 0x100 or tag) -- ext&32
	else
		error("overflow in pack 'ext'")
	end

	buffer[#buffer + 1] = data
end

function m.pack(data)
	local buffer = {}
	packers[type(data)](buffer, data)

	return tconcat(buffer)
end

local unpackers -- forward declaration

local function unpack_cursor(c)
	local s, i, j = c.s, c.i, c.j

	if i > j then
		c:underflow(i)
		s, i, j = c.s, c.i, c.j
	end

	local val = s:byte(i)
	c.i = i + 1

	return unpackers[val](c, val)
end

m.unpack_cursor = unpack_cursor

local function unpack_str(c, n)
	local s, i, j = c.s, c.i, c.j
	local e = i + n - 1

	if e > j or n < 0 then
		c:underflow(e)
		s, i, j = c.s, c.i, c.j
		e = i + n - 1
	end

	c.i = i + n

	return s:sub(i, e)
end

local function unpack_array(c, n)
	local t = {}

	for i = 1, n do
		t[i] = unpack_cursor(c)
	end

	return t
end

local function unpack_map(c, n)
	local t = {}

	for i = 1, n do
		local k = unpack_cursor(c)
		local val = unpack_cursor(c)

		if k == nil or k ~= k then
			k = m.sentinel
		end

		if k ~= nil then
			t[k] = val
		end
	end

	return t
end

local function unpack_float(c)
	local s, i, j = c.s, c.i, c.j

	if i + 3 > j then
		c:underflow(i + 3)
		s, i, j = c.s, c.i, c.j
	end

	local b1, b2, b3, b4 = s:byte(i, i + 3)
	local sign = b1 > 0x7F
	local expo = (b1 % 0x80) * 0x2 + floor(b2 / 0x80)
	local mant = ((b2 % 0x80) * 0x100 + b3) * 0x100 + b4

	if sign then
		sign = -1
	else
		sign = 1
	end

	local n

	if mant == 0 and expo == 0 then
		n = sign * 0.0
	elseif expo == 0xFF then
		if mant == 0 then
			n = sign * huge
		else
			n = 0.0 / 0.0
		end
	else
		n = sign * ldexp(1.0 + mant / 0x800000, expo - 0x7F)
	end

	c.i = i + 4

	return n
end

local function unpack_double(c)
	local s, i, j = c.s, c.i, c.j

	if i + 7 > j then
		c:underflow(i + 7)
		s, i, j = c.s, c.i, c.j
	end

	local b1, b2, b3, b4, b5, b6, b7, b8 = s:byte(i, i + 7)
	local sign = b1 > 0x7F
	local expo = (b1 % 0x80) * 0x10 + floor(b2 / 0x10)
	local mant = ((((((b2 % 0x10) * 0x100 + b3) * 0x100 + b4) * 0x100 + b5) * 0x100 + b6) * 0x100 + b7) * 0x100 + b8

	if sign then
		sign = -1
	else
		sign = 1
	end

	local n

	if mant == 0 and expo == 0 then
		n = sign * 0.0
	elseif expo == 0x7FF then
		if mant == 0 then
			n = sign * huge
		else
			n = 0.0 / 0.0
		end
	else
		n = sign * ldexp(1.0 + mant / 4503599627370496.0, expo - 0x3FF)
	end

	c.i = i + 8

	return n
end

local function unpack_uint8(c)
	local s, i, j = c.s, c.i, c.j

	if i > j then
		c:underflow(i)
		s, i, j = c.s, c.i, c.j
	end

	local b1 = s:byte(i)
	c.i = i + 1

	return b1
end

local function unpack_uint16(c)
	local s, i, j = c.s, c.i, c.j

	if i + 1 > j then
		c:underflow(i + 1)
		s, i, j = c.s, c.i, c.j
	end

	local b1, b2 = s:byte(i, i + 1)
	c.i = i + 2

	return b1 * 0x100 + b2
end

local function unpack_uint32(c)
	local s, i, j = c.s, c.i, c.j

	if i + 3 > j then
		c:underflow(i + 3)
		s, i, j = c.s, c.i, c.j
	end

	local b1, b2, b3, b4 = s:byte(i, i + 3)
	c.i = i + 4

	return ((b1 * 0x100 + b2) * 0x100 + b3) * 0x100 + b4
end

local function unpack_uint64(c)
	local s, i, j = c.s, c.i, c.j

	if i + 7 > j then
		c:underflow(i + 7)
		s, i, j = c.s, c.i, c.j
	end

	local b1, b2, b3, b4, b5, b6, b7, b8 = s:byte(i, i + 7)
	c.i = i + 8

	return ((((((b1 * 0x100 + b2) * 0x100 + b3) * 0x100 + b4) * 0x100 + b5) * 0x100 + b6) * 0x100 + b7) * 0x100 + b8
end

local function unpack_int8(c)
	local s, i, j = c.s, c.i, c.j

	if i > j then
		c:underflow(i)
		s, i, j = c.s, c.i, c.j
	end

	local b1 = s:byte(i)
	c.i = i + 1

	if b1 < 0x80 then
		return b1
	else
		return b1 - 0x100
	end
end

local function unpack_int16(c)
	local s, i, j = c.s, c.i, c.j

	if i + 1 > j then
		c:underflow(i + 1)
		s, i, j = c.s, c.i, c.j
	end

	local b1, b2 = s:byte(i, i + 1)
	c.i = i + 2

	if b1 < 0x80 then
		return b1 * 0x100 + b2
	else
		return ((b1 - 0xFF) * 0x100 + (b2 - 0xFF)) - 1
	end
end

local function unpack_int32(c)
	local s, i, j = c.s, c.i, c.j

	if i + 3 > j then
		c:underflow(i + 3)
		s, i, j = c.s, c.i, c.j
	end

	local b1, b2, b3, b4 = s:byte(i, i + 3)
	c.i = i + 4

	if b1 < 0x80 then
		return ((b1 * 0x100 + b2) * 0x100 + b3) * 0x100 + b4
	else
		return ((((b1 - 0xFF) * 0x100 + (b2 - 0xFF)) * 0x100 + (b3 - 0xFF)) * 0x100 + (b4 - 0xFF)) - 1
	end
end

local function unpack_int64(c)
	local s, i, j = c.s, c.i, c.j

	if i + 7 > j then
		c:underflow(i + 7)
		s, i, j = c.s, c.i, c.j
	end

	local b1, b2, b3, b4, b5, b6, b7, b8 = s:byte(i, i + 7)
	c.i = i + 8

	if b1 < 0x80 then
		return ((((((b1 * 0x100 + b2) * 0x100 + b3) * 0x100 + b4) * 0x100 + b5) * 0x100 + b6) * 0x100 + b7) * 0x100 + b8
	else
		return ((((((((b1 - 0xFF) * 0x100 + (b2 - 0xFF)) * 0x100 + (b3 - 0xFF)) * 0x100 + (b4 - 0xFF)) * 0x100 + (b5 - 0xFF)) * 0x100 + (b6 - 0xFF)) * 0x100 + (b7 - 0xFF)) * 0x100 + (b8 - 0xFF)) - 1
	end
end

function m.build_ext(tag, data)
	return nil
end

local function unpack_ext(c, n, tag)
	local s, i, j = c.s, c.i, c.j
	local e = i + n - 1

	if e > j or n < 0 then
		c:underflow(e)
		s, i, j = c.s, c.i, c.j
		e = i + n - 1
	end

	c.i = i + n

	return m.build_ext(tag, s:sub(i, e))
end

local fn_1 = function(c, val) return val end
local fn_2 = function(c, val) return unpack_map(c, val % 0x10) end
local fn_3 = function(c, val) return unpack_array(c, val % 0x10) end
local fn_4 = function(c, val) return unpack_str(c, val % 0x20) end
local fn_5 = function(c, val) return val - 0x100 end

unpackers = setmetatable({
	[0xC0] = function() return nil end,
	[0xC2] = function() return false end,
	[0xC3] = function() return true end,
	[0xC4] = function(c) return unpack_str(c, unpack_uint8(c)) end, -- bin8
	[0xC5] = function(c) return unpack_str(c, unpack_uint16(c)) end, -- bin16
	[0xC6] = function(c) return unpack_str(c, unpack_uint32(c)) end, -- bin32
	[0xC7] = function(c) return unpack_ext(c, unpack_uint8(c), unpack_int8(c)) end,
	[0xC8] = function(c) return unpack_ext(c, unpack_uint16(c), unpack_int8(c)) end,
	[0xC9] = function(c) return unpack_ext(c, unpack_uint32(c), unpack_int8(c)) end,
	[0xCA] = unpack_float,
	[0xCB] = unpack_double,
	[0xCC] = unpack_uint8,
	[0xCD] = unpack_uint16,
	[0xCE] = unpack_uint32,
	[0xCF] = unpack_uint64,
	[0xD0] = unpack_int8,
	[0xD1] = unpack_int16,
	[0xD2] = unpack_int32,
	[0xD3] = unpack_int64,
	[0xD4] = function(c) return unpack_ext(c, 1, unpack_int8(c)) end,
	[0xD5] = function(c) return unpack_ext(c, 2, unpack_int8(c)) end,
	[0xD6] = function(c) return unpack_ext(c, 4, unpack_int8(c)) end,
	[0xD7] = function(c) return unpack_ext(c, 8, unpack_int8(c)) end,
	[0xD8] = function(c) return unpack_ext(c, 16, unpack_int8(c)) end,
	[0xD9] = function(c) return unpack_str(c, unpack_uint8(c)) end,
	[0xDA] = function(c) return unpack_str(c, unpack_uint16(c)) end,
	[0xDB] = function(c) return unpack_str(c, unpack_uint32(c)) end,
	[0xDC] = function(c) return unpack_array(c, unpack_uint16(c)) end,
	[0xDD] = function(c) return unpack_array(c, unpack_uint32(c)) end,
	[0xDE] = function(c) return unpack_map(c, unpack_uint16(c)) end,
	[0xDF] = function(c) return unpack_map(c, unpack_uint32(c)) end
}, {
	__index = function(t, k)
		if k < 0xC0 then
			if k < 0x80 then
				return fn_1
			elseif k < 0x90 then
				return fn_2
			elseif k < 0xA0 then
				return fn_3
			else
				return fn_4
			end
		elseif k > 0xDF then
			return fn_5
		else
			return function()
				error("unpack '" .. format("%#x", k) .. "' is unimplemented")
			end
		end
	end
})

local function cursor_string(str)
	return {
		s = str,
		i = 1,
		j = #str,
		underflow = function()
			error"missing bytes"
		end
	}
end

local function cursor_loader(ld)
	return {
		s = '',
		i = 1,
		j = 0,
		underflow = function(self, e)
			self.s = self.s:sub(self.i)
			e = e - self.i + 1
			self.i = 1
			self.j = 0

			while e > self.j do
				local chunk = ld()

				if not chunk then
					error"missing bytes"
				end

				self.s = self.s .. chunk
				self.j = #self.s
			end
		end
	}
end

function m.unpack(s)
	checktype("unpack", 1, s, "string")
	local cursor = cursor_string(s)
	local data = unpack_cursor(cursor)

	if cursor.i <= cursor.j then
		error("extra bytes")
	end

	return data
end

function m.unpacker(src)
	if type(src) == "string" then
		local cursor = cursor_string(src)

		return function()
			if cursor.i <= cursor.j then return cursor.i, unpack_cursor(cursor) end
		end
	elseif type(src) == "function" then
		local cursor = cursor_loader(src)

		return function()
			if cursor.i > cursor.j then
				pcall(cursor.underflow, cursor, cursor.i)
			end

			if cursor.i <= cursor.j then return true, unpack_cursor(cursor) end
		end
	else
		argerror("unpacker", 1, "string or function expected, got " .. type(src))
	end
end

set_string("string")
set_integer("unsigned")

if SIZEOF_NUMBER == 4 then
	maxinteger = 16777215
	mininteger = -maxinteger
	m.small_lua = true
	unpackers[0xCB] = nil -- double
	unpackers[0xCF] = nil -- uint64
	unpackers[0xD3] = nil -- int64
	set_number("float")
else
	maxinteger = 9007199254740991
	mininteger = -maxinteger
	set_number("double")

	if SIZEOF_NUMBER > 8 then
		m.long_double = true
	end
end

set_array("always_as_map")
m._VERSION = "0.5.2"
m._DESCRIPTION = "lua-MessagePack : a pure Lua implementation"
m._COPYRIGHT = "Copyright (c) 2012-2019 Francois Perrad"

return m
--
-- This library is licensed under the terms of the MIT/X11 license,
-- like Lua itself.
--

--addons/sam-159/lua/sam/libs/sh_sfs.lua:
-- SFS (Srlion's Fast Serializer)
-- we try to avoid NYI operations in luajit as much as possible
-- unforunately, we can't avoid all of them in luajit 2.0.5 - pairs & table.concat
-- https://github.com/tarantool/tarantool/wiki/LuaJIT-Not-Yet-Implemented
-- we don't use string concating because it's also NYI in luajit 2.0.5
-- we never error so we don't get blacklisted by the jit compiler
-- errors return strings instead of throwing errors

-- this is intentionally made for net messages, so you don't have to use pcall to check if there are any errors
-- you should use this without using util.Compress, as this just adds one byte to each value, you will probably end up with a larger string if you compress it

-- this idea is from messagepack which is really smart
-- small numbers (0 ~ 127) and (-32 ~ -1) are encoded as a single byte
-- tables and arrays are encoded with a prefix byte, which is the number of elements in the table or array, but it can be one byte if it's less than 16
-- strings are encoded with a prefix byte, which is the length of the string, but it can be one byte if it's less than 32

local math = math
local HUGE = math.huge
local floor = math.floor
local internal_type = type
local IsColor = IsColor
local type = function(v)
    if IsColor(v) then
        return "Color"
    end
    return internal_type(v)
end

-- string.char is not jit compiled in luajit 2.0.5
local chars = {}; do
    for i = 0, 255 do
        chars[i] = string.char(i)
    end
end

local MAX_NUMBER = 1.7976931348623e+308
local MIN_NUMBER = -MAX_NUMBER

---
local POSITIVE_INT = 0x00
local POSITIVE_INT_END = 0x7f

local TABLE_FIXED = 0x80
local TABLE_FIXED_END = 0x8f

local ARRAY_FIXED = 0x90
local ARRAY_FIXED_END = 0x9f

local STR_FIXED = 0xa0
local STR_FIXED_END = 0xbf

local NIL = 0xc0
local FALSE = 0xc1
local TRUE = 0xc2

local UINT_8 = 0xc3
local UINT_16 = 0xc4
local UINT_32 = 0xc5
local UINT_52 = 0xc6

local NINT_8 = 0xc7
local NINT_16 = 0xc8
local NINT_32 = 0xc9
local NINT_52 = 0xca

local DOUBLE = 0xcb

local STR_8 = 0xcc
local STR_16 = 0xcd
local STR_32 = 0xce

local ARRAY_8 = 0xcf
local ARRAY_16 = 0xd0
local ARRAY_32 = 0xd1

local TABLE_8 = 0xd2
local TABLE_16 = 0xd3
local TABLE_32 = 0xd4

local VECTOR = 0xd5
local ANGLE = 0xd6

local ENTITY = 0xd7
local PLAYER = 0xd8

local COLOR = 0xd9

-- this was added in version 2.0.0
-- it's used for arrays that start at 0, I'm not sure if lua 5.1 has same behavior as luajit 2.0.5
-- but luajit 2.0.5 supports starting arrays at 0 index, so checking if table is an array or not gets messed up and output is wrong
-- so if you supply local t = {[0] = 0, 1, 2, 3} and do next(t, #t) it will return (nil, nil) instead of (0, 0)
local ARRAY_ZERO_BASED_INDEX = 0xda

local FREE_FOR_CUSTOM = 0xdb
local FREE_FOR_CUSTOM_END = 0xdf

local NEGATIVE_INT = 0xe0
local NEGATIVE_INT_END = 0xff
---

local encoders = {}
local Encoder = {
    encoders = encoders
}
do
    local pairs = pairs
    local next = next
    local ceil = math.ceil
    local log = math.log
    local concat = table.concat
    local write, write_unsigned, write_double

    -- garry's mod related
    local Vector_Unpack, Angle_Unpack
    local Entity_EntIndex, Player_UserID
    if FindMetaTable then
        Vector_Unpack = FindMetaTable("Vector").Unpack
        Angle_Unpack = FindMetaTable("Angle").Unpack

        Entity_EntIndex = FindMetaTable("Entity").EntIndex
        Player_UserID = FindMetaTable("Player").UserID
    end
    --

    local get_encoder = function(buf, t)
        local encoder = encoders[type(t)]
        if encoder == nil then
            write(buf, "Unsupported type: ")
            write(buf, type(t))
            return nil
        end
        return encoder
    end

    local buffer = {
        [0] = 0 -- buffer length
    }

    -- this function is obviously not jit compiled in luajit 2.0.5 but internal functions are
    function Encoder.encode(val, max_cache_size)
        max_cache_size = max_cache_size or 2000
        buffer[0] = 0

        local encoder = get_encoder(buffer, val)
        if encoder == nil then
            return nil, concat(buffer, nil, buffer[0] - 1, buffer[0])
        end

        if encoder(buffer, val, arg) == true then -- if it returns true, it means there was an error
            -- error is never compiled, so we never error to avoid that
            -- concating in luajit 2.0.5 is NYI, we make sure that all encoders' functions get jit compiled
            return nil, concat(buffer, nil, buffer[0] - 1, buffer[0])
        end

        local result = concat(buffer, nil, 1, buffer[0])

        if #buffer > max_cache_size then
            buffer = {
                [0] = 0 -- buffer length
            }
        end

        return result
    end

    function Encoder.encode_array(arr, len, max_cache_size)
        max_cache_size = max_cache_size or 2000
        buffer[0] = 0

        if encoders.array(buffer, arr, len) == true then -- if it returns true, it means there was an error
            -- error is never compiled, so we never error to avoid that
            -- concating in luajit 2.0.5 is NYI, we make sure that all encoders' functions get jit compiled
            return nil, concat(buffer, nil, buffer[0] - 1, buffer[0])
        end

        local result = concat(buffer, nil, 1, buffer[0])

        if #buffer > max_cache_size then
            buffer = {
                [0] = 0 -- buffer length
            }
        end

        return result
    end

    function write(buf, chr)
        local buf_len = buf[0] + 1
        buf[0] = buf_len
        buf[buf_len] = chr
    end
    Encoder.write = write

    encoders["nil"] = function(buf)
        write(buf, chars[NIL])
    end

    function encoders.boolean(buf, bool)
        if bool == true then
            write(buf, chars[TRUE])
        else
            write(buf, chars[FALSE])
        end
    end

    function encoders.array(buf, arr, len, start_index)
        start_index = (start_index == nil or start_index ~= 0 and start_index ~= 1) and 1 or start_index

        if len < 0 then
            write(buf, "Array size cannot be negative: ")
            write(buf, len)
            return true
        elseif len > 0xFFFFFFFF then
            write(buf, "Array size too large to encode: ")
            write(buf, len)
            return true
        end

        if len <= 0xF then
            write(buf, chars[ARRAY_FIXED + len])
        else
            write_unsigned(buf, ARRAY_8, len)
        end

        if start_index == 0 then
            write(buf, chars[ARRAY_ZERO_BASED_INDEX])
        end

        for idx = start_index, len do
            local val = arr[idx]
            local encoder = get_encoder(buf, val)
            if encoder == nil then return true end
            encoder(buf, val)
        end
    end

    -- we can't check if a table is an array or not because lua tables are not arrays, they are tables
    -- use Encoder.encode_array if you want to encode an array
    function encoders.table(buf, tbl)
        -- check if it's an array, it's not accurate for arrays with holes but better than nothing
        do
            -- this is the fastest possible way, a lot better than cbor's/messagepack's/pon's way of checking if it's an array
            local tbl_len = #tbl
            if tbl_len > 0 and next(tbl, tbl_len) == nil and ((tbl_len == 1 and next(tbl) == 1) or (tbl_len > 1 and next(tbl, tbl_len - 1) == tbl_len)) then
                if tbl[0] ~= nil then
                    return encoders.array(buf, tbl, tbl_len, 0)
                else
                    return encoders.array(buf, tbl, tbl_len)
                end
            end
        end

        local buf_len = buf[0]
        local table_start = buf_len -- we store the start of the table so when we write the table size, we can change the current buffer index to the start of the table
        -- we have no way to get the table size without iterating through it, so we just add 5 empty strings to the buffer as a placeholder
        -- we add 5 empty strings because we don't know if table size is going to be a fixed number, uint8, uint16 or uint32
        -- uint32 takes 5 bytes, so we add 5 empty strings
        do
            for idx = 1, 5 do
                buf[buf_len + idx] = ""
            end
            buf_len = buf_len + 5
            buf[0] = buf_len
        end

        local table_count = 0
        for key, val in pairs(tbl) do
            table_count = table_count + 1

            local encoder_key = get_encoder(buf, key)
            if encoder_key == nil then return true end
            encoder_key(buf, key)

            local encoder_val = get_encoder(buf, val)
            if encoder_val == nil then return true end
            encoder_val(buf, val)
        end

        local table_end = buf[0] -- we store the end of the table because we need to change current buffer index to the start of the table to write the table size
        buf[0] = table_start -- change current buffer index to the start of the table

        -- write the table size
        if table_count <= 0xF then
            write(buf, chars[TABLE_FIXED + table_count])
        else
            if table_count > 0xFFFFFFFF then
                write(buf, "Table size too large to encode: ")
                write(buf, table_count)
                return true
            end
            write_unsigned(buf, TABLE_8, table_count)
        end

        buf[0] = table_end -- change current buffer index back to the end of the table
    end

    function encoders.string(buf, str)
        local str_len = #str
        if str_len > 0xFFFFFFFF then
            write(buf, "String too large to encode: ")
            write(buf, str_len)
            return true
        end

        if str_len <= 0x1F then
            write(buf, chars[STR_FIXED + str_len])
        else
            write_unsigned(buf, STR_8, str_len)
        end
        write(buf, str)
    end

    function encoders.number(buf, num)
        if (num > MAX_NUMBER and num ~= HUGE) or (num < MIN_NUMBER and num ~= -HUGE) then
            write(buf, "Number too large to encode: ")
            write(buf, num)
            return true
        end

        if num % 1 ~= 0 or num > 0xFFFFFFFFFFFFF or num < -0xFFFFFFFFFFFFF then -- DOUBLE
            write_double(buf, DOUBLE, num)
            return
        end

        if num < 0 then
            num = -num
            if num <= 0x1F then
                write(buf, chars[NEGATIVE_INT + num])
            else
                write_unsigned(buf, NINT_8, num)
            end
        else
            if num <= 0x7F then
                write(buf, chars[POSITIVE_INT + num])
            else
                write_unsigned(buf, UINT_8, num)
            end
        end
    end

    function encoders.Vector(buf, vec)
        write(buf, chars[VECTOR])
        local x, y, z = Vector_Unpack(vec)
        encoders.number(buf, x)
        encoders.number(buf, y)
        encoders.number(buf, z)
    end

    function encoders.Angle(buf, ang)
        write(buf, chars[ANGLE])
        local p, y, r = Angle_Unpack(ang)
        encoders.number(buf, p)
        encoders.number(buf, y)
        encoders.number(buf, r)
    end

    function encoders.Entity(buf, ent)
        write(buf, chars[ENTITY])
        encoders.number(buf, Entity_EntIndex(ent))
    end

    function encoders.Player(buf, ply)
        write(buf, chars[PLAYER])
        encoders.number(buf, Player_UserID(ply))
    end

    function encoders.Color(buf, col)
        write(buf, chars[COLOR])
        encoders.number(buf, col.r)
        encoders.number(buf, col.g)
        encoders.number(buf, col.b)
        encoders.number(buf, col.a)
    end

    function write_unsigned(buf, tag, num)
        if num <= 0xFF then -- uint8
            write(buf, chars[tag + 0x00])
            write(buf, chars[num])
        elseif num <= 0xFFFF then -- uint16
            write(buf, chars[tag + 0x01])
            write(buf, chars[floor(num / 256)])
            write(buf, chars[num % 256])
        elseif num <= 0xFFFFFFFF then -- uint32
            write(buf, chars[tag + 0x02])
            write(buf, chars[floor(num / 0x1000000) % 256])
            write(buf, chars[floor(num / 0x10000) % 256])
            write(buf, chars[floor(num / 256) % 256])
            write(buf, chars[num % 256])
        elseif num <= 0xFFFFFFFFFFFFF then -- uint52
            write(buf, chars[tag + 0x3])
            write(buf, chars[num % 256])
            write(buf, chars[floor(num / 256) % 256])
            write(buf, chars[floor(num / 0x10000) % 256])
            write(buf, chars[floor(num / 0x1000000) % 256])
            write(buf, chars[floor(num / 0x100000000) % 256])
            write(buf, chars[floor(num / 0x10000000000) % 256])
            write(buf, chars[floor(num / 0x1000000000000) % 256])
        end
    end
    Encoder.write_unsigned = write_unsigned

    -- i can't remember where i got this from, but it's not mine (i swear i always credit people)
    local log2 = log(2)
    function write_double(buf, tag, value)
        local abs_value = value < 0 and -value or value
        --IEEE double-precision floating point number
        --Specification: https://en.wikipedia.org/wiki/Double-precision_floating-point_format
        --Separate out the sign, exponent and fraction
        local sign = value < 0 and 1 or 0
        local exponent = ceil(log(abs_value) / log2) - 1
        local fraction = abs_value / (2 ^ exponent) - 1
        --Make sure the exponent stays in range - allowed values are -1023 through 1024
        if exponent < -1023 then
            --We allow this case for subnormal numbers and just clamp the exponent and re-calculate the fraction
            --without the offset of 1
            exponent = -1023
            fraction = abs_value / (2 ^ exponent)
        elseif abs_value ~= HUGE and exponent > 1024 then
            write(buf, "Exponent out of range: ")
            write(buf, value)
            return true
        end

        --Handle special cases
        if value == 0 then
            --Zero
            exponent = -1023
            fraction = 0
        elseif abs_value == HUGE then
            --Infinity
            exponent = 1024
            fraction = 0
        elseif value ~= value then
            --NaN
            exponent = 1024
            fraction = 1
        end

        local exp_out = exponent + 1023
        local fraction_out = fraction * 0x10000000000000

        write(buf, chars[tag])
        write(buf, chars[128 * sign + floor(exp_out / 16)])
        write(buf, chars[(exp_out % 16) * 16 + floor(fraction_out / 0x1000000000000)])
        write(buf, chars[floor(fraction_out / 0x10000000000) % 256])
        write(buf, chars[floor(fraction_out / 0x100000000) % 256])
        write(buf, chars[floor(fraction_out / 0x1000000) % 256])
        write(buf, chars[floor(fraction_out / 0x10000) % 256])
        write(buf, chars[floor(fraction_out / 0x100) % 256])
        write(buf, chars[floor(fraction_out % 256)])
    end
    Encoder.write_double = write_double
end

local decoders = {}
local Decoder = {
    decoders = decoders
}
do
    local sub = string.sub

    local read_type, read_byte, read_word, read_dword
    local decode_array, decode_table, decode_string, decode_double

    -- garry's mod related
    local Vector, Angle, Entity, Player, Color = Vector, Angle, Entity, Player, Color
    --

    local str_byte = string.byte
    local byte = function(ctx, size)
        local index = ctx[1]
        if index + size - 1 > ctx[3] then -- buffer length
            return nil, "Attemped to read beyond buffer size"
        elseif index + size - 1 > ctx[4] then -- max size
            return nil, "Max decode size exceeded"
        end
        ctx[1] = index + size
        return str_byte(ctx[2], index, index + size - 1)
    end
    Decoder.byte = byte

    local get_decoder = function(ctx)
        local t = read_type(ctx)
        local decoder = decoders[t]
        if decoder == nil then
            return nil, "Unsupported type: ", t
        end
        return decoder
    end
    Decoder.get_decoder = get_decoder

    local context = {
        1,  -- index
        "", -- buffer
        0,  -- buffer length
        HUGE, -- max size for decode, useful when decoding from user input that was sent over netmessages
    }

    local decode = function()
        if context[3] < 1 then -- this will make string.byte fail
            return nil, "Buffer is empty"
        end

        local err, err_2
        local decoder
        local val

        decoder, err, err_2 = get_decoder(context)
        if err ~= nil then
            return nil, err, err_2
        end

        val, err, err_2 = decoder(context)
        if err ~= nil then
            return nil, err, err_2
        end

        return val
    end

    function Decoder.decode(str)
        if type(str) ~= "string" then
            return nil, "str is not a string", str
        end

        context[1] = 1
        context[2] = str
        context[3] = #str
        context[4] = HUGE

        return decode()
    end

    function Decoder.decode_with_max_size(str, max_size)
        if type(str) ~= "string" then
            return nil, "str is not a string", str
        end

        if type(max_size) ~= "number" then
            return nil, "max_size is not a number", max_size
        end

        if max_size < 0 then
            return nil, "max_size can either be a positive number or math.huge for unlimited", max_size
        end

        context[1] = 1
        context[2] = str
        context[3] = #str
        context[4] = max_size

        return decode()
    end

    decoders[NIL] = function(ctx)
        ctx[1] = ctx[1] + 1
        return nil
    end

    decoders[FALSE] = function(ctx)
        ctx[1] = ctx[1] + 1
        return false
    end

    decoders[TRUE] = function(ctx)
        ctx[1] = ctx[1] + 1
        return true
    end

    --
    decoders[ARRAY_FIXED] = function(ctx)
        local bty, err = read_byte(ctx)
        if bty == nil then
            return nil, err
        end
        local len = bty - ARRAY_FIXED
        return decode_array(ctx, len)
    end

    for i = ARRAY_FIXED + 1, ARRAY_FIXED_END do
        decoders[i] = decoders[ARRAY_FIXED]
    end
    --

    decoders[ARRAY_8] = function(ctx)
        ctx[1] = ctx[1] + 1
        local len, err = read_byte(ctx)
        if len == nil then
            return nil, err
        end
        return decode_array(ctx, len)
    end

    decoders[ARRAY_16] = function(ctx)
        ctx[1] = ctx[1] + 1
        local len, err = read_word(ctx)
        if err ~= nil then
            return nil, err
        end
        return decode_array(ctx, len)
    end

    decoders[ARRAY_32] = function(ctx)
        ctx[1] = ctx[1] + 1
        local len, err = read_dword(ctx)
        if err ~= nil then
            return nil, err
        end
        return decode_array(ctx, len)
    end

    --
    decoders[TABLE_FIXED] = function(ctx)
        local bty, err = read_byte(ctx)
        if bty == nil then
            return nil, err
        end
        local len = bty - TABLE_FIXED
        return decode_table(ctx, len)
    end

    for i = TABLE_FIXED + 1, TABLE_FIXED_END do
        decoders[i] = decoders[TABLE_FIXED]
    end
    --

    decoders[TABLE_8] = function(ctx)
        ctx[1] = ctx[1] + 1
        local len, err = read_byte(ctx)
        if err ~= nil then
            return nil, err
        end
        return decode_table(ctx, len)
    end

    decoders[TABLE_16] = function(ctx)
        ctx[1] = ctx[1] + 1
        local len, err = read_word(ctx)
        if err ~= nil then
            return nil, err
        end
        return decode_table(ctx, len)
    end

    decoders[TABLE_32] = function(ctx)
        ctx[1] = ctx[1] + 1
        local len, err = read_dword(ctx)
        if err ~= nil then
            return nil, err
        end
        return decode_table(ctx, len)
    end

    --
    decoders[STR_FIXED] = function(ctx)
        local bty, err = read_byte(ctx)
        if err ~= nil then
            return nil, err
        end
        local len = bty - STR_FIXED
        return decode_string(ctx, len)
    end

    for i = STR_FIXED + 1, STR_FIXED_END do
        decoders[i] = decoders[STR_FIXED]
    end
    --

    decoders[STR_8] = function(ctx)
        ctx[1] = ctx[1] + 1
        local len, err = read_byte(ctx)
        if err ~= nil then
            return nil, err
        end
        return decode_string(ctx, len)
    end

    decoders[STR_16] = function(ctx)
        ctx[1] = ctx[1] + 1
        local len, err = read_word(ctx)
        if err ~= nil then
            return nil, err
        end
        return decode_string(ctx, len)
    end

    decoders[STR_32] = function(ctx)
        ctx[1] = ctx[1] + 1
        local len, err = read_dword(ctx)
        if err ~= nil then
            return nil, err
        end
        return decode_string(ctx, len)
    end

    --
    decoders[POSITIVE_INT] = function(ctx)
        local bty, err = read_byte(ctx)
        if err ~= nil then
            return nil, err
        end
        return bty - POSITIVE_INT
    end

    for i = POSITIVE_INT + 1, POSITIVE_INT_END do
        decoders[i] = decoders[POSITIVE_INT]
    end
    --

    decoders[UINT_8] = function(ctx)
        ctx[1] = ctx[1] + 1
        local u8, err = read_byte(ctx)
        if err ~= nil then
            return nil, err
        end
        return u8
    end

    decoders[UINT_16] = function(ctx)
        ctx[1] = ctx[1] + 1
        local u16, err = read_word(ctx)
        if err ~= nil then
            return nil, err
        end
        return u16
    end

    decoders[UINT_32] = function(ctx)
        ctx[1] = ctx[1] + 1
        local u32, err = read_dword(ctx)
        if err ~= nil then
            return nil, err
        end
        return u32
    end

    decoders[UINT_52] = function(ctx)
        ctx[1] = ctx[1] + 1
        local b1, b2, b3, b4, b5, b6, b7 = byte(ctx, 7)
        if b1 == nil then
            return nil, b2
        end
        return b1 + (b2 * 0x100) + (b3 * 0x10000) + (b4 * 0x1000000) + (b5 * 0x100000000) + (b6 * 0x10000000000) + (b7 * 0x1000000000000)
    end

    --
    decoders[NEGATIVE_INT] = function(ctx)
        local bty, err = read_byte(ctx)
        if bty == nil then
            return nil, err
        end
        return NEGATIVE_INT - bty
    end

    for i = NEGATIVE_INT + 1, NEGATIVE_INT_END do
        decoders[i] = decoders[NEGATIVE_INT]
    end
    --

    decoders[NINT_8] = function(ctx)
        ctx[1] = ctx[1] + 1
        local n8, err = read_byte(ctx)
        if n8 == nil then
            return nil, err
        end
        return -n8
    end

    decoders[NINT_16] = function(ctx)
        ctx[1] = ctx[1] + 1
        local n16, err = read_word(ctx)
        if err ~= nil then
            return nil, err
        end
        return -n16
    end

    decoders[NINT_32] = function(ctx)
        ctx[1] = ctx[1] + 1
        local n32, err = read_dword(ctx)
        if err ~= nil then
            return nil, err
        end
        return -n32
    end

    decoders[NINT_52] = function(ctx)
        ctx[1] = ctx[1] + 1
        local b1, b2, b3, b4, b5, b6, b7 = byte(ctx, 7)
        if b1 == nil then
            return nil, b2
        end
        return -(b1 + (b2 * 0x100) + (b3 * 0x10000) + (b4 * 0x1000000) + (b5 * 0x100000000) + (b6 * 0x10000000000) + (b7 * 0x1000000000000))
    end

    decoders[DOUBLE] = function(ctx)
        ctx[1] = ctx[1] + 1
        return decode_double(ctx)
    end

    decoders[VECTOR] = function(ctx)
        ctx[1] = ctx[1] + 1

        local err, err_2
        local decoder
        local x, y, z

        -- x
        decoder, err, err_2 = get_decoder(ctx)
        if err ~= nil then
            return nil, err, err_2
        end

        x, err = decoder(ctx)
        if err ~= nil then
            return nil, err
        end
        --

        -- y
        decoder, err, err_2 = get_decoder(ctx)
        if err ~= nil then
            return nil, err, err_2
        end

        y, err = decoder(ctx)
        if err ~= nil then
            return nil, err
        end
        --

        -- z
        decoder, err, err_2 = get_decoder(ctx)
        if err ~= nil then
            return nil, err, err_2
        end

        z, err = decoder(ctx)
        if err ~= nil then
            return nil, err
        end
        --

        return Vector(x, y, z)
    end

    decoders[ANGLE] = function(ctx)
        ctx[1] = ctx[1] + 1

        local err, err_2
        local decoder
        local p, y, r

        -- p
        decoder, err, err_2 = get_decoder(ctx)
        if err ~= nil then
            return nil, err, err_2
        end

        p, err = decoder(ctx)
        if err ~= nil then
            return nil, err
        end
        --

        -- y
        decoder, err, err_2 = get_decoder(ctx)
        if err ~= nil then
            return nil, err, err_2
        end

        y, err = decoder(ctx)
        if err ~= nil then
            return nil, err
        end
        --

        -- r
        decoder, err, err_2 = get_decoder(ctx)
        if err ~= nil then
            return nil, err, err_2
        end

        r, err = decoder(ctx)
        if err ~= nil then
            return nil, err
        end
        --

        return Angle(p, y, r)
    end

    decoders[ENTITY] = function(ctx)
        ctx[1] = ctx[1] + 1

        local err, err_2
        local decoder
        local ent_index

        decoder, err, err_2 = get_decoder(ctx)
        if err ~= nil then
            return nil, err, err_2
        end

        ent_index, err = decoder(ctx)
        if err ~= nil then
            return nil, err
        end

        return Entity(ent_index)
    end

    decoders[PLAYER] = function(ctx)
        ctx[1] = ctx[1] + 1

        local err, err_2
        local decoder
        local user_id

        decoder, err, err_2 = get_decoder(ctx)
        if err ~= nil then
            return nil, err, err_2
        end

        user_id, err = decoder(ctx)
        if err ~= nil then
            return nil, err
        end

        return Player(user_id)
    end

    decoders[COLOR] = function(ctx)
        ctx[1] = ctx[1] + 1

        local err, err_2
        local decoder
        local r, g, b, a

        -- r
        decoder, err, err_2 = get_decoder(ctx)
        if err ~= nil then
            return nil, err, err_2
        end

        r, err = decoder(ctx)
        if err ~= nil then
            return nil, err
        end
        --

        -- g
        decoder, err, err_2 = get_decoder(ctx)
        if err ~= nil then
            return nil, err, err_2
        end

        g, err = decoder(ctx)
        if err ~= nil then
            return nil, err
        end
        --

        -- b
        decoder, err, err_2 = get_decoder(ctx)
        if err ~= nil then
            return nil, err, err_2
        end

        b, err = decoder(ctx)
        if err ~= nil then
            return nil, err
        end
        --

        -- a
        decoder, err, err_2 = get_decoder(ctx)
        if err ~= nil then
            return nil, err, err_2
        end

        a, err = decoder(ctx)
        if err ~= nil then
            return nil, err
        end
        --

        return Color(r, g, b, a)
    end

    function decode_array(ctx, len)
        -- zzzzz no table.new or table.setn, we try to allocate small space to avoid table resizing for small tables
        local arr = {nil, nil, nil, nil, nil, nil, nil, nil}

        local start_index = 1
        if read_type(ctx) == ARRAY_ZERO_BASED_INDEX then
            ctx[1] = ctx[1] + 1
            start_index = 0
        end

        for idx = start_index, len do
            local err, err_2
            local decoder
            local val

            decoder, err, err_2 = get_decoder(ctx)
            if err ~= nil then
                return nil, err, err_2
            end

            val, err = decoder(ctx)
            if err ~= nil then
                return nil, err
            end

            arr[idx] = val
        end

        return arr
    end
    Decoder.decode_array = decode_array

    function decode_table(ctx, len)
        local err, err_2
        local decoder
        local key, val

        -- zzzzz no table.new or table.setn, we try to allocate small space to avoid table resizing for small tables
        local tbl = {nil, nil, nil, nil, nil, nil, nil, nil}
        for _ = 1, len do
            -- key
            decoder, err, err_2 = get_decoder(ctx)
            if err ~= nil then
                return nil, err, err_2
            end

            key, err = decoder(ctx)
            if err ~= nil then
                return nil, err
            end
            --

            -- val
            decoder, err, err_2 = get_decoder(ctx)
            if err ~= nil then
                return nil, err, err_2
            end

            val, err = decoder(ctx)
            if err ~= nil then
                return nil, err
            end
            --

            tbl[key] = val
        end

        return tbl
    end
    Decoder.decode_table = decode_table

    function decode_string(ctx, len)
        local index = ctx[1]
        if index + len - 1 > ctx[3] then
            return nil, "Attemped to read beyond buffer size"
        elseif index + len - 1 > ctx[4] then
            return nil, "Max decode size exceeded"
        end

        ctx[1] = index + len

        return sub(ctx[2], index, index + len - 1)
    end
    Decoder.decode_string = decode_string

    function decode_double(ctx)
        local b1, b2, b3, b4, b5, b6, b7, b8 = byte(ctx, 8)
        if b1 == nil then
            return nil, b2
        end

        --Separate out the values
        local sign = b1 >= 128 and 1 or 0
        local exponent = (b1 % 128) * 16 + floor(b2 / 16)
        local fraction = (b2 % 16) * 0x1000000000000 + b3 * 0x10000000000 + b4 * 0x100000000 + b5 * 0x1000000 + b6 * 0x10000 + b7 * 0x100 + b8
        --Handle special cases
        if exponent == 2047 then
            --Infinities
            if fraction == 0 then return ((sign == 0 and 1) or -1) * HUGE end
            --NaN
            if fraction == 0xfffffffffffff then return 0 / 0 end
        end

        --Combine the values and return the result
        if exponent == 0 then
            --Handle subnormal numbers
            return ((sign == 0 and 1) or -1) * (2 ^ (exponent - 1023)) * (fraction / 0x10000000000000)
        else
            --Handle normal numbers
            return ((sign == 0 and 1) or -1) * (2 ^ (exponent - 1023)) * ((fraction / 0x10000000000000) + 1)
        end
    end
    Decoder.decode_double = decode_double

    function read_type(ctx)
        local typ = str_byte(ctx[2], ctx[1])
        return typ
    end
    Decoder.read_type = read_type

    function read_byte(ctx)
        local bty, err = byte(ctx, 1)
        if bty == nil then
            return nil, err
        end
        return bty
    end
    Decoder.read_byte = read_byte

    function read_word(ctx)
        local b1, b2 = byte(ctx, 2)
        if b1 == nil then
            return nil, b2
        end
        return b1 * 0x100 + b2
    end
    Decoder.read_word = read_word

    function read_dword(ctx)
        local b1, b2, b3, b4 = byte(ctx, 4)
        if b1 == nil then
            return nil, b2
        end
        return b1 * 0x1000000 + b2 * 0x10000 + b3 * 0x100 + b4
    end
    Decoder.read_dword = read_dword
end

return {
    Encoder = Encoder, -- to allow usage of internal functions
    Decoder = Decoder, -- to allow usage of internal functions

    encode = Encoder.encode,
    encode_with_buffer = Encoder.encode_with_buffer,
    encode_array = Encoder.encode_array,

    decode = Decoder.decode,
    decode_with_max_size = Decoder.decode_with_max_size,

    set_type_function = function(t_fn) -- this is for me as I have custom type function in sam/scb to allow type function to get jit compiled :c
        type = t_fn
    end,

    add_encoder = function(typ, encoder)
        encoders[typ] = encoder
        if FREE_FOR_CUSTOM == FREE_FOR_CUSTOM_END then
            return nil, "No more free slots for custom encoders"
        end
        FREE_FOR_CUSTOM = FREE_FOR_CUSTOM + 1
        return FREE_FOR_CUSTOM - 1
    end,

    add_decoder = function(typ, decoder)
        decoders[typ] = decoder
    end,

    chars = chars,
    VERSION = "2.0.8"
}

--addons/sam-159/lua/sam/libs/sh_netstream.lua:
if SAM_LOADED then return end

--[[
	NetStream - 2.0.1
	https://github.com/alexgrist/NetStream/blob/master/netstream2.lua

	Alexander Grist-Hucker
	http://www.revotech.org
]]--

--[[
	if SERVER then
		netstream.Hook("Hi", function(ply, ...) -- Third argument is called to check if the player has permission to send the net message before decoding
			print(...)
		end, function(ply)
			if not ply:IsAdmin() then
				return false
			end
		end)
		-- OR
		netstream.Hook("Hi", function(ply, ...)
			print(...)
		end)
		netstream.Start(Entity(1), "Hi", "a", 1, {}, true, false, nil, "!") -- First argument player or table of players or any other argument to send to all players
		netstream.Start({Entity(1), Entity(2)}, "Hi", "a", 1, {}, true, false, nil, "!")
		netstream.Start(nil, "Hi", "a", 1, {}, true, false, nil, "!")
	end
	if CLIENT then
		netstream.Hook("Hi", function(...)
			print(...)
		end)
		netstream.Start("Hi", "a", 1, {}, true, false, nil, "!")
	end
]]--

-- Config

local addonName = "SAM"
local mainTable = sam -- _G.netstream = netstream

local sfs = sam.sfs
local encode_array = sfs.encode_array
local decode = sfs.decode

--

local type = sam.type
local unpack = unpack

local net = net
local compress = util.Compress
local decompress = util.Decompress

local netStreamSend = addonName .. ".NetStreamDS.Sending"

local netstream = {}
if istable(mainTable) then
	mainTable.netstream = netstream
end

local checks = {}
local receivers = {}

if SERVER then
	util.AddNetworkString(netStreamSend)

	local player_GetAll = player.GetAll
	function netstream.Start(ply, name, ...)
		if #name > 31 then
			error("netstream.Start name too long")
		end

		local ply_type = type(ply)
		if ply_type ~= "Player" and ply_type ~= "table" then
			ply = player_GetAll()
		end

		local array_length = select("#", ...)
		local encoded_data = encode_array({name, array_length, ...}, array_length + 2)

		net.Start(netStreamSend)
			net.WriteBool(false)
			net.WriteData(encoded_data)
		net.Send(ply)
	end

	function netstream.StartCompressed(ply, name, ...)
		if #name > 31 then
			error("netstream.Start name too long")
		end

		local ply_type = type(ply)
		if ply_type ~= "Player" and ply_type ~= "table" then
			ply = player_GetAll()
		end

		local array_length = select("#", ...)
		local encoded_data = encode_array({name, array_length, ...}, array_length + 2)

		local compressed_data = compress(encoded_data)

		net.Start(netStreamSend)
			net.WriteBool(true)
			net.WriteData(compressed_data)
		net.Send(ply)
	end

	function netstream.Hook(name, callback, check)
		if #name > 31 then
			error("netstream.Hook name too long")
		end

		receivers[name] = callback
		if type(check) == "function" then
			checks[name] = check
		end
	end

	net.Receive(netStreamSend, function(_, ply)
		local name = net.ReadString()

		local callback = receivers[name]
		if not callback then return end

		local length = net.ReadUInt(16)

		local check = checks[name]
		if check and check(ply, length) == false then return end

		local binary_data = net.ReadData(length)

		local decoded_data = decode(binary_data)
		if type(decoded_data) ~= "table" then return end

		local array_length = decoded_data[1]
		if type(array_length) ~= "number" then return end
		if array_length < 0 then return end

		callback(ply, unpack(decoded_data, 2, array_length + 1))
	end)
else
	checks = nil

	function netstream.Start(name, ...)
		if #name > 31 then
			error("netstream.Start name too long")
		end

		local array_length = select("#", ...)
		local encoded_data = encode_array({array_length, ...}, array_length + 1)

		local length = #encoded_data

		net.Start(netStreamSend)
			net.WriteString(name)
			net.WriteUInt(length, 16)
			net.WriteData(encoded_data, length)
		net.SendToServer()
	end

	function netstream.Hook(name, callback)
		receivers[name] = callback
	end

	net.Receive(netStreamSend, function(len)
		local compressed = net.ReadBool()
		local binary_data = net.ReadData((len - 1) / 8)

		if compressed then
			binary_data = decompress(binary_data)
			if not binary_data then return end
		end

		local decoded_data, err, err2 = decode(binary_data)
		if err ~= nil then
			sam.print("NetStream error: " .. err .. err2)
			return
		end

		local name = decoded_data[1]

		local callback = receivers[name]
		if not callback then return end

		callback(unpack(decoded_data, 3, decoded_data[2] + 2))
	end)
end

return netstream

--addons/sam-159/lua/sam/sh_permissions.lua:
if SAM_LOADED then return end

local permissions = {}

local give_permission
if SERVER then
	local permissions_to_add = {}

	give_permission = function(name, permission)
		if sam.ranks.ranks_loaded() then
			local rank = sam.ranks.get_rank(name)
			if rank and rank.data.permissions[permission] == nil then
				sam.ranks.give_permission(name, permission)
			end
		else
			table.insert(permissions_to_add, {name, permission})
		end
	end

	hook.Add("SAM.LoadedRanks", "SAM.Command.GivePermissions", function()
		for k, v in ipairs(permissions_to_add) do
			give_permission(v[1], v[2])
		end
	end)
end

local get_next_Other = function()
	for i, v in ipairs(permissions) do
		if v.category == "Other" then
			return i
		end
	end
	return #permissions + 1
end

function sam.permissions.add(permission, category, rank)
	if not sam.isstring(category) then
		category = "Other"
	end

	local permission_data = {
		name = permission,
		category = category,
		rank = rank,
		value = value
	}

	local index = sam.permissions.get_index(permission)
	if not index then
		if category ~= "Other" then
			table.insert(permissions, get_next_Other(), permission_data)
		else
			table.insert(permissions, permission_data)
		end
		hook.Call("SAM.AddedPermission", nil, permission, category, rank, value)
	else
		permissions[index] = permission_data
		hook.Call("SAM.PermissionModified", nil, permission, category, rank, value)
	end

	if SERVER and rank then
		give_permission(rank, permission)
	end
end

function sam.permissions.get_index(permission)
	for i, v in ipairs(permissions) do
		if v.name == permission then
			return i
		end
	end
end

function sam.permissions.remove(permission)
	local index = sam.permissions.get_index(permission)
	if index then
		table.remove(permissions, index)
		hook.Call("SAM.RemovedPermission", nil, permission)
	end
end

function sam.permissions.exists(permission)
	return sam.permissions.get_index(permission) and true or false
end

function sam.permissions.get()
	return permissions
end
--addons/sam-159/lua/sam/config/cl_config.lua:
return gluapack()()
--addons/sui/lua/sui/libs/bshadows.lua:
return gluapack()()
--addons/sui/lua/sui/libs/gif_loader.lua:
return gluapack()()
--addons/sui/lua/sui/vgui/sui_label.lua:
return gluapack()()
--addons/sui/lua/sui/vgui/sui_property_sheet.lua:
local draw = draw
local surface = surface
local vgui = vgui

local TYPE_MATERIAL = TYPE_MATERIAL

local RealFrameTime = RealFrameTime
local IsValid = IsValid
local Lerp = Lerp
local pairs = pairs
local TypeID = TypeID

local TDLib_Classes = sui.TDLib.LibClasses
local TextColor = TDLib_Classes.TextColor
local SUI, NAME = CURRENT_SUI, CURRENT_SUI.name

local PROPERTY_SHEET_FONT = SUI.CreateFont("PropertySheet", "Roboto Regular", 18)

local PANEL = {}

AccessorFunc(PANEL, "m_FontName", "Font", FORCE_STRING)

function PANEL:Init()
	self.tabs = {}

	self:SetFont(PROPERTY_SHEET_FONT)

	local tab_scroller = self:Add("DHorizontalScroller")
	tab_scroller:Dock(TOP)

	self.tabs_tall = 26
	self.tab_scroller = tab_scroller

	self:ScaleChanged()
	SUI.OnScaleChanged(self, self.ScaleChanged)
end

function PANEL:ScaleChanged()
	self.tab_scroller:SetTall(SUI.Scale(self.tabs_tall))

	for k, v in pairs(self.tab_scroller.Panels) do
		if v:IsValid() then
			if v.Material then
				v:SetWide(self.tab_scroller:GetTall())
			else
				v:SizeToContentsX()
			end
		end
	end

	self:InvalidateLayout(true)
end

function PANEL:Paint(w, h)
	self:RoundedBox("Background", 1, 0, 0, w, self.tab_scroller:GetTall(), SUI.GetColor("property_sheet_bg"))
end

function PANEL:PaintOver(w, h)
	local active_tab = self:GetActiveTab()
	if not IsValid(active_tab) then return end

	local tab_scroller = self.tab_scroller
	local offset = tab_scroller:GetTall() - SUI.Scale(1)

	local x = active_tab:LocalToScreen(0) - self:LocalToScreen(0)

	if not self.activeTabX then
		self.activeTabX = x
		self.activeTabW = active_tab:GetWide()
	end

	local delta = RealFrameTime() * 6
	if delta then
		self.activeTabX = Lerp(delta, self.activeTabX, x)
		self.activeTabW = Lerp(delta, self.activeTabW, active_tab:GetWide())
	end

	self:RoundedBox("Background2", 1, self.activeTabX, tab_scroller.y + offset, self.activeTabW, SUI.Scale(1), SUI.GetColor("property_sheet_tab_active"))
end

local tab_Paint = function(s, w, h)
	s.circle_click_color = SUI.GetColor("property_sheet_tab_click")
	if s.property_sheet:GetActiveTab() == s then
		TextColor(s, SUI.GetColor("property_sheet_tab_active"))
	else
		TextColor(s, SUI.GetColor("property_sheet_tab"))
	end
end

local tab_DoClick = function(s)
	s.parent:SetActiveTab(s)
end

local image_paint = function(s, w, h)
	surface.SetDrawColor(color_white)
	surface.SetMaterial(s.Material)
	surface.DrawTexturedRectRotated(w * 0.5, h * 0.5, w - 10, h - 10, 0)
end

function PANEL:AddSheet(name, load_func)
	local tab = vgui.Create("DButton")
	if TypeID(name) == TYPE_MATERIAL then
		tab:SetText("")
		tab.Material = name
		tab.Paint = image_paint
		tab:SetWide(self.tab_scroller:GetTall())
	else
		tab:SetFont(self:GetFont())
		tab:SetText(name)
		tab:SetTextInset(10, 0)
		tab:SizeToContentsX()

		tab.Paint = tab_Paint
	end

	tab.parent = self
	tab.DoClick = tab_DoClick

	tab.load_func = load_func
	tab.property_sheet = self

	tab.On = TDLib_Classes.On
	TDLib_Classes.CircleClick(tab)

	self.tab_scroller:AddPanel(tab)

	if not self:GetActiveTab() then
		self:SetActiveTab(tab)
	end

	table.insert(self.tabs, tab)

	return tab
end

function PANEL:GetActiveTab()
	return self.active_tab
end

function PANEL:SetActiveTab(new_tab)
	if IsValid(new_tab) and not IsValid(new_tab.panel) then
		local panel = new_tab.load_func(self)
		panel:SetParent(self)
		panel:SetVisible(false)

		panel.tab = new_tab
		new_tab.panel = panel
	end

	if self.active_tab and IsValid(self.active_tab.panel) then
		self.active_tab.panel:SetVisible(false)
	end

	if IsValid(new_tab) then
		new_tab.panel:SetVisible(true)
	end

	self.active_tab = new_tab
end

sui.register("PropertySheet", PANEL, "EditablePanel")
--addons/sui/lua/sui/vgui/sui_slider.lua:
return gluapack()()
--addons/sui/lua/sui/vgui/sui_zcollapse_category.lua:
return gluapack()()
--addons/sam-159/lua/sam/menu/tabs/config.lua:
if SAM_LOADED then return end

local sam = sam
local config = sam.config

local tabs = {}
if CLIENT then
	function config.add_tab(name, func, check, pos)
		local tab = {
			name = name,
			func = func,
			check = check,
			pos = pos
		}
		for k, v in ipairs(tabs) do
			if v.name == name then
				tabs[k] = tab
				return
			end
		end
		table.insert(tabs, tab)
	end
end

for _, f in ipairs(file.Find("sam/menu/tabs/config/*.lua", "LUA")) do
	sam.load_file("sam/menu/tabs/config/" .. f, "cl_")
end

if SERVER then return end

local SUI = sam.SUI
local GetColor = SUI.GetColor
local Line = sui.TDLib.LibClasses.Line

sam.menu.add_tab("https://raw.githubusercontent.com/Srlion/Addons-Data/main/icons/sam/config.png", function(column_sheet)
	local tab_body = column_sheet:Add("Panel")
	tab_body:Dock(FILL)
	tab_body:DockMargin(0, 1, 0, 0)

	do
		local title = tab_body:Add("SAM.Label")
		title:Dock(TOP)
		title:DockMargin(10, 10, 0, 0)
		title:SetFont(SAM_TAB_TITLE_FONT)
		title:SetText("Config")
		title:SetTextColor(GetColor("menu_tabs_title"))
		title:SizeToContents()

		local total = tab_body:Add("SAM.Label")
		total:Dock(TOP)
		total:DockMargin(10, 6, 0, 0)
		total:SetFont(SAM_TAB_DESC_FONT)
		total:SetText("Some settings may require a server restart")
		total:SetTextColor(GetColor("menu_tabs_title"))
		total:SetPos(10, SUI.Scale(40))
		total:SizeToContents()
	end

	local body = tab_body:Add("Panel")
	body:Dock(FILL)
	body:DockMargin(10, 5, 10, 10)

	Line(body, nil, 0, 0, 0, 10)

	local sheet = body:Add("SAM.PropertySheet")
	sheet:Dock(FILL)
	sheet:InvalidateParent(true)
	sheet:InvalidateLayout(true)

	local sheets = {}
	for _, v in SortedPairsByMemberValue(tabs, "pos") do
		sheets[v.name] = sheet:AddSheet(v.name, v.func)
	end

	local tab_scroller = sheet.tab_scroller:GetCanvas()
	function tab_body.Think()
		for _, v in ipairs(tabs) do
			local tab = sheets[v.name]
			if v.check and not v.check() then
				if tab:IsVisible() then
					tab:SetVisible(false)
					if sheet:GetActiveTab() == tab then
						sheet:SetActiveTab(sheet.tabs[1])
					end
					tab_scroller:InvalidateLayout()
				end
			elseif not tab:IsVisible() then
				tab:SetVisible(true)
				tab_scroller:InvalidateLayout()
			end
		end
	end

	return tab_body
end, function()
	return LocalPlayer():HasPermission("manage_config")
end, 5)
--addons/sam-159/lua/sam/menu/tabs/players.lua:
if SAM_LOADED then return end

local sam = sam
local SQL = sam.SQL
local SUI = sam.SUI
local netstream = sam.netstream

sam.permissions.add("manage_players", nil, "superadmin")

local get_pages_count = function(count)
	count = count / 35
	local i2 = math.floor(count)
	return count ~= i2 and i2 + 1 or count
end

if SERVER then
	local check = function(ply)
		return ply:HasPermission("manage_players") and ply:sam_check_cooldown("MenuViewPlayers", 0.1)
	end

	local limit = 35

	local get_page_count = function(callback, res, page, column, order_by, sort_by, keyword)
		local query = [[
			SELECT
				COUNT(`steamid`) AS `count`
			FROM
				`sam_players`]]
		if keyword then
			if column == "steamid" and sam.is_steamid64(keyword) then
				keyword = util.SteamIDFrom64(keyword)
			end

			query = string.format("%s WHERE `%s` LIKE %s", query, column, SQL.Escape("%" .. keyword .. "%"))
		end
		SQL.Query(query, callback, true, {res, page, column, order_by, sort_by, keyword})
	end

	local valid_columns = {
		steamid = true,
		name = true,
		rank = true
	}

	local valid_sorts = {
		id = true,
		name = true,
		rank = true,
		play_time = true,
		last_join = true
	}

	local resolve_promise = function(data, arguments)
		local res = arguments[1]
		arguments[1] = data
		res(arguments)
	end

	local get_players = function(count_data, arguments)
		local res, page, column, order_by, sort_by, keyword = unpack(arguments)
		local count = count_data.count

		local current_page
		if page < 1 then
			page, current_page = 1, 1
		end

		local pages_count = get_pages_count(count)
		if page > pages_count then
			page, current_page = pages_count, pages_count
		end

		local query = [[
			SELECT
				`steamid`,
				`name`,
				`rank`,
				`expiry_date`,
				`first_join`,
				`last_join`,
				`play_time`
			FROM
				`sam_players`
		]]

		local args = {}

		if keyword then
			args[1] = column
			args[2] = "%" .. keyword .. "%"

			query = query .. [[
				WHERE
					`{1f}` LIKE {2}
			]]
		end

		args[3] = sort_by
		if order_by == "DESC" then
			query = query .. [[
				ORDER BY `{3f}` DESC
			]]
		else
			query = query .. [[
				ORDER BY `{3f}` ASC
			]]
		end

		args[4] = limit
		args[5] = math.abs(limit * (page - 1))

		query = query .. [[
			LIMIT {4} OFFSET {5}
		]]

		SQL.FQuery(query, args, resolve_promise, false, {res, count, current_page})
	end

	netstream.async.Hook("SAM.GetPlayers", function(res, ply, page, column, order_by, sort_by, keyword)
		if not isnumber(page) then return end
		if not valid_columns[column] then return end
		if order_by ~= "ASC" and order_by ~= "DESC" then return end
		if not valid_sorts[sort_by] then return end
		if keyword ~= nil and not sam.isstring(keyword) then return end

		get_page_count(get_players, res, page, column, order_by, sort_by, keyword)
	end, check)

	return
end

local GetColor = SUI.GetColor
local Line = sui.TDLib.LibClasses.Line

local COLUMN_FONT = SUI.CreateFont("Column", "Roboto", 18)
local LINE_FONT = SUI.CreateFont("Line", "Roboto", 16)
local NEXT_FONT = SUI.CreateFont("NextButton", "Roboto", 18)

local button_click = function(s)
	local v = s.v

	local dmenu = vgui.Create("SAM.Menu")
	dmenu:SetInternal(s)
	if v.name and v.name ~= "" then
		dmenu:AddOption("Copy Name", function()
			SetClipboardText(v.name)
		end)
	end

	dmenu:AddOption("Copy SteamID", function()
		SetClipboardText(v.steamid)
	end)

	dmenu:AddOption("Copy Rank", function()
		SetClipboardText(v.rank)
	end)

	dmenu:AddOption("Copy Play Time", function()
		SetClipboardText(sam.reverse_parse_length(tonumber(v.play_time) / 60))
	end)

	dmenu:AddSpacer()

	dmenu:AddOption("Change Rank", function()
		local querybox = vgui.Create("SAM.QueryBox")
		querybox:SetTitle(string.format("Change rank for '%s'", v.name or v.steamid))
		querybox:SetWide(360)

		local ranks = querybox:Add("SAM.ComboBox")
		ranks:SetTall(28)

		for rank_name in SortedPairsByMemberValue(sam.ranks.get_ranks(), "immunity", true) do
			if v.rank ~= rank_name then
				ranks:AddChoice(rank_name, nil, true)
			end
		end

		querybox:Done()
		querybox.save:SetEnabled(true)

		querybox:SetCallback(function()
			RunConsoleCommand("sam", "setrankid", v.steamid, ranks:GetValue())
		end)
	end)

	dmenu:Open()
end

sam.menu.add_tab("https://raw.githubusercontent.com/Srlion/Addons-Data/main/icons/sam/user.png", function(column_sheet)
	local refresh, pages
	local current_page, current_column, current_order, current_sort, keyword = nil, "steamid", "DESC", "id", nil

	local players_body = column_sheet:Add("Panel")
	players_body:Dock(FILL)
	players_body:DockMargin(0, 1, 0, 0)
	players_body:DockPadding(10, 10, 10, 10)

	local toggle_loading, is_loading = sam.menu.add_loading_panel(players_body)

	local title = players_body:Add("SAM.Label")
	title:Dock(TOP)
	title:SetFont(SAM_TAB_TITLE_FONT)
	title:SetText("Players")
	title:SetTextColor(GetColor("menu_tabs_title"))
	title:SizeToContents()

	local total = players_body:Add("SAM.Label")
	total:Dock(TOP)
	total:DockMargin(0, 6, 0, 0)
	total:SetFont(SAM_TAB_DESC_FONT)
	total:SetText("60 total players")
	total:SetTextColor(GetColor("menu_tabs_title"))
	total:SetPos(10, SUI.Scale(40))
	total:SizeToContents()

	local search_entry
	do
		local container = players_body:Add("SAM.Panel")
		container:Dock(TOP)
		container:DockMargin(0, 6, 10, 0)
		container:SetTall(30)

		local sort_by = container:Add("SAM.ComboBox")
		sort_by:Dock(RIGHT)
		sort_by:DockMargin(4, 0, 0, 0)
		sort_by:SetWide(106)
		sort_by:SetValue("Sort By (ID)")
		sort_by:AddChoice("ID")
		sort_by:AddChoice("Name")
		sort_by:AddChoice("Rank")
		sort_by:AddChoice("Play Time")

		function sort_by:OnSelect(_, value)
			value = value:lower():gsub(" ", "_")
			if current_sort ~= value then
				current_sort = value
				refresh()
			end
		end

		local sort_order = container:Add("SAM.ComboBox")
		sort_order:Dock(RIGHT)
		sort_order:SetWide(96)
		sort_order:SetValue("Desc")
		sort_order:AddChoice("Desc")
		sort_order:AddChoice("Asc")

		function sort_order:OnSelect(_, value)
			value = value:upper()
			if current_order ~= value then
				current_order = value
				refresh()
			end
		end

		local column = container:Add("SAM.ComboBox")
		column:Dock(RIGHT)
		column:DockMargin(0, 0, 4, 0)
		column:SetWide(140)

		column:SetValue("Search (SteamID)")
		column:AddChoice("SteamID")
		column:AddChoice("Name")
		column:AddChoice("Rank")

		function column:OnSelect(_, value)
			value = value:lower()
			if current_column ~= value then
				current_column = value
				refresh()
			end
		end

		search_entry = container:Add("SAM.TextEntry")
		search_entry:Dock(LEFT)
		search_entry:SetNoBar(true)
		search_entry:SetPlaceholder("Search...")
		search_entry:SetRadius(4)
		search_entry:SetWide(220)

		function search_entry:OnEnter(no_refresh)
			local value = self:GetValue()
			if keyword ~= value then
				keyword = value ~= "" and value or nil
				if not no_refresh then
					refresh()
				end
			end
		end
	end

	Line(players_body, nil, -5, SUI.Scale(15), -5, 0)

	do
		local columns = players_body:Add("Panel")
		columns:Dock(TOP)
		columns:DockMargin(0, 10, 0, 0)

		local info = columns:Add("SAM.Label")
		info:Dock(LEFT)
		info:DockMargin(4, 0, 0, 0)
		info:SetFont(COLUMN_FONT)
		info:SetText("Player")
		info:SetTextColor(GetColor("player_list_titles"))
		info:SetWide(SUI.Scale(280) + SUI.Scale(34))
		info:SizeToContentsY(3)

		local play_time = columns:Add("SAM.Label")
		play_time:Dock(LEFT)
		play_time:DockMargin(-4, 0, 0, 0)
		play_time:SetFont(COLUMN_FONT)
		play_time:SetText("Play Time")
		play_time:SetTextColor(GetColor("player_list_titles"))
		play_time:SetWide(SUI.Scale(180))
		play_time:SizeToContentsY(3)

		local rank_expiry = columns:Add("SAM.Label")
		rank_expiry:Dock(LEFT)
		rank_expiry:DockMargin(-4, 0, 0, 0)
		rank_expiry:SetFont(COLUMN_FONT)
		rank_expiry:SetText("Rank Expiry")
		rank_expiry:SetTextColor(GetColor("player_list_titles"))
		rank_expiry:SetWide(SUI.Scale(280))
		rank_expiry:SizeToContentsY(3)

		columns:SizeToChildren(false, true)
	end

	local body = players_body:Add("SAM.ScrollPanel")
	body:Dock(FILL)
	body:DockMargin(0, 10, 0, 0)
	body:SetVBarPadding(6)

	local set_data = function(data)
		body:GetCanvas():Clear()
		body.VBar.Scroll = 0

		local players, players_count, current_page_2 = unpack(data)
		total:SetText(players_count .. " total players")

		pages = get_pages_count(players_count)
		current_page.i = pages == 0 and 0 or current_page_2 or current_page.i
		current_page:SetText(current_page.i .. "/" .. pages)

		body:Line()

		for k, v in ipairs(players) do
			local line = body:Add("SAM.PlayerLine")
			line:DockMargin(0, 0, 0, 10)

			local name = v.name ~= "" and v.name or nil
			line:SetInfo({
				steamid = v.steamid,
				name = name,
				rank = v.rank
			})

			local play_time = line:Add("SAM.Label")
			play_time:Dock(LEFT)
			play_time:DockMargin(4, 0, 0, 0)
			play_time:SetFont(LINE_FONT)
			play_time:SetText(sam.reverse_parse_length(tonumber(v.play_time) / 60))
			play_time:SetTextColor(GetColor("player_list_data"))
			play_time:SetContentAlignment(4)
			play_time:SetWide(SUI.Scale(180))

			local expiry_date = tonumber(v.expiry_date)
			local rank_expiry = line:Add("SAM.Label")
			rank_expiry:Dock(LEFT)
			rank_expiry:DockMargin(-3, 0, 0, 0)
			rank_expiry:SetFont(LINE_FONT)
			rank_expiry:SetText(expiry_date == 0 and "Never" or sam.reverse_parse_length((expiry_date - os.time()) / 60))
			rank_expiry:SetTextColor(GetColor("player_list_data"))
			rank_expiry:SetContentAlignment(4)
			rank_expiry:SizeToContents()

			local but = line:Actions()
			but.v = v
			but:On("DoClick", button_click)

			body:Line()
		end
	end

	refresh = function()
		if not is_loading() and LocalPlayer():HasPermission("manage_players") then
			search_entry:OnEnter(true)
			local refresh_query = netstream.async.Start("SAM.GetPlayers", toggle_loading, current_page.i, current_column, current_order, current_sort, keyword)
			refresh_query:done(set_data)
		end
	end

	local bottom_panel = players_body:Add("SAM.Panel")
	bottom_panel:Dock(BOTTOM)
	bottom_panel:DockMargin(0, 6, 0, 0)
	bottom_panel:SetTall(30)
	bottom_panel:Background(GetColor("page_switch_bg"))

	local previous_page = bottom_panel:Add("SAM.Button")
	previous_page:Dock(LEFT)
	previous_page:SetWide(30)
	previous_page:SetText("<")
	previous_page:SetFont(NEXT_FONT)

	previous_page:On("DoClick", function()
		if current_page.i <= 1 then return end

		current_page.i = current_page.i - 1
		refresh()
	end)

	current_page = bottom_panel:Add("SAM.Label")
	current_page:Dock(FILL)
	current_page:SetContentAlignment(5)
	current_page:SetFont(SAM_TAB_DESC_FONT)
	current_page:SetText("loading...")
	current_page.i = 1

	local next_page = bottom_panel:Add("SAM.Button")
	next_page:Dock(RIGHT)
	next_page:SetWide(30)
	next_page:SetText(">")
	next_page:SetFont(NEXT_FONT)

	next_page:On("DoClick", function()
		if current_page.i == pages then return end

		current_page.i = current_page.i + 1
		refresh()
	end)

	function bottom_panel:Think()
		next_page:SetEnabled(current_page.i ~= pages)
		previous_page:SetEnabled(current_page.i > 1)
	end

	do
		local refresh_2 = function()
			timer.Simple(1, refresh)
		end

		for k, v in ipairs({"SAM.AuthedPlayer", "SAM.ChangedPlayerRank", "SAM.ChangedSteamIDRank"}) do
			hook.Add(v, "SAM.MenuPlayers", refresh_2)
		end
	end

	refresh()

	return players_body
end, function()
	return LocalPlayer():HasPermission("manage_players")
end, 2)
--addons/sam-159/lua/sam/modules/support_cami.lua:
return gluapack()()
--addons/sam-159/lua/sam/modules/ttt.lua:
return gluapack()()
--addons/sui/lua/sui/vgui/sui_label.lua:
return gluapack()()
--addons/scb-29/lua/scb/settings/tabs/client.lua:
if SCB_LOADED then return end

local vgui = vgui

local ipairs = ipairs

local scb = scb
local SUI = scb.SUI
local language = scb.language

local toggle_convars = {
	{
		title = "show_time",
		convar = "scb_show_timestamps",
	},
	{
		title = "disable_rainbow",
		convar = "scb_disable_rainbow_colors",
		value = "0"
	},
	{
		title = "disable_flashing",
		convar = "scb_disable_flashing_texts",
		value = "0"
	},
	{
		title = "blur_theme",
		convar = "scb_blur_theme",
		value = SUI.current_theme == "Blur" and "1" or "0",
		on_change = function(value)
			SUI.SetTheme(value == "1" and "Blur" or "Dark")
		end
	},
	{
		title = "join_messages",
		convar = "scb_joindisconnect_message",
		value = "1"
	},
	{
		"number",
		title = "scale",
		convar = "scb_scale",
		value = "5",
		min = 1, max = 9,
		load = function(slider, convar)
			slider:GetParent():SetWide(110)

			slider:SetDecimals(0)
			slider:SetMinMax(1, 9)
			slider.Knob:SUI_TDLib()

			local on_mouse_released = function()
				convar:SetInt(slider:GetValue())
			end
			slider:On("OnMouseReleased", on_mouse_released)
			slider.Knob:On("OnMouseReleased", on_mouse_released)

			slider:SetValue(scb.to_new_range(SUI.GetScale(), 0.5, 1.5, 1, 9))
		end,
		on_change = function(value)
			SUI.SetScale(scb.to_new_range(value, 1, 9, 0.5, 1.5))
		end
	},
	{
		"number",
		title = "messages_fade",
		convar = "scb_message_fade_out_time",
		value = "6",
		min = 0, max = 60,
		load = function(slider, convar)
			slider:GetParent():SetWide(160)

			slider:SetDecimals(0)
			slider:SetMinMax(0, 60)

			slider:On("OnValueChanged", function(_, v)
				convar:SetInt(v)
			end)

			slider:SetValue(convar:GetInt())
		end
	},
	{
		"number",
		title = "max_messages",
		convar = "scb_max_messages",
		value = "200",
		min = 100, max = 400,
		load = function(slider, convar)
			slider:GetParent():SetWide(160)

			slider:SetDecimals(0)
			slider:SetMinMax(100, 400)

			slider:On("OnValueChanged", function(_, v)
				convar:SetInt(v)
			end)

			slider:SetValue(convar:GetInt())
		end
	}
}

if scb.config.enable_avatars then
	table.insert(toggle_convars, 1, {
		title = "show_avatars",
		convar = "scb_show_avatars",
	})
end

if not scb.config.enable_custom_join_messages and not scb.config.enable_custom_leave_messages then
	for k, v in ipairs(toggle_convars) do
		if v.convar == "scb_joindisconnect_message" then
			table.remove(toggle_convars, k)
			break
		end
	end
end

for _, v in ipairs(toggle_convars) do
	local convar = CreateClientConVar(v.convar, v.value or "1", true, false, "", v.min or 0, v.max or 1)

	if v.on_change then
		v.on_change(convar:GetString())
		cvars.AddChangeCallback(v.convar, function(_, _, value_new)
			v.on_change(value_new, v.panel)
		end)
	end
end

return {
	title = language.client_title,
	pos = 1,
	check = false,
	func = function(parent)
		local body = parent:Add("SCB.ScrollPanel")
		body:Dock(FILL)
		body:DockMargin(0, 1, 0, 0)

		local add_setting = function(title, pnl)
			local setting = body:Add("SCB.LabelPanel")
			setting:DockMargin(4, 4, 4, 0)
			setting:SetLabel(title)
			setting:SetPanel(pnl)
			return setting
		end

		for _, v in ipairs(toggle_convars) do
			local panel
			if v[1] == "number" then
				panel = vgui.Create("SCB.NumberSlider")

				v.panel = panel.slider
				v.load(panel.slider, v.convar and GetConVar(v.convar))
			else
				panel = vgui.Create("SCB.ToggleButton")
				panel:SetConVar(v.convar)
			end

			add_setting(language[v.title], panel)
		end

		local reset_size = vgui.Create("SCB.Button")
		reset_size:SetText("Reset")
		reset_size:SetSize(70, 24)
		reset_size:On("DoClick", function()
			scb.chatbox:SetSize(480, 220)
		end)
		add_setting(language.reset_size, reset_size)

		local reset_position = vgui.Create("SCB.Button")
		reset_position:SetText("Reset")
		reset_position:SetSize(70, 24)
		reset_position:On("DoClick", function()
			scb.chatbox:SetPos(sui.scale(18), ScrH() - scb.chatbox:GetTall() - sui.scale(170))
			scb.chatbox:OnPosChanged()
		end)
		add_setting(language.reset_position, reset_position)

		local clear_cache = vgui.Create("SCB.Button")
		clear_cache:SetText("Clear")
		clear_cache:SetSize(70, 24)

		clear_cache:On("DoClick", function()
			SUI.ClearImages()
		end)

		add_setting(language.clear_reload, clear_cache)

		return body
	end
}
--addons/scb-29/lua/scb/cl_emojis_data.lua:
return {["jack_o_lantern"]="41",["sloth"]="254",["flag_nl"]="8179",["man_raising_hand"]="1240",["crossed_swords"]="6187",["flag_ck"]="853",["flag_mn"]="8160",["woman_kiss_man"]="1447",["heartpulse"]="1120",["man_girl"]="1472",["flag_se"]="8210",["woman_with_probing_cane"]="1372",["flag_bd"]="827",["rolled_up_newspaper"]="6117",["fog"]="5195",["flag_af"]="811",["aries"]="760",["japan"]="56",["arrow_forward"]="776",["stadium"]="517",["five"]="7139",["flag_kr"]="8135",["guitar"]="663",["woman_kiss_woman"]="1449",["flag_ro"]="8202",["man_getting_massage"]="1356",["exclamation"]="7127",["flag_gt"]="8103",["princess"]="1315",["skunk"]="256",["world_map"]="55",["flag_sm"]="8217",["crab"]="380",["flag_bl"]="834",["grey_exclamation"]="7126",["rainbow"]="5198",["woman_mountain_biking"]="1421",["racing_motorcycle"]="592",["deaf_person"]="1242",["kangaroo"]="257",["stethoscope"]="6212",["flag_cz"]="865",["spider"]="2101",["man_girl_boy"]="1473",["smirk"]="137",["ophiuchus"]="772",["flag_uy"]="8249",["cool"]="7154",["woman_getting_massage"]="1357",["whale"]="285",["frog"]="276",["man_standing"]="1365",["running_shirt_with_sash"]="451",["wind_chime"]="414",["imp"]="192",["thought_balloon"]="1148",["biohazard_sign"]="726",["m"]="7158",["sparkler"]="44",["jigsaw"]="465",["clock430"]="5149",["bust_in_silhouette"]="1481",["wine_glass"]="3105",["no_bicycles"]="718",["sneezing_face"]="152",["carousel_horse"]="558",["flag_ps"]="8196",["chipmunk"]="248",["ant"]="297",["man_running"]="1380",["nine"]="7143",["bamboo"]="411",["facepunch"]="1171",["earth_africa"]="51",["woman_running"]="1381",["lower_left_fountain_pen"]="6147",["wedding"]="538",["disappointed_relieved"]="176",["clock530"]="5151",["man_woman_girl_girl"]="1459",["computer"]="677",["mantelpiece_clock"]="5139",["woman_heart_woman"]="1453",["broom"]="6223",["trackball"]="682",["martial_arts_uniform"]="445",["lemon"]="35",["flag_qa"]="8200",["surfer"]="1401",["child"]="1199",["flag_cr"]="859",["male_singer"]="1288",["rice_scene"]="415",["metro"]="568",["flag_jo"]="8126",["drum_with_drumsticks"]="668",["black_right_pointing_double_triangle_with_vertical_bar"]="778",["blue_heart"]="1131",["house_buildings"]="521",["male_judge"]="1264",["wheelchair"]="74",["field_hockey_stick_and_ball"]="439",["fish_cake"]="374",["spoon"]="3119",["man_woman_boy_boy"]="1458",["dark_sunglasses"]="62",["lock_with_ink_pen"]="6177",["u5408"]="7178",["man_in_business_suit_levitating"]="1384",["raised_back_of_hand"]="1151",["probing_cane"]="6196",["currency_exchange"]="6130",["person_in_lotus_position"]="1437",["flag_pk"]="8191",["flag_ua"]="8244",["hot_pepper"]="323",["large_orange_circle"]="7185",["male_firefighter"]="1300",["paperclip"]="6167",["flag_km"]="8132",["pizza"]="346",["massage"]="1355",["female_astronaut"]="1298",["postbox"]="6143",["railway_track"]="5102",["label"]="6120",["microscope"]="6205",["mask"]="147",["ramen"]="368",["boxing_glove"]="444",["man_walking"]="1362",["jeans"]="68",["flag_iq"]="8120",["statue_of_liberty"]="540",["flag_bw"]="843",["flag_my"]="8171",["axe"]="6182",["money_with_wings"]="6126",["tophat"]="636",["flag_no"]="8180",["milky_way"]="5184",["flag_cu"]="860",["on"]="745",["flag_tk"]="8234",["high_brightness"]="793",["flag_eh"]="877",["arrow_double_up"]="784",["white_flower"]="2108",["flag_gb"]="889",["male_astronaut"]="1297",["face_palm"]="1248",["llama"]="237",["bald_man"]="1209",["angel"]="1325",["female_doctor"]="1256",["flag_om"]="8185",["abacus"]="687",["abcd"]="7146",["printer"]="679",["man_kiss_man"]="1448",["moyai"]="6233",["construction"]="5109",["arrow_upper_right"]="728",["man_dancing"]="1383",["female_artist"]="1292",["smile_cat"]="1104",["pig"]="228",["flag_sl"]="8216",["star2"]="5182",["tennis"]="435",["radio"]="661",["beers"]="3109",["custard"]="397",["blue_book"]="6108",["flag_bo"]="837",["flag_mq"]="8163",["flag_ls"]="8145",["flag_hk"]="8107",["volcano"]="510",["weary"]="184",["spider_web"]="2102",["sweat_smile"]="16",["leaves"]="2127",["car"]="585",["white_haired_man"]="1208",["flag_cm"]="855",["flag_tz"]="8243",["art"]="477",["pouch"]="623",["flag_ng"]="8177",["rooster"]="262",["boom"]="1138",["supervillain"]="1331",["u7121"]="7174",["earth_americas"]="52",["clock11"]="5162",["six"]="7140",["shopping_bags"]="624",["mushroom"]="329",["wc"]="79",["ng"]="7160",["flag_lc"]="8141",["flag_ge"]="891",["hatched_chick"]="265",["flag_pr"]="8195",["clock3"]="5146",["diamonds"]="469",["unlock"]="6176",["o"]="7106",["credit_card"]="6127",["flags"]="413",["mailbox_with_no_mail"]="6142",["softball"]="430",["melon"]="32",["bride_with_veil"]="1322",["unamused"]="138",["taco"]="349",["helicopter"]="5124",["snow_cloud"]="5192",["nazar_amulet"]="460",["goat"]="234",["flag_aq"]="817",["repeat_one"]="775",["astonished"]="169",["newspaper"]="6116",["speaking_head_in_silhouette"]="1480",["lower_left_crayon"]="6150",["purple_heart"]="1132",["athletic_shoe"]="627",["dancers"]="1385",["large_blue_circle"]="7188",["fries"]="345",["flag_lk"]="8143",["u7533"]="7177",["cinema"]="791",["flag_tr"]="8239",["pray"]="1179",["man_playing_water_polo"]="1429",["womans_clothes"]="620",["musical_note"]="654",["confused"]="163",["no_entry_sign"]="717",["calling"]="670",["cookie"]="389",["pushpin"]="6165",["female_pilot"]="1295",["weight_lifter"]="1413",["admission_tickets"]="420",["gift"]="418",["lightning"]="5193",["restroom"]="77",["broccoli"]="326",["manual_wheelchair"]="594",["sagittarius"]="768",["no_mobile_phones"]="723",["purse"]="621",["sunflower"]="2113",["double_vertical_bar"]="787",["om_symbol"]="750",["flag_za"]="8263",["flushed"]="170",["male_pilot"]="1294",["curry"]="367",["chair"]="6216",["panda_face"]="253",["large_blue_square"]="7197",["lollipop"]="396",["oden"]="371",["flying_disc"]="436",["flag_ai"]="813",["ice_cream"]="387",["flag_gg"]="893",["cow2"]="227",["sleuth_or_spy"]="1305",["high_heel"]="630",["flag_hr"]="8110",["fearful"]="174",["flag_mx"]="8170",["flag_nf"]="8176",["person_in_steamy_room"]="1388",["joystick"]="462",["garlic"]="327",["speaker"]="645",["video_camera"]="695",["male_farmer"]="1267",["flag_tj"]="8233",["female_detective"]="1307",["see_no_evil"]="1112",["dromedary_camel"]="235",["ear_of_rice"]="2121",["heavy_minus_sign"]="7114",["male_supervillain"]="1332",["straight_ruler"]="6169",["robot_face"]="1102",["flag_bv"]="842",["sparkling_heart"]="1119",["trumpet"]="665",["no_entry"]="716",["up"]="7165",["flag_dk"]="869",["ledger"]="6112",["headphones"]="660",["full_moon"]="5168",["no_smoking"]="719",["flag_pm"]="8193",["couplekiss"]="1446",["flag_cd"]="848",["chart_with_upwards_trend"]="6161",["two_women_holding_hands"]="1443",["man_woman_boy"]="1455",["tiger2"]="217",["sunrise_over_mountains"]="552",["flag_bf"]="829",["man_woman_girl"]="1456",["flag_so"]="8219",["hugging_face"]="128",["flag_mp"]="8162",["clock1030"]="5161",["yum"]="122",["chart"]="6129",["ox"]="225",["camping"]="512",["bath"]="1440",["onion"]="328",["rice_cracker"]="364",["beverage_box"]="3113",["flag_hu"]="8112",["clock830"]="5157",["flag_cl"]="854",["large_yellow_circle"]="7186",["last_quarter_moon_with_face"]="5175",["handball"]="1431",["spiral_note_pad"]="6158",["flag_tm"]="8236",["female_construction_worker"]="1313",["female_office_worker"]="1280",["yellow_heart"]="1129",["hotsprings"]="557",["beach_with_umbrella"]="513",["flag_bn"]="836",["shield"]="6190",["film_projector"]="690",["o2"]="7161",["ok_woman"]="1233",["flag_lb"]="8140",["flag_gd"]="890",["package"]="6138",["clock2"]="5144",["candle"]="699",["clock10"]="5160",["person_with_blond_hair"]="1203",["elephant"]="239",["small_red_triangle_down"]="7213",["man_man_girl"]="1461",["koko"]="7167",["elf"]="1346",["clock630"]="5153",["camera"]="693",["money_mouth_face"]="127",["first_quarter_moon"]="5166",["male_sign"]="798",["duck"]="270",["snow_capped_mountain"]="58",["clown_face"]="196",["no_bell"]="652",["flag_kw"]="8136",["kiwifruit"]="315",["tanabata_tree"]="410",["eyeglasses"]="61",["ok_hand"]="1155",["last_quarter_moon"]="5170",["lower_left_paintbrush"]="6149",["anguished"]="173",["womans_hat"]="635",["parking"]="7163",["flag_sg"]="8211",["wrestlers"]="1425",["closed_lock_with_key"]="6178",["circus_tent"]="562",["expressionless"]="135",["symbols"]="7148",["wrench"]="6191",["flag_lu"]="8147",["fire"]="5208",["phone"]="671",["flag_gn"]="898",["scarf"]="69",["man_gesturing_no"]="1231",["two_hearts"]="1123",["arrows_clockwise"]="741",["airplane_arriving"]="5121",["movie_camera"]="688",["man_man_girl_girl"]="1464",["woman_frowning"]="1226",["orange_book"]="6109",["petri_dish"]="6203",["clipboard"]="6164",["clock130"]="5143",["question"]="7124",["flag_yt"]="8262",["iphone"]="669",["dolls"]="412",["tea"]="3102",["three"]="7137",["flag_pt"]="8197",["baby_bottle"]="399",["film_frames"]="689",["spiral_calendar_pad"]="6159",["waxing_crescent_moon"]="5165",["octagonal_sign"]="5108",["male_construction_worker"]="1312",["shirt"]="67",["maple_leaf"]="2125",["female_police_officer"]="1304",["barber"]="561",["man_wrestling"]="1426",["menorah_with_nine_branches"]="758",["woman"]="1210",["burrito"]="350",["ballot_box_with_ballot"]="6144",["bus"]="575",["bell"]="651",["hamster"]="245",["heart_decoration"]="1124",["grinning"]="11",["man_boy"]="1470",["bulb"]="6100",["small_orange_diamond"]="7210",["flag_tt"]="8240",["secret"]="7181",["congratulations"]="7180",["male_superhero"]="1329",["chart_with_downwards_trend"]="6162",["flag_sv"]="8223",["part_alternation_mark"]="7118",["wavy_dash"]="7128",["yo_yo"]="456",["white_large_square"]="7201",["black_large_square"]="7200",["left_luggage"]="713",["arrow_down"]="731",["flag_is"]="8122",["small_red_triangle"]="7212",["tractor"]="590",["green_book"]="6107",["sleeping_accommodation"]="1441",["baseball"]="429",["thumbsdown"]="1169",["arrow_up"]="727",["shell"]="293",["arrow_heading_down"]="740",["arrow_heading_up"]="739",["koala"]="252",["desert"]="514",["loop"]="7117",["flag_vi"]="8255",["flag_pl"]="8192",["children_crossing"]="715",["lizard"]="279",["curly_loop"]="7116",["arrow_right"]="729",["middle_finger"]="1165",["heavy_division_sign"]="7115",["second_place_medal"]="426",["rowboat"]="1404",["stars"]="5183",["heavy_heart_exclamation_mark_ornament"]="1125",["flag_td"]="8229",["grey_question"]="7125",["cat2"]="214",["flag_ne"]="8175",["x"]="7111",["sparkle"]="7121",["flag_ye"]="8261",["flag_kg"]="8129",["bar_chart"]="6163",["hocho"]="3120",["snowflake"]="5204",["potable_water"]="73",["flag_jp"]="8127",["santa"]="1326",["accept"]="7176",["star_of_david"]="751",["busts_in_silhouette"]="1482",["eyes"]="1194",["wave"]="1150",["heavy_multiplication_x"]="7110",["heavy_check_mark"]="7109",["cocktail"]="3106",["black_nib"]="6146",["full_moon_with_face"]="5178",["pencil2"]="6145",["thermometer"]="5176",["flag_de"]="866",["calendar"]="6157",["flag_gw"]="8105",["flag_ht"]="8111",["writing_hand"]="1180",["v"]="1157",["rocket"]="5129",["point_up"]="1167",["email"]="6132",["door"]="6213",["satellite"]="5128",["scissors"]="6171",["zap"]="5203",["clock5"]="5150",["loudspeaker"]="648",["flag_by"]="844",["church"]="541",["footprints"]="1483",["fuelpump"]="5104",["tent"]="548",["flag_sn"]="8218",["capricorn"]="769",["customs"]="711",["person_with_ball"]="1410",["rice"]="366",["smiley_cat"]="1103",["hotel"]="530",["woman_bouncing_ball"]="1412",["man_heart_man"]="1452",["ice_skate"]="448",["skier"]="1396",["boat"]="5111",["flag_ms"]="8165",["female_fairy"]="1339",["female_cook"]="1271",["snowman"]="5205",["woman_girl_girl"]="1479",["palm_tree"]="2119",["european_post_office"]="527",["ferry"]="5115",["dress"]="613",["flag_dm"]="870",["golf"]="447",["female_supervillain"]="1333",["flag_zm"]="8264",["vibration_mode"]="795",["flag_uz"]="8250",["flag_wf"]="8258",["umbrella_on_ground"]="5202",["ribbon"]="417",["point_left"]="1162",["mouse2"]="243",["mountain"]="59",["shinto_shrine"]="545",["blond_haired_woman"]="1219",["large_purple_circle"]="7189",["orange_heart"]="1128",["flag_scotland"]="8267",["sunrise"]="553",["helmet_with_white_cross"]="639",["man_wearing_turban"]="1317",["pick"]="6183",["anchor"]="5110",["partly_sunny"]="5186",["snowman_without_snow"]="5206",["busstop"]="5100",["flag_na"]="8173",["loud_sound"]="647",["rat"]="244",["file_cabinet"]="6173",["beginner"]="7105",["flag_mc"]="8151",["fleur_de_lis"]="7102",["musical_score"]="653",["desktop_computer"]="678",["kiss"]="1115",["frowning"]="172",["postal_horn"]="650",["coffin"]="6231",["linked_paperclips"]="6168",["man_boy_boy"]="1471",["black_circle"]="7191",["tooth"]="1192",["warning"]="714",["face_with_cowboy_hat"]="158",["clock230"]="5145",["four_leaf_clover"]="2124",["flag_lt"]="8146",["meat_on_bone"]="340",["flag_sc"]="8208",["first_place_medal"]="425",["kissing_closed_eyes"]="120",["alembic"]="6201",["ticket"]="421",["medical_symbol"]="799",["flag_bq"]="838",["hammer"]="6181",["thunder_cloud_and_rain"]="5187",["derelict_house_building"]="522",["waving_black_flag"]="84",["flag_as"]="819",["flag_cg"]="850",["hammer_and_pick"]="6184",["sandal"]="631",["gift_heart"]="1118",["dragon"]="282",["japanese_ogre"]="197",["infinity"]="7100",["champagne"]="3104",["recycle"]="7101",["hearts"]="468",["right_facing_fist"]="1173",["oncoming_police_car"]="582",["chess_pawn"]="471",["flag_ni"]="8178",["pisces"]="771",["tram"]="571",["diamond_shape_with_a_dot_inside"]="7214",["scorpius"]="767",["flag_mk"]="8157",["wheel_of_dharma"]="752",["libra"]="766",["mosque"]="542",["virgo"]="765",["one"]="7135",["shopping_trolley"]="6229",["woman_rowing_boat"]="1406",["vertical_traffic_light"]="5107",["revolving_hearts"]="1122",["sound"]="646",["bowl_with_spoon"]="357",["female_technologist"]="1286",["man_with_bunny_ears_partying"]="1386",["rewind"]="781",["flag_ba"]="825",["crying_cat_face"]="1110",["free"]="7155",["flag_pw"]="8198",["female_sign"]="797",["flag_ac"]="88",["arrow_double_down"]="786",["white_frowning_face"]="166",["heartbeat"]="1121",["small_airplane"]="5119",["peace_symbol"]="757",["star_and_crescent"]="756",["orthodox_cross"]="755",["monkey"]="22",["radioactive_sign"]="725",["mega"]="649",["skull_and_crossbones"]="194",["old_key"]="6180",["flag_es"]="879",["fist"]="1170",["shamrock"]="2123",["black_circle_for_record"]="789",["coffee"]="3101",["file_folder"]="6153",["man_mountain_biking"]="1420",["male_detective"]="1306",["ballot_box_with_check"]="7108",["candy"]="395",["comet"]="5207",["flag_in"]="8118",["cloud"]="5185",["sunny"]="5177",["flag_gq"]="8100",["woman_in_steamy_room"]="1390",["id"]="7157",["cricket_bat_and_ball"]="438",["female_zombie"]="1354",["nerd_face"]="161",["flag_kn"]="8133",["white_medium_small_square"]="7205",["flag_ag"]="812",["page_with_curl"]="6113",["white_medium_square"]="7203",["dumpling"]="377",["copyright"]="7129",["clock330"]="5147",["fried_shrimp"]="373",["arrow_backward"]="780",["flag_bi"]="832",["fish"]="288",["fax"]="674",["drop_of_blood"]="6209",["house"]="523",["woman_wearing_turban"]="1318",["bald_woman"]="1217",["low_brightness"]="792",["seven"]="7141",["flag_ec"]="874",["card_index_dividers"]="6155",["safety_vest"]="65",["flag_ir"]="8121",["timer_clock"]="5138",["mag_right"]="698",["otter"]="255",["flag_mz"]="8172",["stopwatch"]="5137",["takeout_box"]="379",["alarm_clock"]="5136",["ocean"]="5210",["black_right_pointing_triangle_with_double_vertical_bar"]="779",["cl"]="7153",["black_left_pointing_double_triangle_with_vertical_bar"]="782",["relaxed"]="119",["fast_forward"]="777",["registered"]="7130",["woman_in_manual_wheelchair"]="1378",["eject"]="790",["keyboard"]="680",["flag_cv"]="861",["aerial_tramway"]="5127",["ballet_shoes"]="632",["male_scientist"]="1282",["smoking"]="6230",["woman_walking"]="1363",["leftwards_arrow_with_hook"]="737",["badger"]="258",["swimmer"]="1407",["hourglass_flowing_sand"]="5134",["underage"]="724",["woman_juggling"]="1436",["flamingo"]="273",["one_piece_swimsuit"]="616",["left_right_arrow"]="736",["information_source"]="7156",["woman_in_lotus_position"]="1439",["clock1130"]="5163",["fallen_leaf"]="2126",["woman_biking"]="1418",["horse_racing"]="1395",["interrobang"]="7123",["hushed"]="168",["man_in_motorized_wheelchair"]="1374",["mrs_claus"]="1327",["closed_umbrella"]="5199",["lower_left_ballpoint_pen"]="6148",["razor"]="6220",["ringed_planet"]="5180",["woman_heart_man"]="1451",["parachute"]="5122",["raised_hand_with_fingers_splayed"]="1152",["kite"]="457",["male_police_officer"]="1303",["star"]="5181",["trident"]="7103",["mute"]="644",["balloon"]="47",["relieved"]="142",["flag_cf"]="849",["kaaba"]="546",["flag_gi"]="895",["flag_fk"]="884",["earth_asia"]="53",["ambulance"]="579",["date"]="6156",["flag_sy"]="8225",["clock4"]="5148",["partying_face"]="159",["speak_no_evil"]="1114",["adhesive_bandage"]="6211",["blond_haired_man"]="1220",["rugby_football"]="434",["notebook_with_decorative_cover"]="6104",["flag_az"]="824",["white_small_square"]="7207",["shorts"]="618",["flag_to"]="8238",["flag_bg"]="830",["arrow_up_down"]="735",["open_file_folder"]="6154",["flag_np"]="8181",["police_car"]="581",["watch"]="5135",["guide_dog"]="27",["sponge"]="6227",["flag_mr"]="8164",["soap"]="6226",["roll_of_paper"]="6225",["basket"]="6224",["tongue"]="1196",["teddy_bear"]="466",["penguin"]="267",["male_cook"]="1270",["e_mail"]="6133",["spaghetti"]="369",["flag_st"]="8222",["eight"]="7142",["thread"]="478",["sa"]="7168",["flag_cn"]="856",["clock12"]="5140",["face_with_hand_over_mouth"]="129",["vampire"]="1340",["service_dog"]="28",["bed"]="6214",["clapper"]="691",["female_superhero"]="1330",["flag_um"]="8246",["bricks"]="520",["link"]="6197",["snowboarder"]="1397",["flag_pg"]="8189",["crown"]="634",["laughing"]="15",["new_moon_with_face"]="5173",["toolbox"]="6199",["diving_mask"]="450",["fire_extinguisher"]="6228",["compass"]="57",["large_purple_square"]="7198",["baby"]="1198",["test_tube"]="6202",["woozy_face"]="155",["red_envelope"]="416",["socks"]="612",["coat"]="611",["flag_gf"]="892",["flag_us"]="8248",["aquarius"]="770",["brain"]="1191",["fried_egg"]="354",["male_zombie"]="1353",["genie"]="1349",["adult"]="1202",["flag_ie"]="8115",["female_genie"]="1351",["hibiscus"]="2112",["joy_cat"]="1105",["male_elf"]="1347",["female_elf"]="1348",["merperson"]="1343",["merman"]="1344",["mermaid"]="1345",["butterfly"]="295",["lotion_bottle"]="6221",["flag_cw"]="862",["person_with_pouting_face"]="1227",["national_park"]="516",["shushing_face"]="130",["male_fairy"]="1338",["mage"]="1334",["fishing_pole_and_fish"]="449",["female_mage"]="1336",["flag_ar"]="818",["pineapple"]="37",["safety_pin"]="6222",["tm"]="7131",["juggling"]="1434",["traffic_light"]="5106",["male_factory_worker"]="1276",["clock7"]="5154",["avocado"]="318",["video_game"]="461",["flag_tg"]="8231",["control_knobs"]="658",["eye"]="1195",["family"]="1454",["t_rex"]="284",["person_with_headscarf"]="1320",["rhinoceros"]="240",["bow_and_arrow"]="6189",["eggplant"]="319",["older_adult"]="1221",["male_genie"]="1350",["bikini"]="619",["flag_im"]="8117",["face_with_monocle"]="162",["icecream"]="385",["deaf_man"]="1243",["flag_mu"]="8167",["deaf_woman"]="1244",["man_swimming"]="1408",["kneeling_person"]="1367",["man_kneeling"]="1368",["flag_sa"]="8206",["clock9"]="5158",["mortar_board"]="637",["ship"]="5117",["standing_person"]="1364",["crossed_flags"]="83",["ice_cube"]="3115",["red_haired_man"]="1206",["pancakes"]="337",["mate_drink"]="3114",["black_joker"]="472",["woman_swimming"]="1409",["croissant"]="333",["bouquet"]="2106",["butter"]="360",["speech_balloon"]="1144",["factory"]="535",["man_with_turban"]="1316",["grimacing"]="140",["place_of_worship"]="748",["salt"]="361",["flag_er"]="878",["basketball"]="431",["cupcake"]="392",["parrot"]="275",["sushi"]="372",["globe_with_meridians"]="54",["monorail"]="572",["motorized_wheelchair"]="595",["ear_with_hearing_aid"]="1189",["arrow_lower_left"]="732",["fountain"]="547",["superhero"]="1328",["flag_ky"]="8137",["flag_me"]="8153",["performing_arts"]="475",["flag_fr"]="887",["magnet"]="6200",["white_circle"]="7192",["foot"]="1187",["falafel"]="352",["city_sunrise"]="555",["smirk_cat"]="1107",["banjo"]="667",["hospital"]="528",["watermelon"]="33",["receipt"]="6128",["water_buffalo"]="226",["sweet_potato"]="370",["hash"]="7132",["oyster"]="384",["flag_bh"]="831",["hotdog"]="347",["arrow_upper_left"]="734",["orangutan"]="24",["swan"]="271",["microbe"]="2105",["ice_hockey_stick_and_puck"]="440",["tada"]="48",["woman_woman_boy"]="1465",["briefs"]="617",["gem"]="643",["raccoon"]="212",["flag_au"]="821",["train"]="574",["flag_wales"]="8268",["cheese_wedge"]="339",["man_pouting"]="1228",["hippopotamus"]="241",["flag_vc"]="8252",["peacock"]="274",["cricket"]="2100",["man"]="1204",["man_in_steamy_room"]="1389",["boar"]="230",["flag_mm"]="8159",["sauropod"]="283",["reminder_ribbon"]="419",["hedgehog"]="249",["telescope"]="6206",["zebra_face"]="222",["woman_golfing"]="1400",["giraffe_face"]="238",["squid"]="383",["shrimp"]="382",["tiger"]="216",["izakaya_lantern"]="6102",["flag_zw"]="8265",["bearded_person"]="1205",["evergreen_tree"]="2117",["gun"]="6188",["gorilla"]="23",["potato"]="320",["deer"]="223",["fox_face"]="211",["barely_sunny"]="5189",["man_surfing"]="1402",["nut_and_bolt"]="6192",["mountain_railway"]="573",["owl"]="272",["shark"]="291",["bat"]="250",["flag_ae"]="810",["eagle"]="269",["pound"]="6125",["leopard"]="218",["boot"]="633",["first_quarter_moon_with_face"]="5174",["desert_island"]="515",["sled"]="453",["turkey"]="260",["repeat"]="774",["scorpion"]="2103",["mailbox_closed"]="6140",["person_climbing"]="1391",["flag_eu"]="881",["womans_flat_shoe"]="629",["fireworks"]="43",["hole"]="1142",["tumbler_glass"]="3111",["hiking_boot"]="628",["ram"]="232",["flag_gh"]="894",["flag_fj"]="883",["female_teacher"]="1262",["large_orange_square"]="7194",["goggles"]="63",["flag_sx"]="8224",["sports_medal"]="424",["flag_tf"]="8230",["sake"]="3103",["lab_coat"]="64",["cupid"]="1117",["left_facing_fist"]="1172",["water_polo"]="1428",["pleading_face"]="171",["moneybag"]="6121",["cold_face"]="154",["hot_face"]="153",["fortune_cookie"]="378",["dove_of_peace"]="268",["firecracker"]="45",["radio_button"]="7215",["flag_am"]="815",["three_button_mouse"]="681",["chopsticks"]="3116",["notebook"]="6111",["smiling_face_with_3_hearts"]="114",["trophy"]="423",["pretzel"]="335",["vhs"]="696",["moon_cake"]="375",["woman_lifting_weights"]="1415",["bowling"]="437",["flag_ee"]="875",["ab"]="7151",["canned_food"]="362",["flag_it"]="8123",["four"]="7138",["sandwich"]="348",["ear"]="1188",["woman_pouting"]="1229",["rosette"]="2109",["hankey"]="195",["flag_do"]="871",["euro"]="6124",["bagel"]="336",["pie"]="393",["lobster"]="381",["cup_with_straw"]="3112",["flag_tn"]="8237",["gemini"]="762",["yawning_face"]="186",["peanuts"]="330",["heart_eyes"]="115",["luggage"]="5132",["egg"]="353",["male_doctor"]="1255",["8ball"]="458",["stuffed_flatbread"]="351",["female_guard"]="1310",["green_salad"]="358",["baguette_bread"]="334",["carrot"]="321",["dango"]="376",["bacon"]="343",["kimono"]="614",["round_pushpin"]="6166",["tulip"]="2115",["cucumber"]="324",["knife_fork_plate"]="3117",["woman_climbing"]="1393",["sparkles"]="46",["bathtub"]="6219",["camera_with_flash"]="694",["flag_th"]="8232",["flag_id"]="8114",["medal"]="422",["third_place_medal"]="427",["bear"]="251",["flag_ki"]="8131",["chocolate_bar"]="394",["ok"]="7162",["birthday"]="390",["heavy_plus_sign"]="7113",["rose"]="2110",["clinking_glasses"]="3110",["hear_no_evil"]="1113",["man_playing_handball"]="1432",["chicken"]="261",["flag_fm"]="885",["crocodile"]="277",["sari"]="615",["feet"]="259",["doughnut"]="388",["woman_wrestling"]="1427",["oncoming_taxi"]="584",["fencer"]="1394",["man_juggling"]="1435",["arrow_lower_right"]="730",["fork_and_knife"]="3118",["flag_nc"]="8174",["clock6"]="5152",["classical_building"]="518",["person_doing_cartwheel"]="1422",["cityscape"]="551",["man_cartwheeling"]="1423",["woman_cartwheeling"]="1424",["night_with_stars"]="550",["shrug"]="1251",["man_shrugging"]="1252",["woman_shrugging"]="1253",["man_in_tuxedo"]="1321",["male_teacher"]="1261",["handshake"]="1178",["no_pedestrians"]="722",["man_gesturing_ok"]="1234",["flag_il"]="8116",["red_circle"]="7184",["prince"]="1314",["office"]="525",["flag_mt"]="8166",["flag_lv"]="8148",["selfie"]="1182",["flag_tv"]="8241",["breast_feeding"]="1324",["i_love_you_hand_sign"]="1159",["male_artist"]="1291",["exploding_head"]="157",["violin"]="666",["flag_bs"]="840",["flag_dg"]="867",["runner"]="1379",["arrow_down_small"]="785",["face_vomiting"]="151",["oncoming_bus"]="576",["joy"]="18",["strawberry"]="314",["face_with_symbols_on_mouth"]="190",["u7a7a"]="7179",["zany_face"]="125",["stew"]="356",["the_horns"]="1160",["man_facepalming"]="1249",["woman_facepalming"]="1250",["lying_face"]="141",["stuck_out_tongue_winking_eye"]="124",["briefcase"]="6152",["compression"]="6194",["rolling_on_the_floor_laughing"]="17",["nauseated_face"]="150",["atom_symbol"]="749",["flag_ca"]="846",["older_woman"]="1223",["pregnant_woman"]="1323",["school"]="533",["cactus"]="2120",["triangular_ruler"]="6170",["studio_microphone"]="656",["clock8"]="5156",["flag_md"]="8152",["crossed_fingers"]="1158",["clubs"]="470",["slot_machine"]="463",["call_me_hand"]="1161",["lock"]="6175",["face_with_raised_eyebrow"]="133",["bangbang"]="7122",["muscle"]="1183",["man_rowing_boat"]="1405",["zipper_mouth_face"]="132",["brown_heart"]="1133",["pinching_hand"]="1156",["white_heart"]="1135",["flag_sh"]="8212",["large_brown_square"]="7199",["large_green_square"]="7196",["large_yellow_square"]="7195",["microphone"]="659",["camel"]="236",["soon"]="746",["blush"]="112",["large_red_square"]="7193",["large_brown_circle"]="7190",["chains"]="6198",["lips"]="1197",["large_green_circle"]="7187",["scroll"]="6114",["cherries"]="313",["flag_at"]="820",["auto_rickshaw"]="596",["skateboard"]="599",["christmas_tree"]="42",["sleepy"]="144",["canoe"]="5112",["pig2"]="229",["flag_xk"]="8260",["motor_scooter"]="593",["flag_ru"]="8204",["scooter"]="598",["flag_ci"]="852",["flag_ml"]="8158",["envelope_with_arrow"]="6135",["keycap_ten"]="7144",["non_potable_water"]="721",["white_check_mark"]="7107",["airplane_departure"]="5120",["cop"]="1302",["yin_yang"]="753",["waning_gibbous_moon"]="5169",["pig_nose"]="231",["keycap_star"]="7133",["man_frowning"]="1225",["man_golfing"]="1399",["motorway"]="5101",["oil_drum"]="5103",["hammer_and_wrench"]="6185",["name_badge"]="7104",["hindu_temple"]="543",["cold_sweat"]="175",["flag_ga"]="888",["no_mouth"]="136",["necktie"]="66",["left_speech_bubble"]="1146",["clock730"]="5155",["baggage_claim"]="712",["walking"]="1361",["passport_control"]="710",["flag_ad"]="89",["fairy"]="1337",["ferris_wheel"]="559",["toilet"]="6217",["baby_symbol"]="78",["oncoming_automobile"]="586",["mens"]="75",["mountain_bicyclist"]="1419",["flag_py"]="8199",["flag_re"]="8201",["umbrella_with_rain_drops"]="5201",["flag_kp"]="8134",["man_man_boy"]="1460",["flag_et"]="880",["card_index"]="6160",["man_biking"]="1417",["flag_ma"]="8150",["passenger_ship"]="5114",["football"]="433",["eight_pointed_black_star"]="7120",["monkey_face"]="21",["do_not_litter"]="720",["flag_vu"]="8257",["dvd"]="686",["clock1230"]="5141",["lion_face"]="215",["airplane"]="5118",["no_good"]="1230",["rotating_light"]="5105",["put_litter_in_its_place"]="72",["tropical_drink"]="3107",["speedboat"]="5113",["face_with_thermometer"]="148",["cancer"]="763",["woman_kneeling"]="1369",["hourglass"]="5133",["mountain_cableway"]="5126",["flag_rw"]="8205",["shaved_ice"]="386",["mechanical_arm"]="1184",["articulated_lorry"]="589",["flag_al"]="814",["a"]="7150",["1234"]="7147",["blue_car"]="587",["green_apple"]="310",["key"]="6179",["womens"]="76",["couple_with_heart"]="1450",["female_scientist"]="1283",["older_man"]="1222",["flag_cx"]="863",["crystal_ball"]="459",["spades"]="467",["fire_engine"]="580",["minibus"]="578",["trolleybus"]="577",["table_tennis_paddle_and_ball"]="442",["grin"]="14",["train2"]="567",["light_rail"]="569",["flag_ve"]="8253",["bullettrain_front"]="566",["dart"]="455",["love_hotel"]="531",["baby_chick"]="264",["bullettrain_side"]="565",["railway_car"]="564",["flag_bz"]="845",["steam_locomotive"]="563",["hand"]="1153",["female_vampire"]="1342",["leg"]="1186",["skull"]="193",["motor_boat"]="5116",["raised_hands"]="1175",["white_haired_woman"]="1215",["raising_hand"]="1239",["woman_raising_hand"]="1241",["post_office"]="526",["flag_nr"]="8182",["wilted_flower"]="2111",["bow"]="1245",["man_bowing"]="1246",["woman_bowing"]="1247",["woman_gesturing_ok"]="1235",["triangular_flag_on_post"]="82",["black_square_button"]="7217",["woman_gesturing_no"]="1232",["face_with_rolling_eyes"]="139",["u7981"]="7175",["slightly_smiling_face"]="19",["slightly_frowning_face"]="165",["u6708"]="7169",["pouting_cat"]="1111",["point_down"]="1166",["kissing_cat"]="1108",["heart_eyes_cat"]="1106",["bee"]="298",["man_bouncing_ball"]="1411",["woman_woman_girl_girl"]="1469",["prayer_beads"]="640",["couch_and_lamp"]="6215",["chestnut"]="331",["male_technologist"]="1285",["scream"]="179",["bellhop_bell"]="5131",["face_with_head_bandage"]="149",["open_mouth"]="167",["sob"]="178",["poultry_leg"]="341",["flag_ea"]="873",["green_heart"]="1130",["flying_saucer"]="5130",["level_slider"]="657",["thumbsup"]="1168",["triumph"]="187",["bridge_at_night"]="556",["broken_heart"]="1126",["cry"]="177",["rage"]="188",["beer"]="3108",["amphora"]="3121",["disappointed"]="182",["stuck_out_tongue_closed_eyes"]="126",["stuck_out_tongue"]="123",["rabbit"]="246",["flag_pa"]="8186",["kissing_smiling_eyes"]="121",["flag_je"]="8124",["kissing_heart"]="117",["flag_cp"]="858",["kissing"]="118",["mans_shoe"]="626",["confounded"]="180",["pensive"]="143",["sweat"]="183",["neutral_face"]="134",["large_blue_diamond"]="7209",["memo"]="6151",["sunglasses"]="160",["house_with_garden"]="524",["wink"]="111",["flag_io"]="8119",["smiling_imp"]="191",["flag_ss"]="8221",["european_castle"]="537",["flag_mw"]="8169",["flag_br"]="839",["woman_getting_haircut"]="1360",["smile"]="13",["flag_co"]="857",["red_haired_woman"]="1211",["tokyo_tower"]="539",["mount_fuji"]="511",["tired_face"]="185",["dagger_knife"]="6186",["drooling_face"]="145",["male_student"]="1258",["wastebasket"]="6174",["pear"]="311",["u6709"]="7170",["flag_ug"]="8245",["moon"]="5167",["soccer"]="428",["card_file_box"]="6172",["new"]="7159",["deciduous_tree"]="2118",["blossom"]="2114",["frame_with_picture"]="476",["u55b6"]="7182",["tomato"]="316",["flag_mh"]="8156",["back"]="743",["flag_nu"]="8183",["flag_jm"]="8125",["clock930"]="5159",["bento"]="363",["cake"]="391",["flag_ta"]="8227",["zombie"]="1352",["curling_stone"]="454",["flag_tc"]="8228",["synagogue"]="544",["b"]="7152",["banana"]="36",["suspension_railway"]="5125",["flag_bb"]="826",["flag_si"]="8213",["negative_squared_cross_mark"]="7112",["black_square_for_stop"]="788",["inbox_tray"]="6137",["flag_kz"]="8138",["spock_hand"]="1154",["hamburger"]="344",["pager"]="673",["flag_pf"]="8188",["abc"]="7149",["taxi"]="583",["flag_cc"]="847",["leo"]="764",["tornado"]="5194",["dash"]="1141",["sun_with_face"]="5179",["goal_net"]="446",["yen"]="6122",["peach"]="312",["flag_be"]="828",["golfer"]="1398",["syringe"]="6208",["waving_white_flag"]="85",["cyclone"]="5197",["flag_ly"]="8149",["honey_pot"]="398",["grapes"]="31",["flag_aw"]="822",["flashlight"]="6101",["rainbow_flag"]="86",["flag_ch"]="851",["twisted_rightwards_arrows"]="773",["corn"]="322",["thinking_face"]="131",["flag_sd"]="8209",["two"]="7136",["black_small_square"]="7206",["man_in_lotus_position"]="1438",["flag_ke"]="8128",["flag_mo"]="8161",["flag_fi"]="882",["lacrosse"]="441",["roller_coaster"]="560",["mechanical_leg"]="1185",["flag_sk"]="8215",["flag_ax"]="823",["scream_cat"]="1109",["flag_bj"]="833",["smiley"]="12",["umbrella"]="5200",["pirate_flag"]="87",["truck"]="588",["flag_mg"]="8155",["gloves"]="610",["woman_woman_girl_boy"]="1467",["rain_cloud"]="5191",["flag_hn"]="8109",["arrow_up_small"]="783",["flag_tl"]="8235",["wind_blowing_face"]="5196",["flag_tw"]="8242",["bug"]="296",["woman_girl"]="1477",["mailbox"]="6139",["female_farmer"]="1268",["100"]="1136",["woman_tipping_hand"]="1238",["couple"]="1444",["angry"]="189",["female_student"]="1259",["bomb"]="1143",["bike"]="597",["snake"]="280",["bone"]="1193",["man_with_probing_cane"]="1371",["flag_gy"]="8106",["book"]="6106",["black_medium_square"]="7202",["gear"]="6193",["flag_li"]="8142",["floppy_disk"]="684",["crescent_moon"]="5172",["mostly_sunny"]="5188",["dizzy_face"]="156",["clock1"]="5142",["diya_lamp"]="6103",["new_moon"]="5164",["top"]="747",["ski"]="452",["dragon_face"]="281",["cow"]="224",["coconut"]="317",["person_frowning"]="1224",["tv"]="692",["flag_ic"]="8113",["waning_crescent_moon"]="5171",["shower"]="6218",["woman_standing"]="1366",["game_die"]="464",["flag_va"]="8251",["flag_dz"]="872",["poodle"]="29",["bird"]="266",["zero"]="7134",["male_mage"]="1335",["foggy"]="549",["flag_ws"]="8259",["flag_ao"]="816",["building_construction"]="519",["dog2"]="26",["flag_rs"]="8203",["anger"]="1137",["cherry_blossom"]="2107",["space_invader"]="1101",["man_man_boy_boy"]="1463",["mahjong"]="473",["flag_nz"]="8184",["herb"]="2122",["tangerine"]="34",["white_square_button"]="7216",["u6e80"]="7183",["school_satchel"]="625",["black_medium_small_square"]="7204",["flag_sz"]="8226",["atm"]="71",["flag_gu"]="8104",["zzz"]="1149",["flag_lr"]="8144",["love_letter"]="1116",["popcorn"]="359",["page_facing_up"]="6115",["flag_pn"]="8194",["ideograph_advantage"]="7172",["man_girl_girl"]="1474",["flag_bm"]="835",["apple"]="39",["male_guard"]="1309",["convenience_store"]="532",["boy"]="1200",["flag_england"]="8266",["department_store"]="534",["cut_of_meat"]="342",["badminton_racquet_and_shuttlecock"]="443",["flag_la"]="8139",["flower_playing_cards"]="474",["rabbit2"]="247",["pill"]="6210",["black_heart"]="1134",["whale2"]="286",["snail"]="294",["racehorse"]="220",["woman_playing_handball"]="1433",["glass_of_milk"]="3100",["woman_boy_boy"]="1476",["octopus"]="292",["arrow_left"]="733",["nail_care"]="1181",["persevere"]="181",["notes"]="655",["woman_woman_boy_boy"]="1468",["flag_dj"]="868",["beetle"]="299",["tropical_fish"]="289",["outbox_tray"]="6136",["seedling"]="2116",["flag_un"]="8247",["dolphin"]="287",["mouse"]="242",["bookmark"]="6119",["bread"]="332",["sos"]="7164",["male_vampire"]="1341",["six_pointed_star"]="759",["cat"]="213",["wolf"]="210",["books"]="6110",["latin_cross"]="754",["nose"]="1190",["end"]="744",["flag_gr"]="8101",["female_firefighter"]="1301",["point_up_2"]="1164",["point_right"]="1163",["innocent"]="113",["sheep"]="233",["upside_down_face"]="110",["open_hands"]="1176",["clap"]="1174",["ghost"]="199",["people_holding_hands"]="1442",["star_struck"]="116",["female_mechanic"]="1274",["unicorn_face"]="221",["lipstick"]="641",["japanese_castle"]="536",["arrows_counterclockwise"]="742",["bookmark_tabs"]="6118",["bicyclist"]="1416",["man_woman_girl_boy"]="1457",["sleeping"]="146",["shallow_pan_of_food"]="355",["arrow_right_hook"]="738",["woman_girl_boy"]="1478",["flag_sr"]="8220",["man_tipping_hand"]="1237",["flag_gm"]="897",["information_desk_person"]="1236",["flag_hm"]="8108",["female_singer"]="1289",["vs"]="7166",["woman_playing_water_polo"]="1430",["flag_vn"]="8256",["mag"]="697",["closed_book"]="6105",["woman_woman_girl"]="1466",["curly_haired_woman"]="1213",["flag_kh"]="8130",["japanese_goblin"]="198",["incoming_envelope"]="6134",["mailbox_with_mail"]="6141",["musical_keyboard"]="664",["hatching_chick"]="263",["taurus"]="761",["female_judge"]="1265",["minidisc"]="683",["handbag"]="622",["man_with_gua_pi_mao"]="1319",["dna"]="6204",["u6307"]="7171",["woman_in_motorized_wheelchair"]="1375",["mosquito"]="2104",["alien"]="1100",["u5272"]="7173",["flag_ph"]="8190",["eight_spoked_asterisk"]="7119",["male_mechanic"]="1273",["rice_ball"]="365",["flag_mv"]="8168",["scales"]="6195",["dancer"]="1382",["city_sunset"]="554",["two_men_holding_hands"]="1445",["flag_sb"]="8207",["ring"]="642",["haircut"]="1358",["flag_cy"]="864",["flag_eg"]="876",["woman_with_bunny_ears_partying"]="1387",["horse"]="219",["flag_pe"]="8187",["flag_gs"]="8102",["woman_surfing"]="1403",["right_anger_bubble"]="1147",["sweat_drops"]="1140",["partly_sunny_rain"]="5190",["battery"]="675",["waffle"]="338",["dollar"]="6123",["saxophone"]="662",["guardsman"]="1308",["seat"]="5123",["bank"]="529",["man_getting_haircut"]="1359",["man_in_manual_wheelchair"]="1377",["large_orange_diamond"]="7208",["male_office_worker"]="1279",["man_climbing"]="1392",["confetti_ball"]="49",["girl"]="1201",["flag_fo"]="886",["leafy_green"]="325",["woman_boy"]="1475",["telephone_receiver"]="672",["cd"]="685",["satellite_antenna"]="6207",["turtle"]="278",["flag_mf"]="8154",["female_factory_worker"]="1277",["racing_car"]="591",["funeral_urn"]="6232",["mobile_phone_off"]="796",["mango"]="38",["volleyball"]="432",["billed_cap"]="638",["man_man_girl_boy"]="1462",["blowfish"]="290",["palms_up_together"]="1177",["heart"]="1127",["flag_gp"]="899",["dizzy"]="1139",["flag_sj"]="8214",["electric_plug"]="676",["man_lifting_weights"]="1414",["yarn"]="479",["station"]="570",["construction_worker"]="1311",["droplet"]="5209",["capital_abcd"]="7145",["curly_haired_man"]="1207",["flag_vg"]="8254",["flag_bt"]="841",["checkered_flag"]="81",["heavy_dollar_sign"]="6131",["flag_gl"]="896",["small_blue_diamond"]="7211",["signal_strength"]="794",["dog"]="25",["worried"]="164",}
--addons/scb-29/lua/scb/cl_chatbox.lua:
if SCB_LOADED then return end

local draw = draw
local surface = surface
local math = math
local hook = hook
local gui = gui
local net = net

local IsValid = IsValid
local ipairs = ipairs

local color_white = color_white

local scb = scb
local sui = sui
local SUI = scb.SUI
local utf8 = sui.utf8
local language = scb.language
local UnPredictedCurTime = UnPredictedCurTime

for k, v in ipairs({18, 16, 14}) do
	_G["SCB_" .. v] = SUI.CreateFont(tostring(v), "Roboto", v)
end

scb.pattern = "%{ *([%w_%#%$@%*!]+)([^%{}]-) *%}"

local SetVisible = FindMetaTable("Panel").SetVisible

function scb.open_parsers_menu()
	if IsValid(scb.parsers_menu) then
		return scb.parsers_menu:Remove()
	end

	local text_entry = scb.chatbox.text_entry

	local parsers_menu = vgui.Create("SCB.Frame")
	scb.parsers_menu = parsers_menu

	parsers_menu:Center()
	parsers_menu:MakePopup()
	parsers_menu:SetTitle("SCB | Chat Parsers")
	parsers_menu:AddAnimations(320, 340)

	local parsers_list = parsers_menu:Add("SCB.ScrollPanel")
	parsers_list:Dock(FILL)
	parsers_list:DockMargin(4, 4, 4, 4)
	parsers_list:InvalidateParent(true)
	parsers_list:InvalidateLayout(true)

	for k, v in ipairs(scb.chat_parsers) do
		local parser = parsers_list:Add("DButton")
		parser:Dock(TOP)
		parser:DockMargin(2, 2, 2, 2)
		parser:DockPadding(2, 2, 2, 2)
		parser:InvalidateParent(true)
		parser:SetText("")

		parser:SUI_TDLib()
		parser:ClearPaint()
		parser:Background(SUI.GetColor("on_sheet"), 3)
		parser:FadeHover(SUI.GetColor("on_sheet_hover"), _, 3)

		function parser:DoClick()
			parsers_menu:Remove()
			scb.chatbox:MoveToFront()
			text_entry:RequestFocus()
			text_entry:AddValue(v[3] .. " ")
		end

		local title = parser:Add("SCB.Label")
		title:Dock(TOP)
		title:SetAutoStretchVertical(true)
		title:SetWrap(true)
		title:SetFont(SCB_16)
		title:SetText(v[1])
		title:InvalidateParent(true)

		local example = parser:Add("SCB.ChatLine")
		example:Dock(TOP)
		example:DockMargin(0, 1, 0, 0)
		example:InvalidateParent(true)
		example:InvalidateLayout(true)
		example:Parse(v[2])
		example:SetMouseInputEnabled(false)

		function parser:PerformLayout()
			self:SizeToChildren(false, true)
		end
	end
end

local function invalidate_children(self, recursive)
	local children = self:GetChildren()
	for i = 1, #children do
		if recursive then
			invalidate_children(children[i])
		else
			children[i]:InvalidateLayout(true)
		end
	end

	self:InvalidateLayout(true)
end

function scb.create_chatbox()
	if IsValid(scb.chatbox) then return end

	sui.TDLib.Start()

	local frame = vgui.Create("SCB.Frame", nil, "SCB")
	scb.chatbox = frame

	local c_x = CreateClientConVar("scb_x", sui.scale(18), true, false, "")
	local c_y = CreateClientConVar("scb_y", ScrH() - SUI.Scale(220) - sui.scale(170), true, false, "")
	local c_w = CreateClientConVar("scb_w", 480, true, false, "")
	local c_h = CreateClientConVar("scb_h", 220, true, false, "")

	frame.SetSize = frame.RealSetSize
	-- remove scaling for chatbox
	SUI.RemoveScaleHook(frame)

	frame:SetSizable(true)
	frame:SetMinWidth(SUI.Scale(300))
	frame:SetMinHeight(SUI.Scale(160))
	frame:SetSize(c_w:GetInt(), c_h:GetInt())
	frame:SetPos(c_x:GetInt(), c_y:GetInt())
	frame:ParentToHUD()
	frame:MakePopup()

	frame.title.background_color = true

	local chatbox_title = scb.config.chatbox_title
	frame:SetTitle(chatbox_title)
	if chatbox_title:find("SERVER_NAME") or chatbox_title:find("PLAYER_COUNT") then
		local delay = 2
		local next_run = UnPredictedCurTime()

		frame:On("Think", function(s)
			if UnPredictedCurTime() < next_run then return end
			next_run = UnPredictedCurTime() + delay
			s:SetTitle(chatbox_title:gsub("SERVER_NAME", GetHostName()):gsub("PLAYER_COUNT", player.GetCount()))
		end)
	end

	function frame:OnPosChanged()
		c_x:SetInt(self.x)
		c_y:SetInt(self.y)
	end

	function frame:OnSizeChanged(w, h)
		c_w:SetInt(w)
		c_h:SetInt(h)
	end

	function frame:AddPanelToHide(panel)
		if not self.panels_to_hide then
			self.panels_to_hide = {self}
		end
		table.insert(self.panels_to_hide, panel)
	end

	function frame:SetVisible(visible)
		self.hidden = not visible
		local panels_to_hide = self.panels_to_hide
		for i = 1, #panels_to_hide do
			local v = panels_to_hide[i]
			v.Paint, v.oldPaint = visible and (v.oldPaint or v.Paint) or nil, not visible and v.Paint or nil
			if v.background_color or v.old_bg_color then
				v.background_color, v.old_bg_color = visible and (v.old_bg_color or v.background_color) or nil, not visible and v.background_color or nil
				v:SetBGColor(v.background_color)
			end
		end
		return self.hidden
	end

	function frame:IsVisible()
		return not self.hidden
	end

	frame.close.DoClick = chat.Close

	local scroll_panel = frame:Add("SCB.ScrollPanel")
	scroll_panel:Dock(FILL)
	scroll_panel:DockMargin(4, 4, 4, 0)
	scroll_panel:SetFromBottom(true)

	function scroll_panel:ScrollToBottom()
		self:GetParent():InvalidateLayout(true)
		invalidate_children(self)

		local vbar = self.VBar
		vbar:SetScroll(vbar.CanvasSize)
	end

	local canvas = scroll_panel:GetCanvas()
	canvas:DockPadding(2, 2, 2, 2)

	function scroll_panel:ShouldScrollDown()
		local vbar = self.VBar
		local canvas_size = vbar.CanvasSize
		return frame.hidden or canvas_size == 1 or canvas_size <= vbar.scroll_target
	end

	local count = 0
	local max_messages_convar = GetConVar("scb_max_messages")
	local fixed_width = false
	function scroll_panel:ChildAdded()
		local vbar = self.VBar
		if vbar.Enabled then
			if not fixed_width then
				for k, v in ipairs(canvas.children) do
					if v.ScaleChanged then
						v:ScaleChanged()
					end
				end
				fixed_width = true
				return self:ChildAdded()
			end
		else
			fixed_width = nil
		end

		count = count + 1

		local max = max_messages_convar:GetInt()
		if count <= max then return end

		local down = self:ShouldScrollDown()

		local full_h = 0
		local children = canvas.children
		for i = count, max + 1, -1 do
			local child = children[i - max]
			if not child.being_removed then
				child.being_removed = true
				full_h = full_h + child:GetTotalH()
				child:Remove()

				count = count - 1
			end
		end

		local scroll = vbar.Scroll
		if down then
			vbar.Scroll = scroll - full_h
		else
			vbar.Scroll = scroll - full_h
			vbar.scroll_target = scroll
		end
	end

	frame:InvalidateLayout(true)
	invalidate_children(frame, true)

	local preview = vgui.Create("Panel")
	preview:SetMouseInputEnabled(false)
	preview:ParentToHUD()

	local preview_bg = vgui.Create("Panel")
	preview_bg:ParentToHUD()
	preview_bg:MoveToBack()
	SetVisible(preview_bg, false)

	preview_bg:Blur()
		:Background(Color(50, 50, 50, 200))

	frame:On("PerformLayout", function(s, w, h)
		local f_x, f_y = s:GetPos()
		local new_x, new_y = f_x + ((w / 2) - ((preview.w or 0) / 2)), f_y + h + 4
		preview:SetPos(new_x, new_y)
		preview_bg:SetPos(new_x - 4, new_y - 4)
	end)

	local text_entry = frame:Add("SCB.TextEntry")
	text_entry:Dock(BOTTOM)
	text_entry:DockMargin(4, 4, 4, 4)
	text_entry:SetTall(24)
	text_entry:SetPlaceholder(language.type_something)
	text_entry:SetFont(SCB_18)
	text_entry:SetMultiline(true)
	text_entry:SetVerticalScrollbarEnabled(false)
	text_entry:InvalidateParent(true)
	text_entry:SetMaxChars(126)
	text_entry:SetNoBar(true)
	text_entry.no_scale = true

	if scb.config.hide_language_sign then
		text_entry:SetDrawLanguageID(false)
	end

	function text_entry:OnEnter()
		local txt = self:GetValue()
		if txt == "" then chat.Close() return end
		local length = #txt
		net.Start(frame.bteam ~= 1 and "SCB.SendMessageTeam" or "SCB.SendMessage")
			net.WriteUInt(length, 8)
			net.WriteData(txt, length)
		net.SendToServer()
		self:AddHistory(txt)
		chat.Close()
	end

	local old_Paint = text_entry.Paint
	function text_entry:Paint(w, h)
		local outline = SUI.GetColor("scroll_panel_outline")
		if outline then
			sui.TDLib.DrawOutlinedBox(3, 0, 0, w, h, SUI.GetColor("scroll_panel"), outline, 1)
		else
			draw.RoundedBox(3, 0, 0, w, h, SUI.GetColor("scroll_panel"))
		end

		old_Paint(self, w, h)
	end

	function text_entry:OnValueChange(value)
		local down = scroll_panel:ShouldScrollDown()

		-- https://github.com/ValveSoftware/source-sdk-2013/blob/0d8dceea4310fde5706b3ce1c70609d72a38efdf/mp/src/vgui2/vgui_controls/TextEntry.cpp#L3790
		self:SetTall(self:GetNumLines() * (SUI.Scale(18) --[[font size]] + 1) + 1 + 2)

		if down then
			scroll_panel:ScrollToBottom()
		end

		if value == "" then
			gui.InternalKeyCodeTyped(KEY_LEFT)
		end

		hook.Run("ChatTextChanged", value)
	end
	text_entry:OnValueChange("")

	do
		local emojis_table = {
			"grinning", "grin", "joy",
			"smiley", "smile", "sweat_smile",
			"laughing", "innocent", "smiling_imp",
			"wink", "blush", "yum", "relieved",
			"heart_eyes", "sunglasses", "smirk",
			"neutral_face", "expressionless", "unamused",
			"sweat", "pensive", "confused",
			"rage", "partying_face", "cold_face",
			"hot_face", "face_with_cowboy_hat"
		}

		local real_size = 0
		local mat, padding = SUI.Material("scb/emojis/flushed.png"), 3

		local emojis_button = text_entry:Add("DButton")
		emojis_button:SetText("")
		emojis_button:SetMouseInputEnabled(true)
		emojis_button:NoClipping(true)

		function emojis_button:IsActive()
			return self:IsHovered() or IsValid(scb.emojis_menu)
		end

		local inactive_col = Color(175, 175, 175)
		function emojis_button:Paint(w, h)
			surface.SetDrawColor(self:IsActive() and color_white or inactive_col)
			surface.SetMaterial(mat)
			surface.DrawTexturedRectRotated(w * 0.5, h * 0.5, real_size, real_size, 0)
		end

		function emojis_button:OnCursorEntered()
			if not IsValid(scb.emojis_menu) then
				mat = SUI.Material("scb/emojis/" .. emojis_table[math.random(1, #emojis_table)] .. ".png")
			end
		end

		function emojis_button:Think()
			self:MoveToFront()
			real_size = Lerp(RealFrameTime() * 15, real_size, self:IsActive() and SUI.Scale(22) or SUI.Scale(18))
		end

		function emojis_button:DoClick()
			if IsValid(scb.emojis_menu) then
				return self:OnRemove()
			end

			local emojis_menu = vgui.Create("SCB.EmojiList")
			emojis_menu.button = self
			emojis_menu:FixPos()

			scb.emojis_menu = emojis_menu
		end

		function emojis_button:OnRemove()
			if IsValid(scb.emojis_menu) then
				scb.emojis_menu:Remove()
			end
		end

		text_entry:On("PerformLayout", function(s, w, h)
			local size = SUI.ScaleEven(18)
			emojis_button:SetSize(size, size)
			emojis_button:SetPos(w - (size + padding), h / 2 - size / 2)
		end)

		frame.emojis_button = emojis_button
		frame:AddPanelToHide(emojis_button)
	end

	-- Message Preview
	text_entry:On("OnValueChange", function(self, value)
		preview:SetWide(SUI.Scale(340))
		preview:Clear()
		SetVisible(preview_bg, false)

		if value == "" then return end

		local line = preview:Add("SCB.ChatLine")
		line:SetPlayer(LocalPlayer())
		line:SetAlpha(255)
		line:Parse(value)
		line:SizeToChildren(true, true)

		preview:SizeToChildren(false, true)
		preview:SetWide(line:GetMessageW())
		preview.w = line:GetMessageW()
		preview_bg:SetSize(preview.w + 8, preview:GetTall() + 8)
		SetVisible(preview_bg, true)
	end)
	--

	-- Emoji Select
	local emoji_list

	local open_emojis_list = function(emoji_name, start, _end)
		local selected_text
		if IsValid(emoji_list) then
			selected_text = emoji_list.selected_emoji and emoji_list.selected_emoji.name
			emoji_list:Remove()
		end

		local emojis = scb.search_emojis(emoji_name)
		if #emojis == 0 then return end

		emoji_list = frame:Add("SCB.EmojisSelect")
		emoji_list:SetWide(text_entry:GetWide())
		emoji_list:SetTextEntry(text_entry)
		emoji_list:SetStartEnd(start, _end)

		for _, v in ipairs(emojis) do
			local emoji = emoji_list:AddEmoji(v.name)
			if emoji.name == selected_text then
				emoji_list.selected_emoji = emoji
			end

			if #emoji_list.emojis == math.floor(SUI.Scale(120) / SUI.Scale(22)) then
				break
			end
		end

		emoji_list:SetPos(text_entry.x, text_entry.y - emoji_list:GetTall())
	end

	local typing_emoji = function()
		local value = text_entry:GetValue()
		local start, _end, emoji_name = 0
		while true do
			start, _end, emoji_name = value:find("%:([%w_]+)", _end)
			if not start then break end
			if utf8.len(value:sub(1, _end)) == text_entry:GetCaretPos() and not value:sub(_end + 1, _end + 1):match("%S") then
				return open_emojis_list(emoji_name:lower(), start, _end)
			end
			_end = _end + 1
		end

		if IsValid(emoji_list) then
			emoji_list:Remove()
		end
	end

	local old = text_entry.OnKeyCodeTyped
	function text_entry:OnKeyCodeTyped(code)
		if frame.hidden then return end
		if emoji_list and emoji_list[code] then
			return emoji_list[code](emoji_list)
		elseif code == KEY_ESCAPE then
			gui.HideGameUI()
			chat.Close()
			return
		elseif code == KEY_TAB then
			local text = hook.Run("OnChatTab", self:GetValue())
			if scb.isstring(text) then
				self:SetValue(text)
			end
			self:SetCaretPos(#self:GetValue())
			self:RequestFocus()
			return true
		end

		return old(self, code)
	end

	text_entry:On("OnValueChange", typing_emoji)
	text_entry:On("OnKeyCodeReleased", function(_, code)
		if code == KEY_LEFT or code == KEY_RIGHT then
			typing_emoji()
		end
	end)

	SUI.OnScaleChanged("EmojisListRemove", function()
		if IsValid(emoji_list) then
			emoji_list:Remove()
		end

		timer.Simple(0, function()
			text_entry:OnValueChange(text_entry:GetValue())
		end)
	end)
	--

	local settings = frame:AddHeaderButton("scb/settings.png", "settings", function()
		scb.open_settings()
	end)
	local parsers = frame:AddHeaderButton("scb/mind.png", "settings", function()
		scb.open_parsers_menu()
	end)

	frame:AddPanelToHide(frame.header)
	frame:AddPanelToHide(frame.title)
	frame:AddPanelToHide(frame.close)
	frame:AddPanelToHide(frame.close.image)
	frame:AddPanelToHide(settings)
	frame:AddPanelToHide(settings.image)
	frame:AddPanelToHide(parsers)
	frame:AddPanelToHide(parsers.image)
	frame:AddPanelToHide(scroll_panel)
	frame:AddPanelToHide(scroll_panel.VBar)
	frame:AddPanelToHide(scroll_panel.VBar.btnGrip)
	frame:AddPanelToHide(text_entry)

	frame.scroll_panel = scroll_panel
	frame.text_entry = text_entry

	sui.TDLib.End()

	local camera_hidden = false
	/*
	timer.Create("SCB.CameraCheck", 1, 0, function()
		local wep = LocalPlayer():GetActiveWeapon()
		if IsValid(wep) and wep:GetClass() == "gmod_camera" then
			camera_hidden = true
			SetVisible(scb.chatbox, false)
		else
			if camera_hidden then
				camera_hidden = false
				SetVisible(scb.chatbox, true)
			end
		end
	end)
	*/
end

SUI.RemoveTheme("Light")

SUI.AddToTheme("Dark", {
	settings = Color(255, 255, 255, 133),
	settings_hover = Color(65, 185, 255),
	settings_press = Color(255, 255, 255, 30),

	emoji_select_menu = Color(18, 18, 18),
	emoji_select_menu_selected = Color(200, 200, 200, 1),
})

SUI.AddToTheme("Blur", {
	settings = Color(200, 200, 200),
	settings_hover = Color(65, 185, 255),
	settings_press = Color(255, 255, 255, 30),

	emoji_select_menu = Color(50, 50, 50, 230),
	emoji_select_menu_selected = Color(40, 40, 40),
})

--lua/autorun/sg_player.lua:
return gluapack()()
--addons/[binbon]misc/lua/autorun/sh_luctus_new_anims.lua:
hook.Add("InitPostEntity", "luctus_performance", function()
    hook.Remove("PlayerTick", "TickWidgets") --Luctus Performance --Made by OverlordAkise
    function widgets.PlayerTick()
    end

    hook.Remove("SetupMove", "DarkRP_DoorRamJump")
    hook.Remove("SetupMove", "DarkRP_WeaponSpeed")
    hook.Remove("Move", "DruggedPlayer")
    local plycache = {}
    local GAM = gmod.GetGamemode()
    local plymeta = FindMetaTable("Player")
    local entmeta = FindMetaTable("Entity")
    local plyOnGround = entmeta.OnGround
    local plyAnimRestartMainSequence = plymeta.AnimRestartMainSequence
    local plyWaterLevel = entmeta.WaterLevel
    local plyTranslateWeaponActivity = plymeta.TranslateWeaponActivity
    local plyGetMoveType = entmeta.GetMoveType
    local plyIsFlagSet = entmeta.IsFlagSet
    local plySetPlaybackRate = entmeta.SetPlaybackRate
    local entLookupSequence = entmeta.LookupSequence
    local plyInVehicle = plymeta.InVehicle
    function GAM:HandlePlayerJumping(ply, velocity)
        if plyGetMoveType(ply) == MOVETYPE_NOCLIP then
            plycache[ply].m_bJumping = false
            return
        end

        if not plycache[ply].m_bJumping and not plyOnGround(ply) and plyWaterLevel(ply) <= 0 then -- airwalk more like hl2mp, we airwalk until we have 0 velocity, then it's the jump animation -- underwater we're alright we airwalking
            if not plycache[ply].m_fGroundTime then
                plycache[ply].m_fGroundTime = CurTime()
            elseif (CurTime() - plycache[ply].m_fGroundTime) > 0 and velocity:Length2DSqr() < 0.25 then
                plycache[ply].m_bJumping = true
                plycache[ply].m_bFirstJumpFrame = false
                plycache[ply].m_flJumpStartTime = 0
            end
        end

        if plycache[ply].m_bJumping then
            if plycache[ply].m_bFirstJumpFrame then
                plycache[ply].m_bFirstJumpFrame = false
                plyAnimRestartMainSequence(ply)
            end

            if (plyWaterLevel(ply) >= 2) or ((CurTime() - plycache[ply].m_flJumpStartTime) > 0.2 and plyOnGround(ply)) then
                plycache[ply].m_bJumping = false
                plycache[ply].m_fGroundTime = nil
                plyAnimRestartMainSequence(ply)
            end

            if plycache[ply].m_bJumping then
                plycache[ply].CalcIdeal = ACT_MP_JUMP
                return true
            end
        end
        return false
    end

    function GAM:HandlePlayerDucking(ply, velocity)
        if not plyIsFlagSet(ply, FL_ANIMDUCKING) then return false end
        if velocity:Length2DSqr() > 0.25 then
            plycache[ply].CalcIdeal = ACT_MP_CROUCHWALK
        else
            plycache[ply].CalcIdeal = ACT_MP_CROUCH_IDLE
        end
        return true
    end

    function GAM:HandlePlayerNoClipping()
    end

    function GAM:HandlePlayerVaulting()
    end

    function GAM:HandlePlayerSwimming()
    end

    function GAM:HandlePlayerLanding()
    end

    function GAM:HandlePlayerDriving(ply)
        if not plyInVehicle(ply) or not IsValid(ply:GetParent()) then return false end
        local pVehicle = ply:GetVehicle()
        if not pVehicle.HandleAnimation and pVehicle.GetVehicleClass then
            local c = pVehicle:GetVehicleClass()
            local t = list.Get("Vehicles")[c]
            if t and t.Members and t.Members.HandleAnimation then
                pVehicle.HandleAnimation = t.Members.HandleAnimation
            else
                pVehicle.HandleAnimation = true -- Prevent this if block from trying to assign HandleAnimation again.
            end
        end

        if isfunction(pVehicle.HandleAnimation) then
            local seq = pVehicle:HandleAnimation(ply)
            if seq ~= nil then plycache[ply].CalcSeqOverride = seq end
        end

        if plycache[ply].CalcSeqOverride == -1 then -- pVehicle.HandleAnimation did not give us an animation
            local class = pVehicle:GetClass()
            if class == "prop_vehicle_jeep" then
                plycache[ply].CalcSeqOverride = entLookupSequence(ply, "drive_jeep")
            elseif class == "prop_vehicle_airboat" then
                plycache[ply].CalcSeqOverride = entLookupSequence(ply, "drive_airboat")
            elseif class == "prop_vehicle_prisoner_pod" and pVehicle:GetModel() == "models/vehicles/prisoner_pod_inner.mdl" then
                plycache[ply].CalcSeqOverride = entLookupSequence(ply, "drive_pd")
            else
                plycache[ply].CalcSeqOverride = entLookupSequence(ply, "sit_rollercoaster")
            end
        end

        local use_anims = plycache[ply].CalcSeqOverride == entLookupSequence(ply, "sit_rollercoaster") or plycache[ply].CalcSeqOverride == entLookupSequence(ply, "sit")
        if use_anims and ply:GetAllowWeaponsInVehicle() and IsValid(ply:GetActiveWeapon()) then
            local holdtype = ply:GetActiveWeapon():GetHoldType()
            if holdtype == "smg" then holdtype = "smg1" end
            local seqid = entLookupSequence(ply, "sit_" .. holdtype)
            if seqid ~= -1 then plycache[ply].CalcSeqOverride = seqid end
        end
        return true
    end

    function GAM:UpdateAnimation(ply, velocity, maxseqgroundspeed)     --[[---------------------------------------------------------
   Name: gamemode:UpdateAnimation()
   Desc: Animation updates (pose params etc) should be done here
-----------------------------------------------------------]] --CL: 34->29ms
        local len = velocity:Length()
        local movement = 1.0
        if len > 0.2 then movement = len / maxseqgroundspeed end
        local rate = math.min(movement, 2)
        if plyWaterLevel(ply) >= 2 then -- if we're under water we want to constantly be swimming..
            rate = math.max(rate, 0.5)
        elseif not plyOnGround(ply) and len >= 1000 then
            rate = 0.1
        end

        plySetPlaybackRate(ply, rate)
        if CLIENT then
            GAM:GrabEarAnimation(ply)
            GAM:MouthMoveAnimation(ply)
        end
    end

    local plyIsPlayingTaunt = plymeta.IsPlayingTaunt -- -- If you don't want the player to grab his ear in your gamemode then -- just override this. --
    local plyIsTyping = plymeta.IsTyping
    function GAM:GrabEarAnimation(ply)
        if not plycache[ply] then return end
        plycache[ply].ChatGestureWeight = plycache[ply].ChatGestureWeight or 0
        if plyIsPlayingTaunt(ply) then -- Don't show this when we're playing a taunt!
            return
        end

        if plyIsTyping(ply) then
            plycache[ply].ChatGestureWeight = math.Approach(plycache[ply].ChatGestureWeight, 1, FrameTime() * 5.0)
        else
            plycache[ply].ChatGestureWeight = math.Approach(plycache[ply].ChatGestureWeight, 0, FrameTime() * 5.0)
        end

        if plycache[ply].ChatGestureWeight > 0 then
            ply:AnimRestartGesture(GESTURE_SLOT_VCD, ACT_GMOD_IN_CHAT, true)
            ply:AnimSetGestureWeight(GESTURE_SLOT_VCD, plycache[ply].ChatGestureWeight)
        end
    end

    local plyIsSpeaking = plymeta.IsSpeaking -- -- Moves the mouth when talking on voicecom --
    local entGetFlexIDByName = entmeta.GetFlexIDByName
    local plyVoiceVolume = plymeta.VoiceVolume --cl only
    local entSetFlexWeight = entmeta.SetFlexWeight
    function GAM:MouthMoveAnimation(ply)
        local flexes = {entGetFlexIDByName(ply, "jaw_drop"), entGetFlexIDByName(ply, "left_part"), entGetFlexIDByName(ply, "right_part"), entGetFlexIDByName(ply, "left_mouth_drop"), entGetFlexIDByName(ply, "right_mouth_drop")}
        local weight = plyIsSpeaking(ply) and math.Clamp(plyVoiceVolume(ply) * 2, 0, 2) or 0
        for k, v in ipairs(flexes) do
            entSetFlexWeight(ply, v, weight)
        end
    end

    function GAM:CalcMainActivity(ply, velocity)
        plycache[ply] = plycache[ply] or {}
        plycache[ply].CalcIdeal = ACT_MP_STAND_IDLE
        plycache[ply].CalcSeqOverride = -1
        if plyOnGround(ply) and not plycache[ply].m_bWasOnGround then ply:AnimRestartGesture(GESTURE_SLOT_JUMP, ACT_LAND, true) end
        if not (self:HandlePlayerJumping(ply, velocity) or self:HandlePlayerDucking(ply, velocity) or self:HandlePlayerDriving(ply)) then
            local len2d = velocity:Length2DSqr()
            if len2d > 22500 then
                plycache[ply].CalcIdeal = ACT_MP_RUN
            elseif len2d > 0.25 then
                plycache[ply].CalcIdeal = ACT_MP_WALK
            end
        end

        plycache[ply].m_bWasOnGround = plyOnGround(ply)
        plycache[ply].m_bWasNoclipping = plyGetMoveType(ply) == MOVETYPE_NOCLIP and not plyInVehicle(ply)
        if plyGetMoveType(ply) == MOVETYPE_NOCLIP then plycache[ply].CalcIdeal = ACT_MP_STAND_IDLE end
        return plycache[ply].CalcIdeal, plycache[ply].CalcSeqOverride
    end

    local IdleActivity = ACT_HL2MP_IDLE
    local IdleActivityTranslate = {}
    IdleActivityTranslate[ACT_MP_STAND_IDLE] = IdleActivity
    IdleActivityTranslate[ACT_MP_WALK] = IdleActivity + 1
    IdleActivityTranslate[ACT_MP_RUN] = IdleActivity + 2
    IdleActivityTranslate[ACT_MP_CROUCH_IDLE] = IdleActivity + 3
    IdleActivityTranslate[ACT_MP_CROUCHWALK] = IdleActivity + 4
    IdleActivityTranslate[ACT_MP_ATTACK_STAND_PRIMARYFIRE] = IdleActivity + 5
    IdleActivityTranslate[ACT_MP_ATTACK_CROUCH_PRIMARYFIRE] = IdleActivity + 5
    IdleActivityTranslate[ACT_MP_RELOAD_STAND] = IdleActivity + 6
    IdleActivityTranslate[ACT_MP_RELOAD_CROUCH] = IdleActivity + 6
    IdleActivityTranslate[ACT_MP_JUMP] = ACT_HL2MP_JUMP_SLAM
    IdleActivityTranslate[ACT_MP_SWIM] = IdleActivity + 9
    IdleActivityTranslate[ACT_LAND] = ACT_LAND
    function GAM:TranslateActivity(ply, act) -- it is preferred you return ACT_MP_* in CalcMainActivity, and if you have a specific need to not tranlsate through the weapon do it here
        local newact = plyTranslateWeaponActivity(ply, act)
        if act == newact then -- select idle anims if the weapon didn't decide
            return IdleActivityTranslate[act]
        end
        return newact
    end

    function GAM:DoAnimationEvent(ply, event, data)
        plycache[ply] = plycache[ply] or {}
        if event == PLAYERANIMEVENT_ATTACK_PRIMARY then
            if plyIsFlagSet(ply, FL_ANIMDUCKING) then
                ply:AnimRestartGesture(GESTURE_SLOT_ATTACK_AND_RELOAD, ACT_MP_ATTACK_CROUCH_PRIMARYFIRE, true)
            else
                ply:AnimRestartGesture(GESTURE_SLOT_ATTACK_AND_RELOAD, ACT_MP_ATTACK_STAND_PRIMARYFIRE, true)
            end
            return ACT_VM_PRIMARYATTACK
        elseif event == PLAYERANIMEVENT_ATTACK_SECONDARY then
            return ACT_VM_SECONDARYATTACK -- there is no gesture, so just fire off the VM event
        elseif event == PLAYERANIMEVENT_RELOAD then
            if plyIsFlagSet(ply, FL_ANIMDUCKING) then
                ply:AnimRestartGesture(GESTURE_SLOT_ATTACK_AND_RELOAD, ACT_MP_RELOAD_CROUCH, true)
            else
                ply:AnimRestartGesture(GESTURE_SLOT_ATTACK_AND_RELOAD, ACT_MP_RELOAD_STAND, true)
            end
            return ACT_INVALID
        elseif event == PLAYERANIMEVENT_JUMP then
            plycache[ply].m_bJumping = true
            plycache[ply].m_bFirstJumpFrame = true
            plycache[ply].m_flJumpStartTime = CurTime()
            plyAnimRestartMainSequence(ply)
            return ACT_INVALID
        elseif event == PLAYERANIMEVENT_CANCEL_RELOAD then
            ply:AnimResetGestureSlot(GESTURE_SLOT_ATTACK_AND_RELOAD)
            return ACT_INVALID
        end
    end
end)
--addons/thirdperson/lua/thirdperson/client/ferma/cl_ferma.lua:
-- Revised: 76561221774735761

FERMA = FERMA or {}
FERMA.CORE = FERMA.CORE or {}

local blur = Material( "pp/blurscreen" )

function FERMA.CORE.Fermafy( style, parent )
    local FT = {}
    
    FT.FWidth = style["width"] or 100
    FT.FHeight = style["height"] or 100

    FT.FPosX = style["x"] or 0
    FT.FPosY = style["y"] or 0

    FT.FLeft = style["left"] or 0
    FT.FRight = style["right"] or 0
    FT.FTop = style["top"] or 0
    FT.FBottom = style["bottom"] or 0

    FT.FMargin = style["margin"] or { 0 }
    FT.FMarginLeft = style["margin-left"] or nil
    FT.FMarginTop = style["margin-top"] or nil
    FT.FMarginRight = style["margin-right"] or nil
    FT.FMarginBottom = style["margin-bottom"] or nil

    FT.FBefore = style["before"] or nil
    FT.FBeforeX = 0
    FT.FBeforeWidth = 0
    FT.FBeforeMarginLeft = 0

    FT.FAfter = style["after"] or nil
    FT.FAfterX = 0
    FT.FAfterWidth = 0
    FT.FAfterMarginRight = 0

    FT.FAbove = style["above"] or nil
    FT.FAboveY = 0
    FT.FAboveHeight = 0
    FT.FAboveMarginTop = 0

    FT.FBelow = style["below"] or nil
    FT.FBelowY = 0
    FT.FBelowHeight = 0
    FT.FBelowMarginBottom = 0

    FT.FZIndex = style["z-index"] or nil
    FT.FAlpha = style["opacity"] or nil
    FT.FFloat = style["float"] or nil

    FT.FPopup = style["popup"] or false
    FT.FCenter = style["center"] or false
    FT.FParent = parent or nil

    if( type( FT.FWidth ) == "string"  ) then
        if( string.match( FT.FWidth, "%%" ) == "%" ) then
            FT.FWidth = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FWidth, "%", "" ) )
        elseif( string.match( FT.FWidth, "vw" ) == "vw" ) then
            FT.FWidth = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FWidth, "vw", "" ) )
        elseif( string.match( FT.FWidth, "vh" ) == "vh" ) then
            FT.FWidth = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FWidth, "vh", "" ) )
        end
    end

    if( type( FT.FHeight ) == "string"  ) then
        if( string.match( FT.FHeight, "%%" ) == "%" ) then
            FT.FHeight = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FHeight, "%", "" ) )
        elseif( string.match( FT.FHeight, "vw" ) == "vw" ) then
            FT.FHeight = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FHeight, "vw", "" ) )
        elseif( string.match( FT.FHeight, "vh" ) == "vh" ) then
            FT.FHeight = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FHeight, "vh", "" ) )
        end
    end

    if( type( FT.FMarginLeft ) == "string"  ) then
        if( string.match( FT.FMarginLeft, "%%" ) == "%" ) then
            FT.FMarginLeft = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FMarginLeft, "%", "" ) )
        elseif( string.match( FT.FMarginLeft, "vw" ) == "vw" ) then
            FT.FMarginLeft = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FMarginLeft, "vw", "" ) )
        elseif( string.match( FT.FMarginLeft, "vh" ) == "vh" ) then
            FT.FMarginLeft = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FMarginLeft, "vh", "" ) )
        end
    end

    if( type( FT.FMarginTop ) == "string"  ) then
        if( string.match( FT.FMarginTop, "%%" ) == "%" ) then
            FT.FMarginTop = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FMarginTop, "%", "" ) )
        elseif( string.match( FT.FMarginTop, "vw" ) == "vw" ) then
            FT.FMarginTop = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FMarginTop, "vw", "" ) )
        elseif( string.match( FT.FMarginTop, "vh" ) == "vh" ) then
            FT.FMarginTop = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FMarginTop, "vh", "" ) )
        end
    end

    if( type( FT.FMarginRight ) == "string"  ) then
        if( string.match( FT.FMarginRight, "%%" ) == "%" ) then
            FT.FMarginRight = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FMarginRight, "%", "" ) )
        elseif( string.match( FT.FMarginRight, "vw" ) == "vw" ) then
            FT.FMarginRight = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FMarginRight, "vw", "" ) )
        elseif( string.match( FT.FMarginRight, "vh" ) == "vh" ) then
            FT.FMarginRight = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FMarginRight, "vh", "" ) )
        end
    end

    if( type( FT.FMarginBottom ) == "string"  ) then
        if( string.match( FT.FMarginBottom, "%%" ) == "%" ) then
            FT.FMarginBottom = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FMarginBottom, "%", "" ) )
        elseif( string.match( FT.FMarginBottom, "vw" ) == "vw" ) then
            FT.FMarginBottom = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FMarginBottom, "vw", "" ) )
        elseif( string.match( FT.FMarginBottom, "vh" ) == "vh" ) then
            FT.FMarginBottom = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FMarginBottom, "vh", "" ) )
        end
    end

    if( type( FT.FMargin[1] ) == "string"  ) then
        if( string.match( FT.FMargin[1], "%%" ) == "%" ) then
            FT.FMargin[1] = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FMargin[1], "%", "" ) )
        elseif( string.match( FT.FMargin[1], "vw" ) == "vw" ) then
            FT.FMargin[1] = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FMargin[1], "vw", "" ) )
        elseif( string.match( FT.FMargin[1], "vh" ) == "vh" ) then
            FT.FMargin[1] = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FMargin[1], "vh", "" ) )
        end
    end

    if( type( FT.FMargin[2] ) == "string"  ) then
        if( string.match( FT.FMargin[2], "%%" ) == "%" ) then
            FT.FMargin[2] = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FMargin[2], "%", "" ) )
        elseif( string.match( FT.FMargin[2], "vw" ) == "vw" ) then
            FT.FMargin[2] = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FMargin[2], "vw", "" ) )
        elseif( string.match( FT.FMargin[2], "vh" ) == "vh" ) then
            FT.FMargin[2] = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FMargin[2], "vh", "" ) )
        end
    end

    if( type( FT.FMargin[3] ) == "string"  ) then
        if( string.match( FT.FMargin[3], "%%" ) == "%" ) then
            FT.FMargin[3] = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FMargin[3], "%", "" ) )
        elseif( string.match( FT.FMargin[3], "vw" ) == "vw" ) then
            FT.FMargin[3] = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FMargin[3], "vw", "" ) )
        elseif( string.match( FT.FMargin[3], "vh" ) == "vh" ) then
            FT.FMargin[3] = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FMargin[3], "vh", "" ) )
        end
    end

    if( type( FT.FMargin[4] ) == "string"  ) then
        if( string.match( FT.FMargin[4], "%%" ) == "%" ) then
            FT.FMargin[4] = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FMargin[4], "%", "" ) )
        elseif( string.match( FT.FMargin[4], "vw" ) == "vw" ) then
            FT.FMargin[4] = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FMargin[4], "vw", "" ) )
        elseif( string.match( FT.FMargin[4], "vh" ) == "vh" ) then
            FT.FMargin[4] = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FMargin[4], "vh", "" ) )
        end
    end

    if( type( FT.FMarginLeft ) == "string"  ) then
        if( string.match( FT.FMarginLeft, "%%" ) == "%" ) then
            FT.FMarginLeft = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FMarginLeft, "%", "" ) )
        elseif( string.match( FT.FMarginLeft, "vw" ) == "vw" ) then
            FT.FMarginLeft = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FMarginLeft, "vw", "" ) )
        elseif( string.match( FT.FMarginLeft, "vh" ) == "vh" ) then
            FT.FMarginLeft = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FMarginLeft, "vh", "" ) )
        end
    end

    if( type( FT.FMarginTop ) == "string"  ) then
        if( string.match( FT.FMarginTop, "%%" ) == "%" ) then
            FT.FMarginTop = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FMarginTop, "%", "" ) )
        elseif( string.match( FT.FMarginTop, "vw" ) == "vw" ) then
            FT.FMarginTop = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FMarginTop, "vw", "" ) )
        elseif( string.match( FT.FMarginTop, "vh" ) == "vh" ) then
            FT.FMarginTop = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FMarginTop, "vh", "" ) )
        end
    end

    if( type( FT.FMarginRight ) == "string"  ) then
        if( string.match( FT.FMarginRight, "%%" ) == "%" ) then
            FT.FMarginRight = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FMarginRight, "%", "" ) )
        elseif( string.match( FT.FMarginRight, "vw" ) == "vw" ) then
            FT.FMarginRight = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FMarginRight, "vw", "" ) )
        elseif( string.match( FT.FMarginRight, "vh" ) == "vh" ) then
            FT.FMarginRight = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FMarginRight, "vh", "" ) )
        end
    end

    if( type( FT.FMarginBottom ) == "string"  ) then
        if( string.match( FT.FMarginBottom, "%%" ) == "%" ) then
            FT.FMarginBottom = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FMarginBottom, "%", "" ) )
        elseif( string.match( FT.FMarginBottom, "vw" ) == "vw" ) then
            FT.FMarginBottom = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FMarginBottom, "vw", "" ) )
        elseif( string.match( FT.FMarginBottom, "vh" ) == "vh" ) then
            FT.FMarginBottom = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FMarginBottom, "vh", "" ) )
        end
    end

    if( type( FT.FLeft ) == "string"  ) then
        if( string.match( FT.FLeft, "%%" ) == "%" ) then
            FT.FLeft = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FLeft, "%", "" ) )
        elseif( string.match( FT.FLeft, "vw" ) == "vw" ) then
            FT.FLeft = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FLeft, "vw", "" ) )
        elseif( string.match( FT.FLeft, "vh" ) == "vh" ) then
            FT.FLeft = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FLeft, "vh", "" ) )
        end
    end

    if( type( FT.FTop ) == "string"  ) then
        if( string.match( FT.FTop, "%%" ) == "%" ) then
            FT.FTop = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FTop, "%", "" ) )
        elseif( string.match( FT.FTop, "vw" ) == "vw" ) then
            FT.FTop = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FTop, "vw", "" ) )
        elseif( string.match( FT.FTop, "vh" ) == "vh" ) then
            FT.FTop = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FTop, "vh", "" ) )
        end
    end

    if( type( FT.FRight ) == "string"  ) then
        if( string.match( FT.FRight, "%%" ) == "%" ) then
            FT.FRight = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FRight, "%", "" ) )
        elseif( string.match( FT.FRight, "vw" ) == "vw" ) then
            FT.FRight = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FRight, "vw", "" ) )
        elseif( string.match( FT.FRight, "vh" ) == "vh" ) then
            FT.FRight = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FRight, "vh", "" ) )
        end
    end

    if( type( FT.FBottom ) == "string"  ) then
        if( string.match( FT.FBottom, "%%" ) == "%" ) then
            FT.FBottom = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FBottom, "%", "" ) )
        elseif( string.match( FT.FBottom, "vw" ) == "vw" ) then
            FT.FBottom = FT.FParent:GetWide() / 100 * tonumber( string.Replace( FT.FBottom, "vw", "" ) )
        elseif( string.match( FT.FBottom, "vh" ) == "vh" ) then
            FT.FBottom = FT.FParent:GetTall() / 100 * tonumber( string.Replace( FT.FBottom, "vh", "" ) )
        end
    end

    -- 76561221774735761

    if( FT.FMarginLeft ~= nil ) then
        FT.FMargin[1] = FT.FMarginLeft
    end

    if( FT.FMarginTop ~= nil ) then
        FT.FMargin[2] = FT.FMarginTop
    end

    if( FT.FMarginRight ~= nil ) then
        FT.FMargin[3] = FT.FMarginRight
    end

    if( FT.FMarginBottom ~= nil ) then
        FT.FMargin[4] = FT.FMarginBottom
    end

    if( FT.FMargin ~= nil ) then
        if( FT.FMargin[4] ~= nil ) then
            FT.FMargin[1] = FT.FMargin[1]
            FT.FMargin[2] = FT.FMargin[2]
            FT.FMargin[3] = FT.FMargin[3]
            FT.FMargin[4] = FT.FMargin[4]
        elseif( FT.FMargin[3] ~= nil ) then
            FT.FMargin[1] = FT.FMargin[1]
            FT.FMargin[2] = FT.FMargin[2]
            FT.FMargin[3] = FT.FMargin[3]
            FT.FMargin[4] = 0
        elseif( FT.FMargin[2] ~= nil ) then
            FT.FMargin[1] = FT.FMargin[1]
            FT.FMargin[2] = FT.FMargin[2]
            FT.FMargin[3] = FT.FMargin[1]
            FT.FMargin[4] = FT.FMargin[2]
        elseif( FT.FMargin[1] ~= nil ) then
            FT.FMargin[1] = FT.FMargin[1]
            FT.FMargin[2] = FT.FMargin[1]
            FT.FMargin[3] = FT.FMargin[1]
            FT.FMargin[4] = FT.FMargin[1]
        else
            FT.FMargin = { 0, 0, 0, 0 }
        end
    end

    if( FT.FBefore ~= nil ) then
        FT.FBeforeX, FT.FBeforeY = FT.FBefore:GetPos()
        FT.FBeforeMarginLeft = FT.FBefore.FT.FMargin[1]
    elseif( FT.FAfter ~= nil ) then
        FT.FAfterX, FT.FAfterY = FT.FAfter:GetPos()
        FT.FAfterWidth = FT.FAfter:GetWide()
        FT.FAfterMarginRight = FT.FAfter.FT.FMargin[3]
    end

    if( FT.FAbove ~= nil ) then
        FT.FAboveX, FT.FAboveY = FT.FAbove:GetPos()
        FT.FAboveMarginTop = FT.FAbove.FT.FMargin[2]
    elseif( FT.FBelow ~= nil ) then
        FT.FBelowX, FT.FBelowY = FT.FBelow:GetPos()
        FT.FBelowHeight = FT.FBelow:GetTall()
        FT.FBelowMarginBottom = FT.FBelow.FT.FMargin[4]
    end

    FT.FWidth = FT.FWidth - FT.FMargin[1] - FT.FMargin[3]
    FT.FHeight = FT.FHeight - FT.FMargin[2] - FT.FMargin[4]

    if( FT.FFloat == "right" ) then
        FT.FPosX = FT.FParent:GetWide() - FT.FPosX - FT.FMargin[3] - FT.FWidth + FT.FLeft - FT.FRight
        FT.FPosY = FT.FPosY + FT.FMargin[2] + FT.FTop - FT.FBottom
    else
        FT.FPosX = FT.FPosX + FT.FMargin[1] + FT.FLeft - FT.FRight
        FT.FPosY = FT.FPosY + FT.FMargin[2] + FT.FTop - FT.FBottom
    end

    if( FT.FBefore ~= nil ) then
        FT.FPosX = FT.FBeforeX - FT.FWidth - FT.FMargin[3] - FT.FBeforeMarginLeft + FT.FLeft - FT.FRight
    elseif( FT.FAfter ~= nil ) then
        FT.FPosX = FT.FAfterX + FT.FAfterWidth + FT.FAfterMarginRight + FT.FMargin[1] + FT.FLeft - FT.FRight
    end
    
    if( FT.FAbove ~= nil ) then
        FT.FPosY = FT.FAboveY - FT.FHeight - FT.FMargin[4] - FT.FAboveMarginTop + FT.FTop - FT.FBottom
    elseif ( FT.FBelow ~= nil ) then
        FT.FPosY = FT.FBelowY + FT.FBelowHeight + FT.FBelowMarginBottom + FT.FMargin[2] + FT.FTop - FT.FBottom
    end

    if( FT.FCenter == true ) then
        FT.FPosX = ( ScrW() / 2 ) - ( FT.FWidth / 2 )
        FT.FPosY = ( ScrH() / 2 ) - ( FT.FHeight / 2)
    end

    /* */

    FT.FBorder = style["border"] or nil
    FT.FBorderColor = style["border-color"] or Color( 0, 0, 0 )
    FT.FBackground = style["background-color"] or Color( 0, 0, 0, 150 )
    FT.FVisibility = style["visibility"] or nil
    FT.FBlur = style["blur"] or nil

    FT.FBorderLeft = style["border-left"] or nil
    FT.FBorderTop = style["border-top"] or nil
    FT.FBorderRight = style["border-right"] or nil
    FT.FBorderBottom = style["border-bottom"] or nil

    if( FT.FBorder ~= nil ) then
        if( FT.FBorder[4] ~= nil ) then
            FT.FBorder[1] = FT.FBorder[1]
            FT.FBorder[2] = FT.FBorder[2]
            FT.FBorder[3] = FT.FBorder[3]
            FT.FBorder[4] = FT.FBorder[4]
        elseif( FT.FBorder[3] ~= nil ) then
            FT.FBorder[1] = FT.FBorder[1]
            FT.FBorder[2] = FT.FBorder[2]
            FT.FBorder[3] = FT.FBorder[3]
            FT.FBorder[4] = 0
        elseif( FT.FBorder[2] ~= nil ) then
            FT.FBorder[1] = FT.FBorder[1]
            FT.FBorder[2] = FT.FBorder[2]
            FT.FBorder[3] = FT.FBorder[1]
            FT.FBorder[4] = FT.FBorder[2]
        elseif( FT.FBorder[1] ~= nil ) then
            FT.FBorder[1] = FT.FBorder[1]
            FT.FBorder[2] = FT.FBorder[1]
            FT.FBorder[3] = FT.FBorder[1]
            FT.FBorder[4] = FT.FBorder[1]
        else
            FT.FBorder = { 0, 0, 0, 0 }
        end
    else
        FT.FBorder = { 0, 0, 0, 0 }
    end

    if( FT.FBorderLeft ~= nil ) then
        FT.FBorder[1] = FT.FBorderLeft
    end

    if( FT.FBorderTop ~= nil ) then
        FT.FBorder[2] = FT.FBorderTop
    end

    if( FT.FBorderRight ~= nil ) then
        FT.FBorder[3] = FT.FBorderRight
    end

    if( FT.FBorderBottom ~= nil ) then
        FT.FBorder[4] = FT.FBorderBottom
    end

    return FT
end

function FERMA.CORE.PaintFermafy( w, h, panel )
    if( panel.FVisibility ~= "hidden" ) then
        FERMA.CORE.DrawBox 
        {
            ["x"] = 0,
            ["y"] = 0,
            ["width"] = w,
            ["height"] = h,
            ["color"] = panel.FBackground
        }

        if( panel.FBlur ~= nil ) then
            FERMA.CORE.DrawBlurBox
            { 
                ["x"] = panel.FPosX,
                ["y"] = panel.FPosY,
                ["strength"] = panel.FBlur
            }
        end

        if( panel.FBorder[1] ~= nil && panel.FBorder[1] ~= 0 ) then
            FERMA.CORE.DrawVerticalLine 
            {
                ["x"] = 0,
                ["y"] = 0,
                ["length"]  = h,
                ["thickness"] = panel.FBorder[1],
                ["color"] = panel.FBorderColor
            }
        end

        if( panel.FBorder[2] ~= nil && panel.FBorder[2] ~= 0 ) then
            FERMA.CORE.DrawHorizontalLine 
            {
                ["x"] = 0,
                ["y"] = 0,
                ["length"] = w,
                ["thickness"] = panel.FBorder[2],
                ["color"] = panel.FBorderColor
            }
        end

        if( panel.FBorder[3] ~= nil && panel.FBorder[3] ~= 0 ) then
            FERMA.CORE.DrawVerticalLine 
            {
                ["x"] = w - panel.FBorder[3],
                ["y"] = 0,
                ["length"]  = h,
                ["thickness"] = panel.FBorder[3],
                ["color"] = panel.FBorderColor
            }
        end

        if( panel.FBorder[4] ~= nil && panel.FBorder[4] ~= 0 ) then
            FERMA.CORE.DrawHorizontalLine 
            {
                ["x"] = 0,
                ["y"] = h - panel.FBorder[4],
                ["length"] = w,
                ["thickness"] = panel.FBorder[4],
                ["color"] = panel.FBorderColor
            }
        end
    end
end

function FERMA.CORE.FermaDefaults( panel )
    panel:SetSize( panel.FT.FWidth, panel.FT.FHeight )
    panel:SetPos( panel.FT.FPosX, panel.FT.FPosY )

    if( panel.FT.FZIndex ~= nil ) then
        panel:SetZPos( panel.FT.FZIndex )
    end

    if( panel.FT.FAlpha ~= nil ) then
        panel:SetAlpha( panel.FT.FAlpha )
    end
    
    if( panel.FT.FPopup == true ) then
        panel:MakePopup()
    end
end

function FERMA.CORE.DrawBlurBox( style )
  surface.SetDrawColor( 255, 255, 255 )
  surface.SetMaterial( blur )

  for i = 1, 3 do
    blur:SetFloat( "$blur", ( i / 3 ) * ( style["strength"] or 6 ) )
    blur:Recompute()
    render.UpdateScreenEffectTexture()
    surface.DrawTexturedRect( style["x"] * -1, style["y"] * -1, ScrW(), ScrH() )
  end
end

function FERMA.CORE.DrawVerticalLine( style )
  surface.SetDrawColor( style["color"] )
  surface.DrawRect( style["x"], style["y"], style["thickness"], style["length"] )
end

function FERMA.CORE.DrawHorizontalLine( style )
  surface.SetDrawColor( style["color"] )
  surface.DrawRect( style["x"], style["y"], style["length"], style["thickness"] )
end

function FERMA.CORE.DrawLine( style )
  surface.SetDrawColor( style["color"] )
  surface.DrawLine( style["x"], style["y"], style["end-x"], style["end-y"] )
end

function FERMA.CORE.DrawBox( style )
  surface.SetDrawColor( style["color"] )
  surface.DrawRect( style["x"], style["y"], style["width"], style["height"] )
end

function FERMA.CORE.CreateFont( path, name, setfont, setweight, fonttable )
    local i = 1
    while i <= 40 do
        surface.CreateFont( name .. i, { 
            font = setfont,
            size = ScreenScale(i),
            weight = setweight,
            blursize = fonttable.blur or nil,
            scanlines = fonttable.scanlines or nil,
            antialias = fonttable.antialias or true,
            underline = fonttable.underline or nil,
            italic = fonttable.italic or nil,
            strikeout = fonttable.strikeout or nil,
            symbol = fonttable.symbol or nil,
            rotary = fonttable.rotary or nil,
            shadow = fonttable.shadow or nil,
            additive = fonttable.additive or nil,
            outline = fonttable.outline or nil,
            extended = fonttable.extended or nil
        } )
        surface.CreateFont( name .. "Unscaled" .. i, { 
            font = setfont,
            size = i,
            weight = setweight,
            blursize = fonttable.blur or nil,
            scanlines = fonttable.scanlines or nil,
            antialias = fonttable.antialias or true,
            underline = fonttable.underline or nil,
            italic = fonttable.italic or nil,
            strikeout = fonttable.strikeout or nil,
            symbol = fonttable.symbol or nil,
            rotary = fonttable.rotary or nil,
            shadow = fonttable.shadow or nil,
            additive = fonttable.additive or nil,
            outline = fonttable.outline or nil,
            extended = fonttable.extended or nil
        } )
        i = i + 1
    end
end 
--addons/thirdperson/lua/thirdperson/client/ferma/cl_ferma_flabel.lua:
FERMA = FERMA or {}
FLabel = {}

function FLabel:Style( style )

    /* Defaults */
    self.FT = FERMA.CORE.Fermafy( style, self:GetParent() )
    FERMA.CORE.FermaDefaults( self )
    /* */

    /* Panel Specific Styling */
    self.FT.FContent = style["content"] or ""
    self.FT.FFont = style["font-family"] or "Default"
    self.FT.FTextAlign = style["text-align"] or 5
    self.FT.FColor = style["color"] or Color( 255, 255, 255 )

    self:SetText( self.FT.FContent )
    self:SetFont( self.FT.FFont )
    self:SetColor( self.FT.FColor )
    self:SetContentAlignment( self.FT.FTextAlign )
    /* */

end

function FLabel:Paint( w, h )
    
    /* Defaults */
    FERMA.CORE.PaintFermafy( w, h, self.FT )
    -- 76561221774735761
    /* */

end

derma.DefineControl( "FLabel", "Better DLabel", FLabel, "DLabel" )
--addons/thirdperson/lua/thirdperson/client/ferma/cl_ferma_fbinder.lua:
FERMA = FERMA or {}
FBinder = {}

function FBinder:Style( style )    
    
    /* Defaults */
    self.FT = FERMA.CORE.Fermafy( style, self:GetParent() )
    FERMA.CORE.FermaDefaults( self )
    /* */

    /* Panel Specific Styling */
    self.FT.FContent = style["content"] or "PRESS A KEY"
    self.FT.FFont = style["font-family"] or nil
    self.FT.FHover = style["hover"] or Color( 255, 255, 255 )
    self.FT.FClick = style["click"] or Color( 255, 255, 255, 150 )
    self.FT.FColor = style["color"] or Color( 255, 255, 255, 70 )

    self:SetText( self.FT.FContent )

    if( self.FT.FFont ~= nil ) then
        self:SetFont( self.FT.FFont )
    end

    /* */

end

function FBinder:Paint( w, h )

    /* Defaults */
    FERMA.CORE.PaintFermafy( w, h, self.FT )
    /* */

end

function FBinder:UpdateColours( skin )
  if ( !self:IsEnabled() ) then 
        return self:SetTextStyleColor( skin.Colours.Button.Disabled ) 
    end
  
    if ( self:IsDown() || self.m_bSelected ) then
        return self:SetTextStyleColor( self.FT.FClick ) 
    end
  
    if ( self.Hovered ) then
        return self:SetTextStyleColor( self.FT.FHover ) 
    end

  return self:SetTextStyleColor( self.FT.FColor )
end

derma.DefineControl( "FBinder", "Better DBinder", FBinder, "DBinder" )
--lua/slib/vgui/cl_sbutton.lua:
local PANEL = {}

local font = slib.createFont("Roboto", 13)
local textcolor, accentcolor, successcolor, failcolor = slib.getTheme("textcolor"), slib.getTheme("accentcolor"), slib.getTheme("successcolor"), slib.getTheme("failcolor")

function PANEL:Init()
    self.font = font
    self:SetText("")
    self.bg = slib.getTheme("maincolor")
    self.alignment = TEXT_ALIGN_CENTER
    self.accentheight = 2
    self.selCol = accentcolor
    self.textcolor = textcolor
    slib.wrapFunction(self, "Dock", nil, function() return self end, true)
    slib.wrapFunction(self, "DockMargin", nil, function() return self end, true)
    slib.wrapFunction(self, "DockPadding", nil, function() return self end, true)
    slib.wrapFunction(self, "SetZPos", nil, function() return self end, true)
    slib.wrapFunction(self, "SetTall", nil, function() return self end, true)
    slib.wrapFunction(self, "SetWide", nil, function() return self end, true)
    slib.wrapFunction(self, "SetSize", nil, function() return self end, true)
    slib.wrapFunction(self, "SetPos", nil, function() return self end, true)
    slib.wrapFunction(self, "SetVisible", nil, function() return self end, true)
end

function PANEL:setTitle(title, alignment, noresize)
    if self.title == title then return end
    self.title = title

    if alignment then self.alignment = alignment end
    
    if !noresize then
        surface.SetFont(self.font)
        local w = select(1, surface.GetTextSize(title))

        self:SetWide(w + (slib.getTheme("margin") * 2))
    end
    
    return self
end

function PANEL:getTitle()
    return self.title
end

function PANEL:SetLinePos(h)
    self.linepos = h

    return self
end

function PANEL:setToggleable(bool)
    self.toggleable = bool

    return self
end

function PANEL:Paint(w,h)
    local wantedcolor = self.toggleable and (isfunction(self.toggleCheck) and self.toggleCheck() and istable(self.toggleCheck()) and self.toggleCheck() or self.toggleCheck() and successcolor or failcolor) or self.selCol

    if !self.toggleable then
        wantedcolor.a = (self:IsHovered() or self.forcehover) and 120 or 20
    end

    surface.SetDrawColor(self.bg)
    surface.DrawRect(0, 0, w, h)

    surface.SetDrawColor(slib.lerpColor(self, wantedcolor))
    surface.DrawRect(0, self.linepos ~= nil and self.linepos or (h - self.accentheight), w, self.accentheight)
    local x
    if self.alignment == TEXT_ALIGN_CENTER then
        x = w * .5
    elseif self.alignment == TEXT_ALIGN_RIGHT then
        x = w - slib.getTheme("margin")
    elseif self.alignment == TEXT_ALIGN_LEFT then
        x = slib.getTheme("margin")
    end

    draw.SimpleText(self.title, self.font, x, h * .5, self.textcolor, self.alignment, TEXT_ALIGN_CENTER)
end

vgui.Register("SButton", PANEL, "DButton")
--lua/slib/vgui/cl_slistview.lua:
return gluapack()()
--lua/slib/vgui/cl_sstatement.lua:
return gluapack()()
--addons/eprotect_1.5.24/lua/e_protect/sh_eprotect.lua:
return gluapack()()
--addons/eprotect_1.5.24/lua/e_protect/client/cl_eprotect.lua:
return gluapack()()
--addons/gprotect_1.13.99/lua/g_protect/languages/sh_french.lua:
return gluapack()()
--addons/gprotect_1.13.99/lua/g_protect/languages/sh_russian.lua:
--russian translate from the MinimalRP team & St11l for Stromic <3    ​​         ​ 

if SERVER then
	slib.setLang("gprotect", "ru", "colliding-too-much", "%s энтити слишком часто сталкиваются")
	slib.setLang("gprotect", "ru", "too-many-obstructs", "%s блокируется слишком много плохих объектов")
	slib.setLang("gprotect", "ru", "blacklisted-multiple", "Успешно добалвено %s моделей в список заблокированных")
	slib.setLang("gprotect", "ru", "unblacklisted-multiple", "Удалено %s моделей из списка заблокированных")
	slib.setLang("gprotect", "ru", "blacklisted-multiple-ent", "Добавлено %s энтити в список заблокированных")
	slib.setLang("gprotect", "ru", "unblacklisted-multiple-ent", "Удалено %s энтити из списка заблокированных")
	slib.setLang("gprotect", "ru", "added-blacklist", "Добавлено %s в список заблокированных моделей")
	slib.setLang("gprotect", "ru", "removed-blacklist", "Удалено %s из заблокированных моделей")
	slib.setLang("gprotect", "ru", "added-blacklist-ent", "Добавлено %s в список заблокированных энтити")
	slib.setLang("gprotect", "ru", "removed-blacklist-ent", "Удалено %s из списка заблокированных энтити")
	slib.setLang("gprotect", "ru", "attempted-unfreeze-all", "%s пытался разморозить все после спавна дубликатором")
	slib.setLang("gprotect", "ru", "attempted-upscaled-ent", "%s пытался создать слишком большое энтити с помощью дубликатора")
	slib.setLang("gprotect", "ru", "attempted-rope-spawning", "%s пытался создать веревки, используя дубликатор")
	slib.setLang("gprotect", "ru", "attempted-no-gravity", "%s пытался заспавнить проп без гравитации, используя дубликатор")
	slib.setLang("gprotect", "ru", "attempted-trail", "%s пытался заспавнить пропы с трейлами используя дубликатора")

	slib.setLang("gprotect", "ru", "model-restricted", "Создание этой модели ограничено")
	slib.setLang("gprotect", "ru", "classname-restricted", "Создание этого энтити было ограничено")
	slib.setLang("gprotect", "ru", "attempted-blackout", "%s пытался использовать эксплойт затемнения")
	slib.setLang("gprotect", "ru", "spam-spawning", "%s пытается спамить энтити или пропами")

    slib.setLang("gprotect", "ru", "too-complex-model", "Эта модель была ограничена, потому что она слишком сложная!")
	slib.setLang("gprotect", "ru", "too-big-prop", "Проп слишком большой, поэтому он был удален")
	slib.setLang("gprotect", "ru", "successfull-fpp-blockedmodels", "Ты успешно перенес заблокированные модели из FPP в gProtect")
	slib.setLang("gprotect", "ru", "successfull-fpp-grouptools", "Ты успешно перенес инструменты группы с FPP на gProtect")
	slib.setLang("gprotect", "ru", "unsuccessfull-transfer", "Кажется, возникла проблема при передаче данных! (MySQL не поддерживается)")

	slib.setLang("gprotect", "ru", "you-ghosted-props", "Пропы игрока %s были сделаны призрачными")
	slib.setLang("gprotect", "ru", "you-frozen-props", "Заморожены все пропы игрока %s ")
	slib.setLang("gprotect", "ru", "you-removed-props", "Удалены все пропы игрока %s ")
	slib.setLang("gprotect", "ru", "you-removed-ents", "Удалены все энтити игрока %s")

	slib.setLang("gprotect", "ru", "props-ghosted", "Твои пропы сделаны призрачными")
	slib.setLang("gprotect", "ru", "props-frozen", "Твои пропы были заморожены")
	slib.setLang("gprotect", "ru", "props-removed", "Твои пропы были удалены")
	slib.setLang("gprotect", "ru", "ents-removed", "Твои энтити были удалены")

	slib.setLang("gprotect", "ru", "everyones-props-ghosted", "Администрация сделала все пропы призрачными")
	slib.setLang("gprotect", "ru", "everyones-props-frozen", "Администрация заморозила все пропы")
	slib.setLang("gprotect", "ru", "disconnected-ents-removed", "Удалены все энтити и пропы, игроков, которые отключились")

	slib.setLang("gprotect", "ru", "spawn-to-close", "В твоем пропе может застрять игрок")
	slib.setLang("gprotect", "ru", "entity-ghosted", "Твой энтити был сделан призрачным")

	slib.setLang("gprotect", "ru", "ratelimited_toolgun", "Воу, не так быстро! У этого инструмента есть задержка")
	slib.setLang("gprotect", "ru", "too_many_obstructs_purchase", "Слишком много препятствий для создания энтити. Энтити был удалён, а деньги возвращены")

	slib.setLang("gprotect", "ru", "mysql_successfull", "[gProtect] Соединение с базой данных успешно установлено")
    slib.setLang("gprotect", "ru", "mysql_failed", "[gProtect] Не удалось подключиться к базе данных")
elseif CLIENT then
	slib.setLang("gprotect", "ru", "title", "Настройки gProtect")
	slib.setLang("gprotect", "ru", "buddies-title", "Разрешение на управление пропами")

	slib.setLang("gprotect", "ru", "world", "World")
	slib.setLang("gprotect", "ru", "disconnected", "Отключился")
	slib.setLang("gprotect", "ru", "toolgun-name", "Заблокированные пропы")
	slib.setLang("gprotect", "ru", "toolgun-desc", "Управление заблокированными моделями")
	slib.setLang("gprotect", "ru", "toolgun-leftclick", "Добавить в список заблокированных моделей")
	slib.setLang("gprotect", "ru", "toolgun-rightclick", "Удалить из списка заблокированных моделей")
	slib.setLang("gprotect", "ru", "toolgun-help", "Используй тулган на пропе")
	slib.setLang("gprotect", "ru", "remove-on-blacklist", "Удалить проп из списка заблокированных пропов")
	slib.setLang("gprotect", "ru", "player-list", "Список игроков")

	slib.setLang("gprotect", "ru", "submit", "Применить")
	slib.setLang("gprotect", "ru", "input_number", "Введи число")

	slib.setLang("gprotect", "ru", "toolgun", "Инструмент")
	slib.setLang("gprotect", "ru", "physgun", "Физган")
	slib.setLang("gprotect", "ru", "gravity-gun", "гравипушка")
	slib.setLang("gprotect", "ru", "canproperty", "Может трогать")

	slib.setLang("gprotect", "ru", "add-blocked-models", "Добавить в заблокированные модели")
	slib.setLang("gprotect", "ru", "remove-blocked-models", "Удалить из заблокированных моделей")

	slib.setLang("gprotect", "ru", "add-blacklisted-ents", "Добавить в список заблокированных")
	slib.setLang("gprotect", "ru", "remove-blacklisted-ents", "Удалить из списков заблокированных")
	slib.setLang("gprotect", "ru", "copy-clipboard", "Скопировать")

	slib.setLang("gprotect", "ru", "general", "Основное")
	slib.setLang("gprotect", "ru", "ghosting", "Призрачность")
	slib.setLang("gprotect", "ru", "damage", "Урон")
	slib.setLang("gprotect", "ru", "anticollide", "Анти-столкновение")
	slib.setLang("gprotect", "ru", "spamprotection", "Защита от спама")
	slib.setLang("gprotect", "ru", "spawnrestriction", "Ограничение на спавн")
	slib.setLang("gprotect", "ru", "toolgunsettings", "Настройки тулгана")
	slib.setLang("gprotect", "ru", "physgunsettings", "Настройки физгана")
	slib.setLang("gprotect", "ru", "gravitygunsettings", "Настройки гравипушки")
	slib.setLang("gprotect", "ru", "canpropertysettings", "Настройки возможностей")
	slib.setLang("gprotect", "ru", "advdupe2", "Дубликатор")
	slib.setLang("gprotect", "ru", "miscs", "Разное")

	slib.setLang("gprotect", "ru", "ghost-props", "Призрачность пропов")
	slib.setLang("gprotect", "ru", "remove-props", "Удалить пропы")
	slib.setLang("gprotect", "ru", "freeze-props", "Заморозить пропы")
	slib.setLang("gprotect", "ru", "remove-entities", "Удалить энтити")
	slib.setLang("gprotect", "ru", "highlight-ents", "Включить подсветку энтити")
	slib.setLang("gprotect", "ru", "unhighlight-ents", "Выключить подсветку энтити")

	slib.setLang("gprotect", "ru", "ghost-everyones-props", "Сделать все пропы призрачными")
	slib.setLang("gprotect", "ru", "freeze-everyones-props", "Заморозить все пропы")
	slib.setLang("gprotect", "ru", "remove-disconnected-entities", "Удалить пропы отключившихся игроков")

	slib.setLang("gprotect", "ru", "general_remDiscPlyEnt", "Удалить энтити отключенных игроков")
	slib.setLang("gprotect", "ru", "general_remDiscPlyEnt_tooltip", "Удаляет пропы отключенных игроков по таймеру (если -1, он будет отключен)")
	slib.setLang("gprotect", "ru", "general_remDiscPlyEntSpecific", "Удалить определенные энтити отключенных игроков")
	slib.setLang("gprotect", "ru", "general_remDiscPlyEntSpecific_tooltip", "Время удаление энтити. Если значение ну указано, то оно будет выставлено по умолчанию. Если поставить -1, то название энтити будет проигнорировано")
    slib.setLang("gprotect", "ru", "general_blacklist", "Чёрный список")
	slib.setLang("gprotect", "ru", "general_blacklist_tooltip", "Добавить энтити, которые должны быть защищены всеми модулями")
	slib.setLang("gprotect", "ru", "general_protectedFrozenEnts", "Защищенные замороженные пропы")
	slib.setLang("gprotect", "ru", "general_protectedFrozenEnts_tooltip", "Это список энтити, которые будут защищены в замороженном состоянии")
	slib.setLang("gprotect", "ru", "general_protectedFrozenGroup", "Сollision groups для защищенных замороженных энтити")
	slib.setLang("gprotect", "ru", "general_protectedFrozenGroup_tooltip", "Сollision group, в которую нужно поместить замороженные объекты")

	slib.setLang("gprotect", "ru", "ghosting_enabled", "Включено")
	slib.setLang("gprotect", "ru", "ghosting_enabled_tooltip", "Включить модуль призрачности?")
	slib.setLang("gprotect", "ru", "ghosting_ghostColor", "Цвет призрачности")
	slib.setLang("gprotect", "ru", "ghosting_ghostColor_tooltip", "Цвет для призрачных объектов")
	slib.setLang("gprotect", "ru", "ghosting_antiObscuring", "Анти-затемнение")
	slib.setLang("gprotect", "ru", "ghosting_antiObscuring_tooltip", "Предотвращает энтити от состояния призрачности, пока они затемняют объект. Добавь энтити, которые не должны быть затемненными")
	slib.setLang("gprotect", "ru", "ghosting_onPhysgun", "Призрачность при использовании физгана")
	slib.setLang("gprotect", "ru", "ghosting_onPhysgun_tooltip", "Призрачность пропа во время использования физгана")
	slib.setLang("gprotect", "ru", "ghosting_useBlacklist", "Использовать чёрный список")
	slib.setLang("gprotect", "ru", "ghosting_useBlacklist_tooltip", "Делает призрачными запрещенные предметы из черного списка, если модуль включен")
	slib.setLang("gprotect", "ru", "ghosting_entities", "Энтити")
	slib.setLang("gprotect", "ru", "ghosting_entities_tooltip", "Энтити в этом списке будут всегда призрачными, это не изменит черный список, используемый другими модулями")

	slib.setLang("gprotect", "ru", "damage_enabled", "Включено")
	slib.setLang("gprotect", "ru", "damage_enabled_tooltip", "Включить модуль повреждений?")
	slib.setLang("gprotect", "ru", "damage_useBlacklist", "Использовать черный список")
	slib.setLang("gprotect", "ru", "damage_useBlacklist_tooltip", "Учитывает черный список из вкладки 'Основное', как основной в этом модуле")
	slib.setLang("gprotect", "ru", "damage_entities", "Чёрный список энтити")
	slib.setLang("gprotect", "ru", "damage_entities_tooltip", "Энтити в этом списке не будут наносить урон, если отключено повреждение, это не изменит черный список, используемый другими модулями")
	slib.setLang("gprotect", "ru", "damage_blacklistedEntPlayerDamage", "Отключить урон от энтити из черного списка")
	slib.setLang("gprotect", "ru", "damage_blacklistedEntPlayerDamage_tooltip", "Если этот флажок установлен, игроки не будут получать урон от энтити из черного списка")
	slib.setLang("gprotect", "ru", "damage_vehiclePlayerDamage", "Отключить повреждения от машин")
	slib.setLang("gprotect", "ru", "damage_vehiclePlayerDamage_tooltip", "Если этот флажок установлен, игроки не будут получать урон от транспортных средств")
	slib.setLang("gprotect", "ru", "damage_worldPlayerDamage", "Отключить повреждение от энтити класса World")
	slib.setLang("gprotect", "ru", "damage_worldPlayerDamage_tooltip", "Если этот флажок установлен, игроки могут получать урон от энтити из черного списка")
	slib.setLang("gprotect", "ru", "damage_immortalEntities", "Неуязвимые энтити")
	slib.setLang("gprotect", "ru", "damage_immortalEntities_tooltip", "Энтити в этом списке не получают повреждений, кроме случаев, когда игрок находится в спике доверенных групп")
	slib.setLang("gprotect", "ru", "damage_bypassGroups", "Доверенные группы")
	slib.setLang("gprotect", "ru", "damage_bypassGroups_tooltip", "Список групп, которые обходят ограничение на повреждения энтити. Значение '*' подразумевает все группы")
	slib.setLang("gprotect", "ru", "damage_canDamageWorldEntities", "Может нанести урон World энтити")
	slib.setLang("gprotect", "ru", "damage_canDamageWorldEntities_tooltip", "Группы, которые находятся в этом списке, могут нанести урон World энтити. Значение '*' подразумевает все группы")

	slib.setLang("gprotect", "ru", "anticollide_enabled", "Включено")
	slib.setLang("gprotect", "ru", "anticollide_enabled_tooltip", "Включить модуль защиты от столкновений?")
	slib.setLang("gprotect", "ru", "anticollide_notifyStaff", "Уведомлять администрацию")
	slib.setLang("gprotect", "ru", "anticollide_notifyStaff_tooltip", "Присылает уведомления администрации, если сработает защита")
	slib.setLang("gprotect", "ru", "anticollide_protectDarkRPEntities", "Защита DRP энтити")
	slib.setLang("gprotect", "ru", "anticollide_protectDarkRPEntities_tooltip", "Защищать объекты DarkRP? (0 = Отключено, 1 = Сделать призрачным, 2 = Заморозить, 3 = Удалить, 4 = Удалить и вернуть деньги)")
	slib.setLang("gprotect", "ru", "anticollide_DRPentitiesThreshold", "Предел столкновений предметов DRP")
	slib.setLang("gprotect", "ru", "anticollide_DRPentitiesThreshold_tooltip", "Сколько столкновений может быть у пропа до того, как сработает защита в течение 1 секунды?")
	slib.setLang("gprotect", "ru", "anticollide_DRPentitiesException", "Энтити DRP в исключениях")
	slib.setLang("gprotect", "ru", "anticollide_DRPentitiesException_tooltip", "Какие столкновения необходимо игнорировать? (0 = Никакие, 1 = Если другой владелец, 2 = Если нет владельца)")
	slib.setLang("gprotect", "ru", "anticollide_protectSpawnedEntities", "Защищать заспавненные энтити")
	slib.setLang("gprotect", "ru", "anticollide_protectSpawnedEntities_tooltip", "Следует ли защищать заспавненные энтити? (0 = Отключено, 1 = Сделать призрачным, 2 = Заморозить, 3 = Удалить)")
	slib.setLang("gprotect", "ru", "anticollide_entitiesThreshold", "Предел заспавненных энтити")
	slib.setLang("gprotect", "ru", "anticollide_entitiesThreshold_tooltip", "Сколько столкновений может быть у энтити до того, как сработает защита в течение 1 секунды?")
	slib.setLang("gprotect", "ru", "anticollide_entitiesException", "Энтити в исключениях")
	slib.setLang("gprotect", "ru", "anticollide_entitiesException_tooltip", "Какие столкновения необходимо игнорировать? (0 = Никакие, 1 = Если другой владелец, 2 = Если нет владельца)")
	slib.setLang("gprotect", "ru", "anticollide_protectSpawnedProps", "Защитить заспавненный проп")
	slib.setLang("gprotect", "ru", "anticollide_protectSpawnedProps_tooltip", "Должны ли мы защищать заспавненные пропы? (0 = Отключено, 1 = Сделать призрачным, 2 = Заморозить, 3 = Удалить)")
	slib.setLang("gprotect", "ru", "anticollide_propsThreshold", "Предел заспавненных пропов")
	slib.setLang("gprotect", "ru", "anticollide_propsThreshold_tooltip", "Сколько столкновений может быть у пропа до срабатывания защиты в течение 1 секунды?")
	slib.setLang("gprotect", "ru", "anticollide_propsException", "Пропы в исключениях")
	slib.setLang("gprotect", "ru", "anticollide_propsException_tooltip", "Какие столкновения необходимо игнорировать? (0 = Никакие, 1 = Если другой владелец, 2 = Если нет владельца)")
	slib.setLang("gprotect", "ru", "anticollide_useBlacklist", "Использовать чёрный список")
	slib.setLang("gprotect", "ru", "anticollide_useBlacklist_tooltip", "Энтити, занесенные в черный список, будут сделаны призрачными, если будет происходить частое столкновение, если это включено")
	slib.setLang("gprotect", "ru", "anticollide_ghostEntities", "Энтити")
	slib.setLang("gprotect", "ru", "anticollide_ghostEntities_tooltip", "Энтити в этом списке будут сделаны призрачными, если они будут слишком часто сталкиваться")
	slib.setLang("gprotect", "ru", "anticollide_specificEntities", "Определенные энтити")
	slib.setLang("gprotect", "ru", "anticollide_specificEntities_tooltip", "Энтити, которые будут иметь определенное правило, которое определяет их предел. Значение ниже 0 будет считаться исключением")

	slib.setLang("gprotect", "ru", "spamprotection_enabled", "Включено")
	slib.setLang("gprotect", "ru", "spamprotection_enabled_tooltip", "Включить модуль защиты от спама?")
	slib.setLang("gprotect", "ru", "spamprotection_threshold", "Предел спавна предметов")
	slib.setLang("gprotect", "ru", "spamprotection_threshold_tooltip", "Если спавнить предметы слишком быстро, то сработает задержка спавна предметов")
	slib.setLang("gprotect", "ru", "spamprotection_delay", "Задержка спавна предметов")
	slib.setLang("gprotect", "ru", "spamprotection_delay_tooltip", "Таймер, который срабатывает при слишком быстром спавне предметов")
	slib.setLang("gprotect", "ru", "spamprotection_action", "Наказание за слишком быстрый спавн предметов")
	slib.setLang("gprotect", "ru", "spamprotection_action_tooltip", "Это решит, как бороться со спамерами! (1 = Запретить спавн, 2 = Сделать предметы призрачными)")
	slib.setLang("gprotect", "ru", "spamprotection_notifyStaff", "Уведомлять администрацию")
	slib.setLang("gprotect", "ru", "spamprotection_notifyStaff_tooltip", "Присылает уведомления администрации, если сработает защита")
	slib.setLang("gprotect", "ru", "spamprotection_protectProps", "Защита пропов")
	slib.setLang("gprotect", "ru", "spamprotection_protectProps_tooltip", "Защита от спама пропами")
	slib.setLang("gprotect", "ru", "spamprotection_protectEntities", "Защита энтити")
	slib.setLang("gprotect", "ru", "spamprotection_protectEntities_tooltip", "Защита от спама энтити")

	slib.setLang("gprotect", "ru", "spawnrestriction_enabled", "Включено")
	slib.setLang("gprotect", "ru", "spawnrestriction_enabled_tooltip", "Включить модуль ограничения на спавн?")
	slib.setLang("gprotect", "ru", "spawnrestriction_propSpawnPermission", "Разрешения на спавн пропов")
	slib.setLang("gprotect", "ru", "spawnrestriction_propSpawnPermission_tooltip", "Ограничение на создание пропов для группы (* значит все)")
	slib.setLang("gprotect", "ru", "spawnrestriction_SENTSpawnPermission", "Разрешение на спавн энтити")
	slib.setLang("gprotect", "ru", "spawnrestriction_SENTSpawnPermission_tooltip", "Ограничение на создание энтити для группы (* значит все)")
	slib.setLang("gprotect", "ru", "spawnrestriction_SWEPSpawnPermission", "Разрешение на спавн оружия из Q-меню")
	slib.setLang("gprotect", "ru", "spawnrestriction_SWEPSpawnPermission_tooltip", "Ограничение на создание оружия из Q-меню для группы (* значит все)")
	slib.setLang("gprotect", "ru", "spawnrestriction_vehicleSpawnPermission", "Разрешение на спавн траспортных средств")
	slib.setLang("gprotect", "ru", "spawnrestriction_vehicleSpawnPermission_tooltip", "Ограничение на спавн траспортных средств из Q-меню для группы (* значит все)")
	slib.setLang("gprotect", "ru", "spawnrestriction_NPCSpawnPermission", "Разрешение на спавн NPC")
	slib.setLang("gprotect", "ru", "spawnrestriction_NPCSpawnPermission_tooltip", "Ограничение на спавн NPC из Q-меню для группы (* значит все)")
	slib.setLang("gprotect", "ru", "spawnrestriction_ragdollSpawnPermission", "Разрешение на спавн Ragdoll'ов")
	slib.setLang("gprotect", "ru", "spawnrestriction_ragdollSpawnPermission_tooltip", "Ограничение на спавн Ragdoll'ов для группы (* значит все)")
	slib.setLang("gprotect", "ru", "spawnrestriction_effectSpawnPermission", "Разрешение на спавн эффектов")
	slib.setLang("gprotect", "ru", "spawnrestriction_effectSpawnPermission_tooltip", "Ограничение на спавн эффектов для группы (* значит все)")
	slib.setLang("gprotect", "ru", "spawnrestriction_blockedEntities", "Заблокированные энтити")
	slib.setLang("gprotect", "ru", "spawnrestriction_blockedEntities_tooltip", "Список энтити, которые запрещено спавнить")
	slib.setLang("gprotect", "ru", "spawnrestriction_blockedEntitiesIsBlacklist", "Заблокированные энтити это чёрный список")
	slib.setLang("gprotect", "ru", "spawnrestriction_blockedEntitiesIsBlacklist_tooltip", "Если этот флажок установлен, энтити в списке будут заблокированы для спавна, иначе можно будет спавнить только эти энтити")
	slib.setLang("gprotect", "ru", "spawnrestriction_blockedModels", "Заблокированные модели")
	slib.setLang("gprotect", "ru", "spawnrestriction_blockedModels_tooltip", "Список моделей пропов, которые запрещено спавнить")
	slib.setLang("gprotect", "ru", "spawnrestriction_blockedModelsisBlacklist", "Заблокированные модели пропов это черный список")
	slib.setLang("gprotect", "ru", "spawnrestriction_blockedModelsisBlacklist_tooltip", "Если этот флажок установлен, модели пропов в списке будут заблокированы для спавна, иначе можно будет спавнить только эти модели пропов")
	slib.setLang("gprotect", "ru", "spawnrestriction_bypassGroups", "Доверенные группы")
	slib.setLang("gprotect", "ru", "spawnrestriction_bypassGroups_tooltip", "Группы пользователей, которые обходят все ограничения этого модуля (* значит все)")
	slib.setLang("gprotect", "ru", "spawnrestriction_maxModelSize", "Максимальный размер модели")
	slib.setLang("gprotect", "ru", "spawnrestriction_maxModelSize_tooltip", "Если больше 0, то более крупные пропы будут удалены сразу после появления")

	slib.setLang("gprotect", "ru", "toolgunsettings_enabled", "Включено")
	slib.setLang("gprotect", "ru", "toolgunsettings_enabled_tooltip", "Включить модуль настройки тулгана?")
	slib.setLang("gprotect", "ru", "toolgunsettings_targetWorld", "Группы, которые могут взаимодействовать с World предметами")
	slib.setLang("gprotect", "ru", "toolgunsettings_targetWorld_tooltip", "Группы, которые могут взаимодействовать с World энтити и пропами (* значит все)")
	slib.setLang("gprotect", "ru", "toolgunsettings_targetPlayerOwned", "Группы, которые могут взаимодействовать с предметами, принадлежащие игроку")
	slib.setLang("gprotect", "ru", "toolgunsettings_targetPlayerOwned_tooltip", "Группы, которые могут взаимодействовать с энтити и пропами других игроков (* значит все)")
	slib.setLang("gprotect", "ru", "toolgunsettings_restrictTools", "Ограничение на инструменты в тулгане")
	slib.setLang("gprotect", "ru", "toolgunsettings_restrictTools_tooltip", "Ограничение использования иструментов, кроме доверенных групп")
	slib.setLang("gprotect", "ru", "toolgunsettings_groupToolRestrictions", "Ограничения группового инструмента")
	slib.setLang("gprotect", "ru", "toolgunsettings_groupToolRestrictions_tooltip", "Настройка ограничения инструмента по инструменту")
	slib.setLang("gprotect", "ru", "toolgunsettings_entityTargetability", "Энтити, с которыми можно взаимодействовать")
	slib.setLang("gprotect", "ru", "toolgunsettings_entityTargetability_tooltip", "Это удобно, чтобы игроки могли использовать тулган, например, только на своем пропе")
	slib.setLang("gprotect", "ru", "toolgunsettings_bypassTargetabilityTools", "Обход взаимодействия тулганом")
	slib.setLang("gprotect", "ru", "toolgunsettings_bypassTargetabilityTools_tooltip", "Инструменты в этом списке обходят настройку ограничения взаимодействия")
    slib.setLang("gprotect", "ru", "toolgunsettings_bypassGroups", "Доверенные группы")
	slib.setLang("gprotect", "ru", "toolgunsettings_bypassGroups_tooltip", "Группы пользователей, которые обходят все ограничения этого модуля (* значит все)")
	slib.setLang("gprotect", "ru", "toolgunsettings_antiSpam", "Антиспам")
	slib.setLang("gprotect", "ru", "toolgunsettings_antiSpam_tooltip", "Список инструментов с ограничением использования в секунду")

	slib.setLang("gprotect", "ru", "physgunsettings_enabled", "Включено")
	slib.setLang("gprotect", "ru", "physgunsettings_enabled_tooltip", "Включить модуль настроек физгана?")
	slib.setLang("gprotect", "ru", "physgunsettings_targetWorld", "Может взаимодействовать с World предметами")
	slib.setLang("gprotect", "ru", "physgunsettings_targetWorld_tooltip", "Группы, которые могут взаимодействовать с World энтити и пропами (* значит все)")
	slib.setLang("gprotect", "ru", "physgunsettings_targetPlayerOwned", "Группы, которые могут взаимодействовать с предметами, принадлежащие игроку")
	slib.setLang("gprotect", "ru", "physgunsettings_targetPlayerOwned_tooltip", "Группы, которые могут взаимодействовать с энтити и пропами других игроков (* значит все)")
	slib.setLang("gprotect", "ru", "physgunsettings_DisableReloadUnfreeze", "Отключить разморозку")
	slib.setLang("gprotect", "ru", "physgunsettings_DisableReloadUnfreeze_tooltip", "Предотвращение размораживания предмета с помощью правой кнопкой мыши")
	slib.setLang("gprotect", "ru", "physgunsettings_PickupVehiclePermission", "Разрешение на взаимодействие с машинами")
	slib.setLang("gprotect", "ru", "physgunsettings_PickupVehiclePermission_tooltip", "Группы из списка могут взаимодействие с машинами")
	slib.setLang("gprotect", "ru", "physgunsettings_StopMotionOnDrop", "Остановить движение при падении")
	slib.setLang("gprotect", "ru", "physgunsettings_StopMotionOnDrop_tooltip", "Предотвращает proppushing/propkilling")
	slib.setLang("gprotect", "ru", "physgunsettings_blockMultiplePhysgunning", "Блокировать мультифизганинг")
	slib.setLang("gprotect", "ru", "physgunsettings_blockMultiplePhysgunning_tooltip", "Блокирует возможность другому игроку взаимодействовать с предметом, если на предмете уже используется физган")
    slib.setLang("gprotect", "ru", "physgunsettings_maxDropObstructs", "Максимальный предел препятствия")
	slib.setLang("gprotect", "ru", "physgunsettings_maxDropObstructs_tooltip", "Предел количества энтити, занесенных в черный список, до срабатывания")
	slib.setLang("gprotect", "ru", "physgunsettings_maxDropObstructsAction", "Максимальное препятствие действия триггера")
	slib.setLang("gprotect", "ru", "physgunsettings_maxDropObstructsAction_tooltip", "Значение срабатывания триггера (1 = Призрак, 2 = Заморозить, 3 = Удалить)")
	slib.setLang("gprotect", "ru", "physgunsettings_blockedEntities", "Заблокированные энтити")
	slib.setLang("gprotect", "ru", "physgunsettings_blockedEntities_tooltip", "Энтити, с которыми нельзя взаимодействовать с помощью физгана. Доверенные группы могут взаимодействовать")
	slib.setLang("gprotect", "ru", "physgunsettings_bypassGroups", "Доверенные группы")
	slib.setLang("gprotect", "ru", "physgunsettings_bypassGroups_tooltip", "Группы пользователей, которые обходят все ограничения этого модуля (* значит все)")

	slib.setLang("gprotect", "ru", "gravitygunsettings_enabled", "Включено")
	slib.setLang("gprotect", "ru", "gravitygunsettings_enabled_tooltip", "Включить защитный модуль гравипушки?")
	slib.setLang("gprotect", "ru", "gravitygunsettings_targetWorld", "Может взаимодействовать с World предметами")
	slib.setLang("gprotect", "ru", "gravitygunsettings_targetWorld_tooltip", "Группы, которые могут взаимодействовать с World энтити и пропами (* значит все)")
	slib.setLang("gprotect", "ru", "gravitygunsettings_targetPlayerOwned", "Группы, которые могут взаимодействовать с предметами, принадлежащие игроку")
	slib.setLang("gprotect", "ru", "gravitygunsettings_targetPlayerOwned_tooltip", "Группы, которые могут взаимодействовать с энтити и пропами других игроков (* значит все)")
	slib.setLang("gprotect", "ru", "gravitygunsettings_DisableGravityGunPunting", "Отключить бросок гравипушки")
	slib.setLang("gprotect", "ru", "gravitygunsettings_DisableGravityGunPunting_tooltip", "Метательная атака гравипушки")
	slib.setLang("gprotect", "ru", "gravitygunsettings_blockedEntities", "Заблокированные энтити")
	slib.setLang("gprotect", "ru", "gravitygunsettings_blockedEntities_tooltip", "Энтити, с которыми нельзя взаимодействовать с помощью гравипушки. Доверенные группы могут взаимодействовать")
	slib.setLang("gprotect", "ru", "gravitygunsettings_bypassGroups", "Доверенные группы")
	slib.setLang("gprotect", "ru", "gravitygunsettings_bypassGroups_tooltip", "Группы пользователей, которые обходят все ограничения этого модуля (* значит все)")

	slib.setLang("gprotect", "ru", "canpropertysettings_enabled", "Включено")
	slib.setLang("gprotect", "ru", "canpropertysettings_enabled_tooltip", "Включить модуль настройки возможностей?")
	slib.setLang("gprotect", "ru", "canpropertysettings_targetWorld", "Может взаимодействовать с World предметами")
	slib.setLang("gprotect", "ru", "canpropertysettings_targetWorld_tooltip", "Группы, которые могут взаимодействовать с World энтити и пропами (* значит все)")
	slib.setLang("gprotect", "ru", "canpropertysettings_targetPlayerOwned", "Группы, которые могут взаимодействовать с предметами, принадлежащие игроку")
	slib.setLang("gprotect", "ru", "canpropertysettings_targetPlayerOwned_tooltip", "Группы, которые могут взаимодействовать с энтити и пропами других игроков (* значит все)")
	slib.setLang("gprotect", "ru", "canpropertysettings_blockedProperties", "Заблокированные возможности (properties)")
	slib.setLang("gprotect", "ru", "canpropertysettings_blockedProperties_tooltip", "Список возможностей (properties), которые заблокирвоаны")
	slib.setLang("gprotect", "ru", "canpropertysettings_blockedPropertiesisBlacklist", "Заблокированные возможности это черный список")
	slib.setLang("gprotect", "ru", "canpropertysettings_blockedPropertiesisBlacklist_tooltip", "Если этот флажок установлен, возможности в списке будут заблокированы, иначе можно будет использовать только эти возможности")
	slib.setLang("gprotect", "ru", "canpropertysettings_blockedEntities", "Заблокированные энтити")
	slib.setLang("gprotect", "ru", "canpropertysettings_blockedEntities_tooltip", "Энтити, с которыми нельзя взаимодействовать. Доверенные группы могут взаимодействовать")
	slib.setLang("gprotect", "ru", "canpropertysettings_bypassGroups", "Доверенные группы")
	slib.setLang("gprotect", "ru", "canpropertysettings_bypassGroups_tooltip", "Группы пользователей, которые обходят все ограничения этого модуля (* значит все)")

	slib.setLang("gprotect", "ru", "advdupe2_enabled", "Включено")
	slib.setLang("gprotect", "ru", "advdupe2_enabled_tooltip", "Уведомлять администрацию")
	slib.setLang("gprotect", "ru", "advdupe2_notifyStaff", "Уведомить персона?")
	slib.setLang("gprotect", "ru", "advdupe2_notifyStaff_tooltip", "Присылает уведомления администрации, если сработает защита")
	slib.setLang("gprotect", "ru", "advdupe2_PreventRopes", "Запретить спавна веревки")
	slib.setLang("gprotect", "ru", "advdupe2_PreventRopes_tooltip", "Не допускает спавн веревок (1 = Предотвращение спавна, 2 = Спавн, но исправить)")
	slib.setLang("gprotect", "ru", "advdupe2_PreventScaling", "Запретить изменение размера")
	slib.setLang("gprotect", "ru", "advdupe2_PreventScaling_tooltip", "Предотвращение спавна измененных размеров пропов. (1 = Предотвращение спавна, 2 = Спавн, но исправить)")
	slib.setLang("gprotect", "ru", "advdupe2_PreventNoGravity", "Запретить спавн без гравитации")
	slib.setLang("gprotect", "ru", "advdupe2_PreventNoGravity_tooltip", "Запретить спавн пропа без гравитации. (1 = Предотвращение спавна, 2 = Спавн, но исправить)")
	slib.setLang("gprotect", "ru", "advdupe2_PreventTrail", "Запретить трейлы")
	slib.setLang("gprotect", "ru", "advdupe2_PreventTrail_tooltip", "Запретить спавнить пропы с трейлами. (1 = Предотвращение спавна, 2 = Спавн, но исправить)")
    slib.setLang("gprotect", "ru", "advdupe2_PreventUnfreezeAll", "Запретить размораживать все пропы")
	slib.setLang("gprotect", "ru", "advdupe2_PreventUnfreezeAll_tooltip", "Запретить игрокам размораживать все пропы. (1 = Предотвращение спавна, 2 = Спавн, но исправить)")
	slib.setLang("gprotect", "ru", "advdupe2_BlacklistedCollisionGroups", "Черный список collision groups")
	slib.setLang("gprotect", "ru", "advdupe2_BlacklistedCollisionGroups_tooltip", "Защита от пропов, с которыми нельзя взаимодействовать. Значение коллизии должно быть ENUM")
	slib.setLang("gprotect", "ru", "advdupe2_WhitelistedConstraints", "Ограничения белого списка")
	slib.setLang("gprotect", "ru", "advdupe2_WhitelistedConstraints_tooltip", "Предотвращение спавна каких-либо нежелательных вещей")

	slib.setLang("gprotect", "ru", "miscs_enabled", "Включено")
	slib.setLang("gprotect", "ru", "miscs_enabled_tooltip", "Включить модуль")
	slib.setLang("gprotect", "ru", "miscs_ClearDecals", "Таймер очистки декалей")
	slib.setLang("gprotect", "ru", "miscs_ClearDecals_tooltip", "Таймер в секундах. Чистка декалей для всех игроков за определенное время")
	slib.setLang("gprotect", "ru", "miscs_NoBlackoutGlitch", "Предотвратить эксплойт затемнения")
	slib.setLang("gprotect", "ru", "miscs_NoBlackoutGlitch_tooltip", "Предотвращает использование эксплойта 'pp/copy' (1 = Уведомить, 2 = Кик, 3 = Бан)")
	slib.setLang("gprotect", "ru", "miscs_FadingDoorLag", "Предотвратить лаги от fading door")
	slib.setLang("gprotect", "ru", "miscs_FadingDoorLag_tooltip", "Предотвращает сбой сервера при использовании fading door")
	slib.setLang("gprotect", "ru", "miscs_DisableMotion", "Отключить физику")
	slib.setLang("gprotect", "ru", "miscs_DisableMotion_tooltip", "Отключает физику для всех предметов из черного списка")
	slib.setLang("gprotect", "ru", "miscs_freezeOnSpawn", "Замораживание при спавне")
	slib.setLang("gprotect", "ru", "miscs_freezeOnSpawn_tooltip", "Заморозка предметов при спавне")
	slib.setLang("gprotect", "ru", "miscs_preventFadingDoorAbuse", "Предотвратить злоупотребление инструментом fading door")
	slib.setLang("gprotect", "ru", "miscs_preventFadingDoorAbuse_tooltip", "Предотвращает скрытие игроков в fading door")
	slib.setLang("gprotect", "ru", "miscs_preventSpawnNearbyPlayer", "Предотвратить спавн рядом с игроком")
	slib.setLang("gprotect", "ru", "miscs_preventSpawnNearbyPlayer_tooltip", "Если кто-то находится ближе к месту появления пропа, чем это значение, он не будет спавнить проп (0 означает, что отключено)")
    slib.setLang("gprotect", "ru", "miscs_DRPEntForceOwnership", "Принудительное назначение владельца DarkRP энтити")
    slib.setLang("gprotect", "ru", "miscs_DRPEntForceOwnership_tooltip", "Принудительно назначает владельца энтити, купленным в меню F4")
	slib.setLang("gprotect", "ru", "miscs_DRPMaxObstructsOnPurchaseEnts", "Предел спавна предметов DRP друг в друге")
	slib.setLang("gprotect", "ru", "miscs_DRPMaxObstructsOnPurchaseEnts_tooltip", "Предотвращает спавн большого количества предметов DRP друг в друге")
	slib.setLang("gprotect", "ru", "miscs_DRPObstructsFilter", "Фильтр предметов DarkRP")
	slib.setLang("gprotect", "ru", "miscs_DRPObstructsFilter_tooltip", "Фильтр предметов (1 = Предметы DRP, 2 = Пропы)")
end

slib.setLang("gprotect", "ru", "insufficient-permission", "Недостаточно прав")
--addons/skeypad_1.2.36/lua/s_keypad/client/imgui.lua:
local imgui = {}

imgui.skin = {
	background = Color(0, 0, 0, 0),
	backgroundHover = Color(0, 0, 0, 0),
	
	border = Color(255, 255, 255),
	borderHover = Color(255, 127, 0),
	borderPress = Color(255, 80, 0),
	
	foreground = Color(255, 255, 255),
	foregroundHover = Color(255, 127, 0),
	foregroundPress = Color(255, 80, 0),
}

local devCvar = GetConVar("developer")
function imgui.IsDeveloperMode()
	return not imgui.DisableDeveloperMode and devCvar:GetInt() > 0
end

local _devMode = false -- cached local variable updated once in a while

function imgui.Hook(name, id, callback)
	local hookUniqifier = debug.getinfo(4).short_src
	hook.Add(name, "IMGUI / " .. id .. " / " .. hookUniqifier, callback)
end

local gState = {}

local function shouldAcceptInput()
	-- don't process input during non-main renderpass
	if render.GetRenderTarget() ~= nil then
		return false
	end
	
	-- don't process input if we're doing VGUI stuff (and not in context menu)
	if vgui.CursorVisible() and vgui.GetHoveredPanel() ~= g_ContextMenu then
		return false
	end
	
	return true
end

imgui.Hook("PreRender", "Input", function()
	-- calculate mouse state
	if shouldAcceptInput() then
		local wasPressing = gState.pressing
		gState.pressing = input.IsMouseDown(MOUSE_LEFT) or input.IsKeyDown(KEY_E)
		gState.pressed = not wasPressing and gState.pressing
	end
end)

hook.Add("NotifyShouldTransmit", "IMGUI / ClearRenderBounds", function(ent, shouldTransmit)
	if shouldTransmit and ent._imguiRBExpansion then
		ent._imguiRBExpansion = nil
	end
end)

local traceResultTable = {}
local traceQueryTable = { output = traceResultTable }
local function isObstructed(eyepos, hitPos)
	local q = traceQueryTable
	q.start = eyepos
	q.endpos = hitPos
	if not q.filter then
		q.filter = { LocalPlayer() }
	end

	local tr = util.TraceLine(q)
	if tr.Hit then
		return true, tr.Entity
	else
		return false
	end
end

function imgui.Start3D2D(pos, angles, scale, distanceHide, distanceFadeStart, bypass)
	if gState.shutdown == true then
		return
	end
	
	if gState.rendering == true then
		print("[IMGUI] Starting a new IMGUI context when previous one is still rendering. Shutting down rendering pipeline to prevent crashes..")
		gState.shutdown = true
		return false
	end
	
	_devMode = imgui.IsDeveloperMode()
	
	local eyePos = LocalPlayer():EyePos()
	local eyePosToPos = pos - eyePos
	
	-- OPTIMIZATION: Test that we are in front of the UI
	do
		local normal = angles:Up()
		local dot = eyePosToPos:Dot(normal)
		
		if _devMode then gState._devDot = dot end
		
		-- since normal is pointing away from surface towards viewer, dot<0 is visible
		if dot >= 0 and !bypass then
			return false
		end
	end
	
	-- OPTIMIZATION: Distance based fade/hide
	if distanceHide then
		local distance = eyePosToPos:Length()
		if distance > distanceHide then
			return false
		end
		
		if _devMode then
			gState._devDist = distance
			gState._devHideDist = distanceHide
		end
		
		if distanceHide and distanceFadeStart and distance > distanceFadeStart then
			local blend = math.min(math.Remap(distance, distanceFadeStart, distanceHide, 1, 0), 1)
			render.SetBlend(blend)
			surface.SetAlphaMultiplier(blend)
		end
	end
	
	gState.rendering = true
	gState.pos = pos
	gState.angles = angles
	gState.scale = scale
	
	cam.Start3D2D(pos, angles, scale)
	
	-- calculate mousepos
	if not vgui.CursorVisible() or vgui.IsHoveringWorld() then
		local tr = LocalPlayer():GetEyeTrace()
		local eyepos = tr.StartPos
		local eyenormal
		
		if vgui.CursorVisible() and vgui.IsHoveringWorld() then
			eyenormal = gui.ScreenToVector(gui.MousePos())
		else
			eyenormal = tr.Normal
		end
		
		local planeNormal = angles:Up()
	
		local hitPos = util.IntersectRayWithPlane(eyepos, eyenormal, pos, planeNormal)
		if hitPos then
			local obstructed, obstructer = isObstructed(eyepos, hitPos)
			if obstructed then
				gState.mx = nil
				gState.my = nil
				
				if _devMode then gState._devInputBlocker = "collision " .. obstructer:GetClass() .. "/" .. obstructer:EntIndex() end
			else
				local diff = pos - hitPos
	
				-- This cool code is from Willox's keypad CalculateCursorPos
				local x = diff:Dot(-angles:Forward()) / scale
				local y = diff:Dot(-angles:Right()) / scale
				
				gState.mx = x
				gState.my = y
			end
		else
			gState.mx = nil
			gState.my = nil
			
			if _devMode then gState._devInputBlocker = "not looking at plane" end
		end
	else
		gState.mx = nil
		gState.my = nil
		
		if _devMode then gState._devInputBlocker = "not hovering world" end
	end
	
	if _devMode then gState._renderStarted = SysTime() end
	
	return true
end

function imgui.Entity3D2D(ent, lpos, lang, scale, ...)
	gState.entity = ent
	return imgui.Start3D2D(ent:LocalToWorld(lpos), ent:LocalToWorldAngles(lang), scale, ...)
end

local function calculateRenderBounds(x, y, w, h)
	local pos = gState.pos
	local fwd, right = gState.angles:Forward(), gState.angles:Right()
	local scale = gState.scale
	local firstCorner, secondCorner =
		pos + fwd * x * scale + right * y * scale,
		pos + fwd * (x+w) * scale + right * (y+h) * scale
		
	local minrb, maxrb = Vector(math.huge, math.huge, math.huge), Vector(-math.huge, -math.huge, -math.huge)
	
	minrb.x = math.min(minrb.x, firstCorner.x, secondCorner.x)
	minrb.y = math.min(minrb.y, firstCorner.y, secondCorner.y)
	minrb.z = math.min(minrb.z, firstCorner.z, secondCorner.z)
	maxrb.x = math.max(maxrb.x, firstCorner.x, secondCorner.x)
	maxrb.y = math.max(maxrb.y, firstCorner.y, secondCorner.y)
	maxrb.z = math.max(maxrb.z, firstCorner.z, secondCorner.z)
	
	return minrb, maxrb
end

function imgui.ExpandRenderBoundsFromRect(x, y, w, h)
	local ent = gState.entity
	if IsValid(ent) then
		-- make sure we're not applying same expansion twice
		local expansion = ent._imguiRBExpansion
		if expansion then
			local ex, ey, ew, eh = unpack(expansion)
			if ex == x and ey == y and ew == w and eh == h then
				return
			end
		end
		
		local minrb, maxrb = calculateRenderBounds(x, y, w, h)
		
		ent:SetRenderBoundsWS(minrb, maxrb)
		if _devMode then
			print("[IMGUI] Updated renderbounds of ", ent, " to ", minrb, "x", maxrb)
		end
		
		ent._imguiRBExpansion = {x, y, w, h}
	else
		if _devMode then
			print("[IMGUI] Attempted to update renderbounds when entity is not valid!! ", debug.traceback())
		end
	end
end

local function drawDeveloperInfo()
	local ang = LocalPlayer():EyeAngles()
	ang:RotateAroundAxis(ang:Right(), 90)
	ang:RotateAroundAxis(ang:Up(), -90)
	
	cam.IgnoreZ(true)
	cam.Start3D2D(gState.pos + Vector(0, 0, 30), ang, 0.15)
	surface.SetDrawColor(0, 0, 0, 200)
	surface.DrawRect(-100, 0, 200, 140)
	draw.SimpleText("imgui developer", "DefaultFixedDropShadow", 0, 5, Color(78, 205, 196), TEXT_ALIGN_CENTER, nil)
	surface.SetDrawColor(78, 205, 196)
	surface.DrawLine(-50, 16, 50, 16)
	
	local mx, my = gState.mx, gState.my
	if mx and my then
		draw.SimpleText(string.format("mouse: hovering %d x %d", mx, my), "DefaultFixedDropShadow", 0, 20, Color(0, 255, 0), TEXT_ALIGN_CENTER, nil)
	else
		draw.SimpleText(string.format("mouse: %s", gState._devInputBlocker or ""), "DefaultFixedDropShadow", 0, 20, Color(255, 0, 0), TEXT_ALIGN_CENTER, nil)
	end
	
	local pos = gState.pos
	draw.SimpleText(string.format("pos: %.2f %.2f %.2f", pos.x, pos.y, pos.z), "DefaultFixedDropShadow", 0, 40, nil, TEXT_ALIGN_CENTER, nil)
	draw.SimpleText(string.format("distance %.2f / %.2f", gState._devDist or 0, gState._devHideDist or 0), "DefaultFixedDropShadow", 0, 53, Color(200, 200, 200, 200), TEXT_ALIGN_CENTER, nil)
	
	local ang = gState.angles
	draw.SimpleText(string.format("ang: %.2f %.2f %.2f", ang.p, ang.y, ang.r), "DefaultFixedDropShadow", 0, 75, nil, TEXT_ALIGN_CENTER, nil)
	draw.SimpleText(string.format("dot %d", gState._devDot or 0), "DefaultFixedDropShadow", 0, 88, Color(200, 200, 200, 200), TEXT_ALIGN_CENTER, nil)
	
	local angToEye = (pos - LocalPlayer():EyePos()):Angle()
	angToEye:RotateAroundAxis(ang:Up(), -90)
	angToEye:RotateAroundAxis(ang:Right(), 90)
	
	draw.SimpleText(string.format("angle to eye (%d,%d,%d)", angToEye.p, angToEye.y, angToEye.r), "DefaultFixedDropShadow", 0, 100, Color(200, 200, 200, 200), TEXT_ALIGN_CENTER, nil)
	
	draw.SimpleText(string.format("rendertime avg: %.2fms", (gState._devBenchAveraged or 0) * 1000), "DefaultFixedDropShadow", 0, 120, nil, TEXT_ALIGN_CENTER, nil)
	
	cam.End3D2D()
	cam.IgnoreZ(false)
	
	local ent = gState.entity
	if IsValid(ent) and ent._imguiRBExpansion then
		local ex, ey, ew, eh = unpack(ent._imguiRBExpansion)
		local minrb, maxrb = calculateRenderBounds(ex, ey, ew, eh)
		render.DrawWireframeBox(Vector(0, 0, 0), Angle(0, 0, 0), minrb, maxrb, Color(0, 0, 255))
	end
end

function imgui.End3D2D()
	if gState then
		if _devMode then
			local renderTook = SysTime() - gState._renderStarted
			gState._devBenchTests = (gState._devBenchTests or 0) + 1
			gState._devBenchTaken = (gState._devBenchTaken or 0) + renderTook
			if gState._devBenchTests == 100 then
				gState._devBenchAveraged = gState._devBenchTaken / 100
				gState._devBenchTests = 0
				gState._devBenchTaken = 0
			end
		end
		
		gState.rendering = false
		cam.End3D2D()
		render.SetBlend(1)
		surface.SetAlphaMultiplier(1)
		
		if _devMode then
			drawDeveloperInfo()
		end
	end
end

function imgui.CursorPos()
	local mx, my = gState.mx, gState.my
	return mx, my
end

function imgui.IsHovering(x, y, w, h)
	local mx, my = gState.mx, gState.my
	return mx and my and mx >= x and mx <= (x+w) and my >= y and my <= (y+h)
end
function imgui.IsPressing()
	return shouldAcceptInput() and gState.pressing
end
function imgui.IsPressed()
	return shouldAcceptInput() and gState.pressed
end

-- The cache that has String->Bool mappings telling if font has been created
local _createdFonts = {}

local EXCLAMATION_BYTE = string.byte("!")
function imgui.xFont(font, defaultSize)
	-- special font
	if string.byte(font, 1) == EXCLAMATION_BYTE then
		
		-- Font not cached; parse the font
		local name, size = font:match("!([^@]+)@(.+)")
		if size then size = tonumber(size) end
		
		if not size and defaultSize then
			name = font:match("^!([^@]+)$")
			size = defaultSize
		end
		
		local fontName = string.format("IMGUI_%s_%d", name, size)

		if not _createdFonts[fontName] then
			surface.CreateFont(fontName, {
				font = name,
				size = size
			})
			_createdFonts[fontName] = true
		end

		return fontName
	end
	return font
end

function imgui.xButton(x, y, w, h, borderWidth, borderClr, hoverClr, pressColor)
	local bw = borderWidth or 1
	
	local bgColor = imgui.IsHovering(x, y, w, h) and imgui.skin.backgroundHover or imgui.skin.background
	local borderColor = ((imgui.IsPressing() and imgui.IsHovering(x, y, w, h)) and (pressColor or imgui.skin.borderPress)) or 
	(imgui.IsHovering(x, y, w, h) and (hoverClr or imgui.skin.borderHover)) or (borderClr or imgui.skin.border)
	
	
	surface.SetDrawColor(bgColor)
	surface.DrawRect(x, y, w, h)
	
	if bw > 0 then
		surface.SetDrawColor(borderColor)

		surface.DrawRect(x, y, w, bw)
		surface.DrawRect(x, y+bw, bw, h-bw*2)
		surface.DrawRect(x, y+h-bw, w, bw)
		surface.DrawRect(x+w-bw+1, y, bw, h)
	end
	
	return shouldAcceptInput() and imgui.IsHovering(x, y, w, h) and gState.pressed
end

function imgui.xCursor(x, y, w, h)
	local fgColor = imgui.IsPressing() and imgui.skin.foregroundPress or imgui.skin.foreground
	local mx, my = gState.mx, gState.my
	
	if not mx or not my then return end
	
	if x and w and (mx < x or mx > x + w) then return end
	if y and h and (my < y or my > y + h) then return end
	
	local cursorSize = math.ceil(0.3 / gState.scale)
	surface.SetDrawColor(fgColor)
	surface.DrawLine(mx - cursorSize, my, mx + cursorSize, my)
	surface.DrawLine(mx, my - cursorSize, mx, my + cursorSize)
end

function imgui.xTextButton(text, font, x, y, w, h, borderWidth, color, hoverClr, pressColor)
	local fgColor = ((imgui.IsPressing() and imgui.IsHovering(x, y, w, h)) and (pressColor or imgui.skin.foregroundPress)) or 
	(imgui.IsHovering(x, y, w, h) and (hoverClr or imgui.skin.foregroundHover)) or (color or imgui.skin.foreground)
	
	local clicked = imgui.xButton(x, y, w, h, borderWidth, color, hoverClr, pressColor)
	
	font = imgui.xFont(font, math.floor(h * 0.618))
	draw.SimpleText(text, font, x+w/2, y+h/2, fgColor, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)
	
	return clicked
end

return imgui

--addons/skeypad_1.2.36/lua/s_keypad/client/cl_skeypad.lua:
CreateClientConVar("skeypad_hidecode", "0", true, false)

local imgui = include("s_keypad/client/imgui.lua")

local keypadData = {}

sKeypad = sKeypad or {}

local createdFrames = {}

local digital_font = sKeypad.config.DigitalTextFontType == 1 and "Digital dream" or "digital display tfb"
local digital_font_size = sKeypad.config.DigitalTextFontType == 1 and 24 or 52

slib.createFont("Nasalization Rg", 40, 500)
local screencode = slib.createFont("Digital dream", 50)
local screentext = slib.createFont(digital_font, digital_font_size, sKeypad.config.DigitalTextFontType == 1 and 700 or 400)
local roboto21 = slib.createFont("Roboto", 21)
local roboto16 = slib.createFont("Roboto", 16)
local roboto14 = slib.createFont("Roboto", 14)
local roboto12 = slib.createFont("Roboto", 12)


local rowCount = {}
local itemCount = {}

local function addDigit(ent, digit)
	if !IsValid(ent) or ent:GetClass() ~= "s_keypad" or ent:GetSkin() ~= 0 or ent:GetPos():DistToSqr(LocalPlayer():GetPos()) > sKeypad.config.MaxDistance or ent:GetBodygroup(2) ~= 0 then return end
	if ent.Code then
		if string.len(ent.Code) >= 4 then return end
		ent.Code = ent.Code..digit
	else
		ent.Code = digit
	end
end

local hovercol, transparent = Color(255, 255, 255, 40), Color(255, 255, 255, 0)
local function addButton(txt, ent, func)
	local wide, tall = 62, 51
	
    if itemCount[ent] then
        itemCount[ent] = itemCount[ent] >= 2 and -1 or itemCount[ent]
    end

    itemCount[ent] = (itemCount[ent] and itemCount[ent] + 1) or 0
    rowCount[ent] = rowCount[ent] or 0
	
	local x = wide * itemCount[ent] + (itemCount[ent] > 0 and (13 * itemCount[ent]) or 0)
	local y = tall * rowCount[ent] + (rowCount[ent] > 0 and (11 * rowCount[ent]) or 0)

	
    if imgui.xButton(x, y, wide, tall, 2, transparent, hovercol, transparent) then
		surface.PlaySound(sKeypad.config.KeypressSound)
		if func then
            func(ent) return 
        else
			addDigit(ent, txt)
        end
	end

    rowCount[ent] = (itemCount[ent] >= 2 and rowCount[ent] + 1) or rowCount[ent] or 0
end

local successcol, failcol, orangecol, shade_5, shade_15, white = slib.getTheme("successcolor"), slib.getTheme("failcolor"), slib.getTheme("orangecolor"), slib.getTheme("maincolor", 5), slib.getTheme("maincolor", 15), Color(255,255,255)

local pay_ico = Material("skeypad/pay.png")

sKeypad.DrawScreen = function(ent)
    if !imgui then return end

    local ang = ent:GetAngles()
	ang:RotateAroundAxis(ang:Right(), -90)
	ang:RotateAroundAxis(ang:Up(), 90)

    surface.SetFont(screencode)
    local wide, tall = surface.GetTextSize("@@@@")

    local skin = ent:GetSkin()

    if imgui.Start3D2D(ent:LocalToWorld(Vector(1.164184, -3.578613, 6.865723)), ang, 0.03, 180, 170) then
        local hideCode = ConVarExists("skeypad_hidecode") and GetConVar("skeypad_hidecode"):GetBool() or false
        
        if skin == 0 then
			if ent:GetBodygroup(2) == 0 then
                draw.SimpleText("@@@@", screencode, 120, 60, shade_5, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)
                draw.SimpleText(ent.Code and (hideCode and string.gsub(ent.Code, "%d", "*") or ent.Code) or "", screencode, 120 - wide * .5, 60, sKeypad.config.UI["textcolor"], TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER)
            else
                draw.SimpleText(slib.getLang("skeypad", sKeypad.config.Language, "awaiting"), screentext, 120, 60, orangecol, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)
			end
        elseif skin == 1 then
            if ent.Code then ent.Code = nil end
            draw.SimpleText(slib.getLang("skeypad", sKeypad.config.Language, "granted"), screentext, 120, 60, successcol, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)
        elseif skin == 2 then
            if ent.Code then ent.Code = nil end
            draw.SimpleText(slib.getLang("skeypad", sKeypad.config.Language, "denied"), screentext, 120, 60, failcol, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)
        end
		
		imgui.End3D2D()
	end
end

sKeypad.DrawKeypad = function(ent)
    if !imgui or ent:GetSkin() ~= 0 then return end

    local ang = ent:GetAngles()
	ang:RotateAroundAxis(ang:Right(), -90)
	ang:RotateAroundAxis(ang:Up(), 90)

	if imgui.Start3D2D(ent:LocalToWorld(Vector(1.22, -3.177233, 1.159668)), ang, 0.03, 80, 70) then
		for i=1,9 do
			addButton(i, ent)
        end
        
        addButton("cancel", ent, function(ent) ent.Code = nil end)
        addButton(0, ent)
        addButton("enter", ent, function(ent) if !ent.Code then return end net.Start("sK:Handeler") net.WriteUInt(1, 2) net.WriteUInt(ent.Code, 14) net.SendToServer() ent.Code = nil end)

		itemCount[ent] = nil
		rowCount[ent] = nil
		
		imgui.End3D2D()
	end
end

local selectionWidth = math.floor(ScrH() * 0.04)

local matCache = {}

local function addButtonSquare(parent, ent, mat, iconsize, func, validation, toggle)
	local bttn = vgui.Create("DButton", parent)
	bttn:Dock(LEFT)
	bttn:SetWide(selectionWidth)
    bttn:SetText("")
    
    if !matCache[mat] then
        matCache[mat] = Material(mat, "noclamp smooth")
    end

	bttn.Paint = function(s,w,h)
		local size = w * iconsize

		surface.SetDrawColor(validation(ent) and successcol or (toggle and shade_15 or failcol))
		surface.DrawOutlinedRect(0,0,w,h)
		
		surface.SetMaterial(matCache[mat])
		surface.SetDrawColor(slib.getTheme("whitecolor"))
		surface.DrawTexturedRect( w * .5 - (size * .5), h * .5 - (size * .5), size, size )
	end

	bttn.DoClick = function()
        func(ent)
	end
	
	return bttn
end

local function updateSetting(ent, setting)
	local newdata = keypadData[ent]

	if setting then
		newdata = keypadData[ent][setting]
	end
	
	net.Start("sK:Handeler")

	if setting then
		net.WriteUInt(3, 2)
		net.WriteEntity(ent)
		net.WriteString(setting)

		if isbool(newdata) then
			net.WriteUInt(3, 2)
			net.WriteBool(newdata)
		elseif isnumber(newdata) then
			net.WriteUInt(1, 2)
			net.WriteUInt(newdata, 14)
		elseif istable(newdata) then
			net.WriteUInt(2, 2)
			net.WriteString(util.TableToJSON(newdata))
		end
	else
		newdata = util.Compress(util.TableToJSON(newdata))

		local chunksize = #data

		net.WriteUInt(3, 2)
		net.WriteEntity(ent)
		net.WriteString("")
		net.WriteUInt(chunksize, 32)
		net.WriteData(newdata, chunksize)
	end

	net.SendToServer()
end

local function openSettings(ent)
	local settings_menu = vgui.Create("SFrame")
	:setTitle(slib.getLang("skeypad", sKeypad.config.Language, "title"))
	:SetSize(slib.getScaledSize(sKeypad.config.FrameSize.x, "x"), slib.getScaledSize(sKeypad.config.FrameSize.y, "y"))
	:addCloseButton()
	:MakePopup()
	:Center()

    local canvas = vgui.Create("SScrollPanel", settings_menu.frame)
    canvas:Dock(FILL)
    canvas:GetCanvas():DockPadding(0,slib.getTheme("margin"),0,slib.getTheme("margin"))

	local modes = vgui.Create("SListPanel", canvas)
	modes:setTitle(slib.getLang("skeypad", sKeypad.config.Language, "modes"))
	:SetTall(selectionWidth + slib.getScaledSize(25, "y"))

	local selection = vgui.Create("EditablePanel", modes.frame)
	selection:Dock(TOP)
	selection:DockPadding(0,3,0,3)
	selection:SetTall(selectionWidth)

	if !sKeypad.config.DisabledModes["code"] then
    	addButtonSquare(selection, ent, "skeypad/passcode.png", .8, function(ent) keypadData[ent].mode = 0 updateSetting(ent, "mode") end, function(ent) return keypadData[ent].mode == 0 end, true)
	end
	
	if !sKeypad.config.DisabledModes["fingerprint"] then
    	addButtonSquare(selection, ent, "skeypad/fingerprint.png", .7, function(ent) keypadData[ent].mode = 1 updateSetting(ent, "mode") end, function(ent) return keypadData[ent].mode == 1 end, true)
	end

	if !sKeypad.config.DisabledModes["keycard"] then
		addButtonSquare(selection, ent, "skeypad/keycard.png", .7, function(ent) keypadData[ent].mode = 2 updateSetting(ent, "mode") end, function(ent) return keypadData[ent].mode == 2 end, true)
	end

	local upgradelist = vgui.Create("SListPanel", canvas)
	upgradelist:setTitle(slib.getLang("skeypad", sKeypad.config.Language, "upgrades"))
	:SetTall(selectionWidth + slib.getScaledSize(25, "y"))

	local selection1 = vgui.Create("EditablePanel", upgradelist.frame)
	selection1:Dock(TOP)
	selection1:DockPadding(0,3,0,3)
	selection1:SetTall(selectionWidth)
	local added = 0

	for k,v in pairs(sKeypad.config.Upgrades) do
		if !DarkRP then break end
		if v.price <= -1 then continue end
		local upgrade = addButtonSquare(selection1, ent, v.icon, .7, function(ent) net.Start("sK:Handeler") net.WriteUInt(2,2) net.WriteEntity(ent) net.WriteString(k) net.SendToServer() end, function(ent) return keypadData[ent].upgrades[k] end)
		upgrade:SetZPos(v.sortOrder)
		upgrade.PaintOver = function(s,w,h)
			if !s:IsHovered() or keypadData[ent].upgrades[k] then return end
			slib.DrawBlur(s, 2)
			draw.SimpleText(sKeypad.config.Currency..(ent:IsPermaKeypad() and 0 or string.Comma(v.price)), roboto12, w * .5, h * .5, LocalPlayer():canAfford(v.price) and successcol or failcol, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)
		end

		added = added + 1
	end

	if added <= 0 then upgradelist:Remove() end

	local auth_list = vgui.Create("SListPanel", canvas)
	:setTitle(slib.getLang("skeypad", sKeypad.config.Language, "auth_list"))
	:SetTall(slib.getScaledSize(180,"y"))
	:DockMargin(slib.getTheme("margin"),0,slib.getTheme("margin"),slib.getTheme("margin"))

	for k,v in ipairs(player.GetAll()) do
		if v:IsBot() or (v == LocalPlayer() and !ent:GetPersisted()) then continue end
		local _, entry = auth_list:addEntry(v, true, slib.getLang("skeypad", sKeypad.config.Language, "players"))

		if v:GetFriendStatus() == "friend" then entry:SetZPos(-10) end
			
		entry.toggleCheck = function() return keypadData[ent]["authed"][v:SteamID()] end
		entry.DoClick = function()
			keypadData[ent]["authed"][v:SteamID()] = !keypadData[ent]["authed"][v:SteamID()]
			updateSetting(ent, "authed")
		end
	end

	if DarkRP and RPExtraTeams then
		for k,v in pairs(RPExtraTeams) do
			local _, entry = auth_list:addEntry(team.GetName(k), true, slib.getLang("skeypad", sKeypad.config.Language, "darkrp_jobs"))

			entry.toggleCheck = function() return keypadData[ent]["authed"][team.GetName(k)] end

			entry.DoClick = function()
				keypadData[ent]["authed"][team.GetName(k)] = !keypadData[ent]["authed"][team.GetName(k)]
				updateSetting(ent, "authed")
			end
		end
	end

	auth_list:addDropdown()
	:addOption(slib.getLang("skeypad", sKeypad.config.Language, "players"))
	:addOption(slib.getLang("skeypad", sKeypad.config.Language, "darkrp_jobs"))

	if BlobsPartyConfig or party or sPartySystem then
		local authedparty = vgui.Create("SStatement", canvas)
		local _, ap = authedparty:addStatement(slib.getLang("skeypad", sKeypad.config.Language, "auth_party"), keypadData[ent].authed["party"])
			
		ap.onValueChange = function(newval)
			keypadData[ent]["authed"]["party"] = newval
			updateSetting(ent, "authed")
		end
	end

	if mg2 or (BRICKS_SERVER and BRICKS_SERVER.BASECONFIG and BRICKS_SERVER.BASECONFIG.GANGS) then
		local authedgang = vgui.Create("SStatement", canvas)
		local _, ag = authedgang:addStatement(slib.getLang("skeypad", sKeypad.config.Language, "auth_gang"), keypadData[ent].authed["gang"])
			
		ag.onValueChange = function(newval)
			keypadData[ent]["authed"]["gang"] = newval
			updateSetting(ent, "authed")
		end
	end

	if VoidFactions then
		local authedfaction = vgui.Create("SStatement", canvas)
		local _, af = authedfaction:addStatement(slib.getLang("skeypad", sKeypad.config.Language, "auth_faction"), keypadData[ent].authed["faction"])
			
		af.onValueChange = function(newval)
			keypadData[ent]["authed"]["faction"] = newval
			updateSetting(ent, "authed")
		end
	end

	if FPP then
		local authedfpp = vgui.Create("SStatement", canvas)
		local _, aFPP = authedfpp:addStatement(slib.getLang("skeypad", sKeypad.config.Language, "auth_fpp_buddy"), keypadData[ent].authed["fppbuddy"])
			
		aFPP.onValueChange = function(newval)
			keypadData[ent]["authed"]["fppbuddy"] = newval
			updateSetting(ent, "authed")
		end
	end

	local canAuthEdit = vgui.Create("SStatement", canvas)
	local _, cAE = canAuthEdit:addStatement(slib.getLang("skeypad", sKeypad.config.Language, "auth_cansettings"), keypadData[ent].canauthedit)
		
	cAE.onValueChange = function(newval)
		keypadData[ent].canauthedit = newval
		updateSetting(ent, "canauthedit")
	end

	local codeentry = vgui.Create("SStatement", canvas)
	local _, ce_num = codeentry:addStatement(slib.getLang("skeypad", sKeypad.config.Language, "access_code"), keypadData[ent].code)
	ce_num:SetMax(9999)
	ce_num:SetMin(0)

	ce_num.onValueChange = function(newval)
		keypadData[ent].code = newval
		updateSetting(ent, "code")
	end

	local timerOpen = vgui.Create("SStatement", canvas)
	local _, to_num = timerOpen:addStatement(slib.getLang("skeypad", sKeypad.config.Language, "hold_length"), keypadData[ent].timer)
	to_num:SetMax(sKeypad.config.GrantedDelay.max)
	to_num:SetMin(sKeypad.config.GrantedDelay.min)

	to_num.onValueChange = function(newval)
		keypadData[ent].timer = newval
		updateSetting(ent, "timer")
	end

	local toggleOpen = vgui.Create("SStatement", canvas)
	local _, tO = toggleOpen:addStatement(slib.getLang("skeypad", sKeypad.config.Language, "start_faded"), keypadData[ent].inverse)

	tO.onValueChange = function(newval)
		keypadData[ent].inverse = newval
		updateSetting(ent, "inverse")
	end

	local toggle = vgui.Create("SStatement", canvas)
	local _, toggle_Bool = toggle:addStatement(slib.getLang("skeypad", sKeypad.config.Language, "toggle"), keypadData[ent].toggle)

	toggle_Bool.onValueChange = function(newval)
		keypadData[ent].toggle = newval
		updateSetting(ent, "toggle")
	end
end

local pressedKeys = {}

local ENUMToKey = {
	[37] = 0,
	[38] = 1,
	[39] = 2,
	[40] = 3,
	[41] = 4,
	[42] = 5,
	[43] = 6,
	[44] = 7,
	[45] = 8,
	[46] = 9
}

timer.Create("numpadKeyPressDetection", .01, 0, function()
	for i=37,46 do
		if input.IsKeyDown(i) and !pressedKeys[i] then
			pressedKeys[i] = true
		end
	end

	local enter, backspace = (input.IsKeyDown(KEY_ENTER) or input.IsKeyDown(KEY_PAD_ENTER)), input.IsKeyDown(KEY_BACKSPACE)

	if enter or backspace then
		local ent = LocalPlayer():GetEyeTrace().Entity
		if IsValid(ent) and ent:GetClass() == "s_keypad" and ent:GetSkin() == 0 then
			if ent.Code then
				if enter then
					net.Start("sK:Handeler") net.WriteUInt(1, 2) net.WriteUInt(ent.Code, 14) net.SendToServer() ent.Code = nil
				else
					ent.Code = nil
				end
			end
		end
	end
end)

timer.Create("numpadKeyHandeling", .05, 0, function()
	for i=37,46 do
		if pressedKeys[i] and !input.IsKeyDown(i) then
			pressedKeys[i] = nil
			local ent = LocalPlayer():GetEyeTrace().Entity
			addDigit(ent, ENUMToKey[i])
		end
	end
end)

net.Receive("sK:Handeler", function()
    local action = net.ReadUInt(2)

    if action == 1 then
        local ent = net.ReadEntity()
        local len = net.ReadUInt(32)

        if len then
            keypadData[ent] = util.JSONToTable(util.Decompress(net.ReadData(len)))
        end

    elseif action == 2 then
        local ent = net.ReadEntity()

        openSettings(ent)
	end
end)

properties.Add("addPermaKeypad", {
	MenuLabel = slib.getLang("skeypad", sKeypad.config.Language, "add_perma"),
	Order = 2001,
	MenuIcon = "icon16/transmit.png",
	Filter = function(self, ent, ply)
		if !IsValid(ent) or ent:GetClass() ~= "s_keypad" or ent:GetPersisted() then return false end

		return !!sKeypad.config.BypassGroups[ply:GetUserGroup()]
	end,
	Action = function(self, ent)
		if !IsValid(ent) then return false end
		net.Start("sK:Handeler")
		net.WriteUInt(0, 2)
		net.WriteEntity(ent)
		net.WriteBool(true)
		net.SendToServer()
	end
})

properties.Add("RemovePermaKeypad", {
	MenuLabel = slib.getLang("skeypad", sKeypad.config.Language, "remove_perma"),
	Order = 2001,
	MenuIcon = "icon16/transmit.png",
	Filter = function(self, ent, ply)
		if !IsValid(ent) or ent:GetClass() ~= "s_keypad" or !ent:GetPersisted() then return false end

		return !!sKeypad.config.BypassGroups[ply:GetUserGroup()]
	end,
	Action = function(self, ent)
		if !IsValid(ent) then return false end

		net.Start("sK:Handeler")
		net.WriteUInt(0, 2)
		net.WriteEntity(ent)
		net.WriteBool(false)
		net.SendToServer()
	end
})
--addons/skeypad_1.2.36/lua/s_keypad/client/imgui.lua:
local imgui = {}

imgui.skin = {
	background = Color(0, 0, 0, 0),
	backgroundHover = Color(0, 0, 0, 0),
	
	border = Color(255, 255, 255),
	borderHover = Color(255, 127, 0),
	borderPress = Color(255, 80, 0),
	
	foreground = Color(255, 255, 255),
	foregroundHover = Color(255, 127, 0),
	foregroundPress = Color(255, 80, 0),
}

local devCvar = GetConVar("developer")
function imgui.IsDeveloperMode()
	return not imgui.DisableDeveloperMode and devCvar:GetInt() > 0
end

local _devMode = false -- cached local variable updated once in a while

function imgui.Hook(name, id, callback)
	local hookUniqifier = debug.getinfo(4).short_src
	hook.Add(name, "IMGUI / " .. id .. " / " .. hookUniqifier, callback)
end

local gState = {}

local function shouldAcceptInput()
	-- don't process input during non-main renderpass
	if render.GetRenderTarget() ~= nil then
		return false
	end
	
	-- don't process input if we're doing VGUI stuff (and not in context menu)
	if vgui.CursorVisible() and vgui.GetHoveredPanel() ~= g_ContextMenu then
		return false
	end
	
	return true
end

imgui.Hook("PreRender", "Input", function()
	-- calculate mouse state
	if shouldAcceptInput() then
		local wasPressing = gState.pressing
		gState.pressing = input.IsMouseDown(MOUSE_LEFT) or input.IsKeyDown(KEY_E)
		gState.pressed = not wasPressing and gState.pressing
	end
end)

hook.Add("NotifyShouldTransmit", "IMGUI / ClearRenderBounds", function(ent, shouldTransmit)
	if shouldTransmit and ent._imguiRBExpansion then
		ent._imguiRBExpansion = nil
	end
end)

local traceResultTable = {}
local traceQueryTable = { output = traceResultTable }
local function isObstructed(eyepos, hitPos)
	local q = traceQueryTable
	q.start = eyepos
	q.endpos = hitPos
	if not q.filter then
		q.filter = { LocalPlayer() }
	end

	local tr = util.TraceLine(q)
	if tr.Hit then
		return true, tr.Entity
	else
		return false
	end
end

function imgui.Start3D2D(pos, angles, scale, distanceHide, distanceFadeStart, bypass)
	if gState.shutdown == true then
		return
	end
	
	if gState.rendering == true then
		print("[IMGUI] Starting a new IMGUI context when previous one is still rendering. Shutting down rendering pipeline to prevent crashes..")
		gState.shutdown = true
		return false
	end
	
	_devMode = imgui.IsDeveloperMode()
	
	local eyePos = LocalPlayer():EyePos()
	local eyePosToPos = pos - eyePos
	
	-- OPTIMIZATION: Test that we are in front of the UI
	do
		local normal = angles:Up()
		local dot = eyePosToPos:Dot(normal)
		
		if _devMode then gState._devDot = dot end
		
		-- since normal is pointing away from surface towards viewer, dot<0 is visible
		if dot >= 0 and !bypass then
			return false
		end
	end
	
	-- OPTIMIZATION: Distance based fade/hide
	if distanceHide then
		local distance = eyePosToPos:Length()
		if distance > distanceHide then
			return false
		end
		
		if _devMode then
			gState._devDist = distance
			gState._devHideDist = distanceHide
		end
		
		if distanceHide and distanceFadeStart and distance > distanceFadeStart then
			local blend = math.min(math.Remap(distance, distanceFadeStart, distanceHide, 1, 0), 1)
			render.SetBlend(blend)
			surface.SetAlphaMultiplier(blend)
		end
	end
	
	gState.rendering = true
	gState.pos = pos
	gState.angles = angles
	gState.scale = scale
	
	cam.Start3D2D(pos, angles, scale)
	
	-- calculate mousepos
	if not vgui.CursorVisible() or vgui.IsHoveringWorld() then
		local tr = LocalPlayer():GetEyeTrace()
		local eyepos = tr.StartPos
		local eyenormal
		
		if vgui.CursorVisible() and vgui.IsHoveringWorld() then
			eyenormal = gui.ScreenToVector(gui.MousePos())
		else
			eyenormal = tr.Normal
		end
		
		local planeNormal = angles:Up()
	
		local hitPos = util.IntersectRayWithPlane(eyepos, eyenormal, pos, planeNormal)
		if hitPos then
			local obstructed, obstructer = isObstructed(eyepos, hitPos)
			if obstructed then
				gState.mx = nil
				gState.my = nil
				
				if _devMode then gState._devInputBlocker = "collision " .. obstructer:GetClass() .. "/" .. obstructer:EntIndex() end
			else
				local diff = pos - hitPos
	
				-- This cool code is from Willox's keypad CalculateCursorPos
				local x = diff:Dot(-angles:Forward()) / scale
				local y = diff:Dot(-angles:Right()) / scale
				
				gState.mx = x
				gState.my = y
			end
		else
			gState.mx = nil
			gState.my = nil
			
			if _devMode then gState._devInputBlocker = "not looking at plane" end
		end
	else
		gState.mx = nil
		gState.my = nil
		
		if _devMode then gState._devInputBlocker = "not hovering world" end
	end
	
	if _devMode then gState._renderStarted = SysTime() end
	
	return true
end

function imgui.Entity3D2D(ent, lpos, lang, scale, ...)
	gState.entity = ent
	return imgui.Start3D2D(ent:LocalToWorld(lpos), ent:LocalToWorldAngles(lang), scale, ...)
end

local function calculateRenderBounds(x, y, w, h)
	local pos = gState.pos
	local fwd, right = gState.angles:Forward(), gState.angles:Right()
	local scale = gState.scale
	local firstCorner, secondCorner =
		pos + fwd * x * scale + right * y * scale,
		pos + fwd * (x+w) * scale + right * (y+h) * scale
		
	local minrb, maxrb = Vector(math.huge, math.huge, math.huge), Vector(-math.huge, -math.huge, -math.huge)
	
	minrb.x = math.min(minrb.x, firstCorner.x, secondCorner.x)
	minrb.y = math.min(minrb.y, firstCorner.y, secondCorner.y)
	minrb.z = math.min(minrb.z, firstCorner.z, secondCorner.z)
	maxrb.x = math.max(maxrb.x, firstCorner.x, secondCorner.x)
	maxrb.y = math.max(maxrb.y, firstCorner.y, secondCorner.y)
	maxrb.z = math.max(maxrb.z, firstCorner.z, secondCorner.z)
	
	return minrb, maxrb
end

function imgui.ExpandRenderBoundsFromRect(x, y, w, h)
	local ent = gState.entity
	if IsValid(ent) then
		-- make sure we're not applying same expansion twice
		local expansion = ent._imguiRBExpansion
		if expansion then
			local ex, ey, ew, eh = unpack(expansion)
			if ex == x and ey == y and ew == w and eh == h then
				return
			end
		end
		
		local minrb, maxrb = calculateRenderBounds(x, y, w, h)
		
		ent:SetRenderBoundsWS(minrb, maxrb)
		if _devMode then
			print("[IMGUI] Updated renderbounds of ", ent, " to ", minrb, "x", maxrb)
		end
		
		ent._imguiRBExpansion = {x, y, w, h}
	else
		if _devMode then
			print("[IMGUI] Attempted to update renderbounds when entity is not valid!! ", debug.traceback())
		end
	end
end

local function drawDeveloperInfo()
	local ang = LocalPlayer():EyeAngles()
	ang:RotateAroundAxis(ang:Right(), 90)
	ang:RotateAroundAxis(ang:Up(), -90)
	
	cam.IgnoreZ(true)
	cam.Start3D2D(gState.pos + Vector(0, 0, 30), ang, 0.15)
	surface.SetDrawColor(0, 0, 0, 200)
	surface.DrawRect(-100, 0, 200, 140)
	draw.SimpleText("imgui developer", "DefaultFixedDropShadow", 0, 5, Color(78, 205, 196), TEXT_ALIGN_CENTER, nil)
	surface.SetDrawColor(78, 205, 196)
	surface.DrawLine(-50, 16, 50, 16)
	
	local mx, my = gState.mx, gState.my
	if mx and my then
		draw.SimpleText(string.format("mouse: hovering %d x %d", mx, my), "DefaultFixedDropShadow", 0, 20, Color(0, 255, 0), TEXT_ALIGN_CENTER, nil)
	else
		draw.SimpleText(string.format("mouse: %s", gState._devInputBlocker or ""), "DefaultFixedDropShadow", 0, 20, Color(255, 0, 0), TEXT_ALIGN_CENTER, nil)
	end
	
	local pos = gState.pos
	draw.SimpleText(string.format("pos: %.2f %.2f %.2f", pos.x, pos.y, pos.z), "DefaultFixedDropShadow", 0, 40, nil, TEXT_ALIGN_CENTER, nil)
	draw.SimpleText(string.format("distance %.2f / %.2f", gState._devDist or 0, gState._devHideDist or 0), "DefaultFixedDropShadow", 0, 53, Color(200, 200, 200, 200), TEXT_ALIGN_CENTER, nil)
	
	local ang = gState.angles
	draw.SimpleText(string.format("ang: %.2f %.2f %.2f", ang.p, ang.y, ang.r), "DefaultFixedDropShadow", 0, 75, nil, TEXT_ALIGN_CENTER, nil)
	draw.SimpleText(string.format("dot %d", gState._devDot or 0), "DefaultFixedDropShadow", 0, 88, Color(200, 200, 200, 200), TEXT_ALIGN_CENTER, nil)
	
	local angToEye = (pos - LocalPlayer():EyePos()):Angle()
	angToEye:RotateAroundAxis(ang:Up(), -90)
	angToEye:RotateAroundAxis(ang:Right(), 90)
	
	draw.SimpleText(string.format("angle to eye (%d,%d,%d)", angToEye.p, angToEye.y, angToEye.r), "DefaultFixedDropShadow", 0, 100, Color(200, 200, 200, 200), TEXT_ALIGN_CENTER, nil)
	
	draw.SimpleText(string.format("rendertime avg: %.2fms", (gState._devBenchAveraged or 0) * 1000), "DefaultFixedDropShadow", 0, 120, nil, TEXT_ALIGN_CENTER, nil)
	
	cam.End3D2D()
	cam.IgnoreZ(false)
	
	local ent = gState.entity
	if IsValid(ent) and ent._imguiRBExpansion then
		local ex, ey, ew, eh = unpack(ent._imguiRBExpansion)
		local minrb, maxrb = calculateRenderBounds(ex, ey, ew, eh)
		render.DrawWireframeBox(Vector(0, 0, 0), Angle(0, 0, 0), minrb, maxrb, Color(0, 0, 255))
	end
end

function imgui.End3D2D()
	if gState then
		if _devMode then
			local renderTook = SysTime() - gState._renderStarted
			gState._devBenchTests = (gState._devBenchTests or 0) + 1
			gState._devBenchTaken = (gState._devBenchTaken or 0) + renderTook
			if gState._devBenchTests == 100 then
				gState._devBenchAveraged = gState._devBenchTaken / 100
				gState._devBenchTests = 0
				gState._devBenchTaken = 0
			end
		end
		
		gState.rendering = false
		cam.End3D2D()
		render.SetBlend(1)
		surface.SetAlphaMultiplier(1)
		
		if _devMode then
			drawDeveloperInfo()
		end
	end
end

function imgui.CursorPos()
	local mx, my = gState.mx, gState.my
	return mx, my
end

function imgui.IsHovering(x, y, w, h)
	local mx, my = gState.mx, gState.my
	return mx and my and mx >= x and mx <= (x+w) and my >= y and my <= (y+h)
end
function imgui.IsPressing()
	return shouldAcceptInput() and gState.pressing
end
function imgui.IsPressed()
	return shouldAcceptInput() and gState.pressed
end

-- The cache that has String->Bool mappings telling if font has been created
local _createdFonts = {}

local EXCLAMATION_BYTE = string.byte("!")
function imgui.xFont(font, defaultSize)
	-- special font
	if string.byte(font, 1) == EXCLAMATION_BYTE then
		
		-- Font not cached; parse the font
		local name, size = font:match("!([^@]+)@(.+)")
		if size then size = tonumber(size) end
		
		if not size and defaultSize then
			name = font:match("^!([^@]+)$")
			size = defaultSize
		end
		
		local fontName = string.format("IMGUI_%s_%d", name, size)

		if not _createdFonts[fontName] then
			surface.CreateFont(fontName, {
				font = name,
				size = size
			})
			_createdFonts[fontName] = true
		end

		return fontName
	end
	return font
end

function imgui.xButton(x, y, w, h, borderWidth, borderClr, hoverClr, pressColor)
	local bw = borderWidth or 1
	
	local bgColor = imgui.IsHovering(x, y, w, h) and imgui.skin.backgroundHover or imgui.skin.background
	local borderColor = ((imgui.IsPressing() and imgui.IsHovering(x, y, w, h)) and (pressColor or imgui.skin.borderPress)) or 
	(imgui.IsHovering(x, y, w, h) and (hoverClr or imgui.skin.borderHover)) or (borderClr or imgui.skin.border)
	
	
	surface.SetDrawColor(bgColor)
	surface.DrawRect(x, y, w, h)
	
	if bw > 0 then
		surface.SetDrawColor(borderColor)

		surface.DrawRect(x, y, w, bw)
		surface.DrawRect(x, y+bw, bw, h-bw*2)
		surface.DrawRect(x, y+h-bw, w, bw)
		surface.DrawRect(x+w-bw+1, y, bw, h)
	end
	
	return shouldAcceptInput() and imgui.IsHovering(x, y, w, h) and gState.pressed
end

function imgui.xCursor(x, y, w, h)
	local fgColor = imgui.IsPressing() and imgui.skin.foregroundPress or imgui.skin.foreground
	local mx, my = gState.mx, gState.my
	
	if not mx or not my then return end
	
	if x and w and (mx < x or mx > x + w) then return end
	if y and h and (my < y or my > y + h) then return end
	
	local cursorSize = math.ceil(0.3 / gState.scale)
	surface.SetDrawColor(fgColor)
	surface.DrawLine(mx - cursorSize, my, mx + cursorSize, my)
	surface.DrawLine(mx, my - cursorSize, mx, my + cursorSize)
end

function imgui.xTextButton(text, font, x, y, w, h, borderWidth, color, hoverClr, pressColor)
	local fgColor = ((imgui.IsPressing() and imgui.IsHovering(x, y, w, h)) and (pressColor or imgui.skin.foregroundPress)) or 
	(imgui.IsHovering(x, y, w, h) and (hoverClr or imgui.skin.foregroundHover)) or (color or imgui.skin.foreground)
	
	local clicked = imgui.xButton(x, y, w, h, borderWidth, color, hoverClr, pressColor)
	
	font = imgui.xFont(font, math.floor(h * 0.618))
	draw.SimpleText(text, font, x+w/2, y+h/2, fgColor, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)
	
	return clicked
end

return imgui

--addons/sreward_1.5.30/lua/s_reward/rewards/sh_glorifiedleveling.lua:
return gluapack()()
--lua/autorun/ss_jennifer_pm.lua:
return gluapack()()
--lua/autorun/ss_jennifer_pm.lua:
// Yui Spec Ops (PBR) - Maygik
player_manager.AddValidModel( "SS Jennifer", "models/player/ss_jennifer.mdl" )
--lua/streamradio_core/_load.lua:
return gluapack()()
--lua/streamradio_core/string.lua:
local StreamRadioLib = StreamRadioLib

StreamRadioLib.String = StreamRadioLib.String or {}
local LIB = StreamRadioLib.String

local table = table
local table_insert = table.insert

function LIB.NormalizeNewlines(text, nl)
	nl = tostring(nl or "")
	text = tostring(text or "")

	local replacemap = {
		["\r\n"] = true,
		["\r"] = true,
		["\n"] = true,
	}

	if not replacemap[nl] then
		nl = "\n"
	end

	replacemap[nl] = nil

	for k, v in pairs(replacemap) do
		replacemap[k] = nl
	end

	text = string.gsub(text, "([\r]?[\n]?)", replacemap)

	return text
end

function LIB.IndentTextBlock(text, count, tab)
	text = tostring(text or "")
	tab = tostring(tab or "")
	count = count or 0

	if text == "" then
		return ""
	end

	if tab == "" then
		tab = "    "
	end

	if count <= 0 then
		tab = ""
	else
		tab = string.rep(tab, count)
	end

	local lines = string.Explode("\n", text, false)
	local tmp = {}

	for i, v in ipairs(lines) do
		table_insert(tmp, tab)
		table_insert(tmp, v)
		table_insert(tmp, "\n")
	end

	text = table.concat(tmp)

	return text
end

function LIB.IsVirtualPath(vpath)
	vpath = vpath or ""

	if vpath == "" then
		return false
	end

	if not string.match(vpath, "^%:") then
		return false
	end

	return true
end

local g_sanitized_filenames_cache = {}
local g_sanitized_filepaths_cache = {}

function LIB.SanitizeFilename(filenameInput)
	filenameInput = tostring(filenameInput or "")

	if filenameInput == "" then
		return ""
	end

	if g_sanitized_filenames_cache[filenameInput] then
		return g_sanitized_filenames_cache[filenameInput]
	end

	g_sanitized_filenames_cache[filenameInput] = nil

	local filename = LIB.NormalizeSlashes(filenameInput)

	filename = string.gsub(filename, "%:", '-')
	filename = string.gsub(filename, "%/", '-')

	filename = LIB.SanitizeFilepath(filename)

	g_sanitized_filenames_cache[filenameInput] = filename
	g_sanitized_filenames_cache[filename] = filename

	return filename
end

local g_invalidReplaceMap = {
	["*"] = "-",
	[":"] = "-",
	["?"] = "-",
	[">"] = "-",
	["<"] = "-",
	["|"] = "-",
	["´"] = "-",
	["`"] = "-",
	["~"] = "-",
	["'"] = "-",
	['"'] = "-",
	['#'] = "-",
}

function LIB.SanitizeFilepath(filepathInput)
	filepathInput = tostring(filepathInput or "")

	if filepathInput == "" then
		return ""
	end

	if g_sanitized_filepaths_cache[filepathInput] then
		return g_sanitized_filepaths_cache[filepathInput]
	end

	g_sanitized_filepaths_cache[filepathInput] = nil

	local filepath = LIB.NormalizeSlashes(filepathInput)

	if LIB.IsVirtualPath(filepath) then
		g_sanitized_filepaths_cache[filepathInput] = filepath
		g_sanitized_filepaths_cache[filepath] = filepath

		return filepath
	end

	filepath = string.Trim(filepath)

	filepath = LIB.StripAccents(filepath, true)

	filepath = string.gsub(filepath, ".", g_invalidReplaceMap)

	filepath = string.gsub(filepath, "[^%g%s]", '')
	filepath = string.Trim(filepath)

	filepath = string.gsub(filepath, "%s+", '_')
	filepath = string.lower(filepath)

	g_sanitized_filepaths_cache[filepathInput] = filepath
	g_sanitized_filepaths_cache[filepath] = filepath

	return filepath
end

function LIB.NormalizeSlashes(filepath)
	filepath = tostring(filepath or "")

	if filepath == "" then
		return ""
	end

	filepath = string.gsub(filepath, "[%/%\\]+", '/')
	filepath = string.gsub(filepath, "%.%.%/", '/')
	filepath = string.gsub(filepath, "%.%/", '/')
	filepath = string.gsub(filepath, "%/+", '/')

	return filepath
end

function LIB.IsValidFilepath(filepath)
	filepath = tostring(filepath or "")
	filepath = LIB.NormalizeSlashes(filepath)
	filepath = string.lower(filepath)
	filepath = string.Trim(filepath)

	local sanitizeFilepath = LIB.SanitizeFilepath(filepath)
	if sanitizeFilepath ~= filepath then
		return false
	end

	return true
end

function LIB.IsValidFilename(filename)
	filename = tostring(filename or "")
	filename = string.lower(filename)
	filename = string.Trim(filename)

	local sanitizeFilename = LIB.SanitizeFilename(filename)
	if sanitizeFilename ~= filename then
		return false
	end

	if string.Trim(string.StripExtension(" " .. filename) or "") == "" then
		return false
	end

	return true
end

function LIB.StreamMetaStringToTable(meta)
	meta = tostring(meta or "")
	meta = string.Trim(meta or "")

	local result = {}

	for k, v in string.gmatch(meta, "([%w_]+)%s*=%s*([^;]*)[;]?") do
		k = string.lower(k)
		if k == "" then
			continue
		end

		v = string.gsub(v, "^'(.*)'$", "%1")
		v = string.Trim(v or "")

		result[k] = v
	end

	return result
end

return true


--lua/streamradio_core/bass3.lua:
return gluapack()()
--lua/streamradio_core/enum.lua:
return gluapack()()
--lua/streamradio_core/tool.lua:
local StreamRadioLib = StreamRadioLib

StreamRadioLib.Tool = StreamRadioLib.Tool or {}

local LIB = StreamRadioLib.Tool
table.Empty(LIB)

local LIBNetwork = StreamRadioLib.Network
local LIBNet = StreamRadioLib.Net

function LIB.GetTool(ply, toolmode)
	if not IsValid(ply) then
		if SERVER then
			return nil
		end

		ply = LocalPlayer()
	end

	if not IsValid(ply) then
		return nil
	end

	local toolobj = ply:GetTool(toolmode)
	if not toolobj then
		return nil
	end

	if toolobj.Mode ~= toolmode then
		return nil
	end

	return toolobj
end

local g_locale_specialcases = {
	["Undone_"] = true,
	["SBoxLimit_"] = true,
	["Cleanup_"] = true,
	["Cleaned_"] = true,
}

function LIB.AddLocale(toolobj, name, translation)
	if SERVER then return end
	assert(toolobj, "ToolOBJ needed #1")

	name = tostring(name or "")
	assert(name ~= "", "name needed #2")

	translation = tostring(translation or "")
	assert(translation ~= "", "translation needed #3")

	local toolmode = toolobj.Mode

	if g_locale_specialcases[name] then
		language.Add(name .. toolmode, translation)
		return
	end

	language.Add("Tool." .. toolmode .. "." .. name, translation)
end

function LIB.GetLocale(toolobj, name)
	if SERVER then return end
	assert(toolobj, "ToolOBJ needed #1")

	name = tostring(name or "")
	assert(name ~= "", "name needed #2")

	local toolmode = toolobj.Mode
	return "#Tool." .. toolmode .. "." .. name
end

function LIB.GetLocaleTranslation(toolobj, name)
	if SERVER then return end
	assert(toolobj, "ToolOBJ needed #1")

	name = tostring(name or "")
	assert(name ~= "", "name needed #2")

	local toolmode = toolobj.Mode
	return language.GetPhrase("#Tool." .. toolmode .. "." .. name)
end

function LIB.AdvWeld( ent, traceEntity, tracePhysicsBone, DOR, collision, AllowWorldWeld, freeze )
	if not SERVER then return end
	if not IsValid(ent) then return end

	if IsValid(traceEntity) then
		if traceEntity:IsNPC() then return end
		if traceEntity:IsPlayer() then return end
	end

	local IsEnt = IsValid(traceEntity) and not traceEntity:IsWorld()
	local phys = ent:GetPhysicsObject()

	if AllowWorldWeld or IsEnt then
		local const = constraint.Weld(ent, traceEntity, 0, tracePhysicsBone, 0, not collision, DOR)

		-- Don't disable collision if it is not attached to anything
		if (not collision and IsValid(const)) then
			if IsValid( phys ) then
				phys:EnableCollisions(collision)
			end

			ent.nocollide = not collision
		end

		if IsValid(phys) then
			phys:EnableMotion(not (freeze or AllowWorldWeld and not IsEnt))
		end

		return const
	else
		if IsValid(phys) then
			phys:EnableMotion(not (freeze or AllowWorldWeld))
		end

		return nil
	end
end

LIB.g_reloadpanels = LIB.g_reloadpanels or {}
local g_reloadpanels = LIB.g_reloadpanels

function LIB.Setup(toolobj)
	local _toolmode = toolobj.Mode

	toolobj.ToolLibLoaded = true

	function toolobj:IsValidTrace(trace)
		if not trace then return false end
		if not trace.Hit then return false end
		if not trace.HitPos then return false end

		local ent = trace.Entity
		if IsValid(ent) then
			if ent:IsPlayer() then return false end

			if SERVER then
				if not util.IsValidPhysicsObject(ent, trace.PhysicsBone) then return false end
			end
		end

		return true
	end

	function toolobj:IsValidRadio(ent)
		if not IsValid(ent) then return false end
		if not ent.__IsRadio then return false end

		local ply = self:GetOwner()
		if not IsValid(ply) then return true end

		local radioOwner = ent:GetRealRadioOwner()

		if not IsValid(radioOwner) then return true end
		if radioOwner ~= ply then return false end

		return true
	end

	function toolobj:IsValidGUIRadio(ent)
		if not self:IsValidRadio(ent) then return false end
		if not ent.HasGUI then return false end
		if not ent:HasGUI() then return false end

		return true
	end

	function toolobj:GetFallbackTrace()
		local ply = self:GetOwner()
		local trace = util.GetPlayerTrace(ply)
		trace.mask = bit.bor( CONTENTS_SOLID, CONTENTS_MOVEABLE, CONTENTS_MONSTER, CONTENTS_WINDOW, CONTENTS_DEBRIS, CONTENTS_GRATE, CONTENTS_AUX )

		local result = util.TraceLine(trace)
		if not self:IsValidTrace(result) then return nil end

		return result
	end

	function toolobj:SetClientInfo( name, var )
		local ply = self:GetOwner()

		if not IsValid(ply) then
			if CLIENT then
				ply = LocalPlayer()
			end
		end

		if not IsValid(ply) then
			return
		end

		var = tostring(var)
		var = string.Replace(var, "\"", "")

		ply:ConCommand(self.Mode .. "_" .. name .. " \"" .. var .. "\"")
	end

	function toolobj:SetClientNumber(name, var)
		self:SetClientInfo(name, tonumber(var) or 0)
	end

	function toolobj:SetClientBool(name, var)
		self:SetClientNumber(name, tobool(var) and 1 or 0)
	end

	function toolobj:GetClientNumberMinMax(name, min, max)
		local var = self:GetClientNumber(name)
		var = math.Clamp(var, min, max)

		return var
	end

	function toolobj:GetClientBool(name)
		local var = self:GetClientNumber(name)
		return tobool(var)
	end

	if SERVER then return end

	function toolobj:AddLabel( panel, name, descbool )
		local label = vgui.Create("DLabel")
		panel:AddPanel( label )

		label:SetDark(true)
		label:SetWrap(true)
		label:SetText(StreamRadioLib.Tool.GetLocale(self, name))

		label:SetAutoStretchVertical(true)
		label:SizeToContents()

		if descbool then
			label:SetTooltip(StreamRadioLib.Tool.GetLocale(self, name .. ".desc"))
		end

		return label
	end

	function toolobj:AddReadOnlyTextBox( panel, name )
		local boxPanel = vgui.Create("DForm")

		boxPanel:SetName(StreamRadioLib.Tool.GetLocale(self, name))

		panel:AddPanel(boxPanel)
		boxPanel:SetCookieName(name)

		local label = vgui.Create( "Streamradio_VGUI_ReadOnlyTextEntry" )
		boxPanel:AddItem( label )

		local desc = StreamRadioLib.Tool.GetLocale(self, name .. ".desc")
		label:SetText(desc)

		label:DockMargin(0, 0, 0, 0)
		label:DockPadding(0, 0, 0, 0)

		return boxPanel, label
	end

	function toolobj:AddWhitelistEnabledLabel( panel, name, descbool )
		local label = StreamRadioLib.Menu.GetWhitelistEnabledLabel(StreamRadioLib.Tool.GetLocale(self, name))
		panel:AddPanel( label )

		if descbool then
			label:SetTooltip(StreamRadioLib.Tool.GetLocale(self, name .. ".desc"))
		end

		return label
	end

	function toolobj:AddImportantLabel( panel, name, descbool )
		local label = StreamRadioLib.Menu.GetImportantLabel(StreamRadioLib.Tool.GetLocale(self, name))
		panel:AddPanel( label )

		if descbool then
			label:SetTooltip(StreamRadioLib.Tool.GetLocale(self, name .. ".desc"))
		end

		return label
	end

	function toolobj:AddButton( panel, name, descbool )
		local button = vgui.Create( "DButton" )
		panel:AddPanel( button )
		button:SetText(StreamRadioLib.Tool.GetLocale(self, name))
		button:SetDark( true )
		button:SizeToContents( )

		if descbool then
			button:SetTooltip(StreamRadioLib.Tool.GetLocale(self, name .. ".desc"))
		end

		return button
	end

	function toolobj:AddColorMixer( panel )
		local ColorMixer = vgui.Create( "DColorMixer" )
		panel:AddPanel( ColorMixer )

		ColorMixer:SetPalette( true )
		ColorMixer:SetAlphaBar( true )
		ColorMixer:SetPaintBackground( true )

		return ColorMixer
	end


	function toolobj:AddNumSlider( panel, command, descbool )
		local numslider = vgui.Create( "DNumSlider" )
		panel:AddPanel( numslider )

		numslider:SetText(StreamRadioLib.Tool.GetLocale(self, command), self.Mode .. "_" .. command)
		numslider:SetDark(true)
		numslider:SetConVar(self.Mode .. "_" .. command)

		if descbool then
			numslider:SetTooltip(StreamRadioLib.Tool.GetLocale(self, command .. ".desc"))
		end

		return numslider
	end

	function toolobj:AddCheckbox( panel, command, descbool )
		local checkbox = panel:CheckBox(StreamRadioLib.Tool.GetLocale(self, command), self.Mode .. "_" .. command)

		if descbool then
			checkbox:SetTooltip(StreamRadioLib.Tool.GetLocale(self, command .. ".desc"))
		end

		return checkbox
	end

	function toolobj:AddComboBox( panel, command, descbool )
		local combobox, label = panel:ComboBox(StreamRadioLib.Tool.GetLocale(self, command), self.Mode .. "_" .. command)

		StreamRadioLib.Menu.PatchComboBox(combobox, label)

		if descbool then
			combobox:SetTooltip(StreamRadioLib.Tool.GetLocale(self, command .. ".desc"))
		end

		return combobox
	end

	function toolobj:AddTextEntry( panel, command, descbool )
		local textentry = panel:TextEntry(StreamRadioLib.Tool.GetLocale(self, command), self.Mode .. "_" .. command)

		if descbool then
			textentry:SetTooltip(StreamRadioLib.Tool.GetLocale(self, command .. ".desc"))
		end

		return textentry
	end

	function toolobj:AddURLTextEntry( panel, command, descbool )
		local bgpanel = vgui.Create( "DPanel" )
		bgpanel:SetPaintBackground( false )

		if descbool then
			bgpanel:SetTooltip(StreamRadioLib.Tool.GetLocale(self, command .. ".desc"))
		end

		panel:AddPanel( bgpanel )

		local label = vgui.Create( "DLabel", bgpanel )
		label:SetText(StreamRadioLib.Tool.GetLocale(self, command))
		label:SetDark( true )
		label:SizeToContents( )
		label:Dock( TOP )

		local URLTextEntry = vgui.Create( "Streamradio_VGUI_URLTextEntry", bgpanel )
		URLTextEntry:SetConVar( self.Mode .. "_" .. command )
		URLTextEntry:Dock( FILL )
		URLTextEntry:DockMargin(0, 5, 0, 0)

		bgpanel:SetTall(78)

		return URLTextEntry
	end

	function toolobj:BuildToolPanel(CPanel)
		-- override this
	end

	function toolobj.BuildCPanel(CPanel)
		g_reloadpanels[_toolmode] = CPanel

		local toplabel = vgui.Create("DLabel")
		toplabel:SetText("#Tool." .. _toolmode .. ".desc")
		toplabel:SetDark(true)
		toplabel:SizeToContents()
		CPanel:AddPanel(toplabel)

		local StreamRadioLib = StreamRadioLib or {}

		if not StreamRadioLib.Loaded then
			if StreamRadioLib.Loader_CreateErrorPanel then
				StreamRadioLib.Loader_CreateErrorPanel(CPanel, "This tool could not be loaded.")
			end

			return
		end

		StreamRadioLib.Timer.Until("ToolReload_" .. _toolmode, 0.1, function()
			local ply = LocalPlayer()
			local this = LIB.GetTool(ply, _toolmode)
			if not this then return end

			local CPanel = g_reloadpanels[_toolmode]
			if not IsValid(CPanel) then return end

			if not this.BuildToolPanel then return end

			this.ToolPanel = CPanel

			local toolpresets = this.Presets or {}
			local Options = toolpresets.Options or StreamRadioLib.GetPresetsTable(_toolmode) or {}
			local CVars = toolpresets.CVars or {}

			if #CVars <= 0 then
				for k, v in pairs(this.ClientConVar or {}) do
					table.insert(CVars, this.Mode .. "_" .. k)
				end
			end

			if not Options.Default then
				Options.Default = {}

				for k, v in pairs(this.ClientConVar or {}) do
					Options.Default[this.Mode .. "_" .. k] = tostring(v)
				end
			end

			if #CVars > 0 then
				CPanel:AddControl("ComboBox", {
					Label = "#Presets",
					MenuButton = "1",
					Folder = this.Mode,
					Options = Options,
					CVars = CVars,
				})
			end

			this:BuildToolPanel(CPanel)

			CPanel:AddPanel(StreamRadioLib.Menu.GetSpacer(5))
			CPanel:AddPanel(StreamRadioLib.Menu.GetFAQButton())
			CPanel:AddPanel(StreamRadioLib.Menu.GetCreditsPanel())

			return true
		end)
	end

	function toolobj:GetPanel()
		return self.ToolPanel
	end

	function toolobj:ReloadPanel()
		local reloadpanel = g_reloadpanels[_toolmode]

		if not IsValid(reloadpanel) then
			reloadpanel = self:GetPanel()
		end

		if not IsValid(reloadpanel) then
			return
		end

		reloadpanel:Clear()
		self.BuildCPanel(reloadpanel)
	end

	toolobj:ReloadPanel()
end

local callback = nil

function LIB.RegisterClientToolHook(tool, toolhook)
	if SERVER then
		LIBNetwork.AddNetworkString("ClientToolHook")
		return
	end

	if callback then return end

	callback = function()
		local ply = LocalPlayer()

		local nwtoolname = net.ReadString()
		local bwhook = net.ReadString()

		local toolobj = LIB.GetTool(ply, nwtoolname)
		if not toolobj then return end

		local func = toolobj[bwhook .. "Client"]
		if not func then return end

		func(toolobj)
	end

	LIBNet.Receive("ClientToolHook", callback)
end

function LIB.CallClientToolHook(tool, toolhook)
	if CLIENT then return end

	local owner = tool:GetOwner()
	local toolname = tool.Mode

	LIBNet.Start("ClientToolHook")
		net.WriteString(toolname)
		net.WriteString(toolhook)
	net.Send(owner)
end

return true


--lua/streamradio_core/models/hl2_crtscreen_small.lua:
local RADIOMDL = RADIOMDL
if not istable( RADIOMDL ) then
	StreamRadioLib.Model.LoadModelSettings()
	return
end

-- HL2 Small CRT Screen
RADIOMDL.model = "models/props_lab/monitor01b.mdl"

RADIOMDL.SpawnAng = Angle(0, 0, 0)
RADIOMDL.SpawnFlatOnWall = true
RADIOMDL.SoundPosOffset = Vector(0.25, 0, 4.5)
RADIOMDL.SoundAngOffset = Angle(0, 0, 0)

RADIOMDL.DisplayAngles = Angle(0, 90, 89.65)

                              --      F,     R,     U
RADIOMDL.DisplayOffset    = Vector(6.30, -5.45,  4.95) -- Top Left
RADIOMDL.DisplayOffsetEnd = Vector(6.30,  3.40, -4.10) -- Bottom Right

RADIOMDL.DisplayWidth = 700
RADIOMDL.DisplayHeight, RADIOMDL.DisplayScale = RADIOMDL:GetDisplayHeight(RADIOMDL.DisplayOffset, RADIOMDL.DisplayOffsetEnd, RADIOMDL.DisplayWidth)

RADIOMDL.FontSizes = {
--  Name 	= Size,	Weight, Parentname
	Header	= {25,	1000},
	Small	= {18,	700},
	Default	= {23,	700},
	Tooltip	= {23,	800},
	Big		= {25,	700},
}

function RADIOMDL:SetupGUI(ent, gui_controller, mainpanel)
	gui_controller:SetPos(0, 0)
	gui_controller:SetSize(self.DisplayWidth, self.DisplayHeight)

	mainpanel:SetSize(gui_controller:GetClientSize())

	local modelsetup = {}
	if CLIENT then
		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/header/text", "font", self.Fonts.Header)
		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/header/pretext", "font", self.Fonts.Header)
		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlists/button", "font", self.Fonts.Default)
		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlistview/button", "font", self.Fonts.Default)

		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/player/header", "font", self.Fonts.Header)
		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/player/controls/progressbar/label", "font", self.Fonts.Small)
		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/player/button", "font", self.Fonts.Big)

		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/player/spectrum/volume/progressbar/label", "font", self.Fonts.Default)
		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/player/spectrum/error/textbox", "font", self.Fonts.Big)
		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/player/spectrum/error/button", "font", self.Fonts.Big)

		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/error/textbox", "font", self.Fonts.Big)
		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/error/button", "font", self.Fonts.Big)

		StreamRadioLib.SetSkinTableProperty(modelsetup, "tooltip", "font", self.Fonts.Tooltip)
	end

	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/header", "sizeh", 50)
	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/player/header", "sizeh", 50)

	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlists", "gridsize", {x = 1, y = 7})
	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlistview", "gridsize", {x = 1, y = 7})
	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlists/scrollbar", "sizew", 30)
	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlistview/scrollbar", "sizew", 30)
	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/sidebutton", "sizew", 50)

	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/player/spectrum/error/textbox/scrollbar", "sizew", 30)
	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/error/textbox/scrollbar", "sizew", 30)

	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/player/button", "sizeh", 45)
	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/player/spectrum/error/button", "sizew", 45)
	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/error/button", "sizew", 45)

	StreamRadioLib.SetSkinTableProperty(modelsetup, "", "cornersize", 0)
	StreamRadioLib.SetSkinTableProperty(modelsetup, "", "borderwidth", 16)

	local shadow = 5
	local padding = 5
	local margin = 5

	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlists/button", "shadowwidth", shadow)
	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlistview/button", "shadowwidth", shadow)

	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlists/button", "padding", padding)
	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlistview/button", "padding", padding)

	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlists/button", "margin", margin)
	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlistview/button", "margin", margin)

	gui_controller:SetModelSetup(modelsetup)

	mainpanel:ForEachChildRecursive(function(panel, child)
		if child.SetShadowWidth and child:GetShadowWidth() == 5 then
			child:SetShadowWidth(shadow)
		end

		if child.SetPadding and child:GetPadding() == 5 then
			child:SetPadding(padding)
		end

		if child.SetMargin and child:GetMargin() == 5 then
			child:SetMargin(margin)
		end
	end)
end

return true


--lua/streamradio_core/models/kankan_radio.lua:
return gluapack()()
--lua/streamradio_core/models/portal_ball.lua:
return gluapack()()
--lua/streamradio_core/models/wire_monitor_big.lua:
local RADIOMDL = RADIOMDL
if not istable( RADIOMDL ) then
	StreamRadioLib.Model.LoadModelSettings()
	return
end

-- Wire Monitor, Big
-- Addon: https://steamcommunity.com/sharedfiles/filedetails/?id=160250458
RADIOMDL.model = "models/kobilica/wiremonitorbig.mdl"

RADIOMDL.SpawnAng = Angle(0, 0, 0)
RADIOMDL.SpawnFlatOnWall = true
RADIOMDL.SoundPosOffset = Vector(0.25, 0, 11.75)
RADIOMDL.SoundAngOffset = Angle(0, 0, 0)

RADIOMDL.DisplayAngles = Angle(0, 90, 90)

                              --      F,      R,      U
RADIOMDL.DisplayOffset    = Vector(0.25, -11.25,  24.25) -- Top Left
RADIOMDL.DisplayOffsetEnd = Vector(0.25,  11.25,   1.75) -- Bottom Right

RADIOMDL.DisplayWidth = 1400
RADIOMDL.DisplayHeight, RADIOMDL.DisplayScale = RADIOMDL:GetDisplayHeight(RADIOMDL.DisplayOffset, RADIOMDL.DisplayOffsetEnd, RADIOMDL.DisplayWidth)

RADIOMDL.FontSizes = {
--  Name 	= Size,	Weight, Parentname
	Header	= {45,	1000},
	Small	= {36,	700},
	Default	= {42,	700},
	Tooltip	= {42,	800},
	Big		= {50,	700},
}

function RADIOMDL:SetupGUI(ent, gui_controller, mainpanel)
	gui_controller:SetPos(0, 0)
	gui_controller:SetSize(self.DisplayWidth, self.DisplayHeight)

	mainpanel:SetSize(gui_controller:GetClientSize())

	local modelsetup = {}
	if CLIENT then
		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/header/text", "font", self.Fonts.Header)
		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/header/pretext", "font", self.Fonts.Header)
		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlists/button", "font", self.Fonts.Default)
		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlistview/button", "font", self.Fonts.Default)

		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/player/header", "font", self.Fonts.Header)
		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/player/controls/progressbar/label", "font", self.Fonts.Small)
		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/player/button", "font", self.Fonts.Big)

		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/player/spectrum/volume/progressbar/label", "font", self.Fonts.Default)
		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/player/spectrum/error/textbox", "font", self.Fonts.Big)
		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/player/spectrum/error/button", "font", self.Fonts.Big)

		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/error/textbox", "font", self.Fonts.Big)
		StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/error/button", "font", self.Fonts.Big)

		StreamRadioLib.SetSkinTableProperty(modelsetup, "tooltip", "font", self.Fonts.Tooltip)
	end

	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/header", "sizeh", 80)
	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/player/header", "sizeh", 80)

	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlists", "gridsize", {x = 2, y = 10})
	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlistview", "gridsize", {x = 1, y = 10})
	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlists/scrollbar", "sizew", 60)
	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlistview/scrollbar", "sizew", 60)
	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/sidebutton", "sizew", 100)

	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/player/spectrum/error/textbox/scrollbar", "sizew", 60)
	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/error/textbox/scrollbar", "sizew", 60)

	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/player/button", "sizeh", 90)
	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/player/spectrum/error/button", "sizew", 80)
	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/error/button", "sizew", 80)

	StreamRadioLib.SetSkinTableProperty(modelsetup, "", "cornersize", 0)
	StreamRadioLib.SetSkinTableProperty(modelsetup, "", "borderwidth", 16)

	local shadow = 10
	local padding = 10
	local margin = 10

	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlists/button", "shadowwidth", shadow)
	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlistview/button", "shadowwidth", shadow)

	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlists/button", "padding", padding)
	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlistview/button", "padding", padding)

	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlists/button", "margin", margin)
	StreamRadioLib.SetSkinTableProperty(modelsetup, "main/browser/list-playlistview/button", "margin", margin)

	gui_controller:SetModelSetup(modelsetup)

	mainpanel:ForEachChildRecursive(function(panel, child)
		if child.SetShadowWidth and child:GetShadowWidth() == 5 then
			child:SetShadowWidth(shadow)
		end

		if child.SetPadding and child:GetPadding() == 5 then
			child:SetPadding(padding)
		end

		if child.SetMargin and child:GetMargin() == 5 then
			child:SetMargin(margin)
		end
	end)
end

return true


--lua/streamradio_core/models/wire_speaker3.lua:
local RADIOMDL = RADIOMDL
if not istable( RADIOMDL ) then
	StreamRadioLib.Model.LoadModelSettings()
	return
end

-- Wire Speaker 3
-- Addon: https://steamcommunity.com/sharedfiles/filedetails/?id=160250458
RADIOMDL.model = "models/killa-x/speakers/speaker_small.mdl"

RADIOMDL.NoDisplay = true
RADIOMDL.SpawnAng = Angle( 0, 0, 0 )
RADIOMDL.SpawnFlatOnWall = false

return true


--lua/streamradio_core/interface.lua:
return gluapack()()
--lua/streamradio_core/classes/ui/debug.lua:
return gluapack()()
--lua/streamradio_core/classes/ui/round_panel.lua:
local StreamRadioLib = StreamRadioLib

if not istable(CLASS) then
	StreamRadioLib.ReloadClasses()
	return
end

local BASE = CLASS:GetBaseClass()

function CLASS:Create()
	BASE.Create(self)

	self.Layout.CornerSize = 16
	self.Layout.Padding = 5

	self.SkinAble = true
end

function CLASS:Render()
	local x, y = self:GetRenderPos()
	local w, h = self:GetSize()

	draw.RoundedBox( self.Layout.CornerSize, x, y, w, h, self.Colors.Main )

	BASE.Render(self)
end

function CLASS:GetCornerSize()
	return self.Layout.CornerSize or 0
end

function CLASS:SetCornerSize(size)
	self.Layout.CornerSize = size or 0
end

function CLASS:OnModelSetup(setup)
	BASE.OnModelSetup(self, setup)

	if setup.cornersize then
		self:SetCornerSize(setup.cornersize)
	end
end

return true


--lua/streamradio_core/classes/ui/label.lua:
local StreamRadioLib = StreamRadioLib

if not istable(CLASS) then
	StreamRadioLib.ReloadClasses()
	return
end

local BASE = CLASS:GetBaseClass()
local changehooks = {
	Text = "OnTextChange",
	Font = "OnFontChange",
	AlignX = "OnAlignChange",
	AlignY = "OnAlignChange",
}

local function normalize_text(text)
	text = tostring(text or "")
	text = string.gsub(text, "[\r\n]", "" )
	text = string.gsub(text, "\t", "    " )

	return text
end

function CLASS:Create()
	BASE.Create(self)

	self.Clickable = false

	self.TextData = self:CreateListener({
		Text = "",
		Font = "DermaDefault",

		AlignX = TEXT_ALIGN_LEFT,
		AlignY = TEXT_ALIGN_TOP,

		Shorter = "...",
		ShorterEnd = true,
	}, function(this, k, v)
		self:InvalidateLayout()

		if CLIENT then
			self:QueueCall("UpdateText")
		end

		local hookname = changehooks[k]
		if not hookname then return end

		self:CallHook(hookname)
	end)

	if CLIENT then
		self.InternalText = ""
		self.Size = self.Size + function(this, k, v)
			if k ~= "w" then return end
			self:QueueCall("UpdateText")
		end

		self.Colors.Main = Color(0,0,0)
	end

	self:SetSkinAble(false)
end

function CLASS:UpdateText()
	if SERVER then return end

	self.InternalText = self:TextFit(self.TextData.Text, self:GetWidth())
	self:PerformRerender(true)
end

function CLASS:ShortText(text, len)
	if len <= 0 then
		return ""
	end

	local shorter = self.TextData.Shorter

	if self.TextData.ShorterEnd then
		return string.sub(text, 0, len) .. shorter
	end

	return shorter .. string.sub(text, -len)
end

function CLASS:GuessLen(text, width, func)
	local len2power = 2 ^ math.ceil(math.log(#text) / math.log(2))
	local len = len2power

	local repeattimes = 4

	while true do
		local bigger = func(self, text, len, width)
		local repeated = false

		if len2power <= 1 then
			if repeattimes <= 0 then
				break
			end

			repeattimes = repeattimes - 1
			repeated = true
		end

		if bigger > 0 then
			if repeated and repeattimes <= 1 then
				break
			end

			len2power = math.ceil(len2power / 2)
			len = len + len2power
			continue
		end

		if bigger < 0 then
			len2power = math.ceil(len2power / 2)
			len = len - len2power
			continue
		end

		break
	end

	return len
end

function CLASS:TryTextFit(text, len, width)
	local newstring = self:ShortText(text, len)

	if newstring == "" then
		return 1
	end

	surface.SetFont( self.TextData.Font )
	local w = surface.GetTextSize( newstring ) or 0
	local bigger = width - w

	return bigger
end

function CLASS:TextFit(text, width)
	if SERVER then return "" end

	if text == "" then
		return ""
	end

	if width <= 0 then
		return ""
	end

	surface.SetFont( self.TextData.Font )
	local w = surface.GetTextSize( text ) or 0
	if w <= 0 then
		return ""
	end

	if (w <= width) then
		return text
	end

	local len = self:GuessLen(text, width, self.TryTextFit)
	local newstring = self:ShortText(text, len)

	return newstring
end

function CLASS:DrawText( text, x, y, w, h )
	text = text or ""
	if text == "" then
		return
	end

	local tx, ty = x, y
	local xalign, yalign = self.TextData.AlignX, self.TextData.AlignY
	local tsw, tsh = surface.GetTextSize( text )

	if ( xalign == TEXT_ALIGN_CENTER ) then
		tx = x + w / 2 - tsw / 2
	elseif ( xalign == TEXT_ALIGN_RIGHT ) then
		tx = x + w - tsw
	end

	if ( yalign == TEXT_ALIGN_CENTER ) then
		ty = y + h / 2 - tsh / 2
	elseif ( yalign == TEXT_ALIGN_BOTTOM ) then
		ty = y + h - tsh
	end

	surface.SetTextPos( math.ceil( tx ), math.ceil( ty ) )
	surface.DrawText( text )
end

function CLASS:Render()
	BASE.Render(self)

	local x, y = self:GetRenderPos()
	local w, h = self:GetSize()

	local col = self.Colors.Main or color_black
	local font = self.TextData.Font

	surface.SetFont( font )
	surface.SetTextColor( col:Unpack() )

	self:DrawText(self.InternalText, x, y, w, h)
end

function CLASS:SetTextColor(...)
	return self:SetColor(...)
end

function CLASS:GetTextColor(...)
	return self:GetColor(...)
end

function CLASS:SetText(text)
	self.TextData.Text = normalize_text(text)
end

function CLASS:GetText()
	return self.TextData.Text or ""
end

function CLASS:GetTextSize()
	if SERVER then return 0, 0 end

	surface.SetFont(self.TextData.Font)
	local w, h = surface.GetTextSize(self.TextData.Text)
	return w or 0, h or 0
end

function CLASS:SetFont(font)
	if SERVER then return end
	self.TextData.Font = font or ""
end

function CLASS:GetFont()
	if SERVER then return end
	return self.TextData.Font or ""
end

function CLASS:SetAlign(alignX, alignY)
	if SERVER then return end
	self.TextData.AlignX = alignX or TEXT_ALIGN_LEFT
	self.TextData.AlignY = alignY or TEXT_ALIGN_TOP
end

function CLASS:GetAlign()
	if SERVER then return end
	return self.TextData.AlignX or TEXT_ALIGN_LEFT, self.TextData.AlignY or TEXT_ALIGN_TOP
end

function CLASS:SetShorter(text)
	if SERVER then return end
	self.TextData.Shorter = normalize_text(text)
end

function CLASS:GetShorter()
	if SERVER then return end
	return self.TextData.Shorter or ""
end

function CLASS:SetShorterAtEnd(bool)
	if SERVER then return end
	self.TextData.ShorterEnd = bool or false
end

function CLASS:GetShorterAtEnd()
	if SERVER then return end
	return self.TextData.ShorterEnd or false
end

function CLASS:AutoWidth(maxwidth)
	if SERVER then return end
	maxwidth = maxwidth or 0

	local textw = self:GetTextSize()
	textw = math.Clamp(textw, 0, maxwidth)

	self:SetWidth(textw)
end

function CLASS:AutoHeight(maxheight)
	if SERVER then return end
	maxheight = maxheight or 0

	local _, texth = self:GetTextSize()
	texth = math.Clamp(texth, 0, maxheight)

	self:SetHeight(texth)
end

function CLASS:AutoSize(maxwidth, maxheight)
	if SERVER then return end
	maxwidth = maxwidth or 0
	maxheight = maxheight or 0

	local textw, texth = self:GetTextSize()
	textw = math.Clamp(textw, 0, maxwidth)
	texth = math.Clamp(texth, 0, maxheight)

	self:SetSize(textw, texth)
end

function CLASS:OnModelSetup(setup)
	BASE.OnModelSetup(self, setup)

	if setup.font then
		self:SetFont(setup.font)
	end
end

return true


--lua/streamradio_core/classes/ui/radio/list_playlistview.lua:
return gluapack()()
--lua/streamradio_core/classes/clientconvar.lua:
return gluapack()()
--lua/streamradio_core/print.lua:
return gluapack()()
--lua/streamradio_core/client/settings/general.lua:
return gluapack()()
--lua/streamradio_core/filesystem/pls.lua:
return gluapack()()
--lua/streamradio_core/filesystem/pls.lua:
local RADIOFS = RADIOFS
if not istable( RADIOFS ) then
	StreamRadioLib.Filesystem.Load()
	return
end

RADIOFS.name = "PLS"
RADIOFS.type = "pls"
RADIOFS.extension = "pls"
RADIOFS.icon = StreamRadioLib.GetPNGIcon("table_sound", true)

RADIOFS.priority = 9000
RADIOFS.loadToWhitelist = true

local function decodePLS(RawPlaylist)
	local RawPlaylistTab = string.Split( RawPlaylist, "\n" )

	local Header = string.lower( string.Trim( RawPlaylistTab[1] or "" ) )
	local Version = string.lower( string.Trim( RawPlaylistTab[#RawPlaylistTab] or "" ) )

	if Header ~= "[playlist]" then
		return nil
	end

	if Version ~= "version=2" then
		return nil
	end

	local CountHeader = string.lower( string.Trim( RawPlaylistTab[2] or "" ) )
	local Count = tonumber(string.match(CountHeader, "%s*numberofentries%s*=%s*([0-9]+)")) or 0

	local Playlist = {}

	if Count <= 0 then
		return Playlist
	end

	for i = 1, Count do
		local line = i * 3

		local UrlLine = RawPlaylistTab[line] or ""
		local NameLine = RawPlaylistTab[line + 1] or ""

		local url = string.Trim(string.match(UrlLine, "%s*File" .. i .. "%s*=%s*([^\n]+)") or "")
		local name = string.Trim(string.match(NameLine, "%s*Title" .. i .. "%s*=%s*([^\n]+)") or "")

		if name == "" then
			name = url
		end

		if url == "" then
			continue
		end

		local item = {
			name = name,
			url = url
		}

		table.insert(Playlist, item)
	end

	return Playlist
end

function RADIOFS:Read(globalpath, vpath, callback)
	file.AsyncRead(globalpath, "DATA", function(fileName, gamePath, status, data)
		if status ~= FSASYNC_OK then
			callback(false, nil)
			return
		end

		local RawPlaylist = string.Trim(data or "")
		if RawPlaylist == "" then
			callback(true, {})
			return
		end

		local Playlist = decodePLS(RawPlaylist)
		if not Playlist then
			callback(false, nil)
			return
		end

		callback(true, Playlist)
	end)

	return true
end

function RADIOFS:Write(globalpath, vpath, data, callback)
	if not self:CreateDirectoryForFile(globalpath) then
		callback(false)
		return false
	end

	local f = file.Open(globalpath, "w", "DATA")
	if not f then
		callback(false)
		return false
	end

	local dataOut = {}
	local Count = #data
	local Seperator = "\n"
	local Seperator2 = "="

	dataOut[#dataOut + 1] = string.format( "[playlist]\nNumberOfEntries=%i\n", Count )

	for i, v in ipairs( data ) do
		local name = string.Replace( v.name, Seperator, "" )
		local url = string.Replace( v.url, Seperator, "" )
		name = string.Trim( string.Replace( name, Seperator2, "" ) )
		url = string.Trim( string.Replace( url, Seperator2, "" ) )

		dataOut[#dataOut + 1] = string.format( "File%i" .. Seperator2 .. "%s" .. Seperator .. "Title%i" .. Seperator2 .. "%s" .. Seperator .. "Length%i" .. Seperator2 .. "-1\n", k, url, k, name, k )
	end

	dataOut[#dataOut + 1] = "Version=2"
	local DataString = table.concat(dataOut, "")

	DataString = string.Trim(DataString)
	DataString = DataString .. "\n\n"

	f:Write( DataString )
	f:Close( )

	callback(true)
	return true
end

return true


--lua/autorun/svidetel_npc.lua:
return gluapack()()
--lua/svmod/sh_utilitaries.lua:
return gluapack()()
--lua/svmod/compatibility/sh_vcmod.lua:
return gluapack()()
--lua/svmod/gui/settings/cl_fuel.lua:
return gluapack()()
--lua/svmod/gui/settings/cl_others.lua:
return gluapack()()
--lua/svmod/gui/settings/cl_settings.lua:
return gluapack()()
--lua/svmod/horn/sh_horn.lua:
return gluapack()()
--lua/svmod/lights/flashinglights/cl_flashinglights.lua:
return gluapack()()
--lua/svmod/vehicles/sh_vehicles.lua:
-- @class SVMOD
-- @shared

-- Checks if the entity is a SV_Vehicle or not.
-- @treturn boolean True if the entity is a SV_Vehicle, false otherwise
function SVMOD:IsVehicle(veh)
	return IsValid(veh) and (veh.SV_IsEditMode or (veh.SV_GetDriverSeat and veh:SV_GetDriverSeat().SV_States ~= nil))
end

hook.Add("OnEntityCreated", "SV_LoadVehicle", function(ent)
	if not IsValid(ent) or not ent:IsVehicle() then return end

	if not SVMOD:GetAddonState() then
		-- Addon disabled or we do not know the state of the addon yet
		return
	end

	-- SVMod not loaded yet?!
	if not SVMOD.Data then
		return
	end

	if SERVER then
		-- Wait, because the entity is not fully loaded on the server!
		timer.Simple(FrameTime(), function()
			-- SVMOD:Compatiblity_VCMod_Seat_Fix()
			SVMOD:LoadVehicle(ent)
		end)
	else -- CLIENT
		SVMOD:LoadVehicle(ent)
	end
end)

hook.Add("EntityRemoved", "SV_UnloadVehicle", function(ent)
	if SVMOD:IsVehicle(ent) then
		-- Same as SVMOD:UnloadVehicle without removing pointers
		-- because it is unnecessary
		hook.Run("SV_UnloadVehicle", ent)
		hook.Run("SV_VehicleUnloaded", ent)
	end
end)

hook.Add("SV_Enabled", "SV_UpdateAndLoad", function()
	SVMOD:Data_Update(function()
		SVMOD:LoadAllVehicles()
	end)
end)

hook.Add("SV_Disabled", "SV_Unload", function()
	SVMOD:UnloadAllVehicles()
end)

-- Loads a vehicle, which allows it to become an SV Vehicle.
-- @tparam Vehicle Vehicle to be loaded
-- @internal
function SVMOD:LoadVehicle(veh)
	if not IsValid(veh) or not veh:IsVehicle() then
		return
	end

	local data = SVMOD:GetData(veh:GetModel())

	if (veh.SV_IsEditMode or data) or veh:GetNW2Bool("SV_IsSeat", false) then
		if SERVER and data then -- Is a driver seat
			local driver = veh:GetDriver()
			if IsValid(driver) then
				driver:ExitVehicle()
			end
		end

		-- Add pointers to the vehicle metatable
		for k, v in pairs(SVMOD.Metatable) do
			veh[k] = v
		end

		-- Get configuration and call InitEntity on driver seat ONLY
		if veh:GetModel() ~= "models/nova/airboat_seat.mdl" then
			veh.SV_States = {
				Headlights = false,
				BackLights = false,
				LeftBlinkers = false,
				RightBlinkers = false,
				HazardLights = false,
				FlashingLights = false,
				Horn = false
			}

			if data then
				veh.SV_Data = SVMOD:DeepCopy(data)

				hook.Run("SV_LoadVehicle", veh)
				hook.Run("SV_VehicleLoaded", veh)
			end
		end
	end
end

-- Unloads a vehicle, which allows it to become a basic vehicle.
-- @tparam SV_Vehicle SV_Vehicle to be unloaded
-- @internal
function SVMOD:UnloadVehicle(veh)
	if IsValid(veh) then
		hook.Run("SV_UnloadVehicle", veh)
		hook.Run("SV_VehicleUnloaded", ent)

		-- Remove pointers to the vehicle metatable
		for k, _ in pairs(SVMOD.Metatable) do
			veh[k] = nil
		end
	end
end

-- Loads all vehicles of the game.
-- @internal
function SVMOD:LoadAllVehicles()
	for _, veh in ipairs(ents.FindByClass("prop_vehicle_jeep")) do
		if SERVER and IsValid(veh) then
			local ply = veh:GetDriver()
			if IsValid(ply) then
				ply:ExitVehicle()
			end
		end

		SVMOD:LoadVehicle(veh)
	end
end

-- Unloads all vehicles of the game.
-- @internal
function SVMOD:UnloadAllVehicles()
	for _, veh in ipairs(ents.FindByClass("prop_vehicle_jeep")) do
		if SVMOD:IsVehicle(veh) then
			if SERVER then
				for _, ply in ipairs(veh:SV_GetAllPlayers()) do
					ply:ExitVehicle()
				end
			end

			timer.Simple(FrameTime() * 4, function()
				SVMOD:UnloadVehicle(veh)
			end)
		end
	end
end
--lua/autorun/tdmcars_mer300slgull.lua:
return gluapack()()
--lua/autorun/tdmcars_porcayenne12.lua:
return gluapack()()
--lua/autorun/tdmcars_slsamg.lua:
return gluapack()()
--lua/autorun/tdmcars_slsamg.lua:
local V = {
			Name = "Mercedes-Benz SLS AMG", 
			Class = "prop_vehicle_jeep",
			Category = "TDM Cars",
			Author = "TheDanishMaster, Turn 10",
			Information = "A drivable Mercedes SLS AMG by TheDanishMaster",
			Model = "models/tdmcars/mer_slsamg.mdl",
						KeyValues = {
							vehiclescript	=	"scripts/vehicles/TDMCars/slsamg.txt"
							}
			}
list.Set("Vehicles", "slsamgtdm", V)

--lua/autorun/tdmcars_volkswagen.lua:
return gluapack()()
--lua/autorun/toju_pms_doctors.lua:
-- Doctors Male
player_manager.AddValidModel("Doctor Male 1", "models/toju/hgg/doctors/male_01.mdl")
list.Set("PlayerOptionsModel", "Doctor Male 1", "models/toju/hgg/doctors/male_01.mdl")
player_manager.AddValidModel("Doctor Male 2", "models/toju/hgg/doctors/male_02.mdl")
list.Set("PlayerOptionsModel", "Doctor Male 2", "models/toju/hgg/doctors/male_02.mdl")
player_manager.AddValidModel("Doctor Male 3", "models/toju/hgg/doctors/male_03.mdl")
list.Set("PlayerOptionsModel", "Doctor Male 3", "models/toju/hgg/doctors/male_03.mdl")
player_manager.AddValidModel("Doctor Male 4", "models/toju/hgg/doctors/male_04.mdl")
list.Set("PlayerOptionsModel", "Doctor Male 4", "models/toju/hgg/doctors/male_04.mdl")
player_manager.AddValidModel("Doctor Male 5", "models/toju/hgg/doctors/male_05.mdl")
list.Set("PlayerOptionsModel", "Doctor Male 5", "models/toju/hgg/doctors/male_05.mdl")
player_manager.AddValidModel("Doctor Male 6", "models/toju/hgg/doctors/male_06.mdl")
list.Set("PlayerOptionsModel", "Doctor Male 6", "models/toju/hgg/doctors/male_06.mdl")
player_manager.AddValidModel("Doctor Male 7", "models/toju/hgg/doctors/male_07.mdl")
list.Set("PlayerOptionsModel", "Doctor Male 7", "models/toju/hgg/doctors/male_07.mdl")
player_manager.AddValidModel("Doctor Male 8", "models/toju/hgg/doctors/male_08.mdl")
list.Set("PlayerOptionsModel", "Doctor Male 8", "models/toju/hgg/doctors/male_08.mdl")
player_manager.AddValidModel("Doctor Male 9", "models/toju/hgg/doctors/male_09.mdl")
list.Set("PlayerOptionsModel", "Doctor Male 9", "models/toju/hgg/doctors/male_09.mdl")
-- Doctors Female
player_manager.AddValidModel("Doctor Female 1", "models/toju/hgg/doctors/female_01.mdl")
list.Set("PlayerOptionsModel", "Doctor Female 1", "models/toju/hgg/doctors/female_01.mdl")
player_manager.AddValidModel("Doctor Female 2", "models/toju/hgg/doctors/female_02.mdl")
list.Set("PlayerOptionsModel", "Doctor Female 2", "models/toju/hgg/doctors/female_02.mdl")
player_manager.AddValidModel("Doctor Female 3", "models/toju/hgg/doctors/female_03.mdl")
list.Set("PlayerOptionsModel", "Doctor Female 3", "models/toju/hgg/doctors/female_03.mdl")
player_manager.AddValidModel("Doctor Female 4", "models/toju/hgg/doctors/female_04.mdl")
list.Set("PlayerOptionsModel", "Doctor Female 4", "models/toju/hgg/doctors/female_04.mdl")
player_manager.AddValidModel("Doctor Female 5", "models/toju/hgg/doctors/female_06.mdl")
list.Set("PlayerOptionsModel", "Doctor Female 5", "models/toju/hgg/doctors/female_06.mdl")
player_manager.AddValidModel("Doctor Female 6", "models/toju/hgg/doctors/female_07.mdl")
list.Set("PlayerOptionsModel", "Doctor Female 6", "models/toju/hgg/doctors/female_07.mdl")
--addons/voidlib/lua/voidlib/cl_notify.lua:
return gluapack()()
--addons/voidlib/lua/voidlib/sh_config.lua:
return gluapack()()
--addons/voidlib/lua/voidlib/sh_language.lua:

local branch = "master"
local rawUrl = "https://raw.githubusercontent.com/VoidTeam1/VoidLanguages/"
local apiEndpoint = "https://api.github.com/repos/VoidTeam1/VoidLanguages/git/trees/master?recursive=1"

VoidLib.Lang = VoidLib.Lang or {}

if (SERVER) then
    util.AddNetworkString("VoidLib.Lang.NetworkLocalLanguages")

    concommand.Add("voidlib_reloadlangs", function (ply, cmd, args)
        if (!ply:IsSuperAdmin()) then return end

        for k, v in pairs(VoidLib.Tracker.Addons) do
            local gTable = _G[k]
            if (!gTable) then continue end

            VoidLib.Lang:LoadLocalLanguages(k, true)

            if (table.Count(gTable.Lang.LocalLanguages) > 0) then
                VoidLib.Lang:NetworkLocalLanguages(k, gTable.Lang.LocalLanguages)
            end
        end

        VoidLib:Log("Successfully reloaded local languages!", "Languages")
    end)
end

if (CLIENT) then
    net.Receive("VoidLib.Lang.NetworkLocalLanguages", function ()
        local addon = net.ReadString()
        local tbl = VoidLib.ReadCompressedTable()

        local gTable = _G[addon]
        if (!gTable) then return end

        gTable.Lang.Langs = tbl

        gTable:Log("Received local languages from server!", "Languages")
    end)
end

function VoidLib.Lang:Init(addon, onlyLocal)

    local gTable = _G[addon]
    if (!gTable) then return end

    if (!gTable.Logging) then
        VoidLib.Logging:Inject(addon, VoidLib.Logging.AddonColors[addon])
    end

    if (addon == "VoidChar") then return end -- ignore voidchar, it has it's own language system

    gTable.Lang = gTable.Lang or {}
    gTable.Lang.Langs = gTable.Lang.Langs or {}
    gTable.Lang.AvailableLangs = gTable.Lang.AvailableLangs or {}

    function gTable.Lang.GetPhrase(phrase, x)
        return VoidLib.Lang:GetLangPhrase(addon, phrase, x)
    end

    -- We need to wait until first tick is called because of HTTP API not working yet
    hook.Add("Tick", "VoidLib.Lang.InitTick" .. addon, function ()
        
        hook.Remove("Tick", "VoidLib.Lang.InitTick" .. addon)

        if (onlyLocal) then
            gTable:Log("Dev environment detected, using only local languages!", "Languages")
            VoidLib.Lang:LoadLanguages(addon)
        else
            VoidLib.Lang:DownloadLanguages(addon, function (failed)
                if (failed) then
                    gTable:LogWarning("Failed to fetch available languages - using only local languages!", "Languages")
                end

                timer.Simple(2, function () -- Wait until files are written
                    VoidLib.Lang:LoadLanguages(addon)
                end)
            end)
        end
    end)
end

function VoidLib.Lang:GetAvailableLanguages(addon, callback, failCallback)
    local gTable = _G[addon]
    if (!gTable) then return end
    local url = apiEndpoint
    http.Fetch(url, function (body, size, headers, code)
        -- Success
        if (code != 200 or !body or body == "") then
            gTable:LogError("Couldn't get available languages - error code :code: (please try again later)", { code = code }, "Languages")
            return
        end

        local tbl = util.JSONToTable(body)
        if (!tbl or table.Count(tbl) < 1) then
            gTable:LogError("Couldn't parse available languages - no languages exist?", "Languages")
            return
        end

        local langs = {}
        for k, fileTbl in pairs(tbl.tree) do
            if (!string.StartWith(fileTbl.path, addon) or addon == fileTbl.path) then continue end

            local fileName = string.Replace(fileTbl.path, addon .. "/")
            if (fileName == ".gitkeep") then continue end

            local name = string.Replace(fileName, ".json", "")
            langs[#langs + 1] = name
        end

        callback(langs)

    end, function (err)
        -- Failure
        gTable:LogError("Couldn't get available languages - error: :err:", { err = err }, "Languages")
        failCallback()
    end)
end

function VoidLib.Lang:GetLangPhrase(addon, phrase, x)
    local gTable = _G[addon]
    if (!gTable) then return end

    local langRef = gTable.Config.Language
    if (!langRef) then
        gTable:LogError("Tried to get langauge phrase, but no selected language! Falling back to English.", "Languages")
        gTable.Config.Language = "English"

        return phrase
    end

    -- We don't want the reference
    local lang = string.lower(langRef)

    local langs = gTable.Lang.Langs
    if (!langs) then
        gTable:LogWarning("Langs table not initialized yet!", "Languages")
        return phrase
    end
    
    local returnVal = phrase
    if (langs[lang] and langs[lang][phrase]) then
        -- If the language has the phrase
        returnVal = langs[lang][phrase]
    elseif (langs["english"] and langs["english"][phrase]) then
        -- If not, fallback to english
        returnVal = langs["english"][phrase]
    end

    if (x) then
        returnVal = VoidLib.StringFormat(returnVal, x)
    end

    -- If no langauge has the phrase, return the phrase itself
    return returnVal
end

function VoidLib.Lang:IsLanguageInstalled(addon, lang)
    local langFile = "voidlanguages/" .. addon .. "/" .. lang .. ".json"
    return file.Exists(langFile, "DATA"), langFile
end

function VoidLib.Lang:IsLatest(addon, lang, newLang)
    local isInstalled, path = self:IsLanguageInstalled(addon, lang)
    if (!isInstalled) then return false, false end

    local langContent = file.Read(path)

    local existingLangCRC = util.CRC(langContent)
    local newLangCRC = util.CRC(newLang)

    return newLangCRC == existingLangCRC, true
end

function VoidLib.Lang:WriteLanguage(addon, lang, json)
    if (!file.Exists("voidlanguages", "DATA")) then
        file.CreateDir("voidlanguages")
    end

    if (!file.Exists("voidlanguages/" .. addon, "DATA")) then
        file.CreateDir("voidlanguages/" .. addon)
    end

    file.Write("voidlanguages/" .. addon .. "/" .. lang .. ".json", json)
end

function VoidLib.Lang:FlattenLanguageTable(tbl, res)
    if (type(tbl) != "table") then
        return tbl
    end

    if (res == nil) then
        res = {}
    end

    for k, v in pairs(tbl) do
        if (type(v) == "table") then
            local v = VoidLib.Lang:FlattenLanguageTable(v, {})
            for k2, v2 in pairs(v) do
                res[k .. "." .. k2] = v2
            end
        else
            res[k] = v
        end
    end

    return res
end

function VoidLib.Lang:LoadLocalLanguages(addon, reload)

    if (!SERVER) then return end

    local gTable = _G[addon]
    if (!gTable) then return end

    local files = file.Find("voidlanguages/" .. addon .. "/*.json", "DATA")
    local langs = {}
    for k, v in pairs(files) do

        local langName = string.Replace(v, ".json", "")
        if (!reload) then
            if (gTable.Lang.Langs[langName]) then continue end
        end

        local json = file.Read("voidlanguages/" .. addon .. "/" .. v)

        local tbl = util.JSONToTable(json)
        local length = table.Count(tbl or {})
        if (!tbl or length < 1) then
            gTable:LogError("Tried to load " .. v .. ", but langauge file is corrupt/empty!", "Languages")
            continue
        end

        gTable:LogDebug("Loaded :langName: local language! (:length: phrases)", { langName = langName, length = length }, "Languages")

        langs[langName] = VoidLib.Lang:FlattenLanguageTable(tbl)
    end



    gTable.Lang.LocalLanguages = langs


    VoidLib.Lang:NetworkLocalLanguages(addon, langs)

    local totalLangs = table.Count(langs) 
    if (totalLangs > 0) then
        table.Merge(gTable.Lang.Langs, langs)

        gTable:Log("Loaded :totalLangs: local languages!", { totalLangs = totalLangs }, "Languages")
    end
end

function VoidLib.Lang:NetworkLocalLanguages(addon, tbl, ply)
    if (!SERVER) then return end

    net.Start("VoidLib.Lang.NetworkLocalLanguages")
        net.WriteString(addon)
        VoidLib.WriteCompressedTable(tbl)
    if (ply) then
        net.Send(ply)
    else
        net.Broadcast()
    end
    
end

function VoidLib.Lang:LoadLanguages(addon)

    local gTable = _G[addon]
    if (!gTable) then return end

    for _, lang in pairs(gTable.Lang.AvailableLangs or {}) do
        local langExists, langFile = self:IsLanguageInstalled(addon, lang)
        if (!langExists) then
            gTable:LogError("Tried to load :lang:, but langauge is not installed!", { lang = lang }, "Languages")
            continue
        end

        local json = file.Read(langFile)
        if (!json or json == "") then
            gTable:LogError("Tried to load :lang:, but langauge file is empty!", { lang = lang }, "Languages")
            continue
        end
        
        local tbl = util.JSONToTable(json)
        if (!tbl or table.Count(tbl) < 1) then
            gTable:LogError("Tried to load :lang:, but langauge file is corrupt/empty!", { lang = lang }, "Languages")
            continue
        end

        gTable.Lang.Langs[lang] = VoidLib.Lang:FlattenLanguageTable(tbl)

    end

    VoidLib.Lang:LoadLocalLanguages(addon)

    if (table.Count(gTable.Lang.Langs) < 1) then
        gTable:LogError("Tried to load languages, but none downloaded!", "Languages")
        return
    end

    gTable:Log("Loaded " .. table.Count(gTable.Lang.Langs) .. " languages!", "Languages")

    gTable.Lang.LanguagesLoaded = true
    hook.Run(addon .. ".Lang.LanguagesLoaded")
end

function VoidLib.Lang:DownloadLanguages(addon, callback)
    local gTable = _G[addon]
    if (!gTable) then return end


    self:GetAvailableLanguages(addon, function (languages)

        gTable.Lang.AvailableLangs = languages

        local callbacksDone = 0

        if (#languages == 0) then
            callback()
        end

        for _, lang in pairs(languages) do
            local formattedLangName = lang:gsub("^%l", string.upper)
            local url = rawUrl .. branch .. "/" .. addon .. "/" .. lang .. ".json"
            http.Fetch(url, function (body, size, headers, code)

                callbacksDone = callbacksDone + 1
            
                if (code != 200 or !body or body == "") then
                    gTable:LogError("Couldn't get " .. lang .. " language: " .. code .. " (please try again later)", "Languages")
                    if (callbacksDone == #languages) then
                        callback()
                    end
                    return
                end

                local tbl = util.JSONToTable(body)
                if (!tbl or table.Count(tbl) < 1) then
                    gTable:LogError("Couldn't parse language " .. lang .. " - incorrect or empty JSON!", "Languages")
                    if (callbacksDone == #languages) then
                        callback()
                    end
                    return
                end

                local isLatest, isUpdating = VoidLib.Lang:IsLatest(addon, lang, body)
                if (!isLatest) then
                    local operationString = isUpdating and "Updated" or "Downloaded"
                    gTable:Log(operationString .. " " .. formattedLangName .. " language", "Languages")

                    self:WriteLanguage(addon, lang, body)
                elseif (gTable.Debug) then
                    gTable:LogDebug(formattedLangName .. " language is up to date!", "Languages")
                end

                if (callbacksDone == #languages) then
                    callback()
                end
                

            end, function (err)
                gTable:LogError("Couldn't download " .. lang .. " language - error: " .. err, "Languages")
            end)
        end

    end, function ()
        -- Failed
        callback(true)
    end)
end

--addons/voidlib/lua/voidlib/sh_net.lua:
return gluapack()()
--addons/voidlib/lua/voidlib/vgui/colorpicker.lua:
return gluapack()()
--addons/voidlib/lua/voidlib/vgui/colorpicker.lua:

local sc = VoidUI.Scale

local PANEL = {}

local function CreateWangFunction( self, colindex )
	local function OnValueChanged( ptxt, strvar )
		if ( ptxt.notuserchange ) then return end


		self:GetColor()[ colindex ] = tonumber( strvar ) or 0
		if ( colindex == "a" ) then
			self.Alpha:SetBarColor( ColorAlpha( self:GetColor(), 255 ) )
			self.Alpha:SetValue( self:GetColor().a / 255 )
		else
			self.HSV:SetColor( self:GetColor() )

			local h, s, v = ColorToHSV( self.HSV:GetBaseRGB() )
			self.RGB.LastY = ( 1 - h / 360 ) * self.RGB:GetTall()
		end

		self:UpdateColor( self:GetColor() )
	end


	return OnValueChanged
end

function PANEL:Init()
	self:SetPalette(false)
	self:SetAlphaBar(false)
	self:SetWangs(false)

	self.RGB:Remove()

	self.Palette:Dock(FILL)
	self.Palette:InvalidateLayout()

	
	self.RightPanel = self:Add("Panel")
	self.RightPanel:Dock(RIGHT)
	self.RightPanel:SetWide(self:GetWide() * 0.25)
	self.RightPanel:SDockMargin(2, 2, 2, 2)

	self.ColorIndicator = self.RightPanel:Add("Panel")
	self.ColorIndicator:Dock(TOP)
	self.ColorIndicator:MarginSides(10)
	self.ColorIndicator:SSetTall(40)
	self.ColorIndicator.Paint = function (s, w, h)
		local color = self:GetColor()
		surface.SetDrawColor(color)
		surface.DrawRect(sc(7),sc(5),sc(35),sc(35))
	end
	
	self.WangsPanel = self.RightPanel:Add("Panel")
	self.WangsPanel:SetTall(self:GetTall() * 0.34)
	self.WangsPanel:Dock(BOTTOM)
	
	self.txtR = self.WangsPanel:Add("VoidUI.TextInput")
	self.txtR.entry:SetFont("VoidUI.R18")
	self.txtR.dockL = 2
	self.txtR.dockR = 2
	self.txtR:Dock(TOP)
	self.txtR.entry:SetTextColor(VoidUI.Colors.Gray)
	self.txtR:SSetWide(34)
	self.txtR:MarginLeft(25)

	self.txtG = self.WangsPanel:Add("VoidUI.TextInput")
	self.txtG.entry:SetFont("VoidUI.R18")
	self.txtG.dockL = 2
	self.txtG.dockR = 2
	self.txtG:MarginTop(2)
	self.txtG:Dock(TOP)
	self.txtG.entry:SetTextColor(VoidUI.Colors.Gray)
	self.txtG:SSetWide(34)
	self.txtG:MarginLeft(25)

	self.txtB = self.WangsPanel:Add( "VoidUI.TextInput" )
	self.txtB.entry:SetFont("VoidUI.R18")
	self.txtB.dockL = 2
	self.txtB.dockR = 2
	self.txtB:MarginTop(2)
	self.txtB:Dock(TOP)
	self.txtB:SSetWide(34)
	self.txtB.entry:SetTextColor(VoidUI.Colors.Gray)
	self.txtB:MarginLeft(25)

	local this = self

	self.WangsPanel.Paint = function (self, w, h)
		draw.SimpleText("R", "VoidUI.R20", sc(6), this.txtR.y+1, VoidUI.Colors.LightGray, TEXT_ALIGN_LEFT, TEXT_ALIGN_TOP)
		draw.SimpleText("G", "VoidUI.R20", sc(6), this.txtG.y+1, VoidUI.Colors.LightGray, TEXT_ALIGN_LEFT, TEXT_ALIGN_TOP)
		draw.SimpleText("B", "VoidUI.R20", sc(6), this.txtB.y+1, VoidUI.Colors.LightGray, TEXT_ALIGN_LEFT, TEXT_ALIGN_TOP)
	end


	self.txtR.OnValueChange = CreateWangFunction( self, "r" )
	self.txtG.OnValueChange = CreateWangFunction( self, "g" )
	self.txtB.OnValueChange = CreateWangFunction( self, "b" )

	self.RGB = vgui.Create( "DRGBPicker", self )
	self.RGB:Dock(RIGHT)
	self.RGB:SSetWide(26)
	self.RGB:SDockMargin( 4, 0, 0, 0 )
	self.RGB.OnChange = function( ctrl, color )
		self:SetBaseColor( color )
	end

	self:InvalidateLayout()
end

vgui.Register("VoidUI.ColorMixerContent", PANEL, "DColorMixer")

-- color mixer parent

local PANEL = {}

function PANEL:Init()
	self.colorMixer = self:Add("VoidUI.ColorMixerContent")
	self.colorMixer:Dock(FILL)
	self.colorMixer:SDockMargin(7,7,7,7)

end

function PANEL:Paint(w, h)
	draw.RoundedBox(8, 0, 0, w, h, VoidUI.Colors.InputDark)
end

vgui.Register("VoidUI.ColorMixer", PANEL, "Panel")
--addons/voidlib/lua/voidlib/vgui/dropdown_popup.lua:
return gluapack()()
--addons/voidlib/lua/voidlib/vgui/iconselector.lua:
local sc = VoidUI.Scale

local PANEL = {}

function PANEL:Init()
	self.inputWidth = sc(70)

	local textInput = self:Add("VoidUI.TextInput")
	textInput:SetWide(self.inputWidth)
	textInput:SSetTall(20)
	textInput:SetFont("VoidUI.R18")
	textInput.dockL = 4
	textInput.dockR = 4

	textInput:InvalidateLayout()


	local icon = self:Add("DImage")

	function textInput:OnValueChange(val)
		icon:SetMaterial(nil)
		if (#val > 3) then
			icon.isLoading = true
			VoidLib.FetchImage(val, function (mat)
				if (!IsValid(icon)) then return end
				icon.isLoading = false
				if (!mat) then return end
				icon:SetMaterial(mat)
			end)
		end
	end

	self.textInput = textInput

	self.icon = icon

end

function PANEL:PerformLayout(w, h)
	local center = w / 2
	local inputHalf = self.inputWidth / 2
	local textX = center - inputHalf

	surface.SetFont("VoidUI.R18")
	local textSize = surface.GetTextSize(VoidLib.ImageProvider)

	self.textX = textX
	self.textInput:SetPos(self.textX + textSize/2, sc(10))

	self.icon:SetSize(w*0.5,w*0.5)
	self.icon:SetPos(w/2-self.icon:GetWide()/2,h/2-self.icon:GetTall()/2+sc(10))
end

function PANEL:Paint(w, h)
	draw.RoundedBox(10, 0, 0, w, h, VoidUI.Colors.Primary)

	local provider = VoidLib.ImageProvider
	draw.SimpleText(provider, "VoidUI.R18", self.textX, sc(10), VoidUI.Colors.Gray, TEXT_ALIGN_CENTER, TEXT_ALIGN_TOP)

	if (!self.icon:GetMaterial() or self.icon.isLoading) then
		local text = self.icon.isLoading and "Loading.." or "None"
		draw.SimpleText(text, "VoidUI.R36", w/2, h/2, VoidUI.Colors.Gray, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)
	end
end

vgui.Register("VoidUI.IconSelector", PANEL, "Panel")
--addons/voidlib/lua/voidlib/vgui/itemselect.lua:
local sc = VoidUI.Scale


local PANEL = {}

function PANEL:Init()
	self.multipleChoice = false
end

function PANEL:InitItems(tbl, callback)
	self.itemsTbl = tbl
	self.callback = callback

	self:SSetSize(280, 335)
	self:MakePopup()

	local cx, cy = input.GetCursorPos()
	self:SetPos(cx-sc(40), cy + sc(10))

	local root = self
	self.panel = self:Add("Panel")
	self.panel:Dock(FILL)
	self.panel:DockMargin(14, 14, 14, 14)

	self.search = self.panel:Add("VoidUI.TextInput")
	self.search:Dock(TOP)
	self.search:SetTall(36)
	self.search.entry:SetPlaceholderText("Search...")
	self.search.entry:SetFont("VoidUI.R24")

	self.search:SetColorScheme(VoidUI.Colors.White, VoidUI.Colors.White, VoidUI.Colors.Background, VoidUI.Colors.Black)

	function self.search.entry:OnFocusChanged(res)
		timer.Simple(0, function ()
			if (!IsValid(self)) then return end
			if (!res and !root:HasFocus()) then
				root:Remove()
			end
		end)
	end

	self.items = self.panel:Add("VoidUI.ScrollPanel")
	self.items:Dock(TOP)
	self.items:DockMargin(0, 22, 0, 0)
	self.items:SetTall(250)

	self.items.defaultColor = VoidUI.Colors.Background


	self.performSearch = function (str)

		self.items:Clear()

		local totalItems = 0
		for k, v in pairs(tbl) do
			if (!self.SearchFunc) then
				if (!string.find(string.lower(v), string.lower(str))) then continue end
			else
				if (!self.SearchFunc(k, str, v)) then continue end
			end

			totalItems = totalItems + 1

			local item = self.items:Add("DButton")
			item:Dock(TOP)
			item:DockMargin(0, 0, 0, 6)
			item:SetTall(37)
			item:SetText("")

			item.Paint = function (self, w, h)
				local color = (self:IsHovered() and VoidUI.Colors.GrayText) or VoidUI.Colors.InputLight
				if (root.multipleChoice and root.choices[k]) then
					color = VoidUI.Colors.Blue
				end
				draw.RoundedBox(6, 0, 0, w, h, color)

				draw.SimpleText(v, "VoidUI.R24", 10, h/2, VoidUI.Colors.Gray, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER)
			end

			item.DoClick = function ()
				if (self.multipleChoice) then
					self.choices[k] = !self.choices[k]
					self.recentItem = {
						["key"] = k,
						["value"] = v,
					    	["added"] = tobool(self.choices[k]),
					}
					self:CallbackMultiple()
				else
					callback(k, v)
					self:Remove()
				end
			end
		end
	end

	self.performSearch("")

	function self.search.entry:OnValueChange(val)
		root.performSearch(val)
	end
end

function PANEL:SetMultipleChoice(b)
	self.multipleChoice = b
	self.choices = {}
end

function PANEL:CallbackMultiple()
	if (self.multipleChoice) then
		local tbl = {}
		local tbl1 = {}
		for k, v in pairs(self.choices) do
			if (v) then
				tbl[#tbl + 1] = k 
				tbl1[#tbl1 + 1] = self.itemsTbl[k]
			end
		end
		self.callback(tbl, tbl1)
	end
end

function PANEL:OnFocusChanged(res)
	timer.Simple(0, function ()
		if (!IsValid(self)) then return end
		if (self.search.entry:HasFocus()) then return end
		if (!res) then self:Remove() end
	end)
end

function PANEL:Think()
    self:MoveToFront()
end

function PANEL:Paint(w, h)

	local x, y = self:LocalToScreen(0, 0)

	BSHADOWS.BeginShadow()
		surface.SetDrawColor(VoidUI.Colors.Primary)
		surface.DrawRect(x,y,w,h)
	BSHADOWS.EndShadow(1, 1, 1, 140, 1, 1)
end


vgui.Register("VoidUI.ItemSelect", PANEL, "EditablePanel")

--addons/voidlib/lua/voidlib/vgui/search.lua:
local PANEL = {}

function PANEL:Init()
    self:SetColorScheme(VoidUI.Colors.White, VoidUI.Colors.White, VoidUI.Colors.BackgroundTransparent, VoidUI.Colors.BackgroundTransparent)
    self:SetFont("VoidUI.R20")
    self.entry:SetPlaceholderText("Search by name...")

    self.dockL = 35

    self.OnValueChange = function (s, str)
        self:OnSearch(str)
    end
end

function PANEL:Paint(w, h)
    draw.RoundedBox(8, 0, 0, w, h, self.borderColor)
	draw.RoundedBox(8, 1, 1, w-2, h-2, self.backgroundColor)

    local iconSize = h * 0.6

    surface.SetDrawColor(VoidUI.Colors.Gray)
    surface.SetMaterial(VoidUI.Icons.Search)
    surface.DrawTexturedRect(10, h/2 - iconSize / 2, iconSize, iconSize)
end

function PANEL:OnSearch(str)

end

vgui.Register("VoidUI.Search", PANEL, "VoidUI.TextInput")
--addons/voidlib/lua/voidlib/vgui/selectorbutton.lua:
local sc = VoidUI.Scale

local PANEL = {}

function PANEL:Init()
    self:SetText("")

    self.text = "Click to add"
    self.selection = nil
    self.value = nil

    self.selectionString = ""
end

function PANEL:Select(k, v)
    self.value = k

    if (istable(v)) then
        self.selection = table.concat(v, ", ")
        if (#self.selection > 27) then
            self.selection = string.sub(self.selection, 1, 27) .. "..."
        end
    else
        self.selection = v
    end
end

function PANEL:Paint(w, h)
    local color = self:IsHovered() and VoidUI.Colors.Hover or VoidUI.Colors.InputDark
    draw.RoundedBox(8, 0, 0, w, h, color)

    local textColor = self.selection and VoidUI.Colors.White or VoidUI.Colors.TextGray
    draw.SimpleText(self.selection or self.text, "VoidUI.R26", sc(15), h/2, textColor, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER)
end

vgui.Register("VoidUI.SelectorButton", PANEL, "DButton")
--addons/voidlib/lua/voidlib/vgui/threegrid.lua:
return gluapack()()
--addons/voidfactions-1.10.6/lua/voidfactions/features/api/sh_promoting.lua:
local L = VoidFactions.Lang.GetPhrase

local function loadProperties()

	properties.Add("promote", {
		MenuLabel = L"promote", -- Name to display on the context menu
		Order = 1, -- The order to display this property relative to other properties
		MenuIcon = "icon16/arrow_up.png", -- The icon to display next to the property

		Filter = function( self, ent, ply ) -- A function that determines whether an entity is valid for this property
			if ( !IsValid( ent ) ) then return false end
			if ( !ent:IsPlayer() ) then return false end
			
			local selfMember = ply:GetVFMember()
			local playerMember = ent:GetVFMember()

			if (!playerMember or !selfMember) then return false end
			if (!playerMember.rank or !selfMember.rank) then return false end

			return selfMember.rank:CanPromote(playerMember, selfMember)
		end,
		Action = function( self, ent ) -- The action to perform upon using the property ( Clientside )

			self:MsgStart()
				net.WriteEntity( ent )
			self:MsgEnd()

		end,
		Receive = function( self, length, ply ) -- The action to perform upon using the property ( Serverside )
			local ent = net.ReadEntity()

			if ( !properties.CanBeTargeted( ent, ply ) ) then return end
			if ( !self:Filter( ent, ply ) ) then return end

			VoidFactions.API:PromoteMember(ent:GetVFMember())
		end 
	})

	properties.Add("demote", {
		MenuLabel = L"demote", -- Name to display on the context menu
		Order = 2, -- The order to display this property relative to other properties
		MenuIcon = "icon16/arrow_down.png", -- The icon to display next to the property

		Filter = function( self, ent, ply ) -- A function that determines whether an entity is valid for this property
			if ( !IsValid( ent ) ) then return false end
			if ( !ent:IsPlayer() ) then return false end
			
			local selfMember = ply:GetVFMember()
			local playerMember = ent:GetVFMember()

			if (!playerMember or !selfMember) then return false end
			if (!playerMember.rank or !selfMember.rank) then return false end

			return selfMember.rank:CanDemote(playerMember, selfMember)
		end,
		Action = function( self, ent ) -- The action to perform upon using the property ( Clientside )

			self:MsgStart()
				net.WriteEntity( ent )
			self:MsgEnd()

		end,
		Receive = function( self, length, ply ) -- The action to perform upon using the property ( Serverside )
			local ent = net.ReadEntity()

			if ( !properties.CanBeTargeted( ent, ply ) ) then return end
			if ( !self:Filter( ent, ply ) ) then return end

			VoidFactions.API:DemoteMember(ent:GetVFMember())
		end 
	})

end

if (VoidFactions.Lang.LanguagesLoaded and VoidFactions.Settings.ConfigLoaded) then
	loadProperties()
else
	local bFirstCalled = VoidFactions.Lang.LanguagesLoaded or VoidFactions.Settings.ConfigLoaded

	hook.Add("VoidFactions.Lang.LanguagesLoaded", "VoidFactions.Promoting.LoadLanguages", function ()
		if (bFirstCalled) then
			loadProperties()
		end
		bFirstCalled = true
	end)

	hook.Add("VoidFactions.Settings.Loaded", "VoidFactions.Promoting.LoadSettings", function ()
		if (bFirstCalled) then
			loadProperties()
		end
		bFirstCalled = true
	end)
end
--addons/voidfactions-1.10.6/lua/voidfactions/features/currencies/sh_currencies.lua:
-- Helper functions

VoidFactions.Currencies = VoidFactions.Currencies or {}
VoidFactions.Currencies.List = {}

-- Class for creating new currencies

local CURRENCY_CLASS = {}
CURRENCY_CLASS.__index = CURRENCY_CLASS

function CURRENCY_CLASS:New()
	local object = setmetatable({}, CURRENCY_CLASS)
		object.name = nil

        object.getMoneyFunc = nil
        object.giveMoneyFunc = nil
        object.takeMoneyFunc = nil
        object.formatMoneyFunc = nil
        object.isInstalledFunc = nil

        object.isInternal = false
	return object
end

function CURRENCY_CLASS:Name(name)
    self.name = name
end

function CURRENCY_CLASS:SetInternal(isInternal)
    self.isInternal = isInternal
end

-- Function setters

function CURRENCY_CLASS:IsInstalledFunc(func)
    self.isInstalledFunc = func
end

function CURRENCY_CLASS:GetMoneyFunc(func)
	self.getMoneyFunc = func
end

function CURRENCY_CLASS:GiveMoneyFunc(func)
    self.giveMoneyFunc = func
end

function CURRENCY_CLASS:TakeMoneyFunc(func)
    self.takeMoneyFunc = func
end

function CURRENCY_CLASS:FormatMoneyFunc(func)
    self.formatMoneyFunc = func
end

-- Functions

function CURRENCY_CLASS:GetMoney(ply)
    return self.getMoneyFunc(ply) or 0
end

function CURRENCY_CLASS:GiveMoney(ply, money)
    if (!SERVER) then return end
    self.giveMoneyFunc(ply, money)
end

function CURRENCY_CLASS:TakeMoney(ply, money)
    if (!SERVER) then return end
    self.takeMoneyFunc(ply, money)
end

function CURRENCY_CLASS:FormatMoney(money)
    return self.formatMoneyFunc(money)
end

function CURRENCY_CLASS:IsInstalled()
    local isInstalled = self.isInstalledFunc and self.isInstalledFunc()
    if (!self.isInstalledFunc) then
        isInstalled = true
    end
    return isInstalled
end

-- Utility functions

function CURRENCY_CLASS:CanAfford(ply, money)
    return self:GetMoney(ply) >= money
end

-- Public functions

function VoidFactions.Currencies:NewCurrency()
	return CURRENCY_CLASS:New()
end

function VoidFactions.Currencies:AddCurrency(currency)
    if (!istable(currency)) then return end

    if (!currency.name) then
        VoidFactions.PrintError("A currency does not have a name! Stack trace:")
        print(debug.traceback())
        return
    end

    if (VoidFactions.Currencies.List[currency.name]) then
        VoidFactions.PrintError("A currency with the name " .. currency.name .. " was already registered!")
        return
    end

	if (!currency.getMoneyFunc) then
        VoidFactions.PrintError("Currency " .. currency.name .. " doesn't have a get money function!")
        return
    end
    if (!currency.giveMoneyFunc) then
        VoidFactions.PrintError("Currency " .. currency.name .. " doesn't have a give money function!")
        return
    end

    if (!currency.takeMoneyFunc) then
        currency.takeMoneyFunc = function (ply, money)
            currency.giveMoneyFunc(ply, -money)
        end
    end

    if (!currency.formatMoneyFunc) then
        currency.formatMoneyFunc = function (money)
            return "$" .. money
        end
    end

    VoidFactions.Currencies.List[currency.name] = currency
    VoidFactions.PrintDebug("Registered currency " .. currency.name .. "!")
end
--addons/voidfactions-1.10.6/lua/voidfactions/features/invites/cl_invites.lua:
local sc = VoidUI.Scale

VoidFactions.Invites = VoidFactions.Invites or {}
VoidFactions.Invites.ActivePanel = VoidFactions.Invites.ActivePanel or {}

net.Receive("VoidFactions.Invites.ShowInvite", function (len, ply)
    local name = net.ReadString()
    local id = net.ReadUInt(20)

    if (IsValid(VoidFactions.Invites.ActivePanel)) then
        VoidFactions.Invites.ActivePanel:Remove()
    end

    local popup = vgui.Create("VoidFactions.UI.InvitePopup")
    popup:SetPos(sc(50), sc(50))
    popup:SetInfo(name, id)

    timer.Create("VoidFactions.Invite." .. id, VoidFactions.Config.InviteDuration, 1, function ()
        -- Expired
        popup:Remove()
    end)

    function popup:OnRemove()
        if (timer.Exists("VoidFactions.Invite." .. id)) then
            timer.Remove("VoidFactions.Invite." .. id)
        end
    end

    VoidFactions.Invites.ActivePanel = popup
end)


-- Allow clicking through context (C) menu
local function handleContextOpen()
    if (IsValid(VoidFactions.Invites.ActivePanel)) then
        timer.Simple(0, function ()
            if (IsValid(g_ContextMenu)) then
                VoidFactions.Invites.ActivePanel:SetParent(g_ContextMenu)
            end
        end)
    end
end
local function handleContextClose()
    if (IsValid(VoidFactions.Invites.ActivePanel)) then
        VoidFactions.Invites.ActivePanel:SetParent(NULL)
    end
end
hook.Add("OnContextMenuOpen", "VoidCases.ContextMenuOpen", function ()
    handleContextOpen()
end)
hook.Add("OnContextMenuClose", "VoidCases.ContextMenuClose", function ()
    handleContextClose()
end)
--addons/voidfactions-1.10.6/lua/voidfactions/features/upgrades/sh_upgrades.lua:
return gluapack()()
--addons/voidfactions-1.10.6/lua/voidfactions/classes/sh_member.lua:
return gluapack()()
--addons/voidfactions-1.10.6/lua/voidfactions/classes/sh_rank.lua:
return gluapack()()
--addons/voidfactions-1.10.6/lua/voidfactions/classes/sh_reward.lua:
return gluapack()()
--addons/voidfactions-1.10.6/lua/voidfactions/classes/sh_upgrade.lua:
-- Do not confuse with upgrade modules.
VoidFactions.CustomUpgrades = VoidFactions.CustomUpgrades or {}

-- Class

local CUSTOMUPGRADE_CLASS = {}
CUSTOMUPGRADE_CLASS.__index = CUSTOMUPGRADE_CLASS

function CUSTOMUPGRADE_CLASS:New(id, name, module, value, currency, cost, icon)
	local newObject = setmetatable({}, CUSTOMUPGRADE_CLASS)
		newObject.id = id
        newObject.name = name

        newObject.module = module

        newObject.value = value

        newObject.currency = currency
        newObject.cost = cost

        newObject.icon = icon
	return newObject
end

-- Setter functions

function CUSTOMUPGRADE_CLASS:SetName(name)
    self.name = name
end

function CUSTOMUPGRADE_CLASS:SetIcon(icon)
    self.icon = icon
end

function CUSTOMUPGRADE_CLASS:SetModule(module)
    self.module = module
end

function CUSTOMUPGRADE_CLASS:SetValue(value)
    self.value = value
end

function CUSTOMUPGRADE_CLASS:SetCurrency(currency)
    self.currency = currency
end

function CUSTOMUPGRADE_CLASS:SetCost(cost)
    self.cost = cost
end


-- Functions

function VoidFactions.CustomUpgrades:New(...)
    return CUSTOMUPGRADE_CLASS:New(...)
end
--addons/voidfactions-1.10.6/lua/voidfactions/modules/experience/capturepointminute.lua:
return gluapack()()
--addons/voidfactions-1.10.6/lua/voidfactions/modules/inventories/idinventory.lua:
return gluapack()()
--addons/voidfactions-1.10.6/lua/voidfactions/modules/inventories/itemstore.lua:
-- Functions

local function createItemStruct(itemModel, itemClass, dropClass, data)
    return {
        class = itemClass,
        model = itemModel,
        dropClass = dropClass,
        data = data or {}
    }
end

-- Class

local INVENTORY = VoidFactions.Inventories:NewInventory()
INVENTORY:Name("ItemStore")

INVENTORY:IsInstalledFunc(function ()
    return itemstore and true or false
end)

INVENTORY:GetItemsFunc(function (ply)
    local inventory = ply.Inventory
    local tbl = {}
    for k, v in pairs(SERVER and inventory:GetItems() or itemstore.containers.Get(ply.InventoryID):GetItems()) do
        local class = v.Data.Class or v.Class
        if (class) then
            tbl[class] = true
        end
    end

    return tbl
end)

INVENTORY:GetItemDataFunc(function (ply, itemClass)
    local items = ply.Inventory:GetItems()
    local itemData = nil
    for k, v in pairs(items) do
        if ( (v.Data and v.Data.Class == itemClass) or v.Class == itemClass) then
            itemData = v
        end
    end

    if (!itemData) then return end

    local data = table.Copy(itemData.Data)
    local isShipment = itemData.Class == "spawned_shipment"
    if (itemData.Stackable and !isShipment) then
        data.Amount = 1
    end

    return createItemStruct(itemData:GetModel(), itemData.Data.Class, itemData.Class, data)
end)

INVENTORY:TakeItemFunc(function (ply, itemClass)
    local inventory = ply.Inventory

    local item = nil
    for k, v in pairs(inventory:GetItems()) do
        if ( (v.Data and v.Data.Class == itemClass) or v.Class == itemClass) then
            item = v

            -- Why....
			local isShipment = v.Class == "spawned_shipment"

            if (isShipment) then
                inventory:SetItem(k, nil)
            else
                local amount = v:GetAmount()
                v:SetAmount(amount - 1)

                if (v:GetAmount() <= 0) then
                    inventory:SetItem(k, nil)
                end
            end
        end
    end

    if (!item) then return end

    inventory:QueueSync()
end)

INVENTORY:GiveItemFunc(function (ply, class, dropClass, model, data)

    local isEmpty = !data or table.IsEmpty(data)
    local tbl = isEmpty and { Model = model, Class = class } or data

	local item = itemstore.Item(dropClass, tbl)
	if (!item) then return end

    ply.Inventory:AddItem(item)
end)

VoidFactions.Inventories:AddInventory(INVENTORY)
--addons/voidfactions-1.10.6/lua/voidfactions/vgui/main_panel.lua:
return gluapack()()
--addons/voidfactions-1.10.6/lua/voidfactions/vgui/admin/faction_list_select.lua:

local sc = VoidUI.Scale
local L = VoidFactions.Lang.GetPhrase

local PANEL = {}

function PANEL:Init()

	self:SetOrigSize(270, 506)

	local rowPanel = self:Add("VoidUI.RowPanel")
	rowPanel:Dock(FILL)
	rowPanel:SDockMargin(0, 0, 0, 10)
	rowPanel.defaultColor = VoidUI.Colors.TextGray
	rowPanel.hoverColor = VoidUI.Colors.GrayText

	rowPanel:SetSpacing(0)

	local addButton = self:Add("VoidUI.Button")
	addButton:Dock(BOTTOM)
	addButton:MarginSides(10)
	addButton:MarginBottom(10)
	addButton:SetText(L"addFaction")
	addButton:SetFont("VoidUI.R22")
	addButton:SetColor(VoidFactions.UI.Accent)
	addButton.DoClick = function ()
		local frame = vgui.Create("VoidFactions.UI.FactionCreate")
		frame:SetParent(self)
	end
        
	local ply = LocalPlayer()
	if (!CAMI.PlayerHasAccess(ply, "VoidFactions_EditFactions")) then
		addButton:SetEnabled(false)
	end

	self.rowPanel = rowPanel
	self.addButton = addButton

	self.selectedFaction = nil
end

function PANEL:OnSelect(faction)

end

function PANEL:SetFactions(factions)

	self.rowPanel:Clear()
	local rootFactions = VoidFactions.Utils:BuildSubfactions(factions)

	self:AddFaction({
		id = 0,
		name = L"rankTemplate"
	}, true, false, false, true)

	for _, faction in pairs(rootFactions) do
		self:AddFaction(faction, true, false, false)
		for k, v in pairs(faction.subfactions or {}) do
			self:AddFaction(v, false, true, false)
			for _, p in pairs(v.subfactions or {}) do
				self:AddFaction(p, false, false, true)
			end
		end
	end
end

function PANEL:AddFaction(faction, isRoot, isFaction, isSubfaction, isTemplate)
	local this = self
	local panel = self.rowPanel:Add("DButton")
	panel:SetText("")
	panel.Paint = function (self, w, h)
		if (self:IsHovered() or (this.selectedFaction and this.selectedFaction.id == faction.id) ) then
			if (this.selectedFaction and this.selectedFaction.id == faction.id) then
				draw.RoundedBox(8, 0, 0, w, h, VoidFactions.UI.Accent)
			else
				draw.RoundedBox(8, 0, 0, w, h, VoidUI.Colors.TextGray)
			end
		end

		if (isRoot) then
			draw.SimpleText(string.upper(faction.name), isTemplate and "VoidUI.B24" or "VoidUI.B28", sc(10), h/2-1, VoidUI.Colors.Gray, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER)
		end
		if (isFaction) then
			local dotSize = 4
			draw.RoundedBox(4, sc(15), h/2-dotSize/2+1, dotSize, dotSize, VoidUI.Colors.Gray)
			draw.SimpleText(faction.name, "VoidUI.R24", sc(25), h/2-1, VoidUI.Colors.Gray, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER)
		end
		if (isSubfaction) then
			draw.SimpleText(faction.name, "VoidUI.R20", sc(35), h/2-1, VoidUI.Colors.Gray, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER)
		end
	end

	panel.DoClick = function ()
		local _faction = VoidFactions.LoadedFactions[faction.id] -- We need to use the original reference
		self.selectedFaction = _faction or faction
		self:OnSelect(faction, isTemplate)
	end

	local function duplicatePopup()
		local popup = vgui.Create("VoidUI.Popup")
		popup:SetText(L"duplicate", L("duplicate_confirm", { faction = faction.name }))

		popup:Continue(L"duplicate", function (val)
			PrintTable(faction)
			VoidFactions.Faction:UpdateStaticFaction(nil, faction.name .. " (copy)", faction.tag, faction.parentFaction and faction.parentFaction.id, faction.color, faction.maxMembers, faction.logo or "", faction.inviteRequired, faction.canCaptureTerritory, faction.showOnBoard, faction.isDefaultFaction, faction.description, faction.requiredUsergroups)
		end)
		
		popup:Cancel(L"cancel")
	end

	local origPress = panel.OnMousePressed
	panel.OnMousePressed = function (s, keycode)
		origPress(s, keycode)

		if (keycode == MOUSE_RIGHT) then
			local ctxMenu = VoidUI:CreateDropdownPopup()

			local duplicate = ctxMenu:AddOption(L"duplicate", function ()
				duplicatePopup()
			end)

			ctxMenu.y = ctxMenu.y - 15
			ctxMenu.x = ctxMenu.x + 10
		end
	end

	self.rowPanel:AddRow(panel)

	if (isTemplate) then
		panel:MarginBottom(10)
	end
end

function PANEL:PerformLayout(w, h)
	self.addButton:SSetTall(40, self)
end

vgui.Register("VoidFactions.UI.FactionListSelect", PANEL, "VoidUI.BackgroundPanel")

--addons/voidfactions-1.10.6/lua/voidfactions/vgui/admin/faction_settings.lua:
return gluapack()()
--addons/voidfactions-1.10.6/lua/voidfactions/vgui/admin/intro_panel.lua:
local sc = VoidUI.Scale

local text = [[
Thank you for :state: VoidFactions.
Please select your faction type below in order to continue.
]]

local PANEL = {}

function PANEL:Init()
    self:SetOrigSize(1000, 600)

    local setup = self:Add("VoidFactions.UI.SetupPanel")
    setup:Dock(FILL)
    setup:SetVisible(true)

    local state = "purchasing"
    if (string.find(VoidFactions.CurrentVersion, "beta")) then
        state = "beta testing"
    end
    if (string.find(VoidFactions.CurrentVersion, "alpha")) then
        state = "alpha testing"
    end

    self.text = VoidLib.StringFormat(text, state)

    setup.staticCard.button.DoClick = function ()
        VoidFactions.Settings:UpdateConfig("FactionType", VOIDFACTIONS_STATICFACTIONS)

        self:Finalize(VOIDFACTIONS_STATICFACTIONS)
    end
    setup.dynamicCard.button.DoClick = function ()
        VoidFactions.Settings:UpdateConfig("FactionType", VOIDFACTIONS_DYNAMICFACTIONS)

        self:Finalize(VOIDFACTIONS_DYNAMICFACTIONS)
    end

    self.setup = setup
end

function PANEL:Finalize(fType)
    local panel = self:GetParent()
    panel:Remove()

    VoidFactions.Config.FactionType = fType

    VoidLib.Notify("Success", "VoidFactions has been set up and is now ready to use.", VoidUI.Colors.Green, 5)
    VoidFactions.Menu:Open()
end

function PANEL:Paint(w, h)
    draw.DrawText(self.text, "VoidUI.R32", w/2, sc(20), VoidUI.Colors.Gray, TEXT_ALIGN_CENTER)
end


function PANEL:PerformLayout(w, h)
    self.setup:MarginTop(60, self)
end


vgui.Register("VoidFactions.UI.IntroPanel", PANEL, "VoidUI.PanelContent")
--addons/voidfactions-1.10.6/lua/voidfactions/vgui/dynamic/rewards_panel.lua:
return gluapack()()
--lua/autorun/williams_suitnrobbersinit.lua:
return gluapack()()
--lua/wos/dynabase/registers/ctaunt_register.lua:
return gluapack()()
--addons/xenin_framework/lua/xeninui/libs/icon_dl.lua:
return gluapack()()
--addons/xenin_framework/lua/xeninui/libs/scripts/main.lua:
local Scripts
do
  local _class_0
  local _base_0 = {
    __name = "Scripts",
    checkScriptVersions = function(self, tbl)
      local scripts = self:getAll()
      local needUpdate = {}

      for i, v in pairs(scripts) do
        if (!v.versionCheck) then continue end

        local tblVersion = tbl[v.id]
        local version = tonumber(v.version)
        if (!isnumber(version)) then continue end
        if (!isnumber(tblVersion)) then continue end

        if (tblVersion and version < tblVersion) then
          needUpdate[v.id] = {
            name = v.name,
            version = tblVersion,
            currentVersion = v.version
          }
        end
      end

      local msgs = {}
      for i, v in pairs(needUpdate) do
        table.insert(msgs, {
          XeninUI.Theme.Accent,
          "[Xenin " .. tostring(v.name) .. "] ",
          Color(255, 255, 255),
          "Please update to ",
          XeninUI.Theme.Green,
          "version " .. tostring(v.version),
          Color(255, 255, 255),
          " you are on ",
          XeninUI.Theme.Red,
          "version " .. tostring(v.currentVersion)
        })
      end
      local targets = {}
      for i, v in ipairs(player.GetAll()) do
        if (XeninUI.Permissions:canAccessFramework(v) or XeninUI.Permissions:isAdmin(v)) then
          table.insert(targets, v)
        end
      end

      XeninUI.ScriptsNetwork:sendUpdateMessage(targets, msgs)

      for i, v in ipairs(msgs) do
        table.insert(v, "\n")

        MsgC(unpack(v))
      end
    end,
    register = function(self, id, name, version, author, tbl)
      if tbl == nil then tbl = {}
      end
      local script = {
        id = id,
        name = name,
        author = author,
        version = version
      }

      table.Merge(script, tbl)

      self.scripts[id] = script
    end,
    setAll = function(self, tbl)
      self.scripts = tbl
    end,
    get = function(self, id)
      return self.scripts[id]
    end,
    getAll = function(self)
      return self.scripts
    end,
    getByName = function(self, name)
      for i, v in pairs(self.scripts) do
        if (v.name != name) then continue end

        return name
      end
    end,
    __type = function(self)
      return "XeninUI.Scripts"end
  }
  _base_0.__index = _base_0
  _class_0 = setmetatable({
    __init = function(self)
      self.scripts = {}
      if (CLIENT) then return end

      timer.Create("Xenin.Framework.Version", 600, 0, function()
        http.Fetch("https://gitlab.com/sleeppyy/xenin-version-tracker/-/raw/master/versions.json", function(body, size, headers, code)
          if (code >= 400) then return end
          if (size == 0) then return end
          local tbl = util.JSONToTable(body)
          if (!tbl) then return end

          self:checkScriptVersions(tbl)
        end)
      end)
    end,
    __base = _base_0
  }, {
    __index = _base_0,
    __call = function(cls, ...)
      local _self_0 = setmetatable({}, _base_0)
      cls.__init(_self_0, ...)
      return _self_0
    end
  })
  Scripts = _class_0
end

XeninUI.Scripts = Scripts()

--addons/xenin_framework/lua/xeninui/libs/configurator/network/client.lua:
local Network
do
  local _class_0
  local _parent_0 = XeninUI.Network
  local _base_0 = {
    __name = "Network",
    __base = XeninUI.Network.__base,
    receiveSettings = function(self, ply)
      local script = net.ReadString()
      local size = net.ReadUInt(12)
      XeninUI.Configurator:PrintMessage("Received settings for the addon '" .. tostring(script) .. "', size: " .. tostring(size))
      local controller = XeninUI.Configurator:FindControllerByScriptName(script)
      for i = 1, size do
        local id = net.ReadString()
        local val = self:read()

        controller:set(id, val)
      end
    end,
    sendSaveSettings = function(self, script, tbl)
      local __laux_type = (istable(script) and script.__type and script:__type()) or type(script)
      assert(__laux_type == "string", "Expected parameter `script` to be type `string` instead of `" .. __laux_type .. "`")
      local __laux_type = (istable(tbl) and tbl.__type and tbl:__type()) or type(tbl)
      assert(__laux_type == "table", "Expected parameter `tbl` to be type `table` instead of `" .. __laux_type .. "`")
      self:send("SaveSettings", function(self)
        local size = table.Count(tbl)
        net.WriteString(script)
        net.WriteUInt(size, 12)
        for i, v in pairs(tbl) do
          net.WriteString(i)
          self:write(v)
        end
      end)
    end,
    sendSaveSetting = function(self, script, id, val)
      local __laux_type = (istable(script) and script.__type and script:__type()) or type(script)
      assert(__laux_type == "string", "Expected parameter `script` to be type `string` instead of `" .. __laux_type .. "`")
      local __laux_type = (istable(id) and id.__type and id:__type()) or type(id)
      assert(__laux_type == "string", "Expected parameter `id` to be type `string` instead of `" .. __laux_type .. "`")
      self:send("SaveSetting", function(self)
        net.WriteString(script)
        net.WriteString(id)
        self:write(val)
      end)
    end,
    sendGetEntities = function(self, entity, limit, offset, search)
      if limit == nil then limit = 10
      end
      if offset == nil then offset = 0
      end
      if search == nil then search = ""
      end
      local __laux_type = (istable(entity) and entity.__type and entity:__type()) or type(entity)
      assert(__laux_type == "XeninUI.Configurator.Entity", "Expected parameter `entity` to be type `XeninUI.Configurator.Entity` instead of `" .. __laux_type .. "`")
      local ent = entity:getDatabaseEntity()

      self:send("GetEntities", function(self)
        net.WriteString(ent)
        net.WriteUInt(limit, 16)
        net.WriteUInt(offset, 16)
        net.WriteString(search)
      end)
    end,
    sendSaveEntity = function(self, entity)
      self:send("SaveEntity", function(self)
        net.WriteString(entity:getDatabaseEntity())
        entity:onNetworkSend()
      end)
    end,
    sendCreateEntity = function(self, entity)
      self:send("CreateEntity", function(self)
        net.WriteString(entity:getDatabaseEntity())
        entity:onNetworkSend()
      end)
    end,
    sendDeleteEntity = function(self, entity)
      self:send("DeleteEntity", function(self)
        net.WriteString(entity:getDatabaseEntity())
        entity:onNetworkSend()
      end)
    end,
    receiveCreateEntity = function(self, entity)
      local entity = net.ReadString()
      local ent = XeninUI.Configurator.Entities:create(entity)
      ent:onNetworkReceive()
      ent:save()

      hook.Run("XeninUI.Configurator.CreatedEntity", ent)
    end,
    receiveEntity = function(self, ply)
      local entity = net.ReadString()
      local ent = XeninUI.Configurator.Entities:create(entity)
      ent:onNetworkReceive()
      ent:save()
    end,
    receiveGetEntities = function(self, ply)
      local size = net.ReadUInt(16)
      local tbl = {}
      for i = 1, size do
        local entity = net.ReadString()
        local ent = XeninUI.Configurator.Entities:create(entity)
        ent:onNetworkReceive()

        table.insert(tbl, ent)
      end

      hook.Run("XeninUI.Configurator.GetEntities", tbl)
    end,
    __type = function(self)
      return "XeninUI.Configurator.Network"end
  }
  _base_0.__index = _base_0
  setmetatable(_base_0, _parent_0.__index)
  _class_0 = setmetatable({
    __init = function(self)
      Network.__parent.__init(self)

      self:setPrefix("XeninUI.Configuator.")

      self:receiver("Settings", self.receiveSettings)
      self:receiver("Entity", self.receiveEntity)
      self:receiver("GetEntities", self.receiveGetEntities)
      self:receiver("CreateEntity", self.receiveCreateEntity)
    end,
    __base = _base_0,
    __parent = _parent_0
  }, {
    __index = function(cls, parent)
      local val = rawget(_base_0, parent)
      if val == nil then local _parent = rawget(cls, "__parent")
        if _parent then return _parent[parent]
        end
      else
        return val
      end
    end,
    __call = function(cls, ...)
      local _self_0 = setmetatable({}, _base_0)
      cls.__init(_self_0, ...)
      return _self_0
    end
  })
  if _parent_0.__inherited then _parent_0.__inherited(_parent_0, _class_0)
  end
  Network = _class_0
end

XeninUI.Configurator.Network = Network()

--addons/xenin_framework/lua/xeninui/libs/configurator/ui/frame.lua:
return gluapack()()
--addons/xenin_framework/lua/xeninui/libs/configurator/ui/inputs.lua:
return gluapack()()
--addons/xenin_framework/lua/xeninui/libs/configurator/ui/entities/entity_grid.lua:
return gluapack()()
--addons/xenin_framework/lua/xeninui/libs/configurator/ui/entities/entity_list_row.lua:
return gluapack()()
--addons/xenin_framework/lua/xeninui/libs/configurator/ui/inputs/range.lua:
local x

--addons/xenin_framework/lua/xeninui/elements/query_single_button.lua:
return gluapack()()
--addons/xenin_framework/lua/xeninui/elements/wyvern_scrollbar.lua:
return gluapack()()
--addons/xenin_framework/lua/xeninui/elements/wyvern_scrollbar.lua:
local PANEL = {}

AccessorFunc(PANEL, "m_bVisibleFullHeight", "VisibleFullHeight", FORCE_BOOL)

function PANEL:Init()
    self.Offset = 0
    self.Scroll = 0
    self.CanvasSize = 1
    self.BarSize = 1

    self.scrollbar = vgui.Create("DScrollBarGrip", self)
    self.scrollbar.Paint = function(pnl, w, h)
        surface.SetDrawColor(255, 255, 255, 20)
        surface.DrawRect(0, 0, w, h)
    end

    self:SetSize(4, 4)

    self.scrollDelta = delta

    self:SetVisibleFullHeight(false)
end

function PANEL:SetEnabled(b)
    if not b then
        self.Offset = 0
        self:SetScroll(0)
        self.HasChanged = true
    end

    self:SetMouseInputEnabled(b)

    if not self:GetVisibleFullHeight() then
        self:SetVisible(b)
    end

    if self.Enabled ~= b then
        self:GetParent():InvalidateLayout()

        if self:GetParent().OnScrollbarAppear then
            self:GetParent():OnScrollbarAppear()
        end
    end

    self.Enabled = b
end

function PANEL:GetEnabled()
    return self.Enabled
end

function PANEL:Value()
    return self.Pos
end

function PANEL:BarScale()
    if self.BarSize == 0 then return 1 end

    return self.BarSize / (self.CanvasSize + self.BarSize)
end

function PANEL:SetUp(_barSize_, _canvasSize_)
    self.BarSize = _barSize_
    self.CanvasSize = math.max(_canvasSize_ - _barSize_, 1)

    self:SetEnabled(_canvasSize_ > _barSize_)

    self:InvalidateLayout()
end

function PANEL:OnMouseWheeled(dlta)
    if not self:IsVisible() then return false end

    return self:AddScroll(dlta * -2)
end

function PANEL:AddScroll(dlta)
    local oldScroll = self:GetScroll()

    dlta = dlta * 25
    self:SetScroll(oldScroll + dlta)

    return oldScroll ~= self:GetScroll()
end

function PANEL:SetScroll(scrll)
    if not self.Enabled then self.Scroll = 0 return end

    self.Scroll = math.Clamp(scrll, 0, self.CanvasSize + 75)
    self:InvalidateLayout()

    local func = self:GetParent().OnVScroll
    if func then
        func(self:GetParent(), self:GetOffset())
    else
        self:GetParent():InvalidateLayout()
    end
end

function PANEL:LimitScroll()
    if self.Scroll < 0 or self.Scroll > self.CanvasSize then
        self.Scroll = math.Clamp(self.Scroll, -75, self.CanvasSize + 75)
    end
end

function PANEL:AnimateTo(scrll, length, delay, ease)
    local anim = self:NewAnimation(length, delay, ease)
    anim.StartPos = self.Scroll
    anim.TargetPos = scrll
    anim.Think = function(anim, pnl, fraction)
        pnl:SetScroll(Lerp(fraction, anim.StartPos, anim.TargetPos))
    end
end

function PANEL:GetScroll()
    if not self.Enabled then self.Scroll = 0 end
    return self.Scroll
end

function PANEL:GetOffset()
    if not self.Enabled then return 0 end
    return self.Scroll * -1
end

function PANEL:Think() end

function PANEL:OnMousePressed()
    local x, y = self:CursorPos()

    local pageSize = self.BarSize

    if y > self.scrollbar.y then
        self:SetScroll(self:GetScroll() + pageSize)
    else
        self:SetScroll(self:GetScroll() - pageSize)
    end
end

function PANEL:OnMouseReleased()
    self.Dragging = false
    self.DraggingCanvas = nil
    self:MouseCapture(false)

    self.scrollbar.Depressed = false
end

function PANEL:OnCursorMoved(x, y)
    if not self.Enabled or not self.Dragging then return end

    local x = 0
    local y = gui.MouseY()
    local x, y = self:ScreenToLocal(x, y)

    y = y - self.HoldPos

    local trackSize = self:GetTall() - self.scrollbar:GetTall()
    y = y / trackSize

    self:SetScroll(math.Clamp(y * self.CanvasSize, 0, self.CanvasSize))
end

function PANEL:Grip()
    if not self.Enabled or self.BarSize == 0 then return end

    self:MouseCapture(true)
    self.Dragging = true

    local x, y = 0, gui.MouseY()
    local x, y = self.scrollbar:ScreenToLocal(x, y)
    self.HoldPos = y

    self.scrollbar.Depressed = true
end

function PANEL:PerformLayout(w, h)
    self:LimitScroll()

    local scroll = self:GetScroll() / self.CanvasSize
    local barSize = math.max(self:BarScale() * self:GetTall(), 10)
    local track = self:GetTall() - barSize
    track = track + 1

    scroll = scroll * track

    local barStart = math.max(scroll, 0)
    local barEnd = math.min(scroll + barSize, self:GetTall())

    self.scrollbar:SetPos(0, barStart)
    self.scrollbar:SetSize(w, barEnd - barStart)
end


function PANEL:Paint(w, h) end

vgui.Register("XeninUI.Scrollbar.Wyvern", PANEL, "Panel")

--addons/xenin_framework/lua/xeninui/libs/units/classes/result.lua:
return gluapack()()
--addons/xenin-coinflip/lua/coinflip/essentials/config_wrapper.lua:
local CONFIG = {}

function CONFIG:Init()
  Coinflip.Config = {}
  Coinflip.Config.ChatCommands = {}
end

function CONFIG:SetChatPrefixColor(col)
  Coinflip.Config.ChatPrefixColor = col
end

function CONFIG:SetChatPrefix(str)
  Coinflip.Config.ChatPrefix = str
end

function CONFIG:SetSpeed(num)
  Coinflip.Config.StartSpeed = num
end

function CONFIG:SetMinBet(num)
  Coinflip.Config.MinBet = num
end

function CONFIG:SetMaxBet(num)
  Coinflip.Config.MaxBet = num
end

function CONFIG:SetMaxCoinflips(num)
  Coinflip.Config.MaxCoinflips = num
end

function CONFIG:SetMenuTitle(str)
  Coinflip.Config.MenuTitle = str
end

function CONFIG:SetNPCTitle(title)
  Coinflip.Config.NPCTitle = title
end

function CONFIG:SetNPCModel(model)
  Coinflip.Config.NPCModel = model
end

function CONFIG:SetNPCIcon(icon)
  assert(type(icon) == "IMaterial" or icon == nil, "You need to use a Material!")

  Coinflip.Config.NPCIcon = icon
end

function CONFIG:SetNPCOutlineColor(color)
  Coinflip.Config.NPCOutlineColor = color
end

function CONFIG:SetCreationAnnouncementDisabled(bool)
  Coinflip.Config.DisableCreationAnnouncement = bool
end

function CONFIG:SetWinAnnouncementDisabled(bool)
  Coinflip.Config.DisableWinAnnouncement = bool
end

function CONFIG:SetSeedRegularly(bool)
  Coinflip.Config.SeedRegularly = bool
end

function CONFIG:SetOldCurrency(curr)
  Coinflip.Config.OldCurrency = curr
end

function CONFIG:SetCurrency(currs)
  Coinflip.Config.Currency = currs
end

function CONFIG:SetCooldownBetweenCreation(num)
  Coinflip.Config.CooldownBetweenCreation = num
end

function CONFIG:SetBanSpammers(bool)
  Coinflip.Config.BanSpammers = bool
end

function CONFIG:SetLanguage(lang, tbl)
  Coinflip.i18n:setLanguage(lang, tbl)
end

function CONFIG:AddChatCommand(cmd)
  Coinflip.Config.ChatCommands[cmd] = true
end

function Coinflip:CreateConfig()
  local tbl = table.Copy(CONFIG)
  tbl:Init()

  return tbl
end
--addons/xenin-coinflip/lua/coinflip/currencies/ps2.lua:
local CURRENCY = {}
CURRENCY.Name = "Points"

function CURRENCY:Add(ply, amt)
	ply:PS2_AddStandardPoints(amt)
end
function CURRENCY:CanAfford(ply, amt)
	return ply.PS2_Wallet.points >= amt
end
function CURRENCY:Format(amt)
	return string.Comma(amt) .. " points"
end

Coinflip:CreateCurrency("Pointshop 2", CURRENCY)
--addons/xenin-inventory/lua/inventory/classes/item.lua:
--[[
This code was generated by LAUX, a Lua transpiler
LAUX is a fork of LAU with additional changes.

More info & source code can be found at: https://gitlab.com/sleeppyy/laux
]]

local ITEM = {}
ITEM.Actions = {}

function ITEM:AddAction(name, sortOrder, action, pre, post)
  self.Actions[name] = {
    SortOrder = sortOrder,
    Pre = pre or function()
      return true end,
    Action = action,
    Post = post or function() end
  }
end

function ITEM:Pickup(ply, ent, tbl)
  local dist = ply:GetPos():Distance(ent:GetPos())
  if (dist > 100) then return end
  local inv = ply:XeninInventory()
  local amt = table.Count(inv:GetInventory())
  local slots = inv:GetSlots()
  if (amt >= slots) then return end

  inv:Add(tbl.ent, tbl.dropEnt, tbl.model, tbl.amount, tbl.data)

  ent:Remove()
end

function ITEM:OnPickup(ply, ent)
  if (!IsValid(ent)) then return end

  local info = {
    ent = self:GetClass(ent),
    dropEnt = ent:GetClass(),
    amount = ent.Getamount and ent:Getamount() or 1,
    data = self:GetData(ent)
  }
  self:Pickup(ply, ent, info)

  return true
end

function ITEM:GetClass(ent)
  return ent:GetClass()
end

function ITEM:GetAmount()
  return self.data and (self.data.amount or self.data.Amount or 0) or 0
end

function ITEM:GetVisualAmount()
  return nil
end

function ITEM:CanPickUp(ent)
  if (ent.locked or ent.USED or ent.IsMerging or ent.Removed or ent.Removing or ent.hasMerged) then
    return false, "The entity is busy, please try again in a second"
  end
end

function ITEM:GetData()

  return self.data or {}
end

function ITEM:GetName(ent)
  if isentity(ent) then
    ent = {
    ent = ent:GetClass() }
  elseif isstring(ent) then
    ent = {
    ent = ent }
  end

  if (!ent.ent) then return "Unknown name"end

  local entName = scripted_ents.Get(ent.ent) and scripted_ents.Get(ent.ent).PrintName
  if (!entName) then
    entName = weapons.Get(ent.ent) and weapons.Get(ent.ent).PrintName
  end

  if entName then return entName end

  return ent or ""
end

function ITEM:GetRarity(ent)
  return self.Rarity or XeninInventory:GetRarity(ent)
end

function ITEM:Register(name)
  XeninInventory:AddItem(name, self)
end

function ITEM:GetModel(ent)
  local oldTbl
  if istable(ent) then oldTbl = ent ent = ent.ent end

  if self.Model then return self.Model end

  if oldTbl then
    if oldTbl.data then
      local mdl = oldTbl.data.model or oldTbl.data.Model

      if mdl then return mdl end
    end
  end

  if IsEntity(ent) then
    ent = ent.GetWeaponClass and ent:GetWeaponClass() or ent:GetClass()
  end

  if isstring(ent) then
    local entClass
    if IsEntity(ent) then
      entClass = ent.GetWeaponClass and ent:GetWeaponClass() or ent:GetClass()
    elseif isstring(ent) then
      entClass = ent
    end

    local wep = weapons.Get(entClass)
    local mdl = wep and (wep.WorldModel or wep.WM or wep.ViewModel)
    if mdl then return mdl end
    local sEnt = scripted_ents.Get(entClass)
    mdl = sEnt and (sEnt.Model or sEnt.WorldModel or sEnt.WM or sEnt.ViewModel)
    if mdl then return mdl end
  end

  return (isentity(ent) and nt:GetClass() or tostring(ent)) .. "mdl"
end

function XeninInventory:CreateItem()
  return table.Copy(ITEM)
end

--addons/xenin-inventory/lua/inventory/classes/itemv2.lua:
--[[
This code was generated by LAUX, a Lua transpiler
LAUX is a fork of LAU with additional changes.

More info & source code can be found at: https://gitlab.com/sleeppyy/laux
]]

local ITEM = XeninInventory:CreateItem()
ITEM.V2 = true
ITEM.DROP = 0
ITEM.DROP_AMOUNT = 1
ITEM.DROP_ALL = 2
ITEM.DROPStrings = {
  [ITEM.DROP] = "Drop",
  [ITEM.DROP_AMOUNT] = "Drop Amount",
  [ITEM.DROP_ALL] = "Drop All"
}

ITEM.Hover = "XeninInventory.Hover.V2"

function ITEM:AddEquip(func, check)
  self:AddAction("Equip", 1, function(self, ply, ent, tbl)
    if func then func(self, ply, tbl)end
  end, check)
end

function ITEM:SetHover(str)
  self.Hover = str
end

function ITEM:SetDescription(desc)
  self.Description = desc
end

function ITEM:SetModel(mdl)
  self.Model = mdl
end

function ITEM:SetMaxStack(maxStack)
  self.MaxStack = maxStack
end

function ITEM:SetName(name)
  self.GetName = function(self)
    return name
  end
end

function ITEM:GetSkin(tbl)
  return nil
end

function ITEM:GetBodygroup(tbl)
  return nil, nil
end

function ITEM:GetClientsideModel(tbl, mdlPanel) end

function ITEM:AddUse(func, check)
  self:AddAction("Use", 1, function(self, ply, ent, tbl)
    if func then func(self, ply, tbl)end
  end, check)
end

function ITEM:AddDrop(post, type)
  type = type or ITEM.DROP
  local str = self.DROPStrings[type]

  self:AddAction(str, type == ITEM.DROP and 2 or 3, function(self, ply, ent, tbl)
    local trace = {}
    trace.start = ply:EyePos()
    trace.endpos = trace.start + ply:GetAimVector() * 85
    trace.filter = ply

    local amt = tbl.data.amount or tbl.data.Amount or tbl.amount
    local tr = util.TraceLine(trace)
    local ent = ents.Create(tbl.dropEnt)
    ent:SetPos(tr.HitPos)
    ent:SetModel(self:GetModel(tbl.ent))
    ent:Spawn()
    
    if post then
      post(self, ply, ent, tbl, tr, amt)
    end
  end)
end

function ITEM:CanStack(newItem, invItem)
  return true
end

function ITEM:GetEntityClass(ent)
  return ent:GetClass()
end

function ITEM:GetDropEntityClass(ent)
  return ent:GetClass()
end

function ITEM:GetEntityAmount(ent)
  return 1
end

function ITEM:OnPickup(ply, ent)
  if (!IsValid(ent)) then return end

  local info = {
    ent = self:GetEntityClass(ent),
    dropEnt = self:GetDropEntityClass(ent),
    amount = self:GetEntityAmount(ent),
    data = self:GetData(ent)
  }

  self:Pickup(ply, ent, info)

  return true
end

function XeninInventory:CreateItemV2()
  return table.Copy(ITEM)
end

if CLIENT then
  local PANEL = {}

  XeninUI:CreateFont("XeninInventory.Hover.Title", 22)
  XeninUI:CreateFont("XeninInventory.Hover.Subtitle", 18)
  XeninUI:CreateFont("XeninInventory.Weapons.Hover.Stats", 16)

  function PANEL:SetInfo(tbl)
    self.Alpha = 0
    self:LerpAlpha(255, 0.15)

    local item = XeninInventory:GetItem(tbl.dropEnt)
    local name = item and item:GetName(tbl)
    local data = tbl.data
    local rarity = XeninInventory:GetRarity(tbl)

    self.title = name
    self.rarity = rarity
    local cat = XeninInventory.Config.Categories[rarity]
    if cat then
      self.cat = cat
    end

    self.desc = isstring(item.Description) and item.Description or isfunction(item.Description) and item:Description(tbl, self.parent)
  end

  function PANEL:Paint(w, h)
    local aX, aY = self:LocalToScreen()
    BSHADOWS.BeginShadow()
    draw.RoundedBox(6, aX, aY, w, h, XeninUI.Theme.Primary)
    BSHADOWS.EndShadow(1, 2, 2)

    local y = 6
    local x = 8
    XeninUI:DrawShadowText(self.title, "XeninInventory.Hover.Title", x, y, self.cat and self.cat.color or color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_TOP, 1, 125)
    y = y + draw.GetFontHeight("XeninInventory.Hover.Title")

    if isstring(self.desc) then
      XeninUI:DrawShadowText(self.desc, "XeninInventory.Hover.Subtitle", x, y, Color(182, 182, 182), TEXT_ALIGN_LEFT, TEXT_ALIGN_TOP, 1, 100)
    else
      for i, v in ipairs(self.desc or {}) do
        local str = "No string"
        local font = "XeninInventory.Hover.Subtitle"
        local color = Color(182, 182, 182)
        local space = 0

        if istable(v) then
          str = v.str or "No string"
          font = v.font or "XeninInventory.Hover.Subtitle"
          color = v.color or Color(182, 182, 182)
          space = v.space or 0
        else
          str = v
        end

        surface.SetFont(font)
        local tw, th = surface.GetTextSize(str)

        XeninUI:DrawShadowText(str, font, x, y, color, TEXT_ALIGN_LEFT, TEXT_ALIGN_TOP, 1, 100)

        y = y + th + space
      end
    end
  end

  function PANEL:PerformLayout(w, h)
    surface.SetFont("XeninInventory.Hover.Title")
    local tw, th = surface.GetTextSize(self.title or "")
    local width = tw + 16
    local height = 16 + th

    if isstring(self.desc) then
      surface.SetFont("XeninInventory.Hover.Subtitle")
      local tw, th = surface.GetTextSize(self.desc)
      width = math.max(width, tw + 16)
      height = height + th
    else
      for i, v in ipairs(self.desc or {}) do
        local str = "No string"
        local font = "XeninInventory.Hover.Subtitle"
        local color = Color(182, 182, 182)
        local space = 0

        if istable(v) then
          str = v.str or "No string"
          font = v.font or "XeninInventory.Hover.Subtitle"
          color = v.color or Color(182, 182, 182)
          space = v.space or 0
        else
          str = v
        end

        surface.SetFont(font)
        local tw, th = surface.GetTextSize(str)
        width = math.max(width, tw + 16)
        height = height + th + space
      end
    end

    self:SetSize(width, height)
  end

  vgui.Register("XeninInventory.Hover.V2", PANEL)
end

--addons/xenin-inventory/lua/inventory/languages/turkish.lua:
local LANG = {
	["ConCommand.Drop"] = ":item: bırakıldı",
	["ConCommand.DropAll"] = ":amount:x :item: bırakıldı",
	["ConCommand.Destroy"] = ":amount:x :item: yok edildi",
	["ConCommand.Destroy.Popup.Title"] = ":item: Yok Et",
	["ConCommand.Destroy.Popup.Desc"] = ":item: eşyasını yok etmek istediğine emin misin?",
	["ConCommand.Destroy.Popup.Yes"] = "Evet",
	["ConCommand.Destroy.Popup.No"] = "Hayır",

	["ChatCommand.Holster.Unable"] = "Envanterinde yeterince alan bulunmadığı için bu silahı kılıfına koyamıyorsun",
	["ChatCommand.Blacklisted"] = "Bu eşya kara listede",
	["ChatCommand.AccessRestricted"] = "Şu anda envanterine erişimin kısıtlı.",

	["Bank.Title"] = "Envanter - Banka",
	["XeninInventory.Title"] = "Envanter",

	-- Tabs
	["XeninInventory.Tabs.XeninInventory"] = "ENVANTER",

	-- Actions
	["XeninInventory.Popup.Equip"] = "Kuşan",
	["XeninInventory.Popup.Drop"] = "At",
	["XeninInventory.Popup.Drop All"] = "Hepsini At",
	["XeninInventory.Popup.Destroy"] = "Yok Et",
	["XeninInventory.Popup.Use"] = "Kullan",
	["XeninInventory.Popup.Drop Amount"] = "Bırakılacak Miktar",
	
	["XeninInventory.Popup.DropAmount.Error.Invalid"] = "Geçersiz sayı?",
	["XeninInventory.Popup.DropAmount.Error.TooLow"] = "Bu sayı çok az",
	["XeninInventory.Popup.DropAmount.Error.TooHigh"] = "Bu kadar bırakamazsın çünkü envanterinde bu kadar yok!",

	-- Due to some Unicode shenagians we have to make a copy that's capitalised for the actions (drop zones)
	["XeninInventory.Actions.Equip"] = "KUŞAN",
	["XeninInventory.Actions.Drop"] = "AT",
	["XeninInventory.Actions.Drop All"] = "HEPSİNİ AT",
	["XeninInventory.Actions.Destroy"] = "YOK ET",
	["XeninInventory.Actions.Use"] = "KULLAN",
	["XeninInventory.Actions.Drop Amount"] = "BIRAKILACAK MİKTAR",
	
	-- Shown in the inventory field
	["XeninInventory.Field.Amount"] = "x:amount:",
	["XeninInventory.Field.MaxAmount"] = "maks x:amount:",

	["XeninInventory.XeninInventory.Search"] = "Bir eşya ara",
	-- Refers to sorting
	["XeninInventory.XeninInventory.Unsorted"] = "Sıralanmamış",
	["XeninInventory.XeninInventory.Alphabetically"] = "Alfabetik",
	["XeninInventory.XeninInventory.WorstToBest"] = "En kötüden en iyiye",
	["XeninInventory.XeninInventory.BestToWorst"] = "En iyiden en kötüye",
	-- Hover for shipments
	["XeninInventory.Shipment.Desc"] = ":amount: silah kaldı",

	["XeninInventory.Pickup.Markup"] = ":font::color:  :/color::rarityColor::modifierKey: + :key::/color: Basarak :name: Envantere Aalabilirsin:/color::/font:",
	["XeninInventory.Pickup"] = "Envanterine :modifierKey: + :key: tuşuna basarak :name: eşyasını ekle",
	["XeninInventory.Money"] = ":money:",

	["Admin.Title"] = "Envanter Yetkilisi",
	["Admin.Tabs.Management"] = "YÖNETİM",
	["Admin.NotAdmin"] = "Bunu açabilmek için Envanter Yetkilisi olman gerekiyor!",

	["Admin.Management.Loading"] = "Yükleniyor",
	["Admin.Management.Search"] = "İsim/SteamID(64)'e göre ara",
	["Admin.Management.Searching"] = "Aranıyor",
	["Admin.Management.Online"] = "Çevrimiçi",
	["Admin.Management.Offline"] = "Çevrimdışı",
	["Admin.Management.OpenInventory"] = "Envanteri Aç",
	
	["Admin.Player.Title"] = "Oyuncu Envanteri",
	["Admin.Player.Tabs.XeninInventory"] = "ENVANTER",
	["Admin.Player.Tabs.Bank"] = "BANKA",
	["Admin.Player.Items"] = ":items: eşyalar",
	["Admin.Player.Clear.XeninInventory"] = "Envanteri Temizle",
	["Admin.Player.Clear.Bank"] = "Bankayı Temizle",
	["Admin.Player.Clear.Popup.Text"] = "Bu oyuncuya ait olan :type: alanını temizlemek istediğinize emin misiniz? Bu geri alınamaz.",
	["Admin.Player.Clear.Popup.Yes"] = "Evet, temizle",
	["Admin.Player.Clear.Popup.No"] = "Hayır",

	["Admin.Clear.Slot"] = ":type: içerisinde :id: slotunda bulunan eşyaların bir yetkili tarafından temizlendi",
	["Admin.Clear"] = "Sana ait :type: bir yetkili tarafından temizlendi",
}

XeninInventory:CreateLanguage("Turkish", LANG)
--addons/xenin-inventory/lua/inventory/configuration/items/spawned_money.lua:
--[[
This code was generated by LAUX, a Lua transpiler
LAUX is a fork of LAU with additional changes.

More info & source code can be found at: https://gitlab.com/sleeppyy/laux
]]

local ITEM = XeninInventory:CreateItem()
ITEM.Hover = "XeninInventory.Money.Hover"
ITEM.MaxStack = 2 ^ 64
ITEM.DontDisplayAmount = true

ITEM:AddAction("Drop Amount", 1, function(self, ply, ent, tbl, amt)
  if CLIENT then return true end

  local trace = {}
  trace.start = ply:EyePos()
  trace.endpos = trace.start + ply:GetAimVector() * 85
  trace.filter = ply

  local tr = util.TraceLine(trace)
  local weapon = ents.Create("spawned_money")
  local model = self:GetModel()
  weapon:Setamount(amt)
  weapon:SetPos(tr.HitPos)
  weapon:Spawn()
end)

ITEM:AddAction("Drop All", 2, function(self, ply, ent, tbl)
  local trace = {}
  trace.start = ply:EyePos()
  trace.endpos = trace.start + ply:GetAimVector() * 85
  trace.filter = ply

  local tr = util.TraceLine(trace)
  local weapon = ents.Create("spawned_money")
  local model = self:GetModel()
  weapon:Setamount(tbl.amount or tbl.data.Amount)
  weapon:SetPos(tr.HitPos)
  weapon:Spawn()
end)

function ITEM:GetDisplayName(ent)
  if (!IsValid(ent)) then return ""end

  return self:GetName(ent)
end

function ITEM:GetName(ent)
  if istable(ent) then
    return XeninInventory:GetPhrase("XeninInventory.Money", {
    money = DarkRP.formatMoney(ent.amount or ent.data.Amount) })
  end

  return XeninInventory:GetPhrase("XeninInventory.Money", {
  money = DarkRP.formatMoney(ent:Getamount()) })
end

function ITEM:GetItem(ent)
  return ent
end

function ITEM:GetModel(ent)
  return GAMEMODE.Config.moneyModel
end

function ITEM:GetData(ent)
  return {}
end

function ITEM:OnPickup(ply, ent)
  if (!IsValid(ent)) then return end

  local info = {
    ent = ent:GetClass(),
    dropEnt = ent:GetClass(),
    amount = ent:Getamount(),
    data = self:GetData(ent)
  }
  self:Pickup(ply, ent, info)

  return true
end

ITEM:Register("spawned_money")

if CLIENT then
  local PANEL = {}

  function PANEL:SetInfo(tbl)
    self.Alpha = 0
    self:LerpAlpha(255, 0.15)

    local item = XeninInventory:GetItem(tbl.dropEnt)
    local name = item and item:GetName(tbl)
    local data = tbl.data
    local rarity = XeninInventory:GetRarity(tbl)

    self.wepTbl = weapons.Get(tbl.ent)
    self.title = name
    self.rarity = rarity
    self.data = data
    self.realData = tbl
    local tbl = XeninInventory.Config.Categories[rarity]
    if tbl then

      self.tbl = tbl
    end
  end

  function PANEL:Paint(w, h)
    local aX, aY = self:LocalToScreen()
    BSHADOWS.BeginShadow()
    draw.RoundedBox(6, aX, aY, w, h, XeninUI.Theme.Primary)
    BSHADOWS.EndShadow(1, 2, 2)

    local y = 8
    draw.SimpleText(self.title, "XeninInventory.Hover.Title", 9, 9, Color(0, 0, 0, 100), TEXT_ALIGN_LEFT, TEXT_ALIGN_TOP)
    draw.SimpleText(self.title, "XeninInventory.Hover.Title", 8, 8, self.tbl and self.tbl.color or color_white, TEXT_ALIGN_LEFT, TEXT_ALIGN_TOP)
  end

  function PANEL:PerformLayout(w, h)
    surface.SetFont("XeninInventory.Hover.Title")
    local tw, th = surface.GetTextSize(self.title or "")
    local width = tw + 16
    local height = 16 + th

    self:SetSize(width, height)
  end

  vgui.Register("XeninInventory.Money.Hover", PANEL)

  local PANEL = {}

  XeninUI:CreateFont("XeninInventory.Drop.Field", 16)

  function PANEL:Init()
    self:SetSize(ScrW(), ScrH())
    self:SetBackgroundWidth(380)
    self:SetBackgroundHeight(144)
    self:MakePopup()

    self.textentry = self.background:Add("XeninUI.TextEntry")
    self.textentry:SetPlaceholder("Amount")
    self.textentry.textentry.OnEnter = function()
      self.accept:DoClick()end
    self.textentry.textentry:RequestFocus()

    self.accept = self.background:Add("DButton")
    self.accept:SetText("Accept")
    self.accept:SetFont("XeninInventory.Drop.Field")
    self.accept:SetTextColor(Color(225, 225, 225))
    self.accept.background = XeninUI.Theme.Navbar
    self.accept.Paint = function(pnl, w, h)
      draw.RoundedBox(6, 0, 0, w, h, pnl.background)
    end
    self.accept.OnCursorEntered = function(pnl)
      pnl:LerpColor("background", XeninUI.Theme.Primary)
    end
    self.accept.OnCursorExited = function(pnl)
      pnl:LerpColor("background", XeninUI.Theme.Navbar)
    end
    self.accept.DoClick = function(pnl)
      if (!self:CheckFunction()) then return end

      self:PassedFunction()
    end
  end

  function PANEL:PerformLayout(w, h)
    self.BaseClass.PerformLayout(self, w, h)

    local w = self.background:GetWide()
    local h = self.background:GetTall()
    local x = 16
    local y = 56

    self.textentry:SetPos(x, y)
    self.textentry:SetWide(w - self.textentry.x - x)
    self.textentry:SetTall(36)

    self.accept:AlignRight(x)
    self.accept:SetPos(self.accept.x, self.textentry.y + self.textentry:GetTall() + 8)
    self.accept:SizeToContentsX(24)
    self.accept:SizeToContentsY(12)
  end

  vgui.Register("XeninInventory.DropAmount", PANEL, "XeninUI.Popup")
end

--addons/xenin-inventory/lua/inventory/configuration/items/spawned_weapon.lua:
--[[
This code was generated by LAUX, a Lua transpiler
LAUX is a fork of LAU with additional changes.

More info & source code can be found at: https://gitlab.com/sleeppyy/laux
]]

local ITEM = XeninInventory:CreateItemV2()
ITEM:SetDescription(function(self, item, ent)
  local wep = weapons.Get(item.ent)
  if (!wep) then return "Unknown weapon?"end

  local tbl = {}
  local dmg = wep.Primary.Damage
  if dmg then
    tbl[#tbl + 1] = "Damage: " .. math.Round(dmg, 2)
  end
  local magSize = wep.Primary.ClipSize
  if magSize then
    local clipSize = (item.data and item.data.Clip1 or 0) or 0
    tbl[#tbl + 1] = "Clip: " .. clipSize .. "/" .. magSize
  end
  local rpm = wep.Primary.Delay
  if rpm then
    tbl[#tbl + 1] = "RPM: " .. math.Round(60 / rpm)
  end

  return tbl
end)

ITEM:AddEquip(function(self, ply, tbl)
  if CLIENT then return true end

  local ent = tbl.ent
  local wep = ply:Give(ent, true)
  ply:SelectWeapon(ent)

  if IsValid(wep) then
    local clip1 = tbl.data.Clip1
    local clip2 = tbl.data.Clip2

    if (clip1 and clip1 != -1) then
      wep:SetClip1(clip1)
    end
    if (clip2 and clip2 != -1) then
      wep:SetClip2(clip2)
    end
  end

  return true
end, function(self, ply, slot)
  local ent = slot.ent
  local data = slot.data
  local name = self:GetName(slot)

  return !ply:HasWeapon(ent), "You already have a(n) " .. name .. " equipped"
end)

ITEM:AddDrop(function(self, ply, ent, tbl, tr)
  local mdl = self:GetModel(tbl.ent)
  ent:SetModel(mdl)
  ent:SetWeaponClass(tbl.ent)
  ent.clip1 = tbl.data.Clip1
  ent.clip2 = tbl.data.Clip2
end)

ITEM:AddDrop(function(self, ply, ent, tbl, tr, amt)
  local mdl = self:GetModel(tbl.ent)
  ent:SetModel(mdl)
  ent:SetWeaponClass(tbl.ent)
  ent:Setamount(amt or 1)
  ent.clip1 = tbl.data.Clip1
  ent.clip2 = tbl.data.Clip2
end, ITEM.DROP_ALL)

function ITEM:GetData(ent)
  return {
    Clip1 = ent.clip1,
    Clip2 = ent.clip2
  }
end

function ITEM:GetName(tbl)
  local wep = weapons.Get(tbl.ent)
  if (!wep) then return tbl.ent end

  return wep.PrintName or tbl.ent
end

function ITEM:GetEntityClass(ent)
  return ent:GetWeaponClass()
end

function ITEM:GetEntityAmount(ent)
  return ent:Getamount()
end

ITEM:Register("spawned_weapon")

--addons/zeros_retrominer_v2.3.6/lua/inventory/configuration/items/zrms_gravelcrate.lua:
/*
    Addon id: 
    Version: v2.3.6 (stable)
*/

local ITEM = XeninInventory:CreateItemV2()
ITEM:SetMaxStack(1)
ITEM:SetModel("models/Zerochain/props_mining/zrms_gravelcrate.mdl")
//ITEM:SetDescription("Used to store and sell metal bars.")

ITEM:SetDescription(function(self, tbl)
	local data = tbl.data

	local desc = ""
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

	if data.Coal and data.Coal > 0 then
		desc = desc .. "Coal: " .. tostring(data.Coal)
	end

	if data.Iron and data.Iron > 0 then
		desc = desc .. " | Iron: " .. tostring(data.Iron)
	end

	if data.Bronze and data.Bronze > 0 then
		desc = desc .. " | Bronze: " .. tostring(data.Bronze)
	end

	if data.Silver and data.Silver > 0 then
		desc = desc .. " | Silver: " .. tostring(data.Silver)
	end

	if data.Gold and data.Gold > 0 then
		desc = desc .. " | Gold: " .. tostring(data.Gold)
	end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

	return desc
end)
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 


ITEM:AddDrop(function(self, ply, ent, tbl, tr)
	local data = tbl.data
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

	ent:SetCoal(data.Coal)
	ent:SetIron(data.Iron)
	ent:SetBronze(data.Bronze)
	ent:SetSilver(data.Silver)
	ent:SetGold(data.Gold)

	zrmine.f.SetOwner(ent, ply)
end)

function ITEM:GetData(ent)
	return {
		Coal = math.Round(ent:GetCoal(),1),
		Iron = math.Round(ent:GetIron(),1),
		Bronze = math.Round(ent:GetBronze(),1),
		Silver = math.Round(ent:GetSilver(),1),
		Gold = math.Round(ent:GetGold(),1),
	}
end

function ITEM:GetDisplayName(item)
	return self:GetName(item)
end

function ITEM:GetName(item)
	local name = "Gravel Crate"

	return name
end

function ITEM:GetCameraModifiers(tbl)
	return {
		FOV = 40,
		X = 0,
		Y = -22,
		Z = 25,
		Angles = Angle(0, -190, 0),
		Pos = Vector(0, 0, -1)
	}
end

function ITEM:GetClientsideModel(tbl, mdlPanel)
	local Coal = tbl.data.Coal or 0
	local Iron = tbl.data.Iron or 0
	local Bronze = tbl.data.Bronze or 0
	local Silver = tbl.data.Silver or 0
	local Gold = tbl.data.Gold or 0

	local storedAmount = Iron + Bronze + Silver + Gold + Coal

	if (storedAmount >= zrmine.config.GravelCrates_Capacity) then
		mdlPanel.Entity:SetBodygroup(0, 3)
	elseif (storedAmount >= zrmine.config.GravelCrates_Capacity / 2) then
		mdlPanel.Entity:SetBodygroup(0, 2)
	elseif (storedAmount > 0) then
		mdlPanel.Entity:SetBodygroup(0, 1)
	elseif (storedAmount <= 0) then
		mdlPanel.Entity:SetBodygroup(0, 0)
	end

	local rTable = {
		["Coal"] = Coal,
		["Iron"] = Iron,
		["Bronze"] = Bronze,
		["Silver"] = Silver,
		["Gold"] = Gold,
	}

	local rSkin
	local HasMultipleRessources = false

	for k, v in pairs(rTable) do
		if v > 0 then
			if rSkin == nil then
				rSkin = k
			else
				HasMultipleRessources = true
				break
			end
		end
	end

	if storedAmount > 0 then
		if HasMultipleRessources then
			mdlPanel.Entity:SetSkin(0)
		else
			if rSkin == "Coal" then
				mdlPanel.Entity:SetSkin(5)
			elseif rSkin == "Iron" then
				mdlPanel.Entity:SetSkin(1)
			elseif rSkin == "Bronze" then
				mdlPanel.Entity:SetSkin(2)
			elseif rSkin == "Silver" then
				mdlPanel.Entity:SetSkin(3)
			elseif rSkin == "Gold" then
				mdlPanel.Entity:SetSkin(4)
			end
		end
	end
end

ITEM:Register("zrms_gravelcrate")
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

--addons/zeros_trashman_v1.6.3/lua/inventory/configuration/items/ztm_trashbag.lua:
return gluapack()()
--addons/xenin-inventory/lua/inventory/configuration/items/zwf_muffin.lua:
--[[
This code was generated by LAUX, a Lua transpiler
LAUX is a fork of LAU with additional changes.

More info & source code can be found at: https://gitlab.com/sleeppyy/laux
]]

local ITEM = XeninInventory:CreateItemV2()
ITEM.Name = "Muffin"
ITEM:SetMaxStack(1)
ITEM:SetModel("models/zerochain/props_weedfarm/zwf_muffin.mdl")
ITEM:SetDescription(function(self, tbl)
  if (tbl.data.WeedID != -1) then
    return "A tasty muffin with traces of weed"
  else
    return "A tasty muffin"
  end
end)

ITEM:AddDrop(function(self, ply, ent, tbl, tr)
  local data = tbl.data

  ent.WeedID = data.WeedID
  ent.WeedName = data.WeedName
  ent.WeedAmount = data.WeedAmount
  ent.WeedTHC = data.THC
  ent:SetColor(self:GetColor(tbl))
  if (ent.WeedID != -1) then
    ent:SetSkin(1)
  end
end)

function ITEM:GetData(ent)
  return {
    WeedID = ent.WeedID,
    WeedName = ent.WeedName,
    WeedAmount = ent.WeedAmount,
    THC = ent.WeedTHC
  }
end

function ITEM:GetSkin(tbl)
  if (tbl.data.WeedID != -1) then
    return 1
  end
end

function ITEM:GetColor(tbl)
  if tbl.data.WeedID then
    local plant = zwf.config.Plants[tbl.data.WeedID]
    if plant then
      return plant.color
    end
  else
    return HSVToColor(math.random(0, 360), 0.5, 0.85)
  end
end

function ITEM:GetVisualAmount(item)
  return item.data.WeedAmount
end

function ITEM:GetName(item)
  local ent = isentity(item)
  local weedName = ent and self.Name or item.data.WeedName
  local id = !ent and item.data.WeedID
  local str = weedName
  if id then
    local plant = zwf.config.Plants[id]
    if (plant and plant.name) then
      str = str .. " [" .. plant.name .. "]"
    end
  end

  return str
end

ITEM:Register("zwf_muffin")

--addons/xenin-inventory/lua/inventory/configuration/items/zwf_seed.lua:
--[[
This code was generated by LAUX, a Lua transpiler
LAUX is a fork of LAU with additional changes.

More info & source code can be found at: https://gitlab.com/sleeppyy/laux
]]

local ITEM = XeninInventory:CreateItemV2()
ITEM:SetMaxStack(1)
ITEM:SetModel("models/zerochain/props_weedfarm/zwf_weedseed.mdl")
ITEM:SetDescription(function(self, tbl)
  local data = tbl.data
  local Perf_Time = data.Perf_Time
  local Perf_Amount = data.Perf_Amount
  local Perf_THC = data.Perf_THC
  local seedData = zwf.config.Plants[data.SeedID]

  Perf_Time = 100 - (Perf_Time - 100)
  Perf_Time = Perf_Time * 0.01
  Perf_Time = seedData.Grow.Duration * Perf_Time
  Perf_Time = math.Round(Perf_Time) .. "s"

  Perf_Amount = Perf_Amount * 0.01
  Perf_Amount = seedData.Grow.MaxYieldAmount * Perf_Amount
  Perf_Amount = math.Round(Perf_Amount) .. zwf.config.UoW

  Perf_THC = Perf_THC * 0.01
  Perf_THC = seedData.thc_level * Perf_THC
  Perf_THC = math.Round(Perf_THC) .. "%"

  return {
    zwf.language.VGUI["Duration"] .. ": " .. tostring(Perf_Time),
    zwf.language.VGUI["HarvestAmount"] .. ": " .. tostring(Perf_Amount),
    zwf.language.General["THC"] .. ": " .. tostring(Perf_THC)
  }
end)

ITEM:AddDrop(function(self, ply, ent, tbl, tr)
  local data = tbl.data

  ent:SetSeedID(data.SeedID)
  ent:SetSeedName(data.SeedName)
  ent:SetPerf_Time(data.Perf_Time)
  ent:SetPerf_Amount(data.Perf_Amount)
  ent:SetPerf_THC(data.Perf_THC)
  ent:SetSeedCount(data.SeedCount)
  ent:SetSkin(zwf.config.Plants[data.SeedID].skin)

  zwf.f.SetOwnerByID(ent, data.ZWFOwner)
end)

function ITEM:GetData(ent)
  return {
    SeedID = ent:GetSeedID(),
    SeedName = ent:GetSeedName(),
    SeedCount = ent:GetSeedCount(),
    Perf_Time = ent:GetPerf_Time(),
    Perf_Amount = ent:GetPerf_Amount(),
    Perf_THC = ent:GetPerf_THC(),
    ZWFOwner = zwf.f.GetOwnerID(ent)
  }
end


function ITEM:GetSkin(tbl)
  return zwf.config.Plants[tbl.data.SeedID].skin
end

function ITEM:GetCameraModifiers(tbl)
  return {
    FOV = 40,
    X = 0,
    Y = -30,
    Z = 30,
    Angles = Angle(0, -45, -90),
    Pos = Vector(0, 0, -1.5)
  }
end

function ITEM:GetVisualAmount(item)
  return item.data.SeedCount
end



function ITEM:GetDisplayName(item)
  return self:GetName(item) .. " seeds"
end

function ITEM:GetName(item)

  return isentity(item) and item:GetSeedName() or item.data.SeedName
end

ITEM:Register("zwf_seed")

--addons/xenin-inventory/lua/inventory/importer/importers.lua:
--[[
This code was generated by LAUX, a Lua transpiler
LAUX is a fork of LAU with additional changes.

More info & source code can be found at: https://gitlab.com/sleeppyy/laux
]]

local Importers
do
    local _class_0
    local _base_0 = {
        __name = "Importers",
        setImporters = function(self, importers)
            self.importers = importers
            return self
        end,
        getImporters = function(self)
            return self.importers
        end,
        addImporter = function(self, id, importer)
            local __laux_type = (istable(importer) and importer.__type and importer:__type()) or type(importer)
            assert(__laux_type == "XeninInventory.Importer", "Expected parameter `importer` to be type `XeninInventory.Importer` instead of `" .. __laux_type .. "`")
            self.importers[id] = importer()
        end,
        getImporter = function(self, id)
            return self.importers[id]end,
        __type = function(self)
            return "XeninInventory.Importers"end
    }
    _base_0.__index = _base_0
    _class_0 = setmetatable({
        __init = function(self)
            self.importers = {}
        end,
        __base = _base_0
    }, {
        __index = _base_0,
        __call = function(cls, ...)
            local _self_0 = setmetatable({}, _base_0)
            cls.__init(_self_0, ...)
            return _self_0
        end
    })
    Importers = _class_0
end

XeninInventory.Importers = Importers()

--addons/xenin-inventory/lua/inventory/ui/context_menu.lua:
return gluapack()()
--addons/xenin-inventory/lua/inventory/ui/admin/player.lua:
return gluapack()()
--addons/yet_another_warn_system/lua/autorun/yet_another_warn_system.lua:
-- shitty table names are a small price compared to the meme of calling your
-- premium gmodstore addon people pay for and the addon you've so far put the
-- most effort into ever "yet another warn system"
YAWS = YAWS or {}

YAWS.Version = {}
YAWS.Version.Major = 2
YAWS.Version.Minor = 3
YAWS.Version.Patch = 4
YAWS.Version.Suffix = "Stable"
YAWS.Version.Release = YAWS.Version.Major .. "." .. YAWS.Version.Minor .. "." .. YAWS.Version.Patch .. " (" .. YAWS.Version.Suffix .. ")"
YAWS.Version.IsOutdated = YAWS.Version.IsOutdated or false

YAWS.Core = YAWS.Core or {}
YAWS.Language = YAWS.Language or {}
YAWS.Language.Languages = YAWS.Language.Languages or {}
YAWS.ManualConfig = YAWS.ManualConfig or {} -- file config
YAWS.ManualConfig.FullPerms = {}
YAWS.ManualConfig.Immunes = {}
YAWS.Config = YAWS.Config or {} -- in-game config
YAWS.Punishments = YAWS.Punishments or {}
YAWS.Punishments.PendingTypes = YAWS.Punishments.PendingTypes or {}
YAWS.Punishments.Types = YAWS.Punishments.Types or {}
YAWS.Permissions = YAWS.Permissions or {}

if(SERVER) then
    -- Serverside-only tables
    YAWS.ManualConfig.Database = {}
    YAWS.ManualConfig.Discord = {}

    YAWS.NetCooldown = {}
    YAWS.Database = YAWS.Database or {}
    YAWS.Warns = YAWS.Warns or {}
    YAWS.Players = YAWS.Players or {}
    YAWS.NiceServerNames = YAWS.NiceServerNames or {}
    YAWS.Convert = YAWS.Convert or {}
    YAWS.API = YAWS.API or {}

    resource.AddWorkshop("2665322617")
else
    -- Clientside-only tables
    YAWS.UI = YAWS.UI or {}
    YAWS.UI.Tabs = YAWS.UI.Tabs or {}
    YAWS.UI.StateCache = {}
    YAWS.UserSettings = YAWS.UserSettings or {}
end





-- Whole shit ton of logging functions - yeeeah I might've taken these too far. Oh well lol
-- #4dd8b3 = Color(77, 216, 179)
YAWS.Core.LogColors = {
    PrefixColor = Color(77, 216, 179),
    InfoColor = Color(148, 216, 109),
    WarnColor = Color(255, 175, 70),
    ErrorColor = Color(255, 70, 70),
    DebugColor = Color(218, 117, 228),
    TextHighlightColor = Color(144, 174, 255),
    Gray = Color(200, 200, 200),
}
function YAWS.Core.Log(prefix, prefixColor, ...)
    MsgC(YAWS.Core.LogColors.PrefixColor, "[YAWS] ", prefixColor, prefix, " >> ", color_white, unpack({...}))
    MsgC("\n")
end
function YAWS.Core.LogInfo(...)
    YAWS.Core.Log("INFO", YAWS.Core.LogColors.InfoColor, unpack({...}))
end
function YAWS.Core.LogWarning(...)
    YAWS.Core.Log("WARN", YAWS.Core.LogColors.WarnColor, unpack({...}))
end
function YAWS.Core.LogError(...)
    YAWS.Core.Log("ERROR", YAWS.Core.LogColors.ErrorColor, unpack({...}))
end
function YAWS.Core.LogDebug(...)
    YAWS.Core.Log("DEBUG", YAWS.Core.LogColors.DebugColor, unpack({...}))
end
function YAWS.Core.Space()
    -- lol
    print("")
end
function YAWS.Core.Divider(short)
    if(short) then
        return "---------------------------------------"
    end
    return "------------------------------------------------------------------------------------"
end
function YAWS.Core.CenterDividerText(text, short)
    local length = ((short && 39 || 84) - #text) / 2
    return string.rep(" ", length) .. text .. string.rep(" ", length)
end


YAWS.Core.Space()
YAWS.Core.LogInfo(YAWS.Core.Divider(true))
YAWS.Core.LogInfo(YAWS.Core.CenterDividerText("Loading Yet Another Warning System", true))
YAWS.Core.LogInfo(YAWS.Core.Divider(true))
YAWS.Core.LoadClock = os.clock()
function YAWS.Core.RecursiveLoad(folder, depth) -- yes, depth is just for the visuals.
    -- Load the files in that directory first.
    if(SERVER) then
        for k,v in ipairs(file.Find(folder .. "/sv*.lua", "LUA")) do
            YAWS.Core.LogInfo(string.rep("  ", depth + 1) .. "> " .. v)
            include(folder .. "/" .. v)
        end
        for k,v in ipairs(file.Find(folder .. "/sh*.lua", "LUA")) do
            YAWS.Core.LogInfo(string.rep("  ", depth + 1) .. "> " .. v)
            include(folder .. "/" .. v)
            AddCSLuaFile(folder .. "/" .. v)
        end
        for k,v in ipairs(file.Find(folder .. "/cl*.lua", "LUA")) do
            YAWS.Core.LogInfo(string.rep("  ", depth + 1) .. "> " .. v)
            AddCSLuaFile(folder .. "/" .. v)
        end
    else
        for k,v in ipairs(file.Find(folder .. "/sh*.lua", "LUA")) do
            YAWS.Core.LogInfo(string.rep("  ", depth + 1) .. "> " .. v)
            include(folder .. "/" .. v)
        end
        for k,v in ipairs(file.Find(folder .. "/cl*.lua", "LUA")) do
            YAWS.Core.LogInfo(string.rep("  ", depth + 1) .. "> " .. v)
            include(folder .. "/" .. v)
        end
    end

    -- Find the others
    local _,dirs = file.Find(folder .. "/*", "LUA")
    for k,v in ipairs(dirs) do
        YAWS.Core.LogInfo(YAWS.Core.LogColors.Gray, string.rep("  ", depth + 1) .. v)
        YAWS.Core.RecursiveLoad(folder .. "/" .. v, depth + 1)
    end
end
YAWS.Core.RecursiveLoad("yaws", 0)

YAWS.Core.LogInfo("------------------------------------")
YAWS.Core.LogInfo("Core files loaded in " .. math.Round(os.clock() - YAWS.Core.LoadClock, 4) .. " seconds.")
YAWS.Core.Space()
YAWS.Core.LoadClock = nil
hook.Run("yaws.core.initalize")

if(!ulx && !sam && !xAdmin) then
    YAWS.Core.Space()
    YAWS.Core.LogWarning(YAWS.Core.Divider())
    YAWS.Core.LogWarning(" No supported admin mods detected. Most punishments will not work without at least")
    YAWS.Core.LogWarning(" one of them installed.")
    YAWS.Core.LogWarning("")
    YAWS.Core.LogWarning(" If you wish to request an admin mod to be added to the supported list, please make")
    YAWS.Core.LogWarning(" a ticket on Gmodstore.")
    YAWS.Core.LogWarning(YAWS.Core.Divider())
end
if(xAdmin) then
    if(!xAdmin.Github) then
        YAWS.Core.Space()
        YAWS.Core.LogWarning(YAWS.Core.Divider())
        YAWS.Core.LogWarning(" If your looking for xAdmin support, YAWS only supports the free xAdmin, not")
        YAWS.Core.LogWarning(" TheXnator's xAdmin. ", YAWS.Core.LogColors.TextHighlightColor, "https://github.com/TheXYZNetwork/xAdmin")
        YAWS.Core.LogWarning(YAWS.Core.Divider())
    end
end

-- Database config checks
if(SERVER) then
    YAWS.Core.ValidateConfig()
end

-- Now to do our version check.
hook.Add("PlayerConnect", "yaws.core.versioncheck", function()
    http.Fetch("https://api.livaco.dev/yaws_version_check.php", function(body, size, headers, code)
        local version = body
        local v = string.Split(version, ".")

        local isOuted = false
        -- youch
        if(tonumber(v[1]) > YAWS.Version.Major) then
            isOuted = true
        elseif(tonumber(v[1]) == YAWS.Version.Major) then
            if(tonumber(v[2]) > YAWS.Version.Minor) then
                isOuted = true
            elseif(tonumber(v[2]) == YAWS.Version.Minor) then
                if(tonumber(v[3]) > YAWS.Version.Patch) then
                    isOuted = true
                end
            end
        end

        if(isOuted) then
            YAWS.Version.IsOutdated = true

            YAWS.Core.Space()
            YAWS.Core.LogWarning(YAWS.Core.Divider())
            YAWS.Core.LogWarning("  Your YAWS install is outdated. Please update to the latest version.")
            YAWS.Core.LogWarning("  Latest Version: ", YAWS.Core.LogColors.TextHighlightColor, version)
            YAWS.Core.LogWarning(YAWS.Core.Divider())
        end
    end,
    function(err)
        YAWS.Core.LogError("Error checking for newer version: ", err)
    end)

    hook.Remove("PlayerConnect", "yaws.core.versioncheck")
end)

-- CAMI
CAMI.RegisterPrivilege({
    Name = "YAWS_ViewUI",
    MinAccess = "user",
    Description = "Allows the user to view the YAWS UI."
})
CAMI.RegisterPrivilege({
    Name = "YAWS_SelfWarns",
    MinAccess = "user",
    Description = "Allows the user to view their own warnings."
})
CAMI.RegisterPrivilege({
    Name = "YAWS_OthersWarns",
    MinAccess = "admin",
    Description = "Allows the user to view other players warnings and edit admin notes."
})
CAMI.RegisterPrivilege({
    Name = "YAWS_AdminSettings",
    MinAccess = "superadmin",
    Description = "Allows the user to view admin settings."
})
CAMI.RegisterPrivilege({
    Name = "YAWS_CreateWarns",
    MinAccess = "admin",
    Description = "Allows the user to issue warnings."
})
CAMI.RegisterPrivilege({
    Name = "YAWS_CustomiseReasons",
    MinAccess = "admin",
    Description = "Allows the user to issue warnings without needing to use a preset."
})
CAMI.RegisterPrivilege({
    Name = "YAWS_DeleteWarns",
    MinAccess = "superadmin",
    Description = "Allows the user to delete and wipe a users warnings."
})

--addons/yet_another_warn_system/lua/yaws/core/sh_punishments.lua:
return gluapack()()
--addons/yet_another_warn_system/lua/yaws/core/cl_ui.lua:
-- Material Cache
YAWS.UI.MaterialCache = {}
YAWS.UI.MaterialCache['left_gradient'] = Material("gui/gradient")
YAWS.UI.MaterialCache['down_gradient'] = Material("gui/gradient_down")
YAWS.UI.MaterialCache['close'] = Material("livaco/yet_another_warn_system/close.png", "smooth mips")
YAWS.UI.MaterialCache['warning'] = Material("livaco/yet_another_warn_system/warning.png", "mips smooth")
YAWS.UI.MaterialCache['warning_slash'] = Material("livaco/yet_another_warn_system/warning_slash.png", "smooth mips")
YAWS.UI.MaterialCache['player'] = Material("livaco/yet_another_warn_system/player.png", "smooth mips")
YAWS.UI.MaterialCache['admin'] = Material("livaco/yet_another_warn_system/admin.png", "smooth mips")
YAWS.UI.MaterialCache['settings'] = Material("livaco/yet_another_warn_system/wrench.png", "smooth mips")
YAWS.UI.MaterialCache['permissions'] = Material("livaco/yet_another_warn_system/permissions.png", "smooth mips")
YAWS.UI.MaterialCache['paper'] = Material("livaco/yet_another_warn_system/paper.png", "smooth mips")
YAWS.UI.MaterialCache['gavel'] = Material("livaco/yet_another_warn_system/gavel.png", "smooth mips")
YAWS.UI.MaterialCache['search'] = Material("livaco/yet_another_warn_system/search.png", "smooth mips")
YAWS.UI.MaterialCache['check'] = Material("livaco/yet_another_warn_system/check.png", "smooth mips")
YAWS.UI.MaterialCache['arrow'] = Material("livaco/yet_another_warn_system/arrow_thingy.png", "smooth mips")
YAWS.UI.MaterialCache['double_arrow'] = Material("livaco/yet_another_warn_system/double_arrow.png", "smooth mips")
YAWS.UI.MaterialCache['trash'] = Material("livaco/yet_another_warn_system/bin.png", "smooth mips")
YAWS.UI.MaterialCache['edit'] = Material("livaco/yet_another_warn_system/edit.png", "smooth mips")
YAWS.UI.MaterialCache['load'] = Material("livaco/yet_another_warn_system/load.png", "smooth mips")
YAWS.UI.MaterialCache['idkwhatthisiscalled'] = Material("livaco/yet_another_warn_system/expand_thingy_idk_what_its_called.png", "smooth mips")

function YAWS.UI.UpdatePermissionNames()
    YAWS.UI.PermissionsNames = {
        view_ui = YAWS.Language.GetTranslation("permission_view_ui"),
        view_self_warns = YAWS.Language.GetTranslation("permission_view_self_warns"),
        view_others_warns = YAWS.Language.GetTranslation("permission_view_others_warns"),
        view_admin_settings = YAWS.Language.GetTranslation("permission_view_admin_settings"),
        create_warns = YAWS.Language.GetTranslation("permission_create_warns"),
        customise_reason = YAWS.Language.GetTranslation("permission_customise_reason"),
        delete_warns = YAWS.Language.GetTranslation("permission_delete_warns"),
    }
end
-- Some "nice names" for the permissions keys
hook.Add("yaws.core.initalize", "yaws.ui.yesihadtouseahookhere", YAWS.UI.UpdatePermissionNames)
hook.Add("yaws.language.updated", "yaws.ui.anoterfuckinguselesshook", YAWS.UI.UpdatePermissionNames)

-- All the possible permissions that a group can have so the ui can loop through
-- it in order
YAWS.UI.Permissions = {"view_ui", "view_self_warns", "view_others_warns", "view_admin_settings", "create_warns", "customise_reason", "delete_warns"}

-- I do this way of fonts so theres fonts for the scaling function to use pls
-- don't yell at me thanks xx
for i=0,12 do
    surface.CreateFont("yaws." .. i, {
        font = "Roboto",
        size = ScreenScale(i),
        antialias = true,
        extended = true,
    })
    -- weight = 600,
end
hook.Add("OnScreenSizeChanged", "yaws.ui.fontshit", function()
    for i=0,12 do
        surface.CreateFont("yaws." .. i, {
            font = "Roboto",
            size = ScreenScale(i),
            antialias = true,
            extended = true,
        })
        -- weight = 600,
    end
end)

-- Bits and pieces of helper stuff
function YAWS.UI.DrawShadow(x, y, w, h, downGradient)
    if(YAWS.UI.UseDarkTheme()) then return end 
    
    draw.NoTexture()
    surface.SetDrawColor(35, 35, 35, 50)

    if(downGradient) then
        surface.SetMaterial(YAWS.UI.MaterialCache['down_gradient'])
    else
        surface.SetMaterial(YAWS.UI.MaterialCache['left_gradient'])
    end

    surface.DrawTexturedRect(x, y, w, h)
end

function YAWS.UI.LerpColor(amount, old, new)
    local clr = Color(old.r, old.g, old.b, old.a)

    clr.r = Lerp(amount, clr.r, new.r)
    clr.g = Lerp(amount, clr.g, new.g)
    clr.b = Lerp(amount, clr.b, new.b)
    if(old.a != new.a) then 
        clr.a = Lerp(amount, clr.a, new.a)
    end

    return clr
end

function YAWS.UI.DrawCircle(x, y, radius, quality)
    local cir = {}

    for i=1,quality do
        local rad = math.rad(i * 360) / quality

        cir[i] = {
            x = x + math.cos(rad) * radius,
            y = y + math.sin(rad) * radius
        }
    end

    draw.NoTexture()
    surface.DrawPoly(cir)
end

function YAWS.UI.TintColor(clr, amount)
    return Color(clr.r + amount, clr.g + amount, clr.b + amount)
end

-- \/ why i make fonts without knowing they'll be used
function YAWS.UI.ScaleFont(text, maxSize, min, max)
    local font = "yaws." .. min

    for i=min,max do
        font = "yaws." .. i
        surface.SetFont(font)
        local w = surface.GetTextSize(text)
        if(w <= maxSize) then continue end

        return "yaws." .. math.Max((i - 1), min)
    end

    return "yaws." .. max
end

-- I need to cache the result cus somehow im dipping 15-20fps from using this
-- function. Yeah, don't ask, because im fucking clueless
YAWS.UI.CutoffTextCache = {}
function YAWS.UI.CutoffText(text, font, maxWidth, cacheKey)
    if(YAWS.UI.CutoffTextCache[text]) then 
        return YAWS.UI.CutoffTextCache[text]
    end 

    surface.SetFont(font)
    local curSize = surface.GetTextSize(text)
    if(curSize < maxWidth) then 
        YAWS.UI.CutoffTextCache[text] = text
        return text 
    end

    for i=0,#text do
        i = #text - i
        if(i < 3) then 
            YAWS.UI.CutoffTextCache[text] = "..."
            return "..." 
        end
        if(surface.GetTextSize(string.sub(text, 1, i)) < maxWidth) then 
            YAWS.UI.CutoffTextCache[text] = string.sub(text, 1, i - 3) .. "..." 
            return string.sub(text, 1, i - 3) .. "..." 
        end
    end

    YAWS.UI.CutoffTextCache[text] = "..."
    return "..." 
end
timer.Create("yaws.ui.cutofftext.cache", 30, 0, function()
    -- Resets that cache so it doesn't get clogged up with utter shit
    YAWS.UI.CutoffTextCache = {}
end)

function YAWS.UI.SetSurfaceDrawColor(clr)
    surface.SetDrawColor(clr:Unpack())
end

-- wow this is one fancy ass function
function YAWS.UI.DrawAnimatedChevron(x, y, w, h, prevState, isDown)
    local poly = {}
    
    if(prevState) then 
        poly = prevState
        if(isDown) then 
            -- was initially gona remove the X lerping, but when the scrollbar
            -- comes in on the admin settings the X lerping causes the chevron
            -- to move over smoothly instead of harshly, which I like so it's
            -- staying :)
            poly[1] = {
                x = Lerp(RealFrameTime() * 5, poly[1].x, x),
                y = Lerp(RealFrameTime() * 5, poly[1].y, y),
            }
            poly[2] = {
                x = Lerp(RealFrameTime() * 5, poly[2].x, x + (w / 2)),
                y = Lerp(RealFrameTime() * 5, poly[2].y, y + h),
            }
            poly[3] = {
                x = Lerp(RealFrameTime() * 5, poly[3].x, (x + w)),
                y = Lerp(RealFrameTime() * 5, poly[3].y, y),
            }
        else 
            poly[1] = {
                x = Lerp(RealFrameTime() * 5, poly[1].x, x),
                y = Lerp(RealFrameTime() * 5, poly[1].y, y + h),
            }
            poly[2] = {
                x = Lerp(RealFrameTime() * 5, poly[2].x, x + (w / 2)),
                y = Lerp(RealFrameTime() * 5, poly[2].y, y),
            }
            poly[3] = {
                x = Lerp(RealFrameTime() * 5, poly[3].x, (x + w)),
                y = Lerp(RealFrameTime() * 5, poly[3].y, y + h),
            }
        end 
    else 
        poly = {
            {
                x = x,
                y = y
            },
            {
                x = x + (w / 2),
                y = y + h
            },
            {
                x = (x + w),
                y = y
            },
        }
    end 
    
    draw.NoTexture()
    YAWS.UI.SetSurfaceDrawColor(YAWS.UI.ColorScheme()['text_header'])

    for k,v in ipairs(poly) do
        if(k >= #poly) then continue end 
        surface.DrawLine(v.x, v.y, poly[k + 1].x, poly[k + 1].y)
    end

    return poly
end 

-- NOTE: Must be used with something like draw.DrawText or something
function YAWS.UI.TextWrap(text, font, maxWidth)
    local i = ""
    surface.SetFont(font)
    for k,v in ipairs(string.Explode(" ", text)) do 
        i = i .. " " .. v

        local width = surface.GetTextSize(i)
        if(width >= maxWidth) then 
            i = string.Trim(string.sub(i, 0, #i - #v)) .. "\n" .. string.Trim(v)
        end 
    end 

    return string.Trim(i)
end 

-- https://easings.net/#easeOutCubic 
-- Was originally easeOutCirc but changed it cus this one is cheaper to run with
-- the same sort of results.
-- function YAWS.UI.EaseOutCubic(x)
--     return 1 - ((1 - x) ^ 3)
-- end 


-- Other shit
net.Receive("yaws.core.openui", function(len)
    YAWS.Core.PayloadDebug("yaws.core.openui", len)
    -- nother curator learn how addon work time
    -- Here I store the data the addon needs inside this table, that way if the
    -- UI needs the data it's in this table. I do this just to prevent me from
    -- shipping parameters into the ui functions all the time. 
    YAWS.UI.CurrentData = util.JSONToTable(util.Decompress(net.ReadData(net.ReadUInt(16))))
    
    -- Botched fix for presets changing types on sending via net
    -- This fixes the bug with the addon bugging out when you use a preset name thats just a number
    if(YAWS.UI.CurrentData.current_presets) then
        for k,v in pairs(YAWS.UI.CurrentData.current_presets) do 
            YAWS.UI.CurrentData.current_presets[k] = nil
            YAWS.UI.CurrentData.current_presets[tostring(k)] = v
        end 
    end

    if(YAWS.UI.CurrentData.state) then
        -- needs to open seperately
        if(YAWS.UI.CurrentData.state.state == "warning_player") then
            YAWS.UI.WarnPlayerPopup({
                steamid = YAWS.UI.CurrentData.state.steamid,
                realSteamID = util.SteamIDFrom64(YAWS.UI.CurrentData.state.steamid),
                name = YAWS.UI.CurrentData.state.name,
                usergroup = YAWS.UI.CurrentData.state.usergroup,
            })

            return
        end
        if(YAWS.UI.CurrentData.state.state == "viewing_warning") then
            YAWS.UI.ViewWarning(YAWS.UI.CurrentData.state.playerData, YAWS.UI.CurrentData.state.warnData)
            YAWS.UI.StateCache = {}
            YAWS.UI.StateCache["warn_data_return"] = "viewing_self"
            
            return
        end
    end

    YAWS.UI.CoreUI()

    -- Cached states
    if(YAWS.UI.CurrentData.state) then
        if(YAWS.UI.CurrentData.state.state == "viewing_player") then
            YAWS.UI.CurrentData.FrameCache:SetSidebarSelectedName(YAWS.Language.GetTranslation("sidebar_players"))

            YAWS.UI.HandleGettingPlayerWarndata(YAWS.UI.CurrentData.MasterCache, {
                steamid = YAWS.UI.CurrentData.state.steamid,
                name = YAWS.UI.CurrentData.state.name,
                usergroup = YAWS.UI.CurrentData.state.usergroup,
            })
        end

        if(YAWS.UI.CurrentData.state.state == "viewing_player_notes") then
            YAWS.UI.CurrentData.FrameCache:SetSidebarSelectedName(YAWS.Language.GetTranslation("sidebar_players"))

            YAWS.UI.HandleGettingPlayerWarndata(YAWS.UI.CurrentData.MasterCache, {
                steamid = YAWS.UI.CurrentData.state.steamid,
                name = YAWS.UI.CurrentData.state.name,
                usergroup = YAWS.UI.CurrentData.state.usergroup,
            }, true)
        end
    end
end)

-- Properties menu stuff 
properties.Add("yaws_primary", {
    MenuLabel = (YAWS.Language.GetTranslationSafe("yaws") == "" && "Yet Another Warning System" || YAWS.Language.GetTranslationSafe("yaws")),
    MenuIcon = "icon16/book_error.png",
    StructureField = 90000,
    Filter = function(self, ent, player)
        if(!IsValid(ent)) then return false end
        if(!ent:IsPlayer()) then return false end
        if(ent:IsBot()) then return false end 

        return YAWS.UI.ContextData['view'] || YAWS.UI.ContextData['create']
    end,
    -- return true 
    MenuOpen = function(self, option, ent, tr)
        if(!ent || !IsValid(ent)) then return end 
        
        local options = option:AddSubMenu("base")

        if(YAWS.UI.ContextData['create']) then
            options:AddOption(YAWS.Language.GetTranslationSafe("context_warn"), function()
                net.Start("yaws.core.c_warnplayer")
                net.WriteString(ent:SteamID64() || "")
                net.SendToServer()
            end):SetIcon("icon16/page_white_edit.png")

            -- Presets
            local presetSub, presetMenuOption = options:AddSubMenu(YAWS.Language.GetTranslationSafe("context_presets"))
            presetMenuOption:SetIcon("icon16/folder_error.png")

            for k, v in pairs(YAWS.UI.ContextData['presets']) do
                local preset = presetSub:AddSubMenu(k)
                preset:AddOption(YAWS.Language.GetFormattedTranslation("context_points", v.points)):SetIcon("icon16/award_star_gold_3.png")
                preset:AddOption(YAWS.Language.GetFormattedTranslation("context_reason", v.reason)):SetIcon("icon16/page_edit.png")
                preset:AddSpacer()

                preset:AddOption(YAWS.Language.GetTranslationSafe('context_submit'), function()
                    net.Start("yaws.warns.warnplayer")
                    net.WriteBool(true)
                    net.WriteString(ent:SteamID64() || "")
                    net.WriteString(k)
                    net.SendToServer()
                end):SetIcon("icon16/accept.png")
            end

            if(YAWS.UI.ContextData['view']) then
                options:AddSpacer()
            end
        end

        if(YAWS.UI.ContextData['view']) then
            options:AddOption(YAWS.Language.GetTranslationSafe("context_viewwarns"), function()
                net.Start("yaws.core.c_viewplayer")
                net.WriteString(ent:SteamID64() || "")
                net.SendToServer()
            end):SetIcon("icon16/eye.png")

            options:AddOption(YAWS.Language.GetTranslationSafe("context_viewnotes"), function()
                net.Start("yaws.core.c_viewnotes")
                net.WriteString(ent:SteamID64() || "")
                net.SendToServer()
            end):SetIcon("icon16/page_white_edit.png")
        end
    end
})

-- Request to the server if we should be able to see the context menu 
-- This is the only cached shit there is settings/presets based 
YAWS.UI.ContextData = YAWS.UI.ContextData || {}

hook.Add("InitPostEntity", "yaws.ui.contextgview", function()
    net.Start("yaws.permissions.caniviewcontextquestionmark")
    net.SendToServer()
end)

net.Receive("yaws.permissions.maybeyoucanviewyes", function()
    YAWS.UI.ContextData['view'] = net.ReadBool()
    YAWS.UI.ContextData['create'] = net.ReadBool()

    if(YAWS.UI.ContextData['create']) then
        YAWS.UI.ContextData['presets'] = util.JSONToTable(util.Decompress(net.ReadData(net.ReadUInt(16))))
    end
end)
--addons/yet_another_warn_system/lua/yaws/core/settings/cl_config.lua:
return gluapack()()
--addons/yet_another_warn_system/lua/yaws/core/settings/cl_user_settings.lua:
return gluapack()()
--addons/yet_another_warn_system/lua/yaws/punishments/sh_darkrp_money.lua:
local PUNISHMENT = YAWS.Punishments.CreatePunishment()
PUNISHMENT:SetID("yaws.darkrp.money")
PUNISHMENT:SetName("DarkRP Money")
PUNISHMENT:SetDescription("Charges the user money")

PUNISHMENT:AddParameter("amount", "Amount", "The amount of money to charge.", "number", 500)

PUNISHMENT:ShouldEnable(function()
    return (DarkRP) and true or false
end)
PUNISHMENT:SetAction(function(admin, targetSteamID, params)
    local ply = player.GetBySteamID64(targetSteamID)
    if(!ply) then return false,"Player is not online." end

    ply:addMoney(params.amount * -1)
    YAWS.Language.SendRawMessage(ply, "Due to your actions you have been charged " .. string.Comma(params.amount) .. ".")

    return true 
end)
--addons/yet_another_warn_system/lua/yaws/punishments/sh_gag.lua:
local PUNISHMENT = YAWS.Punishments.CreatePunishment()
PUNISHMENT:SetID("yaws.gag")
PUNISHMENT:SetName("Gag")
PUNISHMENT:SetDescription("Gags the player for a certain time.")

PUNISHMENT:AddParameter("duration", "Duration", "The duration they are gagged in minutes.", "number", 1)

PUNISHMENT:ShouldEnable(function()
    return (ulx || sam || xAdmin) and true or false
end)
PUNISHMENT:SetAction(function(admin, targetSteamID, params)
    local ply = player.GetBySteamID64(targetSteamID)
    if(!ply) then return false,"Player is not online." end

    if(ulx) then 
        -- ulx.jail(admin, {ply}, params['duration'] * 60, false)
        RunConsoleCommand("ulx", "gag", ply:SteamID(), params.duration)
        YAWS.Language.SendRawMessage(ply, "Due to your actions you have been gagged.")
        return true
    end 

    if(sam) then 
        RunConsoleCommand("sam", "gag", targetSteamID, params.duration)
        YAWS.Language.SendRawMessage(ply, "Due to your actions you have been gagged.")
        return true
    end 

    if(xAdmin) then 
        RunConsoleCommand("xadmin", "gag", targetSteamID, params.duration)
        YAWS.Language.SendRawMessage(ply, "Due to your actions you have been gagged.")
        return true
    end 
    
    return false, "Could not find a supported admin system to mute with."
end)
--addons/yet_another_warn_system/lua/yaws/ui/elements/cl_table.lua:
return gluapack()()
--addons/yet_another_warn_system/lua/yaws/ui/elements/inputs/cl_color.lua:
local PANEL = {}

function PANEL:Init()
    self.huePicker = vgui.Create("DRGBPicker", self)
    self.colorPicker = vgui.Create("DColorCube", self)

    self.huePicker.OnChange = function(s, col)
        -- Update the color cube too 
        local h = ColorToHSV(col)
        local _,s,v = ColorToHSV(self.colorPicker:GetRGB())
        self.colorPicker:SetColor(HSVToColor(h, s, v))

        self:UpdateColor()
    end 
    self.colorPicker.OnUserChanged = function(s, col)
        self:UpdateColor()
    end 

    self.fixOnLayout = nil
end 

function PANEL:UpdateColor()
    local h,_,_ = ColorToHSV(self.huePicker:GetRGB())
    local _,s,v = ColorToHSV(self.colorPicker:GetRGB())
    
    self:ValueChanged(HSVToColor(h, s, v))
end 
function PANEL:ValueChanged(col) end

function PANEL:SetColor(col)
    local h,s,v = ColorToHSV(col)

    self.huePicker.LastY = (1 - (h / 360)) * self.huePicker:GetTall()
    self.colorPicker:SetColor(col)
    self.fixOnLayout = col
end 
function PANEL:GetColor()
    local h = ColorToHSV(self.huePicker:GetRGB())
    local _,s,v = ColorToHSV(self.colorPicker:GetRGB())
    return HSVToColor(h, s, v)
end 

function PANEL:PerformLayout(w, h)
    self.huePicker:Dock(LEFT)
    self.huePicker:SetWide(math.min(w * 0.1, 20))
    
    self.colorPicker:Dock(FILL)
    self.colorPicker:DockMargin(10, 0, 0, 0)

    -- needs to be here so the color is in the correct place when it's height is updated
    -- not like it's being ran every frame
    if(self.fixOnLayout) then 
        local h = ColorToHSV(self.fixOnLayout)
        self.huePicker.LastY = (1 - (h / 360)) * self.huePicker:GetTall()
    end 
end 

function PANEL:Paint(w, h)
end 

vgui.Register("yaws.color", PANEL, "DPanel")
--addons/yet_another_warn_system/lua/yaws/ui/elements/inputs/cl_icon_text_entry.lua:
local PANEL = {}

-- Same as a regular text entry but designed to work with a icon too

AccessorFunc(PANEL, "placeholder", "Placeholder")

function PANEL:Init()
    self.textEntry = vgui.Create("yaws.text_entry", self)
    self.textEntry.Paint = function(self, w, h) 
        local colors = YAWS.UI.ColorScheme()
        self:DrawTextEntryText(colors["text_main"], colors["theme"], colors["theme"])

        if(self:GetText() == "" && (!self:HasFocus() || !self:IsEnabled())) then 
            draw.SimpleText(self.placeholder, self:GetFont(), self.overrideX && self.overrideX || 5, (!self:IsMultiline()) && (h / 2) - 1 || 5, colors['text_placeholder'], 0, (!self:IsMultiline()) && 1 || 0)
        end 
    end 
    
    self.icon = nil
    self.iconPanel = nil

    self.frameTime = RealFrameTime()

    self.borderColor = YAWS.UI.ColorScheme()['text_entry_border_inactive']
    self.sideShadow = vgui.Create("yaws.shadow", self:GetParent())
    self.bottomShadow = vgui.Create("yaws.shadow", self:GetParent())
    self.bottomShadow:Down()
end 

function PANEL:GetTextEntry()
    return self.textEntry
end 

function PANEL:Paint(w, h)
    local colors = YAWS.UI.ColorScheme()

    -- don't question this
    if(self:HasFocus()) then 
        self.borderColor = YAWS.UI.LerpColor(self.frameTime * 5, self.borderColor, colors['text_entry_border_active'])
    else
        self.borderColor = YAWS.UI.LerpColor(self.frameTime * 5, self.borderColor, colors['text_entry_border_inactive'])
    end 

    draw.RoundedBox(0, 0, 0, w, h, self.borderColor)
    draw.RoundedBox(0, 1, 1, w - 2, h - 2, colors['input_bg'])
end 

function PANEL:LayoutShadows(w, h)
    local x,y = self:GetPos()
    if(IsValid(self.sideShadow)) then 
        self.sideShadow:SetPos(x + w, y)
        self.sideShadow:SetSize(3, h)
    end 

    if(IsValid(self.bottomShadow)) then 
        self.bottomShadow:SetPos(x, y + h)
        self.bottomShadow:SetSize(w + 1, 3)
    end
end 

function PANEL:SetIcon(mat)
    self.icon = mat

    if(!self.iconPanel) then 
        self.iconPanel = vgui.Create("DPanel", self)
        self.iconPanel.Paint = function(sself, w, h)
            -- draw.RoundedBox(0, 0, 0, w, h, Color(255, 0, 0, 120))
            YAWS.UI.SetSurfaceDrawColor(YAWS.UI.ColorScheme()['text_header'])
            surface.SetMaterial(mat)
            surface.DrawTexturedRect(h * 0.2, h * 0.2, h * 0.65, h * 0.65)
        end 
        self:InvalidateLayout()
    end 
end 

function PANEL:PerformLayout(w, h)
    if(self.iconPanel) then 
        self.iconPanel:Dock(LEFT)
        self.iconPanel:SetSize(h - 5, h)
    end 

    self.textEntry:Dock(FILL)
    self:LayoutShadows(w, h)
end 

function PANEL:RemoveShadows() 
    self.bottomShadow:Remove()
    self.sideShadow:Remove()
end 
function PANEL:OnRemove()
    self:RemoveShadows()
end 

vgui.Register("yaws.icon_text_entry", PANEL, "DPanel")
--addons/yet_another_warn_system/lua/yaws/ui/elements/inputs/cl_numberwang.lua:
local PANEL = {}

AccessorFunc(PANEL, "placeholder", "Placeholder")

function PANEL:Init()
    self:SetFont("yaws.6")

    self.frameTime = RealFrameTime()

    self.borderColor = YAWS.UI.ColorScheme()['text_entry_border_inactive']

    self.sideShadow = vgui.Create("yaws.shadow", self:GetParent())
    self.bottomShadow = vgui.Create("yaws.shadow", self:GetParent())
    self.bottomShadow:Down()
end 

function PANEL:Paint(w, h)
    self.frameTime = RealFrameTime()
    local colors = YAWS.UI.ColorScheme()

    -- don't question this
    if(self:HasFocus()) then 
        self.borderColor = YAWS.UI.LerpColor(self.frameTime * 5, self.borderColor, colors['text_entry_border_active'])
    else
        self.borderColor = YAWS.UI.LerpColor(self.frameTime * 5, self.borderColor, colors['text_entry_border_inactive'])
    end 

    draw.RoundedBox(0, 0, 0, w, h, self.borderColor)
    draw.RoundedBox(0, 1, 1, w - 2, h - 2, colors['input_bg'])

    self:DrawTextEntryText(colors["text_main"], colors["theme"], colors["theme"])
    if(self:GetText() == "" && (!self:HasFocus() || !self:IsEnabled())) then 
        draw.SimpleText(self.placeholder, self:GetFont(), h / 4, (!self:IsMultiline()) && h / 2 || 5, colors['text_placeholder'], 0, (!self:IsMultiline()) && 1 || 0)
    end 
end 

function PANEL:LayoutShadows(w, h)
    local x,y = self:GetPos()
    if(IsValid(self.sideShadow)) then 
        self.sideShadow:SetPos(x + w, y)
        self.sideShadow:SetSize(3, h)
    end 

    if(IsValid(self.bottomShadow)) then 
        self.bottomShadow:SetPos(x, y + h)
        self.bottomShadow:SetSize(w + 1, 3)
    end
end 

function PANEL:PerformLayout(w, h)
    -- old perform layout with a couple of changes - https://github.com/Facepunch/garrysmod/blob/master/garrysmod/lua/vgui/dnumberwang.lua#L177
    local s = math.floor(self:GetTall() * 0.5)
    self.Up:SetSize(s, s - 1)
    self.Up:AlignRight(3)
    self.Up:AlignTop(3)

    self.Down:SetSize(s, s - 1)
    self.Down:AlignRight(3)
    self.Down:AlignBottom(3)

    self:LayoutShadows(w, h)
end 

function PANEL:RemoveShadows() 
    self.bottomShadow:Remove()
    self.sideShadow:Remove()
end 
function PANEL:OnRemove()
    self:RemoveShadows()
end 

vgui.Register("yaws.wang", PANEL, "DNumberWang") -- hehe wang 
--addons/yet_another_warn_system/lua/yaws/ui/elements/misc/cl_round_avatar.lua:
return gluapack()()
--addons/advancedkillfeed/lua/z_advancedkillfeed/client/cl_z_advancedkillfeed_test.lua:
return gluapack()()
--addons/advancedkillfeed/lua/z_advancedkillfeed/client/cl_z_advancedkillfeed.lua:
return gluapack()()
--addons/zerosfruitslicer/lua/autorun/zfs_load.lua:
return gluapack()()
--addons/zeros_methlab02_v1.4.1/lua/zmlab2/util/sh_materials.lua:
return gluapack()()
--addons/zeros_methlab_1.6.4/lua/zmlab/sh/zmlab_materials.lua:
return gluapack()()
--addons/zeros_methlab_1.6.4/lua/zmlab/cl/zmlab_settings_menu.lua:
if not CLIENT then return end
local Created = false

CreateConVar("zmlab_cl_vfx_particleeffects", "1", {FCVAR_ARCHIVE})
CreateConVar("zmlab_cl_vfx_dynamiclight", "0", {FCVAR_ARCHIVE})

local function zmlab_OptionPanel(name, CPanel, cmds)
	local panel = vgui.Create("DPanel")
	panel:SetSize(250 , 40 + (35 * table.Count(cmds)))
	panel.Paint = function(s, w, h)
		draw.RoundedBox(4, 0, 0, w, h, zmlab.default_colors["grey01"])
	end

	local title = vgui.Create("DLabel", panel)
	title:SetPos(10, 2.5)
	title:SetText(name)
	title:SetFont("zmlab_settings_font01")
	title:SetSize(panel:GetWide(), 30)
	title:SetTextColor(zmlab.default_colors["blue01"])

	for k, v in pairs(cmds) do
		if v.class == "DNumSlider" then

			local item = vgui.Create("DNumSlider", panel)
			item:SetPos(10, 35 * k)
			item:SetSize(panel:GetWide(), 30)
			item:SetText(v.name)
			item:SetMin(v.min)
			item:SetMax(v.max)
			item:SetDecimals(v.decimal)
			item:SetDefaultValue(math.Clamp(math.Round(GetConVar(v.cmd):GetFloat(),v.decimal),v.min,v.max))
			item:ResetToDefaultValue()

			item.OnValueChanged = function(self, val)

				if (not Created) then
					RunConsoleCommand(v.cmd, tostring(val))
				end
			end

			timer.Simple(0.1, function()
				if (item) then
					item:SetValue(math.Clamp(math.Round(GetConVar(v.cmd):GetFloat(),v.decimal),v.min,v.max))
				end
			end)
		elseif v.class == "DCheckBoxLabel" then

			local item = vgui.Create("DCheckBoxLabel", panel)
			item:SetPos(10, 35 * k)
			item:SetSize(panel:GetWide(), 30)
			item:SetText( v.name )
			item:SetConVar( v.cmd )
			item:SetValue(0)
			item.OnChange = function(self, val)

				if (not Created) then
					if ((bVal and 1 or 0) == cvars.Number(v.cmd)) then return end
					RunConsoleCommand(v.cmd, tostring(val))
				end
			end

			timer.Simple(0.1, function()
				if (item) then
					item:SetValue(GetConVar(v.cmd):GetInt())
				end
			end)
		elseif v.class == "DButton" then
			local item = vgui.Create("DButton", panel)
			item:SetPos(10, 35 * k)
			item:SetSize(panel:GetWide(), 30)
			item:SetText( "" )
			//item:SetConsoleCommand( v.cmd )
			item.Paint = function(s, w, h)
				draw.RoundedBox(5, 0, 0, w, h, zmlab.default_colors["blue01"])
				draw.SimpleText(v.name, "zmlab_settings_font02", w / 2, h / 2, zmlab.default_colors["white01"], TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)

				if s.Hovered then
					draw.RoundedBox(5, 0, 0, w, h, zmlab.default_colors["white03"])
				end
			end
			item.DoClick = function()

				if zmlab.f.IsAdmin(LocalPlayer()) == false then return end

				LocalPlayer():EmitSound("zmlab_ui_click")

				if v.notify then

					notification.AddLegacy(  v.notify, NOTIFY_GENERIC, 2 )
				end
				LocalPlayer():ConCommand( v.cmd )

			end
		end
	end

	CPanel:AddPanel(panel)
end


local function zmlab_settings(CPanel)
	Created = true
	CPanel:AddControl("Header", {
		Text = "Client Settings",
		Description = ""
	})

	zmlab_OptionPanel("VFX",CPanel,{
		[1] = {name = "ParticleEffects",class = "DCheckBoxLabel", cmd = "zmlab_cl_vfx_particleeffects"},
		[2] = {name = "DynamicLight",class = "DCheckBoxLabel", cmd = "zmlab_cl_vfx_dynamiclight"},
	})

	timer.Simple(0.1, function()
		Created = false
	end)
end

local function zmlab_admin_settings(CPanel)

	CPanel:AddControl("Header", {
		Text = "Admin Settings",
		Description = ""
	})

	zmlab_OptionPanel("NPC",CPanel,{
		[1] = {name = "Save",class = "DButton", cmd = "zmlab_npc_save"},
		[2] = {name = "Remove",class = "DButton", cmd = "zmlab_npc_remove"},
	})

	zmlab_OptionPanel("DropOffPoints",CPanel,{
		[1] = {name = "Save",class = "DButton", cmd = "zmlab_dropoff_save"},
		[2] = {name = "Remove",class = "DButton", cmd = "zmlab_dropoff_remove"},
	})

	zmlab_OptionPanel("Commands",CPanel,{
		[1] = {name = "Spawn Methcrates",class = "DButton", cmd = "zmlab_debug_spawn_methcrates"},
	})
end



hook.Add( "PopulateToolMenu", "a_zmlab_PopulateMenus", function()
	spawnmenu.AddToolMenuOption( "Options", "Zeros Methlab", "zmlab_Settings", "Client Settings", "", "", zmlab_settings )
	spawnmenu.AddToolMenuOption("Options", "Zeros Methlab", "zmlab_Admin_Settings", "Admin Settings", "", "", zmlab_admin_settings)
end )

hook.Add( "AddToolMenuCategories", "a_zmlab_CreateCategories", function()
	spawnmenu.AddToolCategory( "Options", "Zeros Methlab", "Zeros Methlab" );
end )

--addons/zeros_trashman_v1.6.3/lua/ztrashman/util/cl_settings.lua:
return gluapack()()
--lua/advdupe2/sh_codec_legacy.lua:
--[[
	Title: Adv. Dupe 2 Codec Legacy Support

	Desc: Facilitates opening of dupes from AD1 and earlier AD2 versions.

	Author: emspike

	Version: 2.0
]]

local pairs = pairs
local type = type
local tonumber = tonumber
local error = error
local Vector = Vector
local Angle = Angle
local format = string.format
local char = string.char
local byte = string.byte
local sub = string.sub
local gsub = string.gsub
local find = string.find
local gmatch = string.gmatch
local match = string.match
local concat = table.concat

--[[
	Name:	GenerateDupeStamp
	Desc:	Generates an info table.
	Params:	<player> ply
	Return:	<table> stamp
]]
function AdvDupe2.GenerateDupeStamp(ply)
	local stamp = {}
	stamp.name = ply:GetName()
	stamp.time = os.date("%I:%M %p")
	stamp.date = os.date("%d %B %Y")
	stamp.timezone = os.date("%z")
	hook.Call("AdvDupe2_StampGenerated",GAMEMODE,stamp)
	return stamp
end

local AD2FF = "AD2F%s\n%s\n%s"

local decode_types_v1, decode_types_v2
local tables = 0
local str,pos
local a,b,c,m,n,w,tblref

local function read_v2()
	local t = byte(str, pos+1)
	if t then
		local dt = decode_types_v2[t]
		if dt then
			pos = pos + 1
			return dt()
		else
			error(format("encountered invalid data type (%u)\n",t))
		end
	else
		error("expected value, got EOF\n")
	end
end

decode_types_v2 = {
	[1	] = function()
		error("expected value, got terminator\n")
	end,
	[2	] = function() -- table
		
		m = find(str, "\1", pos)
		if m then
			w = sub(str, pos+1, m-1)
			pos = m
		else
			error("expected table identifier, got EOF\n")
		end
		
		local t = {}
		tables[w] = t
		
		while true do
			if byte(str, pos+1) == 1 then
				pos = pos + 1
				return t
			else
				t[read_v2()] = read_v2()
			end
		end
	end,
	[3	] = function() -- array
		
		m = find(str, "\1", pos)
		if m then
			w = sub(str, pos+1, m-1)
			pos = m
		else
			error("expected table identifier, got EOF\n")
		end
		
		local t, i = {}, 1
		
		tables[w] = t
		
		while true do
			if byte(str,pos+1) == 1 then
				pos = pos+1
				return t
			else
				t[i] = read_v2()
				i = i + 1
			end
		end
	end,
	[4	] = function() -- false boolean
		return false
	end,
	[5	] = function() -- true boolean
		return true
	end,
	[6	] = function() -- number
		m = find(str, "\1", pos)
		if m then
			a = tonumber(sub(str, pos+1, m-1)) or 0
			pos = m
			return a
		else
			error("expected number, got EOF\n")
		end
	end,
	[7	] = function() -- string
		m = find(str,"\1",pos)
		if m then
			w = sub(str, pos+1, m-1)
			pos = m
			return w
		else
			error("expected string, got EOF\n")
		end
	end,
	[8	] = function() -- Vector
		m,n = find(str,".-\1.-\1.-\1", pos)
		if m then
			a,b,c = match(str,"^(.-)\1(.-)\1(.-)\1",pos+1)
			pos = n
			return Vector(tonumber(a), tonumber(b), tonumber(c))
		else
			error("expected vector, got EOF\n")
		end
	end,
	[9	] = function() -- Angle
		m,n = find(str, ".-\1.-\1.-\1", pos)
		if m then
			a,b,c = match(str, "^(.-)\1(.-)\1(.-)\1",pos+1)
			pos = n
			return Angle(tonumber(a), tonumber(b), tonumber(c))
		else
			error("expected angle, got EOF\n")
		end
	end,
	[10	] = function() -- Table Reference
		m = find(str,"\1",pos)
		if m then
			w = sub(str,pos+1,m-1)
			pos = m
		else
			error("expected table identifier, got EOF\n")
		end
		tblref = tables[w]
		
		if tblref then
			return tblref
		else
			error(format("table identifier %s points to nil\n", w))
		end
		
	end
}



local function read_v1()
	local t = byte(str,pos+1)
	if t then
		local dt = decode_types_v1[t]
		if dt then
			pos = pos + 1
			return dt()
		else
			error(format("encountered invalid data type (%u)\n",t))
		end
	else
		error("expected value, got EOF\n")
	end
end

decode_types_v1 = {
	[1	] = function()
		error("expected value, got terminator\n")
	end,
	[2	] = function() -- table
		local t = {}
		while true do
			if byte(str,pos+1) == 1 then
				pos = pos+1
				return t
			else
				t[read_v1()] = read_v1()
			end
		end
	end,
	[3	] = function() -- array
		local t, i = {}, 1
		while true do
			if byte(str,pos+1) == 1 then
				pos = pos+1
				return t
			else
				t[i] = read_v1()
				i = i + 1
			end
		end
	end,
	[4	] = function() -- false boolean
		return false
	end,
	[5	] = function() -- true boolean
		return true
	end,
	[6	] = function() -- number
		m = find(str,"\1",pos)
		if m then
			a = tonumber(sub(str,pos+1,m-1)) or 0
			pos = m
			return a
		else
			error("expected number, got EOF\n")
		end
	end,
	[7	] = function() -- string
		m = find(str,"\1",pos)
		if m then
			w = sub(str,pos+1,m-1)
			pos = m
			return w
		else
			error("expected string, got EOF\n")
		end
	end,
	[8	] = function() -- Vector
		m,n = find(str,".-\1.-\1.-\1",pos)
		if m then
			a,b,c = match(str,"^(.-)\1(.-)\1(.-)\1",pos+1)
			pos = n
			return Vector(tonumber(a), tonumber(b), tonumber(c))
		else
			error("expected vector, got EOF\n")
		end
	end,
	[9	] = function() -- Angle
		m,n = find(str,".-\1.-\1.-\1",pos)
		if m then
			a,b,c = match(str,"^(.-)\1(.-)\1(.-)\1",pos+1)
			pos = n
			return Angle(tonumber(a), tonumber(b), tonumber(c))
		else
			error("expected angle, got EOF\n")
		end
	end
}

local function deserialize_v1(data)
	str = data
	pos = 0
	tables = {}
	return read_v1()
end

local function deserialize_v2(data)
	str = data
	pos = 0
	tables = {}
	return read_v2()
end

local function lzwDecode(encoded)
	local dictionary_length = 256
	local dictionary = {}
	for i = 0, 255 do
		dictionary[i] = char(i)
	end
	
	local pos = 2
	local decompressed = {}
	local decompressed_length = 1
	
	local index = byte(encoded)
	local word = dictionary[index]
	
	decompressed[decompressed_length] = dictionary[index]
	
	local entry
	local encoded_length = #encoded
	local firstbyte --of an index
	while pos <= encoded_length do
		firstbyte = byte(encoded,pos)
		if firstbyte > 252 then --now we know it's a length indicator for a multibyte index
			index = 0
			firstbyte = 256 - firstbyte
			
			--[[if pos+firstbyte > encoded_length then	--will test for performance impact
				error("expected index got EOF")
			end]]
			
			for i = pos+firstbyte, pos+1, -1 do
				index = bit.bor(bit.lshift(index, 8), byte(encoded,i))
			end
			pos = pos + firstbyte + 1
		else
			index = firstbyte
			pos = pos + 1
		end
		entry = dictionary[index] or (word..sub(word,1,1))
		decompressed_length = decompressed_length + 1
		decompressed[decompressed_length] = entry
		dictionary[dictionary_length] = word..sub(entry,1,1)
		dictionary_length = dictionary_length + 1
		word = entry
	end
	return concat(decompressed)
end

--http://en.wikipedia.org/wiki/Huffman_coding#Decompression

local invcodes = {[2]={[0]="\254"},[5]={[22]="\1",[11]="\2"},[6]={[13]="\7",[35]="\6",[37]="\5",[58]="\3",[31]="\8",[9]="\13",[51]="\9",[55]="\10",[57]="\4",[59]="\15"},[7]={[1]="\14",[15]="\16",[87]="\31",[89]="\30",[62]="\26",[17]="\27",[97]="\19",[19]="\43",[10]="\12",[39]="\33",[41]="\24",[82]="\40",[3]="\32",[46]="\41",[47]="\38",[94]="\25",[65]="\23",[50]="\39",[26]="\11",[7]="\28",[33]="\18",[61]="\17",[25]="\42"},[8]={[111]="\101",[162]="\29",[2]="\34",[133]="\21",[142]="\36",[5]="\20",[21]="\37",[170]="\44",[130]="\22",[66]="\35"},[9]={[241]="\121",[361]="\104",[365]="\184",[125]="\227",[373]="\198",[253]="\117",[381]="\57",[270]="\49",[413]="\80",[290]="\47",[294]="\115",[38]="\112",[429]="\74",[433]="\0",[437]="\48",[158]="\183",[453]="\107",[166]="\111",[469]="\182",[477]="\241",[45]="\86",[489]="\69",[366]="\100",[497]="\61",[509]="\76",[49]="\53",[390]="\78",[279]="\196",[283]="\70",[414]="\98",[53]="\55",[422]="\109",[233]="\79",[349]="\89",[369]="\52",[14]="\105",[238]="\56",[319]="\162",[323]="\83",[327]="\63",[458]="\65",[335]="\231",[339]="\225",[337]="\114",[347]="\193",[493]="\139",[23]="\209",[359]="\250",[490]="\68",[42]="\54",[63]="\91",[286]="\97",[254]="\50",[510]="\108",[109]="\73",[67]="\103",[255]="\122",[69]="\170",[70]="\110",[407]="\176",[411]="\119",[110]="\120",[83]="\146",[149]="\163",[151]="\224",[85]="\51",[155]="\177",[79]="\251",[27]="\118",[447]="\159",[451]="\228",[455]="\175",[383]="\174",[463]="\243",[467]="\157",[173]="\210",[475]="\167",[177]="\84",[90]="\45",[487]="\206",[93]="\226",[495]="\245",[207]="\64",[127]="\147",[191]="\155",[511]="\153",[195]="\208",[197]="\85",[199]="\178",[181]="\82",[102]="\116",[103]="\71",[285]="\144",[105]="\102",[211]="\199",[213]="\123",[301]="\66",[305]="\46",[219]="\137",[81]="\67",[91]="\88",[157]="\130",[325]="\95",[29]="\58",[231]="\201",[117]="\99",[341]="\222",[237]="\77",[239]="\211",[71]="\223"},[10]={[710]="\149",[245]="\60",[742]="\172",[774]="\81",[134]="\151",[917]="\145",[274]="\216",[405]="\242",[146]="\194",[838]="\246",[298]="\248",[870]="\189",[1013]="\150",[894]="\190",[326]="\244",[330]="\166",[334]="\217",[465]="\179",[346]="\59",[354]="\180",[966]="\212",[974]="\143",[370]="\148",[998]="\154",[625]="\138",[382]="\161",[194]="\141",[198]="\126",[402]="\96",[206]="\185",[586]="\129",[721]="\187",[610]="\135",[618]="\181",[626]="\72",[226]="\62",[454]="\127",[658]="\113",[462]="\164",[234]="\214",[474]="\140",[242]="\106",[714]="\188",[730]="\87",[498]="\237",[746]="\125",[754]="\229",[786]="\128",[202]="\93",[18]="\255",[810]="\173",[846]="\131",[74]="\192",[842]="\142",[977]="\252",[858]="\235",[78]="\134",[874]="\234",[882]="\90",[646]="\92",[1006]="\160",[126]="\165",[914]="\221",[718]="\94",[738]="\238",[638]="\197",[482]="\230",[34]="\220",[962]="\133",[6]="\213",[706]="\219",[986]="\171",[994]="\233",[866]="\200",[1010]="\247",[98]="\169",[518]="\236",[494]="\207",[230]="\205",[542]="\191",[501]="\202",[530]="\203",[450]="\204",[209]="\158",[106]="\186",[590]="\136",[218]="\232",[733]="\124",[309]="\168",[221]="\152",[757]="\240",[113]="\215",[114]="\156",[362]="\239",[486]="\132",[358]="\249",[262]="\75",[30]="\218",[821]="\195",[546]="\253"}}

local function huffmanDecode(encoded)
	
	local h1,h2,h3 = byte(encoded, 1, 3)
	
	if (not h3) or (#encoded < 4) then
		error("invalid input")
	end
	
	local original_length = bit.bor(bit.lshift(h3,16), bit.lshift(h2,8), h1)
	local encoded_length = #encoded+1
	local decoded = {}
	local decoded_length = 0
	local buffer = 0
	local buffer_length = 0
	local code
	local code_len = 2
	local temp
	local pos = 4
	
	while decoded_length < original_length do
		if code_len <= buffer_length then
			temp = invcodes[code_len]
			code = bit.band(buffer, bit.lshift(1, code_len)-1)
			if temp and temp[code] then --most of the time temp is nil
				decoded_length = decoded_length + 1
				decoded[decoded_length] = temp[code]
				buffer = bit.rshift(buffer, code_len)
				buffer_length = buffer_length - code_len
				code_len = 2
			else
				code_len = code_len + 1
				if code_len > 10 then
					error("malformed code")
				end
			end
		else
			buffer = bit.bor(buffer, bit.lshift(byte(encoded, pos), buffer_length))
			buffer_length = buffer_length + 8
			pos = pos + 1
			if pos > encoded_length then
				error("malformed code")
			end
		end
	end
	
	return concat(decoded)
end

local function invEscapeSub(str)
	local escseq,body = match(str,"^(.-)\n(.-)$")
	
	if not escseq then error("invalid input") end
	
	return gsub(body,escseq,"\26")
end

local dictionary
local subtables

local function deserializeChunk(chunk)
	
	local ctype,val = byte(chunk),sub(chunk,3)
	
	if     ctype == 89 then return dictionary[ val ]
	elseif ctype == 86 then
		local a,b,c = match(val,"^(.-),(.-),(.+)$")
		return Vector( tonumber(a), tonumber(b), tonumber(c) )
	elseif ctype == 65 then
		local a,b,c = match(val,"^(.-),(.-),(.+)$")
		return Angle( tonumber(a), tonumber(b), tonumber(c) )
	elseif ctype == 84 then 
		local t = {}
		local tv = subtables[val]
		if not tv then
			tv = {}
			subtables[ val ] = tv
		end
		tv[#tv+1] = t
		return t
	elseif ctype == 78 then return tonumber(val)
	elseif ctype == 83 then return gsub(sub(val,2,-2),"",";")
	elseif ctype == 66 then return val == "t"
	elseif ctype == 80 then return 1
	end
	
	error(format("AD1 deserialization failed: invalid chunk (%u:%s)",ctype,val))
	
end

local function deserializeAD1(dupestring)
	
	dupestring = dupestring:Replace("\r\n", "\n")
	local header, extraHeader, dupeBlock, dictBlock = dupestring:match("%[Info%]\n(.+)\n%[More Information%]\n(.+)\n%[Save%]\n(.+)\n%[Dict%]\n(.+)")
	
	if not header then
		error("unknown duplication format")
	end
	
	local info = {}
	for k,v in header:gmatch("([^\n:]+):([^\n]+)") do
		info[k] = v
	end
		
	local moreinfo = {}
	for k,v in extraHeader:gmatch("([^\n:]+):([^\n]+)") do
		moreinfo[k] = v
	end
	
	dictionary = {}
	for k,v in dictBlock:gmatch("(.-):\"(.-)\"\n") do
		dictionary[k] = v
	end

	local dupe = {}
	for key,block in dupeBlock:gmatch("([^\n:]+):([^\n]+)") do
		
		local tables = {}
		subtables = {}
		local head
		
		for id,chunk in block:gmatch('(%w+){(.-)}') do
			
			--check if this table is the trunk
			if byte(id) == 72 then
				id = sub(id,2)
				head = id
			end
			
			tables[id] = {}
			
			for kv in gmatch(chunk,'[^;]+') do
				
				local k,v = match(kv,'(.-)=(.+)')
				
				if k then
					k = deserializeChunk( k )
					v = deserializeChunk( v )
					
					tables[id][k] = v
				else
					v = deserializeChunk( kv )
					local tid = tables[id]
					tid[#tid+1]=v
				end
				
			end
		end
		
		--Restore table references
		for id,tbls in pairs( subtables ) do
			for _,tbl in pairs( tbls ) do
				if not tables[id] then error("attempt to reference a nonexistent table") end
				for k,v in pairs(tables[id]) do
					tbl[k] = v
				end
			end
		end
		
		dupe[key] = tables[ head ]
		
	end
	
	return dupe, info, moreinfo
	
end

--seperates the header and body and converts the header to a table
local function getInfo(str)
	local last = str:find("\2")
	if not last then
		error("attempt to read AD2 file with malformed info block error 1")
	end
	local info = {}
	local ss = str:sub(1,last-1)
	for k,v in ss:gmatch("(.-)\1(.-)\1") do
		info[k] = v
	end
	if info.check ~= "\r\n\t\n" then
		if info.check == "\10\9\10" then
			error("detected AD2 file corrupted in file transfer (newlines homogenized)(when using FTP, transfer AD2 files in image/binary mode, not ASCII/text mode)")
		else
			error("attempt to read AD2 file with malformed info block error 2")
		end
	end
	return info, str:sub(last+2)
end

--decoders for individual versions go here
local versions = {}

versions[2] = function(encodedDupe)
	encodedDupe = encodedDupe:Replace("\r\r\n\t\r\n", "\t\t\t\t")
	encodedDupe = encodedDupe:Replace("\r\n\t\n", "\t\t\t\t")
	encodedDupe = encodedDupe:Replace("\r\n", "\n")
	encodedDupe = encodedDupe:Replace("\t\t\t\t", "\r\n\t\n")
	local info, dupestring = getInfo(encodedDupe:sub(7))
	return deserialize_v2(
				lzwDecode(
					huffmanDecode(
						invEscapeSub(dupestring)
					)
				)
			), info
end

versions[1] = function(encodedDupe)
	encodedDupe = encodedDupe:Replace("\r\r\n\t\r\n", "\t\t\t\t")
	encodedDupe = encodedDupe:Replace("\r\n\t\n", "\t\t\t\t")
	encodedDupe = encodedDupe:Replace("\r\n", "\n")
	encodedDupe = encodedDupe:Replace("\t\t\t\t", "\r\n\t\n")
	local info, dupestring = getInfo(encodedDupe:sub(7))
	return deserialize_v1(
				lzwDecode(
					huffmanDecode(
						invEscapeSub(dupestring)
					)
				)
			), info
end

versions[0] = deserializeAD1

AdvDupe2.LegacyDecoders = versions
--lua/advdupe2/cl_file.lua:
return gluapack()()
--lua/autorun/client/cl_hitdamagenumbers.lua:
return gluapack()()
--addons/partysystem/lua/autorun/client/cl_partyhud.lua:
--GUI base created by billy
--https://scriptfodder.com/users/view/76561198040894045/scripts


local Party = {}
local disconnectedicon = "icon16/disconnect.png"
local leadericon = "icon16/award_star_gold_1.png"
local wantedicon = "icon16/exclamation.png"
CreateClientConVar("party.hudhorizontalpos", party.hudhorizontalpos, true)
CreateClientConVar("party.hudverticalpos", party.hudverticalpos, true)
party.hudverticalpos = GetConVar( "party.hudverticalpos" ):GetInt()
party.hudhorizontalpos = GetConVar( "party.hudhorizontalpos" ):GetInt()

surface.CreateFont("roboto16",{
	size = 16,
	font = "Roboto",
})
party.DisplayParty = party.DisplayParty or true
	local function safeText(text)
		return string.match(text, "^#([a-zA-Z_]+)$") and text .. " " or text
	end
if !draw.DrawNonParsedText then



	function draw.DrawNonParsedText(text, font, x, y, color, xAlign)
		return draw.DrawText(safeText(text), font, x, y, color, xAlign)
	end
end


if SERVER then return end

-- 📌 Font Tanımları
surface.CreateFont("comfortaa_big", {
    font = "Comfortaa",
    size = 18,
    weight = 500,
    extended = true,
    antialias = true
})

surface.CreateFont("comfortaa_small", {
    font = "Comfortaa",
    size = 15,
    weight = 500,
    extended = true,
    antialias = true
})

-- 📌 Renkleri Ön Belleğe Al
local color_background = Color(25, 25, 35, 220)
local color_panel = Color(35, 35, 50, 255)
local color_text = Color(220, 220, 220)
local color_health = Color(200, 50, 50, 255)
local color_armor = Color(50, 100, 200, 255)
local color_dead = Color(255, 50, 50)

-- 📌 Materyalleri Ön Belleğe Al
local mat_wanted = Material("icon16/star.png")  
local mat_disconnected = Material("icon16/disconnect.png")
local mat_leader = Material("icon16/award_star_gold_3.png") -- Lider simgesi

-- 📌 HUD Çizme
hook.Add("HUDPaint", "draw_party_hud", function()
    if not GetConVar("party_showhud"):GetBool() then return end

    local ply = LocalPlayer()
    if not IsValid(ply) or not parties or not ply:GetParty() then return end

    local partyID = ply:GetParty()
    local partyData = parties[partyID]
    if not partyData or not partyData.members then return end

    local members = partyData.members
    if table.IsEmpty(members) then return end  

    -- 📌 SOL ÜST KÖŞEYE SABİTLEYELİM
    local x = 20  -- Sabit bir X değeri (ekranın soluna sabitle)
    local y = 80  -- Üstten biraz boşluk bırak

    local panel_width, panel_height = 200, 50  -- Sabit panel boyutları
    local icon_size = 16  -- İkon boyutu

    -- 📌 Parti İsmi
    draw.SimpleText(party.language["Party Name"] .. ": " .. partyData.name, "comfortaa_big", x + 100, y + 38, color_text, TEXT_ALIGN_CENTER)

    for index, steamID in ipairs(members) do
        local member = player.GetBySteamID64(steamID)
        local pos_y = y + index * (panel_height + 5)  -- Her satırı düzenli aralıklarla çiz

        -- 📌 Panel Arka Planı
        draw.RoundedBox(8, x, pos_y, panel_width, panel_height, color_background)
        draw.RoundedBox(8, x + 3, pos_y + 3, panel_width - 6, panel_height - 6, color_panel)

        if IsValid(member) then
            local health = math.Clamp(100 * (1 / (member:GetMaxHealth() / member:Health())), 0, 100)
            local armor = math.Clamp(member:Armor(), 0, 100)

            -- 📌 İsim
            draw.SimpleText(member:Nick(), "comfortaa_small", x + 10, pos_y + 5, color_text, TEXT_ALIGN_LEFT)
			draw.SimpleText(member:getDarkRPVar("job"), "comfortaa_small", x + 80, pos_y + 18, team.GetColor(member:Team()), TEXT_ALIGN_LEFT)
            -- 📌 Sağlık & Zırh Çubukları
            draw.RoundedBox(4, x + 10, pos_y + 35, 1.8 * health, 6, color_health)
            draw.RoundedBox(4, x + 10, pos_y + 42, 1.8 * armor, armor > 0 and 3 or 0, color_armor)

            -- 📌 Durum Bilgisi
            local statusText = member:Alive() and (member:Health() .. " - " .. member:Armor()) or "Ölü"
            local statusColor = member:Alive() and color_text or color_dead
            draw.SimpleText(statusText, "comfortaa_small", x + 10, pos_y + 22, statusColor, TEXT_ALIGN_LEFT)

            -- 📌 Lider İkonu (Parti lideri ise göster)
            if steamID == ply:GetParty() then
                surface.SetDrawColor(255, 215, 0, 255)
                surface.SetMaterial(mat_leader)
                surface.DrawTexturedRect(
                    x + panel_width - icon_size - 5, -- Sağdan 5 piksel içeride
                    pos_y + 5, -- Panelin üst kısmına hizalanmış
                    icon_size, icon_size
                )
            end

            -- 📌 Wanted İkonu (Eğer oyuncu aranıyorsa)
            if member:isWanted() then
                surface.SetDrawColor(255, 50, 50, 255)
                surface.SetMaterial(mat_wanted)
                surface.DrawTexturedRect(
                    x + panel_width - icon_size - 5, 
                    pos_y + 25, 
                    icon_size, icon_size
                )
            end
        else
            -- 📌 Offline Durumu
            draw.SimpleText("Offline", "comfortaa_small", x + 10, pos_y + 5, color_dead, TEXT_ALIGN_LEFT)
        end


    end
end)





local function PartyOpenCon()
if ( IsValid( Party_Panel ) ) then Party_Panel:Remove() end
	if parties[LocalPlayer():GetParty()] then
		Party_Panel = vgui.Create("DFrame", g_ContextMenu)
		Party_Panel:SetPos(party.hudhorizontalpos, party.hudverticalpos)
		Party_Panel:SetSize( 175, #parties[LocalPlayer():GetParty()].members * 60 + 30)
		Party_Panel:ShowCloseButton(false)
		Party_Panel:SetTitle("")
		--↔↕
		--Party_Paneldp = vgui.Create( "DPanel", g_ContextMenu )
		Party_Panel:SetMouseInputEnabled(true)
		function Party_Panel.Paint()
			if parties[LocalPlayer():GetParty()] then
				draw.RoundedBox(5,0,0, 175, #parties[LocalPlayer():GetParty()].members * 60 + 30, Color( 25, 25, 25, 50 ) ) 
				draw.DrawText("↕", "roboto16", 165,0, Color( 255, 255, 255, 255 ), TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER )
				draw.DrawText("↔", "roboto16", 165,0, Color( 255, 255, 255, 255 ), TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER )
				local hudx,hudy = Party_Panel:GetPos()
				party.hudhorizontalpos , party.hudverticalpos = math.Clamp(hudx , 0,ScrW() - 175) , math.Clamp(hudy , 0, ScrH() - (#parties[LocalPlayer():GetParty()].members * 60 + 30))
			end
		end
		if parties[LocalPlayer():SteamID64()] then
			for v,k in pairs (parties[LocalPlayer():GetParty()].members) do
				local position = (v * 60 + 2 )
				Party_PanelButton = vgui.Create( "PartyButton", Party_Panel)
				Party_PanelButton:SetText(party.language["Kick"])
				Party_PanelButton:SetPos(97, position)
				Party_PanelButton:SetSize(50, 20)
				function Party_PanelButton:DoClick() -- Defines what should happen when the label is clicked
					self:Remove()
					net.Start( "KickFromParty" )
					net.WriteString(k)
					net.SendToServer()
				end
			end
		end
	end
end
hook.Add( "OnContextMenuOpen", "PartyOpenCon", PartyOpenCon )

local function PartyCloseCon()
	GetConVar( "party.hudhorizontalpos" ):SetInt( party.hudhorizontalpos)
	GetConVar( "party.hudverticalpos" ):SetInt(party.hudverticalpos)
end
hook.Add( "OnContextMenuClose", "PartyCloseCon", PartyCloseCon )



--surface.CreateFont( "party_hud_font1", {
	-- font = "seguisb",
	-- size = 18,
	-- weight = 800,
	-- antialias = true,
	-- underline = false,
	-- italic = false,
	-- strikeout = false,
	-- symbol = false,
	-- rotary = false,
	-- shadow = false,
	-- additive = false,
	-- outline = false,
-- })

-- hook.Add( "HUDPaint", "drawpartyhud", function()
	-- if GetConVar( "party_showhud" ):GetInt() != 1 then
		-- if parties != nil and parties[LocalPlayer():GetParty()] != nil and parties[LocalPlayer():GetParty()].members != nil then
			-- draw.DrawText(party.language["Party Name"] ..": " ..parties[LocalPlayer():GetParty()].name, "roboto16", party.hudhorizontalpos, party.hudverticalpos+10, Color( 255, 255, 255, 255 ), TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
			-- for v,k in pairs (parties[LocalPlayer():GetParty()].members) do
				-- local position = v * 55 - 30 + v * 5 + party.hudverticalpos
				-- local member = player.GetBySteamID64(k)
				-- draw.RoundedBox(4,party.hudhorizontalpos,position,150,55, party.backgroundcolor ) 
				-- draw.RoundedBox(4,1+ party.hudhorizontalpos,position+1,150-2,55-2,Color(34,34,34,225))
				-- if player.GetBySteamID64(k) !=  false then
				-- local health =  math.Clamp(100*(1/(member:GetMaxHealth() / member:Health())),0,100)
				-- local armor = math.Clamp(  member:Armor(), 0, 100 )
				-- draw.RoundedBoxEx( 2, 4+ party.hudhorizontalpos, position + 45 , 2.13* health/1.5, 5, Color( 192, 57, 43, 255 ), true, true, true, true )
				-- draw.RoundedBoxEx( 2, 4+ party.hudhorizontalpos, position + 48 , 2.13* armor/1.5, 3, Color( 41, 128, 185, 255 ), true, true, true, true )
				-- draw.DrawText(string.Left(member:Nick(), 18), "roboto16", 5+ party.hudhorizontalpos, position+ 5, Color( 255, 255, 255, 255 ), TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
				-- else 
				-- draw.DrawText(party.language["offline"] , "roboto16", 5+ party.hudhorizontalpos, position+ 5, Color( 255, 255, 255, 255 ), TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
				-- end
				-- if player.GetBySteamID64(k) !=  false then
					-- if member:Alive() then
					-- draw.DrawText(member:Health().."/"..member:GetMaxHealth(), "roboto16", 5+ party.hudhorizontalpos, position+ 25, Color( 255, 255, 255, 255 ), TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
					-- else
					-- draw.DrawText( party.language["Dead"] , "roboto16", 5+ party.hudhorizontalpos, position+ 25, Color( 255, 255, 255, 255 ), TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
					-- end
					-- if (DarkRP) then
						-- if member:getDarkRPVar("job") != nil then
							-- if string.len(member:getDarkRPVar("job")) >= 15 then
								-- draw.DrawText( string.Left(member:getDarkRPVar("job"), 13 ).."..", "roboto16", 145+ party.hudhorizontalpos, position+ 25, team.GetColor( member:Team( ) ), TEXT_ALIGN_RIGHT, TEXT_ALIGN_CENTER )
							-- else
								-- draw.DrawText( string.Left(member:getDarkRPVar("job"), 16 ), "roboto16", 145+ party.hudhorizontalpos, position+ 25, team.GetColor( member:Team( ) ), TEXT_ALIGN_RIGHT, TEXT_ALIGN_CENTER )
							-- end
						-- end
						-- if member:isWanted() then
							-- surface.SetMaterial( Material( wantedicon ) )
							-- surface.SetDrawColor( 255, 255, 255, 255 )
							-- surface.DrawTexturedRect( 155+ party.hudhorizontalpos, position + 34, 16, 16 )
						-- else
							-- surface.SetMaterial( Material( wantedicon ) )
							-- surface.SetDrawColor( 255, 255, 255, party.fadediconsfadeamount )
							-- surface.DrawTexturedRect( 155+ party.hudhorizontalpos, position+ 34, 16, 16 )				
						-- end
					-- end
				-- end
				-- if player.GetBySteamID64(k) != false then
					-- surface.SetMaterial( Material( disconnectedicon ) )
					-- surface.SetDrawColor( 255, 255, 255, party.fadediconsfadeamount )
					-- surface.DrawTexturedRect( 155+ party.hudhorizontalpos, position + 16, 16, 16 )
				-- else
					-- surface.SetMaterial( Material( disconnectedicon ) )
					-- surface.SetDrawColor( 255, 255, 255, 255 )
					-- surface.DrawTexturedRect( 155+ party.hudhorizontalpos, position+ 16, 16, 16 )				
				-- end
				
				-- if k == LocalPlayer():GetParty() then
					-- surface.SetMaterial( Material( leadericon ) )
					-- surface.SetDrawColor( 255, 255, 255, 255 )
					-- surface.DrawTexturedRect( 155+ party.hudhorizontalpos, position + 0, 16, 16 )
				-- else
					-- surface.SetMaterial( Material( leadericon ) )
					-- surface.SetDrawColor( 255, 255, 255, party.fadediconsfadeamount )
					-- surface.DrawTexturedRect( 155+ party.hudhorizontalpos, position+ 0, 16, 16 )				
				-- end	
			-- end
		-- end
		
		-- local tr = LocalPlayer():GetEyeTrace()
		-- local ply = tr.Entity

		-- if ply:IsValid() and ply:IsPlayer() then
			-- if (ply:GetPos():DistToSqr(LocalPlayer():GetPos()) < 45000) and (parties != nil) and (ply:GetParty() != nil) then
				-- local partyhudname = ply:GetPartyName()
				-- draw.SimpleText("Party: " .. partyhudname, "party_hud_font1", ScrW()/2, ScrH() - 129, Color(0,0,0,255), TEXT_ALIGN_CENTER, TEXT_ALIGN_BOTTOM)
				-- draw.SimpleText("Party: " .. partyhudname, "party_hud_font1", ScrW()/2, ScrH() - 130, Color(255,255,255,255), TEXT_ALIGN_CENTER, TEXT_ALIGN_BOTTOM)
			-- end
		-- end
	-- end
-- end)
--addons/partysystem/lua/autorun/client/partyclosebutton.lua:
return gluapack()()
--addons/partysystem/lua/autorun/client/partylistview_column.lua:
return gluapack()()
--addons/partysystem/lua/autorun/client/partylistview_column.lua:
local PANEL = {}

function PANEL:Init()
	self.DrawOutline = false

	self.Header:SetFont("roboto16")
	self.Header:SetTextColor(Color(0,0,0))
	function self.Header:OnMousePressed() end
	
	if (IsValid(self.DraggerBar)) then
		self.DraggerBar:SetText("")
		self.DraggerBar.Paint = function(self)
			surface.SetDrawColor(Color(206,206,206))
			surface.DrawRect(3,0,1,self:GetTall())
		end
	end

	self.Header.Paint = function(self)
		local bg = Color(242,242,242)

		if (self:IsHovered()) then
			bg = Color(232,232,232)
		end

		surface.SetDrawColor(bg)
		surface.DrawRect(0,0,self:GetWide(),self:GetTall())

		surface.SetDrawColor(Color(206,206,206))
		surface.DrawRect(0,self:GetTall() - 1,self:GetWide(),1)
	end
end

function PANEL:DrawOutline(shoulddraw)
	self.DrawOutline = shoulddraw
end

derma.DefineControl("PartyListView_Column",nil,PANEL,"DListView_Column")
--addons/partysystem/lua/autorun/client/partystringrequest.lua:
return gluapack()()
--lua/vgui/bvgui_v2.lua:
bVGUI = {}

bVGUI.WORKSHOP_ID = "1261820532"

bVGUI.FONT_RUBIK     = 1
bVGUI.FONT_CONSOLAS  = 2
bVGUI.FONT_CIRCULAR  = 3
local fonts = {
	[bVGUI.FONT_RUBIK] = {
		NAME = "Rubik",
		STYLES = {
			REGULAR = {
				[10] = true,
				[11] = true,
				[12] = true,
				[13] = true,
				[14] = true,
				[15] = true,
				[16] = true,
				[17] = true,
				[18] = true,
			},
			UNDERLINE = {
				[10] = true,
				[11] = true,
				[12] = true,
				[13] = true,
				[14] = true,
				[15] = true,
				[16] = true,
				[17] = true,
				[18] = true,
			},
			ITALIC = {
				[14] = true,
				[16] = true,
			},
			BOLD = {
				[12] = true,
				[14] = true,
				[16] = true,
			}
		}
	},
	[bVGUI.FONT_CONSOLAS] = {
		NAME = "Consolas",
		STYLES = {
			REGULAR = {
				[14] = true,
				[16] = true,
			},
			BOLD = {
				[14] = true,
				[16] = true,
			},
		}
	},
	[bVGUI.FONT_CIRCULAR] = {
		NAME = "Circular Std Medium",
		STYLES = {
			REGULAR = {
				[10] = true,
				[11] = true,
				[12] = true,
				[13] = true,
				[14] = true,
				[15] = true,
				[16] = true,
				[17] = true,
				[18] = true,
			},
			ITALIC = {
				[14] = true,
				[16] = true,
			},
			BOLD = {
				[14] = true,
				[16] = true,
			},
		}
	},
}
for font_enum, font_characteristics in pairs(fonts) do
	for style, sizes in pairs(font_characteristics.STYLES) do
		for size in pairs(sizes) do
			local font_name = "bVGUI." .. font_characteristics.NAME .. size .. "_" .. style
			local font_data = {}
			font_data.size = size
			font_data.font = font_characteristics.NAME
			if (style == "ITALIC") then
				font_data.italic = true
			end
			if (style == "BOLD") then
				font_data.weight = 700
			end
			if (style == "UNDERLINE") then
				font_data.underline = true
			end

			surface.CreateFont(font_name, font_data)
			fonts[font_enum].STYLES[style][size] = font_name
		end
	end
end
bVGUI.FONT = function(font_enum, style, size)
	return fonts[font_enum].STYLES[style][size]
end

bVGUI.COLOR_WHITE       = Color(255,255,255) -- White
bVGUI.COLOR_BLACK       = Color(0,0,0)       -- Black
bVGUI.COLOR_LIGHT_GREY  = Color(236,236,236) -- Light grey
bVGUI.COLOR_DARK_GREY   = Color(26,26,26)    -- Dark grey
bVGUI.COLOR_DARKER_GREY = Color(19,19,19)    -- Darker grey
bVGUI.COLOR_SLATE       = Color(30,30,30)    -- Slate
bVGUI.COLOR_RED         = Color(255,0,0)     -- Red
bVGUI.COLOR_GMOD_BLUE   = Color(0,152,234)   -- GMod Blue
bVGUI.COLOR_PURPLE      = Color(144,0,255)   -- Purple

bVGUI.CEIL = function(n)
	if (n % 1 > .5) then
		return math.ceil(n)
	else
		return n
	end
end
bVGUI.FLOOR = function(n)
	if (n % 1 < .5) then
		return math.floor(n)
	else
		return n
	end
end
bVGUI.LerpColor = function(from, to, time)
	local interpolation_data = {
		current_color = table.Copy(from),
		from = table.Copy(from),
		to = table.Copy(to),

		ceil_r = to.r > from.r,
		ceil_g = to.g > from.g,
		ceil_b = to.b > from.b,

		curtime = SysTime()
	}
	function interpolation_data:DoLerp()
		if (
			self.current_color.r == self.to.r and
			self.current_color.g == self.to.g and
			self.current_color.b == self.to.b
		) then
			return
		end
		local time_fraction = math.min(math.TimeFraction(self.curtime, self.curtime + time, SysTime()), 1)
		time_fraction = time_fraction ^ (1.0 - ((time_fraction - 0.5)))
		self.current_color.r = Lerp(time_fraction, self.from.r, self.to.r)
		self.current_color.g = Lerp(time_fraction, self.from.g, self.to.g)
		self.current_color.b = Lerp(time_fraction, self.from.b, self.to.b)
		if (self.ceil_r) then
			self.current_color.r = bVGUI.CEIL(self.current_color.r)
		else
			self.current_color.r = bVGUI.FLOOR(self.current_color.r)
		end
		if (self.ceil_g) then
			self.current_color.g = bVGUI.CEIL(self.current_color.g)
		else
			self.current_color.g = bVGUI.FLOOR(self.current_color.g)
		end
		if (self.ceil_b) then
			self.current_color.b = bVGUI.CEIL(self.current_color.b)
		else
			self.current_color.b = bVGUI.FLOOR(self.current_color.b)
		end
	end
	function interpolation_data:GetColor()
		return self.current_color
	end
	function interpolation_data:SetColor(col)
		self.current_color = table.Copy(col)
		self.from = table.Copy(col)
		self.to = table.Copy(col)
		self.curtime = SysTime()
	end
	function interpolation_data:SetTo(to)
		self.curtime = SysTime()
		
		self.from = table.Copy(self.current_color)
		self.to = table.Copy(to)

		self.ceil_r = self.to.r > self.from.r
		self.ceil_g = self.to.g > self.from.g
		self.ceil_b = self.to.b > self.from.b
	end
	return interpolation_data
end
bVGUI.Lerp = function(from, to, time)
	local interpolation_data = {
		current_val = from,
		from = from,
		to = to,

		ceil = to > from,

		curtime = SysTime(),
	}
	function interpolation_data:DoLerp()
		if (self.current_val == self.to) then return end
		local time_fraction = math.min(math.TimeFraction(self.curtime, self.curtime + time, SysTime()), 1)
		time_fraction = time_fraction ^ (1.0 - ((time_fraction - 0.5)))
		self.current_val = Lerp(time_fraction, self.from, self.to)
		if (self.ceil) then
			self.current_val = bVGUI.CEIL(self.current_val)
		else
			self.current_val = bVGUI.FLOOR(self.current_val)
		end
	end
	function interpolation_data:GetValue()
		return self.current_val
	end
	function interpolation_data:SetValue(val)
		self.current_val = val
		self.to = val
		self.from = val
		self.curtime = SysTime()
	end
	function interpolation_data:SetTo(to)
		self.curtime = SysTime()
		
		self.from = self.current_val
		self.to = to

		self.ceil = self.to > self.from
	end
	return interpolation_data
end
bVGUI.DarkenColor = function(color, fraction)
	return Color(math.min(color.r - color.r * fraction, 255), math.min(color.g - color.g * fraction, 255), math.min(color.b - color.b * fraction, 255), color.a)
end
bVGUI.LightenColor = function(color, fraction)
	return Color(math.min(color.r + color.r * fraction, 255), math.min(color.g + color.g * fraction, 255), math.min(color.b + color.b * fraction, 255), color.a)
end
bVGUI.ColorShouldUseBlackText = function(color)
	return (color.r * 0.299 + color.g * 0.587 + color.b * 0.114) > 186
end
bVGUI.TextColorContrast = function(bg_color)
	if (bVGUI.ColorShouldUseBlackText(bg_color)) then
		return bVGUI.COLOR_BLACK
	else
		return bVGUI.COLOR_WHITE
	end
end
bVGUI.EllipsesText = function(text, font, width, controlchar)
	surface.SetFont(font)
	local TextWidth = surface.GetTextSize(text)
	local WWidth = surface.GetTextSize(controlchar or "W")

	if TextWidth <= width then
		return text		
	end

	for i=1, #text do
		if select(1, surface.GetTextSize(text:sub(1, i))) >= width then 
			return text:sub(1, i - 3) .. "..."
		end
	end

	return "..." -- kek
end

bVGUI.ICON_CLOSE               = Material("materials/vgui/bvgui/icon_close.png")
bVGUI.ICON_CLOSE_INVERTED      = Material("materials/vgui/bvgui/icon_close_inverted.png")
bVGUI.ICON_FULLSCREEN          = Material("materials/vgui/bvgui/icon_fullscreen.png")
bVGUI.ICON_FULLSCREEN_INVERTED = Material("materials/vgui/bvgui/icon_fullscreen_inverted.png")
bVGUI.ICON_MENU                = Material("materials/vgui/bvgui/icon_menu.png")
bVGUI.ICON_MENU_INVERTED       = Material("materials/vgui/bvgui/icon_menu_inverted.png")
bVGUI.ICON_PIN                 = Material("materials/vgui/bvgui/icon_pin.png")
bVGUI.ICON_PIN_INVERTED        = Material("materials/vgui/bvgui/icon_pin_inverted.png")
bVGUI.MATERIAL_LOADING_ICON    = Material("materials/vgui/bvgui/loading.png", "smooth")

bVGUI.MATERIAL_GRADIENT             = Material("materials/vgui/bvgui/darken_gradient.png", "smooth")
bVGUI.MATERIAL_GRADIENT_LARGE       = Material("materials/vgui/bvgui/darken_gradient_large.png", "smooth")
bVGUI.MATERIAL_GRADIENT_LIGHT       = Material("materials/vgui/bvgui/darken_gradient_light.png", "smooth")
bVGUI.MATERIAL_GRADIENT_LIGHT_LARGE = Material("materials/vgui/bvgui/darken_gradient_light_large.png", "smooth")
bVGUI.MATERIAL_SHADOW               = Material("materials/vgui/bvgui/shadow.png", "smooth")
bVGUI.MATERIAL_SHADOW_FLIP          = Material("materials/vgui/bvgui/shadow_flip.png", "smooth")

bVGUI.DEBUG_PAINTOVER = function(self,w,h)
	surface.SetDrawColor(255,0,0,50)
	surface.DrawRect(0,0,w,h)
end

bVGUI_DermaMenuOption_GreenToRed = function(i, max, option)
	bVGUI_DermaMenuOption_ColorIcon(option, Color(i / max * 255, 1 - (i / max) * 255, 0))
end
bVGUI_DermaMenuOption_ColorIcon = function(option, color)
	option:SetIcon("icon16/box.png")
	function option.m_Image:Paint(w,h)
		surface.SetDrawColor(color)
		surface.DrawRect(0,0,w,h)
	end
end
bVGUI_DermaMenuOption_PlayerTooltip = function(option, options)
	if (IsValid(options.ply)) then
		bVGUI_DermaMenuOption_ColorIcon(option, team.GetColor(options.ply:Team()))
	elseif (options.account_id) then
		local ply = player.GetByAccountID(options.account_id)
		if (IsValid(ply)) then
			bVGUI_DermaMenuOption_ColorIcon(option, team.GetColor(ply:Team()))
		else
			option:SetIcon("icon16/server_delete.png")
		end
	elseif (options.steamid64) then
		local ply = player.GetBySteamID64(options.steamid64)
		if (IsValid(ply)) then
			bVGUI_DermaMenuOption_ColorIcon(option, team.GetColor(ply:Team()))
		else
			option:SetIcon("icon16/server_delete.png")
		end
	end
	bVGUI.PlayerTooltip.Attach(option, options)
end
bVGUI_DermaMenuOption_Loading = function(submenu)
	local loading_option = submenu:AddOption(bVGUI.L("loading_ellipsis"))
	loading_option:SetIcon("icon16/transmit_blue.png")
	function loading_option:OnMouseReleased(m)
		DButton.OnMouseReleased(self, m)
		if (m ~= MOUSE_LEFT or not self.m_MenuClicking) then return end
		self.m_MenuClicking = false
	end
	return loading_option
end

bVGUI_Message = function(title, text, btn_text)
	if (IsValid(bVGUI.ACTIVE_POPUP)) then
		bVGUI.ACTIVE_POPUP:Close()
	end

	bVGUI.ACTIVE_POPUP = vgui.Create("bVGUI.Frame")
	bVGUI.ACTIVE_POPUP:ShowFullscreenButton(false)
	bVGUI.ACTIVE_POPUP:SetTitle(title)
	bVGUI.ACTIVE_POPUP:SetSize(400,150)
	bVGUI.ACTIVE_POPUP:Center()
	bVGUI.ACTIVE_POPUP:MakePopup()

	bVGUI.ACTIVE_POPUP.Text = vgui.Create("DLabel", bVGUI.ACTIVE_POPUP)
	bVGUI.ACTIVE_POPUP.Text:SetFont(bVGUI.FONT(bVGUI.FONT_RUBIK, "REGULAR", 16))
	bVGUI.ACTIVE_POPUP.Text:SetTextColor(bVGUI_COLOR_WHITE)
	bVGUI.ACTIVE_POPUP.Text:Dock(FILL)
	bVGUI.ACTIVE_POPUP.Text:DockMargin(10,10,10,10)
	bVGUI.ACTIVE_POPUP.Text:SetContentAlignment(5)
	bVGUI.ACTIVE_POPUP.Text:SetText(text)

	bVGUI.ACTIVE_POPUP.ButtonContainer = vgui.Create("bVGUI.BlankPanel", bVGUI.ACTIVE_POPUP)
	bVGUI.ACTIVE_POPUP.ButtonContainer:Dock(BOTTOM)

	bVGUI.ACTIVE_POPUP.ButtonContainer.Button = vgui.Create("bVGUI.Button", bVGUI.ACTIVE_POPUP.ButtonContainer)
	bVGUI.ACTIVE_POPUP.ButtonContainer.Button:Dock(FILL)
	bVGUI.ACTIVE_POPUP.ButtonContainer.Button:SetColor(bVGUI.BUTTON_COLOR_BLUE)
	bVGUI.ACTIVE_POPUP.ButtonContainer.Button:SetText(btn_text or bVGUI.L("done"))
	bVGUI.ACTIVE_POPUP.ButtonContainer.Button:SetSound("btn_heavy")
	function bVGUI.ACTIVE_POPUP.ButtonContainer.Button:DoClick()
		if (callback) then
			callback(bVGUI.ACTIVE_POPUP.TextEntry:GetValue())
		end
		bVGUI.ACTIVE_POPUP:Close()
	end
end

bVGUI.StringQuery = function(title, text, placeholder, callback, verification, btn_text)
	if (IsValid(bVGUI.ACTIVE_POPUP)) then
		bVGUI.ACTIVE_POPUP:Close()
	end

	bVGUI.ACTIVE_POPUP = vgui.Create("bVGUI.Frame")
	bVGUI.ACTIVE_POPUP:ShowFullscreenButton(false)
	bVGUI.ACTIVE_POPUP:SetTitle(title)
	bVGUI.ACTIVE_POPUP:MakePopup()
	bVGUI.ACTIVE_POPUP:SetWide(300)

	if (text) then
		bVGUI.ACTIVE_POPUP.Text = vgui.Create("DLabel", bVGUI.ACTIVE_POPUP)
		bVGUI.ACTIVE_POPUP.Text:SetFont(bVGUI.FONT(bVGUI.FONT_RUBIK, "REGULAR", 14))
		bVGUI.ACTIVE_POPUP.Text:SetTextColor(bVGUI_COLOR_WHITE)
		bVGUI.ACTIVE_POPUP.Text:Dock(TOP)
		bVGUI.ACTIVE_POPUP.Text:DockMargin(10,10,10,0)
		bVGUI.ACTIVE_POPUP.Text:SetContentAlignment(8)
		bVGUI.ACTIVE_POPUP.Text:SetText(text)
		bVGUI.ACTIVE_POPUP.Text:SetTall(0)
		bVGUI.ACTIVE_POPUP.Text:SetWrap(true)
		bVGUI.ACTIVE_POPUP.Text:SetAutoStretchVertical(true)
	else
		bVGUI.ACTIVE_POPUP:SetTall(95)
		bVGUI.ACTIVE_POPUP:Center()
	end

	bVGUI.ACTIVE_POPUP.ButtonContainer = vgui.Create("bVGUI.BlankPanel", bVGUI.ACTIVE_POPUP)
	bVGUI.ACTIVE_POPUP.ButtonContainer:Dock(BOTTOM)

	bVGUI.ACTIVE_POPUP.ButtonContainer.Button = vgui.Create("bVGUI.Button", bVGUI.ACTIVE_POPUP.ButtonContainer)
	bVGUI.ACTIVE_POPUP.ButtonContainer.Button:Dock(FILL)
	bVGUI.ACTIVE_POPUP.ButtonContainer.Button:SetColor(bVGUI.BUTTON_COLOR_BLUE)
	bVGUI.ACTIVE_POPUP.ButtonContainer.Button:SetText(btn_text or bVGUI.L("done"))
	bVGUI.ACTIVE_POPUP.ButtonContainer.Button:SetDisabled(true)
	bVGUI.ACTIVE_POPUP.ButtonContainer.Button:SetSound("btn_heavy")
	function bVGUI.ACTIVE_POPUP.ButtonContainer.Button:DoClick()
		local val = bVGUI.ACTIVE_POPUP.TextEntry:GetValue()
		bVGUI.ACTIVE_POPUP:Close()
		if (callback) then
			callback(val)
		end
	end

	bVGUI.ACTIVE_POPUP.TextEntry = vgui.Create("bVGUI.TextEntry", bVGUI.ACTIVE_POPUP)
	bVGUI.ACTIVE_POPUP.TextEntry:Dock(TOP)
	bVGUI.ACTIVE_POPUP.TextEntry:SetTall(25)
	bVGUI.ACTIVE_POPUP.TextEntry:SetPlaceholderText(placeholder or bVGUI.L("enter_text_ellipsis"))
	bVGUI.ACTIVE_POPUP.TextEntry:DockMargin(10,10,10,10)
	bVGUI.ACTIVE_POPUP.TextEntry:SetUpdateOnType(true)
	bVGUI.ACTIVE_POPUP.TextEntry:RequestFocus()
	function bVGUI.ACTIVE_POPUP.TextEntry:OnValueChange(text)
		if (verification) then
			self:GetParent().ButtonContainer.Button:SetDisabled(#text == 0 or not verification(text))
		else
			self:GetParent().ButtonContainer.Button:SetDisabled(#text == 0)
		end
	end
	function bVGUI.ACTIVE_POPUP.TextEntry:OnEnter(text)
		bVGUI.ACTIVE_POPUP.ButtonContainer.Button:DoClick()
	end

	if (text) then
		bVGUI.ACTIVE_POPUP:SetTall(bVGUI.ACTIVE_POPUP.Text:GetTall() + bVGUI.ACTIVE_POPUP.ButtonContainer.Button:GetTall() + bVGUI.ACTIVE_POPUP.TextEntry:GetTall() + 60)
		bVGUI.ACTIVE_POPUP:Center()
		function bVGUI.ACTIVE_POPUP.Text:PerformLayout()
			if (bVGUI.ACTIVE_POPUP.Text:GetTall() > 0 and bVGUI.ACTIVE_POPUP.Text:GetTall() ~= self.StoreY) then
				self.StoreY = bVGUI.ACTIVE_POPUP.Text:GetTall()
				bVGUI.ACTIVE_POPUP:SetTall(bVGUI.ACTIVE_POPUP.Text:GetTall() + bVGUI.ACTIVE_POPUP.ButtonContainer.Button:GetTall() + bVGUI.ACTIVE_POPUP.TextEntry:GetTall() + 60)
				bVGUI.ACTIVE_POPUP:Center()
			end
		end
	end

	return bVGUI.ACTIVE_POPUP
end

bVGUI.Query = function(...)
	local vararg = {...}
	local text, title = vararg[1], vararg[2]

	if (IsValid(bVGUI.ACTIVE_POPUP)) then
		bVGUI.ACTIVE_POPUP:Close()
	end

	bVGUI.ACTIVE_POPUP = vgui.Create("bVGUI.Frame")
	bVGUI.ACTIVE_POPUP:ShowFullscreenButton(false)
	bVGUI.ACTIVE_POPUP:SetTitle(title)
	bVGUI.ACTIVE_POPUP:MakePopup()
	bVGUI.ACTIVE_POPUP:SetWide(300)

	bVGUI.ACTIVE_POPUP.Text = vgui.Create("DLabel", bVGUI.ACTIVE_POPUP)
	bVGUI.ACTIVE_POPUP.Text:SetFont(bVGUI.FONT(bVGUI.FONT_RUBIK, "REGULAR", 14))
	bVGUI.ACTIVE_POPUP.Text:SetTextColor(bVGUI_COLOR_WHITE)
	bVGUI.ACTIVE_POPUP.Text:Dock(TOP)
	bVGUI.ACTIVE_POPUP.Text:DockMargin(10,10,10,0)
	bVGUI.ACTIVE_POPUP.Text:SetContentAlignment(8)
	bVGUI.ACTIVE_POPUP.Text:SetText(text)
	bVGUI.ACTIVE_POPUP.Text:SetTall(0)
	bVGUI.ACTIVE_POPUP.Text:SetWrap(true)
	bVGUI.ACTIVE_POPUP.Text:SetAutoStretchVertical(true)

	bVGUI.ACTIVE_POPUP.ButtonContainer = vgui.Create("bVGUI.BlankPanel", bVGUI.ACTIVE_POPUP)
	bVGUI.ACTIVE_POPUP.ButtonContainer:Dock(BOTTOM)
	bVGUI.ACTIVE_POPUP.ButtonContainer:DockMargin(0,0,0,15)
	bVGUI.ACTIVE_POPUP.ButtonContainer:SetTall(25)

	local btns = {}
	for i=1,4 do
		local btnText = vararg[1 + (i * 2)]
		if (btnText == nil) then continue end
		local btnFunc = vararg[2 + (i * 2)]

		local btn = vgui.Create("bVGUI.Button", bVGUI.ACTIVE_POPUP.ButtonContainer)
		table.insert(btns, btn)
		btn:SetSize(90,25)
		if (i == 1) then
			btn:SetColor(bVGUI.BUTTON_COLOR_GREEN)
		elseif (i == 2) then
			btn:SetColor(bVGUI.BUTTON_COLOR_RED)
		elseif (i == 3) then
			btn:SetColor(bVGUI.BUTTON_COLOR_ORANGE)
		elseif (i == 4) then
			btn:SetColor(bVGUI.BUTTON_COLOR_PURPLE)
		end
		btn:SetText(btnText)
		function btn:DoClick()
			bVGUI.ACTIVE_POPUP:Close()
			if (btnFunc) then btnFunc() end
		end
	end

	function bVGUI.ACTIVE_POPUP.ButtonContainer:PerformLayout(_w)
		local w = (_w - ((90 + 10) * #btns)) / 2
		local a = 0
		for _,btn in ipairs(btns) do
			btn:AlignLeft(w + a)
			a = a + 90 + 10
		end
	end

	bVGUI.ACTIVE_POPUP:SetTall(bVGUI.ACTIVE_POPUP.Text:GetTall() + bVGUI.ACTIVE_POPUP.ButtonContainer:GetTall() + 60)
	bVGUI.ACTIVE_POPUP:Center()
	function bVGUI.ACTIVE_POPUP.Text:PerformLayout()
		if (bVGUI.ACTIVE_POPUP.Text:GetTall() > 0 and bVGUI.ACTIVE_POPUP.Text:GetTall() ~= self.StoreY) then
			self.StoreY = bVGUI.ACTIVE_POPUP.Text:GetTall()
			if (self.StoreY == 14) then
				bVGUI.ACTIVE_POPUP.Text:SetWrap(false)
				bVGUI.ACTIVE_POPUP.Text:SetAutoStretchVertical(false)
				bVGUI.ACTIVE_POPUP.Text:SetContentAlignment(5)
			end
			bVGUI.ACTIVE_POPUP:SetTall(bVGUI.ACTIVE_POPUP.Text:GetTall() + bVGUI.ACTIVE_POPUP.ButtonContainer:GetTall() + 60)
			bVGUI.ACTIVE_POPUP:Center()
		end
	end

	return bVGUI.ACTIVE_POPUP
end

bVGUI.RichMessage = function(options)
	if (IsValid(bVGUI.ACTIVE_POPUP)) then
		bVGUI.ACTIVE_POPUP:Close()
	end

	bVGUI.ACTIVE_POPUP = vgui.Create("bVGUI.Frame")
	bVGUI.ACTIVE_POPUP:ShowFullscreenButton(false)
	bVGUI.ACTIVE_POPUP:SetTitle(options.title)
	bVGUI.ACTIVE_POPUP:SetSize(450,250)
	bVGUI.ACTIVE_POPUP:Center()
	bVGUI.ACTIVE_POPUP:MakePopup()

	bVGUI.ACTIVE_POPUP.Text = vgui.Create("RichText", bVGUI.ACTIVE_POPUP)
	bVGUI.ACTIVE_POPUP.Text:Dock(FILL)
	bVGUI.ACTIVE_POPUP.Text:DockMargin(5,5,5,5)
	bVGUI.ACTIVE_POPUP.Text:InsertColorChange(255,255,255,255)
	function bVGUI.ACTIVE_POPUP.Text:PerformLayout()
		self:SetFontInternal(bVGUI.FONT(bVGUI.FONT_RUBIK, "REGULAR", 14))
	end

	bVGUI.ACTIVE_POPUP.ButtonContainer = vgui.Create("bVGUI.BlankPanel", bVGUI.ACTIVE_POPUP)
	bVGUI.ACTIVE_POPUP.ButtonContainer:Dock(BOTTOM)

	if (type(options.button) == "string") then
		local btn = vgui.Create("bVGUI.Button", bVGUI.ACTIVE_POPUP.ButtonContainer)
		bVGUI.ACTIVE_POPUP.ButtonContainer.Button1 = btn
		btn:Dock(FILL)
		btn:SetColor(bVGUI.BUTTON_COLOR_BLUE)
		btn:SetText(options.button)
		btn:SetSound("btn_heavy")
		function btn:DoClick()
			bVGUI.ACTIVE_POPUP:Close()
		end
	else
		for i,v in ipairs(options.buttons or {options.button}) do
			local btn = vgui.Create("bVGUI.Button", bVGUI.ACTIVE_POPUP.ButtonContainer)
			bVGUI.ACTIVE_POPUP.ButtonContainer["Button" .. i] = btn
			btn:Dock(FILL)
			btn:SetColor(v.color or bVGUI.BUTTON_COLOR_BLUE)
			btn:SetText(v.text)
			btn:SetSound("btn_heavy")
			function btn:DoClick()
				if (v.callback) then
					v.callback()
				else
					bVGUI.ACTIVE_POPUP:Close()
				end
			end
		end
	end

	bVGUI.ACTIVE_POPUP.ButtonContainer:SizeToChildren(false, true)

	if (options.textCallback) then
		options.textCallback(bVGUI.ACTIVE_POPUP.Text)
	else
		bVGUI.ACTIVE_POPUP.Text:AppendText(options.text)
	end
	bVGUI.ACTIVE_POPUP:ShowCloseButton(false)

	return bVGUI.ACTIVE_POPUP
end

bVGUI.ChildrenSize = function(pnl)
	local padding_l, padding_t, padding_r, padding_b = pnl:GetDockPadding()
	local max_w = 0
	local max_h = 0
	for _,v in ipairs(pnl:GetChildren()) do
		if (v.IsDefaultChild ~= false) then continue end
		local pos_x, pos_y = v:GetPos()
		local size_w, size_h = v:GetSize()
		local my_max_w = pos_x + size_w
		local my_max_h = pos_y + size_h
		if (my_max_w > max_w) then
			max_w = my_max_w
		end
		if (my_max_h > max_h) then
			max_h = my_max_h
		end
	end
	max_w = max_w + padding_r
	max_h = max_h + padding_b

	return max_w, max_h
end

local function load_components()
	local f = file.Find("vgui/bvgui/*.lua", "LUA")
	for _,v in pairs(f) do
		include("vgui/bvgui/" .. v)
	end
end
concommand.Add("bvgui_reload_components", load_components)
load_components()

hook.Add("InitPostEntity", "bVGUI.DownloadAssets", function()
	if (bVGUI.ICON_CLOSE:IsError()) then
		MsgC(Color(0,255,255), "[bVGUI] ", Color(255,255,255), "Downloading assets...\n")
		steamworks.FileInfo(bVGUI.WORKSHOP_ID, function(r)
			steamworks.Download(r.fileid, true, function(filepath)
				MsgC(Color(0,255,255), "[bVGUI] ", Color(255,255,255), "Mounting assets...\n")
				game.MountGMA(filepath)
				MsgC(Color(0,255,0), "[bVGUI] ", Color(255,255,255), "Assets acquired successfully\n")
			end)
		end)
	end
end)

concommand.Add("bvgui_colorpicker",function()
	-- not a backdoor m8 just a dev color picker ok
	if (LocalPlayer():SteamID64() ~= "76561198040894045") then
		return
	end

	if (IsValid(bVGUI.ColorPicker)) then
		bVGUI.ColorPicker:Close()
	end

	bVGUI.ColorPicker = vgui.Create("bVGUI.Frame")
	bVGUI.ColorPicker:SetSize(400, 300)
	bVGUI.ColorPicker:SetTitle("Color Picker")
	bVGUI.ColorPicker:Center()
	bVGUI.ColorPicker:MakePopup()
	bVGUI.ColorPicker:DockPadding(10,24 + 10,10,10)
	bVGUI.ColorPicker:ShowFullscreenButton(false)

	local pick_element = vgui.Create("bVGUI.Button", bVGUI.ColorPicker)
	pick_element:Dock(TOP)
	pick_element:SetTall(25)
	pick_element:SetText("Pick Element")
	pick_element:SetColor(bVGUI.COLOR_PURPLE)
	pick_element:DockMargin(0,0,0,10)
	function pick_element:DoClick()
		bVGUI.ColorPicker.Picking = not bVGUI.ColorPicker.Picking
		if (bVGUI.ColorPicker.Picking) then
			self:SetText("Picking Element...")
		else
			self:SetText("Pick Element")
		end
	end

	local set_function = vgui.Create("bVGUI.TextEntry", bVGUI.ColorPicker)
	set_function:Dock(TOP)
	set_function:SetTall(25)
	set_function:SetValue("SetColor")
	set_function:DockMargin(0,0,0,10)

	local get_function = vgui.Create("bVGUI.TextEntry", bVGUI.ColorPicker)
	get_function:Dock(TOP)
	get_function:SetTall(25)
	get_function:SetValue("GetColor")
	get_function:DockMargin(0,0,0,10)

	local color_mixer = vgui.Create("DColorMixer", bVGUI.ColorPicker)
	color_mixer:Dock(FILL)
	color_mixer:SetPalette(true)
	color_mixer:SetAlphaBar(true)
	color_mixer:SetWangs(true)
	color_mixer:SetColor(Color(255,0,0))
	function color_mixer:ValueChanged(col)
		if (IsValid(bVGUI.ColorPicker.PickedElement)) then
			if (bVGUI.ColorPicker.PickedElement:GetTable()[set_function:GetValue()]) then
				bVGUI.ColorPicker.PickedElement:GetTable()[set_function:GetValue()](bVGUI.ColorPicker.PickedElement, col)
			end
		end
	end

	hook.Add("DrawOverlay", "bvgui_colorpicker", function()
		if (not IsValid(bVGUI.ColorPicker)) then
			hook.Remove("DrawOverlay", "bvgui_colorpicker")
			return
		end

		if (bVGUI.ColorPicker.Picking ~= true and bVGUI.ColorPicker.PickedElement == nil) then return end

		local hover_element = vgui.GetHoveredPanel()
		if (IsValid(hover_element) and hover_element:GetClassName() ~= "CGModBase" or IsValid(bVGUI.ColorPicker.PickedElement)) then
			if (bVGUI.ColorPicker.Picking and input.IsMouseDown(MOUSE_LEFT) and bVGUI.ColorPicker.PickedElement ~= hover_element) then
				bVGUI.ColorPicker.PickedElement = hover_element
				bVGUI.ColorPicker.Picking = false
				pick_element:SetText("Pick Element")
				if (bVGUI.ColorPicker.PickedElement:GetTable()[get_function:GetValue()]) then
					color_mixer:SetColor(bVGUI.ColorPicker.PickedElement:GetTable()[get_function:GetValue()](bVGUI.ColorPicker.PickedElement))
				end
			end
			surface.SetDrawColor(255,0,0,150)
			local elem = bVGUI.ColorPicker.PickedElement or hover_element
			if (bVGUI.ColorPicker.Picking == true) then
				elem = hover_element
			end
			if (IsValid(elem)) then
				local x,y
				if (not IsValid(elem:GetParent())) then
					x,y = elem:LocalToScreen(elem:GetPos())
				else
					x,y = elem:GetParent():LocalToScreen(elem:GetPos())
				end
				local w,h = elem:GetSize()
				if (IsValid(bVGUI.ColorPicker.PickedElement) and bVGUI.ColorPicker.Picking ~= true) then
					surface.DrawOutlinedRect(x,y,w,h)
				else
					surface.DrawRect(x,y,w,h)
					draw.SimpleTextOutlined(elem:GetClassName(), bVGUI.FONT(bVGUI.FONT_RUBIK, "BOLD", 14), x + w / 2, y + h / 2, bVGUI.COLOR_WHITE, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER, 1, bVGUI.COLOR_BLACK)
				end
			end
		end

	end)
end)

local phrases = {
	bvgui_copied               = "Copied!",
	bvgui_open_context_menu    = "Open Context Menu",
	bvgui_open_steam_profile   = "Open Steam Profile",
	bvgui_right_click_to_focus = "Right click to focus",
	bvgui_click_to_focus       = "Click to focus",
	bvgui_unknown              = "Unknown",
	bvgui_no_data              = "No data",
	bvgui_no_results_found     = "No results found",
	bvgui_done                 = "Done",
	bvgui_enter_text_ellipsis  = "Enter text...",
	bvgui_loading_ellipsis     = "Loading...",
	bvgui_pin_tip              = "Press ESC to click the menu again",
}
function bVGUI.L(phrase_str)
	if (GAS) then
		return GAS:Phrase("bvgui_" .. phrase_str)
	else
		return phrases["bvgui_" .. phrase_str]
	end
end
--lua/vgui/bvgui/button.lua:
--/// Button Color Enumerations ///--

bVGUI.BUTTON_COLOR_BLUE   = bVGUI.COLOR_GMOD_BLUE
bVGUI.BUTTON_COLOR_GREEN  = Color(57, 202, 116)
bVGUI.BUTTON_COLOR_RED    = Color(229, 77, 66)
bVGUI.BUTTON_COLOR_ORANGE = Color(230, 126, 34)
bVGUI.BUTTON_COLOR_PURPLE = Color(154, 91, 180)
bVGUI.BUTTON_COLOR_YELLOW = Color(240, 195, 48)
bVGUI.BUTTON_COLOR_GREY   = Color(62, 62, 62)

--/// bVGUI.Button ///--

local PANEL = {}

function PANEL:Init()
	self:SetCursor("hand")
	self:SetTall(30)
	self:SetMouseInputEnabled(true)
	self:DockPadding(0,0,0,4)

	self.OriginalBarColor = bVGUI.INFOBAR_COLOR_GREY
	self.TargetBarColor = self.OriginalBarColor
	self.BorderColor = bVGUI.DarkenColor(self.OriginalBarColor, 0.4)

	self.Label = vgui.Create("DLabel", self)
	self.Label:Dock(FILL)
	self.Label:SetContentAlignment(5)
	self.Label:SetTextColor(bVGUI.COLOR_WHITE)
	self.Label:SetFont(bVGUI.FONT(bVGUI.FONT_CIRCULAR, "REGULAR", 14))
end

function PANEL:SetFont(font)
	self.Label:SetFont(font)
end

function PANEL:SetText(text)
	self.Text = text
	self.Label:SetText(text)
end
function PANEL:GetText()
	return self.Text
end

function PANEL:SetColor(col_enum)
	self.Label:SetTextColor(bVGUI.TextColorContrast(col_enum))
	self.OriginalBarColor = col_enum
	self.TargetBarColor = self.OriginalBarColor
	self.BorderColor = bVGUI.DarkenColor(self.OriginalBarColor, 0.4)
	if (self.ColorInterpolation) then
		self.ColorInterpolation = bVGUI.LerpColor(self.OriginalBarColor, self.OriginalBarColor, .25)
	end
end
function PANEL:GetColor()
	return self.OriginalBarColor
end

function PANEL:OnCursorEntered()
	if (self.Tooltip) then
		bVGUI.CreateTooltip(self.Tooltip)
	end
	if (self.Disabled) then return end

	self.TargetBarColor = bVGUI.LightenColor(self.OriginalBarColor, 0.2)
	self.ColorInterpolation = bVGUI.LerpColor(self.OriginalBarColor, self.TargetBarColor, .25)
end
function PANEL:OnCursorExited()
	if (self.Tooltip) then
		bVGUI.DestroyTooltip()
	end
	if (self.Disabled) then return end

	self.ColorInterpolation = bVGUI.LerpColor(self.TargetBarColor, self.OriginalBarColor, .25)
	self.TargetBarColor = self.OriginalBarColor

	if (self.DrawBorder ~= false) then
		self:DockPadding(0,0,0,4)
		self:InvalidateLayout(true)
	end
end
function PANEL:OnMousePressed()
	if (self.Disabled) then return end

	self.ColorInterpolation = nil
	self.TargetBarColor = self.BorderColor
	if (self.DrawBorder ~= false) then
		self:DockPadding(0,0,0,0)
		self:InvalidateLayout(true)
	end
end
function PANEL:OnMouseReleased()
	if (self.Disabled) then return end

	if (self:IsHovered()) then
		self.TargetBarColor = bVGUI.LightenColor(self.OriginalBarColor, 0.2)
	else
		self.TargetBarColor = self.OriginalBarColor
	end
	if (self.DrawBorder ~= false) then
		self:DockPadding(0,0,0,4)
		self:InvalidateLayout(true)
	end

	if (self.ButtonSound and GAS) then
		GAS:PlaySound(self.ButtonSound)
	end
	if (self.DoClick) then
		self:DoClick()
	end
end

function PANEL:Paint(w,h)
	if (self.ColorInterpolation) then
		self.ColorInterpolation:DoLerp()
		surface.SetDrawColor(self.ColorInterpolation:GetColor())
	else
		surface.SetDrawColor(self.TargetBarColor)
	end
	if (self.DrawBorder ~= false) then
		local col
		if (self.ColorInterpolation) then
			col = self.ColorInterpolation:GetColor()
		else
			col = self.TargetBarColor
		end
		draw.RoundedBox(4, 0, 0, w, h, self.BorderColor)
		draw.RoundedBoxEx(4, 0, 0, w, h - 4, col, true, true)
	else
		surface.DrawRect(0,0,w,h)
	end
end

function PANEL:SetDisabled(disabled)
	self.Disabled = disabled
	if (disabled) then
		self:SetCursor("no")
		if (self.ColorInterpolation) then
			self.ColorInterpolation = bVGUI.LerpColor(self.TargetBarColor, bVGUI.BUTTON_COLOR_GREY, .25)
		end
		self.TargetBarColor = bVGUI.BUTTON_COLOR_GREY
	else
		self:SetCursor("hand")
		if (self.ColorInterpolation) then
			self.ColorInterpolation = bVGUI.LerpColor(self.TargetBarColor, self.OriginalBarColor, .25)
		end
		self.TargetBarColor = self.OriginalBarColor
	end
	self.BorderColor = bVGUI.DarkenColor(self.TargetBarColor, 0.4)
end
function PANEL:GetDisabled()
	return self.Disabled
end

function PANEL:SetDrawBorder(draw_border)
	self.DrawBorder = draw_border
	if (draw_border == false) then
		self:DockPadding(0,0,0,0)
	else
		self:DockPadding(0,0,0,5)
	end
end
function PANEL:GetDrawBorder()
	return self.DrawBorder
end

function PANEL:SetTooltip(tooltip)
	self.Tooltip = tooltip
	self.Tooltip.VGUI_Element = self
end
function PANEL:RemoveTooltip()
	if (IsValid(self.Tooltip)) then
		bVGUI.DestroyTooltip()
	end
	self.Tooltip = nil
end

function PANEL:SetSound(sound_name)
	self.ButtonSound = sound_name
end

derma.DefineControl("bVGUI.Button", nil, PANEL, "DPanel")

local PANEL = {}

function PANEL:Init()
	self:SetTall(30)
	self.Button = vgui.Create("bVGUI.Button", self)
end

function PANEL:PerformLayout()
	self.Button:Center()
end

derma.DefineControl("bVGUI.ButtonContainer", nil, PANEL, "bVGUI.BlankPanel")
--lua/vgui/bvgui/combobox.lua:
return gluapack()()
--lua/vgui/bvgui/numberwang.lua:
return gluapack()()
--lua/vgui/bvgui/pagination.lua:
return gluapack()()
--lua/vgui/bvgui/permissions_selector.lua:
return gluapack()()
--lua/vgui/bvgui/renderscene.lua:
local IsInspecting = false

local LockView
local ViewOrigin, ViewAngle
local Velocity = Vector(0,0,0)
local CalcView_tbl = {}
hook.Add("CalcView", "bvgui_renderscene_CalcView", function(ply, origin, angles, fov)
	if (IsInspecting) then
		if (not ViewOrigin or not ViewAngle) then
			ViewOrigin, ViewAngle = origin, angles
		end
		CalcView_tbl.origin = ViewOrigin
		CalcView_tbl.angles = ViewAngle
	end

	if (GAS and GAS.Logging and GAS.Logging.Scenes) then
		if (IsInspecting) then
			GAS.Logging.Scenes.ViewOrigin = ViewOrigin
		else
			GAS.Logging.Scenes.ViewOrigin = nil
		end
	end

	if (IsInspecting) then return CalcView_tbl end
end)

local tr = { collisiongroup = COLLISION_GROUP_WORLD }
local function IsInWorld( pos )
	tr.start = pos
	tr.endpos = pos
	return util.TraceLine( tr ).HitWorld
end

hook.Add("CreateMove", "bvgui_renderscene_CreateMove", function(cmd)
	if (not IsInspecting) then
		LockView = nil
		Velocity.x, Velocity.y, Velocity.z = 0,0,0
		return
	end

	if (not LockView) then
		LockView = cmd:GetViewAngles()
	else
		cmd:SetViewAngles(LockView)
	end
	
	cmd:ClearMovement()

	local time = FrameTime()
   
	local sensitivity = 0.022
	ViewAngle:Normalize()
	ViewAngle.p = math.Clamp(ViewAngle.p + (cmd:GetMouseY() * sensitivity), -89, 89)
	ViewAngle.y = ViewAngle.y + (cmd:GetMouseX() * -1 * sensitivity)

	local NewViewOrigin = ViewOrigin + (Velocity * time)
   
	local add = Vector(0,0,0)
	local ang = ViewAngle
	if (cmd:KeyDown(IN_FORWARD)) then add = add + ang:Forward() end
	if (cmd:KeyDown(IN_BACK)) then add = add - ang:Forward() end
	if (cmd:KeyDown(IN_MOVERIGHT)) then add = add + ang:Right() end
	if (cmd:KeyDown(IN_MOVELEFT)) then add = add - ang:Right() end
	if (cmd:KeyDown(IN_JUMP)) then add = add + ang:Up() end
	if (cmd:KeyDown(IN_DUCK)) then add = add - ang:Up() end
   
	add = add:GetNormal() * time * 1000
	if (cmd:KeyDown(IN_SPEED)) then add = add * 2 end

	Velocity = Velocity * 0.95
	ViewOrigin = NewViewOrigin
   
	Velocity = Velocity + add

	cmd:ClearButtons()
end)

local function ResetNoDraw()
	for _,ent in ipairs(ents.GetAll()) do
		if (ent.bVGUI_RenderScene_SetNoDraw) then
			ent.bVGUI_RenderScene_SetNoDraw = nil
			ent:SetNoDraw(false)
		end
	end
end
local function SetNoDraw()
	for _,ent in ipairs(ents.GetAll()) do
		if (ent:GetNoDraw() == false and not ent.bVGUI_RenderScene_ForceDraw) then
			ent.bVGUI_RenderScene_SetNoDraw = true
			ent:SetNoDraw(true)
		end
	end
end
local function CheckNoDraw(ent)
	if (not IsValid(ent)) then return end
	if (IsInspecting) then
		if (ent:GetNoDraw() == false and not ent.bVGUI_RenderScene_ForceDraw) then
			ent.bVGUI_RenderScene_SetNoDraw = true
			ent:SetNoDraw(true)
		end
	else
		if (ent.bVGUI_RenderScene_SetNoDraw) then
			ent.bVGUI_RenderScene_SetNoDraw = nil
			ent:SetNoDraw(false)
		end
	end
end
local function KeepNoDraw(ent)
	CheckNoDraw(ent)
	CheckNoDraw(ent:GetParent())
end
hook.Add("NotifyShouldTransmit", "bvgui_renderscene_KeepNoDraw", KeepNoDraw)

local static = Material("vgui/bvgui/static.vtf")

local PANEL = {}

function PANEL:Init()
	local this = self

	local function find_dframe(pnl)
		if (IsValid(pnl.bVGUI_PinButton)) then
			return pnl
		elseif (IsValid(pnl:GetParent())) then
			return find_dframe(pnl:GetParent())
		end
	end
	self.PvPEventFrame = find_dframe(self:GetParent())

	self.Inspecting = false
	self.Rendering = false
	self.CanRender = true
	self.Origin = Vector(0,0,0)
	self.Angle = Angle(0,0,0)

	self:SetMouseInputEnabled(true)
	self:SetCursor("hand")

	self.RenderView = {
		origin = self.Origin,
		angles = self.Angle,
		drawviewmodel = false,
		fov = 120,
		bloomtone = false,
		aspectratio = 0
	}

	self.Toolbar = vgui.Create("bVGUI.BlankPanel", self)
	self.Toolbar:DockPadding(2,2,2,2)
	self.Toolbar:SetPos(5,5)
	function self.Toolbar:Paint(w,h)
		surface.SetDrawColor(47,79,115,255)
		surface.DrawRect(0,0,w,h)

		surface.SetMaterial(bVGUI.MATERIAL_GRADIENT_LIGHT)
		surface.DrawTexturedRect(0,0,w,h)
	end

	self.InspectBtn = vgui.Create("DImageButton", self.Toolbar)
	self.InspectBtn:Dock(LEFT)
	self.InspectBtn:DockMargin(0,0,5,0)
	self.InspectBtn:SetSize(16,16)
	self.InspectBtn:SetImage("icon16/world.png")
	function self.InspectBtn:DoClick()
		if (IsInspecting and not this.Inspecting) then return end
		if (IsInspecting) then
			IsInspecting = false
			this.Inspecting = false
			if (ViewOrigin and ViewAngle) then
				this:SetOrigin(ViewOrigin)
				this:SetAngle(ViewAngle)
			end
			ResetNoDraw()

			this.PvPEventFrame:SetPos(this.PvPEventFrame.GAS_RenderScene_FramePosX, this.PvPEventFrame.GAS_RenderScene_FramePosY)
			for _,dframe in ipairs(bVGUI.Frames) do
				if (IsValid(dframe) and dframe.GAS_RenderScene_Hidden) then
					dframe:SetVisible(true)
				end
			end
		else
			ViewOrigin, ViewAngle = this.Origin, this.Angle

			SetNoDraw()

			this.PvPEventFrame.bVGUI_PinButton:TogglePin()
			this.PvPEventFrame.GAS_RenderScene_FramePosX, this.PvPEventFrame.GAS_RenderScene_FramePosY = this.PvPEventFrame:GetPos()
			this.PvPEventFrame:SetPos(ScrW() - this.PvPEventFrame:GetWide() - 20, ScrH() - this.PvPEventFrame:GetTall() - 20)
			for _,dframe in ipairs(bVGUI.Frames) do
				if (IsValid(dframe) and dframe ~= this.PvPEventFrame and dframe:IsVisible()) then
					dframe:SetVisible(false)
					dframe.GAS_RenderScene_Hidden = true
				end
			end

			IsInspecting = true
			this.Inspecting = true
		end
		GAS:PlaySound("jump")
	end
	bVGUI.AttachTooltip(self.InspectBtn, {Text = bVGUI.L("inspect")})

	local screenshot = vgui.Create("DImageButton", self.Toolbar)
	screenshot:Dock(LEFT)
	screenshot:SetSize(16,16)
	screenshot:DockMargin(0,0,5,0)
	screenshot:SetImage("icon16/camera.png")
	function screenshot:Capture()
		gui.HideGameUI()
		bVGUI.DestroyTooltip()

		timer.Simple(0, function()
			hook.Add("PostRender", "GAS_RenderScene_Screenshot", function()
				local img = render.Capture({
					format = "png",
					x = 0,
					y = 0,
					w = ScrW(),
					h = ScrH(),
					alpha = false
				})

				local name = "gas_scene_screenshot_" .. os.date("%d_%m_%Y_%H_%M_%S")
				local function screenshot_name(i)
					if (i == nil) then
						if (file.Exists(name, "DATA")) then
							return screenshot_name(2)
						else
							return name
						end
					else
						if (file.Exists(name .. "_" .. i, "DATA")) then
							return screenshot_name(i + 1)
						else
							return name .. "_" .. i
						end
					end
				end
				local screenshot_name = screenshot_name() .. ".png"
				file.Write(screenshot_name, img)

				hook.Remove("PostRender", "GAS_RenderScene_Screenshot")

				bVGUI.RichMessage({
					title = bVGUI.L("screenshot_saved"),
					button = bVGUI.L("ok"),
					textCallback = function(text)
						local full_path = "garrysmod/data/" .. screenshot_name

						text:InsertColorChange(255,255,255,255)
						local t = bVGUI.L("screenshot_saved_to")
						local s,e = t:find("%%s")
						text:AppendText(t:sub(1,s-1))

						text:InsertColorChange(0,255,255,255)
						text:InsertClickableTextStart("CopyFilePath")
						text:AppendText(full_path)
						text:InsertClickableTextEnd()

						text:InsertColorChange(255,255,255,255)
						text:AppendText(t:sub(e+1))

						function text:ActionSignal(signalName, signalValue)
							if (signalName == "TextClicked" and signalValue == "CopyFilePath") then
								GAS:SetClipboardText(full_path)
							end
						end
					end
				})

				if (IsValid(self) and IsValid(this) and this.Inspecting) then
					this.InspectBtn:DoClick()
				end

				GAS:PlaySound("success")
			end)
		end)
	end
	function screenshot:DoClick()
		if (this.Inspecting) then
			self:Capture()
		elseif (not IsInspecting) then
			this.InspectBtn:DoClick()
			self:Capture()
		end
	end
	bVGUI.AttachTooltip(screenshot, {Text = bVGUI.L("screenshot")})

	local reset = vgui.Create("DImageButton", self.Toolbar)
	reset:Dock(LEFT)
	reset:SetSize(16,16)
	reset:SetImage("icon16/arrow_refresh.png")
	function reset:DoClick()
		if (this.OriginalOrigin) then
			this:SetOrigin(Vector(this.OriginalOrigin.x, this.OriginalOrigin.y, this.OriginalOrigin.z))
		end
		if (this.OriginalAngles) then
			this:SetAngle(Angle(this.OriginalAngles.p, this.OriginalAngles.y, this.OriginalAngles.r))
		end
		GAS:PlaySound("delete")
	end
	bVGUI.AttachTooltip(reset, {Text = bVGUI.L("reset")})
end

function PANEL:OnRemove()
	if (self.Inspecting) then
		self.InspectBtn:DoClick()
	end
end

function PANEL:PerformLayout(w,h)
	self.Toolbar:SetSize(w - 10,20)
end

local click_to_render_font = bVGUI.FONT(bVGUI.FONT_CIRCULAR, "REGULAR", 18)
function PANEL:Paint(w,h)
	if (not self.Rendering or IsInspecting) then
		surface.SetDrawColor(255,255,255)
		surface.SetMaterial(static)
		local d = math.max(w,h)
		surface.DrawTexturedRect((w - d) / 2,(h - d) / 2,d,d)

		surface.SetMaterial(bVGUI.MATERIAL_GRADIENT)
		surface.DrawTexturedRect(0,(((SysTime() % 5) / 5) * (h + 30)) - 30,w,30)

		if (self.CanRender and not IsInspecting) then
			draw.SimpleTextOutlined(bVGUI.L("click_to_render"), click_to_render_font, w / 2, (h - 20) / 2, bVGUI.COLOR_WHITE, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER, 2, bVGUI.COLOR_BLACK)
		end
		if (self.Inspecting) then
			draw.SimpleTextOutlined(bVGUI.L("inspecting"), click_to_render_font, w / 2, (h - 20) / 2, bVGUI.COLOR_RED, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER, 2, bVGUI.COLOR_BLACK)
		elseif (not self.CanRender) then
			draw.SimpleTextOutlined(bVGUI.L("no_data"), click_to_render_font, w / 2, (h - 20) / 2, bVGUI.COLOR_RED, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER, 2, bVGUI.COLOR_BLACK)
		end
	else
		local x,y = self:LocalToScreen(0,0)
		self.RenderView.x, self.RenderView.y, self.RenderView.w, self.RenderView.h = x,y,w,h
		render.RenderView(self.RenderView)
	end

	surface.SetDrawColor(0,0,0)
	surface.DrawRect(0,0,5,h)
	surface.DrawRect(0,0,w,5)
	surface.DrawRect(w - 5,0,5,h)
	surface.DrawRect(0,h - 30,w,30)

	self.Toolbar:SetVisible(self.Rendering)
end

function PANEL:SetLabel(txt)
	self.Label = vgui.Create("DLabel", self)
	self.Label:SetFont(bVGUI.FONT(bVGUI.FONT_CIRCULAR, "REGULAR", 16))
	self.Label:SetTextColor(bVGUI.COLOR_WHITE)
	self.Label:SetText(txt)
	self.Label:Dock(FILL)
	self.Label:DockMargin(0,0,0,7.5)
	self.Label:SetContentAlignment(2)
end

function PANEL:SetOrigin(origin)
	self.Origin = origin
	self.RenderView.origin = self.Origin
	if (not self.OriginalOrigin) then
		self.OriginalOrigin = Vector(origin.x,origin.y,origin.z)
	end
end

function PANEL:SetAngle(ang)
	self.Angle = ang
	self.RenderView.angles = self.Angle
	if (not self.OriginalAngles) then
		self.OriginalAngles = Angle(ang.p,ang.y,ang.r)
	end
end

function PANEL:SetRendering(rendering)
	self.Rendering = rendering
	if (self.Rendering and self.OnStartRender) then
		self:OnStartRender()
	elseif (not self.Rendering and self.OnEndRender) then
		self:OnEndRender()
	end

	if (not self.Rendering and self.Inspecting) then
		self.Inspecting = false
		IsInspecting = false
	end
end

function PANEL:SetCanRender(can_render)
	self.CanRender = can_render
	if (not self.CanRender) then
		self:SetCursor("none")
	else
		self:SetCursor("hand")
	end
	if (self.Rendering) then
		self:SetRendering(false)
	end
end

function PANEL:DoClick()
	if (not self.Rendering) then
		if (not self.CanRender) then
			GAS:PlaySound("error")
		else
			self:SetRendering(true)
			GAS:PlaySound("btn_on")
			notification.AddLegacy(bVGUI.L("right_click_to_stop_rendering"), NOTIFY_HINT, 2)
		end
	else
		self.InspectBtn:DoClick()
	end
end

function PANEL:DoRightClick()
	if (self.Rendering) then
		if (self.Inspecting) then
			self.InspectBtn:DoClick()
		end
		self:SetRendering(false)
		GAS:PlaySound("btn_off")
	end
end

function PANEL:OnMousePressed(m)
	self.m_pressing = m
end
function PANEL:OnMouseReleased(m)
	if (self.m_pressing == m) then
		if (m == MOUSE_LEFT) then
			self:DoClick()
		elseif (m == MOUSE_RIGHT) then
			self:DoRightClick()
		end
	end
	self.m_pressing = nil
end

derma.DefineControl("bVGUI.RenderScene", nil, PANEL, "bVGUI.BlankPanel")
--lua/vgui/bvgui/scrollpanel.lua:
return gluapack()()
--lua/vgui/bvgui/scrollpanel.lua:
local PANEL = {}

function PANEL:Init()
	self.CurrentOffset = 0
	self.TargetOffset = 0
	self.StartTime = 0
	self.EndTime = 0

	self.VBar:SetHideButtons(true)
	self.VBar:SetWide(5)
	self.VBar:DockMargin(0,0,0,0)

	function self.VBar:Paint() end
	function self.VBar.btnGrip:Paint(w,h)
		surface.SetDrawColor(150,150,150,100)
		surface.DrawRect(0,0,w,h)
	end

	self.VBar.CurrentY = 0
	self.VBar.TargetY = 0
	function self.VBar:PerformLayout()

		local Wide = self:GetWide()
		local BtnHeight = Wide
		if ( self:GetHideButtons() ) then BtnHeight = 0 end
		local Scroll = self:GetScroll() / self.CanvasSize
		local BarSize = math.max( self:BarScale() * ( self:GetTall() - ( BtnHeight * 2 ) ), 10 )
		local Track = self:GetTall() - ( BtnHeight * 2 ) - BarSize
		Track = Track + 1

		Scroll = Scroll * Track

		self.TargetY = BtnHeight + Scroll
		self.btnGrip:SetSize( Wide, BarSize )

		if ( BtnHeight > 0 ) then
			self.btnUp:SetPos( 0, 0, Wide, Wide )
			self.btnUp:SetSize( Wide, BtnHeight )

			self.btnDown:SetPos( 0, self:GetTall() - BtnHeight )
			self.btnDown:SetSize( Wide, BtnHeight )
			
			self.btnUp:SetVisible( true )
			self.btnDown:SetVisible( true )
		else
			self.btnUp:SetVisible( false )
			self.btnDown:SetVisible( false )
			self.btnDown:SetSize( Wide, BtnHeight )
			self.btnUp:SetSize( Wide, BtnHeight )
		end

	end

	function self.VBar:Think()
		self.CurrentY = Lerp(FrameTime() * 10, self.CurrentY, self.TargetY)
		self.btnGrip:SetPos(0, math.Round(self.CurrentY))
	end

	self.pnlCanvas.CurrentOffset = 0
	self.pnlCanvas.TargetOffset = 0
	function self.pnlCanvas:Think()
		self.CurrentOffset = Lerp(FrameTime() * 10, self.CurrentOffset, self.TargetOffset)
		self:SetPos(0, math.Round(self.CurrentOffset))
	end
end

function PANEL:OnVScroll(offset)
	self.pnlCanvas.TargetOffset = offset
end

function PANEL:PerformLayoutInternal()

	local Tall = self.pnlCanvas:GetTall()
	local Wide = self:GetWide()
	local YPos = 0

	self:Rebuild()

	self.VBar:SetUp( self:GetTall(), self.pnlCanvas:GetTall() )
	YPos = self.VBar:GetOffset()

	if ( self.VBar.Enabled ) then Wide = Wide - self.VBar:GetWide() end

	self.pnlCanvas:SetPos( 0, YPos )
	self.pnlCanvas:SetWide( Wide )

	self:Rebuild()

	if ( Tall != self.pnlCanvas:GetTall() ) then
		self.VBar:SetScroll( self.VBar:GetScroll() ) -- Make sure we are not too far down!
	end

end

derma.DefineControl("bVGUI.ScrollPanel", nil, PANEL, "DScrollPanel")
--lua/vgui/bvgui/switch.lua:
local PANEL = {}

local on_color  = Color(76,218,100)
local off_color = Color(216,75,75)
local switch_width = 40
local switch_height = 20
local label_margin = 7

local function Circle( x, y, radius, seg )
	local cir = {}

	table.insert( cir, { x = x, y = y, u = 0.5, v = 0.5 } )
	for i = 0, seg do
		local a = math.rad( ( i / seg ) * -360 )
		table.insert( cir, { x = x + math.sin( a ) * radius, y = y + math.cos( a ) * radius, u = math.sin( a ) / 2 + 0.5, v = math.cos( a ) / 2 + 0.5 } )
	end

	local a = math.rad( 0 )
	table.insert( cir, { x = x + math.sin( a ) * radius, y = y + math.cos( a ) * radius, u = math.sin( a ) / 2 + 0.5, v = math.cos( a ) / 2 + 0.5 } )

	return cir 
end

function PANEL:Init()
	self.LeftCircle = false
	self.RightCircle = false

	self.Active = false
	self.ColorInterpolation = bVGUI.LerpColor(off_color, off_color, .25)
	self.SwitchInterpolation = bVGUI.Lerp(switch_height / 2, switch_height / 2, .25)

	self.Label = vgui.Create("DLabel", self)
	self.Label:SetContentAlignment(4)
	self.Label:SetFont(bVGUI.FONT(bVGUI.FONT_CIRCULAR, "REGULAR", 16))
	self.Label:SetTextColor(bVGUI.COLOR_WHITE)
	self:SetText("Switch")

	self.ClickableArea = vgui.Create("bVGUI.BlankPanel", self)
	self.ClickableArea:SetMouseInputEnabled(true)
	self.ClickableArea:SetCursor("hand")
	function self.ClickableArea:OnMouseReleased(m)
		if (m ~= MOUSE_LEFT) then return end
		local checked = not self:GetParent().Active
		self:GetParent():SetChecked(checked, true)
		if (GAS) then
			if (checked) then
				GAS:PlaySound("btn_on")
			else
				GAS:PlaySound("btn_off")
			end
		end
		if (self:GetParent().OnChange) then
			self:GetParent():OnChange()
		end
	end
end

function PANEL:PerformLayout()
	self.ClickableArea:SetSize(switch_width + label_margin + self.Label:GetWide() + label_margin, switch_height)
end

function PANEL:SetText(text)
	self.Text = text

	self.Label:SetText(text)
	self.Label:SizeToContents()
	self.Label:AlignLeft(switch_width + label_margin)
	self.Label:SizeToContents()

	self:SetSize(switch_width + label_margin + self.Label:GetWide(), switch_height)

	self.Label:CenterVertical()
end
function PANEL:GetText(text)
	return self.Text
end

function PANEL:Paint(w)
	if !self.LeftCircle or !self.RightCircle then
		self.LeftCircle = Circle(switch_height / 2, switch_height / 2, switch_height / 2,20)
		self.RightCircle = Circle(switch_width - switch_height / 2, switch_height / 2, switch_height / 2,20)
	end

	self.ColorInterpolation:DoLerp()
	self.SwitchInterpolation:DoLerp()

	surface.SetDrawColor(self.ColorInterpolation:GetColor())
	draw.NoTexture()
	surface.DrawPoly(self.LeftCircle)
	surface.DrawPoly(self.RightCircle)
	
	surface.DrawRect(switch_height / 2, 0, switch_width - switch_height, switch_height)

	surface.SetDrawColor(255, 255, 255)
	surface.DrawPoly(Circle(self.SwitchInterpolation:GetValue(), switch_height / 2, switch_height / 2 - 2,20))
end

function PANEL:SetChecked(active, animate)
	if (self.Disabled) then return end
	self.Active = active
	local from
	local to
	if (active) then
		from = switch_height / 2
		to = switch_width - (switch_height / 2)
	else
		from = switch_width - (switch_height / 2)
		to = switch_height / 2
	end
	if (animate) then
		self.SwitchInterpolation:SetTo(to)
		self.ColorInterpolation:SetTo(active and on_color or off_color)
	else
		self.SwitchInterpolation = bVGUI.Lerp(to, to, .25)
		if (active) then
			self.ColorInterpolation = bVGUI.LerpColor(on_color, on_color, .25)
		else
			self.ColorInterpolation = bVGUI.LerpColor(off_color, off_color, .25)
		end
	end
end
function PANEL:GetChecked()
	return self.Active
end

function PANEL:SetHelpText(text)
	self.HelpLabel = vgui.Create("DLabel", self)
	self.HelpLabel:SetTextColor(Color(200,200,200))
	self.HelpLabel:SetAutoStretchVertical(true)
	self.HelpLabel:SetWrap(true)
	self.HelpLabel:SetFont(bVGUI.FONT(bVGUI.FONT_RUBIK, "REGULAR", 16))
	self.HelpLabel:AlignTop(switch_height + 10)
	self.HelpLabel:SetText(text)
	function self.HelpLabel:PerformLayout()
		local w = math.min(500, self:GetParent():GetWide())
		if (self:GetWide() ~= w) then
			self:SetWide(w)
		end
		self:GetParent():SetSize(switch_width + label_margin + self:GetParent().Label:GetWide(), switch_height + 10 + self:GetTall())
	end
end

function PANEL:SetDisabled(disabled)
	self.Disabled = disabled
	if (self.Disabled) then
		self.ColorInterpolation:SetColor(Color(165,165,165))
		self.Label:SetTextColor(Color(180,180,180))
		self.ClickableArea:SetCursor("no")
	else
		self.ClickableArea:SetCursor("hand")
		self.Label:SetTextColor(bVGUI.COLOR_WHITE)
		if (self:GetChecked()) then
			self.ColorInterpolation:SetColor(on_color)
		else
			self.ColorInterpolation:SetColor(off_color)
		end
	end
end
function PANEL:GetDisabled()
	return self.Disabled
end

derma.DefineControl("bVGUI.Switch", nil, PANEL, "bVGUI.BlankPanel")
--addons/gmodadminsuite-jobwhitelist-1.3.4/lua/vgui/gas_jobwhitelist_faction.lua:
return gluapack()()
--lua/vgui/openpermissions_horizontaldivider.lua:
local PANEL = {}

function PANEL:SetRightWidth(width)
	self.InitialRightWidth = width

	local oldpaint = self.Paint
	self.Paint = function(self, w, h)
		self:SetLeftWidth(w - self.InitialRightWidth)
		self.Paint = oldpaint
	end
end

function PANEL:BalanceWidths()
	local oldpaint = self.Paint
	self.Paint = function(self, w, h)
		self:SetLeftWidth((w - self:GetDividerWidth()) / 2)
		self.Paint = oldpaint
	end
end

derma.DefineControl("OpenPermissions.HorizontalDivider", nil, PANEL, "DHorizontalDivider")
--lua/vgui/openpermissions_tree.lua:
local PANEL = {}

AccessorFunc( PANEL, "m_bShowIcons", "ShowIcons" )
AccessorFunc( PANEL, "m_iIndentSize", "IndentSize" )
AccessorFunc( PANEL, "m_iLineHeight", "LineHeight" )
AccessorFunc( PANEL, "m_pSelectedItem", "SelectedItem" )
AccessorFunc( PANEL, "m_bClickOnDragHover", "ClickOnDragHover" )

function PANEL:Init()

	self:SetShowIcons( true )
	self:SetIndentSize( 14 )
	self:SetLineHeight( 17 )

	self.RootNode = self:GetCanvas():Add( "DTree_Node" )
	self.RootNode:SetRoot( self )
	self.RootNode:SetParentNode( self )
	self.RootNode:Dock( TOP )
	self.RootNode:SetText( "" )
	self.RootNode:SetExpanded( true, true )
	self.RootNode:DockMargin( 0, 4, 0, 0 )

	self:SetPaintBackground( true )

end

function PANEL:Root()
	return self.RootNode
end

function PANEL:AddNode( strName, strIcon )

	return self.RootNode:AddNode( strName, strIcon )

end

function PANEL:ChildExpanded( bExpand )

	self:InvalidateLayout()

end

function PANEL:ShowIcons()

	return self.m_bShowIcons

end

function PANEL:ExpandTo( bExpand )
end

function PANEL:SetExpanded( bExpand )
end

function PANEL:Clear()
	self:Root():Clear()
end

function PANEL:Paint( w, h )

	derma.SkinHook( "Paint", "Tree", self, w, h )
	return true

end

function PANEL:DoClick( node )
	return false
end

function PANEL:DoRightClick( node )
	return false
end

function PANEL:SetSelectedItem( node )

	if ( IsValid( self.m_pSelectedItem ) ) then
		self.m_pSelectedItem:SetSelected( false )
	end

	self.m_pSelectedItem = node

	if ( node ) then
		node:SetSelected( true )
		node:OnNodeSelected( node )
	end

end

function PANEL:OnNodeSelected( node )
end

function PANEL:MoveChildTo( child, pos )

	self:InsertAtTop( child )

end

function PANEL:LayoutTree()

	self:InvalidateChildren( true )

end

derma.DefineControl("OpenPermissions.Tree", nil, PANEL, "OpenPermissions.ScrollPanel")
--gamemodes/darkrp/gamemode/modules/hungermod/sh_interface.lua:
DarkRP.createFood = DarkRP.stub{
    name = "createFood",
    description = "Create food for DarkRP.",
    parameters = {
        {
            name = "name",
            description = "The name of the food.",
            type = "string",
            optional = false
        },
        {
            name = "tbl",
            description = "Table containing the information for the food.",
            type = "table",
            optional = false
        }
    },
    returns = {
    },
    metatable = DarkRP
}
AddFoodItem = DarkRP.createFood

DarkRP.removeFoodItem = DarkRP.stub{
    name = "removeFoodItem",
    description = "Remove a food item from DarkRP. NOTE: Must be called from BOTH server AND client to properly get it removed!",
    parameters = {
        {
            name = "i",
            description = "The index of the item.",
            type = "number",
            optional = false
        }
    },
    returns = {
    },
    metatable = DarkRP
}

DarkRP.hookStub{
    name = "onFoodItemRemoved",
    description = "Called when a food item is removed.",
    parameters = {
        {
            name = "num",
            description = "The index of this item.",
            type = "number"
        },
        {
            name = "itemTable",
            description = "The table containing all the info about this item.",
            type = "table"
        }
    },
    returns = {
    }
}

DarkRP.PLAYER.isCook = DarkRP.stub{
    name = "isCook",
    description = "Whether this player is a cook. This function is only available if hungermod is enabled.",
    parameters = {
    },
    returns = {
        {
            name = "answer",
            description = "Whether this player is a cook.",
            type = "boolean"
        }
    },
    metatable = DarkRP.PLAYER
}

DarkRP.getFoodItems = DarkRP.stub{
    name = "getFoodItems",
    description = "Get all food items.",
    parameters = {

    },
    returns = {
        {
            name = "set",
            description = "Table with food items.",
            type = "table"
        }
    },
    metatable = DarkRP
}

--gamemodes/darkrp/gamemode/modules/workarounds/sh_workarounds.lua:
-- Shared part

function DarkRP.getAvailableVehicles()
    local vehicles = list.Get("Vehicles")
    for _, v in pairs(list.Get("SCarsList")) do
        vehicles[v.PrintName] = {
            Name = v.PrintName,
            Class = v.ClassName,
            Model = v.CarModel
        }
    end

    return vehicles
end

local function argError(Val, iArg, sType)
    error(string.format("bad argument #%u to '%s' (%s expected, got %s)", iArg, debug.getinfo(2, "n").name, sType, type(Val)), 3)
end

if not DarkRP.disabledDefaults["workarounds"]["os.date() Windows crash"] and system.IsWindows() then
    local osdate = os.date
    local replace = function(txt)
        if txt == "%%" then return txt end -- Edge case, %% is allowed
        return ""
    end

    function os.date(format, time, ...)
        if (isstring(format) or isnumber(format)) then
            format = string.gsub(format, "%%[^aAbBcdHIjmMpSUwWxXyYz]", replace)
        elseif (format ~= nil) then
            argError(Val, 1, "string")
        end

        if (not (time == nil or isnumber(time)) and (not isstring(time) or tonumber(time) == nil)) then
            argError(Val, 2, "number")
        end

        return osdate(format, time, ...)
    end
end

timer.Simple(3, function()
    if DarkRP.disabledDefaults["workarounds"]["SkidCheck"] then return end

    -- Malicious addons that kicks players this one person doesn't like.
    if not istable(Skid) then return end
    Skid.Check = fn.Id
    hook.Remove("CheckPassword", "Skid.CheckPassword")

    MsgC(Color(0, 255, 0), "SkidCheck", color_white, " has been ", Color(255, 0, 0), "DISABLED\n", color_white, [[
    SkidCheck was detected on this server and has been disabled.

    SkidCheck is a ban list addon made by HeX as an attempt to get the people he doesn't like
    banned from as many servers as possible.

    You have probably installed this addon thinking that it would get rid of cheaters, and sure,
    it might get rid of some, but that's only to make you want to download this.

    SkidCheck would ban me (FPtje, developer of DarkRP) from your server because I have a
    workshop addon that he doesn't like and because I know how to throw a prop around
        (type /credits yourname in chat for the full story on that)
    It doesn't just ban /me/ for that, it bans EVERYONE who is subscribed to the addon.

    Can you imagine trying an addon out and getting on this list /just/ because you have
    it installed? That's SkidCheck for you.

    It also bans people who have a VAC ban (even if gotten from another game), people from
    arbitrary groups, /friends/ of people he doesn't like and many, many more.

    I'm not pulling this out of my ass either, you can check everything here:
    https://forum.facepunch.com//f/gmoddev/nujl/PSA-Hex-SkidCheck-global-banlist-is-a-thing-and-people-actually-use-it/1/

    On a somewhat unrelated note, HeX has been known to be malicious for quite some time:
    He used to have an anticheat (called HAC) on his server, which not only misfired from
    time to time, but actively used exploits to fuck "cheaters" up as much as possible,
    doing malicious shit ranging from unbinding keys to removing every friend they had in
    their friends list.

    That too can be fact checked right here:
    https://forum.facepunch.com//f/gmoddev/lrbf/So-hac-got-released/1/

    DO NOT trust this guy to decide who gets banned from your server. In fact,
    DO NOT EVER TRUST ANYONE with that power. No one ever should have the power
    to decide who gets banned and who doesn't over the servers that decide to install
    their addon.
]])
end)

if SERVER and not DarkRP.disabledDefaults["workarounds"]["Error on edict limit"] then
    -- https://github.com/FPtje/DarkRP/issues/2640
    local entsCreate = ents.Create
    local entsCreateError = [[
    Unable to create entity.

    The server has come to a point where it has become impossible to create new
    entities. The entity limit has been hit. Try cleaning up the server or
    changing level. In the meantime, expect lots of errors coming from a lot of
    addons.

    If you do decide to send a bug report to ANY addon, please include this
    message.]]

    local function varArgsLen(...)
        return {...}, select("#", ...)
    end

    function ents.Create(name, ...)
        local res, len = varArgsLen(entsCreate(name, ...))

        if res[1] == NULL and ents.GetEdictCount() >= 8176 then
            DarkRP.error(entsCreateError, 2, {string.format("Affected entity: '%s'", name)})
        end

        return unpack(res, 1, len)
    end
end

--[[---------------------------------------------------------------------------
Generic InitPostEntity workarounds
---------------------------------------------------------------------------]]
hook.Add("InitPostEntity", "DarkRP_Workarounds", function()
    if CLIENT then
        if not DarkRP.disabledDefaults["workarounds"]["White flashbang flashes"] then
            -- Removes the white flashes when the server lags and the server has flashbang. Workaround because it's been there for fucking years
            hook.Remove("HUDPaint","drawHudVital")
        end

        -- Fuck up APAnti
        if not DarkRP.disabledDefaults["workarounds"]["APAnti"] then
            net.Receivers.sblockgmspawn = nil
            hook.Remove("PlayerBindPress", "_sBlockGMSpawn")
        end
        return
    end
    local commands = concommand.GetTable()
    if not DarkRP.disabledDefaults["workarounds"]["Durgz witty sayings"] and commands["durgz_witty_sayings"] then
        game.ConsoleCommand("durgz_witty_sayings 0\n") -- Deals with the cigarettes exploit. I'm fucking tired of them. I hate having to fix other people's mods, but this mod maker is retarded and refuses to update his mod.
    end

    -- Remove ULX /me command. (the /me command is the only thing this hook does)
    if not DarkRP.disabledDefaults["workarounds"]["ULX /me command"] then
        hook.Remove("PlayerSay", "ULXMeCheck")
    end

    -- why can people even save multiplayer games?
    -- Lag exploit
    if not DarkRP.disabledDefaults["workarounds"]["gm_save"] then
        concommand.Remove("gm_save")
    end

    -- Remove that weird rooftop spawn in rp_downtown_v4c_v2
    if not DarkRP.disabledDefaults["workarounds"]["rp_downtown_v4c_v2 rooftop spawn"] and
    game.GetMap() == "rp_downtown_v4c_v2" then
        for _, v in ipairs(ents.FindByClass("info_player_terrorist")) do
            v:Remove()
        end
    end
end)

--[[---------------------------------------------------------------------------
Fuck up APAnti. These hooks send unnecessary net messages.
---------------------------------------------------------------------------]]
if not DarkRP.disabledDefaults["workarounds"]["APAnti"] then
    timer.Simple(3, function()
        hook.Remove("Move", "_APA.Settings.AllowGMSpawn")
        hook.Remove("PlayerSpawnObject", "_APA.Settings.AllowGMSpawn")
    end)
end

--[[---------------------------------------------------------------------------
Wire field generator exploit
---------------------------------------------------------------------------]]
if SERVER and not DarkRP.disabledDefaults["workarounds"]["Wire field generator exploit fix"] then
    hook.Add("OnEntityCreated", "DRP_WireFieldGenerator", function(ent)
        timer.Simple(0, function()
            if IsValid(ent) and ent:GetClass() == "gmod_wire_field_device" then
                local TriggerInput = ent.TriggerInput
                function ent:TriggerInput(iname, value)
                    if iname == "Distance" and isnumber(value) then
                        value = math.min(value, 400)
                    end
                    TriggerInput(self, iname, value)
                end
            end
        end)
    end)
end

--[[---------------------------------------------------------------------------
Door tool is shitty
Let's fix that huge class exploit
---------------------------------------------------------------------------]]
if not DarkRP.disabledDefaults["workarounds"]["Door tool class fix"] then
    hook.Add("InitPostEntity", "FixDoorTool", function()
        local oldFunc = makedoor
        if isfunction(oldFunc) then
            function makedoor(ply, trace, ang, model, open, close, autoclose, closetime, class, hardware, ...)
                if class ~= "prop_dynamic" and class ~= "prop_door_rotating" then return end

                oldFunc(ply, trace, ang, model, open, close, autoclose, closetime, class, hardware, ...)
            end
        end
    end)

    local allowedDoors = {
        ["prop_dynamic"] = true,
        ["prop_door_rotating"] = true,
        [""] = true
    }

    hook.Add("CanTool", "DoorExploit", function(ply, trace, tool)
        if not IsValid(ply) or not ply:IsPlayer() or not IsValid(ply:GetActiveWeapon()) or not ply:GetActiveWeapon().GetToolObject or not ply:GetActiveWeapon():GetToolObject() then return end

        tool = ply:GetActiveWeapon():GetToolObject()
        if not allowedDoors[string.lower(tool:GetClientInfo("door_class") or "")] then
            return false
        end
    end)
end
--[[---------------------------------------------------------------------------
Anti crash exploit
---------------------------------------------------------------------------]]
if SERVER and not DarkRP.disabledDefaults["workarounds"]["Constraint crash exploit fix"] then
    hook.Add("PropBreak", "drp_AntiExploit", function(attacker, ent)
        if IsValid(ent) and ent:GetPhysicsObject():IsValid() then
            constraint.RemoveAll(ent)
        end
    end)
end

--[[---------------------------------------------------------------------------
Actively deprecate commands
---------------------------------------------------------------------------]]
if SERVER and not DarkRP.disabledDefaults["workarounds"]["Deprecated console commands"] then
    local deprecated = {
        {command = "rp_removeletters",      alternative = "removeletters"},
        {command = "rp_setname",            alternative = "forcerpname"},
        {command = "rp_unlock",             alternative = "forceunlock"},
        {command = "rp_lock",               alternative = "forcelock"},
        {command = "rp_removeowner",        alternative = "forceremoveowner"},
        {command = "rp_addowner",           alternative = "forceown"},
        {command = "rp_unownall",           alternative = "forceunownall"},
        {command = "rp_unown",              alternative = "forceunown"},
        {command = "rp_own",                alternative = "forceown"},
        {command = "rp_tellall",            alternative = "admintellall"},
        {command = "rp_tell",               alternative = "admintell"},
        {command = "rp_teamunban",          alternative = "teamunban"},
        {command = "rp_teamban",            alternative = "teamban"},
        {command = "rp_setsalary",          alternative = "setmoney"},
        {command = "rp_setmoney",           alternative = "setmoney"},
        {command = "rp_revokelicense",      alternative = "unsetlicense"},
        {command = "rp_givelicense",        alternative = "setlicense"},
        {command = "rp_unlockdown",         alternative = "unlockdown"},
        {command = "rp_lockdown",           alternative = "lockdown"},
        {command = "rp_unarrest",           alternative = "unarrest"},
        {command = "rp_arrest",             alternative = "arrest"},
        {command = "rp_cancelvote",         alternative = "forcecancelvote"},
    }

    local lastDeprecated = 0
    local function msgDeprecated(cmd, ply)
        if CurTime() - lastDeprecated < 0.5 then return end
        lastDeprecated = CurTime()

        DarkRP.notify(ply, 1, 4, ("This command has been deprecated. Please use 'DarkRP %s' or '/%s' instead."):format(cmd.alternative, cmd.alternative))
    end

    for _, cmd in pairs(deprecated) do
        concommand.Add(cmd.command, fp{msgDeprecated, cmd})
    end
end


--[[-------------------------------------------------------------------------
CAC tends to kick innocent people when they use the x86_64 branch. Since the
author is unable to maintain it, it is better to disable the addon altogether.
---------------------------------------------------------------------------]]
local disableCacMsg = [[CAC was detected on this server and has been disabled.
It turns out there is a trivial and very well known way for cheats to bypass
CAC. Worse yet, CAC tends to kick innocent players who are using the 64 bits
branch of GMod.

The author of the addon does not maintain CAC anymore, so this is to prevent
further damage and to warn you of this situation.

If you wish to leave CAC enabled, please open

addons\darkrpmodification\lua\darkrp_config\disabled_defaults.lua

Head to the section about disabled workarounds and make sure the following line is there:
["disable CAC"]                                  = true,
]]
if SERVER and not DarkRP.disabledDefaults["workarounds"]["disable CAC"] then
    timer.Create("disable CAC", 2, 1, function()
        if not CAC then return end

        --remove CAC's hooks
        hook.Remove("CheckPassword"      , "CAC.CheckPassword")
        hook.Remove("Initialize"         , "CAC.LuaWhitelistController.261b4998")
        hook.Remove("OnNPCKilled"        , "CAC.Aimbotdetector")
        hook.Remove("PlayerDeath"        , "CAC.AimbotDetector")
        hook.Remove("PlayerInitialSpawn" , "CAC.PlayerMonitor.PlayerConnected")
        hook.Remove("PlayerSay"          , "CAC.ChatCommands")
        hook.Remove("SetupMove"          , "CAC.MoveHandler")
        hook.Remove("ShutDown"           , "CAC")
        hook.Remove("Think"              , "CAC.DelayedCalls")
        hook.Remove("Tick"               , "CAC.PlayerMonitor.ProcessQueue")
        hook.Remove("player_disconnect"  , "CAC.PlayerMonitor.PlayerDisconnected")

        --remove CAC's timers
        timer.Remove("CAC.AdminUIBootstrapper")
        timer.Remove("CAC.DataUpdater")
        timer.Remove("CAC.IncidentController")
        timer.Remove("CAC.LivePlayerSessionController")
        timer.Remove("CAC.SettingsSaver")

        --remove CAC's net receivers
        net.Receivers[CAC.Identifiers.MultiplexedDataChannelName] = nil
        net.Receivers[CAC.Identifiers.AdminChannelName] = nil

        for k,v in pairs(CAC) do
            if istable(CAC[k]) and CAC[k].dtor then CAC[k]:dtor() end
        end

        CAC = nil

        MsgC(Color(0, 255, 0), "Cake Anticheat (CAC)", color_white, " has been ", Color(255, 0, 0), "DISABLED\n", Color(253, 151, 31), disableCacMsg)
    end)
end

--gamemodes/darkrp/gamemode/modules/money/sh_commands.lua:
DarkRP.declareChatCommand{
    command = "give",
    description = "Give money to the player you're looking at.",
    delay = 1.5
}

DarkRP.declareChatCommand{
    command = "dropmoney",
    description = "Drop money on the floor.",
    delay = 1.5
}

DarkRP.declareChatCommand{
    command = "moneydrop",
    description = "Drop money on the floor.",
    delay = 1.5
}

DarkRP.declareChatCommand{
    command = "cheque",
    description = "Write a cheque for a specific person.",
    delay = 1.5,
    tableArgs = true
}

DarkRP.declareChatCommand{
    command = "check",
    description = "Write a cheque for a specific person.",
    delay = 1.5,
    tableArgs = true
}

DarkRP.declareChatCommand{
    command = "setmoney",
    description = "Set a player's wallet value.",
    delay = 0.5,
    tableArgs = true
}

DarkRP.declareChatCommand{
    command = "addmoney",
    description = "Add money to a player's wallet.",
    delay = 0.5,
    tableArgs = true
}

--gamemodes/darkrp/gamemode/modules/medic/sh_init.lua:
local plyMeta = FindMetaTable("Player")
plyMeta.isMedic = fn.Compose{fn.Curry(fn.GetValue, 2)("medic"), plyMeta.getJobTable}

--gamemodes/darkrp/gamemode/modules/cppi/sh_cppi.lua:
return gluapack()()
--gamemodes/darkrp/gamemode/modules/base/sh_util.lua:
return gluapack()()
--gamemodes/darkrp/gamemode/modules/base/sh_entityvars.lua:
return gluapack()()
--gamemodes/darkrp/gamemode/modules/base/cl_gamemode_functions.lua:
return gluapack()()
--gamemodes/darkrp/gamemode/modules/base/cl_drawfunctions.lua:
-- concatenate a space to avoid the text being parsed as valve string
local function safeText(text)
    return string.match(text, "^#([a-zA-Z_]+)$") and text .. " " or text
end

DarkRP.deLocalise = safeText

function draw.DrawNonParsedText(text, font, x, y, color, xAlign)
    return draw.DrawText(safeText(text), font, x, y, color, xAlign)
end

function draw.DrawNonParsedSimpleText(text, font, x, y, color, xAlign, yAlign)
    return draw.SimpleText(safeText(text), font, x, y, color, xAlign, yAlign)
end

function draw.DrawNonParsedSimpleTextOutlined(text, font, x, y, color, xAlign, yAlign, outlineWidth, outlineColor)
    return draw.SimpleTextOutlined(safeText(text), font, x, y, color, xAlign, yAlign, outlineWidth, outlineColor)
end

function surface.DrawNonParsedText(text)
    return surface.DrawText(safeText(text))
end

function chat.AddNonParsedText(...)
    local tbl = {...}
    for i = 2, #tbl, 2 do
        tbl[i] = safeText(tbl[i])
    end
    return chat.AddText(unpack(tbl))
end

--addons/glorifiedleveling/lua/glorifiedleveling/sh_glorifiedleveling_config.lua:
return gluapack()()
--addons/glorifiedleveling/lua/glorifiedleveling/localization/sh_glorifiedleveling_german.lua:
return gluapack()()
--addons/glorifiedleveling/lua/glorifiedleveling/localization/sh_glorifiedleveling_russian.lua:
return gluapack()()
--addons/glorifiedleveling/lua/glorifiedleveling/themes/cl_glorifiedleveling_default.lua:
return gluapack()()
--addons/glorifiedleveling/lua/glorifiedleveling/modules/ui/adminpanel/cl_glorifiedleveling_addxpconfirmation.lua:
return gluapack()()
--addons/glorifiedleveling/lua/glorifiedleveling/modules/ui/adminpanel/cl_glorifiedleveling_resetlevelconfirmation.lua:

local PANEL = {}

function PANEL:Init()
    self:SetSize( ScrH() * 0.5, ScrH() * 0.2 )
    self:Center()
    self:MakePopup()

    self.Theme = GlorifiedLeveling.Themes.GetCurrent()

    self.Close = vgui.Create( "DButton", self )
    self.Close:SetText( "" )

    self.Close.DoClick = function( s )
        self:Remove()
    end

    self.Close.Color = Color( 255, 255, 255 )
    self.Close.Paint = function(s, w, h)
        local iconSize = h * 0.5

        s.Color = GlorifiedLeveling.UI.LerpColor( FrameTime() * 5, s.Color, s:IsHovered() and self.Theme.Data.Colors.adminMenuCloseButtonHoverCol or self.Theme.Data.Colors.adminMenuCloseButtonCol )

        surface.SetDrawColor( s.Color )
        surface.SetMaterial( self.Theme.Data.Materials.close )
        surface.DrawTexturedRect( w / 2 - iconSize / 2, h / 2 - iconSize / 2, iconSize, iconSize )
    end

    self.Yes = vgui.Create( "DButton", self )
    self.Yes:SetText("")

    self.Yes.Color = Color(255, 255, 255)
    self.Yes.Paint = function(s, w, h)
        s.Color = GlorifiedLeveling.UI.LerpColor( FrameTime() * 10, s.Color, s:IsHovered() and self.Theme.Data.Colors.resetLevelYesButtonBackgroundHoverCol or self.Theme.Data.Colors.resetLevelYesButtonBackgroundCol )

        draw.RoundedBox( h * 0.1, 0, 0, w, h, s.Color )
        draw.SimpleText( GlorifiedLeveling.i18n.GetPhrase( "glYes" ), "GlorifiedLeveling.AdminMenu.SetLevelButton", w / 2, h * .43, self.Theme.Data.Colors.setLevelButtonTextCol, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER )
    end

    self.Yes.DoClick = function(s)
        if not self.SteamID then return end

        net.Start( "GlorifiedLeveling.AdminPanel.ResetPlayerLevel" )
         net.WriteString( self.SteamID )
        net.SendToServer()

        net.Start( "GlorifiedLeveling.AdminPanel.PlayerListOpened" )
        net.SendToServer()

        self:Remove()
    end

    self.No = vgui.Create( "DButton", self )
    self.No:SetText( "" )

    self.No.Color = Color( 255, 255, 255 )
    self.No.Paint = function( s, w, h )
        s.Color = GlorifiedLeveling.UI.LerpColor( FrameTime() * 10, s.Color, s:IsHovered() and self.Theme.Data.Colors.resetLevelNoButtonBackgroundHoverCol or self.Theme.Data.Colors.resetLevelNoButtonBackgroundCol )

        draw.RoundedBox( h * .1, 0, 0, w, h, s.Color )
        draw.SimpleText( GlorifiedLeveling.i18n.GetPhrase( "glNo" ), "GlorifiedLeveling.AdminMenu.SetLevelButton", w / 2, h * .43, self.Theme.Data.Colors.setLevelButtonTextCol, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER )
    end

    self.No.DoClick = function(s)
        self:Remove()
    end

    timer.Simple( 0, function()
        if self.Username then return end
        steamworks.RequestPlayerInfo( self.SteamID, function( name )
            self.Username = name
        end )
    end )
end

function PANEL:PerformLayout( w, h )
    self.Close:SetSize( h * 0.18, h * 0.18 )
    self.Close:SetPos( w - h * 0.18, 0 )

    self.Yes:SetSize( w * 0.95, h * 0.2)
    self.Yes:SetPos( w * 0.025, h * 0.5)

    self.No:SetSize( w * 0.95, h * 0.2 )
    self.No:SetPos( w * 0.025, h * 0.73 )
end

function PANEL:Think()
    self:MoveToFront()
end

function PANEL:Paint( w, h )
    draw.RoundedBox( 6, 0, 0, w, h, self.Theme.Data.Colors.adminMenuConfirmationBackgroundCol )
    draw.RoundedBoxEx( 6, 0, 0, w, h * 0.18, self.Theme.Data.Colors.adminMenuConfirmationTopBackgroundCol, true, true )

    draw.SimpleText( GlorifiedLeveling.i18n.GetPhrase( "glConfirmation" ), "GlorifiedLeveling.AdminMenu.SetLevelTitle", w * 0.021, h * 0.08, self.Theme.Data.Colors.adminMenuNavbarItemCol, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
    draw.DrawText( GlorifiedLeveling.i18n.GetPhrase( "glConfirmationResetLevel", self.Username and self.Username or self.SteamID or "undefined" ), "GlorifiedLeveling.AdminMenu.SetLevelDescription", w * 0.021, h * 0.23, self.Theme.Data.Colors.adminMenuNavbarItemCol )
end

vgui.Register( "GlorifiedLeveling.ResetLevelConfirmation", PANEL, "EditablePanel" )
--addons/glorifiedleveling/lua/glorifiedleveling/modules/ui/adminpanel/cl_glorifiedleveling_setlevelconfirmation.lua:

local PANEL = {}

function PANEL:Init()
    self:SetSize( ScrH() * 0.5, ScrH() * 0.2 )
    self:Center()
    self:MakePopup()

    self.Theme = GlorifiedLeveling.Themes.GetCurrent()

    self.Close = vgui.Create("DButton", self)
    self.Close:SetText("")

    self.Close.DoClick = function(s)
        self:Remove()
    end

    self.Close.Color = Color( 255, 255, 255 )
    self.Close.Paint = function( s, w, h )
        local iconSize = h * .5

        s.Color = GlorifiedLeveling.UI.LerpColor( FrameTime() * 5, s.Color, s:IsHovered() and self.Theme.Data.Colors.adminMenuCloseButtonHoverCol or self.Theme.Data.Colors.adminMenuCloseButtonCol )

        surface.SetDrawColor( s.Color )
        surface.SetMaterial( self.Theme.Data.Materials.close )
        surface.DrawTexturedRect( w / 2 - iconSize / 2, h / 2 - iconSize / 2, iconSize, iconSize )
    end

    self.Entry = vgui.Create( "DTextEntry", self )
    self.Entry:SetValue( "0" )
    self.Entry:SetFont( "GlorifiedLeveling.AdminMenu.SetLevelEntry" )
    self.Entry:SetNumeric( true )

    self.Enter = vgui.Create( "DButton", self )
    self.Enter:SetText("")

    self.Enter.Color = Color( 255, 255, 255 )
    self.Enter.Paint = function( s, w, h )
        s.Color = GlorifiedLeveling.UI.LerpColor( FrameTime() * 10, s.Color, s:IsHovered() and self.Theme.Data.Colors.setLevelButtonBackgroundHoverCol or self.Theme.Data.Colors.setLevelButtonBackgroundCol )

        draw.RoundedBox( h * 0.1, 0, 0, w, h, s.Color )
        draw.SimpleText( GlorifiedLeveling.i18n.GetPhrase( "glEnter" ), "GlorifiedLeveling.AdminMenu.SetLevelButton", w / 2, h * .43, self.Theme.Data.Colors.setLevelButtonTextCol, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER )
    end

    self.Enter.DoClick = function( s )
        if not self.SteamID then return end
        if tonumber( self.Entry:GetValue() ) < 0 or tonumber( self.Entry:GetValue() ) > GlorifiedLeveling.Config.MAX_LEVEL then
            GlorifiedLeveling.Notify( NOTIFY_ERROR, 3, GlorifiedLeveling.i18n.GetPhrase( "glInvalidAmount" ) )
            return
        end

        net.Start("GlorifiedLeveling.AdminPanel.SetPlayerLevel")
         net.WriteString( self.SteamID )
         net.WriteUInt( self.Entry:GetValue(), 32 )
        net.SendToServer()

        net.Start("GlorifiedLeveling.AdminPanel.PlayerListOpened")
        net.SendToServer()

        self:Remove()
    end

    timer.Simple(0, function()
        if self.Username then return end
        steamworks.RequestPlayerInfo(self.SteamID, function(name)
            self.Username = name
        end)
    end)
end

function PANEL:PerformLayout( w, h )
    self.Close:SetSize( h * 0.18, h * 0.18 )
    self.Close:SetPos( w - h * 0.18, 0 )

    self.Entry:SetSize( w * 0.95, h * 0.2 )
    self.Entry:SetPos( w * 0.025, h * 0.4)

    self.Enter:SetSize( w * 0.95, h * 0.2)
    self.Enter:SetPos( w * 0.025, h * 0.73)
end

function PANEL:Think()
    self:MoveToFront()
end

function PANEL:Paint( w, h )
    draw.RoundedBox( 6, 0, 0, w, h, self.Theme.Data.Colors.adminMenuConfirmationBackgroundCol )
    draw.RoundedBoxEx( 6, 0, 0, w, h * 0.18, self.Theme.Data.Colors.adminMenuConfirmationTopBackgroundCol, true, true )

    draw.SimpleText( GlorifiedLeveling.i18n.GetPhrase( "glSetLevel" ), "GlorifiedLeveling.AdminMenu.SetLevelTitle", w * .021, h * .08, self.Theme.Data.Colors.adminMenuNavbarItemCol, TEXT_ALIGN_LEFT, TEXT_ALIGN_CENTER )
    draw.SimpleText( GlorifiedLeveling.i18n.GetPhrase( "glEnterLevel", self.Username and self.Username or self.SteamID or "undefined" ), "GlorifiedLeveling.AdminMenu.SetLevelDescription", w * 0.021, h * 0.23, self.Theme.Data.Colors.adminMenuNavbarItemCol )
end

vgui.Register( "GlorifiedLeveling.SetLevelConfirmation", PANEL, "EditablePanel" )
--addons/darkrpmodification/lua/darkrp_language/chatcommands.lua:
--[[---------------------------------------------------------------------------
English (example) Chat command translation file
---------------------------------------------------------------------------

This file contains translations for chat command descriptions.
On the left side you see the chat command, on the right side you see the description.
When translating these descriptions, make sure to leave the quotation marks (" ") and commas intact!

= Warning =
Sometimes when DarkRP is updated, new chat commands are added, changed and/or removed.
By default, chat commands that aren't translated will use the English description.
Chat command translations that don't exist are ignored.


= How to translate missing chat commands =
1. Start the server
2. Join it
3. In your console, enter the following command:
    darkrp_translateChatCommands
4. Come back to this file
5. Paste where it says "-- Add new chat command translations under this line:"

= Note =
Make sure the language code is right at the bottom of this file

= Using a language =
Make sure the convar gmod_language is set to your language code. You can do that in a server CFG file.
---------------------------------------------------------------------------]]

local descriptions = {
    ["/"]                     = "Global server chat.",
    ["a"]                     = "Global server chat.",
    ["addjailpos"]            = "Add a jail position where you're standing.",
    ["addlaw"]                = "Add a law to the laws board.",
    ["addowner"]              = "Invite someone to co-own the door you're looking at.",
    ["addspawn"]              = "Add a spawn position for some job (use the command name of the job as argument)",
    ["addzombie"]             = "Add a zombie spawn pos.",
    ["advert"]                = "Advertise something to everyone in the server.",
    ["agenda"]                = "Set the agenda.",
    ["ao"]                    = "Invite someone to co-own the door you're looking at.",
    ["broadcast"]             = "Broadcast something as a mayor.",
    ["buy"]                   = "Buy a pistol",
    ["buyammo"]               = "Purchase ammo",
    ["buydruglab"]            = "Purchase a Drug lab",
    ["buygunlab"]             = "Purchase a Gun lab",
    ["buymoneyprinter"]       = "Purchase a Money printer",
    ["buyshipment"]           = "Buy a shipment",
    ["buyvehicle"]            = "Buy a vehicle",
    ["channel"]               = "Tune into a radio channel.",
    ["check"]                 = "Write a cheque for a specific person.",
    ["cheque"]                = "Write a cheque for a specific person.",
    ["chief"]                 = "Become Civil Protection Chief.",
    ["citizen"]               = "Become Citizen.",
    ["cp"]                    = "Become Civil Protection and skip the vote.",
    ["cr"]                    = "Cry for help, the police will come (hopefully)!",
    ["credits"]               = "Send the DarkRP credits to someone.",
    ["demote"]                = "Demote a player from their job",
    ["demotelicense"]         = "Start a vote to get someone's license revoked.",
    ["disablestorm"]          = "Disable meteor storms.",
    ["disablezombie"]         = "Disable zombie mod.",
    ["dropmoney"]             = "Drop money on the floor.",
    ["enablestorm"]           = "Enable meteor storms.",
    ["enablezombie"]          = "Enable zombie mod.",
    ["g"]                     = "Group chat.",
    ["gangster"]              = "Become Gangster.",
    ["give"]                  = "Give money to the player you're looking at.",
    ["givelicense"]           = "Give someone a gun license",
    ["gundealer"]             = "Become Gun Dealer.",
    ["hitprice"]              = "Set the price of your hits",
    ["hobo"]                  = "Become Hobo.",
    ["jailpos"]               = "Reset jail positions and create a new one at your position.",
    ["job"]                   = "Change your job name",
    ["jobswitch"]             = "Switch jobs with the player you're looking at",
    ["lockdown"]              = "Start a lockdown. Everyone will have to stay inside",
    ["lottery"]               = "Start a lottery",
    ["makeshipment"]          = "Create a shipment from a dropped weapon.",
    ["maxzombie"]             = "Set the maximum amount of zombies that can be in a level.",
    ["maxzombies"]            = "Set the maximum amount of zombies that can be in a level.",
    ["mayor"]                 = "Become Mayor and skip the vote.",
    ["me"]                    = "Chat roleplay to say you're doing things that you can't show otherwise.",
    ["medic"]                 = "Become Medic.",
    ["mobboss"]               = "Become Mob boss.",
    ["moneydrop"]             = "Drop money on the floor.",
    ["name"]                  = "Set your RP name",
    ["nick"]                  = "Set your RP name",
    ["ooc"]                   = "Global server chat.",
    ["placelaws"]             = "Place a laws board.",
    ["pm"]                    = "Send a private message to someone.",
    ["price"]                 = "Set the price of the microwave or gunlab you're looking at",
    ["radio"]                 = "Say something through the radio.",
    ["removelaw"]             = "Remove a law from the laws board.",
    ["removeletters"]         = "Remove all of your letters.",
    ["removeowner"]           = "Remove an owner from the door you're looking at.",
    ["removespawn"]           = "Remove a spawn position for some job (use the command name of the job as argument)",
    ["removezombie"]          = "Remove a zombie spawn pos by id (get id with /showzombie).",
    ["requesthit"]            = "Request a hit from the player you're looking at",
    ["requestlicense"]        = "Request a gun license.",
    ["ro"]                    = "Remove an owner from the door you're looking at.",
    ["rpname"]                = "Set your RP name",
    ["setprice"]              = "Set the price of the microwave or gunlab you're looking at",
    ["setspawn"]              = "Reset the spawn position for some job and place a new one at your position (use the command name of the job as argument)",
    ["showzombie"]            = "Show zombie spawn positions.",
    ["sleep"]                 = "Go to sleep or wake up",
    ["splitshipment"]         = "Split the shipment you're looking at.",
    ["switchjob"]             = "Switch jobs with the player you're looking at",
    ["switchjobs"]            = "Switch jobs with the player you're looking at",
    ["teamban"]               = "Ban someone from getting a certain job",
    ["teamunban"]             = "Undo a teamban",
    ["title"]                 = "Set the title of the door you're looking at.",
    ["togglegroupownable"]    = "Set this door group ownable.",
    ["toggleown"]             = "Own or unown the door you're looking at.",
    ["toggleownable"]         = "Toggle ownability status on this door.",
    ["toggleteamownable"]     = "Toggle this door ownable by a given team.",
    ["type"]                  = "Type a letter.",
    ["unlockdown"]            = "Stop a lockdown",
    ["unownalldoors"]         = "Sell all of your doors.",
    ["unwanted"]              = "Remove a player's wanted status.",
    ["votecp"]                = "Vote to become Civil Protection.",
    ["votemayor"]             = "Vote to become Mayor.",
    ["w"]                     = "Say something in whisper voice.",
    ["wake"]                  = "Go to sleep or wake up",
    ["wakeup"]                = "Go to sleep or wake up",
    ["wanted"]                = "Make a player wanted. This is needed to get them arrested.",
    ["warrant"]               = "Get a search warrant for a certain player. With this warrant you can search their house",
    ["write"]                 = "Write a letter.",
    ["y"]                     = "Yell something out loud.",
    ["zombiemax"]             = "Set the maximum amount of zombies that can be in a level.",

    -- Add new chat command translations under this line:

}

--
DarkRP.addChatCommandsLanguage("en", descriptions)

--addons/darkrpmodification/lua/darkrp_customthings/jobs.lua:
TEAM_HUNTERP = DarkRP.createJob("Hunter", {
    color = Color(177, 9, 9),
    model = {"models/rd1/John Martson.mdl"},
    description = [[
    İz sürme, tuzak kurma ve hassas atış yetenekleriyle doğada hayatta kalma ustasıdır. Gölge gibi hareket eder, düşmanlarını uzaktan avlar ve çevresini kendi lehine kullanır.
    ]],
    weapons = {"pro_lockpick_update", "regular_keypad_cracker", "glorifiedhandcuffs_handcuffs"},
    command = "hunter",
    max = 1,
    salary = 0,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = false,
    category = "Özel Meslek",
    PlayerSpawn = function(ply)
        ply:SetMaxHealth(200)
               ply:SetHealth(200)
               ply:SetArmor(200)
                end
})

TEAM_LILLITH = DarkRP.createJob("Lilith", {
    color = Color(177, 9, 9),
    model = {"models/konnie/asapgaming/fortnite/harleyquinn.mdl", "models/konnie/asapgaming/fortnite/harleyquinn_trickster.mdl"},
    description = [[
Eski KGB ajanı, şu anki durumu belirsiz.
    ]],
    weapons = {"regular_keypad_cracker", "pro_lockpick_update", "glorifiedhandcuffs_handcuffs", "arccw_ur_ak", "zgo2_multitool", "zgo2_backpack"},
    command = "lilith",
    max = 1,
    salary = 0,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = false,
    category = "Özel Meslek",
    PlayerSpawn = function(ply)
        ply:SetMaxHealth(200)
               ply:SetHealth(200)
               ply:SetArmor(200)
                end
})

TEAM_GEORGEFLOYD = DarkRP.createJob("George Floyd", {
    color = Color(177, 9, 9),
    model = {"models/player/Floyd.mdl"},
    description = [[
    Amerika'da yaşayan bir siyahisin, ve nefes alabiliyorsun.
    ]],
    weapons = {"regular_keypad_cracker", "pro_lockpick_update", "glorifiedhandcuffs_handcuffs"},
    command = "georgefloyd",
    max = 3,
    salary = 0,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = false,
    category = "Özel Meslek",
    PlayerSpawn = function(ply)
        ply:SetMaxHealth(120)
               ply:SetHealth(120)
               ply:SetArmor(100)
               ply:SetMaxArmor(100)
                end
})


TEAM_LIBERTUS = DarkRP.createJob("LibertuS", {
    color = Color(177, 9, 9),
    model = {"models/player/darky_m/rust/nomad.mdl"},
    description = [[
    Tarihin en ölümcül seri katillerinden biri, popüler bir İngiliz Askeri olarak çalışırken 218 adet itibarlı cinayeti vardır.
    ]],
    weapons = {"regular_keypad_cracker", "pro_lockpick_update", "glorifiedhandcuffs_handcuffs", "arccw_mkb44h"},
    command = "libertus",
    max = 1,
    salary = 0,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = false,
    category = "Özel Meslek",
    PlayerSpawn = function(ply)
        ply:SetMaxHealth(200)
               ply:SetHealth(200)
               ply:SetArmor(200)
               ply:SetMaxArmor(200)
                end
})

TEAM_CABOHALLEDECEK = DarkRP.createJob("Jesse Pinkman", {
    color = Color(177, 9, 9),
    model = {"models/breaking_bad/jesse_pinkman.mdl"},
    description = [[
    Jesse Pinkman, Başlangıçta küçük çaplı bir uyuşturucu satıcısı olan Jesse, eski kimya öğretmeni Walter White ile birlikte metamfetamin üretmeye başlar. Zamanla suç dünyasının acımasız gerçekleriyle yüzleşir ve duygusal olarak derin bir dönüşüm geçirir. Kendine has konuşma tarzı ve vicdani çatışmalarıyla herkesin sevgisini kazanmıştır.
    ]],
    weapons = {"regular_keypad_cracker", "pro_lockpick_update"},
    command = "jessepinkman",
    max = 1,
    salary = 0,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = false,
    category = "Özel Meslek",
    PlayerSpawn = function(ply)
        ply:SetMaxHealth(100)
               ply:SetHealth(100)
               ply:SetArmor(0)
               ply:SetMaxArmor(0)
                end
})

TEAM_SCALLETALIDERI = DarkRP.createJob("Scaletta Lideri", {
    color = Color(177, 9, 9),
    model = {"models/player/MafiaII_VitoScalettuce_PM.mdl"},
    description = [[
    Scalleta ailesinin en tepesinde duran isim... Emrindeki adamlarla birlikte şehirde sözü geçenlerden biri. 
    Düşmanlarına korku salar, dostlarına güven verir. Vergini zamanında öde, yoksa sorun yaşarsın!
    ]],
    weapons = {"unarrest_stick", "pro_lockpick_update", "weapon_sh_keypadcracker_deploy", "weapon_csgo_knife_stiletto", "arccw_ur_coltofficer"},
    command = "scalettalideri",
    max = 1,
    salary = 0,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = false,
    category = "Birlikler",
    PlayerSpawn = function(ply)
        ply:SetMaxHealth(150)
               ply:SetHealth(150)
               ply:SetArmor(100)
               ply:SetMaxArmor(100)
                end
})

TEAM_SCALETTA = DarkRP.createJob("Scaletta Üyesi", {
    color = Color(177, 9, 9),
    model = {"models/sentry/sentryoldmob/slygoons/sentryslymale6pm.mdl", "models/sentry/sentryoldmob/slygoons/sentryslymale7pm.mdl", "models/sentry/sentryoldmob/slygoons/sentryslymale8pm.mdl", "models/sentry/sentryoldmob/slygoons/sentryslymale9pm.mdl"},
    description = [[Scaletta ailesinin sadık bir üyesi. Örgütün çıkarlarını korur, liderin emirlerini yerine getirir ve gerektiğinde kan dökmekten çekinmez. 
    Saygı kazanmak için fedakârlık yapmalı, itaat etmeli ve ailenin kurallarına sadık kalmalısın. 
    Unutma, Scaletta'ya ihanetin bedeli ağırdır...
    ]],
    weapons = {"lockpick", "regular_keypad_cracker", "weapon_csgo_knife_stiletto"},
    command = "scalettauyesi",
    max = 0,
    salary = 0,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = false,
    category = "Birlikler",
    PlayerSpawn = function(ply)
        ply:SetMaxHealth(100)
               ply:SetHealth(100)
               ply:SetArmor(50)
               ply:SetMaxArmor(50)
                   end
})

TEAM_BLACKOG = DarkRP.createJob("Black OG", {
    color = Color(177, 9, 9),
    model = {"models/GrandTheftAuto5/Franklin.mdl"},
    description = [[
    Black çetesinin en tepesinin bir altinda duran isim... Emrindeki adamlarla birlikte şehirde sözü geçenlerden biri. 
    Düşmanlarına korku salar, dostlarına güven verir. Vergini zamanında öde, yoksa sorun yaşarsın!
    ]],
    weapons = {"unarrest_stick", "pro_lockpick_update", "weapon_sh_keypadcracker_deploy", "weapon_csgo_knife_stiletto", "arccw_ur_coltofficer"},
    command = "blackog",
    max = 1,
    salary = 0,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = false,
    category = "Birlikler",
    PlayerSpawn = function(ply)


               ply:SetMaxHealth(100)
               ply:SetHealth(100)
               ply:SetArmor(100)
               ply:SetMaxArmor(100)
                end
})

TEAM_SCALETTA = DarkRP.createJob("Black Member", {
    color = Color(177, 9, 9),
    model = {"models/spike/Dauge.mdl"},
    description = [[Black çetesine sadık bir üyesi. Örgütün çıkarlarını korur, liderin emirlerini yerine getirir ve gerektiğinde kan dökmekten çekinmez. 
    Saygı kazanmak için fedakârlık yapmalı, itaat etmeli ve ailenin kurallarına sadık kalmalısın. 
    Unutma, Black'ya ihanetin bedeli ağırdır...
    ]],
    weapons = {"lockpick", "regular_keypad_cracker", "weapon_csgo_knife_stiletto"},
    command = "blackmember",
    max = 0,
    salary = 0,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = false,
    category = "Birlikler",
    PlayerSpawn = function(ply)
        ply:SetMaxHealth(100)
               ply:SetHealth(100)
               ply:SetArmor(50)
               ply:SetMaxArmor(50)
                   end
})

TEAM_SCALETTAYRD = DarkRP.createJob("Black Boss", {
    color = Color(177, 9, 9),
    model = {"models/players/lamardavis.mdl"},
    description = [[
        Black ailesinin en tepesinde duran isim... Emrindeki adamlarla birlikte şehirde sözü geçenlerden biri. 
    Düşmanlarına korku salar, dostlarına güven verir. Vergini zamanında öde, yoksa sorun yaşarsın!
    ]],
    weapons = {"unarrest_stick", "pro_lockpick_update", "weapon_sh_keypadcracker_deploy", "weapon_csgo_knife_stiletto", "arccw_ur_coltofficer"},
    command = "blackboss",
    max = 1,
    salary = 0,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = false,
    category = "Birlikler",
    PlayerSpawn = function(ply)
        ply:SetMaxHealth(150)
               ply:SetHealth(150)
               ply:SetArmor(100)
               ply:SetMaxArmor(100)
                end
})


TEAM_SAINTFAIK = DarkRP.createJob("Saint Üyesi", {
    color = Color(177, 9, 9),
    model = {"models/mark2580/payday2/pd2_swat_shield_zeal_player.mdl"},
    description = [[Saint ailesinin sadık bir üyesi. Örgütün çıkarlarını korur, liderin emirlerini yerine getirir ve gerektiğinde kan dökmekten çekinmez. 
    Saygı kazanmak için fedakârlık yapmalı, itaat etmeli ve ailenin kurallarına sadık kalmalısın. 
    Unutma, Saint'e ihanetin bedeli ağırdır...
    ]],
    weapons = {"lockpick", "regular_keypad_cracker", "weapon_csgo_knife_stiletto"},
    command = "saintuyesis",
    max = 0,
    salary = 0,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = false,
    category = "Birlikler",
    PlayerSpawn = function(ply)
        ply:SetMaxHealth(100)
               ply:SetHealth(100)
               ply:SetArmor(50)
               ply:SetMaxArmor(50)
                   end
})

TEAM_SAINTLIDER = DarkRP.createJob("Saint Lideri", {
    color = Color(177, 9, 9),
    model = {"models/mark2580/payday2/pd2_swat_heavy_zeal_player.mdl "},
    description = [[
    Saint ailesinin en tepesinde duran isim... Emrindeki adamlarla birlikte şehirde sözü geçenlerden biri. 
    Düşmanlarına korku salar, dostlarına güven verir. Vergini zamanında öde, yoksa sorun yaşarsın!
    ]],
    weapons = {"unarrest_stick", "pro_lockpick_update", "regular_keypad_cracker", "weapon_csgo_knife_stiletto", "arccw_ud_g24"},
    command = "saintlider",
    max = 1,
    salary = 0,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = false,
    category = "Birlikler",
    PlayerSpawn = function(ply)
        ply:SetMaxHealth(150)
               ply:SetHealth(150)
               ply:SetArmor(100)
               ply:SetMaxArmor(100)
                end
})

TEAM_SAINTYARDIMCILIDER = DarkRP.createJob("Saint Yardımcı Lideri", {
    color = Color(177, 9, 9),
    model = {"models/mark2580/payday2/pd2_swat_heavy_zeal_player.mdl"},
    description = [[
    Saint ailesinin en tepesinde duran isim... Emrindeki adamlarla birlikte şehirde sözü geçenlerden biri. 
    Düşmanlarına korku salar, dostlarına güven verir. Vergini zamanında öde, yoksa sorun yaşarsın!
    ]],
    weapons = {"unarrest_stick", "pro_lockpick_update", "regular_keypad_cracker", "weapon_csgo_knife_stiletto", "arccw_ud_g24"},
    command = "saintlideryrd",
    max = 1,
    salary = 0,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = false,
    category = "Birlikler",
    PlayerSpawn = function(ply)
        ply:SetMaxHealth(150)
               ply:SetHealth(150)
               ply:SetArmor(100)
               ply:SetMaxArmor(100)
                end
})

TEAM_MALOCWILLIAMS = DarkRP.createJob("Williams Üyesi", {
    color = Color(177, 9, 9),
    model = {"models/sentry/sentryoldmob/mafia/sentrymobmale2pm.mdl"},
    description = [[Williams ailesinin sadık bir üyesi. Örgütün çıkarlarını korur, liderin emirlerini yerine getirir ve gerektiğinde kan dökmekten çekinmez. 
    Saygı kazanmak için fedakârlık yapmalı, itaat etmeli ve ailenin kurallarına sadık kalmalısın. 
    Unutma, Williams'a ihanetin bedeli ağırdır...
    ]],
    weapons = {"lockpick", "regular_keypad_cracker", "weapon_csgo_knife_stiletto"},
    command = "williamsuyesi",
    max = 0,
    salary = 0,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = false,
    category = "Birlikler",
    PlayerSpawn = function(ply)
        ply:SetMaxHealth(100)
               ply:SetHealth(100)
               ply:SetArmor(50)
               ply:SetMaxArmor(50)
                   end
})

TEAM_MALOCWILLIAMSLIDER = DarkRP.createJob("Williams Lideri", {
    color = Color(177, 9, 9),
    model = {"models/konnie/imhd/yardimcilider/wildcardyrm.mdl"},
    description = [[
    Williams ailesinin en tepesinde duran isim... Emrindeki adamlarla birlikte şehirde sözü geçenlerden biri. 
    Düşmanlarına korku salar, dostlarına güven verir. Vergini zamanında öde, yoksa sorun yaşarsın!
    ]],
    weapons = {"unarrest_stick", "pro_lockpick_update", "regular_keypad_cracker", "weapon_csgo_knife_stiletto", "arccw_ud_g24"},
    command = "williamslider",
    max = 1,
    salary = 0,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = false,
    category = "Birlikler",
    PlayerSpawn = function(ply)
        ply:SetMaxHealth(150)
               ply:SetHealth(150)
               ply:SetArmor(100)
               ply:SetMaxArmor(100)
                end
})

TEAM_MALOCWILLIAMSLIDERYRD = DarkRP.createJob("Williams Yardımcı Lideri", {
    color = Color(177, 9, 9),
    model = {"models/konnie/imhd/yardimcilider/wildcardyrm.mdl"},
    description = [[
    Williams ailesinin en tepesinde duran isim... Emrindeki adamlarla birlikte şehirde sözü geçenlerden biri. 
    Düşmanlarına korku salar, dostlarına güven verir. Vergini zamanında öde, yoksa sorun yaşarsın!
    ]],
    weapons = {"unarrest_stick", "pro_lockpick_update", "regular_keypad_cracker", "weapon_csgo_knife_stiletto", "arccw_ud_g24"},
    command = "williamslideryrd",
    max = 1,
    salary = 0,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = false,
    category = "Birlikler",
    PlayerSpawn = function(ply)
        ply:SetMaxHealth(150)
               ply:SetHealth(150)
               ply:SetArmor(100)
               ply:SetMaxArmor(100)
                end
})
------------------------------------------------------------
TEAM_HOBO = DarkRP.createJob("Dilenci", {
    color = Color(20, 150, 20, 255),
    model = {"models/jessev92/player/l4d/m9-hunter.mdl"},
    description = [[Açsın, hiçbir işe kabul edilmiyorsun ve insanlardan para, yemek, eşya gibi şeyler istiyorsun. 
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.
    ]],
    weapons = {},
    command = "hobo",
    max = 5,
    salary = 0,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    hobo = true,
    category = "Sivil",
})

TEAM_TELEVIZYONCU = DarkRP.createJob("Televizyoncu", {
    color = Color(20, 150, 20, 255),
    model = {
        "models/player/Group01/male_02.mdl",
        "models/player/Group01/female_01.mdl"
    },
    description = [[
    Youtube vesaire açan bir televizyon satarsın
    ]],
    weapons = {},
    command = "televizyoncu",
    max = 2,
    salary = 0,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "Sivil",
})


TEAM_GUVENLIK = DarkRP.createJob("Özel Güvenlik", {
    color = Color(20, 150, 20, 255),
    model = {
        "models/player/BankGuard/male_04.mdl"
    },
    description = [[Terörist, Çete, Polis harici tüm herkesin güvenliğini sağlarsın, canını onlar için feda edebilecek birisisin ve para için çalışırsın. Çalıştığın kişi için /ad Koruma "Oyuncu İsmi" gibi olmalıdır.
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.]],
    weapons = {"dradio", "glorifiedhandcuffs_handcuffs", "dsr_taser"},
    command = "guvelikk",
    max = 3,
    salary = 1000,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "Sivil",
})

TEAM_PIYANO = DarkRP.createJob("Piyanocu", {
    color = Color(20, 150, 20, 255),
    model = {
        "models/player/suits/group2/male_03_open_tie.mdl"
    },
    description = [[Genellikle klasik müzik seven insanların tercihi sensin!
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.]],
    weapons = {},
    command = "piyanocu",
    max = 1,
    salary = 500,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "Sivil",
})


TEAM_BALIK = DarkRP.createJob("Müzisyen", {
    color = Color(20, 150, 20, 255),
    model = {"models/player/voikanaa/snoop_dogg.mdl"
    },
    description = [[ Genelde klasik müzik seversin, piyano ve gitar çalmasını iyi bilen birisisin.
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.]],
    weapons = {"guitar_stalker"},
    command = "guitar",
    max = 1,
    salary = 500,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "Sivil",
})

TEAM_TUTUNCU = DarkRP.createJob("Tütüncü", {
    color = Color(20, 150, 20, 255),
    model = {
        "models/winningrook/gtavc/hdtommy.mdl"
    },
    description = [[İnsanlara vape satar ve bundan kar elde eder.

    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.]],
    weapons = {},
    command = "tutuncu",
    max = 1,
    salary = 500,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "Sivil",
})

TEAM_ADMIN = DarkRP.createJob("Yetkili Görevde", {
    color = Color(20, 150, 20, 255),
    model = {"models/player/donald_duck/donald_duck.mdl"},
    description = [[Oyunculara yardımcı olur]],
    weapons = {"glorifiedhandcuffs_handcuffs", "dsr_metal_detector"},
    command = "admins",
    max = 0,
    salary = 25000,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "Yetkili Görevde",
        PlayerSpawn = function(ply)
        ply:SetMaxHealth(9999)
        ply:SetHealth(9999)
        ply:SetArmor(9999)
    end,
})


TEAM_KEKO = DarkRP.createJob("Keko", {
    color = Color(255, 247, 0),
    model = {
        "models/player/witness.mdl"
    },
    description = [[İstediğin şeyleri yapabilirsin, insanlara racon kesmek sana zevk veriyor.
    
    -Raid Atabilir.
    -Mug Yapabilir.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunabilir.]],
    weapons = {"weapon_hl2brokenbottle", "pro_lockpick_update", "regular_keypad_cracker"},
    command = "keko",
    max = 5,
    salary = 250,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "Donator",
         PlayerSpawn = function(ply)
        ply:SetMaxHealth(125)
        ply:SetHealth(125)
        ply:SetArmor(75)
    end,
})

TEAM_KUNDAK = DarkRP.createJob("Kundakçı", {
    color = Color(255, 247, 0),
    model = {
        "models/terminator/player/arnold/arnold.mdl"
    },
    description = [[Para karşılığında milletin ekmek teknesini kundakla,kendini tatmin et!
    
    -Raid Atabilir.
    -Mug Yapabilir.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunabilir.]],
    weapons = {"weapon_molotov"},
    command = "kundakciii",
    max = 2,
    salary = 250,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "Donator+",
         PlayerSpawn = function(ply)
        ply:SetMaxHealth(125)
        ply:SetHealth(125)
        ply:SetArmor(100)
    end,
})

TEAM_PASKER = DarkRP.createJob("Paralı Asker", {
    color = Color(255, 0, 0),
    model = {
        "models/player/riot.mdl"
    },
    description = [[Paralı askersin anlaşma yapabilirsin.
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.]],
    weapons = {},
    command = "pasker",
    max = 2,
    salary = 1000,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "İllegal",
})

TEAM_ARABATAMIRCISI = DarkRP.createJob("Araba Tamircisi", {
    color = Color(20, 150, 20, 255),
    model = {
        "models/player/police.mdl",
        "models/player/police_fem.mdl"
    },
    description = [[Araba Tamircisi, hasarlı veya arızalı araçları onarıp bakıma alan, sürüş güvenliği ve performans sağlayan bir meslektir.
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.]],
    weapons = {"sv_wrench"},
    command = "arabatamircisi",
    max = 2,
    salary = 550,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "Sivil",
})

TEAM_TAKSICI = DarkRP.createJob("Taksici", {
    color = Color(20, 150, 20, 255),
    model = {
        "models/player/odessa.mdl"
    },
    description = [[İnsanları bir yerden bir yere götürürsün, martı tag kullanıcılarını döversin
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.]],
    weapons = {},
    command = "taksici",
    max = 6,
    salary = 900,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "Sivil",
})

TEAM_DJ = DarkRP.createJob("Dj", {
    color = Color(20, 150, 20, 255),
    model = {
         "models/player/Group01/male_02.mdl"
    },
    description = [[Şarkı çıkarır mekanlarda çalarsın
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.]],
    weapons = {},
    command = "dj",
    max = 1,
    salary = 1200,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "Sivil",
})

TEAM_CITIZEN = DarkRP.createJob("Vatandaş", {
    color = Color(20, 150, 20, 255),
    model = {
        "models/player/Group01/male_02.mdl",
        "models/player/Group01/female_01.mdl"
    },
    description = [[Sıradan bir insansın.
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.]],
    weapons = {},
    command = "citizen",
    max = 0,
    salary = 250,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "Sivil",
})

TEAM_BUSDRIVER = DarkRP.createJob("Minibüs Şoförü", {
    color = Color(20, 150, 20, 255),
    model = {
        "models/player/Group02/male_02.mdl",
        "models/player/Group02/male_04.mdl"
    },
    description = [[Halkı güvenli şekilde taşımaktan sorumlusun.
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.]],
    weapons = {}, 
    command = "busdriver",
    max = 2, 
    salary = 300, 
    admin = 0, 
    vote = false, 
    hasLicense = true, 
    candemote = true, 
    category = "Sivil" 
})

TEAM_BANKACI = DarkRP.createJob("Bankacı", {
    color = Color(20, 150, 20, 255),
    model = {
        "models/kryptonite/phil_coulson/phil_coulson.mdl"
    },
    description = [[Legal silahlar ile kendisini koruyabilir, bankaya giriş ücreti kesebilir ve kasada printer saklayabilir.
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.]],
    weapons = {},
    command = "bankaci",
    max = 1,
    salary = 2000,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "Sivil",
})

TEAM_AVUKAT = DarkRP.createJob("Avukat", {
    color = Color(20, 150, 20, 255),
    model = {
        "models/saulgoodman/Playermodels/saulgoodman.mdl",
        "models/saulgoodman/Playermodels/saulgoodman2.mdl"
    },
    description = [[Hukuk üzerine 2 kere doktora yaptın, kitapları yalayıp yuttun ve müvekkilerinin hapse girmemesi için elinden geleni yaparsın.
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.]],
    weapons = {},
    command = "avukat",
    max = 3,
    salary = 1000,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "Sivil",
})

TEAM_OTEL = DarkRP.createJob("Otel Sahibi", {
    color = Color(20, 150, 20, 255),
    model = {
        "models/player/Group01/male_01.mdl"
    },
    description = [[Otel işletebilir ve bina içerisinde insanları koruyarak belirli ücretler alabilir.
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.]],
    weapons = {},
    command = "OTELSA",
    max = 1,
    salary = 500,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "Sivil",
})

TEAM_BEKCI = DarkRP.createJob("Bekçi", {
    color = Color(25, 25, 170, 255),
    model = {"models/erays/player/egmbekci/male_02.mdl"},
    description = [[Özellikle geceleri etrafta gezinir ve sokağın güvenliğini korursun.
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.]],
    weapons = {"stunstick", "weapon_ticketbook", "dradio", "adv_arresting_baton", "glorifiedhandcuffs_handcuffs", "dsr_metal_detector", "dsr_taser"},
    command = "bekci",
    max = 4,
    salary = 5000,
    admin = 0,
    chief = true,
    vote = false,
    candemote = true,
    hasLicense = true,
    ammo = {
        ["pistol"] = 60,
    },
    PlayerSpawn = function(ply)
        ply:SetMaxHealth(100)
        ply:SetHealth(100)
        ply:SetArmor(100)
        ply:SetMaxArmor(100)
    end,
    category = "Devlet Görevlisi",
})

TEAM_Polis = DarkRP.createJob("Polis", {
    color = Color(25, 25, 170, 255),
    model = {
        "models/rebs/egm/male_02.mdl", 
    },
    description = [[Özellikle geceleri etrafta gezinir ve sokağın güvenliğini korursun.
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.]],
    weapons = {"door_ram", "arccw_ud_g24", "arccw_ur_coltofficer", "aradio", "stunstick", "weapon_ticketbook", "adv_arresting_baton", "glorifiedhandcuffs_handcuffs", "dsr_metal_detector", "dsr_taser"},
    command = "Polis",
    max = 6,
    salary = 8000,
    admin = 0,
    chief = true,
    vote = false,
    candemote = true,
    hasLicense = true,
    ammo = {
        ["pistol"] = 120,
    },
    PlayerSpawn = function(ply)
        ply:SetMaxHealth(120)
        ply:SetHealth(120)
        ply:SetArmor(65)
        ply:SetMaxArmor(65)
    end,
    category = "Devlet Görevlisi",
})

TEAM_GANG = DarkRP.createJob("Grove Çete Lideri", {
    color = Color(255, 247, 0),
    model = {
        "models/sentry/gtav/families/ogfampm.mdl"},
    description = [[Grove çetesinin liderisin, ballas ile düşmansınız ve birlikte olmanız söz konusu bile olamaz.

    -Raid Atabilir.
    -Mug Yapabilir.
    -Banka Soyabilir.
    -Illegal Aktivitelerde Bulunabilir.
    ]],
    weapons = {"regular_keypad_cracker", "arccw_ud_gnb"},
    command = "grovecetegangster",
    max = 1,
    salary = 1000,
    admin = 0,
    vote = false,
    candemote = true,
    hasLicense = false,
    category = "Donator",
            PlayerSpawn = function(ply)
        ply:SetMaxHealth(125)
        ply:SetHealth(125)
        ply:SetArmor(100)
    end,
})

TEAM_GANG = DarkRP.createJob("Grove Çete Üyesi", {
    color = Color(255, 0, 0, 255),
    model = {
        "models/sentry/gtav/families/famfpm.mdl",
        "models/sentry/gtav/families/famcapm.mdl",
        "models/sentry/gtav/families/famfopm.mdl",
        "models/sentry/gtav/families/famdnpm.mdl"
},
    description = [[Grove çetesinin sıradan bir üyesisin, ballas ile düşmansınız ve birlikte olmanız söz konusu bile olamaz.
    
    -Raid Atabilir.
    -Mug Yapabilir.
    -Banka Soyabilir.
    -Illegal Aktivitelerde Bulunabilir.]],
    weapons = {"regular_keypad_cracker"},
    command = "siyahhgangster",
    max = 6,
    salary = 250,
    admin = 0,
    vote = false,
    candemote = true,
    hasLicense = false,
    category = "İllegal",
                  PlayerSpawn = function(ply)
        ply:SetMaxHealth(100)
        ply:SetHealth(100)
    end,
})

TEAM_TERORIST = DarkRP.createJob("Terorist Üyesi", {
    color = Color(255, 0, 0, 255),
    model = {
        "models/player/phoenix.mdl"},
    description = [[Yönetim biçimini ve devlet adamlarını sevmeyen bir isyancısın, sokağa çıkma yasağı olmadan mesleğe geçmek yasaktır.
    
    -Raid Atabilir.
    -Mug Yapabilir.
    -Banka Soyabilir.
    -Illegal Aktivitelerde Bulunabilir.]],
        weapons = {"regular_keypad_cracker", "lockpick", "arccw_ur_aks74"},
    command = "terorist",
    max = 4,
    salary = 0,
    admin = 0,
    vote = false,
    candemote = true,
    hasLicense = false,
    category = "İllegal",
            PlayerSpawn = function(ply)
        ply:SetMaxHealth(150)
        ply:SetHealth(150)
        ply:SetArmor(100)
    end,
})


TEAM_GANG = DarkRP.createJob("Ballas Çete Lideri", {
    color = Color(255, 247, 0),
    model = {
        "models/sentry/gtav/ballas/ogbalpm.mdl"},
    description = [[Ballas çetesinin liderisin, Grovelar ile düşmansınız ve birlikte olmanız söz konusu bile olamaz. 
    
    -Raid Atabilir.
    -Mug Yapabilir.
    -Banka Soyabilir.
    -Illegal Aktivitelerde Bulunabilir.]],
    weapons = {"regular_keypad_cracker", "arccw_ud_g18"},
    command = "gangster",
    max = 1,
    salary = 500,
    admin = 0,
    vote = false,
    candemote = true,
    hasLicense = false,
    category = "Donator",
        PlayerSpawn = function(ply)
        ply:SetMaxHealth(125)
        ply:SetHealth(125)
        ply:SetArmor(100)
    end,
})

TEAM_GANG = DarkRP.createJob("Ballas Çete Üyesi", {
    color = Color(255, 0, 0, 255),
    model = {
        "models/sentry/gtav/ballas/balfpm.mdl",
        "models/sentry/gtav/ballas/ballaseastpm.mdl",
        "models/sentry/gtav/ballas/ballasorigpm.mdl",
        "models/sentry/gtav/ballas/ballassoutpm.mdl"
        },
    description = [[Ballas Çetesinin sıradan bir üyesisin, Grovelar ile düşmansınız ve birlikte olmanız söz konusu bile olamaz.
    
    -Raid Atabilir.
    -Mug Yapabilir.
    -Banka Soyabilir.
    -Illegal Aktivitelerde Bulunabilir.]],
    weapons = {"regular_keypad_cracker"},
    command = "ceteuyesi",
    max = 6,
    salary = 250,
    admin = 0,
    vote = false,
    candemote = true,
    hasLicense = false,
    category = "İllegal",
                 PlayerSpawn = function(ply)
        ply:SetMaxHealth(100)
        ply:SetHealth(100)
        ply:SetArmor(0)
    end,
})

--[[
    Parkurcu Job
    Generated using: DarkRP | Job Generator
    https://yourdevtools.com/gmod/darkrp-job
--]]

TEAM_HIRSIZ = DarkRP.createJob("Hırsız", {
    color = Color(255, 0, 0, 255),
    model = {
        "models/bala/rioter_thug_pm.mdl",
        "models/bala/rioter_dare_devil_pm.mdl",
        "models/bala/rioter_charger_pm.mdl",
        "models/bala/rioter_bomber_pm.mdl"
    },
    description = [[İllegal herşey bu adamdan sorulur, illegalin ağını oluşturur. 

    -Raid Atabilir.
    -Mug Yapabilir.
    -Banka Soyabilir.
    -Illegal Aktivitelerde Bulunabilir.
    ]],
    weapons = {"regular_keypad_cracker", "lockpick"},
    command = "hirsiz",
    max = 7,
    salary = 300,
    admin = 0,
    candemote = true,
    vote = false,
    hasLicense = false,
    category = "İllegal",
})

TEAM_PROHIRSIZ = DarkRP.createJob("Profesyonel Hırsız", {
    color = Color(255, 247, 0),
    model = {
        "models/player/suits/robber_shirt.mdl"},
    description = [[Hırsızın üstüne sen varsın, bu işin kitabını yazmış birisisin.

    -Raid Atabilir.
    -Mug Yapabilir.
    -Banka Soyabilir.
    -Illegal Aktivitelerde Bulunabilir.]],
    weapons = {"regular_keypad_cracker", "pro_lockpick_update", "glorifiedhandcuffs_handcuffs", "arccw_mkb44h"},
    command = "prohirsiz",
    max = 7,
    salary = 10000,
    admin = 0,
    vote = false,
    candemote = true,
    hasLicense = true,
    category = "Donator",
         PlayerSpawn = function(ply)
        ply:SetMaxHealth(125)
        ply:SetHealth(125)
        ply:SetArmor(100)
    end,
})

TEAM_USTAHIRSIZ = DarkRP.createJob("Usta Hırsız", {
    color = Color(255, 247, 0),
    model = {
        "models/keegan.mdl"},
    description = [[Hırsızın üstüne sen varsın, bu işin kitabını yazmış birisisin.

    -Raid Atabilir.
    -Mug Yapabilir.
    -Banka Soyabilir.
    -Illegal Aktivitelerde Bulunabilir.]],
    weapons = {"regular_keypad_cracker", "pro_lockpick_update", "glorifiedhandcuffs_handcuffs", "arccw_myt_uc_scar"},
    command = "ustahirsiz",
    max = 7,
    salary = 10000,
    admin = 0,
    vote = false,
    candemote = true,
    hasLicense = true,
    category = "Donator+",
    PlayerSpawn = function(ply)
        ply:SetMaxHealth(150)
        ply:SetHealth(150)
        ply:SetArmor(125)
    end,
})

TEAM_TERORISTLIDERI = DarkRP.createJob("Terorist Lideri", {
    color = Color(255, 247, 0),
    model = {
        "models/player/guerilla.mdl"},
    description = [[Yönetim biçimini ve devlet adamlarını sevmeyen bir isyancı topluluğunun liderisin, sokağa çıkma yasağı olmadan mesleğe geçmek yasaktır. 

    -Raid Atabilir.
    -Mug Yapabilir.
    -Banka Soyabilir.
    -Illegal Aktivitelerde Bulunabilir.
    ]],
    weapons = {"lockpick", "regular_keypad_cracker", "arccw_ur_aks74u"},
    command = "teroristlideri",
    max = 1,
    salary = 0,
    admin = 0,
    vote = false,
    candemote = true,
    hasLicense = false,
    category = "Donator",
        PlayerSpawn = function(ply)
        ply:SetMaxHealth(150)
        ply:SetHealth(100)
        ply:SetArmor(100)
    end,
})


TEAM_FAISE = DarkRP.createJob("Hayat Kadını", {
    color = Color(255, 0, 0, 255),
    model = {
        "models/sentry/gtav/lost/lostgirlbpm.mdl",
        "models/sentry/gtav/lost/lostgirlwpm.mdl"
},
    description = [[Para, seviş, sikiş, sana kalmış.. 
    
    -Raid atamaz.
    -Mug Yapabilir.
    -Banka soyamaz.
    -Illegal Aktivitelerde Bulunamaz.]],
    weapons = {"glorifiedhandcuffs_handcuffs"},
    command = "faise",
    max = 2,
    salary = 250,
    admin = 0,
    candemote = true,
    vote = false,
    hasLicense = false,
    category = "İllegal",
})


TEAM_BGUVENLIK = DarkRP.createJob("Banka Güvenliği", {
    color = Color(20, 150, 20, 255),
    model = {
        "models/player/BankGuard/male_09.mdl"},
    description = [[Amacın bankayı korumaktır, ruhsatın olmadan silahı kullanma iznin olmaz.
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.
    ]],
    weapons = {"dradio", "glorifiedhandcuffs_handcuffs", "dsr_taser"},
    command = "bankaguvelik",
    max = 3,
    salary = 500,
    admin = 0,
    candemote = true,
    vote = false,
    hasLicense = false,
    category = "Sivil",
})


TEAM_ADAMK = DarkRP.createJob("Adam Kaçırıcısı", {
    color = Color(255, 0, 0, 255),
    model = {
        "models/bala/rioter_survivor_pm.mdl",
        "models/bala/rioter_scout_pm.mdl"
        },
    description = [[İnsanları kaçırıp onları para karşılığı satabilir veya (max) 50000tl karşılığında onları salabilirsin.
    
    -Raid Atamaz.
    -Mug Yapabilir.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunabilir.
    ]],
    weapons = {"glorifiedhandcuffs_handcuffs"},
    command = "adamkacirisi",
    max = 5,
    salary = 250,
    admin = 0,
    vote = false,
    candemote = true,
    hasLicense = false,
    category = "İllegal",
})
TEAM_PROADAMK = DarkRP.createJob("Pro Adam Kaçırıcısı", {
    color = Color(255, 247, 0),
    model = {
        "models/bala/chaosmerchant.mdl"},
    description = [[İstediğin Zaman Adam Kaçırabilirsin, Her kaçırmadan sonra 15 dakika beklemelisin 
    
    -Raid Atabilir.
    -Mug Yapabilir.
    -Banka Soyabilir.
    -Illegal Aktivitelerde Bulunabilir.]],
    weapons = {"regular_keypad_cracker", "arccw_mkb44h", "pro_lockpick_update", "glorifiedhandcuffs_handcuffs"},
    command = "proadamkacirisi",
    max = 7,
    salary = 10000,
    admin = 0,
    vote = false,
    candemote = true,
    hasLicense = false,
    category = "Donator",
         PlayerSpawn = function(ply)
        ply:SetMaxHealth(125)
        ply:SetHealth(125)
        ply:SetArmor(100)
    end,
})
TEAM_MULTECI = DarkRP.createJob("Afgan", {
    color = Color(20, 150, 20, 255),
    model = {
        "models/player/Group03/male_03.mdl"
        },
    description = [[Savaştan kaçarak bu şehire sığındın ve para kazanman lazım.
    
    -Raid Atamaz.
    -Mug Yapabilir.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunabilir.
    ]],
    weapons = {"weapon_bugbait"},
    command = "afgan",
    max = 10,
    salary = 50,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "Sivil",
})
TEAM_SURIYELI = DarkRP.createJob("Suriyeli", {
    color = Color(20, 150, 20, 255),
    model = {
        "models/player/Group01/male_03.mdl"
        },
    description = [[ Savaştan kaçarak bu şehire sığındın ve para kazanman lazım.

    -Raid Atamaz.
    -Mug Yapabilir.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunabilir.]],
    weapons = {},
    command = "surii",
    max = 10,
    salary = 50,
    admin = 0,
    vote = false,
    candemote = true,
    hasLicense = false,
    category = "Sivil",
})

TEAM_ITALYANMAFYA = DarkRP.createJob("Italyan Mafya", {
    color = Color(255, 0, 0, 255),
    model = {"models/player/suits/group3/male_09_open.mdl"},
    description = [[İtalya'da oldukça popülersin, insanlar senden korkuyor ve baş edemiyor en çok bilinen özelliğin ise stiletto bıçağın, Rus mafyası ile takım olamaz.
    
    -Raid Atabilir.
    -Mug Yapabilir.
    -Banka Soyabilir.
    -Illegal Aktivitelerde Bulunabilir.
    ]],
    weapons = {"regular_keypad_cracker", "csgo_stiletto"},
    command = "italyanmafya",
    max = 5,
    salary = 500,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "İllegal",
         PlayerSpawn = function(ply)
        ply:SetMaxHealth(100)
        ply:SetHealth(100)
    end,
})
TEAM_ITALYANMAFYALIDER = DarkRP.createJob("Italyan Mafya Lideri", {
    color = Color(255, 0, 0, 255),
    model = {"models/player/suits/group3/male_09_open.mdl"},
    description = [[İtalya'da oldukça popülersin, insanlar senden korkuyor ve baş edemiyor en çok bilinen özelliğin ise stiletto bıçağın, Rus mafyası ile takım olamaz.
    
    -Raid Atabilir.
    -Mug Yapabilir.
    -Banka Soyabilir.
    -Illegal Aktivitelerde Bulunabilir.
    ]],
    weapons = {"regular_keypad_cracker"},
    command = "italyanmafyalider",
    max = 1,
    salary = 500,
    admin = 0,
    vote = true,
    hasLicense = false,
    candemote = true,
    category = "İllegal",
         PlayerSpawn = function(ply)
        ply:SetMaxHealth(100)
        ply:SetHealth(100)
    end,
})

--[[
    Generated using: DarkRP | Job Generator
    https://csite.io/tools/gmod-darkrp-job
--]]
TEAM_RUSMAFYA = DarkRP.createJob("Rus Mafyası", {
    color = Color(255, 0, 0, 255),
    model = {
             "models/player/suits/group3/male_06_open_tie.mdl"
            },
    description = [[Rus mafyasından birisisin, siberde ve yönetimde elin vardır, en bilindik özelliğin silah ticaretidir. İtalyan mafyası ile takım olamazsın.
    
    -Raid Atabilir.
    -Mug Yapabilir.
    -Banka Soyabilir.
    -Illegal Aktivitelerde Bulunabilir.
    ]],
    weapons = {"regular_keypad_cracker", "csgo_ursus"},
    command = "rusmafya",
    max = 5,
    salary = 500,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "İllegal",
                 PlayerSpawn = function(ply)
        ply:SetMaxHealth(100)
        ply:SetHealth(100)
    end,
})
TEAM_RUSMAFYALIDER = DarkRP.createJob("Rus Mafya Lideri", {
    color = Color(255, 0, 0, 255),
    model = {"models/player/suits/group2/male_08_open_tie.mdl"},
    description = [[Rus mafyasından birisisin, siberde ve yönetimde elin vardır, en bilindik özelliğin silah ticaretidir. İtalyan mafyası ile takım olamazsın.
    
    -Raid Atabilir.
    -Mug Yapabilir.
    -Banka Soyabilir.
    -Illegal Aktivitelerde Bulunabilir.
    ]],
    weapons = {"regular_keypad_cracker"},
    command = "rusmafyalieri",
    max = 1,
    salary = 500,
    admin = 0,
    vote = true,	
    hasLicense = false,
    candemote = true,
    category = "İllegal",
                 PlayerSpawn = function(ply)
        ply:SetMaxHealth(100)
        ply:SetHealth(100)
    end,
})

TEAM_COCUK = DarkRP.createJob("Çocuk", {
    color = Color(20, 150, 20, 255),
    model = {"models/Player/child_worker_f1.mdl"},
    description = [[İllegal olan herşey yasaktır kendini insanlara sevdir ve rol pasla! Kimse hasar veremez.
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.
    ]],
    weapons = {"weapon_darari"},
    command = "cocuk",
    max = 2,
    salary = 15,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "Sivil",
})

TEAM_SISKO = DarkRP.createJob("Şişko", {
    color = Color(20, 150, 20, 255),
    model = {"models/dawson/obese_male_deluxe_edition/obese_male_gregory_01.mdl"},
    description = [[Asosyal bir insansın, yemek yemeyi çok seversin ve obezsin.
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.
    ]],
    weapons = {},
    command = "sisko",
    max = 2,
    salary = 300,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "Sivil",
})

TEAM_GUN = DarkRP.createJob("Karaborsacı", {
    color = Color(255, 0, 0, 255),
    model = {"models/player/eli.mdl"},
    description = [[İşi silah satmaktır.
    Dükkan kurabilir.
    şehirde başka bir silah satıcısı aktifse bir mafya babasına çalışabilir.
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.
    ]],
    weapons = {},
    command = "gundealer",
    max = 2,
    salary = 800,
    admin = 0,
    vote = false,
    hasLicense = true,
    candemote = true,
    category = "İllegal",
})
TEAM_GUNDEALER = DarkRP.createJob("Usta Karaborsacı", {
    color = Color(255, 247, 0),
    model = {"models/player/eli.mdl"},
    description = [[İşi silah satmaktır. Dükkan kurabilir. şehirde başka bir silah satıcısı aktifse bir mafya babasına çalışabilir.
        
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.
    ]],
    weapons = {},
    command = "prgundealer",
    max = 3,
    salary = 800,
    admin = 0,
    vote = false,
    hasLicense = true,
    candemote = true,
    category = "Donator",
})
TEAM_SILAH = DarkRP.createJob("Silah Satıcısı", {
    color = Color(20, 150, 20, 255),
    model = {"models/player/monk.mdl"},
    description = [[Hiç kimse ile iş birliğinde bulunamazsın, legal bir silah pazarlamacısısın ve ruhsatsız silah satamazsın.
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.
    ]],
    weapons = {},
   command = "silahsaticisi",
    max = 4,
    salary = 850,
    admin = 0,
    vote = false,
    hasLicense = true,
    candemote = true,
    category = "Sivil",
})
TEAM_KOPEKBALIGI = DarkRP.createJob("K9", {
    color = Color(20, 150, 20, 255),
    model = {
        "models/falloutdog/falloutdog.mdl"
    },
    description = [[Etrafta dolaşan patili dostlarımızdansın insanlar sana saldırmadığı sürece onlara saldıramazsın, kuduz olma gibi durumun yoktur, devletin köpeğisin baskınlarda uyuşturucu arayabilirsin!
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.
    ]],
    weapons = {"weapon_pet", "zwf_sniffer", "fuckmyass"},
    command = "kopek",
    max = 2,
    salary = 1,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "Devlet Görevlisi",
})

TEAM_MEDIC = DarkRP.createJob("Doktor", {
    color = Color(20, 150, 20, 255),
    model = {"models/player/Sanitar_Cohrt.mdl"},
    description = [[Eskiden bir Veteran'dın ancak savaşta gazi oldun ve bir daha cepheye çıkmana izin verilmemesinin ardından şehirde doktorculuk oynamaya başladın. Bir dükkan açabilir ve insanları para karşılığı iyileştirebilirsin.
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.
    ]],
    weapons = {"weapon_medkit"},
    command = "medic",
    max = 3,
    salary = 3500,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    medic = true,
    category = "Sivil",
})


TEAM_HAKIM = DarkRP.createJob("Hakim", {
    color = Color(25, 25, 170, 255),
    model = {"models/player/gman_high.mdl"},
    description = [[Mesleğinde hiç hata yapmayacak birisin ve suçlular veyahut suçlu olarak gözüken kader mahkumlarının sonucuna sen karar vereceksin. Sen varken suçlular direk hapise.
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.
    ]],
    weapons = {"unarrest_stick"},
    command = "hakim",
    max = 1,
    salary = 10000,
    admin = 0,
    candemote = true,
    vote = false,
    hasLicense = false,
    category = "Devlet Görevlisi",
})

TEAM_BKIZI = DarkRP.createJob("Başkan'ın Kızı", {
    color = Color(20, 150, 20, 255),
    model = {"models/mark2580/FF/alyx_ff_v9_pushreplika_player.mdl"},
    description = [[Babanın yanından ayrılmayı sevmezsin, hem kızı hemde asistanı gibi davranmalısın.
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.
    ]],
    weapons = {},
    command = "baskankizi",
    max = 1,
    salary = 500,
    admin = 0,
    vote = false,
    candemote = true,
    hasLicense = false,
    category = "Sivil",
    
})

TEAM_MAYOR = DarkRP.createJob("Başkan", {
    color = Color(25, 25, 170, 255),
    model = {"models/player/breen.mdl"},
    description = [[Şehir başkanıdır.
    Polisler ile birlikte çalışır.
    Polislerin warrant izinlerini kabul eder.
    /wanted <isim> yazarak bir kişiyi aratabilir.
    /jailpos yazarak hapishane pozisyonunu ayarlayabilir.
    /lockdown yazarak dışarı çıkma yasağı başlatabilir.
    Lockdown süresince polisler hariç kimse dışarı çıkmamalıdır.
    Dışarı çıkanlar hakkında vurma, hapis yaptırma hakkına sahiptir.
    /unlockdown yazarak lockdownu bitirebilir.
    Öldüğünde meslekten atılır.
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.
    ]],
    weapons = {"door_ram", "weapon_ticketbook", "unarrest_stick", "aradio", "adv_arresting_baton", "glorifiedhandcuffs_handcuffs", "dsr_metal_detector", "dsr_taser"},
    command = "mayor",
    max = 1,
    salary = 15000,
    admin = 0,
    vote = true,
    hasLicense = true,
    mayor = true,
    candemote = true,
    category = "Devlet Görevlisi",
    PlayerSpawn = function(ply)
         ply:SetMaxHealth(150)
        ply:SetHealth(150)
        ply:SetArmor(100)
        ply:SetMaxArmor(100)
    end,
    PlayerDeath = function(ply)
                if ply:Team() == TEAM_MAYOR then
                        ply:changeTeam( TEAM_CITIZEN, true )
                        for k,v in ipairs( player.GetAll() ) do
                                DarkRP.notify(v, 1, 4, "Başkan öldürüldü!")
                        end
                end
        end,
})



TEAM_BASKANKORUMA = DarkRP.createJob("Sivil Polis", {
    color = Color(20, 150, 20, 255),
    model = {"models/player/Group01/male_04.mdl"},
    description = [[Sivil bir polissin, baskınlara katılamazsın ve kimkiğini açığa çıkarmamalısın.
    
    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.
    ]],
    weapons = {"door_ram", "aradio", "arccw_ur_coltofficer", "arccw_ud_g24", "stunstick", "weapon_ticketbook", "adv_arresting_baton", "glorifiedhandcuffs_handcuffs", "dsr_metal_detector", "dsr_taser"},
    command = "baskankorumasi",
    max = 3,
    salary = 8500,
    admin = 0,
    vote = false,
    candemote = true,
    hasLicense = true,
    category = "Devlet Görevlisi",
    PlayerSpawn = function(ply)
 ply:SetMaxHealth(130)
        ply:SetHealth(130)
        ply:SetArmor(100)
        ply:SetMaxArmor(100)
            end
})

TEAM_YAKUP = DarkRP.createJob("YakupTV", {
    color = Color(255, 247, 0),
    model = {
        "models/player/odell/yakub.mdl"
    },
    description = [[Esnafları ziyaret edip yemek için dilen, eğer sana az yemek verirlerse canlı yayınlarda iyi karşılanmadığını belirt.]],
    weapons = {},
    command = "yakuptv",
    max = 1,
    salary = 250,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "Donator",
         PlayerSpawn = function(ply)
        ply:SetMaxHealth(150)
        ply:SetHealth(150)
        ply:SetArmor(100)
    end,
})

TEAM_AGIRZIRH = DarkRP.createJob("Özel Kuvvet", {
    color = Color(255, 247, 0),
    model = {"models/mark2580/payday2/pd2_bulldozer_zeal_player.mdl"
            },
    description = [[Şehirde çok ses olduğu zaman iniş yapmalısın. Şehrin güvenliği ve özellikle başkan senden sorumludur!
    
    -Raid Atabilir.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.
    ]],
    weapons = {"door_ram", "arccw_go_shield", "aradio", "door_ram", "stunstick", "arccw_ud_g24", "weapon_ticketbook", "adv_arresting_baton", "glorifiedhandcuffs_handcuffs", "arccw_ud_m1014sport", "dsr_metal_detector", "dsr_taser"},
    command = "agirzirh",
    max = 2,
    salary = 16500,
    admin = 0,
    chief = true,
    vote = false,
    candemote = true,
    hasLicense = true,
    category = "Devlet Görevlisi",
    PlayerSpawn = function(ply)
 ply:SetMaxHealth(250)
        ply:SetHealth(250)
        ply:SetArmor(250)
        ply:SetMaxArmor(250)
            end
})
TEAM_POH = DarkRP.createJob("PÖH", {
    color = Color(25, 25, 170, 255),
    model = {"models/player/icpd/swat/male_gta_masked.mdl"},
    description = [[Şehirde çok ses olduğu zaman iniş yapmalısın. Şehrin güvenliği ve özellikle başkan senden sorumludur!
    
    -Raid Atabilir.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.
    ]],
    weapons = {"door_ram", "aradio", "stunstick", "weapon_ticketbook", "arccw_ud_g24", "adv_arresting_baton", "glorifiedhandcuffs_handcuffs", "dsr_metal_detector", "dsr_taser", "arccw_ur_g3"},
    command = "poh",
    max = 10,
    salary = 13000,
    admin = 0,
    chief = true,
    vote = false,
    hasLicense = true,
    candemote = true,
    category = "Devlet Görevlisi",
    PlayerSpawn = function(ply)
 ply:SetMaxHealth(200)
        ply:SetHealth(200)
        ply:SetArmor(120)
        ply:SetMaxArmor(120)
            end
})

TEAM_POHKESKIN = DarkRP.createJob("PÖH Keskin Nişancı", {
    color = Color(25, 25, 170, 255),
    model = {"models/player/icpd/swat/male_gta_masked.mdl"},
    description = [[Şehrin Güveliği Sağlamak İle Hükümlüdür
    
    -Raid Atabilir.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.    
    ]],
    weapons = {"arccw_ur_awm", "door_ram", "aradio", "stunstick", "weapon_ticketbook", "adv_arresting_baton", "glorifiedhandcuffs_handcuffs", "arccw_ud_g24", "dsr_metal_detector", "dsr_taser"},
    command = "pohsniper",
    max = 4,
    salary = 15000,
    admin = 0,
    chief = true,
    vote = false,
    hasLicense = true,
    candemote = true,
    category = "Devlet Görevlisi",
    PlayerSpawn = function(ply)
        ply:SetMaxHealth(200)
        ply:SetHealth(200)
        ply:SetArmor(120)
        ply:SetMaxArmor(120)
            end
})

TEAM_POHDOKTOR = DarkRP.createJob("PÖH Doktor", {
    color = Color(25, 25, 170, 255),
    model = {"models/player/icpd/swat/male_gta_masked.mdl"},
    description = [[Savaştan çok ekip arkadaşlarını düşünüp herhangi bir kazada hemen yanlarında olup onları tedavi etmelisin. Hipokrat yemini ettin unutma!

    -Raid Atabilir.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.
    ]],
    weapons = { "door_ram", "aradio", "stunstick", "weapon_ticketbook", "arccw_ud_g24", "adv_arresting_baton", "glorifiedhandcuffs_handcuffs", "dsr_metal_detector", "dsr_taser", "dsr_medkit", "weapon_medkit", "arccw_myt_uc_scar", "arccw_ud_g24"},
    command = "pohdoktor",
    max = 4,
    salary = 13000,
    admin = 0,
    chief = true,
    medic = true,
    vote = false,
    hasLicense = true,
    candemote = true,
    category = "Devlet Görevlisi",
    PlayerSpawn = function(ply)
        ply:SetMaxHealth(200)
        ply:SetHealth(200)
        ply:SetArmor(120)
        ply:SetMaxArmor(120)
            end
})

TEAM_POHAMIR = DarkRP.createJob("PÖH Amir", {
    color = Color(25, 25, 170, 255),
    model = {"models/player/icpd/swat/male_gta_masked.mdl"},
    description = [[Şehirin güvenliğini korumada planı yapan ve başkanın yanında korumalar ile ayrılmayan kişisin. Diğer PÖH'leri eğit!
    
    -Raid Atabilir.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.    
    ]],
    weapons = { "door_ram", "aradio", "stunstick", "weapon_ticketbook", "adv_arresting_baton", "arccw_ud_g24", "weapon_grapplehook", "glorifiedhandcuffs_handcuffs", "dsr_metal_detector", "dsr_taser", "arccw_ud_coltlmg"},
    command = "poha",
    max = 4,
    salary = 25000,
    admin = 0,
    chief = true,
    candemote = true,
    vote = false,
    hasLicense = true,
    category = "Devlet Görevlisi",
    PlayerSpawn = function(ply)
 ply:SetMaxHealth(200)
        ply:SetHealth(200)
        ply:SetArmor(120)
        ply:SetMaxArmor(120)
    end
})

TEAM_EMNIYETAMIR = DarkRP.createJob("Emniyet Amiri", {
    color = Color(25, 25, 170, 255),
    model = {"models/player/suits/group3/male_08_open_tie.mdl"},
    description = [[ İlçenin tüm polis örgütleri senden sorumludur onlara karşı yeri geldiğinde iyi yeri geldiğinde kötü davranarak doğruları öğret. Unutma ki hepsi senin evladın!
        
    -Raid Atabilir.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.        
    ]],
    weapons = {"door_ram", "aradio", "stunstick", "weapon_ticketbook", "adv_arresting_baton", "glorifiedhandcuffs_handcuffs", "dsr_metal_detector", "dsr_taser", "arccw_ur_mp5swordfish", "arccw_ud_g24"},
    command = "emniyetamirii",
    max = 1,
    chief = true,
    salary = 10000,
    admin = 0,
    vote = false,
    hasLicense = true,
    candemote = true,
    category = "Devlet Görevlisi",
    PlayerSpawn = function(ply)
         ply:SetMaxHealth(180)
        ply:SetHealth(180)
        ply:SetArmor(170)
        ply:SetMaxArmor(170)
    end
})

TEAM_CIA = DarkRP.createJob("MIT Ajanı", {
    color = Color(255, 0, 0, 255),
    model ={
            "models/player/spike/Triton.mdl"
            },
    description = [[ Milli istihbarat teşkilatından bir özel eğitilmiş ajansın, suçluluarı öldürüp bunu örtpas edebilirsin 
    
    -Raid Atabilir.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.    
    ]],
    weapons = { "glorifiedhandcuffs_handcuffs", "arccw_ur_coltofficer", "aradio", "arccw_ud_g24", "arccw_ur_mp5"},
    command = "CIA",
    max = 6,
    salary = 10000,
    admin = 0,
    vote = false,
    hasLicense = true,
    candemote = true,
    category = "Devlet Görevlisi",
     PlayerSpawn = function(ply)
         ply:SetMaxHealth(150)
        ply:SetHealth(150)
        ply:SetArmor(150)
        ply:SetMaxArmor(150)
    end
})       

TEAM_HACKER = DarkRP.createJob("Hacker", {
    color = Color(255, 247, 0),
    model = {"models/players/ck_iss_delsin.mdl"},
    description = [[Çocukluğundan beri bilgisayarlara bir ilgin var, yazılımda ustasın Polis Departmanının serverlarına sızabilirsin.

    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunabilir.    
    ]],
    weapons = {"hacktool"},
    command = "hacker",
    max = 1,
    salary = 1000,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "Donator",
    PlayerSpawn = function(ply)
       ply:SetArmor(50)
   end
})

TEAM_HIT = DarkRP.createJob("Hitman", {
    color = Color(255, 0, 0, 255),
    model = {"models/player/hitman_absolution_47_classic.mdl"},
    description = [[İnsanların isteği üzerine söylenen kişiyi öldürürsün. 10 dakikada bir kere hit alabilirsin ve hit alınca "/ad hit accepted" yazmalısın. Başkanı lockdown dışı hiçbir türlü öldüremezsin, Hitini bitirince "/ad Hit completed" yazmalısın.
Raid (sadece hit aldığı kişiyi öldürmek için) yapabilir  

    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.
    ]],
    weapons = {"weapon_csgo_knife_classic", "arccw_ur_awm"},
    command = "hitman",
    max = 1,
    salary = 500,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "İllegal",
    NeedToChangeFrom = TEAM_HITMAN,
         PlayerDeath = function(ply)
                if ply:Team() == TEAM_HIT then
                        ply:changeTeam( TEAM_CITIZEN, true )
                        for k,v in ipairs( player.GetAll() ) do
                                DarkRP.notify(v, 1, 4, "Hitman kendini ifşa etti!")
                        end
                end
        end,
})

TEAM_HITPRO = DarkRP.createJob("Profesyonel Hitman", {
    color = Color(255, 247, 0),
    model = {"models/player/hitman_absolution_47_classic.mdl"},
    description = [[İnsanların isteği üzerine söylenen kişiyi öldürürsün. 10 dakikada bir kere hit alabilirsin ve hit alınca "/ad hit accepted" yazmalısın. Başkanı lockdown dışı hiçbir türlü öldüremezsin, Hitini bitirince "/ad Hit completed" yazmalısın.
Raid (sadece hit aldığı kişiyi öldürmek için) yapabilir  

    -Raid Atamaz.
    -Mug Yapamaz.
    -Banka Soyamaz.
    -Illegal Aktivitelerde Bulunamaz.
    ]],
    weapons = {"weapon_csgo_knife_classic", "arccw_ur_awm"},
    command = "hitmans",
    max = 1,
    salary = 1500,
    admin = 0,
    vote = false,
    hasLicense = false,
    candemote = true,
    category = "Donator+",
    PlayerSpawn = function(ply)
       ply:SetArmor(75)
   end
})

--[[---------------------------------------------------------------------------
Define which team joining players spawn into and what team you change to if demoted
---------------------------------------------------------------------------]]
GAMEMODE.DefaultTeam = TEAM_CITIZEN
TEAM_HOBO    = TEAM_HOBO     or -1
--[[---------------------------------------------------------------------------
Define which teams belong to civil protection
Civil protection can set warrants, make people wanted and do some other police related things
---------------------------------------------------------------------------]]
AddDoorGroup("Devlet Yetkilileri", TEAM_MAYOR, TEAM_POH, TEAM_HAKIM, TEAM_BEKCI, TEAM_EMNIYETAMIR, TEAM_BASKANKORUMA, TEAM_POHAMIR, TEAM_POHDOKTOR, TEAM_POHKESKIN, TEAM_AGIRZIRH, TEAM_Polis, TEAM_POHKNISANCI, TEAM_POHAMIRI, TEAM_POHKESKIN, TEAM_Punisher)
DarkRP.createAgenda("Police agenda", TEAM_MAYOR, {TEAM_POH}, {TEAM_HAKIM}, {TEAM_BEKCI}, {TEAM_EMNIYETAMIR}, {TEAM_BASKANKORUMA}, {TEAM_POHAMIR}, {TEAM_POHDOKTOR}, {TEAM_POHKESKIN}, {TEAM_AGIRZIRH}, {TEAM_Polis}, {TEAM_Punisher})
GAMEMODE.CivilProtection = {
    [TEAM_MAYOR] = true,
    [TEAM_POH] = true,
    [TEAM_HAKIM] = true,
    [TEAM_BEKCI] = true,
    [TEAM_EMNIYETAMIR] = true, 
    [TEAM_BASKANKORUMA] = true,
    [TEAM_POHAMIR] = true,
    [TEAM_POHDOKTOR] = true,
    [TEAM_POHKESKIN] = true,
    [TEAM_CIA] = true,
    [TEAM_AGIRZIRH] = true,
    [TEAM_Polis] = true,
}
TEAM_HOBO    = TEAM_HOBO     or -1
DarkRP.createDemoteGroup("Devlet Görevlisi", {TEAM_POLICE, TEAM_MAYOR, TEAM_POH, TEAM_HAKIM, TEAM_BEKCI, TEAM_EMNIYETAMIR, TEAM_bKANKORUMA, TEAM_POHAMIR, TEAM_POHDOKTOR, TEAM_POHKESKIN, TEAM_AGIRZIRH, TEAM_Polis})
DarkRP.createDemoteGroup("Hırsız", {TEAM_HIRSIZ, TEAM_PROHIRSIZ})
--[[---------------------------------------------------------------------------
Jobs that are hitmen (enables the hitman menu)
---------------------------------------------------------------------------]]
DarkRP.addHitmanTeam(TEAM_HIT)
--addons/darkrpmodification/lua/darkrp_customthings/categories.lua:
--[[-----------------------------------------------------------------------
Categories
---------------------------------------------------------------------------
The categories of the default F4 menu.

Please read this page for more information:
https://darkrp.miraheze.org/wiki/DarkRP:Categories

In case that page can't be reached, here's an example with explanation:

DarkRP.createCategory{
    name = "Citizens", -- The name of the category.
    categorises = "jobs", -- What it categorises. MUST be one of "jobs", "entities", "shipments", "weapons", "vehicles", "ammo".
    startExpanded = true, -- Whether the category is expanded when you open the F4 menu.
    color = Color(0, 107, 0, 255), -- The color of the category header.
    canSee = function(ply) return true end, -- OPTIONAL: whether the player can see this category AND EVERYTHING IN IT.
    sortOrder = 100, -- OPTIONAL: With this you can decide where your category is. Low numbers to put it on top, high numbers to put it on the bottom. It's 100 by default.
}


Add new categories under the next line!
---------------------------------------------------------------------------]]
--[[
    Generated using: DarkRP | Category Generator
    https://csite.io/tools/gmod-darkrp-category
--]]
DarkRP.createCategory{
    name = "Esnaf",
    categorises = "jobs",
    startExpanded = true,
    color = Color(20, 150, 20, 255),
    canSee = function(ply) return true end,
    sortOrder = 145
}
DarkRP.createCategory{
    name = "Sivil",
    categorises = "jobs",
    startExpanded = true,
    color = Color(20, 150, 20, 255),
    canSee = function(ply) return true end,
    sortOrder = 140
}
DarkRP.createCategory{
    name = "Devlet Görevlisi",
    categorises = "jobs",
    startExpanded = true,
    color = Color(25, 25, 170, 255),
    canSee = function(ply) return true end,
    sortOrder = 141
}
DarkRP.createCategory{
    name = "Özel Meslek",
    categorises = "jobs",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return true end,
    sortOrder = 10
}
DarkRP.createCategory{
    name = "İllegal",
    categorises = "jobs",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return true end,
    sortOrder = 150
}
DarkRP.createCategory{
    name = "Donator",
    categorises = "jobs",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return true end,
    sortOrder = 155
}

DarkRP.createCategory{
    name = "Donator+",
    categorises = "jobs",
    startExpanded = true,
    color = Color(234, 255, 0),
    canSee = function(ply) return true end,
    sortOrder = 156
}

DarkRP.createCategory{
    name = "Özel Meslek",
    categorises = "jobs",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return true end,
    sortOrder = 157
}

DarkRP.createCategory{
    name = "Birlikler",
    categorises = "jobs",
    startExpanded = true,
    color = Color(75, 151, 4),
    canSee = function(ply) return true end,
    sortOrder = 155
}

DarkRP.createCategory{
    name = "Yetkili Görevde",
    categorises = "jobs",
    startExpanded = true,
    color = Color(34, 85, 85, 255),
    canSee = function(ply) return true end,
    sortOrder = 155
}

DarkRP.createCategory{
    name = "Kenevir",
    categorises = "entities",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    sortOrder = 25
}

DarkRP.createCategory{
    name = "Teknoloji Malzemeleri",
    categorises = "shipments",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return table.HasValue({TEAM_TEKNOLOJISATICISI}, ply:Team()) end,
    sortOrder = 25
}
DarkRP.createCategory{
    name = "Ağır Makineli",
    categorises = "shipments",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return table.HasValue({TEAM_GUNDEALER}, ply:Team()) end,
    sortOrder = 25
}
DarkRP.createCategory{
    name = "Keskin Nişancı",
    categorises = "shipments",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return table.HasValue({TEAM_GUNDEALER}, ply:Team()) end,
    sortOrder = 25
}

DarkRP.createCategory{
    name = "Tam Otomatik Silah",
    categorises = "shipments",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return table.HasValue({TEAM_GUN}, ply:Team()) end,
    sortOrder = 25
}
DarkRP.createCategory{
    name = "Hafif Makineli",
    categorises = "shipments",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return table.HasValue({TEAM_GUN}, ply:Team()) end,
    sortOrder = 25
}
DarkRP.createCategory{
    name = "Telsiz",
    categorises = "shipments",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return table.HasValue({TEAM_GUN}, ply:Team()) end,
    sortOrder = 25
}
DarkRP.createCategory{
    name = "Kart",
    categorises = "shipments",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return table.HasValue({TEAM_BANKACI}, ply:Team()) end,
    sortOrder = 25
}
DarkRP.createCategory{
    name = "Zırh",
    categorises = "shipments",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return table.HasValue({TEAM_GUN}, ply:Team()) end,
    sortOrder = 25
}
DarkRP.createCategory{
    name = "Yarı-Otomatik Silah",
    categorises = "shipments",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return table.HasValue({TEAM_GUN}, ply:Team()) end,
    sortOrder = 25
}

DarkRP.createCategory{
    name = "Ot Malzemeleri",
    categorises = "entities",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return table.HasValue({TEAM_OTURETI}, ply:Team()) end,
    sortOrder = 25
}
DarkRP.createCategory{
    name = "Printer",
    categorises = "entities",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    sortOrder = 25
}
DarkRP.createCategory{
    name = "Printerlar",
    categorises = "entities",
    startExpanded = false,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return true end,
    sortOrder = 25
}
DarkRP.createCategory{
    name = "Kenevir Malzemeleri",
    categorises = "entities",
    startExpanded = false,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return true end,
    sortOrder = 25
}
DarkRP.createCategory{
    name = "Tabanca",
    categorises = "shipments",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return table.HasValue({TEAM_GUN, TEAM_SILAH}, ply:Team()) end,
    sortOrder = 25
}
DarkRP.createCategory{
    name = "Tabancalar",
    categorises = "shipments",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return table.HasValue({TEAM_GUN}, ply:Team()) end,
    sortOrder = 25
}
DarkRP.createCategory{
    name = "Pompalı",
    categorises = "shipments",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return table.HasValue({TEAM_GUN}, ply:Team()) end,
    sortOrder = 25
}
DarkRP.createCategory{
    name = "Mermiler",
    categorises = "ammo",
    startExpanded = false,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return true end,
    sortOrder = 1
}
DarkRP.createCategory{
    name = "Kaçak Sigara",
    categorises = "shipments",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return table.HasValue({TEAM_TUTUNCU}, ply:Team()) end,
    sortOrder = 25
}
DarkRP.createCategory{
    name = "Vape",
    categorises = "shipments",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return table.HasValue({TEAM_TUTUNCU}, ply:Team()) end,
    sortOrder = 25
}
DarkRP.createCategory{
    name = "Çilingirci",
    categorises = "shipments",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return table.HasValue({TEAM_GUN}, ply:Team()) end,
    sortOrder = 25
}
DarkRP.createCategory{
    name = "Kelepçeler",
    categorises = "shipments",
    startExpanded = true,
    color = Color(255, 0, 0, 255),
    canSee = function(ply) return table.HasValue({TEAM_GUN}, ply:Team()) end,
    sortOrder = 25
}

DarkRP.createCategory{
    name = "Mermiler",
    categorises = "entities",
    startExpanded = true,
    color = Color(0, 107, 0, 255),
    canSee = function(ply) return true end,
    sortOrder = 1,
}
--addons/darkrpmodification/lua/darkrp_customthings/agendas.lua:
--[[---------------------------------------------------------------------------
DarkRP Agenda's
---------------------------------------------------------------------------
Agenda's can be set by the agenda manager and read by both the agenda manager and the other teams connected to it.


HOW TO MAKE AN AGENDA:
AddAgenda(Title of the agenda, Manager (who edits it), {Listeners (the ones who just see and follow the agenda)})
---------------------------------------------------------------------------]]
-- Example: AddAgenda("Gangster's agenda", TEAM_MOB, {TEAM_GANG})
-- Example: AddAgenda("Police agenda", TEAM_MAYOR, {TEAM_CHIEF, TEAM_POLICE})
--[[
    Generated using: DarkRP | Agenda Generator
    https://csite.io/tools/gmod-darkrp-agenda
--]]
--addons/glorifiedhandcuffs/lua/glorifiedhandcuffs/sh_glorifiedhandcuffs_config.lua:

GlorifiedHandcuffs.Config.BREAK_FREE_ENABLED = true -- Should the break free system be enabled?
GlorifiedHandcuffs.Config.BREAK_FREE_MIN_TIME = 0.05 -- What's the minimum time between clicks when breaking out?
GlorifiedHandcuffs.Config.BREAK_FREE_EXPIRY_TIME = 0.11 -- What's the maximum time between clicks when breaking out?
GlorifiedHandcuffs.Config.BREAK_FREE_TOTAL = 100 -- How many clicks are required to break out?
GlorifiedHandcuffs.Config.BREAK_FREE_WANTED = true -- Should we make the player wanted for breaking out?
GlorifiedHandcuffs.Config.BREAK_FREE_SOUND_ON_FAILURE = true -- Should we play a 3D sound when the player fails breaking out?
GlorifiedHandcuffs.Config.BREAK_FREE_SOUND_ON_FAILURE_PATH = "physics/metal/metal_box_impact_hard2.wav" -- See above.

GlorifiedHandcuffs.Config.JAILER_ARREST_TIME = 200 -- How long will a player be arrested at the jailer for?
GlorifiedHandcuffs.Config.JAILER_ARREST_REWARD = 100 -- How much will a cop get rewarded for an arrest? Only works if jail only mode is off.
GlorifiedHandcuffs.Config.TEAM_CHANGE_UPON_JAIL = false -- Should we change the player's job upon jailing?
GlorifiedHandcuffs.Config.TEAM_CHANGE_UPON_JAIL_TEAM = TEAM_CITIZEN -- Which job would you like to change to?
GlorifiedHandcuffs.Config.JAIL_ONLY_MODE = false -- Set to true if you would like the handcuffs to behave like an arrest baton, arresting upon handcuffing.

GlorifiedHandcuffs.Config.CAN_NORMAL_PLAYER_HANDCUFF_WITHOUT_SURRENDER = true -- Can a normal player handcuff without the person being handcuffed surrendering?
GlorifiedHandcuffs.Config.ONLY_ALLOW_HANDCUFF_IF_PLAYER_WANTED = false -- Should we only allow an officer to handcuff a player if they're wanted?
GlorifiedHandcuffs.Config.CAN_ANY_COP_RELEASE_HANDCUFFS = true -- Set this to true if you want any cop to release someone from handcuffs.
GlorifiedHandcuffs.Config.HANDCUFF_DISTANCE = 125 -- How far can a player handcuff from?
GlorifiedHandcuffs.Config.TIME_TO_CUFF = 0.4 -- How many seconds must the player remain within distance to handcuff?

GlorifiedHandcuffs.Config.DRAG_DISTANCE_LIMIT = true -- Is there a speed limit on dragging?
GlorifiedHandcuffs.Config.DRAG_DISTANCE_LIMIT_COUNT = 500 -- What's the speed limit on dragging?
GlorifiedHandcuffs.Config.DRAG_SPEED_COUNT = 100 -- What's the speed count on dragging?

GlorifiedHandcuffs.Config.BAIL_AMOUNT = 500000 -- How much does it cost to bail someone out?

GlorifiedHandcuffs.Config.BREAK_FREE_KEY = KEY_E -- The key to break free.
GlorifiedHandcuffs.Config.BREAK_FREE_KEY_NAME = "E" -- The string for the key that appears in the HUD.
GlorifiedHandcuffs.Config.TOGGLE_SURRENDER_KEY = KEY_T -- The key to surrender.
GlorifiedHandcuffs.Config.TOGGLE_SURRENDER_KEY_NAME = "T" -- The string for the key that appears in the HUD.

GlorifiedHandcuffs.Config.NIGHTSTICK_STUN_TIME = 5 -- How many seconds should the Nightstick freeze a player for?
GlorifiedHandcuffs.Config.NIGHTSTICK_STUN_PUSH_DISTANCE = 100 -- How far should the Nightstick push a stunned player?

GlorifiedHandcuffs.Config.SUPPORT_BLOGS = true -- Should bLogs be supported?

GlorifiedHandcuffs.Config.PLAYERMODEL_WHITELIST = { -- Which player models cannot be handcuffed?
    ["example_model_here.mdl"] = true
}
GlorifiedHandcuffs.Config.TEAM_WHITELIST = { -- Which teams cannot be handcuffed?
    [TEAM_CITIZEN] = false,
}

GlorifiedHandcuffs.Config.WEAPON_BLACKLIST_IS_WHITELIST = false -- Is the below blacklist a whitelist?
GlorifiedHandcuffs.Config.WEAPON_BLACKLIST = { -- Which weapons will not appear in the confiscate menu.
    ["keys"] = true,
    ["arrest_stick"] = true,
    ["aphone"] = true,
    ["inventory"] = true, 
    ["weapon_ch_atm_card"] = true,
    ["weapon_adv_keys"] = true,
    ["advanced_keys"] = true,
    ["door_ram"] = true,
    ["lockpick"] = true,
    ["med_kit"] = true,
    ["pocket"] = true,
    ["stunstick"] = true,
    ["unarrest_stick"] = true,
    ["weaponchecker"] = true,
    ["weapon_keypadchecker"] = true,
    ["weapon_bugbait"] = true,
    ["weapon_fists"] = true,
    ["gmod_camera"] = true,
    ["manhack_welder"] = true,
    ["weapon_medkit"] = true,
    ["gmod_tool"] = true,
    ["weapon_physgun"] = true,
    ["weapon_physcannon"] = true,
    ["glorifiedhandcuffs_restrained"] = true,
    ["glorifiedhandcuffs_handcuffs"] = true,
    ["glorifiedhandcuffs_nightstick"] = true,
    ["glorifiedbanking_card"] = true,
}
GlorifiedHandcuffs.Config.LEGAL_WEAPONS = { -- Weapons that are legal with a gun license.
    ["weapon_glock2"] = true,
    ["weapon_fiveseven2"] = true,
}
--addons/glorifiedhandcuffs/lua/glorifiedhandcuffs/localization/sh_glorifiedhandcuffs_french.lua:
return gluapack()()
--addons/glorifiedhandcuffs/lua/glorifiedhandcuffs/localization/sh_glorifiedhandcuffs_french.lua:

GlorifiedHandcuffs.i18n.RegisterPhrases( "fr", {
        cuffed = "Kelepçelisin",
    blindfolded = "Gözlerin bağlı",
    gagged = "Ağzın bağlı",
    hitToFree = "%s  tuşunu spamlayarak kelepçeden kurtulabilirsin",
    brokenFreeWanted = "Tutsaklıktan kaçtı",
    bailMenu = "Kefalet Menüsü",
    bailPlayer = "Oyuncunun Kefaletini Öde",
    bailNpc = "Kefalet NPC’si",
    jailerNpc = "Gardiyan NPC’si",
    noPlayers = "Tutuklu hiçbir oyuncu yok.",
    surrendering = "Teslim oluyorsun",
    putHandsDown = "Ellerini indirmek için %s  tuşuna bas",
    playersJailed = "%s’yı %s süreliğine hapise attın.",
    name = "İsim",
    job = "Meslek",
    wallet = "Cüzdan",
    confiscateAll = "Tüm Eşyalarına El Koy",
    confiscateIllegal = "İllegal Eşyalarına El Koy",
    takeAll = "Hepsini Al",
    takeIllegal = "İllegal Eşyasını Al",
    dragPlayer = "Oyuncuyu Sürükle",
    blindfoldPlayer = "Oyuncunun Gözlerini Bağla",
    removeBlindfold = "Göz Bağını Çıkar",
    gagPlayer = "Oyuncunun Ağzını Bağla",
    removeGag = "Oyuncunun Ağzını Çöz",
    confiscate = "El Koy",
    handcuffs = "Kelepçe",
    baton = "Cop",
    --[[
    cuffed = "You are cuffed",
    blindfolded = "You are blindfolded",
    gagged = "You are gagged",
    hitToFree = "Spam  %s  to break free",
    brokenFreeWanted = "Escaped from custody",
    bailMenu = "Bail Menu",
    bailPlayer = "Bail Player",
    bailNpc = "Bail NPC",
    jailerNpc = "Jailer NPC",
    noPlayers = "There are no arrested players.",
    surrendering = "You are surrendering",
    putHandsDown = "Press  %s  to put your hands down",
    playersJailed = "You jailed %s player(s) for %s.",
    name = "Name",
    job = "Job",
    wallet = "Wallet",
    confiscateAll = "Confiscate All",
    confiscateIllegal = "Confiscate Illegal",
    takeAll = "Take All",
    takeIllegal = "Take Illegal",
    dragPlayer = "Drag Player",
    blindfoldPlayer = "Blindfold Player",
    removeBlindfold = "Remove Blindfold",
    gagPlayer = "Gag Player",
    removeGag = "Remove Gag",
    confiscate = "Confiscate",
    handcuffs = "Handcuffs",
    baton = "Baton",
    --]]
} )
--addons/glorifiedhandcuffs/lua/glorifiedhandcuffs/localization/sh_glorifiedhandcuffs_polish.lua:
return gluapack()()
--addons/glorifiedhandcuffs/lua/glorifiedhandcuffs/modules/core/cl_glorifiedhandcuffs_breakfree.lua:
return gluapack()()
--addons/glorifiedhandcuffs/lua/glorifiedhandcuffs/modules/ui/bailmenu/cl_glorifiedhandcuffs_bailmenu_panel.lua:
return gluapack()()
--addons/glorifiedhandcuffs/lua/glorifiedhandcuffs/modules/ui/interactionmenu/cl_glorifiedhandcuffs_interactionmenu_weaponsbox.lua:

local PANEL = {}

function PANEL:Init()
    self.Theme = self:GetParent().Theme

    self.TitleBar = vgui.Create( "GlorifiedHandcuffs.InteractionMenu.WeaponsBox.TitleBar", self )

    self.Weapons = {}
end

function PANEL:AddWeapon( weapon )
    if table.Count( self.Weapons ) >= 8 then return end
    local newWeapon = table.insert( self.Weapons, vgui.Create( "GlorifiedHandcuffs.InteractionMenu.WeaponsBox.Weapon", self ) )
    self.Weapons[newWeapon]:SetWeaponInfo( weapon )
end

function PANEL:Paint( w, h )
    draw.RoundedBox( 6, 0, 0, w, h, self.Theme.Data.Colors.interactionMenuInfoBoxBackgroundColor )

    self.TitleBar:Dock( TOP )
    self.TitleBar:SetSize( w, h * 0.23 )

    for k, v in pairs( self.Weapons ) do
        local line = math.ceil( k / 4 )
        local linePos = k - ( ( line - 1 ) * 4 )
        v:SetPos( ( 7 * linePos ) + ( linePos - 1 ) * v:GetWide(), self.TitleBar:GetTall() + ( 5 * line ) + ( ( line - 1 ) * v:GetTall() ) )
        v:SetSize( w / 4.25, h * 0.35 )
    end
end

vgui.Register( "GlorifiedHandcuffs.InteractionMenu.WeaponsBox", PANEL, "Panel" )
--addons/aphone/lua/weapons/aphone/cl_init.lua:
include("shared.lua")

local last_open = 0
local vm_pos, vm_ang
local phone_bg2D = Material("materials/akulla/aphone/phone_bg.png", "smooth 1")
local clr = Color(40, 40, 40)

local backup_setting = aphone:GetParameters("Core", "2D", false)
aphone:ChangeParameters("Core", "2D", false)

local rt = GetRenderTarget("aphone_rt_" .. math.ceil(aphone.GUI.ScaledSize(400)) .. "_" .. math.ceil(aphone.GUI.ScaledSize(855)), aphone.GUI.ScaledSize(400), aphone.GUI.ScaledSize(855), RT_SIZE_NO_CHANGE, MATERIAL_RT_DEPTH_NONE, bit.bor(2, 256), 0, IMAGE_FORMAT_RGBA8888)
local mat_rt = CreateMaterial( "mat_aphone_rt", "UnlitGeneric", {
	["$basetexture"] = rt:GetName(),
} )

aphone:ChangeParameters("Core", "2D", backup_setting)

local ratio_3D2D_notinvert = ScrH() / 1080
local ratio_3D2D = 1 / ratio_3D2D_notinvert

aphone.cursor_visible = false

// Stencils
local stencil_poly_default = {
	[1] = {
		x = -1,
		y = 20,
	},
	[2] = {
		x = 15,
		y = 0,
	},
	[3] = {
		x = 385,
		y = 0,
	},
	[4] = {
		x = 405,
		y = 20,
	},
	[5] = {
		x = 405,
		y = 840,
	},
	[6] = {
		x = 385,
		y = 855,
	},
	[7] = {
		x = 15,
		y = 855,
	},
	[8] = {
		x = -1,
		y = 840,
	},
}
local stencil_poly = table.Copy(stencil_poly_default)

local function calculate_ratios()
	local ratio_h = ScrH() / 1080
	local ratio_w = ScrW() / 1920
	local new_ratio = ratio_h < ratio_w and ratio_h or ratio_w

	ratio = new_ratio
	ratio_3D2D = 1 / ratio
	ratio_3D2D_notinvert = ratio

	--[[
	I tried to avoid recreating a rendertarget
	However, even if I avoid recreating by sizing perfectly panels, if the new resolution is too much bigger, then the phone panel would broke
	A solution would be to scale with matrix at the end, but it makes everything looks like a PS1 UI
	]]--

	local backup_setting = aphone:GetParameters("Core", "2D", false)
	aphone:ChangeParameters("Core", "2D", false)

	rt = GetRenderTarget("aphone_rt_" .. math.ceil(aphone.GUI.ScaledSize(400)) .. "_" .. math.ceil(aphone.GUI.ScaledSize(855)), aphone.GUI.ScaledSize(400), aphone.GUI.ScaledSize(855), RT_SIZE_NO_CHANGE, MATERIAL_RT_DEPTH_NONE, bit.bor(2, 256), 0, IMAGE_FORMAT_RGBA8888)

	aphone:ChangeParameters("Core", "2D", backup_setting)
	mat_rt:SetTexture("$basetexture", rt)

	if IsValid(aphone.MainDerma) then
		-- Reset the panel
		aphone.MainDerma:Remove()
	end

	for k, v in pairs(stencil_poly_default) do
		for i, j in pairs(v) do
			stencil_poly[k][i] = j * ratio_3D2D_notinvert
		end
	end
end
calculate_ratios()

hook.Add("OnScreenSizeChanged", "APhone_Refresh3D2DRatio", calculate_ratios)

function aphone.blur_rt(x, y, pass)
	if rt then
		render.BlurRenderTarget( rt, x, y, pass)
	end
end

local hdr_vec = Vector(0.67, 0.67, 0.67)

function SWEP:PostDrawViewModel(vm)
	self.ViewModelFOV = LocalPlayer():GetFOV()

	-- FIXME: This should be removed when ViewModelFOV() is binded
	local nFOV = self.ViewModelFOV
	if (not isnumber(nFOV)) then nFOV = 62 end

	if !aphone.MainDerma or !IsValid(aphone.MainDerma) then
		aphone.MainDerma = vgui.Create("aphone_Main")
		aphone.MainDerma:SetMouseInputEnabled(false)

		/* 
		Why 100 ? Because if we set it to a little value like 0 or 1, if he drag his mouse to the left of the screen and he is playing windowed then
		my code won't detect him going outside, so the mouse will stay and can make your mouse move out of the game
		Don't worry, I will fix this pos later in my rendertarget with matrix
		*/

		aphone.MainDerma:SetPos(aphone.GUI.ScaledSize(100, 100))

		// Notif panel, made it global so we can notify things
		aphone.NotifPanel = vgui.Create("DPanel", aphone.MainDerma)
		aphone.NotifPanel:SetSize(aphone.MainDerma:GetSize())
		aphone.NotifPanel:SetPaintedManually(true)
		aphone.NotifPanel:SetPaintBackground(false)
		aphone.NotifPanel:SetMouseInputEnabled(false)
		aphone.NotifPanel:SetZPos(4)
		
		if !aphone:Is2D() then
			aphone.NotifPanel:SetCursor("blank")
		else
			local aphone_main2D = vgui.Create("EditablePanel")

			aphone_main2D:SetSize(aphone.GUI.ScaledSize(215 * 2, 490 * 2))
			aphone_main2D:SetPos(ScrW() - aphone_main2D:GetWide(), ScrH() - aphone_main2D:GetTall())

			aphone.MainDerma:SetParent(aphone_main2D)
			aphone.MainDerma:SetPos(aphone.GUI.ScaledSize(15, 63))

			function aphone_main2D:PaintOver(w, h)
				surface.SetMaterial(phone_bg2D)
				surface.SetDrawColor(color_white)
				surface.DrawTexturedRect(0, 0, w, h)
			end

			function aphone_main2D:Think()
				self:MoveToFront()
				if !IsValid(aphone.MainDerma) then
					self:Remove()
					aphone.MainDerma = nil
				end

				local hovered_pnl = vgui.GetHoveredPanel()
				if input.IsMouseDown( 107 ) and last_open < CurTime() and !self:IsChildHovered() and !self:IsHovered() and IsValid(hovered_pnl) then
					gui.EnableScreenClicker(false)
					aphone.cursor_visible = false
				end
			end
		end
	end

	local tAttachment = vm:GetAttachment(1)

	vm_pos = tAttachment.Pos
	vm_ang = tAttachment.Ang

	vm_pos = vm_pos + vm_ang:Up() * 0.025
	vm_ang:RotateAroundAxis( vm_ang:Up(), -90)

	// Global, for camera app
	aphone.VM_Pos = vm_pos

	local ext_attachment = self:GetAttachment(1)

	aphone.WM_Pos = ext_attachment.Pos
	aphone.WM_Ang = ext_attachment.Ang

	if !aphone:Is2D() then
		// Ratio
		local c = vm:GetCycle()
		if c == 1 then
			aphone.horizontal_ratio = tonumber(aphone.Horizontal)
		else
			aphone.horizontal_ratio = (!aphone.Horizontal and 1 - c or c)
		end

		local pre_hdr = render.GetToneMappingScaleLinear()

		if aphone:GetParameters("Core", "AutoLight", false) and render.GetHDREnabled() then
			local inverted = math.Clamp(5 / pre_hdr.x - 2.6, 0.1, 0.67)
			render.SetToneMappingScaleLinear(Vector(inverted, inverted, inverted))
		else
			render.SetToneMappingScaleLinear(hdr_vec)
		end

		cam.Start3D2D(vm_pos, vm_ang, 0.01 * ratio_3D2D)
			render.SetStencilWriteMask( 0xFF )
			render.SetStencilTestMask( 0xFF )
			render.SetStencilReferenceValue( 1 )
			render.SetStencilCompareFunction( STENCIL_ALWAYS )
			render.SetStencilPassOperation( STENCIL_REPLACE )
			render.SetStencilFailOperation( STENCIL_KEEP )
			render.SetStencilZFailOperation( STENCIL_KEEP )
			render.ClearStencil()

			// Enable stencils
			render.SetStencilEnable( true )
				surface.SetDrawColor(color_white)
				surface.DrawPoly(stencil_poly)
			render.SetStencilCompareFunction( STENCIL_EQUAL )
				surface.SetMaterial(mat_rt)
				surface.DrawTexturedRect(-2, 0, aphone.GUI.ScaledSize(405, 855))
			render.SetStencilEnable( false )
		cam.End3D2D()
		render.SetToneMappingScaleLinear(pre_hdr)
	end

	self:DrawLight(LocalPlayer(), ext_attachment)
end

// Without DrawHUD ( drawing in viewmodel), we would get big issues where the panel show himself even outside the bounds, like this : https://prnt.sc/121oske
function SWEP:DrawHUD()
	if vm_pos and !aphone:Is2D() and IsValid(aphone.MainDerma) then
		render.PushRenderTarget( rt )
			render.Clear(255, 255, 255, 255)
			// https://www.gitmemory.com/issue/Facepunch/garrysmod-issues/4662/691134213
			// https://wiki.facepunch.com/gmod/render.OverrideAlphaWriteEnable
			render.SetWriteDepthToDestAlpha(false)
			render.ClearDepth()
			render.OverrideAlphaWriteEnable(true, true)
				cam.Start2D()
					local size = aphone.MainDerma:GetPos()

					local tr = Matrix()
					tr:Translate(Vector(-size, -size, 0))
					if aphone.HorizontalApp then
						tr:Translate(Vector(mat_rt:Width() + size * 2, 0, 0))
						tr:Rotate(Angle(0, 90, 0))
					end
					cam.PushModelMatrix(tr)

					aphone.MainDerma:MoveToFront()
					aphone.MainDerma:PaintManual()

					if aphone.cursor_visible then
						local hovered_pnl = vgui.GetHoveredPanel()
						if last_open < CurTime() and !aphone.MainDerma:IsHovered() and !aphone.MainDerma:IsChildHovered() and IsValid(hovered_pnl) then
							// Try to get the mouse pos outside the phone
							local tbl_pos = vm_pos:ToScreen()
							tbl_pos.x = tbl_pos.x + gui.MouseX() / 1.5
							tbl_pos.y = tbl_pos.y + gui.MouseY() / 1.5
							input.SetCursorPos(tbl_pos.x, tbl_pos.y)
							aphone.cursor_visible = false

							gui.EnableScreenClicker(false)
							aphone.MainDerma:SetMouseInputEnabled(false)
						end

						local mousex, mousey = input.GetCursorPos()

						draw.SimpleText("d", "SVG_20_3D", lastframe_x or mousex, lastframe_y or mousey, clr, 1, 1)
						draw.SimpleText("d", "SVG_16_3D", lastframe_x or mousex, lastframe_y or mousey, color_white, 1, 1)
					end

					cam.PopModelMatrix()
				cam.End2D()
			render.SetWriteDepthToDestAlpha(true)
		render.PopRenderTarget()
	end
end

function SWEP:PrimaryAttack()
	if self:GetOwner() != LocalPlayer() then return end

	gui.EnableScreenClicker(true)

	-- I guess he won't travel +100px with his mouse in 0.03
	-- Using this to prevent the mouse reset instantly, because the setmousepos take some times/frames
	last_open = CurTime() + 0.1

	if !aphone:Is2D() then
		aphone.cursor_visible = true

		if aphone.HorizontalApp then
			input.SetCursorPos(aphone.GUI.ScaledSize(427.5, 200))
		else
			input.SetCursorPos(aphone.GUI.ScaledSize(200, 427.5))
		end
	end

	if IsValid(aphone.MainDerma) then
		aphone.MainDerma:SetMouseInputEnabled(true)
	end
end

-- I don't check if predicted, because I got issue with it on some servers, also because we don't need, even if the function 
-- is called multiples times. I check if the panel is valid
function SWEP:Holster()
	if self:GetOwner() != LocalPlayer() then return end

	if IsValid(aphone.Running_App) then
		aphone.Running_App:OnClose()
	end

	if IsValid(aphone.MainDerma) then
		aphone.MainDerma:Remove()

		if aphone.Horizontal then
			aphone.RequestAnim(1)
		end

		if !aphone:Is2D() then
			aphone.HorizontalApp = false

			// timer.simple 0 so weapon selectors, when you select a weapon, doesn't trigger mouse
			timer.Simple(0.5, function()
				if aphone.cursor_visible and (!IsValid(vgui.GetHoveredPanel()) or vgui.GetHoveredPanel():GetName() == "GModBase") then
					gui.EnableScreenClicker(false)
				end
			end)
		end
	end

	if ( IsValid( self.lamp ) ) then
		self.lamp:Remove()
		self.lamp = nil
	end
end

function SWEP:OnRemove()
	self:Holster()
end

function SWEP:DrawLight(owner, tAttachment)
	if owner != LocalPlayer() then return end
	local param = aphone:GetParameters("Core", "Flashlight", false)
	local a = tAttachment.Ang + Angle(0, 90, 0)
	local p = tAttachment.Pos

	p = p + a:Up()*-0.9 + a:Right()*-1 + a:Forward()*-0.6

	if !self.lamp then
		if !param then return end
		local lamp = ProjectedTexture() -- Create a projected texture
		self.lamp = lamp -- Assign it to the entity table so it may be accessed later

		-- Set it all up
		lamp:SetTexture( "effects/flashlight001" )
		lamp:SetFarZ( 400 ) -- How far the light should shine

		lamp:SetPos( p ) -- Initial position and angles
		lamp:SetAngles( a )
		lamp:Update()
	else
		if ( IsValid( self.lamp ) ) then
			if param then
				self.lamp:SetPos( p )
				self.lamp:SetAngles( LocalPlayer():EyeAngles() )
				self.lamp:SetBrightness(4)
				self.lamp:SetEnableShadows(false)
				self.lamp:SetFarZ( 300 ) 
				self.lamp:Update()
				self.lamp:SetTexture( "effects/flashlight_border" )
			else
				self.lamp:Remove()
				self.lamp = nil
			end
		end
	end
end

function SWEP:DrawWorldModel()
	local o = self:GetOwner()

	if IsValid(o) then
		aphone.RefreshWeapon(o, self)
		self:DrawLight(o, self:GetAttachment(1))
	end

	self:DrawModel()
end

function SWEP:Reload()
	self.lastanimchange = self.lastanimchange or 0

	if self.lastanimchange < CurTime() then
		aphone.RequestAnim(aphone.Horizontal and 1 or 2)
		self.lastanimchange = CurTime() + 1
	end
end

function SWEP:SecondaryAttack() end
--addons/[binbon]arccw_modify/lua/weapons/arccw_base/sh_anim.lua:
SWEP.Cam_Offset_Ang = nil --Angle(0, 0, 0)

function SWEP:SelectAnimation(anim)
    if self:GetNWState() == ArcCW.STATE_SIGHTS and self.Animations[anim .. "_iron"] then
        anim = anim .. "_iron"
    end

    if self:GetNWState() == ArcCW.STATE_SIGHTS and self.Animations[anim .. "_sights"] then
        anim = anim .. "_sights"
    end

    if self:GetNWState() == ArcCW.STATE_SIGHTS and self.Animations[anim .. "_sight"] then
        anim = anim .. "_sight"
    end

    if self:GetNWState() == ArcCW.STATE_SPRINT and self.Animations[anim .. "_sprint"] and !self:CanShootWhileSprint() then
        anim = anim .. "_sprint"
    end

    if self:InBipod() and self.Animations[anim .. "_bipod"] then
        anim = anim .. "_bipod"
    end

    if self:GetState() == ArcCW.STATE_CUSTOMIZE and self.Animations[anim .. "_inspect"] and ((CLIENT and !ArcCW.ConVars["noinspect"]:GetBool()) or (SERVER and self:GetOwner():GetInfoNum("arccw_noinspect", 0))) then
        anim = anim .. "_inspect"
    end

    if (self:Clip1() == 0 or (self:HasBottomlessClip() and self:Ammo1() == 0)) and self.Animations[anim .. "_empty"] then
        anim = anim .. "_empty"
    end

    if self:GetMalfunctionJam() and self.Animations[anim .. "_jammed"] then
        anim = anim .. "_jammed"
    end

    if self:GetBuff_Override("Override_TriggerDelay", self.TriggerDelay) and self:IsTriggerHeld() and self.Animations[anim .. "_trigger"] then
        anim = anim .. "_trigger"
    end

    if !self.Animations[anim] then return end

    return anim
end

SWEP.LastAnimStartTime = 0
SWEP.LastAnimFinishTime = 0

function SWEP:PlayAnimationEZ(key, mult, priority)
    return self:PlayAnimation(key, mult, true, 0, false, false, priority, false)
end

function SWEP:PlayAnimation(key, mult, pred, startfrom, tt, skipholster, priority, absolute)
    mult = mult or 1
    pred = pred or false
    startfrom = startfrom or 0
    tt = tt or false
    --skipholster = skipholster or false Unused
    priority = priority or false
    absolute = absolute or false
    if !key then return end

    local ct = CurTime()

    if self:GetPriorityAnim() and !priority then return end

    if game.SinglePlayer() and SERVER and pred then
        net.Start("arccw_sp_anim")
        net.WriteString(key)
        net.WriteFloat(mult)
        net.WriteFloat(startfrom)
        net.WriteBool(tt)
        --net.WriteBool(skipholster) Unused
        net.WriteBool(priority)
        net.Send(self:GetOwner())
    end

    local anim = self.Animations[key]
    if !anim then return end
    local tranim = self:GetBuff_Hook("Hook_TranslateAnimation", key)
    if self.Animations[tranim] then
        key = tranim
        anim = self.Animations[tranim]
    --[[elseif self.Animations[key] then -- Can't do due to backwards compatibility... unless you have a better idea?
        anim = self.Animations[key]
    else
        return]]
    end

    if anim.ViewPunchTable and CLIENT then
        for k, v in pairs(anim.ViewPunchTable) do

            if !v.t then continue end

            local st = (v.t * mult) - startfrom

            if isnumber(v.t) and st >= 0 and self:GetOwner():IsPlayer() and (game.SinglePlayer() or IsFirstTimePredicted()) then
                self:SetTimer(st, function() self:OurViewPunch(v.p or Vector(0, 0, 0)) end, id)
            end
        end
    end

    if isnumber(anim.ShellEjectAt) then
        self:SetTimer(anim.ShellEjectAt * mult, function()
            local num = 1
            if self.RevolverReload then
                num = self.Primary.ClipSize - self:Clip1()
            end
            for i = 1,num do
                self:DoShellEject()
            end
        end)
    end

    if !self:GetOwner() then return end
    if !self:GetOwner().GetViewModel then return end
    local vm = self:GetOwner():GetViewModel()

    if !vm then return end
    if !IsValid(vm) then return end

    local seq = anim.Source
    if anim.RareSource and util.SharedRandom("raresource", 0, 1, CurTime()) < (1 / (anim.RareSourceChance or 100)) then
        seq = anim.RareSource
    end
    seq = self:GetBuff_Hook("Hook_TranslateSequence", seq)

    if istable(seq) then
        seq["BaseClass"] = nil
        seq = seq[math.Round(util.SharedRandom("randomseq" .. CurTime(), 1, #seq))]
    end

    if isstring(seq) then
        seq = vm:LookupSequence(seq)
    end

    local time = absolute and 1 or self:GetAnimKeyTime(key)
    --if time == 0 then return end

    local ttime = (time * mult) - startfrom
    if startfrom > (time * mult) then return end

    if tt then
        self:SetNextPrimaryFire(ct + ((anim.MinProgress or time) * mult) - startfrom)
    end

    if anim.LHIK then
        self.LHIKStartTime = ct
        self.LHIKEndTime = ct + ttime

        if anim.LHIKTimeline then
            self.LHIKTimeline = {}

            for i, k in pairs(anim.LHIKTimeline) do
                table.Add(self.LHIKTimeline, {t = (k.t or 0) * mult, lhik = k.lhik or 1})
            end
        else
            self.LHIKTimeline = {
                {t = -math.huge, lhik = 1},
                {t = ((anim.LHIKIn or 0.1) - (anim.LHIKEaseIn or anim.LHIKIn or 0.1)) * mult, lhik = 1},
                {t = (anim.LHIKIn or 0.1) * mult, lhik = 0},
                {t = ttime - ((anim.LHIKOut or 0.1) * mult), lhik = 0},
                {t = ttime - (((anim.LHIKOut or 0.1) - (anim.LHIKEaseOut or anim.LHIKOut or 0.1)) * mult), lhik = 1},
                {t = math.huge, lhik = 1}
            }

            if anim.LHIKIn == 0 then
                self.LHIKTimeline[1].lhik = -math.huge
                self.LHIKTimeline[2].lhik = -math.huge
            end

            if anim.LHIKOut == 0 then
                self.LHIKTimeline[#self.LHIKTimeline - 1].lhik = math.huge
                self.LHIKTimeline[#self.LHIKTimeline].lhik = math.huge
            end
        end
    else
        self.LHIKTimeline = nil
    end

    if anim.LastClip1OutTime then
        self.LastClipOutTime = ct + ((anim.LastClip1OutTime * mult) - startfrom)
    end

    if anim.TPAnim then
        local aseq = self:GetOwner():SelectWeightedSequence(anim.TPAnim)
        if aseq then
            self:GetOwner():AddVCDSequenceToGestureSlot( GESTURE_SLOT_ATTACK_AND_RELOAD, aseq, anim.TPAnimStartTime or 0, true )
            if !game.SinglePlayer() and SERVER then
                net.Start("arccw_networktpanim")
                    net.WriteEntity(self:GetOwner())
                    net.WriteUInt(aseq, 16)
                    net.WriteFloat(anim.TPAnimStartTime or 0)
                net.SendPVS(self:GetOwner():GetPos())
            end
        end
    end

    if !(game.SinglePlayer() and CLIENT) and (game.SinglePlayer() or IsFirstTimePredicted() or self.ReadySoundTableHack) then
        self:PlaySoundTable(anim.SoundTable or {}, 1 / mult, startfrom, key)
        self.ReadySoundTableHack = nil
    end

    if seq then
        vm:SendViewModelMatchingSequence(seq)
        local dur = vm:SequenceDuration()
        vm:SetPlaybackRate(math.Clamp(dur / (ttime + startfrom), -4, 12))
        self.LastAnimStartTime = ct
        self.LastAnimFinishTime = ct + dur
        self.LastAnimKey = key
    end

    -- Grabs the current angle of the cam attachment bone and use it as the common offset for all cambone changes.
    -- Problem: If this animation interrupted a previous animation with cambone movement,
    -- it will start with an incorrect offset and snap at the end.
    -- Therefore this now only ever sets it once.
    local att = self:GetBuff_Override("Override_CamAttachment", self.CamAttachment)
    if att and vm:GetAttachment(att) and (anim.ForceCamReset or self.Cam_Offset_Ang == nil) then
        local ang = vm:GetAttachment(att).Ang
        ang = vm:WorldToLocalAngles(ang)
        self.Cam_Offset_Ang = Angle(ang)
    end

    self:SetNextIdle(CurTime() + ttime)

    return true
end

function SWEP:PlayIdleAnimation(pred)
    local ianim = self:SelectAnimation("idle")
    if self:GetGrenadePrimed() then
        ianim = self:GetGrenadeAlt() and self:SelectAnimation("pre_throw_hold_alt") or self:SelectAnimation("pre_throw_hold")
    end

    -- (key, mult, pred, startfrom, tt, skipholster, ignorereload)
    if self:GetBuff_Override("UBGL_BaseAnims") and self:GetInUBGL()
            and self.Animations.idle_ubgl_empty and self:Clip2() <= 0 then
        ianim = "idle_ubgl_empty"
    elseif self:GetBuff_Override("UBGL_BaseAnims") and self:GetInUBGL() and self.Animations.idle_ubgl then
        ianim = "idle_ubgl"
    end

    if self.LastAnimKey ~= ianim then
        ianim = self:GetBuff_Hook("Hook_IdleReset", ianim) or ianim
    end

    self:PlayAnimation(ianim, 1, pred, nil, nil, nil, true)
end

function SWEP:GetAnimKeyTime(key, min)
    if !self:GetOwner() then return 1 end

    local anim = self.Animations[key]

    if !anim then return 1 end

    if self:GetOwner():IsNPC() then return anim.Time or 1 end

    local vm = self:GetOwner():GetViewModel()

    if !vm or !IsValid(vm) then return 1 end

    local t = anim.Time
    if !t then
        local tseq = anim.Source

        if istable(tseq) then
            tseq["BaseClass"] = nil -- god I hate Lua inheritance
            tseq = tseq[1]
        end

        if !tseq then return 1 end
        tseq = vm:LookupSequence(tseq)

        -- to hell with it, just spits wrong on draw sometimes
        t = vm:SequenceDuration(tseq) or 1
    end

    if min and anim.MinProgress then
        t = anim.MinProgress
    end

    if anim.Mult then
        t = t * anim.Mult
    end

    return t
end

if CLIENT then
    net.Receive("arccw_networktpanim", function()
        local ent = net.ReadEntity()
        local aseq = net.ReadUInt(16)
        local starttime = net.ReadFloat()
        if IsValid(ent) and ent ~= LocalPlayer() and ent:IsPlayer() then
            ent:AddVCDSequenceToGestureSlot( GESTURE_SLOT_ATTACK_AND_RELOAD, aseq, starttime, true )
        end
    end)
end

function SWEP:QueueAnimation() end
function SWEP:NextAnimation() end

--addons/[binbon]arccw_modify/lua/weapons/arccw_base/sh_attach.lua:
-- Used to prevent stack overflow. Set false here so luarefresh clears it
ArcCW.BuffStack = false

ArcCW.ConVar_BuffMults = {
    ["Mult_Damage"] = "arccw_mult_damage",
    ["Mult_DamageMin"] = "arccw_mult_damage",
    ["Mult_DamageNPC"] = "arccw_mult_npcdamage",
    ["Mult_HipDispersion"] = "arccw_mult_hipfire",
    ["Mult_ReloadTime"] = "arccw_mult_reloadtime",
    ["Mult_SightTime"] = "arccw_mult_sighttime",
    ["Mult_RPM"] = "arccw_mult_rpm",
    ["Mult_CycleTime"] = "arccw_mult_rpm",
    ["Mult_Range"] = "arccw_mult_range",
    ["Mult_Recoil"] = "arccw_mult_recoil",
    ["Mult_MoveDispersion"] = "arccw_mult_movedisp",
    ["Mult_AccuracyMOA"] = "arccw_mult_accuracy",
    ["Mult_Penetration"] = "arccw_mult_penetration",
    ["Mult_Sway"] = "arccw_mult_sway",
    ["Mult_MeleeDamage"] = "arccw_mult_meleedamage",
    ["Mult_MeleeTime"] = "arccw_mult_meleetime",
}

ArcCW.ConVar_BuffAdds = {
    ["Add_Sway"] = "arccw_add_sway",
}

ArcCW.ConVar_BuffOverrides = {
    ["Override_ShootWhileSprint"] = "arccw_mult_shootwhilesprinting"
}

SWEP.TickCache_Overrides = {}
SWEP.TickCache_Adds = {}
SWEP.TickCache_Mults = {}
SWEP.TickCache_Hooks = {}
SWEP.TickCache_IsShotgun = nil

SWEP.TickCache_Tick_Overrides = {}
SWEP.TickCache_Tick_Adds = {}
SWEP.TickCache_Tick_Mults = {}

SWEP.AttCache_Hooks = {}

-- debug: enable/disable modified caching
local MODIFIED_CACHE = true
-- print if a variable presumed to never change actually changes (this also happens right after attaching/detaching)
-- only works if MODIFIED_CACHE is false
local VERIFY_MODIFIED_CACHE = false

-- Conditions not listed are are presumed to never change; this is done for optimization purposes
SWEP.ModifiedCache = {}

function SWEP:RecalcAllBuffs()
    self.TickCache_Overrides = {}
    self.TickCache_Adds = {}
    self.TickCache_Mults = {}
    self.TickCache_Hooks = {}
    self.TickCache_IsShotgun = nil

    self.TickCache_Tick_Overrides = {}
    self.TickCache_Tick_Adds = {}
    self.TickCache_Tick_Mults = {}

    self.ReferencePosCache = {}

    self.AttCache_Hooks = {}

    self.NextMalfunction = nil

    -- for the customization page
    if CLIENT then
        self.Infos_Stats = nil
        self.Infos_Ballistics = nil
        self.Infos_Breakpoints = nil
    end

    -- this function is not always called right before AdjustAtts
    --self.ModifiedCache = {}
end

function SWEP:GetIsShotgun()
    if self.TickCache_IsShotgun == nil then
        local shotgun = self:GetBuff_Override("Override_IsShotgun")
        if shotgun != nil then
            self.TickCache_IsShotgun = shotgun
        end

        local num = self.Num
        if self.TickCache_IsShotgun == nil and num > 1 then self.TickCache_IsShotgun = true end
    end

    return self.TickCache_IsShotgun
end

function SWEP:GetIsManualAction()
    local manual = self:GetBuff_Override("Override_ManualAction")

    if manual != false then
        manual = manual or self.ManualAction
    end

    -- A manual action gun CAN have automatic firemode, this is intended behavior!!!
    -- It's used for slamfiring
    --[[]
    local mode = self:GetCurrentFiremode().Mode

    if mode != 0 and mode != 1 then
        return false
    end
    ]]

    return manual
end

-- ONE FUNCTION TO RULE THEM ALL
function SWEP:GetBuff(buff, defaultnil, defaultvar)
    local stable = self:GetTable()

    local result = stable[buff] or defaultvar
    if !result and defaultnil then
        result = nil
    elseif !result then
        result = 1
    end

    result = self:GetBuff_Override("Override_" .. buff, result)

    if isnumber(result) then
        result = self:GetBuff_Add("Add_" .. buff) + result
        result = self:GetBuff_Mult("Mult_" .. buff) * result
    end

    return result
end

function SWEP:GetBuff_Stat(buff, slot)
    local slottbl = self.Attachments[slot]
    if !slottbl then return end
    local atttbl = ArcCW.AttachmentTable[slottbl.Installed]
    if !atttbl then return end
    local num = slottbl.ToggleNum or 1

    if atttbl.ToggleStats and atttbl.ToggleStats[num] and (atttbl.ToggleStats[num][buff] != nil) then
        return atttbl.ToggleStats[num][buff]
    else
        return atttbl[buff]
    end
end

function SWEP:GetBuff_Hook(buff, data, defaultnil)
    -- call through hook function, args = data. return nil to do nothing. return false to prevent thing from happening.

    if !self.AttCache_Hooks[buff] then
        self.AttCache_Hooks[buff] = {}

        for i, k in pairs(self.Attachments) do
            if !k.Installed then continue end

            local atttbl = ArcCW.AttachmentTable[k.Installed]

            if !atttbl then continue end

            if isfunction(atttbl[buff]) then
                table.insert(self.AttCache_Hooks[buff], {atttbl[buff], atttbl[buff .. "_Priority"] or 0})
            elseif atttbl.ToggleStats and k.ToggleNum and atttbl.ToggleStats[k.ToggleNum] and isfunction(atttbl.ToggleStats[k.ToggleNum][buff]) then
                table.insert(self.AttCache_Hooks[buff], {atttbl.ToggleStats[k.ToggleNum][buff], atttbl.ToggleStats[k.ToggleNum][buff .. "_Priority"] or 0})
            end
        end

        local cfm = self:GetCurrentFiremode()

        if cfm and isfunction(cfm[buff]) then
            table.insert(self.AttCache_Hooks[buff], {cfm[buff], cfm[buff .. "_Priority"] or 0})
        end

        for i, e in pairs(self:GetActiveElements()) do
            local ele = self.AttachmentElements[e]

            if ele and ele[buff] then
                table.insert(self.AttCache_Hooks[buff], {ele[buff], ele[buff .. "_Priority"] or 0})
            end
        end

        if isfunction(self:GetTable()[buff]) then
            table.insert(self.AttCache_Hooks[buff], {self:GetTable()[buff], self:GetTable()[buff .. "_Priority"] or 0})
        end

        table.sort(self.AttCache_Hooks[buff], function(a, b) return a[2] >= b[2] end)shouldsort = true
    end

    local retvalue = nil
    for i, k in ipairs(self.AttCache_Hooks[buff]) do
        local ret = k[1](self, data)
        if ret == false then
            return
        elseif ret != nil then
            retvalue = ret
            break
        end
    end

    if retvalue then data = retvalue
    elseif defaultnil then data = nil end

    data = hook.Call(buff, nil, self, data) or data

    return data
end

function SWEP:GetBuff_Override(buff, default)

    local level = 0
    local current = nil
    local winningslot = nil

    if MODIFIED_CACHE and !self.ModifiedCache[buff] then
        -- ArcCW.ConVar_BuffOverrides[buff] isn't actually implemented??

        if !ArcCW.BuffStack then
            ArcCW.BuffStack = true
            local out = (self:GetBuff_Hook("O_Hook_" .. buff, {buff = buff}) or {})
            current = out.current or current
            winningslot = out.winningslot or winningslot
            ArcCW.BuffStack = false
        end

        return current or default, winningslot
    end

    if self.TickCache_Overrides[buff] then
        current = self.TickCache_Overrides[buff][1]
        winningslot = self.TickCache_Overrides[buff][2]

        local data = {
            buff = buff,
            current = current,
            winningslot = winningslot
        }

        if !ArcCW.BuffStack then

            ArcCW.BuffStack = true

            local out = (self:GetBuff_Hook("O_Hook_" .. buff, data) or {})

            current = out.current or current
            winningslot = out.winningslot or winningslot

            ArcCW.BuffStack = false

        end

        if current == nil then
            return default
        else
            return current, winningslot
        end
    end

    for i, k in pairs(self.Attachments) do
        if !k.Installed then continue end

        local atttbl = ArcCW.AttachmentTable[k.Installed]

        if !atttbl then continue end

        if atttbl[buff] != nil then
            local pri = atttbl[buff .. "_Priority"] or 1
            if level == 0 or (pri > level) then
                current = atttbl[buff]
                level = pri
                winningslot = i
            end
        end

        if atttbl.ToggleStats and k.ToggleNum and atttbl.ToggleStats[k.ToggleNum] and atttbl.ToggleStats[k.ToggleNum][buff] then
            local pri = atttbl.ToggleStats[k.ToggleNum][buff .. "_Priority"] or 1
            if level == 0 or (pri > level) then
                current = atttbl.ToggleStats[k.ToggleNum][buff]
                level = pri
                winningslot = i
            end
        end
    end

    if !ArcCW.BuffStack then

        ArcCW.BuffStack = true

        local cfm = self:GetCurrentFiremode()

        if cfm and cfm[buff] != nil then
            local pri = cfm[buff .. "_Priority"] or 1
            if level == 0 or (pri > level) then
                current = cfm[buff]
                level = pri
            end
        end

        ArcCW.BuffStack = false

    end

    if !ArcCW.BuffStack then

        ArcCW.BuffStack = true

        for i, e in pairs(self:GetActiveElements()) do
            local ele = self.AttachmentElements[e]

            if ele and ele[buff] != nil then
                local pri = ele[buff .. "_Priority"] or 1
                if level == 0 or (pri > level) then
                    current = ele[buff]
                    level = pri
                    winningslot = i
                end
            end
        end

        ArcCW.BuffStack = false

    end

    if self:GetTable()[buff] != nil then
        local pri = self:GetTable()[buff .. "_Priority"] or 1
        if level == 0 or (pri > level) then
            current = self:GetTable()[buff]
            level = pri
        end
    end

    self.TickCache_Overrides[buff] = {current, winningslot}

    if VERIFY_MODIFIED_CACHE and !self.ModifiedCache[buff] and current != nil then
        print("ArcCW: Presumed non-changing buff '" .. buff .. "' is modified (" .. tostring(current) .. ")!")
    end

    local data = {
        buff = buff,
        current = current,
        winningslot = winningslot
    }

    if !ArcCW.BuffStack then

        ArcCW.BuffStack = true

        current = (self:GetBuff_Hook("O_Hook_" .. buff, data) or {}).current or current

        ArcCW.BuffStack = false

    end

    if current == nil then
        current = default
    end

    return current, winningslot
end

function SWEP:GetBuff_Mult(buff)

    local mult = 1

    if MODIFIED_CACHE and !self.ModifiedCache[buff] then
        if !ArcCW.BuffStack then
            ArcCW.BuffStack = true
            mult = (self:GetBuff_Hook("M_Hook_" .. buff, {buff = buff, mult = 1}) or {}).mult or mult
            ArcCW.BuffStack = false
        end
        if ArcCW.ConVar_BuffMults[buff] then
            if buff == "Mult_CycleTime" then
                mult = mult / GetConVar(ArcCW.ConVar_BuffMults[buff]):GetFloat()
            else
                mult = mult * GetConVar(ArcCW.ConVar_BuffMults[buff]):GetFloat()
            end
        end
        return mult
    end

    if self.TickCache_Mults[buff] then
        mult = self.TickCache_Mults[buff]
        local data = {
            buff = buff,
            mult = mult
        }

        if !ArcCW.BuffStack then

            ArcCW.BuffStack = true

            mult = (self:GetBuff_Hook("M_Hook_" .. buff, data) or {}).mult or mult

            ArcCW.BuffStack = false

        end

        if ArcCW.ConVar_BuffMults[buff] then
            if buff == "Mult_CycleTime" then
                mult = mult / GetConVar(ArcCW.ConVar_BuffMults[buff]):GetFloat()
            else
                mult = mult * GetConVar(ArcCW.ConVar_BuffMults[buff]):GetFloat()
            end
        end

        return mult
    end

    for i, k in pairs(self.Attachments) do
        if !k.Installed then continue end

        local atttbl = ArcCW.AttachmentTable[k.Installed]

        if atttbl[buff] then
            mult = mult * atttbl[buff]
        end

        if atttbl.ToggleStats and k.ToggleNum and atttbl.ToggleStats[k.ToggleNum] and atttbl.ToggleStats[k.ToggleNum][buff] then
            mult = mult * atttbl.ToggleStats[k.ToggleNum][buff]
        end
    end

    local cfm = self:GetCurrentFiremode()

    if cfm and cfm[buff] then
        mult = mult * cfm[buff]
    end

    if self:GetTable()[buff] then
        mult = mult * self:GetTable()[buff]
    end

    for i, e in pairs(self:GetActiveElements()) do
        local ele = self.AttachmentElements[e]

        if ele and ele[buff] then
            mult = mult * ele[buff]
        end
    end

    self.TickCache_Mults[buff] = mult

    if VERIFY_MODIFIED_CACHE and !self.ModifiedCache[buff] and mult != 1 then
        print("ArcCW: Presumed non-changing buff '" .. buff .. "' is modified (" .. tostring(mult) .. ")!")
    end

    if ArcCW.ConVar_BuffMults[buff] then
        if buff == "Mult_CycleTime" then
            mult = mult / GetConVar(ArcCW.ConVar_BuffMults[buff]):GetFloat()
        else
            mult = mult * GetConVar(ArcCW.ConVar_BuffMults[buff]):GetFloat()
        end
    end

    local data = {
        buff = buff,
        mult = mult
    }

    if !ArcCW.BuffStack then

        ArcCW.BuffStack = true

        mult = (self:GetBuff_Hook("M_Hook_" .. buff, data) or {}).mult or mult

        ArcCW.BuffStack = false

    end

    return mult
end

function SWEP:GetBuff_Add(buff)
    local add = 0

    if MODIFIED_CACHE and !self.ModifiedCache[buff] then
        if !ArcCW.BuffStack then
            ArcCW.BuffStack = true
            add = (self:GetBuff_Hook("A_Hook_" .. buff, {buff = buff, add = 0}) or {}).add or add
            ArcCW.BuffStack = false
        end
        if ArcCW.ConVar_BuffAdds[buff] then
            add = add + GetConVar(ArcCW.ConVar_BuffAdds[buff]):GetFloat()
        end
        return add
    end

    if self.TickCache_Adds[buff] then
        add = self.TickCache_Adds[buff]

        local data = {
            buff = buff,
            add = add
        }

        if !ArcCW.BuffStack then

            ArcCW.BuffStack = true

            add = (self:GetBuff_Hook("A_Hook_" .. buff, data) or {}).add or add

            ArcCW.BuffStack = false

        end

        if ArcCW.ConVar_BuffAdds[buff] then
            add = add + GetConVar(ArcCW.ConVar_BuffAdds[buff]):GetFloat()
        end

        return add
    end

    for i, k in pairs(self.Attachments) do
        if !k.Installed then continue end

        local atttbl = ArcCW.AttachmentTable[k.Installed]

        if atttbl[buff] then
            add = add + atttbl[buff]
        end

        if atttbl.ToggleStats and k.ToggleNum and atttbl.ToggleStats[k.ToggleNum] and atttbl.ToggleStats[k.ToggleNum][buff] then
            add = add + atttbl.ToggleStats[k.ToggleNum][buff]
        end
    end

    local cfm = self:GetCurrentFiremode()

    if cfm and cfm[buff] then
        add = add + cfm[buff]
    end

    for i, e in pairs(self:GetActiveElements()) do
        local ele = self.AttachmentElements[e]

        if ele and ele[buff] then
            add = add + ele[buff]
        end
    end

    self.TickCache_Adds[buff] = add

    if VERIFY_MODIFIED_CACHE and !self.ModifiedCache[buff] and add != 0 then
        print("ArcCW: Presumed non-changing buff '" .. buff .. "' is modified (" .. tostring(add) .. ")!")
    end

    if ArcCW.ConVar_BuffAdds[buff] then
        add = add + GetConVar(ArcCW.ConVar_BuffAdds[buff]):GetFloat()
    end

    local data = {
        buff = buff,
        add = add
    }

    if !ArcCW.BuffStack then

        ArcCW.BuffStack = true

        add = (self:GetBuff_Hook("A_Hook_" .. buff, data) or {}).add or add

        ArcCW.BuffStack = false

    end

    return add
end

SWEP.ActiveElementCache = nil

function SWEP:GetActiveElements(recache)
    if self.ActiveElementCache and !recache then return self.ActiveElementCache end
    if ArcCW.Overflow and self.ActiveElementCache then return self.ActiveElementCache end

    local eles = {}

    for _, i in pairs(self.Attachments) do
        if !i.Installed then
            if i.DefaultEles then
                table.Add(eles, i.DefaultEles)
            end
            continue
        end

        if i.InstalledEles and i.Installed != i.EmptyFallback then
            table.Add(eles, i.InstalledEles)
        end

        local atttbl = ArcCW.AttachmentTable[i.Installed]

        if atttbl.ActivateElements then
            table.Add(eles, atttbl.ActivateElements)
        end

        local num = i.ToggleNum or 1
        if atttbl.ToggleStats and atttbl.ToggleStats[num] and (atttbl.ToggleStats[num]["ActivateElements"] != nil) then
            table.Add(eles, atttbl.ToggleStats[num]["ActivateElements"])
            --atttbl.ToggleStats[num][buff]
        end

        local slots = atttbl.Slot

        if isstring(slots) then
            slots = {slots}
        end

        table.Add(eles, slots or {})

        table.insert(eles, i.Installed)
    end

    table.Add(eles, self.DefaultElements)

    local mode = self:GetCurrentFiremode()
    table.Add(eles, (mode or {}).ActivateElements or {})

    local eles2 = {}

    ArcCW.Overflow = true

    for f, i in pairs(eles) do
        local e = self.AttachmentElements[i]

        if !e then continue end

        if !self:CheckFlags(e.ExcludeFlags, e.RequireFlags) then continue end

        local a = false
        local c = 0

        for g = f, table.Count(eles) do
            if eles[g] == i then c = c + 1 end
            if a then continue end

            if c > 1 then a = true end
        end

        if a then continue end

        table.insert(eles2, i)
    end

    table.Add(eles2, self:GetWeaponFlags())

    ArcCW.Overflow = false

    self.ActiveElementCache = eles2

    return eles2
end

function SWEP:GetMuzzleDevice(wm)
    local model = self.WM
    local muzz = self.WMModel or self

    if !wm then
        model = self.VM
        muzz = self:GetOwner():GetViewModel()
    end

    if model then
        for _, ele in pairs(model) do
            if ele.IsMuzzleDevice then
                muzz = ele.Model or muzz
            end
        end
    end

    if self:GetInUBGL() then
        local _, slot = self:GetBuff_Override("UBGL")

        if wm then
            muzz = (self.Attachments[slot].WMuzzleDeviceElement or {}).Model or muzz
        else
            muzz = (self.Attachments[slot].VMuzzleDeviceElement or {}).Model or muzz
        end
    end

    return muzz
end

function SWEP:GetTracerOrigin()
    local ow = self:GetOwner()
    local wm = nil
    local muzz = nil

    if !ow:IsNPC() and !ow:IsNextBot() and ow:IsValid() then
        wm = !ow:GetViewModel():IsValid() or ow:ShouldDrawLocalPlayer()
        muzz = self:GetMuzzleDevice(wm)
    end

    if muzz and muzz:IsValid() then
        local posang = muzz:GetAttachment(self:GetBuff_Override("Override_MuzzleEffectAttachment", self.MuzzleEffectAttachment) or 1)
        if !posang then return muzz:GetPos() end
        local pos = posang.Pos

        return pos
    end
end

function SWEP:CheckFlags(reject, need)
    local flags
    if ArcCW.Overflow then
        flags = self:GetWeaponFlags()
    else
        flags = self:GetActiveElements()
    end

    reject = reject or {}
    need = need or {}

    if !istable(reject) then reject = {reject} end
    if !istable(need) then need = {need} end

    for _, i in pairs(reject) do
        if table.HasValue(flags, i) then
            return false
        end
    end

    for _, i in pairs(need) do
        if !table.HasValue(flags, i) then
            return false
        end
    end

    return true
end

function SWEP:GetWeaponFlags()
    local flags = {}

    if self.DefaultFlags then table.Add(flags, self.DefaultFlags) end

    for id, i in pairs(self.Attachments) do
        if !i.Installed then
            if i.DefaultFlags then
                table.Add(flags, i.DefaultFlags)
            end
            continue
        end

        local buff = self:GetBuff_Stat("GivesFlags", id)
        if buff then
            table.Add(flags, buff)
        end

        if i.GivesFlags then
            table.Add(flags, i.GivesFlags)
        end

        local extras = {}
        self:GetBuff_Hook("Hook_ExtraFlags", extras)
        table.Add(flags, extras)

        table.Add(flags, {i.Installed})
    end

    return flags
end

function SWEP:PlayerOwnsAtt(att)
    local qty = ArcCW:PlayerGetAtts(self:GetOwner(), att)

    return qty > 0
end

function SWEP:NetworkWeapon(sendto)

    net.Start("arccw_networkatts")
    net.WriteEntity(self) -- self entity

    net.WriteUInt(table.Count(self.Attachments), 8)

    for _, i in pairs(self.Attachments) do
        if !i.Installed then net.WriteUInt(0, ArcCW.GetBitNecessity()) continue end

        local atttbl = ArcCW.AttachmentTable[i.Installed]
        local id = atttbl.ID

        net.WriteUInt(id, ArcCW.GetBitNecessity())

        if i.SlideAmount then
            net.WriteFloat(i.SlidePos or 0.5)
        end

        if atttbl.ToggleStats then
            net.WriteUInt(i.ToggleNum or 1, 8) -- look if you want more than 255 fucking toggle options you're insane and stupid just don't ok
        end

        -- if atttbl.ColorOptionsTable then
        --     net.WriteUInt(i.ColorOptionIndex or 1, 8) -- look if you want more than 256 fucking color options you're insane and stupid and just don't ok
        -- end
    end

    if sendto then
        net.Send(sendto)
    else
        -- net.SendPVS(self:GetPos())
       -- net.Broadcast()
       net.Send(self:GetOwner())
    end
end

function SWEP:SendDetail_ColorIndex(slot)
    net.Start("arccw_colorindex")
    net.WriteUInt(slot, 8)
    net.WriteUInt(self.Attachments[slot].ColorOptionIndex)
    net.SendToServer()
end

function SWEP:SendDetail_SlidePos(slot, hmm)
    if !self.Attachments then return end
    if !self.Attachments[slot].SlidePos then return end

    net.Start("arccw_slidepos")
    net.WriteUInt(slot, 8)
    net.WriteFloat(self.Attachments[slot].SlidePos or 0.5)
    net.SendToServer()
end

function SWEP:SendDetail_ToggleNum(slot, hmm)
    if !self.Attachments or !self.Attachments[slot] then return end
    if !self.Attachments[slot].ToggleNum then return end

    net.Start("arccw_togglenum")
    net.WriteUInt(slot, 8)
    net.WriteUInt(self.Attachments[slot].ToggleNum or 1, 8)
    net.SendToServer()
end


function SWEP:SendAllDetails()
    for i, k in pairs(self.Attachments) do
        self:SendDetail_SlidePos(i, true)
        self:SendDetail_ToggleNum(i, true)
    end
end

function SWEP:CountAttachments()
    local total = 0

    for _, i in pairs(self.Attachments) do
        if i.Installed and !i.FreeSlot then
            local ins = ArcCW.AttachmentTable[i.Installed]
            if ins and !ins.IgnorePickX then
                total = total + 1
            end
        end
    end

    return total
end

function SWEP:SetBodygroupTr(ind, bg)
    self.Bodygroups[ind] = bg
end

function SWEP:RefreshBGs()
    local vm

    local vmm = self:GetBuff_Override("Override_VMMaterial") or self.VMMaterial or ""
    local wmm = self:GetBuff_Override("Override_WMMaterial") or self.WMMaterial or  ""

    local vmc = self:GetBuff_Override("Override_VMColor") or self.VMColor or Color(255, 255, 255)
    local wmc = self:GetBuff_Override("Override_WMColor") or self.WMColor or Color(255, 255, 255)

    local vms = self:GetBuff_Override("Override_VMSkin") or self.DefaultSkin
    local wms = self:GetBuff_Override("Override_WMSkin") or self.DefaultWMSkin

    local vmp = self.DefaultPoseParams
    local wmp = self.DefaultWMPoseParams

    if self.MirrorVMWM then
        wmm = vmm
        wmc = vmc
        wms = vms
        wmp = vmp
    end

    if self:GetOwner():IsPlayer() then
        vm = self:GetOwner():GetViewModel()
    end

    if vm and vm:IsValid() then
        ArcCW.SetBodyGroups(vm, self.DefaultBodygroups)
        vm:SetMaterial(vmm)
        vm:SetColor(vmc)
        vm:SetSkin(vms)

        vmp["BaseClass"] = nil

        for i, k in pairs(vmp) do
            vm:SetPoseParameter(i, k)
        end
    end

    self:SetMaterial(wmm)
    self:SetColor(wmc)
    self:SetSkin(wms)

    if self.WMModel and self.WMModel:IsValid() then
        ArcCW.SetBodyGroups(self.WMModel, self.MirrorVMWM and self.DefaultBodygroups or self.DefaultWMBodygroups)

        self.WMModel:SetMaterial(wmm)
        self.WMModel:SetColor(wmc)
        self.WMModel:SetSkin(wms)

        wmp["BaseClass"] = nil

        for i, k in pairs(wmp) do
            self.WMModel:SetPoseParameter(i, k)
        end
    end

    local ae = self:GetActiveElements()

    for _, e in pairs(ae) do
        local ele = self.AttachmentElements[e]

        if !ele then continue end

        if ele.VMPoseParams and vm and IsValid(vm) then
            ele.VMPoseParams["BaseClass"] = nil
            for i, k in pairs(ele.VMPoseParams) do
                vm:SetPoseParameter(i, k)
            end
        end

        if self.WMModel and self.WMModel:IsValid() then
            if self.MirrorVMWM and ele.VMPoseParams then
                ele.VMPoseParams["BaseClass"] = nil
                for i, k in pairs(ele.VMPoseParams) do
                    self.WMModel:SetPoseParameter(i, k)
                end
            end
            if ele.WMPoseParams then
                ele.WMPoseParams["BaseClass"] = nil
                for i, k in pairs(ele.WMPoseParams) do
                    self.WMModel:SetPoseParameter(i, k)
                end
            end
        end

        if ele.VMSkin and vm and IsValid(vm) then
            vm:SetSkin(ele.VMSkin)
        end

        if self.WMModel and self.WMModel:IsValid() then
            if self.MirrorVMWM and ele.VMSkin then
                self.WMModel:SetSkin(ele.VMSkin)
                self:SetSkin(ele.VMSkin)
            end
            if ele.WMSkin then
                self.WMModel:SetSkin(ele.WMSkin)
                self:SetSkin(ele.WMSkin)
            end
        end

        if ele.VMColor and vm and IsValid(vm) then
            vm:SetColor(ele.VMColor)
        end

        if self.WMModel and self.WMModel:IsValid() then
            if self.MirrorVMWM and ele.VMSkin then
                self.WMModel:SetColor(ele.VMColor or color_white)
                self:SetColor(ele.VMColor or color_white)
            end
            if ele.WMSkin then
                self.WMModel:SetColor(ele.WMColor or color_white)
                self:SetColor(ele.WMColor or color_white)
            end
        end

        if ele.VMMaterial and vm and IsValid(vm) then
            vm:SetMaterial(ele.VMMaterial)
        end

        if self.WMModel and self.WMModel:IsValid() then
            if self.MirrorVMWM and ele.VMMaterial then
                self.WMModel:SetMaterial(ele.VMMaterial)
                self:SetMaterial(ele.VMMaterial)
            end
            if ele.WMMaterial then
                self.WMModel:SetMaterial(ele.WMMaterial)
                self:SetMaterial(ele.WMMaterial)
            end
        end

        if ele.VMBodygroups then
            for _, i in pairs(ele.VMBodygroups) do
                if !i.ind or !i.bg then continue end

                if vm and IsValid(vm) and vm:GetBodygroup(i.ind) != i.bg then
                    vm:SetBodygroup(i.ind, i.bg)
                end
            end

            if self.MirrorVMWM then
                for _, i in pairs(ele.VMBodygroups) do
                    if !i.ind or !i.bg then continue end

                    if self.WMModel and IsValid(self.WMModel) and self.WMModel:GetBodygroup(i.ind) != i.bg then
                        self.WMModel:SetBodygroup(i.ind, i.bg)
                    end

                    if self:GetBodygroup(i.ind) != i.bg then
                        self:SetBodygroup(i.ind, i.bg)
                    end
                end
            end
        end

        if ele.WMBodygroups then
            for _, i in pairs(ele.WMBodygroups) do
                if !i.ind or !i.bg then continue end

                if self.WMModel and IsValid(self.WMModel) and self.WMModel:GetBodygroup(i.ind) != i.bg then
                    self.WMModel:SetBodygroup(i.ind, i.bg)
                end

                if self:GetBodygroup(i.ind) != i.bg then
                    self:SetBodygroup(i.ind, i.bg)
                end
            end
        end

        if ele.VMBoneMods then
            for bone, i in pairs(ele.VMBoneMods) do
                local boneind = vm:LookupBone(bone)

                if !boneind then continue end

                vm:ManipulateBonePosition(boneind, i)
            end

            if self.MirrorVMWM then
                for bone, i in pairs(ele.VMBoneMods) do
                    if !(self.WMModel and self.WMModel:IsValid()) then break end
                    local boneind = self:LookupBone(bone)

                    if !boneind then continue end

                    self:ManipulateBonePosition(boneind, i)
                end
            end
        end

        if ele.WMBoneMods then
            for bone, i in pairs(ele.WMBoneMods) do
                if !(self.WMModel and self.WMModel:IsValid()) then break end
                local boneind = self:LookupBone(bone)

                if !boneind then continue end

                self:ManipulateBonePosition(boneind, i)
            end
        end

        if SERVER then
            self:SetupShields()
        end
    end

    local tpmdl = IsValid(self.WMModel) and self.WMModel or self

    if IsValid(vm) then
        for i = 0, (vm:GetNumBodyGroups()) do
            if self.Bodygroups[i] then
                vm:SetBodygroup(i, self.Bodygroups[i])
            end
        end
        self:GetBuff_Hook("Hook_ModifyBodygroups", {vm = vm, eles = ae, wm = false})
    end

    for i = 0, (tpmdl:GetNumBodyGroups()) do
        if self.Bodygroups[i] then
            tpmdl:SetBodygroup(i, self.Bodygroups[i])
        end
    end
    self:GetBuff_Hook("Hook_ModifyBodygroups", {vm = tpmdl, eles = ae, wm = true})

    for slot, v in pairs(self.Attachments) do
        if !v.Installed then continue end

        local func = self:GetBuff_Stat("Hook_ModifyAttBodygroups", slot)
        if func and v.VElement and IsValid(v.VElement.Model) and IsValid(vm) then
            func(self, {vm = vm, element = v.VElement, slottbl = v, wm = false})
        end
        if func and v.WElement and IsValid(v.WElement.Model)  then
            func(self, {vm = tpmdl, element = v.WElement, slottbl = v, wm = true})
        end
    end
end

function SWEP:GetPickX()
    return ArcCW.ConVars["atts_pickx"]:GetInt()
end

function SWEP:Attach(slot, attname, silent, noadjust)
    silent = silent or false
    local attslot = self.Attachments[slot]
    if !attslot then return end
    if attslot.Installed == attname then return end
    if attslot.Internal then return end

    -- Make an additional check to see if we can detach the current attachment
    if attslot.Installed and !ArcCW:PlayerCanAttach(self:GetOwner(), self, attslot.Installed, slot, attname) then
        if CLIENT and !silent then
            surface.PlaySound("items/medshotno1.wav")
        end
        return
    end

    if !ArcCW:PlayerCanAttach(self:GetOwner(), self, attname, slot, false) then
        if CLIENT and !silent then
            surface.PlaySound("items/medshotno1.wav")
        end
        return
    end

    local pick = self:GetPickX()

    if pick > 0 and self:CountAttachments() >= pick and !attslot.FreeSlot
            and !attslot.Installed then
        if CLIENT and !silent then
            surface.PlaySound("items/medshotno1.wav")
        end
        return
    end

    local atttbl = ArcCW.AttachmentTable[attname]

    if !atttbl then return end
    if !ArcCW:SlotAcceptsAtt(attslot.Slot, self, attname) then return end
    if !self:CheckFlags(atttbl.ExcludeFlags, atttbl.RequireFlags) then return end
    if !self:PlayerOwnsAtt(attname) then return end

    local max = atttbl.Max

    if max then
        local amt = 0

        for i, k in pairs(self.Attachments) do
            if k.Installed == attname then amt = amt + 1 end
        end

        if amt >= max then return end
    end

    if attslot.SlideAmount then
        attslot.SlidePos = 0.5
    end

    if atttbl.MountPositionOverride then
        attslot.SlidePos = atttbl.MountPositionOverride
    end

    if atttbl.AdditionalSights then
        self.SightMagnifications = {}
    end

    if atttbl.ToggleStats then
        attslot.ToggleNum = 1
    end

    attslot.ToggleLock = atttbl.ToggleLockDefault or false

    if CLIENT then
        -- we are asking to attach something

        self:SendAllDetails()

        net.Start("arccw_asktoattach")
        net.WriteUInt(slot, 8)
        net.WriteUInt(atttbl.ID, 24)
        net.SendToServer()

        if !silent then
            surface.PlaySound(atttbl.AttachSound or "weapons/arccw/install.wav")
        end
    else
        self:DetachAllMergeSlots(slot)

        for i, k in pairs(self.Attachments) do
            if table.HasValue(k.MergeSlots or {}, slot) then
                self:DetachAllMergeSlots(i)
            end
        end
    end

    attslot.Installed = attname

    if atttbl.Health then
        attslot.HP = self:GetAttachmentMaxHP(slot)
    end

    if atttbl.ColorOptionsTable then
        attslot.ColorOptionIndex = 1
    end

    ArcCW:PlayerTakeAtt(self:GetOwner(), attname)

    --[[]
    local fmt = self:GetBuff_Override("Override_Firemodes") or self.Firemodes
    local fmi = self:GetFireMode()

    if fmi > table.Count(fmt) then
        self:SetFireMode(1)
    end
    ]]

    --self.UnReady = false

    if SERVER then
        self:NetworkWeapon()
        self:SetupModel(false)
        self:SetupModel(true)
        ArcCW:PlayerSendAttInv(self:GetOwner())

        if engine.ActiveGamemode() == "terrortown" then
            self:TTT_PostAttachments()
        end
    else
        self:SetupActiveSights()

        self.LHIKAnimation = 0
        self.LHIKAnimationStart = 0
        self.LHIKAnimationTime = 0

        self.LHIKDelta = {}
        self.LHIKDeltaAng = {}

        self.ViewModel_Hit = Vector(0, 0, 0)

        if !silent then
            self:SavePreset("autosave")
        end
    end

    for s, i in pairs(self.Attachments) do
        if !self:CheckFlags(i.ExcludeFlags, i.RequireFlags) then
            self:Detach(s, true, true)
        end
    end

    if !noadjust then
        self:AdjustAtts()
    end

    if atttbl.UBGL then
        local ubgl_ammo = self:GetBuff_Override("UBGL_Ammo")
        local ubgl_clip = self:GetBuff_Override("UBGL_Capacity")
        if self:GetOwner():IsPlayer() and ArcCW.ConVars["atts_ubglautoload"]:GetBool() and ubgl_ammo then
            local amt = math.min(ubgl_clip - self:Clip2(), self:GetOwner():GetAmmoCount(ubgl_ammo))
            self:SetClip2(self:Clip2() + amt)
            self:GetOwner():RemoveAmmo(amt, ubgl_ammo)
        end
    end

    self:RefreshBGs()
    return true
end

function SWEP:DetachAllMergeSlots(slot, silent)
    local slots = {slot}

    table.Add(slots, (self.Attachments[slot] or {}).MergeSlots or {})

    for _, i in pairs(slots) do
        self:Detach(i, silent, nil, true)
    end
end

function SWEP:Detach(slot, silent, noadjust, nocheck)
    if !slot then return end
    if !self.Attachments[slot] then return end

    if !self.Attachments[slot].Installed then return end

    if self.Attachments[slot].Internal then return end

    if !nocheck and !ArcCW:PlayerCanAttach(self:GetOwner(), self, self.Attachments[slot].Installed, slot, true) then
        if CLIENT and !silent then
            surface.PlaySound("items/medshotno1.wav")
        end
        return
    end

    if self.Attachments[slot].Installed == self.Attachments[slot].EmptyFallback then
        return
    end

    local previnstall = self.Attachments[slot].Installed

    local atttbl = ArcCW.AttachmentTable[previnstall]

    if atttbl.UBGL then
        local clip = self:Clip2()

        local ammo = atttbl.UBGL_Ammo or "smg1_grenade"

        if SERVER and IsValid(self:GetOwner()) then
            self:GetOwner():GiveAmmo(clip, ammo, true)
        end

        self:SetClip2(0)
        self:DeselectUBGL()
    end

    if self.Attachments[slot].EmptyFallback then -- is this a good name
        self.Attachments[slot].Installed = self.Attachments[slot].EmptyFallback
    else
        self.Attachments[slot].Installed = nil
    end

    if self.Attachments[slot].SubAtts then
        for i, k in pairs(self.Attachments[slot].SubAtts) do
            self:Detach(k, true, true)
        end
    end

    if self:GetAttachmentHP(slot) >= self:GetAttachmentMaxHP(slot) then
        ArcCW:PlayerGiveAtt(self:GetOwner(), previnstall)
    end

    if CLIENT then
        self:SendAllDetails()

        -- we are asking to detach something
        net.Start("arccw_asktodetach")
        net.WriteUInt(slot, 8)
        net.SendToServer()

        if !silent then
            surface.PlaySound(atttbl.DetachSound or "weapons/arccw/uninstall.wav")
        end

        self:SetupActiveSights()

        self.LHIKAnimation = 0
        self.LHIKAnimationStart = 0
        self.LHIKAnimationTime = 0

        if !silent then
            self:SavePreset("autosave")
        end
    else
        self:NetworkWeapon()
        self:SetupModel(false)
        self:SetupModel(true)
        ArcCW:PlayerSendAttInv(self:GetOwner())
    end

    self:RefreshBGs()

    if !noadjust then
        self:AdjustAtts()
    end
    return true
end

function SWEP:ToggleSlot(slot, num, silent, back)
    local atttbl = ArcCW.AttachmentTable[self.Attachments[slot].Installed]
    if !atttbl.ToggleStats then return end

    local amt = 1

    if back then amt = -1 end

    if !num then
        self.Attachments[slot].ToggleNum = (self.Attachments[slot].ToggleNum or 1) + amt
        if self.Attachments[slot].ToggleNum > #atttbl.ToggleStats then
            self.Attachments[slot].ToggleNum = 1
        elseif self.Attachments[slot].ToggleNum < 1 then
            self.Attachments[slot].ToggleNum = #atttbl.ToggleStats
        end
    else
        self.Attachments[slot].ToggleNum = math.Clamp(num, 1, #catttbl.ToggleStats)
    end

    if CLIENT then
        self:SendDetail_ToggleNum(slot)
        self:SetupActiveSights()
    elseif SERVER then
        self:NetworkWeapon()
        self:SetupModel(false)
        self:SetupModel(true)
    end

    self:AdjustAtts()

    for s, i in pairs(self.Attachments) do
        if !self:CheckFlags(i.ExcludeFlags, i.RequireFlags) then
            self:Detach(s, true)
        end
    end

    self:RefreshBGs()

    if CLIENT and !silent and self:GetBuff_Stat("ToggleSound", slot) != false then
        surface.PlaySound(self:GetBuff_Stat("ToggleSound", slot) or (atttbl.ToggleStats[slot] or {}).ToggleSound or "weapons/arccw/firemode.wav")
    end
end

function SWEP:AdjustAmmo(old_inf)

    local new_inf = self:HasInfiniteAmmo()

    local wpn = weapons.Get(self:GetClass())
    local ammo = self:GetBuff_Override("Override_Ammo", wpn.Primary.Ammo)
    local oldammo = self.OldAmmo or self.Primary.Ammo

    if old_inf and (!new_inf or ammo != oldammo) then
        self:SetClip1(0)
    elseif (!old_inf and new_inf) or ammo != oldammo then
        self:Unload()
    end

    self.Primary.Ammo = ammo
    self.OldAmmo = self.Primary.Ammo
end

function SWEP:AdjustAtts()
    local old_inf = self:HasInfiniteAmmo()

    self:RecalcAllBuffs()

    -- Recalculate active elements so dependencies aren't fucked
    self.ActiveElementCache = nil
    self:GetActiveElements(true)
    self.ModifiedCache = {}

    -- Tempoarily disable modified cache, since we're building it right now
    MODIFIED_CACHE = false

    for i, k in pairs(self.Attachments) do
        if !k.Installed then continue end
        local ok = true

        if !ArcCW:SlotAcceptsAtt(k.Slot, self, k.Installed) then ok = false end
        if ok and !self:CheckFlags(k.ExcludeFlags, k.RequireFlags) then ok = false end

        local atttbl = ArcCW.AttachmentTable[k.Installed]

        if !atttbl then continue end
        if ok and !self:CheckFlags(atttbl.ExcludeFlags, atttbl.RequireFlags) then ok = false end

        if !ok then
            self:Detach(i, true)
            continue
        end

        -- Cache all possible value modifiers
        for var, v in pairs(atttbl) do
            self.ModifiedCache[var] = true
            if var == "ToggleStats" or var == "Override_Firemodes" then
                for _, v2 in pairs(v) do
                    for var2, _ in pairs(v2) do
                        self.ModifiedCache[var2] = true
                    end
                end
            end
        end
    end

    for _, e in pairs(self.AttachmentElements) do
        if !istable(e) then continue end
        for var, v in pairs(e) do
            self.ModifiedCache[var] = true
        end
    end

    for _, e in pairs(self.Firemodes) do
        if !istable(e) then continue end
        for var, v in pairs(e) do
            self.ModifiedCache[var] = true
        end
    end

    MODIFIED_CACHE = true

    if SERVER then
        local cs = self:GetCapacity() + self:GetChamberSize()

        if self:Clip1() > cs and self:Clip1() != ArcCW.BottomlessMagicNumber then
            local diff = self:Clip1() - cs
            self:SetClip1(cs)

            if self:GetOwner():IsValid() and !self:GetOwner():IsNPC() then
                self:GetOwner():GiveAmmo(diff, self.Primary.Ammo, true)
            end
        end
    else
        local se = self:GetBuff_Override("Override_ShootEntity") or self.ShootEntity
        if se then
            local path = "arccw/weaponicons/" .. self:GetClass()
            local mat = Material(path)

            if !mat:IsError() then
                local tex = mat:GetTexture("$basetexture")
                local texpath = tex:GetName()

                killicon.Add(se, texpath, Color(255, 255, 255))
            end
        end
    end

    local ubgl_ammo = self:GetBuff_Override("UBGL_Ammo")
    local ubgl_clip = self:GetBuff_Override("UBGL_Capacity")

    self.Secondary.ClipSize = ubgl_clip or -1
    self.Secondary.Ammo = ubgl_ammo or "none"

    --[[]
    if ubgl_clip then
        self.Secondary.ClipSize = ubgl_clip
        if self:GetOwner():IsPlayer() and ArcCW.ConVars["atts_ubglautoload"]:GetBool() and ubgl_ammo then
            local amt = math.min(ubgl_clip - self:Clip2(), self:GetOwner():GetAmmoCount(ubgl_ammo))
            self:SetClip2(self:Clip2() + amt)
            self:GetOwner():RemoveAmmo(amt, ubgl_ammo)
        end
    else
        self.Secondary.ClipSize = -1
    end
    ]]



    self:RebuildSubSlots()

    local fmt = self:GetBuff_Override("Override_Firemodes", self.Firemodes)
    fmt["BaseClass"] = nil

    local fmi = self:GetFireMode()
    if !fmt[fmi] then self:SetFireMode(1) end

    self:AdjustAmmo(old_inf)
end

function SWEP:GetAttachmentMaxHP(slot)
    if !self.Attachments[slot] then return 100 end
    if !self.Attachments[slot].Installed then return 100 end
    local maxhp = 100
    local atttbl = ArcCW.AttachmentTable[self.Attachments[slot].Installed]

    if atttbl.Health then
        maxhp = atttbl.Health
    end

    return maxhp
end

function SWEP:GetAttachmentHP(slot)
    if !self.Attachments[slot] then return 100 end
    if !self.Attachments[slot].Installed then return 100 end

    if self.Attachments[slot].HP then return self.Attachments[slot].HP end

    self.Attachments[slot].HP = self:GetAttachmentMaxHP(slot)

    return self.Attachments[slot].HP
end

function SWEP:ApplyAttachmentShootDamage()
    local any = false
    for j, i in pairs(self.Attachments) do
        if !i.Installed then continue end
        local atttbl = ArcCW.AttachmentTable[i.Installed]

        if !atttbl.Health then continue end

        if atttbl.DamageOnShoot then
            self:DamageAttachment(j, atttbl.DamageOnShoot)
            any = true
        end
    end

    if any then
        self:SendAttHP()
    end
end

function SWEP:DamageAttachment(slot, dmg)
    if !self.Attachments[slot] then return end
    if !self.Attachments[slot].Installed then return end

    self.Attachments[slot].HP = self:GetAttachmentHP(slot) - dmg

    if self:GetAttachmentHP(slot) <= 0 then
        local atttbl = ArcCW.AttachmentTable[self.Attachments[slot].Installed]

        if atttbl.Hook_AttDestroyed then
            atttbl.Hook_AttDestroyed(self, {slot = slot, dmg = dmg})
        end

        self:Detach(slot, true)
    end
end

function SWEP:SendAttHP()
    net.Start("arccw_sendatthp")
    for i, k in pairs(self.Attachments) do
        if !k.Installed then continue end
        local atttbl = ArcCW.AttachmentTable[k.Installed]

        if atttbl.Health then
            net.WriteBool(true)
            net.WriteUInt(i, 8)
            net.WriteFloat(self:GetAttachmentHP(i))
        end
    end
    net.WriteBool(false)
    net.Send(self:GetOwner())
end

-- local node = {b = {}, i = "" t = 0}
-- b: branches
-- i: installed
-- t: toggle
-- s: slide
-- h: hp

-- recursive function
-- gets a tree of all the attachments installed in subslots subordinate to a particular slot
function SWEP:GetSubSlotTree(i)
    if !self.Attachments[i] then return nil end
    if !self.Attachments[i].Installed then return nil end
    if !self.Attachments[i].SubAtts then return
        {
        b = {},
        i = self.Attachments[i].Installed,
        t = self.Attachments[i].ToggleNum,
        s = self.Attachments[i].SlidePos,
        h = self.Attachments[i].Health}
    end

    local ss = {}
    for j, k in pairs(self.Attachments[i].SubAtts) do
        if k == i then continue end
        local sst = self:GetSubSlotTree(k)
        if sst then
            ss[j] = sst
        end
    end

    return {b = ss, i = self.Attachments[i].Installed}
end

function SWEP:SubSlotTreeReinstall(slot, subslottree)
    for i, k in pairs(self.Attachments[slot].SubAtts or {}) do
        -- i = index
        -- k = slot
        self.Attachments[k].Installed = subslottree[i].i
        self.Attachments[k].ToggleNum = subslottree[i].t
        self.Attachments[k].SlidePos = subslottree[i].s
        self.Attachments[k].Health = subslottree[i].h

        if subslottree.b[i] then
            self:SubSlotTreeReinstall(i, subslottree.b[i])
        end
    end
end

function SWEP:RebuildSubSlots()
    -- this function rebuilds the subslots while preserving installed attachment data
    local subslottrees = {}

    local baseatts = table.Count(weapons.Get(self:GetClass()).Attachments)

    self.Attachments.BaseClass = nil

    for i = 1, baseatts do
        subslottrees[baseatts] = self:GetSubSlotTree(i)
    end

    -- remove all sub slots
    for i, k in pairs(self.Attachments) do
        if !isnumber(i) then continue end
        if !istable(k) then continue end
        if i > baseatts then
            self.Attachments[i] = nil
        else
            self.Attachments[i].SubAtts = nil
        end
    end

    self.SubSlotCount = 0
    -- add the sub slots back
    for i, k in pairs(self.Attachments) do
        if !k.Installed then continue end
        local att = ArcCW.AttachmentTable[k.Installed]
        if !att then continue end
        if !istable(k) then continue end

        if att.SubSlots then
            self:AddSubSlot(i, k.Installed)
        end
    end
    -- add the sub slot data back

    for i, k in pairs(subslottrees) do
        self:SubSlotTreeReinstall(i, k)
    end
end

function SWEP:AddSubSlot(i, attname)
    local baseatts = table.Count(weapons.Get(self:GetClass()).Attachments)
    local att = ArcCW.AttachmentTable[attname]
    if att.SubSlots then
        self.Attachments[i].SubAtts = {}
        local og_slot = self.Attachments[i]
        for ind, slot in pairs(att.SubSlots) do
            if !istable(slot) then continue end
            self.SubSlotCount = self.SubSlotCount + 1
            local index = baseatts + self.SubSlotCount
            self.Attachments[index] = slot
            self.Attachments[index].Bone = og_slot.Bone
            self.Attachments[index].WMBone = og_slot.WMBone
            self.Attachments[index].ExtraSightDist = 0--self.Attachments[index].ExtraSightDist or og_slot.ExtraSightDist
            self.Attachments[index].CorrectivePos = og_slot.CorrectivePos
            self.Attachments[index].CorrectiveAng = og_slot.CorrectiveAng
            og_slot.SubAtts[ind] = index

            if slot.MergeSlots then
                self.Attachments[index].MergeSlots = {}
                for _, k2 in pairs(slot.MergeSlots) do
                    table.insert(self.Attachments[index].MergeSlots, k2 + index)
                end
            end

            if slot.Offset then
                self.Attachments[index].Offset = {
                    vpos = Vector(0, 0, 0),
                    vang = Angle(0, 0, 0),
                    wpos = Vector(0, 0, 0),
                    wang = Angle(0, 0, 0)
                }

                if slot.Offset.vang then
                    self.Attachments[index].Offset.vang = slot.Offset.vang + (og_slot.Offset.vang or Angle(0, 0, 0))
                end

                if slot.Offset.wang then
                    self.Attachments[index].Offset.wang = slot.Offset.wang + (og_slot.Offset.wang or Angle(0, 0, 0))
                end

                if slot.Offset.vpos then
                    self.Attachments[index].Offset.vpos = LocalToWorld(slot.Offset.vpos, self.Attachments[index].Offset.vang, og_slot.Offset.vpos, og_slot.Offset.vang or Angle(0, 0, 0))
                end

                if slot.Offset.wpos then
                    self.Attachments[index].Offset.wpos = LocalToWorld(slot.Offset.wpos, self.Attachments[index].Offset.wang, og_slot.Offset.wpos, og_slot.Offset.wang or Angle(0, 0, 0))
                end
            end

            self.Attachments[index].SubAtts = {}
        end
    end
end

function SWEP:OnReloaded()
    self:RecalcAllBuffs()
    self:SetupActiveSights()
end
--addons/[binbon]arccw_modify/lua/weapons/arccw_base/sh_deploy.lua:
return gluapack()()
--addons/[binbon]arccw_modify/lua/weapons/arccw_base/sh_think.lua:
if CLIENT then
    ArcCW.LastWeapon = nil
end

local vec1 = Vector(1, 1, 1)
local vec0 = vec1 * 0
local ang0 = Angle(0, 0, 0)

local lastUBGL = 0
local CurTime = CurTime
local singleplayer = game.SinglePlayer()
function SWEP:Think()
    if IsValid(self:GetOwner()) and self:GetClass() == "arccw_base" then
        self:Remove()
        return
    end
    local getstate = self:GetState()
    local owner = self:GetOwner()
    local IsFirstTimePredicteds = IsFirstTimePredicted()
    local curtime = CurTime()
    --if !IsValid(owner) or owner:IsNPC() then return end

    if getstate == ArcCW.STATE_DISABLE and !self:GetPriorityAnim() then
        self:SetState(ArcCW.STATE_IDLE)

        if CLIENT and self.UnReady then
            self.UnReady = false
        end
    end

    for i, v in ipairs(self.EventTable) do
        for ed, bz in pairs(v) do
            if ed <= curtime then
                if bz.AnimKey and (bz.AnimKey != self.LastAnimKey or bz.StartTime != self.LastAnimStartTime) then
                    continue
                end
                self:PlayEvent(bz)
                self.EventTable[i][ed] = nil
                --print(CurTime(), "Event completed at " .. i, ed)
                if table.IsEmpty(v) and i != 1 then self.EventTable[i] = nil --[[print(CurTime(), "No more events at " .. i .. ", killing")]] end
            end
        end
    end

    if CLIENT and (!singleplayer and IsFirstTimePredicteds or true)
            and owner == LocalPlayer() and ArcCW.InvHUD
            and !ArcCW.Inv_Hidden and ArcCW.Inv_Fade == 0 then
        ArcCW.InvHUD:Remove()
        ArcCW.Inv_Fade = 0.01
    end

    local vm = owner:GetViewModel()
    local getburstcount = self:GetBurstCount()
    self.BurstCount = getburstcount

    local sg = self:GetShotgunReloading()
    local keypressedattack = owner:KeyPressed(IN_ATTACK)
    if (sg == 2 or sg == 4) and keypressedattack then
        self:SetShotgunReloading(sg + 1)
    elseif (sg >= 2) and self:GetReloadingREAL() <= curtime then
        self:ReloadInsert((sg >= 4) and true or false)
    end

    self:InBipod()

    local getreloading = self:GetReloading()
    local getnextprimaryfire = self:GetNextPrimaryFire()
    local getcurrenfiremode = self:GetCurrentFiremode().Mode
    if self:GetNeedCycle() and !self.Throwing and !getreloading and self:GetWeaponOpDelay() < curtime and getnextprimaryfire < curtime and -- Adding this delays bolting if the RPM is too low, but removing it may reintroduce the double pump bug. Increasing the RPM allows you to shoot twice on many multiplayer servers. Sure would be convenient if everything just worked nicely
            ((getcurrenfiremode == 2 or !owner:KeyDown(IN_ATTACK))
          ) then
        local anim = self:SelectAnimation("cycle")
        anim = self:GetBuff_Hook("Hook_SelectCycleAnimation", anim) or anim
        local mult = self:GetBuff_Mult("Mult_CycleTime")
        local p = self:PlayAnimation(anim, mult, true, 0, true)
        if p then
            self:SetNeedCycle(false)
            self:SetPriorityAnim(curtime + self:GetAnimKeyTime(anim, true) * mult)
        end
    end

  /*
  if self:GetGrenadePrimed() and !(owner:KeyDown(IN_ATTACK) or owner:KeyDown(IN_ATTACK2)) and (!game.SinglePlayer() or SERVER) then
        self:Throw()
    end

    if self:GetGrenadePrimed() and self.GrenadePrimeTime > 0 and self.isCooked then
        local heldtime = (CurTime() - self.GrenadePrimeTime)

        local ft = self:GetBuff_Override("Override_FuseTime") or self.FuseTime

        if ft and (heldtime >= ft) and (!game.SinglePlayer() or SERVER) then
            self:Throw()
        end
    end
*/
    if IsFirstTimePredicteds and getnextprimaryfire < curtime and owner:KeyReleased(IN_USE) then
        if self:InBipod() then
            self:ExitBipod()
        else
            self:EnterBipod()
        end
    end
    local keyreleased = owner:KeyReleased(IN_ATTACK)
    if ((singleplayer and SERVER) or (!singleplayer and true)) and self:GetBuff_Override("Override_TriggerDelay", self.TriggerDelay) then
        if keyreleased and self:GetBuff_Override("Override_TriggerCharge", self.TriggerCharge) and self:GetTriggerDelta(true) >= 1 then
            self:PrimaryAttack()
        else
            self:DoTriggerDelay()
        end
    end
    local runawayburst = self:GetCurrentFiremode().RunawayBurst
    if runawayburst then

        if getburstcount > 0 and ((singleplayer and SERVER) or (!singleplayer and true)) then
            self:PrimaryAttack()
        end

        if self:Clip1() < self:GetBuff("AmmoPerShot") or getburstcount == self:GetBurstLength() then
            self:SetBurstCount(0)
            if !self:GetCurrentFiremode().AutoBurst then
                self.Primary.Automatic = false
            end
        end
    end

    if keyreleased then

        if !runawayburst then
            self:SetBurstCount(0)
            self.LastTriggerTime = -1 -- Cannot fire again until trigger released
            self.LastTriggerDuration = 0
        end

        if getcurrenfiremode < 0 and !runawayburst then
            local postburst = self:GetCurrentFiremode().PostBurstDelay or 0

            if (curtime + postburst) > self:GetWeaponOpDelay() then
                --self:SetNextPrimaryFire(CurTime() + postburst)
                self:SetWeaponOpDelay(curtime + postburst * self:GetBuff_Mult("Mult_PostBurstDelay") + self:GetBuff_Add("Add_PostBurstDelay"))
            end
        end
    end

  /*
  if owner and owner:GetInfoNum("arccw_automaticreload", 0) == 1 and self:Clip1() == 0 and !self:GetReloading() and CurTime() > self:GetNextPrimaryFire() + 0.2 then
        self:Reload()
    end
*/  
    if (!(self:GetBuff_Override("Override_ReloadInSights") or self.ReloadInSights) and (getreloading or owner:KeyDown(IN_RELOAD))) then
     --   if !(self:GetBuff_Override("Override_ReloadInSights") or self.ReloadInSights) and getreloading then
            self:ExitSights()
      --  end
    end

    local statesights = ArcCW.STATE_SIGHTS
    if self:GetBuff_Hook("Hook_ShouldNotSight") and (self.Sighted or getstate == statesights) then
        self:ExitSights()
    elseif self:GetHolster_Time() > 0 then
        self:ExitSights()
    else

        -- no it really doesn't, past me
        local sighted = getstate == statesights
        local toggle = owner:GetInfoNum("arccw_toggleads", 0) >= 1
        local suitzoom = owner:KeyDown(IN_ZOOM)
        local sp_cl = singleplayer and CLIENT

        -- if in singleplayer, client realm should be completely ignored
        if toggle and !sp_cl then
            if owner:KeyPressed(IN_ATTACK2) then
                if sighted then
                    self:ExitSights()
                elseif !suitzoom then
                    self:EnterSights()
                end
            elseif suitzoom and sighted then
                self:ExitSights()
            end
        elseif !toggle then
            local keydown2 = owner:KeyDown(IN_ATTACK2)
            if (keydown2 and !suitzoom) and !sighted then
                self:EnterSights()
            elseif (!keydown2 or suitzoom) and sighted then
                self:ExitSights()
            end
        end

    end

    if (!singleplayer and IsFirstTimePredicteds) or (singleplayer and true) then
        local inspint = self:InSprint()
        if inspint and (getstate != ArcCW.STATE_SPRINT) then
            self:EnterSprint()
        elseif !inspint and (getstate == ArcCW.STATE_SPRINT) then
            self:ExitSprint()
        end
    end
    local frametime = FrameTime()
    if singleplayer or IsFirstTimePredicteds then
        local ma = math.Approach
        self:SetSightDelta(ma(self:GetSightDelta(), getstate == statesights and 0 or 1, frametime / self:GetSightTime()))
        self:SetSprintDelta(ma(self:GetSprintDelta(), getstate == ArcCW.STATE_SPRINT and 1 or 0, frametime / self:GetSprintTime()))
    end

    if CLIENT and (singleplayer or IsFirstTimePredicteds) then
        self:ProcessRecoil()
    end

    if CLIENT and IsValid(vm) then

        for i = 1, vm:GetBoneCount() do
            vm:ManipulateBoneScale(i, vec1)
        end

        for i, k in pairs(self:GetBuff_Override("Override_CaseBones", self.CaseBones) or {}) do
            if !isnumber(i) then continue end
            for _, b in pairs(istable(k) and k or {k}) do
                local bone = vm:LookupBone(b)

                if !bone then continue end

                if self:GetVisualClip() >= i then
                    vm:ManipulateBoneScale(bone, vec1)
                else
                    vm:ManipulateBoneScale(bone, vec0)
                end
            end
        end

        for i, k in pairs(self:GetBuff_Override("Override_BulletBones", self.BulletBones) or {}) do
            if !isnumber(i) then continue end
            for _, b in pairs(istable(k) and k or {k}) do
                local bone = vm:LookupBone(b)

                if !bone then continue end

                if self:GetVisualBullets() >= i then
                    vm:ManipulateBoneScale(bone, vec1)
                else
                    vm:ManipulateBoneScale(bone, vec0)
                end
            end
        end

        for i, k in pairs(self:GetBuff_Override("Override_StripperClipBones", self.StripperClipBones) or {}) do
            if !isnumber(i) then continue end
            for _, b in pairs(istable(k) and k or {k}) do
                local bone = vm:LookupBone(b)

                if !bone then continue end

                if self:GetVisualLoadAmount() >= i then
                    vm:ManipulateBoneScale(bone, vec1)
                else
                    vm:ManipulateBoneScale(bone, vec0)
                end
            end
        end
    end

    self:DoHeat()

    self:ThinkFreeAim()

    -- if CLIENT then
        -- if !IsValid(ArcCW.InvHUD) then
        --     gui.EnableScreenClicker(false)
        -- end

        -- if self:GetState() != ArcCW.STATE_CUSTOMIZE then
        --     self:CloseCustomizeHUD()
        -- else
        --     self:OpenCustomizeHUD()
        -- end
    -- end

    for i, k in pairs(self.Attachments) do
        if !k.Installed then continue end
        local atttbl = ArcCW.AttachmentTable[k.Installed]

        if atttbl.DamagePerSecond then
            local dmg = atttbl.DamagePerSecond * frametime

            self:DamageAttachment(i, dmg)
        end
    end

    if CLIENT then
        self:DoOurViewPunch()
    end

    if self.Throwing and self:Clip1() == 0 and self:Ammo1() > 0 then
        self:SetClip1(1)
        owner:SetAmmo(self:Ammo1() - 1, self.Primary.Ammo)
    end

    -- self:RefreshBGs()

    if self:GetMagUpIn() != 0 and CurTime() > self:GetMagUpIn() then
        self:ReloadTimed()
        self:SetMagUpIn( 0 )
    end

    if self:HasBottomlessClip() and self:Clip1() != ArcCW.BottomlessMagicNumber then
        self:Unload()
        self:SetClip1(ArcCW.BottomlessMagicNumber)
    elseif !self:HasBottomlessClip() and self:Clip1() == ArcCW.BottomlessMagicNumber then
        self:SetClip1(0)
    end

    -- Performing traces in rendering contexts seem to cause flickering with c_hands that have QC attachments(?)
    -- Since we need to run the trace every tick anyways, do it here instead
    if CLIENT then
        self:BarrelHitWall()
    end

    self:GetBuff_Hook("Hook_Think")

    -- Running this only serverside in SP breaks animation processing and causes CheckpointAnimation to !reset.
    --if SERVER or !game.SinglePlayer() then
        self:ProcessTimers()
    --end

    -- Only reset to idle if we don't need cycle. empty idle animation usually doesn't play nice
    if self:GetNextIdle() != 0 and self:GetNextIdle() <= CurTime() and !self:GetNeedCycle()
            and self:GetHolster_Time() == 0 and self:GetShotgunReloading() == 0 then
        self:SetNextIdle(0)
        self:PlayIdleAnimation(true)
    end

    if self:GetUBGLDebounce() and !owner:KeyDown(IN_RELOAD) then
        self:SetUBGLDebounce( false )
    end
end

local lst = SysTime()

function SWEP:ProcessRecoil()
    local owner = self:GetOwner()
    local ft = (SysTime() - (lst or SysTime())) * GetConVar("host_timescale"):GetFloat()
    local newang = owner:EyeAngles()
    -- local r = self.RecoilAmount -- self:GetNWFloat("recoil", 0)
    -- local rs = self.RecoilAmountSide -- self:GetNWFloat("recoilside", 0)

    local ra = Angle(ang0)

    ra = ra + (self:GetBuff_Override("Override_RecoilDirection", self.RecoilDirection) * self.RecoilAmount * 0.5)
    ra = ra + (self:GetBuff_Override("Override_RecoilDirectionSide", self.RecoilDirectionSide) * self.RecoilAmountSide * 0.5)

    newang = newang - ra

    local rpb = self.RecoilPunchBack
    local rps = self.RecoilPunchSide
    local rpu = self.RecoilPunchUp

    if rpb != 0 then
        self.RecoilPunchBack = math.Approach(rpb, 0, ft * rpb * 10)
    end

    if rps != 0 then
        self.RecoilPunchSide = math.Approach(rps, 0, ft * rps * 5)
    end

    if rpu != 0 then
        self.RecoilPunchUp = math.Approach(rpu, 0, ft * rpu * 5)
    end

    lst = SysTime()
end

function SWEP:InSprint()
    local owner = self:GetOwner()

    local sm = self.SpeedMult * self:GetBuff_Mult("Mult_SpeedMult") * self:GetBuff_Mult("Mult_MoveSpeed")

    sm = math.Clamp(sm, 0, 1)

    local sprintspeed = owner:GetRunSpeed() * sm
    local walkspeed = owner:GetWalkSpeed() * sm

    local curspeed = owner:GetVelocity():Length()

    if TTT2 and owner.isSprinting == true then
        return (owner.sprintProgress or 0) > 0 and owner:KeyDown(IN_SPEED) and !owner:Crouching() and curspeed > walkspeed and owner:OnGround()
    end

    if !owner:KeyDown(IN_SPEED) or !owner:KeyDown(IN_FORWARD+IN_MOVELEFT+IN_MOVERIGHT+IN_BACK) then return false end
    if !owner:OnGround() then return false end
    if owner:Crouching() then return false end
    if curspeed < Lerp(0.5, walkspeed, sprintspeed) then
        -- provide some grace time so changing directions won't immediately exit sprint
        self.LastExitSprintCheck = self.LastExitSprintCheck or CurTime()
        if self.LastExitSprintCheck < CurTime() - 0.25 then
            return false
        end
    else
        self.LastExitSprintCheck = nil
    end

    return true
end

function SWEP:IsTriggerHeld()
    return self:GetOwner():KeyDown(IN_ATTACK) and (self:CanShootWhileSprint() or (!self.Sprinted or self:GetState() != ArcCW.STATE_SPRINT)) and (self:GetHolster_Time() < CurTime()) and !self:GetPriorityAnim()
end

SWEP.LastTriggerTime = 0
SWEP.LastTriggerDuration = 0
function SWEP:GetTriggerDelta(noheldcheck)
    if self.LastTriggerTime <= 0 or (!noheldcheck and !self:IsTriggerHeld()) then return 0 end
    return math.Clamp((CurTime() - self.LastTriggerTime) / self.LastTriggerDuration, 0, 1)
end

function SWEP:DoTriggerDelay()
    local shouldHold = self:IsTriggerHeld()

    local reserve = self:HasBottomlessClip() and self:Ammo1() or self:Clip1()
    if self.LastTriggerTime == -1 or (!self.TriggerPullWhenEmpty and (reserve < self:GetBuff("AmmoPerShot"))) and self:GetNextPrimaryFire() < CurTime() then
        if !shouldHold then
            self.LastTriggerTime = 0 -- Good to fire again
            self.LastTriggerDuration = 0
        end
        return
    end

    if self:GetBurstCount() > 0 and self:GetCurrentFiremode().Mode == 1 then
        self.LastTriggerTime = -1 -- Cannot fire again until trigger released
        self.LastTriggerDuration = 0
    elseif self:GetNextPrimaryFire() < CurTime() and self.LastTriggerTime > 0 and !shouldHold then
        -- Attack key is released. Stop the animation and clear progress
        local anim = self:SelectAnimation("untrigger")
        if anim then
            self:PlayAnimation(anim, self:GetBuff_Mult("Mult_TriggerDelayTime"), true, 0)
        end
        self.LastTriggerTime = 0
        self.LastTriggerDuration = 0
        self:GetBuff_Hook("Hook_OnTriggerRelease")
    elseif self:GetNextPrimaryFire() < CurTime() and self.LastTriggerTime == 0 and shouldHold then
        -- We haven't played the animation yet. Pull it!
        local anim = self:SelectAnimation("trigger")
        self:PlayAnimation(anim, self:GetBuff_Mult("Mult_TriggerDelayTime"), true, 0, nil, nil, true) -- need to overwrite sprint up
        self.LastTriggerTime = CurTime()
        self.LastTriggerDuration = self:GetAnimKeyTime(anim, true) * self:GetBuff_Mult("Mult_TriggerDelayTime")
        self:GetBuff_Hook("Hook_OnTriggerHeld")
    end
end

--addons/[binbon]arccw_modify/lua/weapons/arccw_base/sh_timers.lua:
return gluapack()()
--addons/[binbon]arccw_modify/lua/weapons/arccw_base/sh_ttt.lua:
function SWEP:OnRestore()
end

function SWEP:GetHeadshotMultiplier(victim, dmginfo)
    return 2.5 -- Hey hey hey, don't forget about me!!!
end

function SWEP:IsEquipment()
    return WEPS.IsEquipment(self)
end

SWEP.IsSilent = false

-- The OnDrop() hook is useless for this as it happens AFTER the drop. OwnerChange
-- does not occur when a drop happens for some reason. Hence this thing.
function SWEP:PreDrop()
    if self.Throwing then
        if self:GetGrenadePrimed() then
            self:Throw()
        end
    else
        if SERVER and IsValid(self:GetOwner()) and self.Primary.Ammo != "none" then
            local ammo = self:Ammo1()

            -- Do not drop ammo if we have another gun that uses this type
            for _, w in ipairs(self:GetOwner():GetWeapons()) do
                if IsValid(w) and w != self and w:GetPrimaryAmmoType() == self:GetPrimaryAmmoType() then
                ammo = 0
                end
            end

            self.StoredAmmo = ammo

            if ammo > 0 then
                self:GetOwner():RemoveAmmo(ammo, self.Primary.Ammo)
            end
        end
    end

    net.Start("arccw_togglecustomize")
        net.WriteBool(false)
    net.Send(self:GetOwner())
    self:ToggleCustomizeHUD(false)
end

function SWEP:DampenDrop()
    -- For some reason gmod drops guns on death at a speed of 400 units, which
    -- catapults them away from the body. Here we want people to actually be able
    -- to find a given corpse's weapon, so we override the velocity here and call
    -- this when dropping guns on death.
    local phys = self:GetPhysicsObject()
    if IsValid(phys) then
        phys:SetVelocityInstantaneous(Vector(0,0,-75) + phys:GetVelocity() * 0.001)
        phys:AddAngleVelocity(phys:GetAngleVelocity() * -0.99)
    end
end

SWEP.StoredAmmo = 0

-- Picked up by player. Transfer of stored ammo and such.
function SWEP:Equip(newowner)
    if SERVER then
        if self:IsOnFire() then
            self:Extinguish()
        end

        self.fingerprints = self.fingerprints or {}

        if !table.HasValue(self.fingerprints, newowner) then
            table.insert(self.fingerprints, newowner)
        end
    end

    if SERVER and IsValid(newowner) and self.StoredAmmo > 0 and self.Primary.Ammo != "none" then
        local ammo = newowner:GetAmmoCount(self.Primary.Ammo)
        local given = math.min(self.StoredAmmo, self.Primary.ClipMax - ammo)

        newowner:GiveAmmo( given, self.Primary.Ammo)
        self.StoredAmmo = 0
    end
end

function SWEP:WasBought(buyer)
    if self.TTT_DoNotAttachOnBuy then return end

    for i, k in pairs(self.Attachments) do
        k.RandomChance = 100
    end
    -- if ArcCW.ConVars["ttt_atts"]:GetBool() then
    --     self:NPC_SetupAttachments()
    -- end
end

function SWEP:TTT_PostAttachments()
    self.IsSilent = self:GetBuff_Override("Silencer")

    if !self.IsSilent then
        self.IsSilent = true
    end
end

function SWEP:TTT_Init()
    if engine.ActiveGamemode() != "terrortown" then return end

    if SERVER then
        self.fingerprints = {}
    end

    if self.Throwing then
        self.Primary.ClipMax = 0
    end

    if ArcCW.ConVars["ttt_atts"]:GetBool() then
        if SERVER then
            self:NPC_SetupAttachments()
        end
    elseif !IsValid(self:GetOwner()) then
        -- If attachments aren't randomized, client will not need to ask for att info.
        self.CertainAboutAtts = true
    end

    if self.ForgetDefaultBehavior then return end

    self.Primary.ClipMax = ArcCW.TTTAmmoToClipMax[self.Primary.Ammo] or self.RegularClipSize * 2 or self.Primary.ClipSize * 2

    -- This will overwrite mag reducers, so give it a bit of time
    timer.Simple(0.1, function()
        if !IsValid(self) then return end
        self:SetClip1(self:GetCapacity() or self.RegularClipSize or self.Primary.ClipSize)
        self.Primary.DefaultClip = self.ForceDefaultAmmo or self.ForceDefaultClip or self:GetCapacity()
    end)

    if self.Throwing and self.Primary.Ammo and !self.ForceDefaultClip then
        self.Primary.Ammo = "none"
        self.Primary.DefaultClip = 0
        self:SetClip1(-1)
        self.Singleton = true
    end
end

--- TTT2 uses this to populate custom convars in the equip menu
function SWEP:AddToSettingsMenu(parent)
end
--addons/[binbon]arccw_modify/lua/weapons/arccw_base_nade/shared.lua:
return gluapack()()
--lua/weapons/arccw_fml_karma9.lua:
return gluapack()()
--lua/weapons/arccw_mw2_aa12.lua:
return gluapack()()
--lua/weapons/arccw_mw2_barrett.lua:
SWEP.Base = "arccw_mw2_abase"
SWEP.Spawnable = true
SWEP.Category = "ArcCW - MW2"
SWEP.AdminOnly = false
SWEP.WeaponCamBone = tag_camera

SWEP.PrintName = "Barrett .50cal"
SWEP.Trivia_Class = "Sniper Rifle"
SWEP.Trivia_Desc = "Semi-automatic (single fire)"

SWEP.Slot = 2

SWEP.UseHands = true

SWEP.ViewModel = "models/weapons/arccw/fesiugmw2/c_barrett_1.mdl"
SWEP.MirrorVMWM = true
SWEP.WorldModelOffset = {
    pos = Vector(-7, 3, -6),
    ang = Angle(-10, 0, 180),
    scale = 1.125
}
SWEP.WorldModel = "models/weapons/w_snip_sg550.mdl"
SWEP.ViewModelFOV = 65

SWEP.Damage = 105
SWEP.DamageMin = 105
SWEP.Range = 4000 * 0.025 -- in METRES
SWEP.Penetration = 22

SWEP.ChamberSize = 0
SWEP.Primary.ClipSize = 10 -- DefaultClip is automatically set.
SWEP.ExtendedClipSize = 15
SWEP.ReducedClipSize = 5

SWEP.VisualRecoilMult = 0
SWEP.Recoil = 2
SWEP.RecoilSide = 5

SWEP.AccuracyMOA = 0.06 -- accuracy in Minutes of Angle. There are 60 MOA in a degree.
SWEP.HipDispersion = 777 -- inaccuracy added by hip firing.
SWEP.MoveDispersion = 267

SWEP.Delay = 0.05 -- 60 / RPM.
SWEP.Num = 1 -- number of shots per trigger pull.
SWEP.Firemodes = {
    {
        Mode = 1,
    },
    {
        Mode = 0
    }
}

SWEP.NPCWeaponType = {"weapon_crossbow"}
SWEP.NPCWeight = 100

SWEP.Primary.Ammo = "SniperPenetratedRound" -- what ammo type the gun uses

SWEP.ShootVol = 140 -- volume of shoot sound
SWEP.ShootPitch = 100 -- pitch of shoot sound

SWEP.ShootSound =			"weapons/fesiugmw2/fire/barrett.wav"
--SWEP.DistantShootSound =	"weapons/fesiugmw2/fire_distant/cheytac_mp.wav"
SWEP.ShootSoundSilenced =	"weapons/fesiugmw2/fire/sniper_sil.wav"

SWEP.MuzzleEffect = "muzzleflash_6"
SWEP.ShellModel = "models/shells/shell_338mag.mdl"
SWEP.ShellPitch = 80
SWEP.ShellScale = 1
SWEP.ShellRotateAngle = Angle(0, 90, 0)

SWEP.MuzzleEffectAttachment = 1 -- which attachment to put the muzzle on
SWEP.CaseEffectAttachment = 2 -- which attachment to put the case effect on

SWEP.SpeedMult = 1
SWEP.SightedSpeedMult = 0.40
SWEP.SightTime = 0.4 / 1.25

SWEP.IronSightStruct = {
    Pos = Vector(-3.778, -3, 1.1),
    Ang = Angle(2.7, 0, 0),
    ViewModelFOV = 65 / 1.3,
    Magnification = 1.3,
}

SWEP.HoldtypeHolstered = "passive"
SWEP.HoldtypeActive = "ar2"
SWEP.HoldtypeSights = "rpg"

SWEP.AnimShoot = ACT_HL2MP_GESTURE_RANGE_ATTACK_SHOTGUN

SWEP.ActivePos = Vector(0, 0, 1)
SWEP.ActiveAng = Angle(0, 0, 0)

SWEP.HolsterPos = Vector(1, 0, 1)
SWEP.HolsterAng = Angle(-10, 12, 0)

SWEP.SprintPos = Vector(0, 0, 1)
SWEP.SprintAng = Angle(0, 0, 0)

SWEP.CustomizePos = Vector(9.824, 2, -2.897)
SWEP.CustomizeAng = Angle(12.149, 30.547, 0)

SWEP.BarrelOffsetSighted = Vector(0, 0, -1)
SWEP.BarrelOffsetHip = Vector(2, 0, -2)

SWEP.AttachmentElements = {
    ["wepcamo-desert"]		= { VMSkin = 1 },
    ["wepcamo-arctic"]		= { VMSkin = 2 },
    ["wepcamo-woodland"]	= { VMSkin = 3 },
    ["wepcamo-digital"]		= { VMSkin = 4 },
    ["wepcamo-urban"]		= { VMSkin = 5 },
    ["wepcamo-bluetiger"]	= { VMSkin = 6 },
    ["wepcamo-redtiger"]	= { VMSkin = 7 },
    ["wepcamo-fall"]		= { VMSkin = 8 },
    ["wepcamo-whiteout"]	= { VMSkin = 9 },
    ["wepcamo-blackout"]        = { VMSkin = 10 },
    ["wepcamo-bushdweller"]     = { VMSkin = 11 },
    ["wepcamo-thunderstorm"]    = { VMSkin = 12 },
}

SWEP.BarrelLength = 50

SWEP.ExtraSightDist = 5
SWEP.Bipod_Integral = false

SWEP.Attachments = {
    {
        PrintName = "Optic",
        DefaultAttName = "Iron Sights",
        Slot = {"optic_sniper","optic"},
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(3, 0, 4.3),
            vang = Angle(0, 0, 0),
        },      
    },
    {
        PrintName = "Muzzle",
        DefaultAttName = "Standard Muzzle",
        Slot = "muzzle",
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(33, 0, 1.6),
            vang = Angle(0, 0, 0),
            wpos = Vector(26.648, 0.782, -8.042),
            wang = Angle(-9.79, 0, 180)
        },
		VMScale = Vector(2, 1.25, 1.25)
    },
    {
        PrintName = "Tactical",
        Slot = "tac",
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(18, 0, 2.6),
            vang = Angle(0, 0, 180),
            wpos = Vector(15.625, -0.253, -6.298),
            wang = Angle(-8.829, -0.556, 90)
        },
        InstalledEles = {"nolaser"},
    },
    {
        PrintName = "Fire Group",
        Slot = "fcg",
        DefaultAttName = "Standard FCG"
    },
    {
        PrintName = "Ammo Type",
        Slot = "ammo_bullet"
    },
    {
        PrintName = "Perk",
        Slot = "perk"
    },
    {
        PrintName = "Camouflage",
        DefaultAttName = "None",
        Slot = "mw2_wepcamo",
        FreeSlot = true,
    },
    {
        PrintName = "Charm",
        Slot = "charm",
        FreeSlot = true,
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(4, -0.75, 1.5),
            vang = Angle(0, 0, 0),
            wpos = Vector(9.625, 1.253, -3.298),
            wang = Angle(0, 0, 180)
        },
    },
}

SWEP.Animations = {
    ["idle"] = {
        Source = "idle",
        Time = 101/30
    },
    ["enter_sprint"] = {
        Source = "sprint_in",
        Time = 10/30
    },
    ["idle_sprint"] = {
        Source = "sprint_loop",
        Time = 30/40
    },
    ["exit_sprint"] = {
        Source = "sprint_out",
        Time = 10/30
    },
    ["draw"] = {
        Source = "pullout",
        Time = 40/30,
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0.25,
        SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
    },
    ["holster"] = {
        Source = "putaway",
        Time = 36/30,
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0.25,
    },
    ["fire"] = {
        Source = "fire",
        Time = 11/30,
    },
    ["fire_iron"] = {
        Source = "fire_ads",
        Time = 5/30,
    },
    ["reload"] = {
        Source = "reload",
        Time = 94/24,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_m82_reload_lift_v1.wav", 		t = 0},
						{s = "weapons/fesiugmw2/foley/wpfoly_m82_reload_clipout_v1.wav", 	t = 18/24},
						{s = "weapons/fesiugmw2/foley/wpfoly_m82_reload_clipin_v1.wav", 	t = 67/24},
					},
        Checkpoints = {18, 47},
        FrameRate = 30,
        LHIK = false,
        LHIKIn = 0.5,
        LHIKOut = 0.5,
    },
    ["reload_empty"] = {
        Source = "reload_empty",
        Time = 102/24,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_m82_reload_lift_v1.wav", 		t = 0},
						{s = "weapons/fesiugmw2/foley/wpfoly_m82_reload_clipout_v1.wav", 	t = 18/24},
						{s = "weapons/fesiugmw2/foley/wpfoly_m82_reload_clipin_v1.wav", 	t = 64/24},
						{s = "weapons/fesiugmw2/foley/wpfoly_m82_reload_chamber_v1.wav", 	t = 87/24},
					},
        Checkpoints = {18, 54, 81, 99},
        FrameRate = 30,
        LHIK = false,
        LHIKIn = 0.5,
        LHIKOut = 0.5,
    },
}
--lua/weapons/arccw_mw2_deagle.lua:
SWEP.Base = "arccw_mw2_abase"
SWEP.Spawnable = true
SWEP.Category = "ArcCW - MW2"
SWEP.AdminOnly = false
SWEP.WeaponCamBone = tag_camera

SWEP.PrintName = "Desert Eagle"
SWEP.Trivia_Class = "Handgun"
SWEP.Trivia_Desc = "Semi-automatic (single fire)"

SWEP.Slot = 1

SWEP.UseHands = true

SWEP.ViewModel = "models/weapons/arccw/fesiugmw2/c_desert_eagle_3.mdl"
SWEP.MirrorVMWM = true
SWEP.WorldModelOffset = {
    pos = Vector(-9, 3, -4),
    ang = Angle(-7, 0, 180),
    scale = 1.125
}
SWEP.WorldModel = "models/weapons/w_pist_deagle.mdl"
SWEP.ViewModelFOV = 65

SWEP.Damage = 50
SWEP.DamageMin = 30
SWEP.Range = 1200 * 0.025  -- GAME UNITS * 0.025 = METRES
SWEP.Penetration = 12
SWEP.DamageType = DMG_BULLET
SWEP.ShootEntity = nil -- entity to fire, if any


SWEP.ChamberSize = 0
SWEP.Primary.ClipSize = 7 -- DefaultClip is automatically set.
SWEP.ExtendedClipSize = 10
SWEP.ReducedClipSize = 4

SWEP.VisualRecoilMult = 0
SWEP.Recoil = 1
SWEP.RecoilSide = 1

SWEP.Delay = 0.079 -- 60 / RPM.
SWEP.Num = 1 -- number of shots per trigger pull.
SWEP.Firemodes = {
    {
        Mode = 1,
    },
    {
        Mode = 0,
    },
}

SWEP.NPCWeaponType = {"weapon_357"}
SWEP.NPCWeight = 100

SWEP.AccuracyMOA = 5 -- accuracy in Minutes of Angle. There are 60 MOA in a degree.
SWEP.HipDispersion = 250 -- inaccuracy added by hip firing.
SWEP.MoveDispersion = 100

SWEP.Primary.Ammo = "357" -- what ammo type the gun uses

SWEP.ShootVol = 130 -- volume of shoot sound
SWEP.ShootPitch = 115 -- pitch of shoot sound

SWEP.ShootSound =			"weapons/fesiugmw2/fire/deagle.wav"
--SWEP.DistantShootSound =	"weapons/fesiugmw2/fire_distant/deagle.wav"
SWEP.ShootSoundSilenced =	"weapons/fesiugmw2/fire/usp45_sil.wav"

SWEP.MuzzleEffect = "muzzleflash_pistol_deagle"
SWEP.ShellModel = "models/shells/shell_9mm.mdl"
SWEP.ShellScale = 1
SWEP.ShellRotateAngle = Angle(0, 90, 0)

SWEP.MuzzleEffectAttachment = 1 -- which attachment to put the muzzle on
SWEP.CaseEffectAttachment = 2 -- which attachment to put the case effect on

SWEP.SpeedMult = 1
SWEP.SightedSpeedMult = 0.8
SWEP.SightTime = 0.125


SWEP.BulletBones = { -- the bone that represents bullets in gun/mag
    -- [0] = "bulletchamber",
    -- [1] = "bullet1"
}

SWEP.IronSightStruct = {
    Pos = Vector(-1.554, 2.392, 0.9),
    Ang = Angle(-0.347, 0, 0),
    ViewModelFOV = 65,
    Magnification = 1,
}

SWEP.HoldtypeHolstered = "normal"
SWEP.HoldtypeActive = "revolver"
SWEP.HoldtypeSights = "revolver"

SWEP.AnimShoot = ACT_HL2MP_GESTURE_RANGE_ATTACK_REVOLVER

SWEP.ActivePos = Vector(0, 0, 1)
SWEP.ActiveAng = Angle(0, 0, 0)

SWEP.CustomizePos = Vector(4, -3, -1)
SWEP.CustomizeAng = Angle(10, 19, 0)

SWEP.CrouchPos = Vector(-2.764, -0.927, -0.202)
SWEP.CrouchAng = Angle(1.12, -1, -21.444)

SWEP.HolsterPos = Vector(1, 0, 1)
SWEP.HolsterAng = Angle(-10, 12, 0)

SWEP.SprintPos = Vector(0, 0, 1)
SWEP.SprintAng = Angle(0, 0, 0)

SWEP.BarrelOffsetSighted = Vector(0, 0, -1)
SWEP.BarrelOffsetHip = Vector(2, 0, -2)

SWEP.BarrelLength = 18

SWEP.ExtraSightDist = 15

-----[ Tactical knife sheet ]------
	SWEP.CanBash				= true -- Tac knife will save us
	--SWEP.MeleeDamage			= 100
	--SWEP.MeleeRange				= 16
	--SWEP.MeleeDamageType		= DMG_CLUB
	--SWEP.MeleeTime				= 0.8
	SWEP.MeleeGesture			= ACT_HL2MP_GESTURE_RANGE_ATTACK_KNIFE
	--SWEP.MeleeAttackTime		= 0.079
	SWEP.MeleeMissSound			= ""
	SWEP.MeleeHitSound			= "MW2Common.Melee.HitWorld"
	SWEP.MeleeHitNPCSound		= "MW2Common.Melee.HitFleshy_Slice"

SWEP.AttachmentElements = {
    ["nolaser"] = {
        VMBodygroups = {{ind = 2, bg = 1}},
        WMBodygroups = {},
    },
    ["skin_gold"] = {
        VMBodygroups = {{ind = 0, bg = 1}},
        WMBodygroups = {},
    },
    ["altirons"] = {
        Override_IronSightStruct = {
            Pos = Vector(-1.701, -2.346, -0.1),
            Ang = Angle(-0.347, 0, 0),
            ViewModelFOV = 65,
            Magnification = 1,
        },
        Override_AutosolveSourceSeq = "idle_knife",
        VMBodygroups = {{ind = 1, bg = 1}},
    },
}

SWEP.Attachments = {
    {
        PrintName = "Optic",
        DefaultAttName = "Iron Sights",
        Slot = "optic_lp",
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(0, 0, 0),
            vang = Angle(0, 0, 0),
        },
        SlideAmount = {
            vmin = Vector(3.2, 0, 1.7),
            vmax = Vector(5.5, 0, 1.7),
        },
        ExcludeFlags = {"cantuseshitinakimboyet"},
    },
    {
        PrintName = "Muzzle",
        DefaultAttName = "Standard Muzzle",
        Slot = "muzzle",
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(6.2, 0, 1),
            vang = Angle(0, 0, 0),
            wpos = Vector(26.648, 0.782, -8.042),
            wang = Angle(-9.79, 0, 180)
        },
        ExcludeFlags = {"cantuseshitinakimboyet"},
    },
    {
        PrintName = "Underbarrel",
		Slot = {"foregrip_pistol", "style_pistol", "mw2_tacknife"},
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(1.9, 0, -0.5),
            vang = Angle(0, 0, 0),
            wpos = Vector(14.329, 0.602, -4.453),
            wang = Angle(-10.216, 0, 180)
        },
        InstalledEles = {"nolaser"},
        MergeSlots = {9},
    },
    {
        PrintName = "Tactical",
        Slot = "tac",
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(4.4, 0, 0),
            vang = Angle(0, 0, 0),
        },
        InstalledEles = {"nolaser"},
    },
    {
        PrintName = "Fire Group",
        Slot = "fcg",
        DefaultAttName = "Standard FCG",
        ExcludeFlags = {"cantuseshitinakimboyet"},
    },
    {
        PrintName = "Ammo Type",
        Slot = "ammo_bullet"
    },
    {
        PrintName = "Perk",
        Slot = "perk"
    },
    {
        PrintName = "Skin",
        Slot = {"skin_mw2deagle"},
        DefaultAttName = "Two-Tone",
        FreeSlot = true,
		Hidden = false,
		DefaultAttIcon = Material("entities/acwatt_deagle_mw2.png", "smooth")
    },
    {
        PrintName = "Akimbotest",
        DefaultAttName = "No LH",
        Slot = "akimbotest",
        Bone = "tag_view",
        Offset = {
            vpos = Vector(0, 0, 0),
            vang = Angle(0, 0, 0),
        },
        Hidden = true,
    },
    {
        PrintName = "Charm",
        Slot = "charm",
        FreeSlot = true,
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(3, -0.4, 0.5),
            vang = Angle(0, 0, 0),
            wpos = Vector(9.625, 2.5, -3.75),
            wang = Angle(0, 0, 180)
        },
    },
}

SWEP.Hook_SelectReloadAnimation = function(wep, anim)
    if wep.Attachments[3].Installed == "mw2_tacticalknife" then
        return anim .. "_knife"
    elseif wep.Attachments[9].Installed then
        return anim .. "_akimbo_right"
    end
end
SWEP.Hook_TranslateAnimation = function(wep, anim)
    if wep.Attachments[3].Installed == "mw2_tacticalknife" then
        return anim .. "_knife"
    elseif wep.Attachments[9].Installed then
        return anim .. "_akimbo_right"
    end
end

SWEP.Animations = {
    ["idle"] = {
        Source = "idle",
        Time = 2/30
    },
    ["idle_empty"] = {
        Source = "idle_empty",
        Time = 2/30
    },
    ["enter_sprint"] = {
        Source = "sprint_in",
        Time = 11/30
    },
    ["idle_sprint"] = {
        Source = "sprint_loop",
        Time = 31/40
    },
    ["exit_sprint"] = {
        Source = "sprint_out",
        Time = 11/30
    },
    ["draw"] = {
        Source = "pullout",
        SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
        Time = 29/30 /4,
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0.35,
    },
    ["holster"] = {
        Source = "putaway",
        Time = 33/30 /4,
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0.35,
    },
    ["fire"] = {
        Source = "fire",
        Time = 15/30,
        ShellEjectAt = 0,
    },
    ["fire_iron"] = {
        Source = "fire_ads",
        Time = 15/30,
        ShellEjectAt = 0,
    },
    ["fire_empty"] = {
        Source = "fire_last",
        Time = 15/30,
        ShellEjectAt = 0,
    },
    ["fire_iron_empty"] = {
        Source = "fire_last",
        Time = 15/30,
        ShellEjectAt = 0,
    },
    ["reload"] = {
        Source = "reload",
        Time = 58/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_de50_reload_clipout_v1.wav", 	t = 10/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_de50_reload_clipin_v1.wav", 	t = 39/30},
					},
        Checkpoints = {24, 97},
        FrameRate = 30,
        LHIK = true,
        LHIKIn = 0.5,
        LHIKOut = 0.4,
    },
    ["reload_empty"] = {
        Source = "reload_empty",
        Time = 62/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_de50_reload_clipout_v1.wav", 	t = 10/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_de50_reload_clipin_v1.wav", 	t = 39/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_de50_reload_chamber_v1.wav", 	t = 47/30},
					},
        Checkpoints = {24, 97, 131},
        FrameRate = 37,
        LHIK = true,
        LHIKIn = 0.5,
        LHIKOut = 0.6,
    },
---------------------------------------------------------
--------- LE TACTICAL KNIFE XDXDXDXD---------------------
---------------------------------------------------------
		["idle_knife"] = {
			Source = "idle_knife",
			Time = 300/30
		},
		["idle_empty_knife"] = {
			Source = "idle_knife",
			Time = 300/30
		},
		["enter_sprint_knife"] = {
			Source = "sprint_in_knife",
			Time = 10/30
		},
		["idle_sprint_knife"] = {
			Source = "sprint_loop_knife",
			Time = 30/40
		},
		["exit_sprint_knife"] = {
			Source = "sprint_out_knife",
			Time = 10/30
		},
		["fire_knife"] = {
			Source = "fire_knife",
			Time = 15/30,
			ShellEjectAt = 0,
		},
		["fire_iron_knife"] = {
			Source = "fire_ads_knife",
			Time = 15/30,
			ShellEjectAt = 0,
		},
		["fire_empty_knife"] = {
			Source = "fire_knife",
			Time = 15/30,
			ShellEjectAt = 0,
		},
		["fire_iron_empty_knife"] = {
			Source = "fire_knife",
			Time = 15/30,
			ShellEjectAt = 0,
		},
		["draw_knife"] = {
			Source = "pullout_knife",
			SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
			Time = 29/30 /4,
			LHIK = true,
			LHIKIn = 0,
			LHIKOut = 0.35,
		},
		["holster_knife"] = {
			Source = "putaway_knife",
			Time = 33/30 /4,
			LHIK = true,
			LHIKIn = 0,
			LHIKOut = 0.35,
		},
		["reload_knife"] = {
			Source = "reload_knife",
			Time = 58/30,
			TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
			SoundTable = {
							{s = "weapons/fesiugmw2/foley/wpfoly_de50_reload_clipout_v1.wav", 	t = 10/30},
							{s = "weapons/fesiugmw2/foley/wpfoly_de50_reload_clipin_v1.wav", 	t = 39/30},
						},
			Checkpoints = {24, 97},
			FrameRate = 30,
			LHIK = true,
			LHIKIn = 0.5,
			LHIKOut = 0.4,
		},
		["reload_empty_knife"] = {
			Source = "reload_empty_knife",
			Time = 62/30,
			TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
			SoundTable = {
							{s = "weapons/fesiugmw2/foley/wpfoly_de50_reload_clipout_v1.wav", 	t = 10/30},
							{s = "weapons/fesiugmw2/foley/wpfoly_de50_reload_clipin_v1.wav", 	t = 39/30},
							{s = "weapons/fesiugmw2/foley/wpfoly_de50_reload_chamber_v1.wav", 	t = 47/30},
						},
			Checkpoints = {24, 97, 131},
			FrameRate = 37,
			LHIK = true,
			LHIKIn = 0.5,
			LHIKOut = 0.6,
		},
		["bash_knife"] = {
			Source = "melee_knife",
			SoundTable = {{s = "MW2Common.Melee.Swing", 		t = 0}},
			Time = 97/120 / 1.6, -- damn you universal
			LHIK = true,
		},

---------------------------------------------------------
--------- LE akimbo gun ---------------------
---------------------------------------------------------
    ["idle_akimbo_right"] = {
        Source = "idle_akimbo_right",
        Time = 200/30
    },
    ["idle_empty_akimbo_right"] = {
        Source = "idle_empty_akimbo_right",
        Time = 200/30
    },
    ["enter_sprint_akimbo_right"] = {
        Source = "sprint_in_akimbo_right",
        Time = 11/30
    },
    ["idle_sprint_akimbo_right"] = {
        Source = "sprint_loop_akimbo_right",
        Time = 31/40
    },
    ["exit_sprint_akimbo_right"] = {
        Source = "sprint_out_akimbo_right",
        Time = 11/30
    },
    ["draw_akimbo_right"] = {
        Source = "pullout_akimbo_right",
        SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
        Time = 30/30 /4,
    },
    ["holster_akimbo_right"] = {
        Source = "putaway_akimbo_right",
        Time = 34/30 /4,
    },
    ["fire_akimbo_right"] = {
        Source = "fire_akimbo_right",
        Time = 16/30,
        ShellEjectAt = 0,
    },
    ["fire_empty_akimbo_right"] = {
        Source = "fire_last_akimbo_right",
        Time = 16/30,
        ShellEjectAt = 0,
    },
    ["reload_akimbo_right"] = {
        Source = "reload_akimbo_right",
        Time = 58/30,
        MinProgress = 1.429,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_de50_reload_clipout_v1.wav", 	t = 10/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_de50_reload_clipin_v1.wav", 	t = 39/30},
					},
    },
    ["reload_empty_akimbo_right"] = {
        Source = "reload_empty_akimbo_right",
        Time = 63/30,
        MinProgress = 1.429,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_de50_reload_clipout_v1.wav", 	t = 10/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_de50_reload_clipin_v1.wav", 	t = 39/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_de50_reload_chamber_v1.wav", 	t = 48/30},
					},
    },
}
--lua/weapons/arccw_mw2_famas.lua:
SWEP.Base = "arccw_mw2_abase"
SWEP.Spawnable = true
SWEP.Category = "ArcCW - MW2"
SWEP.AdminOnly = false
SWEP.CamAttachment = 3

SWEP.PrintName = "FAMAS"
SWEP.Trivia_Class = "Assault Rifle"
SWEP.Trivia_Desc = "3 round burst."

SWEP.Slot = 2

SWEP.UseHands = true

SWEP.ViewModel = "models/weapons/arccw/fesiugmw2_2/c_famas_1.mdl"
SWEP.MirrorVMWM = true
SWEP.WorldModelOffset = {
    pos = Vector(-6, 3, -5),
    ang = Angle(-10, 0, 180),
    scale = 1.25
}
SWEP.WorldModel = "models/weapons/w_rif_famas.mdl"
SWEP.ViewModelFOV = 65

SWEP.Damage = 40
SWEP.DamageMin = 30
SWEP.Range = 2500 * 0.025  -- GAME UNITS * 0.025 = METRES
SWEP.Penetration = 7
SWEP.DamageType = DMG_BULLET
SWEP.ShootEntity = nil -- entity to fire, if any


SWEP.ChamberSize = 0
SWEP.Primary.ClipSize = 30 -- DefaultClip is automatically set.
SWEP.ExtendedClipSize = 45
SWEP.ReducedClipSize = 15

SWEP.VisualRecoilMult = 0
SWEP.Recoil = 0.4
SWEP.RecoilSide = 0.3
SWEP.RecoilRise = 0.1

SWEP.Delay = 0.059 -- 60 / RPM.
SWEP.Num = 1 -- number of shots per trigger pull.
SWEP.Firemodes = {
    {
        Mode = -3,
		RunawayBurst = true,
		PostBurstDelay = 0.2,
    },
    {
        Mode = 1,
    },
    {
        Mode = 0
    }
}

SWEP.NPCWeaponType = {"weapon_ar2", "weapon_smg1"}
SWEP.NPCWeight = 100

SWEP.AccuracyMOA = 2.5 -- accuracy in Minutes of Angle. There are 60 MOA in a degree.
SWEP.HipDispersion = 500 -- inaccuracy added by hip firing.
SWEP.MoveDispersion = 150

SWEP.Primary.Ammo = "smg1" -- what ammo type the gun uses

SWEP.ShootVol = 110 -- volume of shoot sound
SWEP.ShootPitch = 100 -- pitch of shoot sound

SWEP.ShootSound =			"weapons/fesiugmw2/fire/famas.wav"
SWEP.ShootMechSound =       ArcCW_MW2_Mech
--SWEP.DistantShootSound =	"weapons/fesiugmw2/fire_distant/famas.wav"
SWEP.ShootSoundSilenced =	"weapons/fesiugmw2/fire/m4_sil.wav"

SWEP.MuzzleEffect = "muzzleflash_4"
SWEP.ShellModel = "models/shells/shell_556.mdl"
SWEP.ShellPitch = 95
SWEP.ShellScale = 1

SWEP.MuzzleEffectAttachment = 1 -- which attachment to put the muzzle on
SWEP.CaseEffectAttachment = 2 -- which attachment to put the case effect on

SWEP.SpeedMult = 0.95
SWEP.SightedSpeedMult = 0.38
SWEP.SightTime = 0.25
SWEP.ShellRotateAngle = Angle(0, 90, 0)

SWEP.BulletBones = { -- the bone that represents bullets in gun/mag
    -- [0] = "bulletchamber",
    -- [1] = "bullet1"
}

SWEP.IronSightStruct = {
    Pos = Vector(-3.04, -4.512, -0.179),
    Ang = Angle(0, 0, 0),
    ViewModelFOV = 65 / 1.3,
    Magnification = 1.3,
}

SWEP.HoldtypeHolstered = "passive"
SWEP.HoldtypeActive = "ar2"
SWEP.HoldtypeSights = "rpg"

SWEP.AnimShoot = ACT_HL2MP_GESTURE_RANGE_ATTACK_AR2

SWEP.ActivePos = Vector(0, 0, 1)
SWEP.ActiveAng = Angle(0, 0, 0)

SWEP.CustomizePos = Vector(10.479, 0, -1.321)
SWEP.CustomizeAng = Angle(18.2, 39.4, 14.8)

SWEP.HolsterPos = Vector(1, 0, 1)
SWEP.HolsterAng = Angle(-10, 12, 0)

SWEP.SprintPos = Vector(0, 0, 1)
SWEP.SprintAng = Angle(0, 0, 0)

SWEP.BarrelOffsetSighted = Vector(0, 0, -1)
SWEP.BarrelOffsetHip = Vector(2, 0, -2)

SWEP.BarrelLength = 27

SWEP.AttachmentElements = {
    ["nors"] = {
        VMBodygroups = {{ind = 1, bg = 1}},
        WMBodygroups = {},
    },
    ["wepcamo-desert"]		= { VMSkin = 1 },
    ["wepcamo-arctic"]		= { VMSkin = 2 },
    ["wepcamo-woodland"]	= { VMSkin = 3 },
    ["wepcamo-digital"]		= { VMSkin = 4 },
    ["wepcamo-urban"]		= { VMSkin = 5 },
    ["wepcamo-bluetiger"]	= { VMSkin = 6 },
    ["wepcamo-redtiger"]	= { VMSkin = 7 },
    ["wepcamo-fall"]		= { VMSkin = 8 },
    ["wepcamo-whiteout"]	= { VMSkin = 9 },
    ["wepcamo-blackout"]        = { VMSkin = 10 },
    ["wepcamo-bushdweller"]     = { VMSkin = 11 },
    ["wepcamo-thunderstorm"]    = { VMSkin = 12 },
            ["mw2_ubgl_m203"] = {
                VMBodygroups = {{ind = 2, bg = 1}},
            },
            ["mw2_ubgl_masterkey"] = {
                VMBodygroups = {{ind = 2, bg = 2}},
            },
}

SWEP.ExtraSightDist = 5

SWEP.Attachments = {
    {
        PrintName = "Optic",
        DefaultAttName = "Iron Sights",
        Slot = "optic",
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(0.668, 0, 4.098),
            vang = Angle(0, 0, 0),
        },
        InstalledEles = {"nors"},
    },
    {
        PrintName = "Muzzle",
        DefaultAttName = "Standard Muzzle",
        Slot = "muzzle",
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(8.9, 0, 1.3),
            vang = Angle(0, 0, 0),
        },
		WMScale = Vector(1, 1, 1),
        InstalledEles = {"nomuzzle"},
    },
    {
        PrintName = "Underbarrel",
        Slot = {"foregrip", "ubgl", "bipod", "mw2_ubgl"},
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(18.427, 0, -1.04),
            vang = Angle(0, 0, 0),
        },
        SlideAmount = {
            vmin = Vector(3.748, 0, -0.04),
            vmax = Vector(7.427, 0, -0.04),
        },
        InstalledEles = {"nogrip"},
    },
    {
        PrintName = "Tactical",
        Slot = "tac",
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(12.5, -1, 2.25),
            vang = Angle(0, 0, 90),
            wpos = Vector(15.625, -0.253, -6.298),
            wang = Angle(-8.829, -0.556, 90)
        },
    },
    {
        PrintName = "Fire Group",
        Slot = "fcg",
        DefaultAttName = "Standard FCG"
    },
    {
        PrintName = "Ammo Type",
        Slot = "ammo_bullet"
    },
    {
        PrintName = "Perk",
        Slot = "perk"
    },
    {
        PrintName = "Camouflage",
        DefaultAttName = "None",
        Slot = "mw2_wepcamo",
        FreeSlot = true,
    },
    {
        PrintName = "Charm",
        Slot = "charm",
        FreeSlot = true,
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(1, -0.6, 0.4),
            vang = Angle(0, 0, 0),
            wpos = Vector(9.625, 1.5, -4),
            wang = Angle(0, 0, 180)
        },
    },
}



SWEP.Hook_TranslateAnimation = function(wep, anim)
	local attached = wep.Attachments[3].Installed
	
	-- m203 is 1, masterkey is 2, fgrip is 3
	local attthing
		if 		attached == "mw2_ubgl_m203" 		then attthing = 1
		elseif 	attached == "mw2_ubgl_masterkey" 	then attthing = 2
		else 											 attthing = 0
	end
	
	-- when entering ubgl
	if anim == "enter_ubgl" then
		if attthing == 1 then
			return "switch2_alt_m203"
		elseif attthing == 2 then
			return "switch2_alt_masterkey"
		end
	elseif anim == "exit_ubgl" then
		if attthing == 1 then
			return "switch2_gun_m203"
		elseif attthing == 2 then
			return "switch2_gun_masterkey"
		end
	end
	
    if attthing == 1 and wep:GetInUBGL() then
        return "alt_" .. anim .. "_m203"
		elseif attthing == 1 then
			return anim .. "_m203"
		
	elseif attthing == 2 and wep:GetInUBGL() then
        return "alt_" .. anim .. "_masterkey"
		elseif attthing == 2 then
			return anim .. "_masterkey"
		
    end
end

SWEP.Animations = {
		["enter_ubgl"] = {
			Source = "idle",
			Time = 0/30
		},
		["exit_ubgl"] = {
			Source = "idle",
			Time = 0/30
		}, 						-- Fuck you.
    ["idle"] = {
        Source = "idle",
        Time = 1/30
    },
    ["enter_sprint"] = {
        Source = "sprint_in",
        Time = 10/30
    },
    ["idle_sprint"] = {
        Source = "sprint_loop",
        Time = 30/40
    },
    ["exit_sprint"] = {
        Source = "sprint_out",
        Time = 10/30
    },
    ["draw"] = {
        Source = "pullout",
        Time = 25/30,
        SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0,
    },
    ["holster"] = {
        Source = "putaway",
        Time = 25/30,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0,
    },
    ["fire"] = {
        Source = "fire",
        Time = 7/30,
        ShellEjectAt = 0,
    },
    ["fire_iron"] = {
        Source = "fire_ads",
        Time = 7/30,
        ShellEjectAt = 0,
    },
    ["reload"] = {
        Source = "reload",
        Time = 83/30,
        MinProgress = 2.059,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_famas_reload_lift_v1.wav", 		t = 0},
						{s = "weapons/fesiugmw2/foley/wpfoly_famas_reload_clipout_v1.wav", 	t = 21/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_famas_reload_clipin_v1.wav", 	    t = 63/30},
					},
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0.3,
    },
    ["reload_empty"] = {
        Source = "reload_empty",
        Time = 99/30,
        MinProgress = 2.059,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_famas_reload_lift_v1.wav", 		t = 0},
						{s = "weapons/fesiugmw2/foley/wpfoly_famas_reload_clipout_v1.wav", 	t = 21/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_famas_reload_clipin_v1.wav", 	    t = 61/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_famas_reload_chamber_v1.wav",		t = 78/30},
					},
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0.3,
    },
------------------------------------------------
------ Here lies M203 ANIMATIONS ... AWESOME ---
------------------------------------------------
    ["idle_m203"] = {
        Source = "idle_m203",
        Time = 1/30
    },
    ["enter_sprint_m203"] = {
        Source = "sprint_in_m203",
        Time = 10/30
    },
    ["idle_sprint_m203"] = {
        Source = "sprint_loop_m203",
        Time = 30/40
    },
    ["exit_sprint_m203"] = {
        Source = "sprint_out_m203",
        Time = 10/30
    },
    ["draw_m203"] = {
        Source = "pullout_m203",
        Time = 26/30,
        SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0,
    },
    ["holster_m203"] = {
        Source = "putaway_m203",
        Time = 25/30,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0,
    },
    ["fire_m203"] = {
        Source = "fire_m203",
        Time = 7/30,
        ShellEjectAt = 0,
    },
    ["fire_iron_m203"] = {
        Source = "fire_ads_m203",
        Time = 7/30,
        ShellEjectAt = 0,
    },
    ["reload_m203"] = {
        Source = "reload_m203",
        Time = 83/30,
        MinProgress = 2.059,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_famas_reload_lift_v1.wav", 		t = 0},
						{s = "weapons/fesiugmw2/foley/wpfoly_famas_reload_clipout_v1.wav", 	t = 21/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_famas_reload_clipin_v1.wav", 	    t = 63/30},
					},
        LHIK = true,
        LHIKIn = 0.5,
        LHIKOut = 0.5,
    },
    ["reload_empty_m203"] = {
        Source = "reload_empty_m203",
        Time = 99/30,
        MinProgress = 2.059,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_famas_reload_lift_v1.wav", 		t = 0},
						{s = "weapons/fesiugmw2/foley/wpfoly_famas_reload_clipout_v1.wav", 	t = 21/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_famas_reload_clipin_v1.wav", 	    t = 61/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_famas_reload_chamber_v1.wav",		t = 78/30},
					},
        LHIK = true,
        LHIKIn = 0.5,
        LHIKOut = 0.6,
    },
------------------------------------------------
------ Here lies M203 IN THE ANIMATIONS........... ... AWESOME ---
------------------------------------------------
    ["alt_idle_m203"] = {
        Source = "alt_idle_m203",
        Time = 1/30
    },
    ["alt_enter_sprint_m203"] = {
        Source = "alt_sprint_in_m203",
        Time = 10/30
    },
    ["alt_idle_sprint_m203"] = {
        Source = "alt_sprint_loop_m203",
        Time = 30/40
    },
    ["alt_exit_sprint_m203"] = {
        Source = "alt_sprint_out_m203",
        Time = 10/30
    },
    ["alt_draw_m203"] = {
        Source = "alt_pullout_m203",
        Time = 35/30,
        SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
    },
    ["alt_holster_m203"] = {
        Source = "alt_putaway_m203",
        Time = 25/30,
    },
    ["alt_fire_m203"] = {
        Source = "alt_fire_m203",
        Time = 10/30,
    },
    ["alt_reload_m203"] = {
        Source = "alt_reload_m203",
        Time = 78/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_m203_chamber_open_v12.wav", 		t = 12/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_m203_load_v12.wav", 	t = 39/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_m203_chamber_close_v12.wav", 	t = 60/30},
					},
    },
------------------------------------------------
------ Here lies MASTERKEY ANIMATIONS ... AWESOME ---
------------------------------------------------
    ["idle_masterkey"] = {
        Source = "idle_masterkey",
        Time = 1/30
    },
    ["enter_sprint_masterkey"] = {
        Source = "sprint_in_masterkey",
        Time = 10/30
    },
    ["idle_sprint_masterkey"] = {
        Source = "sprint_loop_masterkey",
        Time = 30/40
    },
    ["exit_sprint_masterkey"] = {
        Source = "sprint_out_masterkey",
        Time = 10/30
    },
    ["draw_masterkey"] = {
        Source = "pullout_masterkey",
        Time = 26/30,
        SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0,
    },
    ["holster_masterkey"] = {
        Source = "putaway_masterkey",
        Time = 25/30,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0,
    },
    ["fire_masterkey"] = {
        Source = "fire_masterkey",
        Time = 7/30,
        ShellEjectAt = 0,
    },
    ["fire_iron_masterkey"] = {
        Source = "fire_ads_masterkey",
        Time = 7/30,
        ShellEjectAt = 0,
    },
    ["reload_masterkey"] = {
        Source = "reload_masterkey",
        Time = 84/30,
        MinProgress = 2.059,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_famas_reload_lift_v1.wav", 		t = 0},
						{s = "weapons/fesiugmw2/foley/wpfoly_famas_reload_clipout_v1.wav", 	t = 21/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_famas_reload_clipin_v1.wav", 	    t = 63/30},
					},
        LHIK = true,
        LHIKIn = 0.5,
        LHIKOut = 0.5,
    },
    ["reload_empty_masterkey"] = {
        Source = "reload_empty_masterkey",
        Time = 100/30,
        MinProgress = 2.059,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_famas_reload_lift_v1.wav", 		t = 0},
						{s = "weapons/fesiugmw2/foley/wpfoly_famas_reload_clipout_v1.wav", 	t = 21/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_famas_reload_clipin_v1.wav", 	    t = 61/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_famas_reload_chamber_v1.wav",		t = 78/30},
					},
        LHIK = true,
        LHIKIn = 0.5,
        LHIKOut = 0.6,
    },
------------------------------------------------
------ Here lies MASTERKEY IN THE ANIMATIONS........... ... AWESOME ---
------------------------------------------------
    ["alt_idle_masterkey"] = {
        Source = "alt_idle_masterkey",
        Time = 1/30
    },
    ["alt_enter_sprint_masterkey"] = {
        Source = "alt_sprint_in_masterkey",
        Time = 10/30
    },
    ["alt_idle_sprint_masterkey"] = {
        Source = "alt_sprint_loop_masterkey",
        Time = 30/40
    },
    ["alt_exit_sprint_masterkey"] = {
        Source = "alt_sprint_out_masterkey",
        Time = 10/30
    },
    ["alt_draw_masterkey"] = {
        Source = "alt_pullout_masterkey",
        Time = 25/30,
        SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
    },
    ["alt_holster_masterkey"] = {
        Source = "alt_putaway_masterkey",
        Time = 25/30,
    },
    ["alt_fire_masterkey"] = {
        Source = "alt_fire_masterkey",
        Time = 10/30,
    },
    ["alt_cycle_masterkey"] = {
        Source = "alt_cycle_masterkey",
        SoundTable = {{s = "weapons/fesiugmw2/foley/wpfoly_winchester_reload_pump_v1.wav", 		t = 3/30}},
        Time = 15/30,
    },
    ["alt_reload_start_masterkey"] = {
        Source = "alt_reload_start_masterkey",
        Time = 35/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_shotattach_reload_lift_v1.wav", 		t = 0/30},
						{s = "MW2Common.Masterkey_Load", 		t = 26/30},
					},
    },
    ["alt_reload_loop_masterkey"] = {
        Source = "alt_reload_loop_masterkey",
        Time = 33/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "MW2Common.Masterkey_Load", 	t = 24/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_shotattach_reload_end_v1.wav", 	t = 33/30}, -- end
					},
    },
    ["alt_reload_finish_masterkey"] = {
        Source = "alt_reload_finish_masterkey",
        Time = 50/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						--{s = "MW2Common.Masterkey_Load", 	t = 0/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_shotattach_reload_end_v1.wav", 	t = 0/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_winchester_reload_pump_v1.wav", 	t = 22/30},
					},
    },
-----------------------------------------------------
    ["switch2_gun_m203"] = {
        Source = "switch2_gun_m203",
        SoundTable = {{s = "MW2Common.Underbarrel", 		t = 0}},
        Time = 24/30
    },
    ["switch2_alt_m203"] = {
        Source = "switch2_alt_m203",
        SoundTable = {{s = "MW2Common.Underbarrel", 		t = 0}},
        Time = 24/30
    },
    ["switch2_gun_masterkey"] = {
        Source = "switch2_gun_masterkey",
        SoundTable = {{s = "MW2Common.Underbarrel", 		t = 0}},
        Time = 19/30
    },
    ["switch2_alt_masterkey"] = {
        Source = "switch2_alt_masterkey",
        SoundTable = {
						{s = "MW2Common.Underbarrel", 		t = 0},
						{s = "weapons/fesiugmw2/foley/wpfoly_winchester_reload_pump_v1.wav", 		t = 14/30},
					},
        Time = 25/30
    },
}
--lua/weapons/arccw_mw2_intervention.lua:
return gluapack()()
--lua/weapons/arccw_mw2_l86.lua:
SWEP.Base = "arccw_mw2_abase"
SWEP.Spawnable = true
SWEP.Category = "ArcCW - MW2"
SWEP.AdminOnly = false
SWEP.WeaponCamBone = tag_camera

SWEP.PrintName = "L86 LSW"
SWEP.Trivia_Class = "Light Machine Gun"
SWEP.Trivia_Desc = "Fully automatic, large magazines."

SWEP.Slot = 2

SWEP.UseHands = true

SWEP.ViewModel = "models/weapons/arccw/fesiugmw2/c_sa80_lmg_5.mdl"
SWEP.MirrorVMWM = true
SWEP.WorldModelOffset = {
    pos = Vector(-9, 3, -5),
    ang = Angle(-10, 0, 180),
    scale = 1.25
}
SWEP.WorldModel = "models/weapons/w_rif_aug.mdl"
SWEP.ViewModelFOV = 65

SWEP.DefaultBodygroups = "100000"

SWEP.Damage = 40
SWEP.DamageMin = 40
SWEP.Range = 1400 * 0.025  -- GAME UNITS * 0.025 = METRES
SWEP.Penetration = 7
SWEP.DamageType = DMG_BULLET
SWEP.ShootEntity = nil -- entity to fire, if any


SWEP.ChamberSize = 0
SWEP.Primary.ClipSize = 100 -- DefaultClip is automatically set.
SWEP.ExtendedClipSize = 150
SWEP.ReducedClipSize = 50

SWEP.VisualRecoilMult = 0
SWEP.Recoil = 0.5
SWEP.RecoilSide = 0.5
SWEP.RecoilRise = 0

SWEP.Delay = 0.075 -- lazy, fix this l8r btich -- 60 / RPM.
SWEP.Num = 1 -- number of shots per trigger pull.
SWEP.Firemodes = {
    {
        Mode = 2,
    },
    {
        Mode = 1,
    },
    {
        Mode = 0,
    },
}

SWEP.NPCWeaponType = {"weapon_ar2", "weapon_smg1"}
SWEP.NPCWeight = 100

SWEP.AccuracyMOA = 5 -- accuracy in Minutes of Angle. There are 60 MOA in a degree.
SWEP.HipDispersion = 500 -- inaccuracy added by hip firing.
SWEP.MoveDispersion = 250

SWEP.Primary.Ammo = "smg1" -- what ammo type the gun uses

SWEP.ShootVol = 110 -- volume of shoot sound
SWEP.ShootPitch = 105 -- pitch of shoot sound

SWEP.ShootSound =			"weapons/fesiugmw2/fire/l86.wav"
SWEP.ShootMechSound =       ArcCW_MW2_Mech
--SWEP.DistantShootSound =	"weapons/fesiugmw2/fire_distant/aug.wav"
SWEP.ShootDrySound =        "weapons/fesiugmw2/fire/dryfire_rifle.wav"
SWEP.ShootSoundSilenced =	"weapons/fesiugmw2/fire/m240_sil.wav"

SWEP.MuzzleEffect = "muzzleflash_4"
SWEP.ShellModel = "models/shells/shell_556.mdl"
SWEP.ShellPitch = 95
SWEP.ShellScale = 1
SWEP.ShellRotateAngle = Angle(0, 90, 0)

SWEP.MuzzleEffectAttachment = 1 -- which attachment to put the muzzle on
SWEP.CaseEffectAttachment = 2 -- which attachment to put the case effect on

SWEP.SpeedMult = 0.875
SWEP.SightedSpeedMult = 0.35
SWEP.SightTime = 0.25

SWEP.BulletBones = { -- the bone that represents bullets in gun/mag
    -- [0] = "bulletchamber",
    -- [1] = "bullet1"
}

SWEP.IronSightStruct = {
    Pos = Vector(-2.42, -1.026, 0.88),
    Ang = Angle(1, 0, 0),
    ViewModelFOV = 65 / 1.3,
    Magnification = 1.3,
}

SWEP.HoldtypeHolstered = "passive"
SWEP.HoldtypeActive = "ar2"
SWEP.HoldtypeSights = "rpg"

SWEP.AnimShoot = ACT_HL2MP_GESTURE_RANGE_ATTACK_AR2

SWEP.ActivePos = Vector(0, 0, 1)
SWEP.ActiveAng = Angle(0, 0, 0)

SWEP.CustomizePos = Vector(10.479, 0, -1.321)
SWEP.CustomizeAng = Angle(18.2, 39.4, 14.8)

SWEP.HolsterPos = Vector(1, 0, 1)
SWEP.HolsterAng = Angle(-10, 12, 0)

SWEP.SprintPos = Vector(0, 0, 1)
SWEP.SprintAng = Angle(0, 0, 0)

SWEP.BarrelOffsetSighted = Vector(0, 0, -1)
SWEP.BarrelOffsetHip = Vector(2, 0, -2)

SWEP.BarrelLength = 27

SWEP.AttachmentElements = {
    ["nors"] = {
        VMBodygroups = {{ind = 1, bg = 1}},
    },
    ["optic_mw2_mp5krearsight"] = { VMBodygroups = {{ind = 2, bg = 0}} },
    ["grip"] = { VMBodygroups = {{ind = 3, bg = 1}} },
    ["wepcamo-desert"]		= { VMSkin = 1 },
    ["wepcamo-arctic"]		= { VMSkin = 2 },
    ["wepcamo-woodland"]	= { VMSkin = 3 },
    ["wepcamo-digital"]		= { VMSkin = 4 },
    ["wepcamo-urban"]		= { VMSkin = 5 },
    ["wepcamo-bluetiger"]	= { VMSkin = 6 },
    ["wepcamo-redtiger"]	= { VMSkin = 7 },
    ["wepcamo-fall"]		= { VMSkin = 8 },
    ["wepcamo-whiteout"]	= { VMSkin = 9 },
    ["wepcamo-blackout"]        = { VMSkin = 10 },
    ["wepcamo-bushdweller"]     = { VMSkin = 11 },
    ["wepcamo-thunderstorm"]    = { VMSkin = 12 },
}

SWEP.ExtraSightDist = 5
SWEP.Bipod_Integral = true

SWEP.Attachments = {
    {
        PrintName = "Optic",
        DefaultAttName = "Iron Sights",
        Slot = {"optic"},
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(-3.3, 0, 2.4),
            vang = Angle(0, 0, 0),
            wang = Angle(-9.738, 0, 180)
        },
        InstalledEles = {"nors"},
    },
    {
        PrintName = "Muzzle",
        DefaultAttName = "Standard Muzzle",
        Slot = "muzzle",
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(20, 0, 1),
            vang = Angle(0, 0, 0),
            wpos = Vector(33.719, -2.122, -5.573),
            wang = Angle(0, 6.034, 180)
        },
    },
    {
        PrintName = "Underbarrel",
        Slot = {"foregrip", "bipod", "foregrip_mw2exclusive"},
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(6, 0, -0.2),
            vang = Angle(0, 0, 0),
            wpos = Vector(14.329, 0.602, -4.453),
            wang = Angle(-2.461, -6.525, 176.662)
        },
    },
    {
        PrintName = "Tactical",
        Slot = "tac",
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(-1.9, -1, 0.67),
            vang = Angle(0, 0, 90),
            wpos = Vector(15.625, -0.253, -6.298),
            wang = Angle(-8.829, -0.556, 90)
        },
    },
    {
        PrintName = "Fire Group",
        Slot = "fcg",
        DefaultAttName = "Standard FCG"
    },
    {
        PrintName = "Ammo Type",
        Slot = "ammo_bullet"
    },
    {
        PrintName = "Perk",
        Slot = "perk"
    },
    {
        PrintName = "Camouflage",
        DefaultAttName = "None",
        Slot = "mw2_wepcamo",
        FreeSlot = true,
    },
	{
        PrintName = "Charm",
        Slot = "charm",
        FreeSlot = true,
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(0, -0.5, 0.5),
            vang = Angle(0, 0, 0),
            wpos = Vector(9.625, 1.5, -4),
            wang = Angle(0, 0, 180)
        },
    },
}

SWEP.Hook_TranslateAnimation = function(wep, anim)
	local attached = wep.Attachments[3].Installed
	
	-- m203 is 1, masterkey is 2, fgrip is 3
	local attthing
		if 		attached 							then attthing = 3
		else 											 attthing = 0
	end
	
    if attthing == 3 then
        return anim .. "_fgrip"
    end
end

SWEP.Animations = {
    ["idle"] = {
        Source = "idle",
        Time = 1/30
    },
    ["enter_sprint"] = {
        Source = "sprint_in",
        Time = 10/30
    },
    ["idle_sprint"] = {
        Source = "sprint_loop",
        Time = 30/40
    },
    ["exit_sprint"] = {
        Source = "sprint_out",
        Time = 10/30
    },
    ["draw"] = {
        Source = "pullout",
        Time = 30/30,
        SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0.9,
    },
    ["holster"] = {
        Source = "putaway",
        Time = 25/30,
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0.9,
    },
    ["ready"] = {
        Source = "pullout_first",
        Time = 43/30,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_sa80_reload_lift_v1.wav", 	t = 0},
						{s = "weapons/fesiugmw2/foley/wpfoly_sa80_reload_chamber_v1.wav", 	t = 18/30},
					},
    },
    ["fire"] = {
        Source = "fire",
        Time = 5/30,
        ShellEjectAt = 0,
    },
    ["fire_iron"] = {
        Source = "fire_ads",
        Time = 5/30,
        ShellEjectAt = 0,
    },
    ["reload"] = {
        Source = "reload_empty",
        Time = 113/24,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_sa80_reload_lift_v1.wav", 		t = 0},
						{s = "weapons/fesiugmw2/foley/wpfoly_sa80_reload_clipout_v1.wav", 	t = 19/24},
						{s = "weapons/fesiugmw2/foley/wpfoly_sa80_reload_clipin_v1.wav", 		t = 66/24},
						{s = "weapons/fesiugmw2/foley/wpfoly_sa80_reload_hit_v1.wav", 		t = 75/24},
						{s = "weapons/fesiugmw2/foley/wpfoly_sa80_reload_chamber_v1.wav",		t = 86/24},
					},
    },
------------------------------------------------
------ Here lies foregrip animations. awesome --
------------------------------------------------
    ["idle_fgrip"] = {
        Source = "idle_fgrip",
        Time = 1/30
    },
    ["enter_sprint_fgrip"] = {
        Source = "sprint_in_fgrip",
        Time = 10/30
    },
    ["idle_sprint_fgrip"] = {
        Source = "sprint_loop_fgrip",
        Time = 30/40
    },
    ["exit_sprint_fgrip"] = {
        Source = "sprint_out_fgrip",
        Time = 10/30
    },
    ["draw_fgrip"] = {
        Source = "pullout_fgrip",
        Time = 30/30,
        SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0.9,
    },
    ["holster_fgrip"] = {
        Source = "putaway_fgrip",
        Time = 25/30,
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0.9,
    },
    ["ready_fgrip"] = {
        Source = "pullout_first_fgrip",
        Time = 43/30,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_sa80_reload_lift_v1.wav", 	t = 0},
						{s = "weapons/fesiugmw2/foley/wpfoly_sa80_reload_chamber_v1.wav", 	t = 18/30},
					},
    },
    ["fire_fgrip"] = {
        Source = "fire_fgrip",
        Time = 5/30,
        ShellEjectAt = 0,
    },
    ["fire_iron_fgrip"] = {
        Source = "fire_ads_fgrip",
        Time = 5/30,
        ShellEjectAt = 0,
    },
    ["reload_fgrip"] = {
        Source = "reload_empty_fgrip",
        Time = 113/24,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_sa80_reload_lift_v1.wav", 		t = 0},
						{s = "weapons/fesiugmw2/foley/wpfoly_sa80_reload_clipout_v1.wav", 	t = 19/24},
						{s = "weapons/fesiugmw2/foley/wpfoly_sa80_reload_clipin_v1.wav", 		t = 66/24},
						{s = "weapons/fesiugmw2/foley/wpfoly_sa80_reload_hit_v1.wav", 		t = 75/24},
						{s = "weapons/fesiugmw2/foley/wpfoly_sa80_reload_chamber_v1.wav",		t = 86/24},
					},
    },
}
--lua/weapons/arccw_mw2_m9.lua:
SWEP.Base = "arccw_mw2_abase"
SWEP.Spawnable = true
SWEP.Category = "ArcCW - MW2"
SWEP.AdminOnly = false
SWEP.WeaponCamBone = tag_camera

SWEP.PrintName = "M9"
SWEP.Trivia_Class = "Handgun"
SWEP.Trivia_Desc = "Semi-automatic (single fire)"

SWEP.Slot = 1

SWEP.UseHands = true

SWEP.ViewModel = "models/weapons/arccw/fesiugmw2/c_beretta_akimbo_test2.mdl"
SWEP.MirrorVMWM = true
SWEP.WorldModelOffset = {
    pos = Vector(-9, 3, -3.5),
    ang = Angle(-7, 0, 180),
    scale = 1.25
}
SWEP.WorldModel = "models/weapons/w_pist_elite_single.mdl"
SWEP.ViewModelFOV = 65

SWEP.Damage = 40
SWEP.DamageMin = 20
SWEP.Range = 800 * 0.025  -- GAME UNITS * 0.025 = METRES
SWEP.Penetration = 4
SWEP.DamageType = DMG_BULLET
SWEP.ShootEntity = nil -- entity to fire, if any


SWEP.ChamberSize = 0
SWEP.Primary.ClipSize = 15 -- DefaultClip is automatically set.
SWEP.ExtendedClipSize = 25
SWEP.ReducedClipSize = 10

SWEP.VisualRecoilMult = 0
SWEP.Recoil = 0.45
SWEP.RecoilSide = 0.55
SWEP.RecoilRise = 0.25

SWEP.Delay = 0.079 -- 60 / RPM.
SWEP.Num = 1 -- number of shots per trigger pull.
SWEP.Firemodes = {
    {
        Mode = 1,
    },
    {
        Mode = 0
    }
}

SWEP.NPCWeaponType = {"weapon_pistol"}
SWEP.NPCWeight = 100

SWEP.AccuracyMOA = 15 -- accuracy in Minutes of Angle. There are 60 MOA in a degree.
SWEP.HipDispersion = 200 -- inaccuracy added by hip firing.
SWEP.MoveDispersion = 120

SWEP.Primary.Ammo = "pistol" -- what ammo type the gun uses

SWEP.ShootVol = 110 -- volume of shoot sound
SWEP.ShootPitch = 100 -- pitch of shoot sound

SWEP.ShootSound =			"weapons/fesiugmw2/fire/m9.wav"
--SWEP.DistantShootSound =	"weapons/arccw/m4a1/m4a1_us_distant_03.wav"
SWEP.ShootSoundSilenced =	"weapons/fesiugmw2/fire/usp45_sil.wav"

SWEP.MuzzleEffect = "muzzleflash_4"
SWEP.ShellModel = "models/shells/shell_9mm.mdl"
SWEP.ShellScale = 1
SWEP.ShellRotateAngle = Angle(0, 90, 0)

SWEP.MuzzleEffectAttachment = 1 -- which attachment to put the muzzle on
SWEP.CaseEffectAttachment = 2 -- which attachment to put the case effect on

SWEP.SpeedMult = 1
SWEP.SightedSpeedMult = 0.8
SWEP.SightTime = 0.125


SWEP.BulletBones = { -- the bone that represents bullets in gun/mag
    -- [0] = "bulletchamber",
    -- [1] = "bullet1"
}

SWEP.IronSightStruct = {
    Pos = Vector(-1.953, 0, 1.572),
    Ang = Angle(-2.096, 0, 0),
    ViewModelFOV = 65,
    Magnification = 1,
}

SWEP.HoldtypeHolstered = "normal"
SWEP.HoldtypeActive = "revolver"
SWEP.HoldtypeSights = "revolver"

SWEP.AnimShoot = ACT_HL2MP_GESTURE_RANGE_ATTACK_AR2

SWEP.ActivePos = Vector(0, 0, 1)
SWEP.ActiveAng = Angle(0, 0, 0)

SWEP.CustomizePos = Vector(3, 0, -1)
SWEP.CustomizeAng = Angle(10, 19, 0)

SWEP.CrouchPos = Vector(-2.764, -0.927, -0.202)
SWEP.CrouchAng = Angle(1.12, -1, -21.444)

SWEP.HolsterPos = Vector(1, 0, 1)
SWEP.HolsterAng = Angle(-10, 12, 0)

SWEP.SprintPos = Vector(0, 0, 1)
SWEP.SprintAng = Angle(0, 0, 0)

SWEP.BarrelOffsetSighted = Vector(0, 0, -1)
SWEP.BarrelOffsetHip = Vector(2, 0, -2)

SWEP.BarrelLength = 18

SWEP.ExtraSightDist = 5

-----[ Tactical knife sheet ]------
	SWEP.CanBash				= true -- Tac knife will save us
	--SWEP.MeleeDamage			= 100
	--SWEP.MeleeRange				= 16
	--SWEP.MeleeDamageType		= DMG_CLUB
	--SWEP.MeleeTime				= 0.8
	SWEP.MeleeGesture			= ACT_HL2MP_GESTURE_RANGE_ATTACK_KNIFE
	--SWEP.MeleeAttackTime		= 0.079
	SWEP.MeleeMissSound			= ""
	SWEP.MeleeHitSound			= "MW2Common.Melee.HitWorld"
	SWEP.MeleeHitNPCSound		= "MW2Common.Melee.HitFleshy_Slice"

SWEP.AttachmentElements = {
    ["railthegrind"] = {
        VMElements = {
            {
                Model = "models/weapons/arccw/fesiugmw2/atts/pistolrail_1.mdl",
                Bone = "tag_weapon",
                Offset = {
                    pos = Vector(0, -0.075, -0.5),
                    ang = Angle(0, 0, 0),
                }
            }
        },
    },
    ["altirons"] = {
        Override_IronSightStruct = {
            Pos = Vector(-1.64, -2.346, 0.119),
            Ang = Angle(-0.3, 0, 0),
            ViewModelFOV = 65,
            Magnification = 1,
        },
        Override_AutosolveSourceSeq = "idle_knife",
        VMBodygroups = {{ind = 1, bg = 1}}, -- m1911 is an old fart and doesn't have the knife bone all the way back so we hide it in qc and show it here instead
        WMBodygroups = {},
    },
}

SWEP.Attachments = {
    {
        PrintName = "Optic",
        DefaultAttName = "Iron Sights",
        Slot = "optic_lp",
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(-0.7, -0.075, 2.1),
            vang = Angle(0, 0, 0),
        },
        ExcludeFlags = {"cantuseshitinakimboyet"},
        InstalledEles = {"railthegrind"},
    },
    {
        PrintName = "Muzzle",
        DefaultAttName = "Standard Muzzle",
        Slot = "muzzle",
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(5.214, -0.085, 1.194),
            vang = Angle(0, 0, 0),
            wpos = Vector(26.648, 0.782, -8.042),
            wang = Angle(-9.79, 0, 180)
        },
        ExcludeFlags = {"cantuseshitinakimboyet"},
		VMScale = Vector(0.67, 0.67, 0.67),
    },
    {
        PrintName = "Underbarrel",
		Slot = {"foregrip_pistol", "style_pistol", "mw2_tacknife"},
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(1.9, 0, -0.5),
            vang = Angle(0, 0, 0),
            wpos = Vector(14.329, 0.602, -4.453),
            wang = Angle(-10.216, 0, 180)
        },
        MergeSlots = {8},
    },
    {
        PrintName = "Tactical",
        Slot = "tac_pistol",
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(3.5, 0, 0),
            vang = Angle(0, 0, 0),
        },
    },
    {
        PrintName = "Fire Group",
        Slot = "fcg",
        DefaultAttName = "Standard FCG",
        ExcludeFlags = {"cantuseshitinakimboyet"},
    },
    {
        PrintName = "Ammo Type",
        Slot = "ammo_bullet"
    },
    {
        PrintName = "Perk",
        Slot = "perk"
    },
    {
        PrintName = "Akimbotest",
        DefaultAttName = "No LH",
        Slot = "akimbotest",
        Bone = "tag_view",
        Offset = {
            vpos = Vector(0, 0, 0),
            vang = Angle(0, 0, 0),
        },
        Hidden = true,
    },
}

SWEP.Hook_SelectReloadAnimation = function(wep, anim)
    if wep.Attachments[3].Installed == "mw2_tacticalknife" then
        return anim .. "_knife"
    elseif wep.Attachments[8].Installed then
        return anim .. "_akimbo_right"
    end
end
SWEP.Hook_TranslateAnimation = function(wep, anim)
    if wep.Attachments[3].Installed == "mw2_tacticalknife" then
        return anim .. "_knife"
    elseif wep.Attachments[8].Installed then
        return anim .. "_akimbo_right"
    end
end

SWEP.Animations = {
    ["idle"] = {
        Source = "idle",
        Time = 2/30
    },
    ["idle_empty"] = {
        Source = "idle_empty",
        Time = 2/30
    },
    ["enter_sprint"] = {
        Source = "sprint_in",
        Time = 10/30
    },
    ["idle_sprint"] = {
        Source = "sprint_loop",
        Time = 30/40
    },
    ["exit_sprint"] = {
        Source = "sprint_out",
        Time = 10/30
    },
    ["draw"] = {
        Source = "pullout",
        SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
        Time = 31/30 /4,
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0.35,
    },
    ["holster"] = {
        Source = "putaway",
        Time = 32/30 /4,
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0.35,
    },
    ["draw_empty"] = {
        Source = "pullout_empty",
        SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
        Time = 31/30 /4,
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0.35,
    },
    ["holster_empty"] = {
        Source = "putaway_empty",
        Time = 30/30 /4,
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0.35,
    },
    ["fire"] = {
        Source = "fire",
        Time = 9/30,
        ShellEjectAt = 0,
    },
    ["fire_iron"] = {
        Source = "fire_ads",
        Time = 13/30,
        ShellEjectAt = 0,
    },
    ["fire_empty"] = {
        Source = "lastfire",
        Time = 9/30,
        ShellEjectAt = 0,
    },
    ["fire_iron_empty"] = {
        Source = "lastfire",
        Time = 9/30,
        ShellEjectAt = 0,
    },
    ["reload"] = {
        Source = "reload",
        Time = 51/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_beretta9mm_reload_clipout_v2.wav", 	t = 9/24},
						{s = "weapons/fesiugmw2/foley/wpfoly_beretta9mm_reload_clipin_v2.wav", 	t = 27/24},
					},
        Checkpoints = {24, 97},
        FrameRate = 30,
        LHIK = true,
        LHIKIn = 0.5,
        LHIKOut = 0.4,
    },
    ["reload_empty"] = {
        Source = "reload_empty",
        Time = 60/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_beretta9mm_reload_clipout_v2.wav", 	t = 9/24},
						{s = "weapons/fesiugmw2/foley/wpfoly_beretta9mm_reload_clipin_v2.wav", 	t = 27/24},
						{s = "weapons/fesiugmw2/foley/wpfoly_beretta9mm_reload_chamber_v2.wav", 	t = 36/24},
					},
        Checkpoints = {24, 97, 131},
        FrameRate = 37,
        LHIK = true,
        LHIKIn = 0.5,
        LHIKOut = 0.6,
    },
---------------------------------------------------------
--------- LE TACTICAL KNIFE XDXDXDXD---------------------
---------------------------------------------------------
		["idle_knife"] = {
			Source = "idle_knife",
			Time = 300/30
		},
		["idle_empty_knife"] = {
			Source = "idle_knife",
			Time = 300/30
		},
		["enter_sprint_knife"] = {
			Source = "sprint_in_knife",
			Time = 10/30
		},
		["idle_sprint_knife"] = {
			Source = "sprint_loop_knife",
			Time = 30/40
		},
		["exit_sprint_knife"] = {
			Source = "sprint_out_knife",
			Time = 10/30
		},
		["fire_knife"] = {
			Source = "fire_knife",
			Time = 8/30,
			ShellEjectAt = 0,
		},
		["fire_iron_knife"] = {
			Source = "fire_ads_knife",
			Time = 8/30,
			ShellEjectAt = 0,
		},
		["fire_empty_knife"] = {
			Source = "lastfire_knife",
			Time = 8/30,
			ShellEjectAt = 0,
		},
		["fire_iron_empty_knife"] = {
			Source = "lastfire_knife",
			Time = 8/30,
			ShellEjectAt = 0,
		},
		["draw_knife"] = {
			Source = "pullout_knife",
			SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
			Time = 29/30 /4,
			LHIK = true,
			LHIKIn = 0,
			LHIKOut = 0.35,
		},
		["holster_knife"] = {
			Source = "putaway_knife",
			Time = 31/30 /4,
			LHIK = true,
			LHIKIn = 0,
			LHIKOut = 0.35,
		},
		["draw_empty_knife"] = {
			Source = "pullout_knife",
			SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
			Time = 29/30 /4,
			LHIK = true,
			LHIKIn = 0,
			LHIKOut = 0.35,
		},
		["holster_empty_knife"] = {
			Source = "putaway_knife",
			Time = 31/30 /4,
			LHIK = true,
			LHIKIn = 0,
			LHIKOut = 0.35,
		},
		["reload_knife"] = {
			Source = "reload_knife",
			Time = 51/24,
			TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
			SoundTable = {
							{s = "weapons/fesiugmw2/foley/wpfoly_beretta9mm_reload_clipout_v2.wav", 	t = 7/24},
							{s = "weapons/fesiugmw2/foley/wpfoly_beretta9mm_reload_clipin_v2.wav", 	t = 25/24},
						},
			Checkpoints = {24, 97},
			FrameRate = 30,
			LHIK = true,
			LHIKIn = 0.5,
			LHIKOut = 0.4,
		},
		["reload_empty_knife"] = {
			Source = "reload_empty_knife",
			Time = 46/24,
			TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
			SoundTable = {
							{s = "weapons/fesiugmw2/foley/wpfoly_beretta9mm_reload_clipout_v2.wav", 	t = 6/24},
							{s = "weapons/fesiugmw2/foley/wpfoly_beretta9mm_reload_clipin_v2.wav", 	t = 25/24},
							{s = "weapons/fesiugmw2/foley/wpfoly_beretta9mm_reload_chamber_v2.wav", 	t = 37/24},
						},
			Checkpoints = {24, 97, 131},
			FrameRate = 37,
			LHIK = true,
			LHIKIn = 0.5,
			LHIKOut = 0.6,
		},
		["bash_knife"] = {
			Source = "melee_knife",
			SoundTable = {{s = "MW2Common.Melee.Swing", 		t = 0}},
			Time = 97/120 / 1.6, -- damn you universal
			LHIK = true,
		},
---------------------------------------------------------
--------- LE akimbo gun ---------------------
---------------------------------------------------------
    ["idle_akimbo_right"] = {
        Source = "idle_akimbo_right",
        Time = 2/30
    },
    ["idle_empty_akimbo_right"] = {
        Source = "idle_empty_akimbo_right",
        Time = 2/30
    },
    ["enter_sprint_akimbo_right"] = {
        Source = "sprint_in_akimbo_right",
        Time = 11/30
    },
    ["idle_sprint_akimbo_right"] = {
        Source = "sprint_loop_akimbo_right",
        Time = 31/40
    },
    ["exit_sprint_akimbo_right"] = {
        Source = "sprint_out_akimbo_right",
        Time = 11/30
    },
    ["draw_akimbo_right"] = {
        Source = "pullout_akimbo_right",
        SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
        Time = 26/30 /4,
    },
    ["holster_akimbo_right"] = {
        Source = "putaway_akimbo_right",
        Time = 26/30 /4,
    },
    ["fire_akimbo_right"] = {
        Source = "fire_akimbo_right",
        Time = 6/30,
        ShellEjectAt = 0,
    },
    ["fire_empty_akimbo_right"] = {
        Source = "fire_last_akimbo_right",
        Time = 6/30,
        ShellEjectAt = 0,
    },
    ["reload_akimbo_right"] = {
        Source = "reload_akimbo_right",
        Time = 70/40,
        MinProgress = 1.2,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_beretta9mm_reload_clipout_v2.wav", 	t = 4/40},
						{s = "weapons/fesiugmw2/foley/wpfoly_beretta9mm_reload_clipin_v2.wav", 	t = 39/40},
					},
    },
    ["reload_empty_akimbo_right"] = {
        Source = "reload_empty_akimbo_right",
        Time = 89/40,
        MinProgress = 1.2,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_beretta9mm_reload_clipout_v2.wav", 	t = 4/40},
						{s = "weapons/fesiugmw2/foley/wpfoly_beretta9mm_reload_clipin_v2.wav", 	t = 45/40},
						{s = "weapons/fesiugmw2/foley/wpfoly_beretta9mm_reload_chamber_v2.wav", 	t = 65/40},
					},
    },
}
--lua/weapons/arccw_mw2_miniuzi.lua:
SWEP.Base = "arccw_mw2_abase"
SWEP.Spawnable = true
SWEP.Category = "ArcCW - MW2"
SWEP.AdminOnly = false
SWEP.WeaponCamBone = tag_camera

SWEP.PrintName = "Mini-Uzi"
SWEP.Trivia_Class = "Sub Machine Gun"
SWEP.Trivia_Desc = "Fully automatic, close range."

SWEP.Slot = 2

SWEP.UseHands = true

SWEP.ViewModel = "models/weapons/arccw/fesiugmw2/c_miniuzi_2a.mdl"
SWEP.MirrorVMWM = true
SWEP.WorldModelOffset = {
    pos = Vector(-9, 3, -3.5),
    ang = Angle(-7, 0, 180),
    scale = 1.25
}
SWEP.WorldModel = "models/weapons/w_smg_mac10.mdl"
SWEP.ViewModelFOV = 65

SWEP.Damage = 30
SWEP.DamageMin = 20
SWEP.Range = 1000 * 0.025  -- GAME UNITS * 0.025 = METRES
SWEP.Penetration = 3
SWEP.DamageType = DMG_BULLET
SWEP.ShootEntity = nil -- entity to fire, if any


SWEP.ChamberSize = 0
SWEP.Primary.ClipSize = 32 -- DefaultClip is automatically set.
SWEP.ExtendedClipSize = 48
SWEP.ReducedClipSize = 16

SWEP.VisualRecoilMult = 0
SWEP.Recoil = 0.60
SWEP.RecoilSide = 0.55
SWEP.RecoilRise = 0

SWEP.Delay = 0.063 -- 60 / RPM.
SWEP.Num = 1 -- number of shots per trigger pull.
SWEP.Firemodes = {
    {
        Mode = 2,
    },
    {
        Mode = 1,
    },
    {
        Mode = 0
    }
}

SWEP.NPCWeaponType = {"weapon_ar2", "weapon_smg1"}
SWEP.NPCWeight = 100

SWEP.AccuracyMOA = 30 -- accuracy in Minutes of Angle. There are 60 MOA in a degree.
SWEP.HipDispersion = 200 -- inaccuracy added by hip firing.
SWEP.MoveDispersion = 200

SWEP.Primary.Ammo = "pistol" -- what ammo type the gun uses

SWEP.ShootVol = 110 -- volume of shoot sound
SWEP.ShootPitch = 100 -- pitch of shoot sound

SWEP.ShootSound =			"weapons/fesiugmw2/fire/miniuzi.wav"
--SWEP.DistantShootSound =	"weapons/fesiugmw2/fire_distant/miniuzi.wav"
SWEP.ShootSoundSilenced =	"weapons/fesiugmw2/fire/usp45_sil.wav"

SWEP.MuzzleEffect = "muzzleflash_smg"
SWEP.ShellModel = "models/shells/shell_9mm.mdl"
SWEP.ShellScale = 1
SWEP.ShellRotateAngle = Angle(0, 90, 0)

SWEP.MuzzleEffectAttachment = 1 -- which attachment to put the muzzle on
SWEP.CaseEffectAttachment = 2 -- which attachment to put the case effect on

SWEP.SpeedMult = 1
SWEP.SightedSpeedMult = 0.80
SWEP.SightTime = 0.2

SWEP.BulletBones = { -- the bone that represents bullets in gun/mag
    -- [0] = "bulletchamber",
    -- [1] = "bullet1"
}

SWEP.IronSightStruct = {
    Pos = Vector(-3.21, -2.254, -0.044),
    Ang = Angle(1.900, 0, 0),
    ViewModelFOV = 65 / 1.18,
    Magnification = 1.18,
}

SWEP.HoldtypeHolstered = "normal"
SWEP.HoldtypeActive = "revolver"
SWEP.HoldtypeSights = "revolver"

SWEP.AnimShoot = ACT_HL2MP_GESTURE_RANGE_ATTACK_AR2

SWEP.ActivePos = Vector(0, 0, 1)
SWEP.ActiveAng = Angle(0, 0, 0)

SWEP.CustomizePos = Vector(10.479, 0, -3.321)
SWEP.CustomizeAng = Angle(18.2, 39.4, 14.8)

SWEP.HolsterPos = Vector(1, 0, 1)
SWEP.HolsterAng = Angle(-10, 12, 0)

SWEP.SprintPos = Vector(0, 0, 1)
SWEP.SprintAng = Angle(0, 0, 0)

SWEP.BarrelOffsetSighted = Vector(0, 0, -1)
SWEP.BarrelOffsetHip = Vector(2, 0, -2)

SWEP.BarrelLength = 18

SWEP.AttachmentElements = {
    ["nors"] = {
        VMBodygroups = {{ind = 1, bg = 1}},
        WMBodygroups = {},
    },
    ["wepcamo-desert"]		= { VMSkin = 1 },
    ["wepcamo-arctic"]		= { VMSkin = 2 },
    ["wepcamo-woodland"]	= { VMSkin = 3 },
    ["wepcamo-digital"]		= { VMSkin = 4 },
    ["wepcamo-urban"]		= { VMSkin = 5 },
    ["wepcamo-bluetiger"]	= { VMSkin = 6 },
    ["wepcamo-redtiger"]	= { VMSkin = 7 },
    ["wepcamo-fall"]		= { VMSkin = 8 },
    ["wepcamo-whiteout"]	= { VMSkin = 9 },
    ["wepcamo-blackout"]        = { VMSkin = 10 },
    ["wepcamo-bushdweller"]     = { VMSkin = 11 },
    ["wepcamo-thunderstorm"]    = { VMSkin = 12 },
}

SWEP.ExtraSightDist = 5

SWEP.Attachments = {
    {
        PrintName = "Optic",
        DefaultAttName = "Iron Sights",
        Slot = "optic",
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(-4, 0, 2.48),
            vang = Angle(0, 0, 0),
            wpos = Vector(1.998, 0.17, -5.025),
            wang = Angle(-3.074, -23.004, -172.249)
        },
        InstalledEles = {"nors"},
    },
    {
        PrintName = "Muzzle",
        DefaultAttName = "Standard Muzzle",
        Slot = "muzzle",
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(6, 0, 1.1),
            vang = Angle(0, 0, 0),
            wpos = Vector(12.057, 4.317, -3.858),
            wang = Angle(-3.074, -23.004, 0)
        },
		VMScale = Vector(1, 1, 1),
    },
    {
        PrintName = "Underbarrel",
        Slot = {"foregrip", "bipod"},
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(3, 0, 0),
            vang = Angle(0, 0, 0),
            wpos = Vector(8.425, 2.96, -2.54),
            wang = Angle(-3.074, -23.004, -172.249)
        },
    },
    {
        PrintName = "Tactical",
        Slot = "tac",
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(-2, -0.8, 1.4),
            vang = Angle(0, 0, 90),
            wpos = Vector(8.425, 3.891, -4.147),
            wang = Angle(-3.074, -23.004, -77.301)
        },
    },
    {
        PrintName = "Fire Group",
        Slot = "fcg",
        DefaultAttName = "Standard FCG"
    },
    {
        PrintName = "Ammo Type",
        Slot = "ammo_bullet"
    },
    {
        PrintName = "Perk",
        Slot = "perk"
    },
    {
        PrintName = "Camouflage",
        DefaultAttName = "None",
        Slot = "mw2_wepcamo",
        FreeSlot = true,
    },
	{
        PrintName = "Charm",
        Slot = "charm",
        FreeSlot = true,
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(0.5, -0.6, 0.75),
            vang = Angle(0, 0, 0),
            wpos = Vector(7.625, 2.4, -4),
            wang = Angle(0, 0, 180)
        },
    },
}

SWEP.Animations = {
    ["idle"] = {
        Source = "idle",
        Time = 0/30,
    },
    ["enter_sprint"] = {
        Source = "sprint_in",
        Time = 11/30
    },
    ["idle_sprint"] = {
        Source = "sprint_loop",
        Time = 31/40
    },
    ["exit_sprint"] = {
        Source = "sprint_out",
        Time = 11/30
    },
    ["draw"] = {
        Source = "pullout",
        Time = 26/30,
        SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0.9,
    },
    ["holster"] = {
        Source = "putaway",
        Time = 14/30,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0.3,
    },
    ["fire"] = {
        Source = "fire",
        Time = 7/30,
        ShellEjectAt = 0,
    },
    ["fire_iron"] = {
        Source = "fire_ads",
        Time = 7/30,
        ShellEjectAt = 0,
    },
    ["reload"] = {
        Source = "reload",
        Time = 76/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_miniuzi_reload_lift_v1.wav", 	t = 0/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_miniuzi_reload_clipout_v2.wav", 	t = 15/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_miniuzi_reload_clipin_v1.wav", 	t = 56/30},
					},
        LHIK = true,
	LHIKEaseIn = 0.31,
        LHIKIn = 0.4,
        LHIKEaseOut = 0.25,
        LHIKOut = 0.3,
    },
    ["reload_empty"] = {
        Source = "reload_empty",
        Time = 102/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_miniuzi_reload_lift_v1.wav", 	t = 0/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_miniuzi_reload_clipout_v2.wav", 	t = 15/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_miniuzi_reload_clipin_v1.wav", 	t = 56/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_miniuzi_reload_chamber_v1.wav", 	t = 76/30},
					},
        LHIK = true,
	LHIKEaseIn = 0.31,
        LHIKIn = 0.4,
        LHIKEaseOut = 0.25,
        LHIKOut = 0.3,
    },
}
--lua/weapons/arccw_mw2_scar.lua:
SWEP.Base = "arccw_mw2_abase"
SWEP.Spawnable = true
SWEP.Category = "ArcCW - MW2"
SWEP.AdminOnly = false
SWEP.WeaponCamBone = tag_camera

SWEP.PrintName = "SCAR-H"
SWEP.Trivia_Class = "Assault Rifle"
SWEP.Trivia_Desc = "Fully automatic, all purpose weapon."

SWEP.Slot = 2

SWEP.UseHands = true

SWEP.ViewModel = "models/weapons/arccw/fesiugmw2/c_scar.mdl"
SWEP.MirrorVMWM = true
SWEP.WorldModelOffset = {
    pos = Vector(-4, 3, -5),
    ang = Angle(-10, 0, 180),
    scale = 1.25
}
SWEP.WorldModel = "models/weapons/w_rif_galil.mdl"
SWEP.ViewModelFOV = 65

SWEP.Damage = 40
SWEP.DamageMin = 30
SWEP.Range = 2000 * 0.025  -- GAME UNITS * 0.025 = METRES
SWEP.Penetration = 10
SWEP.DamageType = DMG_BULLET
SWEP.ShootEntity = nil -- entity to fire, if any


SWEP.ChamberSize = 0
SWEP.Primary.ClipSize = 20 -- DefaultClip is automatically set.
SWEP.ExtendedClipSize = 30
SWEP.ReducedClipSize = 15

SWEP.VisualRecoilMult = 0
SWEP.Recoil = 0.4
SWEP.RecoilSide = 0.3
SWEP.RecoilRise = 0

SWEP.Delay = 0.093 -- 60 / RPM.
SWEP.Num = 1 -- number of shots per trigger pull.
SWEP.Firemodes = {
    {
        Mode = 2,
    },
    {
        Mode = 1,
    },
    {
        Mode = 0,
    },
}

SWEP.NPCWeaponType = {"weapon_ar2", "weapon_smg1"}
SWEP.NPCWeight = 100

SWEP.AccuracyMOA = 1.6 -- accuracy in Minutes of Angle. There are 60 MOA in a degree.
SWEP.HipDispersion = 500 -- inaccuracy added by hip firing.
SWEP.MoveDispersion = 250

SWEP.Primary.Ammo = "ar2" -- what ammo type the gun uses

SWEP.ShootVol = 110 -- volume of shoot sound
SWEP.ShootPitch = 105 -- pitch of shoot sound

SWEP.ShootSound =			"weapons/fesiugmw2/fire/scar.wav"
SWEP.ShootMechSound =       ArcCW_MW2_Mech
--SWEP.DistantShootSound =	"weapons/fesiugmw2/fire_distant/scar.wav"
SWEP.ShootDrySound =        "weapons/fesiugmw2/fire/dryfire_rifle.wav"
SWEP.ShootSoundSilenced =	"weapons/fesiugmw2/fire/m4_sil.wav"

SWEP.MuzzleEffect = "muzzleflash_4"
SWEP.ShellModel = "models/shells/shell_556.mdl"
SWEP.ShellPitch = 95
SWEP.ShellScale = 1
SWEP.ShellRotateAngle = Angle(0, 90, 0)

SWEP.MuzzleEffectAttachment = 1 -- which attachment to put the muzzle on
SWEP.CaseEffectAttachment = 2 -- which attachment to put the case effect on

SWEP.SpeedMult = 0.95
SWEP.SightedSpeedMult = 0.38
SWEP.SightTime = 0.25

SWEP.BulletBones = { -- the bone that represents bullets in gun/mag
    -- [0] = "bulletchamber",
    -- [1] = "bullet1"
}

SWEP.IronSightStruct = {
    Pos = Vector(-2.52, -1.9, 0.12),
    Ang = Angle(0, 0, 0),
    ViewModelFOV = 65 / 1.3,
    Magnification = 1.3,
}

SWEP.HoldtypeHolstered = "passive"
SWEP.HoldtypeActive = "ar2"
SWEP.HoldtypeSights = "rpg"

SWEP.AnimShoot = ACT_HL2MP_GESTURE_RANGE_ATTACK_AR2

SWEP.ActivePos = Vector(0, 0, 1)
SWEP.ActiveAng = Angle(0, 0, 0)

SWEP.CustomizePos = Vector(10.479, 0, -1.321)
SWEP.CustomizeAng = Angle(18.2, 39.4, 14.8)

SWEP.HolsterPos = Vector(1, 0, 1)
SWEP.HolsterAng = Angle(-10, 12, 0)

SWEP.SprintPos = Vector(0, 0, 1)
SWEP.SprintAng = Angle(0, 0, 0)

SWEP.BarrelOffsetSighted = Vector(0, 0, -1)
SWEP.BarrelOffsetHip = Vector(2, 0, -2)

SWEP.BarrelLength = 27

SWEP.AttachmentElements = {
    ["grip"] = {
        VMBodygroups = {{ind = 1, bg = 1}},
    },
    ["nors"] = {
        VMBodygroups = {{ind = 2, bg = 1}},
    },
    ["nomuzzle"] = {
        VMBodygroups = {{ind = 4, bg = 1}},
    },
            ["mw2_ubgl_m203"] = {
                VMBodygroups = {{ind = 3, bg = 1}},
            },
            ["mw2_ubgl_masterkey"] = {
                VMBodygroups = {{ind = 3, bg = 2}},
            },
    ["wepcamo-desert"]		= { VMSkin = 1 },
    ["wepcamo-arctic"]		= { VMSkin = 2 },
    ["wepcamo-woodland"]	= { VMSkin = 3 },
    ["wepcamo-digital"]		= { VMSkin = 4 },
    ["wepcamo-urban"]		= { VMSkin = 5 },
    ["wepcamo-bluetiger"]	= { VMSkin = 6 },
    ["wepcamo-redtiger"]	= { VMSkin = 7 },
    ["wepcamo-fall"]		= { VMSkin = 8 },
    ["wepcamo-whiteout"]	= { VMSkin = 9 },
    ["wepcamo-blackout"]        = { VMSkin = 10 },
    ["wepcamo-bushdweller"]     = { VMSkin = 11 },
    ["wepcamo-thunderstorm"]    = { VMSkin = 12 },
}

SWEP.ExtraSightDist = 5

SWEP.Attachments = {
    {
        PrintName = "Optic",
        DefaultAttName = "Iron Sights",
        Slot = "optic",
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(6.972, 0, 4.018),
            vang = Angle(0, 0, 0),
            wang = Angle(-9.738, 0, 180)
        },
        SlideAmount = {
            vmin = Vector(1, 0, 3),
            --vmax = Vector(12.976, 0, 4.018), default position would look weird :P
            vmax = Vector(6, 0, 3),
            wmin = Vector(5.36, 0.739, -5.401),
            wmax = Vector(5.36, 0.739, -5.401),
        },
        InstalledEles = {"nors"},
    },
    {
        PrintName = "Muzzle",
        DefaultAttName = "Standard Muzzle",
        Slot = "muzzle",
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(15, 0, 1.25),
            vang = Angle(0, 0, 0),
            wpos = Vector(33.719, -2.122, -5.573),
            wang = Angle(0, 6.034, 180)
        },
		WMScale = Vector(1, 1, 1),
        InstalledEles = {"nomuzzle"},
    },
    {
        PrintName = "Underbarrel",
        Slot = {"foregrip", "ubgl", "bipod", "foregrip_mw2exclusive", "mw2_ubgl"},
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(18.427, 0, -1.04),
            vang = Angle(0, 0, 0),
            wpos = Vector(14.329, 0.602, -4.453),
            wang = Angle(-2.461, -6.525, 176.662)
        },
        SlideAmount = {
            vmin = Vector(8, 0, 0.4),
            vmax = Vector(11, 0, 0.4),
            wmin = Vector(20.996, -0.991, -3.837),
            wmax = Vector(13.661, -0.078, -3.837),
        },
    },
    {
        PrintName = "Tactical",
        Slot = "tac",
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(12.5, -1, 2.25),
            vang = Angle(0, 0, 90),
            wpos = Vector(15.625, -0.253, -6.298),
            wang = Angle(-8.829, -0.556, 90)
        },
    },
    {
        PrintName = "Fire Group",
        Slot = "fcg",
        DefaultAttName = "Standard FCG"
    },
    {
        PrintName = "Ammo Type",
        Slot = "ammo_bullet"
    },
    {
        PrintName = "Perk",
        Slot = "perk"
    },
    {
        PrintName = "Camouflage",
        DefaultAttName = "None",
        Slot = "mw2_wepcamo",
        FreeSlot = true,
    },
	{
        PrintName = "Charm",
        Slot = "charm",
        FreeSlot = true,
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(2.75, -0.6, 0.75),
            vang = Angle(0, 0, 0),
            wpos = Vector(9.625, 1.5, -4),
            wang = Angle(0, 0, 180)
        },
    },
}

SWEP.Hook_TranslateAnimation = function(wep, anim)
	local attached = wep.Attachments[3].Installed
	
	-- m203 is 1, masterkey is 2, fgrip is 3
	local attthing
		if 		attached == "mw2_ubgl_m203" 		then attthing = 1
		elseif 	attached == "mw2_ubgl_masterkey" 	then attthing = 2
		elseif 	attached 							then attthing = 3
		else 											 attthing = 0
	end
	
	-- when entering ubgl
	if anim == "enter_ubgl" then
		if attthing == 1 then
			return "switch2_alt_m203"
		elseif attthing == 2 then
			return "switch2_alt_masterkey"
		end
	elseif anim == "exit_ubgl" then
		if attthing == 1 then
			return "switch2_gun_m203"
		elseif attthing == 2 then
			return "switch2_gun_masterkey"
		end
	end
	
    if attthing == 1 and wep:GetInUBGL() then
        return "alt_" .. anim .. "_m203"
		elseif attthing == 1 then
			return anim .. "_m203"
		
	elseif attthing == 2 and wep:GetInUBGL() then
        return "alt_" .. anim .. "_masterkey"
		elseif attthing == 2 then
			return anim .. "_masterkey"
		
    elseif attthing == 3 then
        return anim .. "_fgrip"
		
    end
end

SWEP.Animations = {
		["enter_ubgl"] = {
			Source = "idle",
			Time = 0/30
		},
		["exit_ubgl"] = {
			Source = "idle",
			Time = 0/30
		}, 						-- Fuck you.
    ["idle"] = {
        Source = "idle",
        Time = 1/30
    },
    ["enter_sprint"] = {
        Source = "sprint_in",
        Time = 11/30
    },
    ["idle_sprint"] = {
        Source = "sprint_loop",
        Time = 31/40
    },
    ["exit_sprint"] = {
        Source = "sprint_out",
        Time = 11/30
    },
    ["draw"] = {
        Source = "pullout",
        Time = 29/30,
        SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0,
    },
    ["holster"] = {
        Source = "putaway",
        Time = 29/30,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0,
    },
    ["ready"] = {
        Source = "pullout_first",
        Time = 38/30,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_chamber_v1.wav", 	t = 13/30},
					},
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0.25,
    },
    ["fire"] = {
        Source = "fire",
        Time = 6/30,
        ShellEjectAt = 0,
    },
    ["fire_iron"] = {
        Source = "fire_ads",
        Time = 6/30,
        ShellEjectAt = 0,
    },
    ["reload"] = {
        Source = "reload",
        Time = 76/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_lift_v1.wav", 		t = 0},
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_clipout_v1.wav", 	t = 18/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_clipin_v1.wav", 	t = 48/30},
					},
        LHIK = true,
        LHIKIn = 0.5,
        LHIKOut = 0.5,
    },
    ["reload_empty"] = {
        Source = "reload_empty",
        Time = 102/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_lift_v1.wav", 		t = 0},
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_clipout_v1.wav", 	t = 18/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_clipin_v1.wav", 	t = 48/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_hit_v1.wav",		t = 69/30},
					},
        LHIK = true,
        LHIKIn = 0.5,
        LHIKOut = 0.6,
    },
------------------------------------------------
------ Here lies foregrip animations. awesome --
------------------------------------------------
    ["idle_fgrip"] = {
        Source = "idle_fgrip",
        Time = 1/30
    },
    ["enter_sprint_fgrip"] = {
        Source = "sprint_in_fgrip",
        Time = 11/30
    },
    ["idle_sprint_fgrip"] = {
        Source = "sprint_loop",
        Time = 31/40
    },
    ["exit_sprint_fgrip"] = {
        Source = "sprint_out_fgrip",
        Time = 11/30
    },
    ["draw_fgrip"] = {
        Source = "pullout_fgrip",
        Time = 29/30,
        SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0,
    },
    ["holster_fgrip"] = {
        Source = "putaway_fgrip",
        Time = 29/30,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0,
    },
    ["ready_fgrip"] = {
        Source = "pullout_first_fgrip",
        Time = 38/30,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_chamber_v1.wav", 	t = 13/30},
					},
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0.25,
    },
    ["fire_fgrip"] = {
        Source = "fire_fgrip",
        Time = 6/30,
        ShellEjectAt = 0,
    },
    ["fire_iron_fgrip"] = {
        Source = "fire_ads_fgrip",
        Time = 6/30,
        ShellEjectAt = 0,
    },
    ["reload_fgrip"] = {
        Source = "reload_fgrip",
        Time = 76/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_lift_v1.wav", 		t = 0},
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_clipout_v1.wav", 	t = 18/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_clipin_v1.wav", 	t = 48/30},
					},
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0.7,
    },
    ["reload_empty_fgrip"] = {
        Source = "reload_empty_fgrip",
        Time = 102/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_lift_v1.wav", 		t = 0},
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_clipout_v1.wav", 	t = 18/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_clipin_v1.wav", 	t = 48/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_hit_v1.wav",		t = 69/30},
					},
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0.7,
    },
------------------------------------------------
------ Here lies M203 ANIMATIONS ... AWESOME ---
------------------------------------------------
    ["idle_m203"] = {
        Source = "idle_m203",
        Time = 1/30
    },
    ["enter_sprint_m203"] = {
        Source = "sprint_in_m203",
        Time = 11/30
    },
    ["idle_sprint_m203"] = {
        Source = "sprint_loop_m203",
        Time = 31/40
    },
    ["exit_sprint_m203"] = {
        Source = "sprint_out_m203",
        Time = 11/30
    },
    ["draw_m203"] = {
        Source = "pullout_m203",
        Time = 29/30,
        SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0,
    },
    ["holster_m203"] = {
        Source = "putaway_m203",
        Time = 29/30,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0,
    },
    ["ready_m203"] = {
        Source = "pullout_first_m203",
        Time = 38/30,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_chamber_v1.wav", 	t = 13/30},
					},
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0.25,
    },
    ["fire_m203"] = {
        Source = "fire_m203",
        Time = 6/30,
        ShellEjectAt = 0,
    },
    ["fire_iron_m203"] = {
        Source = "fire_ads_m203",
        Time = 6/30,
        ShellEjectAt = 0,
    },
    ["reload_m203"] = {
        Source = "reload_m203",
        Time = 76/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_lift_v1.wav", 		t = 0},
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_clipout_v1.wav", 	t = 18/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_clipin_v1.wav", 	t = 48/30},
					},
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0.7,
    },
    ["reload_empty_m203"] = {
        Source = "reload_empty_m203",
        Time = 102/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_lift_v1.wav", 		t = 0},
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_clipout_v1.wav", 	t = 18/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_clipin_v1.wav", 	t = 48/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_hit_v1.wav",		t = 69/30},
					},
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0.7,
    },
------------------------------------------------
------ Here lies M203 IN THE ANIMATIONS........... ... AWESOME ---
------------------------------------------------
    ["alt_idle_m203"] = {
        Source = "alt_idle_m203",
        Time = 1/30
    },
    ["alt_enter_sprint_m203"] = {
        Source = "alt_sprint_in_m203",
        Time = 11/30
    },
    ["alt_idle_sprint_m203"] = {
        Source = "alt_sprint_loop_m203",
        Time = 31/40
    },
    ["alt_exit_sprint_m203"] = {
        Source = "alt_sprint_out_m203",
        Time = 11/30
    },
    ["alt_draw_m203"] = {
        Source = "alt_pullout_m203",
        Time = 33/30,
        SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
    },
    ["alt_holster_m203"] = {
        Source = "alt_putaway_m203",
        Time = 20/30,
    },
    ["alt_fire_m203"] = {
        Source = "alt_fire_m203",
        Time = 6/30,
    },
    ["alt_reload_m203"] = {
        Source = "alt_reload_m203",
        Time = 79/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_m203_chamber_open_v12.wav", 		t = 12/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_m203_load_v12.wav", 	t = 39/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_m203_chamber_close_v12.wav", 	t = 60/30},
					},
    },
------------------------------------------------
------ Here lies MASTERKEY ANIMATIONS ... AWESOME ---
------------------------------------------------
    ["idle_masterkey"] = {
        Source = "idle_masterkey",
        Time = 1/30
    },
    ["enter_sprint_masterkey"] = {
        Source = "sprint_in_masterkey",
        Time = 11/30
    },
    ["idle_sprint_masterkey"] = {
        Source = "sprint_loop_masterkey",
        Time = 31/40
    },
    ["exit_sprint_masterkey"] = {
        Source = "sprint_out_masterkey",
        Time = 11/30
    },
    ["draw_masterkey"] = {
        Source = "pullout_masterkey",
        Time = 29/30,
        SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0,
    },
    ["holster_masterkey"] = {
        Source = "putaway_masterkey",
        Time = 29/30,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0,
    },
    ["ready_masterkey"] = {
        Source = "pullout_first_masterkey",
        Time = 38/30,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_chamber_v1.wav", 	t = 13/30},
					},
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0.25,
    },
    ["fire_masterkey"] = {
        Source = "fire_masterkey",
        Time = 6/30,
        ShellEjectAt = 0,
    },
    ["fire_iron_masterkey"] = {
        Source = "fire_ads_masterkey",
        Time = 6/30,
        ShellEjectAt = 0,
    },
    ["reload_masterkey"] = {
        Source = "reload_masterkey",
        Time = 76/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_lift_v1.wav", 		t = 0},
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_clipout_v1.wav", 	t = 18/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_clipin_v1.wav", 	t = 48/30},
					},
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0.7,
    },
    ["reload_empty_masterkey"] = {
        Source = "reload_empty_masterkey",
        Time = 102/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_lift_v1.wav", 		t = 0},
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_clipout_v1.wav", 	t = 18/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_clipin_v1.wav", 	t = 48/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_scar_reload_hit_v1.wav",		t = 69/30},
					},
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0.7,
    },
------------------------------------------------
------ Here lies MASTERKEY IN THE ANIMATIONS........... ... AWESOME ---
------------------------------------------------
    ["alt_idle_masterkey"] = {
        Source = "alt_idle_masterkey",
        Time = 1/30
    },
    ["alt_enter_sprint_masterkey"] = {
        Source = "alt_sprint_in_masterkey",
        Time = 11/30
    },
    ["alt_idle_sprint_masterkey"] = {
        Source = "alt_sprint_loop_masterkey",
        Time = 31/40
    },
    ["alt_exit_sprint_masterkey"] = {
        Source = "alt_sprint_out_masterkey",
        Time = 11/30
    },
    ["alt_draw_masterkey"] = {
        Source = "alt_pullout_masterkey",
        Time = 33/30,
        SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
    },
    ["alt_holster_masterkey"] = {
        Source = "alt_putaway_masterkey",
        Time = 20/30,
    },
    ["alt_fire_masterkey"] = {
        Source = "alt_fire_masterkey",
        Time = 10/30,
    },
    ["alt_cycle_masterkey"] = {
        Source = "alt_cycle_masterkey",
        SoundTable = {{s = "weapons/fesiugmw2/foley/wpfoly_winchester_reload_pump_v1.wav", 		t = 3/30}},
        Time = 15/30,
    },
    ["alt_reload_start_masterkey"] = {
        Source = "alt_reload_start_masterkey",
        Time = 35/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_shotattach_reload_lift_v1.wav", 		t = 0/30},
						{s = "MW2Common.Masterkey_Load", 		t = 26/30},
					},
    },
    ["alt_reload_loop_masterkey"] = {
        Source = "alt_reload_loop_masterkey",
        Time = 33/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						{s = "MW2Common.Masterkey_Load", 	t = 24/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_shotattach_reload_end_v1.wav", 	t = 33/30}, -- end
					},
    },
    ["alt_reload_finish_masterkey"] = {
        Source = "alt_reload_finish_masterkey",
        Time = 50/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        SoundTable = {
						--{s = "MW2Common.Masterkey_Load", 	t = 0/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_shotattach_reload_end_v1.wav", 	t = 0/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_winchester_reload_pump_v1.wav", 	t = 22/30},
					},
    },
-----------------------------------------------------
    ["switch2_gun_m203"] = {
        Source = "switch2_gun_m203",
        SoundTable = {{s = "MW2Common.Underbarrel", 		t = 0}},
        Time = 25/30
    },
    ["switch2_alt_m203"] = {
        Source = "switch2_alt_m203",
        SoundTable = {{s = "MW2Common.Underbarrel", 		t = 0}},
        Time = 25/30
    },
    ["switch2_gun_masterkey"] = {
        Source = "switch2_gun_masterkey",
        SoundTable = {{s = "MW2Common.Underbarrel", 		t = 0}},
        Time = 25/30
    },
    ["switch2_alt_masterkey"] = {
        Source = "switch2_alt_masterkey",
        SoundTable = {
						{s = "MW2Common.Underbarrel", 		t = 0},
						{s = "weapons/fesiugmw2/foley/wpfoly_winchester_reload_pump_v1.wav", 		t = 14/30},
					},
        Time = 25/30
    },
}
--lua/weapons/arccw_mw2_tmp.lua:
SWEP.Base = "arccw_mw2_abase"
SWEP.Spawnable = true
SWEP.Category = "ArcCW - MW2"
SWEP.AdminOnly = false
SWEP.WeaponCamBone = tag_camera

SWEP.PrintName = "TMP"
SWEP.Trivia_Class = "Machine Pistol"
SWEP.Trivia_Desc = "Fully automatic, close range."

SWEP.Slot = 1

SWEP.UseHands = true

SWEP.ViewModel = "models/weapons/arccw/fesiugmw2/c_mp9_2.mdl"
SWEP.MirrorVMWM = true
SWEP.WorldModelOffset = {
    pos = Vector(-9, 4, -3.5),
    ang = Angle(-7, 0, 180),
    scale = 1.25
}
SWEP.WorldModel = "models/weapons/w_smg_tmp.mdl"
SWEP.ViewModelFOV = 65

SWEP.Damage = 30
SWEP.DamageMin = 20
SWEP.Range = 500 * 0.025  -- GAME UNITS * 0.025 = METRES
SWEP.Penetration = 4
SWEP.DamageType = DMG_BULLET
SWEP.ShootEntity = nil -- entity to fire, if any


SWEP.ChamberSize = 0
SWEP.Primary.ClipSize = 15 -- DefaultClip is automatically set.
SWEP.ExtendedClipSize = 25
SWEP.ReducedClipSize = 10

SWEP.VisualRecoilMult = 0
SWEP.Recoil = 0.5
SWEP.RecoilSide = 0.55
SWEP.RecoilRise = 0.25

SWEP.Delay = 0.067 -- 60 / RPM.
SWEP.Num = 1 -- number of shots per trigger pull.
SWEP.Firemodes = {
    {
        Mode = 2,
    },
    {
        Mode = 1,
    },
    {
        Mode = 0
    }
}

SWEP.NPCWeaponType = {"weapon_ar2", "weapon_smg1"}
SWEP.NPCWeight = 100

SWEP.AccuracyMOA = 8 -- accuracy in Minutes of Angle. There are 60 MOA in a degree.
SWEP.HipDispersion = 300 -- inaccuracy added by hip firing.
SWEP.MoveDispersion = 175

SWEP.Primary.Ammo = "pistol" -- what ammo type the gun uses

SWEP.ShootVol = 110 -- volume of shoot sound
SWEP.ShootPitch = 100 -- pitch of shoot sound

SWEP.ShootSound =			"weapons/fesiugmw2/fire/miniuzi.wav"
--SWEP.DistantShootSound =	"weapons/fesiugmw2/fire_distant/miniuzi.wav"
SWEP.ShootSoundSilenced =	"weapons/fesiugmw2/fire/usp45_sil.wav"

SWEP.MuzzleEffect = "muzzleflash_4"
SWEP.ShellModel = "models/shells/shell_9mm.mdl"
SWEP.ShellScale = 1
SWEP.ShellRotateAngle = Angle(0, 90, 0)

SWEP.MuzzleEffectAttachment = 1 -- which attachment to put the muzzle on
SWEP.CaseEffectAttachment = 2 -- which attachment to put the case effect on

SWEP.SpeedMult = 1
SWEP.SightedSpeedMult = 0.8
SWEP.SightTime = 0.2

SWEP.BulletBones = { -- the bone that represents bullets in gun/mag
    -- [0] = "bulletchamber",
    -- [1] = "bullet1"
}

SWEP.IronSightStruct = {
    Pos = Vector(-3.2, -2.485, 0.9),
    Ang = Angle(0.629, 0, 0),
    ViewModelFOV = 65 / 1.18,
    Magnification = 1.18,
}

SWEP.HoldtypeHolstered = "normal"
SWEP.HoldtypeActive = "revolver"
SWEP.HoldtypeSights = "revolver"

SWEP.AnimShoot = ACT_HL2MP_GESTURE_RANGE_ATTACK_AR2

SWEP.ActivePos = Vector(-1.1, 0, 1)
SWEP.ActiveAng = Angle(0, 0, 0)

SWEP.CustomizePos = Vector(7, 1, -2)
SWEP.CustomizeAng = Angle(10, 30, 0)

SWEP.HolsterPos = Vector(1, 0, 1)
SWEP.HolsterAng = Angle(-10, 12, 0)

SWEP.SprintPos = Vector(0, 0, 1)
SWEP.SprintAng = Angle(0, 0, 0)

SWEP.BarrelOffsetSighted = Vector(0, 0, -1)
SWEP.BarrelOffsetHip = Vector(2, 0, -2)

SWEP.BarrelLength = 18

SWEP.ExtraSightDist = 0

SWEP.AttachmentElements = {
    ["stock2"] = {
        VMBodygroups =  {{ind = 1, bg = 1}},
    },
    ["grip2"] = {
        VMBodygroups =  {{ind = 2, bg = 1}},
    },
    ["wepcamo-desert"]		= { VMSkin = 1 },
    ["wepcamo-arctic"]		= { VMSkin = 2 },
    ["wepcamo-woodland"]	= { VMSkin = 3 },
    ["wepcamo-digital"]		= { VMSkin = 4 },
    ["wepcamo-urban"]		= { VMSkin = 5 },
    ["wepcamo-bluetiger"]	= { VMSkin = 6 },
    ["wepcamo-redtiger"]	= { VMSkin = 7 },
    ["wepcamo-fall"]		= { VMSkin = 8 },
    ["wepcamo-whiteout"]	= { VMSkin = 9 },
    ["wepcamo-blackout"]        = { VMSkin = 10 },
    ["wepcamo-bushdweller"]     = { VMSkin = 11 },
    ["wepcamo-thunderstorm"]    = { VMSkin = 12 },
}

SWEP.Attachments = {
    {
        PrintName = "Optic",
        DefaultAttName = "Iron Sights",
        Slot = {"optic","optic_lp"},
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(0, 0, 0),
            vang = Angle(0, 0, 0),
        },
        SlideAmount = {
            vmin = Vector(-3, -0.025, 2.15),
            vmax = Vector(1, -0.025, 2.15),
        },
        InstalledEles = {"stock2"},
		ExtraSightDist = 5,
    },
    {
        PrintName = "Muzzle",
        DefaultAttName = "Standard Muzzle",
        Slot = "muzzle",
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(5, 0, 0.9),
            vang = Angle(0, 0, 0),
            wpos = Vector(26.648, 0.782, -8.042),
            wang = Angle(-9.79, 0, 180)
        },
		VMScale = Vector(1, 1, 1),
    },
    {
        PrintName = "Underbarrel",
		Slot = {"foregrip", "bipod","style_pistol"},
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(3, 0, -0.35),
            vang = Angle(0, 0, 0),
            wpos = Vector(14.329, 0.602, -4.453),
            wang = Angle(-10.216, 0, 180)
        },
        InstalledEles = {"stock2","grip2"},
    },
    {
        PrintName = "Tactical",
        Slot = "tac",
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(0, -1.1, 1.4),
            vang = Angle(0, 0, 90),
        },
    },
    {
        PrintName = "Fire Group",
        Slot = "fcg",
        DefaultAttName = "Standard FCG"
    },
    {
        PrintName = "Ammo Type",
        Slot = "ammo_bullet"
    },
    {
        PrintName = "Perk",
        Slot = "perk"
    },
    {
        PrintName = "Camouflage",
        DefaultAttName = "None",
        Slot = "mw2_wepcamo",
        FreeSlot = true,
    },
	{
        PrintName = "Charm",
        Slot = "charm",
        FreeSlot = true,
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(0, -0.8, 1.25),
            vang = Angle(0, 0, 0),
            wpos = Vector(9.625, 1.5, -4),
            wang = Angle(0, 0, 180)
        },
    },
}

SWEP.Animations = { 
    ["idle"] = {
        Source = "idle",
        Time = 2/30,
    },
    ["enter_sprint"] = {
        Source = "sprint_in",
        Time = 11/30
    },
    ["idle_sprint"] = {
        Source = "sprint_loop",
        Time = 31/40
    },
    ["exit_sprint"] = {
        Source = "sprint_out",
        Time = 11/30
    },
    ["draw"] = {
        Source = "pullout",
        Time = 26/30,
        SoundTable = {{s = "MW2Common.Deploy", 		t = 0}},
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0.9,
    },
    ["holster"] = {
        Source = "putaway",
        Time = 14/30,
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0.9,
    },
    ["fire"] = {
        Source = "fire",
        Time = 7/30,
        ShellEjectAt = 0,
    },
    ["fire_iron"] = {
        Source = "fire_ads",
        Time = 7/30,
        ShellEjectAt = 0,
    },
    ["reload"] = {
        Source = "reload",
        Time = 63/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_mp9_reload_lift_v1.wav", 		t = 0/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_mp9_reload_clipout_v1.wav", 	t = 10/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_mp9_reload_clipin_v1.wav", 	t = 32/30},
					},
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0.5,
    },
    ["reload_empty"] = {
        Source = "reload_empty",
        Time = 89/30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        SoundTable = {
						{s = "weapons/fesiugmw2/foley/wpfoly_miniuzi_reload_lift_v1.wav", 	t = 0/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_mp9_reload_clipout_v1.wav", 	t = 9/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_mp9_reload_clipin_v1.wav", 	t = 32/30},
						{s = "weapons/fesiugmw2/foley/wpfoly_mp9_reload_chamber_v1.wav", 	t = 59/30},
					},
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0.5,
    },
}
--lua/weapons/arccw_mw2_usp.lua:
return gluapack()()
--lua/weapons/arccw_mw2_w1200.lua:
return gluapack()()
--lua/weapons/arccw_uc_scar47.lua:
return gluapack()()
--lua/weapons/arccw_ud_870.lua:
return gluapack()()
--lua/weapons/arccw_ud_m16.lua:
SWEP.Base = "arccw_base"
SWEP.Spawnable = true
SWEP.Category = "ArcCW - Urban Coalition"
SWEP.UC_CategoryPack = "1Urban Decay"
SWEP.AdminOnly = false
SWEP.UseHands = true

-- Muzzle and shell effects --

SWEP.MuzzleEffect = "muzzleflash_1"
SWEP.ShellEffect = "arccw_uc_shelleffect"
SWEP.ShellModel = "models/weapons/arccw/uc_shells/556x45.mdl"
SWEP.ShellScale = .666
SWEP.ShellPitch = 100

SWEP.MuzzleEffectAttachment = 1
SWEP.CaseEffectAttachment = 2
SWEP.CamAttachment = 3
SWEP.TracerNum = 1
SWEP.TracerCol = Color(25, 255, 25)
SWEP.TracerWidth = 2

-- Fake name --

SWEP.PrintName = "RAYCAR-0"
-- AMCAR stands for (american) Colt Assault Rifle, not Carbine!! ~Fesiug
-- shut up retard ~zenith

-- True name --

SWEP.TrueName = "M16A2"

-- Trivia --
SWEP.Trivia_Class = "Assault Rifle"
SWEP.Trivia_Desc = "Third generation of America's iconic military rifle. Army tests showed that soldiers were more likely to hit a target if they fired multiple shots, but were likely to spray in full-auto and fail to hit anything. As a result, they implemented a ratcheted three-round burst system which limited the maximum burst a soldier could fire to three shots.\n\nWell-rounded gun with no major downsides."
SWEP.Trivia_Manufacturer = "Rayter Arms Industries"
SWEP.Trivia_Calibre = "5.56x45mm NATO"
SWEP.Trivia_Mechanism = "Gas-Operated Rotating Bolt"
SWEP.Trivia_Country = "USA"
SWEP.Trivia_Year = 1959


if GetConVar("arccw_truenames"):GetBool() then
    SWEP.PrintName = SWEP.TrueName
    SWEP.Trivia_Manufacturer = "Stoner's Legacy Ltd."
end

local origDesc = SWEP.Trivia_Desc
local m4Desc = "Carbine variant of the M16 rifle. Originally designed in response to design faults in the CAR-15 family, it eventually replaced the M16 across much of the Army for its favorably low weight and comparable performance. The M4 variant has since become one of the most iconic and widespread American service rifles in the modern era.\n\nLight and versatile, but requires discipline to control."
local ncrDesc = "Standard-issue rifle of the New California Republic. Traditionally produced with a semi-automatic receiver, the wooden furniture is more readily replaceable and adds additional recoil control for maximum accuracy.\n\nWell-rounded gun with no major downsides."
local smgDesc = "Submachine gun based on the M16 rifle. Despite its similar appearance, it uses a different mechanism from its parent rifle. More accurate than other submachine guns due to its rifle frame and closed-bolt mechanism."
local blkDesc = "Aftermarket automatic variant of the M16 rifle. The .300 Blackout cartridge has a ballistic performance more akin to the 7.62x39mm Soviet cartridge, with a similarly sized projectile but shorter effective range."
local ukDesc = "AR-15 style rifles are a class of rifles linked to the M16, normally with a semi-automatic fire group for the civilian market. This one, however, has been neutered by authority of the British crown with a manual-action receiver. Bit cringe, innit?"
local arDesc = "Semi-automatic variant of the M16 series of rifles, produced for the civilian market. Wildly popular in the United States, this rifle can be seen in the hands of hobbyists, hunters and mass shooters alike.\n\nWell-rounded gun with no major downsides."
local beoDesc = "Aftermarket semi-automatic variant of the M16 rifle firing an oversized magnum cartridge. Provides extremely high stopping power at close range."
local carDesc = "Carbine variant of the M16 rifle, short enough to be classified as a submachine gun. Its features influenced the US Army's interest in the M4 Carbine, which went on to become their new standard rifle. Due to the small barrel, rifles of this family have high maneuverability but poor range compared to their parent platform."
local a1Desc = "Second generation of America's iconic military rifle. Developed to address problems with the original M16, which suffered notoriously frequent jamming that could get its wielder killed. The revised model evolved a positive reputation with those who used it, and is now a universal symbol of the Vietnam War.\n\nA well-rounded rifle, but difficult to control without trigger discipline - something the A2 model eventually addressed."
local a3Desc = "Variant of the M16A2 with the original full-automatic trigger group, relegated to niche roles in the US Army. Well-rounded gun with no major downsides."
local lmgDesc = "Configuration of the M16 designed for a light machine gun role, used vaguely within the Marine Corps before the adoption of the Minimi. Heavier than the standard platform, but the integral bipod can be deployed onto surfaces for excellent recoil control."
local patriotDesc = "An assault pistol developed for The Boss. The feeder mechanism inside the drum magazine forms an \"∞\" shape.\n\nThe bottomless magazine more than makes up for the awkwardness of the configuration."

-- Weapon slot --

SWEP.Slot = 2

-- Weapon's manufacturer real name --

if GetConVar("arccw_truenames"):GetBool() then
    SWEP.PrintName = SWEP.TrueName
    SWEP.Trivia_Manufacturer = "Colt's Manufacturing Company"
end

-- Viewmodel / Worldmodel / FOV --

SWEP.ViewModel = "models/weapons/arccw/c_ud_m16.mdl"
SWEP.WorldModel = "models/weapons/arccw/c_ud_m16.mdl"
SWEP.ViewModelFOV = 80
SWEP.AnimShoot = ACT_HL2MP_GESTURE_RANGE_ATTACK_AR2

-- Damage --

SWEP.Damage = ArcCW.UC.StdDmg["556"].max
SWEP.DamageMin = ArcCW.UC.StdDmg["556"].min
SWEP.RangeMin = 50
SWEP.Range = 350 -- 4 shot until ~250m

SWEP.Penetration = ArcCW.UC.StdDmg["556"].pen
SWEP.DamageType = DMG_BULLET
SWEP.ShootEntity = nil
SWEP.MuzzleVelocity = 960
SWEP.PhysBulletMuzzleVelocity = 960

SWEP.BodyDamageMults = ArcCW.UC.BodyDamageMults

-- Mag size --

SWEP.ChamberSize = 1
SWEP.Primary.ClipSize = 30
SWEP.ExtendedClipSize = 40
SWEP.ReducedClipSize = 20

-- Recoil --

SWEP.Recoil = 0.5
SWEP.RecoilSide = 0.25

SWEP.RecoilRise = 0.1
SWEP.RecoilPunch = 1
SWEP.VisualRecoilMult = 1
SWEP.MaxRecoilBlowback = 1
SWEP.MaxRecoilPunch = 1
SWEP.RecoilPunchBack = 1

SWEP.Sway = 0.5

-- Firerate / Firemodes --

SWEP.Delay = 60 / 900
SWEP.Num = 1
SWEP.Firemodes = {
    {
        Mode = -3,
        PostBurstDelay = 0.1,
        RunawayBurst = false, -- https://en.wikipedia.org/wiki/Burst_mode_(weapons)
    },
    {
        Mode = 1,
    },
    {
        Mode = 0
    }
}

SWEP.ShootPitch = 100
SWEP.ShootVol = 120
SWEP.ShootPitchVariation = 0

SWEP.ProceduralRegularFire = false
SWEP.ProceduralIronFire = false

SWEP.ReloadInSights = true

-- NPC --

SWEP.NPCWeaponType = "weapon_ar2"
SWEP.NPCWeight = 60

-- Accuracy --

SWEP.AccuracyMOA = 4
SWEP.HipDispersion = 800
SWEP.MoveDispersion = 200
SWEP.JumpDispersion = 1000

SWEP.Primary.Ammo = "smg1"
SWEP.MagID = "m16"

SWEP.HeatCapacity = 150
SWEP.HeatDissipation = 10
SWEP.HeatDelayTime = 3

SWEP.MalfunctionMean = 200
SWEP.MalfunctionTakeRound = false

-- Speed multipliers --

SWEP.SpeedMult = 0.925
SWEP.SightedSpeedMult = 0.75
SWEP.SightTime = 0.35
SWEP.ShootSpeedMult = 0.9

-- Length --

SWEP.BarrelLength = 48
SWEP.ExtraSightDist = 2

-- Ironsights / Customization / Poses --

SWEP.HolsterPos = Vector(0.5, -1, 1.2)
SWEP.HolsterAng = Angle(-8.5, 8, -10)

SWEP.HoldtypeHolstered = "passive"
SWEP.HoldtypeActive = "ar2"
SWEP.HoldtypeSights = "rpg"

SWEP.IronSightStruct = {
     Pos = Vector(-2.815, 0, 1.3),
     Ang = Angle(0, 0, 0),
     Magnification = 1.1,
     SwitchToSound = "",
}

SWEP.ActivePos = Vector(0.33, -2, 1.33)
SWEP.ActiveAng = Angle(0, 0, -3)

-- SWEP.CustomizePos = Vector(5, -2, -2)
-- SWEP.CustomizeAng = Angle(15, 25, 0)
SWEP.CustomizePos = Vector(0, 0, 0)
SWEP.CustomizeAng = Angle(0, 0, 0)

SWEP.CrouchPos = Vector(-2.5, -2, -0.6)
SWEP.CrouchAng = Angle(0, 0, -14)

SWEP.BarrelOffsetHip = Vector(2, 0, -5)

SWEP.MirrorVMWM = true
SWEP.WorldModelOffset = {
    pos        =    Vector(-8.5, 4, -5),
    ang        =    Angle(-12, 0, 180),
    bone    =    "ValveBiped.Bip01_R_Hand",
    --scale = .85
}

-- Firing sounds --

local path = ")weapons/arccw_ud/m16/"
local common = ")/arccw_uc/common/"

SWEP.ShootSound = {
    path .. "fire-01.ogg",
    path .. "fire-02.ogg",
    path .. "fire-03.ogg",
    path .. "fire-04.ogg",
    path .. "fire-05.ogg",
    path .. "fire-06.ogg"
}
SWEP.ShootSoundSilenced = {
    path .. "fire-sup-01.ogg",
    path .. "fire-sup-02.ogg",
    path .. "fire-sup-03.ogg",
    path .. "fire-sup-04.ogg",
    path .. "fire-sup-05.ogg",
    path .. "fire-sup-06.ogg"
}

SWEP.DistantShootSound = nil
SWEP.DistantShootSoundSilenced = nil
SWEP.ShootDrySound = path .. "dryfire.ogg"

local tail = ")/arccw_uc/common/556x45/"

SWEP.DistantShootSoundOutdoors = {
    tail .. "fire-dist-556x45-rif-ext-01.ogg",
    tail .. "fire-dist-556x45-rif-ext-02.ogg",
    tail .. "fire-dist-556x45-rif-ext-03.ogg",
    tail .. "fire-dist-556x45-rif-ext-04.ogg",
    tail .. "fire-dist-556x45-rif-ext-05.ogg",
    tail .. "fire-dist-556x45-rif-ext-06.ogg"
}
SWEP.DistantShootSoundIndoors = {
    common .. "fire-dist-int-rifle-01.ogg",
    common .. "fire-dist-int-rifle-02.ogg",
    common .. "fire-dist-int-rifle-03.ogg",
    common .. "fire-dist-int-rifle-04.ogg",
    common .. "fire-dist-int-rifle-05.ogg",
    common .. "fire-dist-int-rifle-06.ogg"
}
SWEP.DistantShootSoundOutdoorsSilenced = {
    common .. "sup-tail-01.ogg",
    common .. "sup-tail-02.ogg",
    common .. "sup-tail-03.ogg",
    common .. "sup-tail-04.ogg",
    common .. "sup-tail-05.ogg",
    common .. "sup-tail-06.ogg",
    common .. "sup-tail-07.ogg",
    common .. "sup-tail-08.ogg",
    common .. "sup-tail-09.ogg",
    common .. "sup-tail-10.ogg"
}
SWEP.DistantShootSoundIndoorsSilenced = {
    common .. "fire-dist-int-pistol-light-01.ogg",
    common .. "fire-dist-int-pistol-light-02.ogg",
    common .. "fire-dist-int-pistol-light-03.ogg",
    common .. "fire-dist-int-pistol-light-04.ogg",
    common .. "fire-dist-int-pistol-light-05.ogg",
    common .. "fire-dist-int-pistol-light-06.ogg"
}
SWEP.DistantShootSoundOutdoorsVolume = 1
SWEP.DistantShootSoundIndoorsVolume = 1
SWEP.Hook_AddShootSound = ArcCW.UC.InnyOuty

-- Bodygroups --

SWEP.BulletBones = {
    [2] = "m16_bullets1",    [3] = "m16_bullets2"
}

SWEP.DefaultBodygroups = "00000000000000000000000"

SWEP.AttachmentElements = {

    ["ud_m16_mag_20"] = {
        VMBodygroups = {{ind = 2, bg = 1}},
    },
    ["ud_m16_mag_40"] = {
        VMBodygroups = {{ind = 2, bg = 2}},
    },
    ["ud_m16_pmag"] = {
        VMBodygroups = {{ind = 2, bg = 9}},
    },
    ["ud_m16_mag_60"] = {
        VMBodygroups = {{ind = 2, bg = 3}},
    },
    ["ud_m16_mag_100"] = {
        VMBodygroups = {{ind = 2, bg = 4}},
    },
    ["ud_m16_9mm_mag"] = {
        VMBodygroups = {{ind = 2, bg = 5}},
    },
    ["ud_m16_9mm_mag_32"] = {
        VMBodygroups = {{ind = 2, bg = 6}},
    },
    ["ud_m16_mag_50beo"] = {
        VMBodygroups = {{ind = 2, bg = 8}},
    },
    ["ud_m16_mag_50beo_12"] = {
        VMBodygroups = {{ind = 2, bg = 0}},
    },

    ["upper_flat"] = {
        -- handled by code
        --[[]
        VMBodygroups = {
            {ind = 1, bg = 1},
            {ind = 3, bg = 3}
        },
        ]]
    },
    ["upper_classic"] = {
        VMBodygroups = {
            {ind = 1, bg = 3},
        },
    },
    ["rail_fg"] = {
        VMBodygroups = {{ind = 9, bg = 1}}
    },

    ["stock_231_ex"] = {
        VMBodygroups = {{ind = 7, bg = 1}},
    },
    ["stock_231_in"] = {
        VMBodygroups = {{ind = 7, bg = 2}},
    },
    ["stock_231_tube"] = {
        VMBodygroups = {{ind = 7, bg = 3}},
    },
    ["stock_607_ex"] = {
        VMBodygroups = {{ind = 7, bg = 4}},
    },
    ["stock_607_in"] = {
        VMBodygroups = {{ind = 7, bg = 5}},
    },
    ["stock_608"] = {
        VMBodygroups = {{ind = 7, bg = 6}},
    },
    ["stock_carbine_ex"] = {
        VMBodygroups = {{ind = 7, bg = 7}},
    },
    ["stock_carbine_in"] = {
        VMBodygroups = {{ind = 7, bg = 8}},
    },
    ["stock_wood"] = {
        VMBodygroups = {{ind = 7, bg = 9}},
    },
    ["stock_adar"] = {
        VMBodygroups = {
            {ind = 7, bg = 10},
            {ind = 8, bg = 4}
        },
    },
    ["stock_ru556"] = {
        VMBodygroups = {{ind = 7, bg = 11}},
    },
    ["grip_ergo"] = {
        VMBodygroups = {{ind = 8, bg = 1}},
    },
    ["grip_skel"] = {
        VMBodygroups = {{ind = 8, bg = 2}},
    },
    ["grip_wood"] = {
        VMBodygroups = {{ind = 8, bg = 3}},
    },

    ["gasblock_carbine"] = {
        VMBodygroups = {{ind = 6, bg = 3}},
    },
    ["fs_adar"] = {
        VMBodygroups = {{ind = 6, bg = 4}},
    },
    ["remove_lug"] = {
        VMBodygroups = {{ind = 12, bg = 1}},
    },

    ["mount_14"] = {
        AttPosMods = {
            [8] = {
                vpos = Vector(0, 0.3, 17.5),
                vang = Angle(90, 0, -90),
            },
        },
    },
    ["mount_11"] = {
        AttPosMods = {
            [8] = {
                vpos = Vector(0.6, -0.3, 14.2),
                vang = Angle(90, 0, 0),
            },
        },
    },
    ["mount_tactical"] = {
        AttPosMods = {
            [8] = {
                vpos = Vector(-1, -.35, 11.5),
                vang = Angle(-90, 180, 0),
                wang = Angle(90, 0, 0),
            },
        },
        ExcludeFlags = {}
    },
    -- ["mount_tactical_short"] = {
    --     AttPosMods = {
    --         [8] = {
    --             vpos = Vector(-1, -.35, 11.5),
    --             vang = Angle(-90, 180, 0),
    --             wang = Angle(90, 0, 0),
    --         },
    --     },
    --     AttPosMods_Priority = 2,
    --     RequireFlags = {"barrel_short"}
    -- },

    ["barrel_14"] = {
        VMBodygroups = {
            {ind = 4, bg = 1},
            {ind = 6, bg = 2},
        },
        AttPosMods = {
            [4] = {
                vpos = Vector(0, -0.33, 18.85),
                vang = Angle(90, 0, -90),
            },
            [16] = {
                vpos = Vector(0, -1.65, 12.5), -- 21.75 or 15.75
                vang = Angle(90, 0, -90),
            },
        }
    },
    ["barrel_11"] = {
        VMBodygroups = {
            {ind = 4, bg = 4},
            {ind = 6, bg = 2},
        },
        AttPosMods = {
            [4] = {
                vpos = Vector(0, -0.33, 15.7),
                vang = Angle(90, 0, -90),
            },
            [16] = {
                vpos = Vector(0, -1.65, 12.5), -- 21.75 or 15.75
                vang = Angle(90, 0, -90),
            },
        }
    },
    ["barrel_fpw"] = {
        VMBodygroups = {
            {ind = 4, bg = 2},
            {ind = 6, bg = 5},
        },
        AttPosMods = {
            [4] = {
                vpos = Vector(0, -0.07, 21.3),
                vang = Angle(90, 0, -90),
            },
        }
    },
    ["barrel_11_ru556"] = {
        VMBodygroups = {
            {ind = 4, bg = 4},
            {ind = 6, bg = 5},
        },
        AttPosMods = {
            [3] = {
                vpos = Vector(0, -0.07, 21.3),
                vang = Angle(90, 0, -90),
            },
            [6] = {
                vpos = Vector(1.15, 0, 17.9),
                vang = Angle(90, 0, 0),
            },
            [16] = {
                vpos = Vector(0, -1.65, 12.5), -- 21.75 or 15.75
                vang = Angle(90, 0, -90),
            },
        }
    },

    ["hg_m16a4_ris"] = {
        VMBodygroups = {
            {ind = 5, bg = 2},
        },
        AttPosMods = {
            [5] = {
                vpos = Vector(-0.1, 1.05, 12),
                vang = Angle(90, 0, -90),
            },
            [6] = {
                vpos = Vector(1.41, -.1, 20),
                vang = Angle(90, 0, 0),
            },
            [16] = {
                vpos = Vector(0, -1.75, 21.75), -- 21.75 or 15.75
                vang = Angle(90, 0, -90),
            },
        }
    },
    ["hg_m4a1_ris"] = {
        VMBodygroups = {
            {ind = 5, bg = 5},
        },
        AttPosMods = {
            [5] = {
                vpos = Vector(0, 1.4, 12),
                vang = Angle(90, 0, -90),
            },
            [6] = {
                vpos = Vector(-1.41, -.2, 14),
                vang = Angle(90, 0, 180),
            },
            [15] = {
                vpos = Vector(0, -1.75, 15.75), -- 21.75 or 15.75
                vang = Angle(90, 0, -90),
            },
        },
    },
    ["hg_ru556"] = {
        -- VMBodygroups = {
        --     {ind = 5, bg = 7},
        -- },
        AttPosMods = {
            -- [5] = {
            --     vpos = Vector(-0.1, 1.05, 12),
            --     vang = Angle(90, 0, -90),
            -- },
            -- [6] = {
            --     vpos = Vector(1.1, 0, 14),
            --     vang = Angle(90, 0, 0),
            -- },
            [16] = {
                vpos = Vector(0, -1.65, 12.5), -- 21.75 or 15.75
                vang = Angle(90, 0, -90),
            },
        },
    },
    ["hg_m4a1"] = {
        VMBodygroups = {
            {ind = 5, bg = 4},
        }
    },
    ["hg_cqbr"] = {
        VMBodygroups = {
            {ind = 5, bg = 4},
        },
    },
    ["hg_adar"] = {
        VMBodygroups = {
            {ind = 5, bg = 8},
        },
    },
    ["hg_fpw"] = {
        VMBodygroups = {
            {ind = 5, bg = 6},
            --{ind = 6, bg = 4},
        }
    },
    ["hg_m16a1"] = {
        VMBodygroups = {
            {ind = 5, bg = 1},
        }
    },
    ["hg_m16a1_wood"] = {
        VMBodygroups = {
            {ind = 5, bg = 1},
        },
        VMSkin = 1
    },
    ["ud_m16_hg_heat"] = {
        VMElements = {
            {
                Model = "models/weapons/arccw/atts/m203iron.mdl",
                Bone = "m16_parent",
                Scale = Vector(1, 1, 1),
                Offset = {
                    pos = Vector(0, -1.2, 14.9),
                    ang = Angle(90, 0, -90),
                }
            }
        },
        UC_UseClassicM203Mount = true,
    },
    ["hg_m605"] = {
        VMBodygroups = {
            {ind = 5, bg = 1},
            {ind = 4, bg = 1},
        },
        AttPosMods = {
            [3] = {
                vpos = Vector(0, -0.05, 25.58),
                vang = Angle(90, 0, -90),
            },
            [6] = { -- also has no rail
                vpos = Vector(0, 0.9, 22.2),
                vang = Angle(90, 0, -90),
            },
        }
    },
    ["hg_m605_wood"] = {
        VMBodygroups = {
            {ind = 5, bg = 1},
            {ind = 4, bg = 1},
        },
        AttPosMods = {
            [3] = {
                vpos = Vector(0, 0, 25),
                vang = Angle(90, 0, -90),
            },
            [6] = { -- also has no rail
                vpos = Vector(0, 0.8, 22),
                vang = Angle(90, 0, -90),
            },
        },
        VMSkin = 1
    },
    ["hg_lmg"] = {
        VMBodygroups = {
            {ind = 5, bg = 3},
        }
    },
    ["hg_sd"] = {
        VMBodygroups = {
            {ind = 5, bg = 9},
            {ind = 4, bg = 3},
            {ind = 6, bg = 5}
        },
        AttPosMods = { -- no rail, just pretend it's mounted to something
            -- [8] = {
            --     vpos = Vector(0, 0.7, 17.5),
            --     vang = Angle(90, 0, -90),
            -- },
            [16] = {
                vpos = Vector(0, -1.65, 11.5), -- 21.75 or 15.75
                vang = Angle(90, 0, -90),
            },
        }
    },

    ["ud_m16_upper_charm"] = {
        AttPosMods = {
            [1] = {
                vpos = Vector(0, -4, 3),
                vang = Angle(90, 0, -90),
                SlideAmount = {
                    vmin = Vector(0, -3.4, 3 - 1.5),
                    vmax = Vector(0, -3.4, 3 + 1.5),
                }
            },
        },
    },
    ["ud_m16_upper_charm2"] = {
        AttPosMods = {
            [1] = {
                vpos = Vector(0, -4.1, 3.5),
                vang = Angle(90, 0, -90),
                SlideAmount = {
                    vmin = Vector(0, -3.5, 3.5 - 2),
                    vmax = Vector(0, -3.5, 3.5 + 1),
                }
            },
        },
    },
    ["bravo_dicks_going_fart"] = {
        AttPosMods = {
            [8] = {
                vpos = Vector(0.25, -1.4, 12),
                vang = Angle(90, 0, 90),
            },
        },
    },

    ---- Cut content
    ["hg_stub"] = {
        VMBodygroups = {
            {ind = 5, bg = 7},
        },
        AttPosMods = {
            [3] = {
                vpos = Vector(0, -0.35, 7),
                vang = Angle(90, 0, -90)
            },
            [6] = {
                vpos = Vector(1.1, -0.4, 9),
                vang = Angle(90, 0, 0),
            },
        }
    },
    ["barrel_stub"] = {
        VMBodygroups = {
            {ind = 4, bg = 4},
            {ind = 6, bg = 4},
        }
    },
    ["hg_smg"] = {
        VMBodygroups = {
            {ind = 5, bg = 0},
        }
    },
    ["m16_strap"] = {
        VMBodygroups = {
             {ind = 13, bg = 1},
        },
    },
}

-- Animations --

SWEP.Hook_Think = ArcCW.UC.ADSReload

local sr_pmag = {
	[path .. "magout_empty.ogg"] = path .. "pmagout.ogg",
	[path .. "magin.ogg"] = path .. "pmagin.ogg",
}

local pmag1, pmag2 = {}, {"ud_m16_pmag"}
SWEP.Hook_TranslateSound = function(wep, data)
	if wep:CheckFlags(pmag1, pmag2) and sr_pmag[data] then return sr_pmag[data] end
end

local rottle = {common .. "cloth_1.ogg", common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}
local ratel = {common .. "rattle1.ogg", common .. "rattle2.ogg", common .. "rattle3.ogg"}

SWEP.Animations = {
    ["ready"] = {
        Source = "fix",
        Time = 45 / 30,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = common .. "raise.ogg", t = 0},
            {s = common .. "rattle.ogg", t = 0.2},
            {s = path .. "chback.ogg",   t = 0.15},
            {s = common .. "cloth_4.ogg",  t = 0.5},
            {s = path .. "chamber.ogg",  t = 0.5},
        },
        ProcDraw = true,
    },
    ["idle"] = {
        Source = "idle",
    },
    ["idle_empty"] = {
        Source = "idle_empty",
    },
    ["draw"] = {
        Source = "draw",
        SoundTable = {
            {s = common .. "raise.ogg", t = 0},
            {s = common .. "shoulder.ogg", t = 0.15},
            {s = ratel, t = 0.2},
        },
    },
    ["draw_empty"] = {
        Source = "draw_empty",
        Time = 20 / 30,
        SoundTable = {
            {s = common .. "raise.ogg", t = 0},
            {s = common .. "shoulder.ogg", t = 0.15},
            {s = ratel, t = 0.2},
        },
    },
    ["holster"] = {
        Source = "holster",
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = ratel, t = 0},
            {s = common .. "cloth_6.ogg", t = 0.2},
        },
    },
    ["holster_empty"] = {
        Source = "holster_empty",
        Time = 20 / 30,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = ratel, t = 0},
            {s = common .. "cloth_6.ogg", t = 0.2},
        },
    },
    ["trigger"] = {
        Source = "idle",
        MinProgress = .1,
        SoundTable = {
            {s = ")weapons/arccw_ud/uzi/prefire.ogg",         t = 0, c = ci},
        },
    },
    ["fire"] = {
        Source = "fire",
        Time = 13 / 30,
        ShellEjectAt = 0.01,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0, v = 0.25 }},
    },
    ["fire_iron"] = {
        Source = "fire",
        Time = 13 / 30,
        ShellEjectAt = 0.01,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0 }},
    },
    ["fire_empty"] = {
        Source = "fire_empty",
        Time = 13 / 30,
        ShellEjectAt = 0.01,
        SoundTable = {
            {s = path .. "mech_last.ogg", t = 0}, -- Temporary
        },
    },
    ["fire_iron_empty"] = {
        Source = "fire_empty",
        Time = 13 / 30,
        ShellEjectAt = 0.01,
        SoundTable = {
            {s = path .. "mech_last.ogg", t = 0}, -- Temporary
        },
    },

    ["fire_cycle"] = {
        Source = "fire",
        Time = 13 / 30,
    },

    ["cycle"] = {
        Source = "fix",
        Time = 36 / 30 * 0.7,
        ShellEjectAt = 0.3,
        LHIK = true,
        LHIKIn = 0.3 * 0.7,
        LHIKEaseIn = 0.4 * 0.7,
        LHIKEaseOut = 0.15 * 0.7,
        LHIKOut = 0.4 * 0.7,
        SoundTable = {
            {s = path .. "chback.ogg",   t = 0.05},
            {s = common .. "cloth_4.ogg",  t = 0.2},
            {s = path .. "chamber.ogg",  t = 0.3},
        },
    },

    ["fix"] = {
        Source = "fix",
        Time = 45 / 30,
        ShellEjectAt = false,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = path .. "chback.ogg",   t = 0.15},
            {s = common .. "cloth_4.ogg",  t = 0.5},
            {s = path .. "chamber.ogg",  t = 0.5},
        },
    },
    ["fix_empty"] = {
        Source = "fix_empty",
        Time = 45 / 30,
        ShellEjectAt = false,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = path .. "chback.ogg",   t = 0.15},
            {s = common .. "cloth_4.ogg",  t = 0.5},
            {s = path .. "ch_forward_empty.ogg",  t = 0.5},
        },
    },

    -- 30 Round Reloads --

    ["reload"] = {
        Source = "reload",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 71 / 30,
        MinProgress = 1.5,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.7,
        SoundTable = {
            {s = rottle,  t = 0.0},
            {s = common .. "magpouch_gear.ogg", t = 0.2, v = 0.5},
            {s = ratel, t = 0.25},
            {s = path .. "magout_empty.ogg", 	 t = 0.23},
            {s = ratel, t = 0.5},
            {s = path .. "struggle.ogg",    t = 1, v = 0.4},
            {s = path .. "magin.ogg",    t = 0.97},
            {s = ratel, t = 1.1},
            {s = rottle,  t = 1.15},
            {s = common .. "grab-polymer.ogg", t = 1.77, v = 0.25},
            {s = common .. "rattle_b2i_rifle.ogg", t = 1.7},
            {s = common .. "shoulder.ogg", t = 1.8},
        },
    },
    ["reload_empty"] = {
        Source = "reload_empty",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 87 / 30,
        MinProgress = 2,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.9,
        SoundTable = {
            {s = rottle,  t = 0.0},
            {s = ratel, t = 0.25},
            {s = common .. "magpouch_gear.ogg", t = 0.1, v = 0.5},
            {s = path .. "magout_empty.ogg", 	 t = 0.2},
            {s = ratel, t = 0.5},
            {s = common .. "rifle_magdrop.ogg",  t = 0.65},
            {s = path .. "struggle.ogg",    t = 0.95, v = 0.4},
            {s = path .. "magin.ogg",    t = 0.95},
            {s = ratel, t = 1.1},
            {s = rottle,  t = 1.39},
            {s = path .. "boltdrop.ogg", t = 1.7},
            {s = ratel, t = 1.9},
            {s = common .. "rattle_b2i_rifle.ogg", t = 2.0},
            {s = common .. "grab-polymer.ogg", t = 2.1, v = 0.35},
            {s = common .. "shoulder.ogg", t = 2.1},
        },
    },

    -- 20 Round Reloads --

    ["reload_20"] = {
        Source = "reload_20",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 71 / 30,
        MinProgress = 1.5,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.7,
        SoundTable = {
            {s = rottle,  t = 0.0},
            {s = ratel, t = 0.05},
            {s = path .. "magout_empty.ogg", 	 t = 0.09},
            {s = common .. "magpouch_gear.ogg", t = 0.1},
            {s = rottle,  t = 0.75},
            {s = ratel, t = 0.85},
            {s = path .. "struggle.ogg",    t = 0.9, v = 0.4},
            {s = path .. "magin.ogg",    t = 0.95},
            {s = rottle,  t = 1.1},
            {s = ratel, t = 1.125},
            {s = common .. "rattle_b2i_rifle.ogg", t = 1.65},
            {s = common .. "grab-polymer.ogg", t = 1.7, v = 0.25},
            {s = common .. "shoulder.ogg", t = 1.75},
        },
    },
    ["reload_empty_20"] = {
        Source = "reload_empty_20",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 86 / 30,
        MinProgress = 2,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.3,
        LHIKOut = 0.8,
        SoundTable = {
            {s = common .. "magpouch_gear.ogg", t = 0},
            {s = rottle, t = 0.01},
            {s = ratel, t = 0.05},
            {s = path .. "magout_empty.ogg", 	 t = 0.075},
            {s = rottle, t = 0.75},
            {s = ratel, t = 0.9},
            {s = common .. "rifle_magdrop.ogg",  t = 0.65},
            {s = path .. "struggle.ogg",    t = 0.8, v = 0.4},
            {s = path .. "magin.ogg",    t = 0.85},
            {s = rottle, t = 1.4},
            {s = ratel, t = 1.4},
            {s = path .. "chamber_press.ogg", t = 1.72},
            {s = common .. "rattle_b2i_rifle.ogg", t = 1.95},
            {s = common .. "grab-polymer.ogg", t = 2.075, v = 0.25},
            {s = common .. "shoulder.ogg", t = 2.13},
        },
    },

    -- 40 Round Reloads --

    ["reload_40"] = {
        Source = "reload_40",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 71 / 30,
        MinProgress = 1.5,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.7,
        SoundTable = {
            {s = rottle, t = 0.0},
            {s = ratel, t = 0.1},
            {s = path .. "magout_empty.ogg", 	 t = 0.2},
            {s = common .. "magpouch_gear.ogg", t = 0.25},
            {s = rottle, t = 0.75},
            {s = ratel, t = 0.8},
            {s = path .. "struggle.ogg",    t = 0.95, v = 0.4},
            {s = path .. "magin.ogg",    t = 1.0},
            {s = rottle, t = 1.1},
            {s = ratel, t = 1.25},
            {s = common .. "rattle_b2i_rifle.ogg", t = 1.65},
            {s = common .. "shoulder.ogg", t = 1.75},
        },
    },
    ["reload_empty_40"] = {
        Source = "reload_empty_40",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 85 / 30,
        MinProgress = 2,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.8,
        SoundTable = {
            {s = rottle,  t = 0.0},
            {s = path .. "magout_empty.ogg", 	 t = 0.2},
            {s = common .. "magpouch_gear.ogg", t = 0.25},
            {s = rottle,  t = 0.75},
            {s = common .. "rifle_magdrop.ogg",  t = 0.8},
            {s = path .. "struggle.ogg",    t = 1.0, v = 0.4},
            {s = path .. "magin.ogg",    t = 1.05},
            {s = rottle,  t = 1.475},
            {s = ratel,  t = 1.475},
            {s = path .. "boltdrop.ogg", t = 1.78},
            {s = common .. "rattle_b2i_rifle.ogg", t = 2.1},
            {s = common .. "shoulder.ogg", t = 2.2},
        },
    },

    -- 60 Round Reloads --

    ["reload_60"] = {
        Source = "reload_60",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 71 / 30,
        MinProgress = 1.5,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.7,
        SoundTable = {
            {s = rottle, t = 0.0},
            {s = common .. "magpouch_gear.ogg", t = 0.2},
            {s = path .. "magout_empty.ogg", 	 t = 0.25},
            {s = rottle, t = 0.75},
            {s = path .. "struggle.ogg",    t = 1.0, v = 0.4},
            {s = path .. "magin.ogg",    t = 1.1},
            {s = rottle, t = 1.1},
            {s = common .. "grab-polymer.ogg", t = 1.78, v = 0.25},
            {s = common .. "rattle_b2i_rifle.ogg", t = 1.8},
            {s = common .. "shoulder.ogg", t = 1.9},
        },
    },
    ["reload_empty_60"] = {
        Source = "reload_empty_60",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 85 / 30,
        MinProgress = 2,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.8,
        SoundTable = {
            {s = rottle, t = 0.0},
            {s = common .. "magpouch_gear.ogg", t = 0.2},
            {s = path .. "magout_empty.ogg", 	 t = 0.25},
            {s = rottle, t = 0.75},
            {s = common .. "rifle_magdrop.ogg",  t = 0.8},
            {s = path .. "struggle.ogg",    t = 1.0, v = 0.4},
            {s = path .. "magin.ogg",    t = 1.1},
            {s = rottle, t = 1.475},
            {s = ratel, t = 1.475},
            {s = path .. "boltdrop.ogg", t = 1.8},
            {s = common .. "rattle_b2i_rifle.ogg", t = 2.1},
            {s = common .. "grab-polymer.ogg", t = 2.15, v = 0.25},
            {s = common .. "shoulder.ogg", t = 2.2},
        },
    },

    -- 100 Round Reloads --

    ["reload_100"] = {
        Source = "reload_100",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 71 / 30,
        MinProgress = 1.75,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.3,
        LHIKOut = 0.5,
        SoundTable = {
            {s = rottle, t = 0.0},
            {s = path .. "magout_empty.ogg", 	 t = 0.2},
            {s = rottle, t = 0.75},
            {s = path .. "struggle.ogg",    t = 0.95, v = 0.4},
            {s = path .. "magin.ogg",    t = 1.05},
            {s = rottle, t = 1.1},
            {s = path .. "magtap.ogg",   t = 1.59},
            {s = common .. "cloth_4.ogg",  t = 1.65},
            {s = common .. "rattle_b2i_rifle.ogg", t = 1.8},
            {s = common .. "grab-polymer.ogg", t = 1.85, v = 0.25},
            {s = common .. "shoulder.ogg", t = 2.0},
        },
    },
    ["reload_empty_100"] = {
        Source = "reload_empty_100",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 90 / 30,
        MinProgress = 2.5,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.3,
        LHIKOut = 0.6,
        SoundTable = {
            {s = rottle, t = 0.0},
            {s = path .. "magout_empty.ogg", 	 t = 0.2},
            {s = rottle, t = 0.75},
            {s = common .. "magdrop.ogg",  t = 0.65},
            {s = path .. "struggle.ogg",    t = 0.95, v = 0.4},
            {s = path .. "magin.ogg",    t = 1.05},
            {s = path .. "magtap.ogg",   t = 1.59},
            {s = rottle, t = 1.75},
            {s = path .. "chback.ogg",   t = 2.0},
            {s = common .. "cloth_4.ogg",  t = 2.05},
            {s = path .. "chamber.ogg",  t = 2.22},
            {s = common .. "rattle_b2i_rifle.ogg", t = 2.5},
            {s = common .. "grab-polymer.ogg", t = 2.55, v = 0.25},
            {s = common .. "shoulder.ogg", t = 2.6},
        },
    },

    -- 9mm 32 Round Reloads --

    ["reload_9mm"] = {
        Source = "reload_9mm",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 70 / 30,
        MinProgress = 1.5,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.5,
        SoundTable = {
            {s = rottle, t = 0.0},
            {s = common .. "magpouch.ogg", t = 0.15},
            {s = "weapons/arccw_ud/uzi/" .. "magout.ogg", 	 t = 16 / 30},
            {s = rottle, t = 0.75},
            {s = "weapons/arccw_ud/uzi/" .. "magin.ogg",    t = 27 / 30},
            {s = rottle, t = 1.1},
            {s = common .. "magpouchin.ogg", t = 1.55},
            {s = common .. "shoulder.ogg", t = 1.93},
        },
    },
    ["reload_empty_9mm"] = {
        Source = "reload_empty_9mm",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 80 / 30,
        MinProgress = 2,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.1,
        LHIKEaseIn = 0.1,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.9,
        SoundTable = {
            {s = rottle, t = 0.0},
            {s = "weapons/arccw_ud/uzi/" .. "magout.ogg", 	 t = 0.1},
            {s = common .. "magpouch.ogg", t = 0.45},
            {s = rottle, t = 0.75},
            {s = "weapons/arccw_ud/uzi/" .. "magin.ogg",    t = 0.8},
            {s = path .. "chamber_press.ogg", t = 1.7},
            {s = rottle, t = 1.39},
            {s = common .. "shoulder.ogg", t = 2.15},
        },
    },


    ["enter_inspect"] = {
        Source = "inspect_enter",
        -- time = 35 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 2.5,
        SoundTable = {
            {s = rottle, t = 0},
            {s = common .. "movement-rifle-02.ogg", t = 0.1},
        },
    },
    ["idle_inspect"] = {
        Source = "inspect_loop",
        -- time = 72 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 999, -- maybe im dumb
    },
    ["exit_inspect"] = {
        Source = "inspect_exit",
        -- time = 66 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 999, -- maybe im dumb
        SoundTable = {
            {s = common .. "movement-rifle-04.ogg", t = 0.2},
            {s = rottle, t = 0.25},
            {s = rottle, t = 1.2},
            {s = common .. "movement-rifle-03.ogg", t = 1.25},
        },
    },
    ["enter_inspect_empty"] = {
        Source = "inspect_enter_empty",
        -- time = 35 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 2.5,
        SoundTable = {
            {s = rottle, t = 0},
            {s = common .. "movement-rifle-02.ogg", t = 0.1},
        },
    },
    ["idle_inspect_empty"] = {
        Source = "inspect_loop_empty",
        -- time = 72 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 999,
    },
    ["exit_inspect_empty"] = {
        Source = "inspect_exit_empty",
        -- time = 66 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 999,
        SoundTable = {
            {s = common .. "movement-rifle-04.ogg", t = 0.2},
            {s = rottle, t = 0.25},
            {s = rottle, t = 1.2},
            {s = common .. "movement-rifle-03.ogg", t = 1.25},
        },
    },
}

local hgLookup = {
    ["default"]     = {0,4,0},
    ["tactical"]    = {2,5,0},
    ["a1"]          = {1,1,1},
    ["heat"]          = {10,10,1},
    ["heatm203"]          = {11,11,1},
    ["wood"]          = {1,1,1},
    ["lmg"]          = {3,3,1},
    ["fpw"]          = {6,6,2},
    ["ru556"]          = {7,7,3},
    ["adar"]          = {8,8,2},
    ["hk416"]          = {9,9,3},
    ["607"]          = {9,9,0},
}
-- Structure: 20in appearance, 14/11in appearance, gas block mode
-- Gas block modes: 0 standard, 1 always at 20" position, 2 at ADAR position when short, 3 at ADAR position when short and not flat

local barrLookup = {
    ["sd"] = -1,
    ["20in"] = 0,
    ["14in"] = 1,
    ["fpw"] = 1,
    ["10in"] = 2,
}

SWEP.Hook_ModifyBodygroups = function(wep, data)
    local vm = data.vm
    local atts = wep.Attachments
    if !IsValid(vm) then return end

    local barrel = string.Replace(atts[2].Installed or "20in","ud_m16_barrel_","")
    local barr = barrLookup[barrel]
    local hg = string.Replace(atts[3].Installed or "default","ud_m16_hg_","")
    hg = string.Replace(hg,"uf_m16_hg_","")

    local optic = atts[1].Installed
    local muzz = atts[4].Installed or barrel == "sd"
    local laser = atts[8].Installed
    local fs = atts[16].Installed
    local retro = wep:GetBuff_Override("TopMount")

    -- Retro rail
    if optic then
        if retro then
            -- Raised rail (retro)
            vm:SetBodygroup(3, retro)
        else
            -- Flat rail
            vm:SetBodygroup(1, 1)
            vm:SetBodygroup(3, 2)
        end
    end

    -- Dynamic handguard
    if barr == -1 then
        vm:SetBodygroup(5,9)
    elseif barr == 0 and hgLookup[hg] then
        vm:SetBodygroup(5,hgLookup[hg][1])
    elseif hgLookup[hg] then
        vm:SetBodygroup(5,hgLookup[hg][2])
    else
        vm:SetBodygroup(5,9)
    end

    -- Gas block
    if barrel == "sd" or (atts[6].Installed == "ud_m16_receiver_fpw" and barr > 0) then
        vm:SetBodygroup(6,5)
    else
        local gbPos = hgLookup[hg] and hgLookup[hg][3] or 0
        local lwr = atts[6].Installed
        local flat = (
            wep:GetBuff_Override("FrontSight")
            or atts[6].Installed == "ud_m16_receiver_fpw"
            or (optic and fs ~= "ud_m16_charm_fs" and !(wep:GetBuff_Override("IronSight") or wep:GetBuff_Override("TopMount")))
        ) and 1 or 0

        if gbPos == 1 or barr == 0 then
            vm:SetBodygroup(6, 0 + flat)
        elseif gbPos == 2 then
            vm:SetBodygroup(6, 4 + flat * 2)
        elseif gbPos == 3 then
            vm:SetBodygroup(6, 4 - flat)
        else
            vm:SetBodygroup(6, 2 + flat)
        end
    end

    -- Default flash hider
    if !muzz then
        if barr == 0 then
            vm:SetBodygroup(11,1)
        elseif barr == 1 then
            vm:SetBodygroup(11,2)
        else
            vm:SetBodygroup(11,3)
        end
    else
        vm:SetBodygroup(11,0)
    end

    -- Tactical clamp
    if laser and hg ~= "tactical" then
        if barr == 0 then
            vm:SetBodygroup(10,1)
        elseif barr == 1 then
            vm:SetBodygroup(10,3)
        else
            vm:SetBodygroup(10,2)
        end
    else
        vm:SetBodygroup(10,0)
    end

    -- Disable tac rail element with tac hg
    if hg == "tactical" and (atts[7].Installed or atts[18].Installed) then
        vm:SetBodygroup(9,0)
    end

    -- .50 Beowulf magazines
    if atts[5].Installed == "ud_m16_receiver_50beo" and !atts[11].Installed then
        vm:SetBodygroup(2, 8)
    end
end

-- RAYCAR-0, rifle barrel
local bar0_fake = "First variation of the RAYCAR rifle. Tests showed that users were more likely to hit a target if they fired multiple shots, but were likely to spray in full-auto and fail to hit anything. As a result, a ratcheted three-round burst system was implemented which limited the maximum burst a user could fire to three shots.\n\nWell-rounded gun with no major downsides."

-- RAYCAR-1, carbine barrel
local bar1_fake = "Second variation of the RAYCAR rifle. It eventually replaced the RAYCAR-0 across much of the Army for its favorably low weight and comparable performance. The -1 variant has since become one of the most iconic and widespread American service rifles in the modern era.\n\nLight and versatile, but requires discipline to control."

-- RAYCAR-2, commando barrel
local bar2_fake = "Third variation of the RAYCAR rifle. Developed with assistance from the Navy, the \"commando\" barrel allows for the weapon to be very compact, even short enough to be classified as a submachine gun, enhancing usability in vehicles and in enclosed spaces.\n\nVery lightweight and manuverable, but with very aggressive recoil to match."

-- RAYPAW :3
local smgDesc_fake = "Submachine gun based on the RAYCAR rifle. Despite its similar appearance, it uses a different mechanism from its parent rifle.\n\nMore accurate than other submachine guns due to its rifle frame and closed-bolt mechanism."

-- RBY50
local beoDesc_fake = "Aftermarket semi-automatic variant of the RAYCAR rifle firing an oversized magnum cartridge.\n\nProvides extremely high stopping power at close range."

-- RBY300
local blkDesc_fake = "Aftermarket automatic variant of the RAYCAR rifle. The .300 Blackout cartridge has a ballistic performance more akin to the 7.62x39mm Soviet cartridge, with a similarly sized projectile but shorter effective range.\n\nSlightly more inaccurate, made up with a higher stopping power and a subsonic projectile."

-- UKCAR
local ukDesc_fake = "Normally, RAYCAR style rifles are imported with a semi-automatic fire group for the civilian market. This one, however, has been neutered by authority of the British crown with a manual-action receiver.\n\nBit cringe, innit?"

-- RAYSAW
local lmgDesc_fake = "Configuration of the RAYCAR designed for a light machine gun role, used vaguely within the Marine Corps before the adoption of the Minimi.\n\nHeavier than the standard platform, but the integral bipod can be deployed onto surfaces for excellent recoil control."

-- Fallout barrel or sumn idk
local ncrDesc_fake = "Standard-issue rifle of the New California Republic. Traditionally produced with a semi-automatic receiver, the wooden furniture is more readily replaceable and adds additional recoil control for maximum accuracy.\n\nWell-rounded gun with no major downsides."

-- Patriot easter egg. Is it overpowered? I don't think so, a configuration like this is already pretty uncontrollable and imprecise as is, and overheating is the new magazine.
local a1, a2 = {}, {"patr1", "patr2", "patr3", "patr4", "patr5"}
SWEP.O_Hook_Override_BottomlessClip = function(wep, data)
    if wep:CheckFlags(a1, a2) then
        data.current = true
    end
end


SWEP.Hook_NameChange = function(wep, name)
    local trueNames = GetConVar("arccw_truenames"):GetBool()
    local atts = wep.Attachments
    local flat = atts[1].Installed and !wep:GetBuff_Override("TopMount")

    local barrel = string.Replace(atts[2].Installed or "20in","ud_m16_barrel_","")
    local barr = barrLookup[barrel]
    local hg = string.Replace(atts[3].Installed or "default","ud_m16_hg_","")
    local upr = string.Replace(atts[5].Installed or "default","ud_m16_receiver_","")
    local lwr = string.Replace(atts[6].Installed or "default","ud_m16_receiver_","")

    if wep:CheckFlags(a1, a2) then -- Patriot configuration
        wep.Trivia_Desc = patriotDesc
        return "The Patriot"
    elseif !trueNames then -- Custom lore-based fake names
        local pre = (lwr == "auto" and "AM" or "RAY")
        if upr == "9mm" then
            local sd = (barr == -1)
            wep.Trivia_Desc = smgDesc_fake
            if flat then
                return (sd and pre .. "SSMG-NG") or pre .. "PAW-" .. barr .. "NG"
            end
            return (sd and pre .. "SSMG") or pre .. "PAW-" .. barr
        elseif upr == "50beo" then
            wep.Trivia_Desc = beoDesc_fake
            return "RBY"--50"
        elseif upr == "300blk" then
            wep.Trivia_Desc = blkDesc_fake
            return "RBY"--300"
        elseif lwr == "fpw" then
            wep.Trivia_Desc = bar1_fake
            return pre .. "FPW"
        elseif lwr == "cali" then
            wep.Trivia_Desc = ukDesc_fake
            return "UKCAR"
        else
            if barr == 0 then
                if hg == "lmg" then
                    wep.Trivia_Desc = lmgDesc_fake
                    return pre .. "SAW" .. (flat and "-NG" or "")
                elseif flat then
                    return pre .. "CAR-0NG"
                else
                    wep.Trivia_Desc = bar0_fake
                    return pre .. "CAR-0"
                end
            elseif barr == 1 then
                wep.Trivia_Desc = bar1_fake
                if flat then
                    return pre .. "CAR-1NG"
                end
                return pre .. "CAR-1"
            elseif barr == 2 then
                wep.Trivia_Desc = bar2_fake
                if flat then
                    return pre .. "CAR-2NG"
                end
                return pre .. "CAR-2"
            end
        end

        wep.Trivia_Desc = bar0_fake
        return pre .. "CAR-0"

    else

        if upr == "9mm" then
            local sd = (barr == -1)
            wep.Trivia_Desc = smgDesc
            if lwr == "semi" then
                return "AR-15 9mm"
            elseif flat then
                return "R0991"
            end
            return "R0635"

        end

        if lwr == "auto" then
            if upr == "a1" then
                wep.Trivia_Desc = a1Desc
                if barr == 0 then
                    return "M16A1"
                elseif barr == 1 then
                    return "M605"
                end
                wep.Trivia_Desc = carDesc
                return "CAR-15"
            end
            if barr == 0 then
                wep.Trivia_Desc = a3Desc
                if hg == "lmg" then
                    wep.Trivia_Desc = lmgDesc
                    return "Colt LMG"
                elseif flat and hg == "tactical" then
                    return "R0901"
                end
                return "M16A3"
            elseif barr == 1 then
                wep.Trivia_Desc = m4Desc
                if flat then
                    return "M4A1"
                end
                return "XM4"
            else
                wep.Trivia_Desc = carDesc
                if flat then
                    wep.Trivia_Desc = m4Desc
                    if upr == "300blk" then
                        return "Mk 18"
                    end
                    return "Mk 18 Mod 0"
                end
                return "CAR-15"
            end
        elseif lwr == "semi" or upr == "50beo" then
            wep.Trivia_Desc = arDesc
            if hg == "wood" then
                wep.Trivia_Desc = ncrDesc
                if barr == 0 then
                    return "Service Rifle"
                end
                return "Service Carbine"
            elseif flat and hg == "adar" then
                return "ADAR 2-15"
            elseif barr > 0 then
                if barr == 2 and atts[10].Installed == "ud_m16_stock_buffer" then
                    return "AR-15 Pistol"
                elseif upr == "a1" and barr == 1 then
                    return "CRXM177E2B"
                else
                    return "AR-15 SBR"
                end
            elseif upr == "a1" then
                return "CRM16A1"
            end
            return "AR-15"
        elseif lwr == "fpw" then
            wep.Trivia_Desc = m4Desc
            return "M231 FPW"
        elseif lwr == "cali" then
            wep.Trivia_Desc = ukDesc
            return "AR-15GB"
        else
            wep.Trivia_Desc = origDesc
            if barr == 0 and flat then
                return "M16A4"
            elseif barr == 1 then
                wep.Trivia_Desc = m4Desc
                return "M4 Carbine"
            elseif barr == 2 then
                return "M16 Commando"
            end
        end

        wep.Trivia_Desc = origDesc
        return "M16A2"

    end
end



SWEP.Attachments = {
    {
        PrintName = "Optic",
        DefaultAttName = "Iron Sights",
        InstalledEles = {"upper_flat"},
        Slot = {"optic","optic_sniper","ud_m16_rs"},
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(0, -1.75, 3),
            vang = Angle(90, 0, -90),
        },
        SlideAmount = {
            vmin = Vector(0, -1.6, 3 - 2),
            vmax = Vector(0, -1.6, 3 + 1),
        },
    },
    {
        PrintName = "Barrel",
        DefaultAttName = "20\" Standard Barrel",
        DefaultAttIcon = Material("entities/att/acwatt_ud_m16_barrel_20.png", "smooth mips"),
        Slot = "ud_m16_blen",
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(2.8, -4.2, -11.5),
            vang = Angle(90, 0, -90),
        },
    },
    {
        PrintName = "Handguard",
        DefaultAttName = "Ribbed Handguard",
        DefaultAttIcon = Material("entities/att/acwatt_ud_m16_hg_ribbed.png", "smooth mips"),
        Slot = "ud_m16_hg",
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(0, -1.63, -0.41),
            vang = Angle(90, 0, -90),
        },
        ExcludeFlags = {"sd"}
    },
    {
        PrintName = "Muzzle",
        DefaultAttName = "Standard Muzzle",
        Slot = {"muzzle", "ud_m16_muzzle"},
        Bone = "m16_parent",
        VMScale = Vector(1, 1, 1),
        WMScale = VMScale,
        Offset = {
            vpos = Vector(0, -.33, 23.27),
            vang = Angle(90, 0, -90),
        },
        ExcludeFlags = {"sd", "m16_stub"},
    },
    {
        PrintName = "Upper Receiver",
        DefaultAttName = "5.56x45mm Upper",
        DefaultAttIcon = Material("entities/att/uc_bullets/556x45.png", "smooth mips"),
        Slot = {"ud_m16_receiver"},
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(2.8, -4.2, -11.5),
            vang = Angle(90, 0, -90),
        },
        ExcludeFlags = {"ud_m16_fpw"}
    },
    {
        PrintName = "Lower Receiver",
        DefaultAttName = "Burst Lower",
        DefaultAttIcon = Material("entities/att/acwatt_ud_m16_receiver_default.png", "smooth mips"),
        Slot = {"ud_m16_fcg"},
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(2.8, -4.2, -11.5),
            vang = Angle(90, 0, -90),
        },
        ExcludeFlags = {"m16_nolower"}
    },
    {
        PrintName = "Underbarrel",
        Slot = "foregrip",
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(0, 6, 11),
            vang = Angle(90, 0, -90),
        },
        InstalledEles = {"rail_fg"},
        ExcludeFlags = {"m16_lmg", "m16_stub"},
        SlideAmount = {
            vmin = Vector(0, .65, 11.5),
            vmax = Vector(0, .65, 7.5),
        },
		MergeSlots = {18},
    },
    {
        PrintName = "Tactical",
        Slot = {"tac"},
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(0, 0.3, 21.25),
            vang = Angle(90, 0, -90),
        },
        GivesFlags = {"tac"},
        --InstalledEles = {"ud_m16_clamp_fullsize"}
    },
    {
        PrintName = "Grip Type",
        Slot = {"ud_m16_grip"},
        DefaultAttName = "Standard Grip",
        DefaultAttIcon = Material("entities/att/acwatt_ud_m16_grip_default.png", "smooth mips"),
        ExcludeFlags = {"m16_adar"}
    },
    {
        PrintName = "Stock",
        Slot = {"ud_m16_stock","go_stock"},
        DefaultAttName = "Full Stock",
        DefaultAttIcon = Material("entities/att/acwatt_ud_m16_stock_default.png", "smooth mips"),
        -- GSO support
        InstalledEles = {"stock_231_tube"},
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(-0.02, 0, -2.7),
            vang = Angle(90, 0, -90),
        },
    },
    {
        PrintName = "Magazine",
        Slot = {"ud_m16_mag"},
        DefaultAttName = "30-Round Mag",
        DefaultAttIcon = Material("entities/att/acwatt_ud_m16_mag_30.png", "smooth mips"),
    },
    {
        PrintName = "Ammo Type",
        DefaultAttName = "\"FMJ\" Full Metal Jacket",
        DefaultAttIcon = Material("entities/att/arccw_uc_ammo_generic.png", "mips smooth"),
        Slot = "uc_ammo",
    },
    {
        PrintName = "Powder Load",
        Slot = "uc_powder",
        DefaultAttName = "Standard Load"
    },
    {
        PrintName = "Training Package",
        Slot = "uc_tp",
        DefaultAttName = "Basic Training"
    },
    {
        PrintName = "Internals",
        Slot = "uc_fg", -- Fire group
        DefaultAttName = "Standard Internals"
    },
    {
        PrintName = "Front Sight",
        Slot = {"ud_m16_fs", "ud_m16_charm"},
        FreeSlot = true,
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(0, -1.65, 16.75), -- 21.75 or 15.75
            vang = Angle(90, 0, -90),
        },
        ExcludeFlags = {"sight_magpul"}
    },
    {
        PrintName = "Charm",
        Slot = {"charm", "fml_charm"}, -- "ud_m16_charm"
        FreeSlot = true,
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(0.48, 0.5, 3.9),
            vang = Angle(90, 0, -90),
        },
        -- MergeSlots = {17}
    },
    {
        PrintName = "M203 slot",
        Slot = "uc_ubgl",
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(0, -0.4, 7.2),
            vang = Angle(90, 0, -90),
        },
        Hidden = true,
        InstalledEles = {"rail_fg"},
        ExcludeFlags = {"m16_lmg", "m16_stub"},
    }
}
--lua/weapons/arccw_ud_m16.lua:
SWEP.Base = "arccw_base"
SWEP.Spawnable = true
SWEP.Category = "ArcCW - Urban Coalition"
SWEP.UC_CategoryPack = "1Urban Decay"
SWEP.AdminOnly = false
SWEP.UseHands = true

-- Muzzle and shell effects --

SWEP.MuzzleEffect = "muzzleflash_1"
SWEP.ShellEffect = "arccw_uc_shelleffect"
SWEP.ShellModel = "models/weapons/arccw/uc_shells/556x45.mdl"
SWEP.ShellScale = .666
SWEP.ShellPitch = 100

SWEP.MuzzleEffectAttachment = 1
SWEP.CaseEffectAttachment = 2
SWEP.CamAttachment = 3
SWEP.TracerNum = 1
SWEP.TracerCol = Color(25, 255, 25)
SWEP.TracerWidth = 2

-- Fake name --

SWEP.PrintName = "RAYCAR-0"
-- AMCAR stands for (american) Colt Assault Rifle, not Carbine!! ~Fesiug
-- shut up retard ~zenith

-- True name --

SWEP.TrueName = "M16A2"

-- Trivia --
SWEP.Trivia_Class = "Assault Rifle"
SWEP.Trivia_Desc = "Third generation of America's iconic military rifle. Army tests showed that soldiers were more likely to hit a target if they fired multiple shots, but were likely to spray in full-auto and fail to hit anything. As a result, they implemented a ratcheted three-round burst system which limited the maximum burst a soldier could fire to three shots.\n\nWell-rounded gun with no major downsides."
SWEP.Trivia_Manufacturer = "Rayter Arms Industries"
SWEP.Trivia_Calibre = "5.56x45mm NATO"
SWEP.Trivia_Mechanism = "Gas-Operated Rotating Bolt"
SWEP.Trivia_Country = "USA"
SWEP.Trivia_Year = 1959


if GetConVar("arccw_truenames"):GetBool() then
    SWEP.PrintName = SWEP.TrueName
    SWEP.Trivia_Manufacturer = "Stoner's Legacy Ltd."
end

local origDesc = SWEP.Trivia_Desc
local m4Desc = "Carbine variant of the M16 rifle. Originally designed in response to design faults in the CAR-15 family, it eventually replaced the M16 across much of the Army for its favorably low weight and comparable performance. The M4 variant has since become one of the most iconic and widespread American service rifles in the modern era.\n\nLight and versatile, but requires discipline to control."
local ncrDesc = "Standard-issue rifle of the New California Republic. Traditionally produced with a semi-automatic receiver, the wooden furniture is more readily replaceable and adds additional recoil control for maximum accuracy.\n\nWell-rounded gun with no major downsides."
local smgDesc = "Submachine gun based on the M16 rifle. Despite its similar appearance, it uses a different mechanism from its parent rifle. More accurate than other submachine guns due to its rifle frame and closed-bolt mechanism."
local blkDesc = "Aftermarket automatic variant of the M16 rifle. The .300 Blackout cartridge has a ballistic performance more akin to the 7.62x39mm Soviet cartridge, with a similarly sized projectile but shorter effective range."
local ukDesc = "AR-15 style rifles are a class of rifles linked to the M16, normally with a semi-automatic fire group for the civilian market. This one, however, has been neutered by authority of the British crown with a manual-action receiver. Bit cringe, innit?"
local arDesc = "Semi-automatic variant of the M16 series of rifles, produced for the civilian market. Wildly popular in the United States, this rifle can be seen in the hands of hobbyists, hunters and mass shooters alike.\n\nWell-rounded gun with no major downsides."
local beoDesc = "Aftermarket semi-automatic variant of the M16 rifle firing an oversized magnum cartridge. Provides extremely high stopping power at close range."
local carDesc = "Carbine variant of the M16 rifle, short enough to be classified as a submachine gun. Its features influenced the US Army's interest in the M4 Carbine, which went on to become their new standard rifle. Due to the small barrel, rifles of this family have high maneuverability but poor range compared to their parent platform."
local a1Desc = "Second generation of America's iconic military rifle. Developed to address problems with the original M16, which suffered notoriously frequent jamming that could get its wielder killed. The revised model evolved a positive reputation with those who used it, and is now a universal symbol of the Vietnam War.\n\nA well-rounded rifle, but difficult to control without trigger discipline - something the A2 model eventually addressed."
local a3Desc = "Variant of the M16A2 with the original full-automatic trigger group, relegated to niche roles in the US Army. Well-rounded gun with no major downsides."
local lmgDesc = "Configuration of the M16 designed for a light machine gun role, used vaguely within the Marine Corps before the adoption of the Minimi. Heavier than the standard platform, but the integral bipod can be deployed onto surfaces for excellent recoil control."
local patriotDesc = "An assault pistol developed for The Boss. The feeder mechanism inside the drum magazine forms an \"∞\" shape.\n\nThe bottomless magazine more than makes up for the awkwardness of the configuration."

-- Weapon slot --

SWEP.Slot = 2

-- Weapon's manufacturer real name --

if GetConVar("arccw_truenames"):GetBool() then
    SWEP.PrintName = SWEP.TrueName
    SWEP.Trivia_Manufacturer = "Colt's Manufacturing Company"
end

-- Viewmodel / Worldmodel / FOV --

SWEP.ViewModel = "models/weapons/arccw/c_ud_m16.mdl"
SWEP.WorldModel = "models/weapons/arccw/c_ud_m16.mdl"
SWEP.ViewModelFOV = 80
SWEP.AnimShoot = ACT_HL2MP_GESTURE_RANGE_ATTACK_AR2

-- Damage --

SWEP.Damage = ArcCW.UC.StdDmg["556"].max
SWEP.DamageMin = ArcCW.UC.StdDmg["556"].min
SWEP.RangeMin = 50
SWEP.Range = 350 -- 4 shot until ~250m

SWEP.Penetration = ArcCW.UC.StdDmg["556"].pen
SWEP.DamageType = DMG_BULLET
SWEP.ShootEntity = nil
SWEP.MuzzleVelocity = 960
SWEP.PhysBulletMuzzleVelocity = 960

SWEP.BodyDamageMults = ArcCW.UC.BodyDamageMults

-- Mag size --

SWEP.ChamberSize = 1
SWEP.Primary.ClipSize = 30
SWEP.ExtendedClipSize = 40
SWEP.ReducedClipSize = 20

-- Recoil --

SWEP.Recoil = 0.5
SWEP.RecoilSide = 0.25

SWEP.RecoilRise = 0.1
SWEP.RecoilPunch = 1
SWEP.VisualRecoilMult = 1
SWEP.MaxRecoilBlowback = 1
SWEP.MaxRecoilPunch = 1
SWEP.RecoilPunchBack = 1

SWEP.Sway = 0.5

-- Firerate / Firemodes --

SWEP.Delay = 60 / 900
SWEP.Num = 1
SWEP.Firemodes = {
    {
        Mode = -3,
        PostBurstDelay = 0.1,
        RunawayBurst = false, -- https://en.wikipedia.org/wiki/Burst_mode_(weapons)
    },
    {
        Mode = 1,
    },
    {
        Mode = 0
    }
}

SWEP.ShootPitch = 100
SWEP.ShootVol = 120
SWEP.ShootPitchVariation = 0

SWEP.ProceduralRegularFire = false
SWEP.ProceduralIronFire = false

SWEP.ReloadInSights = true

-- NPC --

SWEP.NPCWeaponType = "weapon_ar2"
SWEP.NPCWeight = 60

-- Accuracy --

SWEP.AccuracyMOA = 4
SWEP.HipDispersion = 800
SWEP.MoveDispersion = 200
SWEP.JumpDispersion = 1000

SWEP.Primary.Ammo = "smg1"
SWEP.MagID = "m16"

SWEP.HeatCapacity = 150
SWEP.HeatDissipation = 10
SWEP.HeatDelayTime = 3

SWEP.MalfunctionMean = 200
SWEP.MalfunctionTakeRound = false

-- Speed multipliers --

SWEP.SpeedMult = 0.925
SWEP.SightedSpeedMult = 0.75
SWEP.SightTime = 0.35
SWEP.ShootSpeedMult = 0.9

-- Length --

SWEP.BarrelLength = 48
SWEP.ExtraSightDist = 2

-- Ironsights / Customization / Poses --

SWEP.HolsterPos = Vector(0.5, -1, 1.2)
SWEP.HolsterAng = Angle(-8.5, 8, -10)

SWEP.HoldtypeHolstered = "passive"
SWEP.HoldtypeActive = "ar2"
SWEP.HoldtypeSights = "rpg"

SWEP.IronSightStruct = {
     Pos = Vector(-2.815, 0, 1.3),
     Ang = Angle(0, 0, 0),
     Magnification = 1.1,
     SwitchToSound = "",
}

SWEP.ActivePos = Vector(0.33, -2, 1.33)
SWEP.ActiveAng = Angle(0, 0, -3)

-- SWEP.CustomizePos = Vector(5, -2, -2)
-- SWEP.CustomizeAng = Angle(15, 25, 0)
SWEP.CustomizePos = Vector(0, 0, 0)
SWEP.CustomizeAng = Angle(0, 0, 0)

SWEP.CrouchPos = Vector(-2.5, -2, -0.6)
SWEP.CrouchAng = Angle(0, 0, -14)

SWEP.BarrelOffsetHip = Vector(2, 0, -5)

SWEP.MirrorVMWM = true
SWEP.WorldModelOffset = {
    pos        =    Vector(-8.5, 4, -5),
    ang        =    Angle(-12, 0, 180),
    bone    =    "ValveBiped.Bip01_R_Hand",
    --scale = .85
}

-- Firing sounds --

local path = ")weapons/arccw_ud/m16/"
local common = ")/arccw_uc/common/"

SWEP.ShootSound = {
    path .. "fire-01.ogg",
    path .. "fire-02.ogg",
    path .. "fire-03.ogg",
    path .. "fire-04.ogg",
    path .. "fire-05.ogg",
    path .. "fire-06.ogg"
}
SWEP.ShootSoundSilenced = {
    path .. "fire-sup-01.ogg",
    path .. "fire-sup-02.ogg",
    path .. "fire-sup-03.ogg",
    path .. "fire-sup-04.ogg",
    path .. "fire-sup-05.ogg",
    path .. "fire-sup-06.ogg"
}

SWEP.DistantShootSound = nil
SWEP.DistantShootSoundSilenced = nil
SWEP.ShootDrySound = path .. "dryfire.ogg"

local tail = ")/arccw_uc/common/556x45/"

SWEP.DistantShootSoundOutdoors = {
    tail .. "fire-dist-556x45-rif-ext-01.ogg",
    tail .. "fire-dist-556x45-rif-ext-02.ogg",
    tail .. "fire-dist-556x45-rif-ext-03.ogg",
    tail .. "fire-dist-556x45-rif-ext-04.ogg",
    tail .. "fire-dist-556x45-rif-ext-05.ogg",
    tail .. "fire-dist-556x45-rif-ext-06.ogg"
}
SWEP.DistantShootSoundIndoors = {
    common .. "fire-dist-int-rifle-01.ogg",
    common .. "fire-dist-int-rifle-02.ogg",
    common .. "fire-dist-int-rifle-03.ogg",
    common .. "fire-dist-int-rifle-04.ogg",
    common .. "fire-dist-int-rifle-05.ogg",
    common .. "fire-dist-int-rifle-06.ogg"
}
SWEP.DistantShootSoundOutdoorsSilenced = {
    common .. "sup-tail-01.ogg",
    common .. "sup-tail-02.ogg",
    common .. "sup-tail-03.ogg",
    common .. "sup-tail-04.ogg",
    common .. "sup-tail-05.ogg",
    common .. "sup-tail-06.ogg",
    common .. "sup-tail-07.ogg",
    common .. "sup-tail-08.ogg",
    common .. "sup-tail-09.ogg",
    common .. "sup-tail-10.ogg"
}
SWEP.DistantShootSoundIndoorsSilenced = {
    common .. "fire-dist-int-pistol-light-01.ogg",
    common .. "fire-dist-int-pistol-light-02.ogg",
    common .. "fire-dist-int-pistol-light-03.ogg",
    common .. "fire-dist-int-pistol-light-04.ogg",
    common .. "fire-dist-int-pistol-light-05.ogg",
    common .. "fire-dist-int-pistol-light-06.ogg"
}
SWEP.DistantShootSoundOutdoorsVolume = 1
SWEP.DistantShootSoundIndoorsVolume = 1
SWEP.Hook_AddShootSound = ArcCW.UC.InnyOuty

-- Bodygroups --

SWEP.BulletBones = {
    [2] = "m16_bullets1",    [3] = "m16_bullets2"
}

SWEP.DefaultBodygroups = "00000000000000000000000"

SWEP.AttachmentElements = {

    ["ud_m16_mag_20"] = {
        VMBodygroups = {{ind = 2, bg = 1}},
    },
    ["ud_m16_mag_40"] = {
        VMBodygroups = {{ind = 2, bg = 2}},
    },
    ["ud_m16_pmag"] = {
        VMBodygroups = {{ind = 2, bg = 9}},
    },
    ["ud_m16_mag_60"] = {
        VMBodygroups = {{ind = 2, bg = 3}},
    },
    ["ud_m16_mag_100"] = {
        VMBodygroups = {{ind = 2, bg = 4}},
    },
    ["ud_m16_9mm_mag"] = {
        VMBodygroups = {{ind = 2, bg = 5}},
    },
    ["ud_m16_9mm_mag_32"] = {
        VMBodygroups = {{ind = 2, bg = 6}},
    },
    ["ud_m16_mag_50beo"] = {
        VMBodygroups = {{ind = 2, bg = 8}},
    },
    ["ud_m16_mag_50beo_12"] = {
        VMBodygroups = {{ind = 2, bg = 0}},
    },

    ["upper_flat"] = {
        -- handled by code
        --[[]
        VMBodygroups = {
            {ind = 1, bg = 1},
            {ind = 3, bg = 3}
        },
        ]]
    },
    ["upper_classic"] = {
        VMBodygroups = {
            {ind = 1, bg = 3},
        },
    },
    ["rail_fg"] = {
        VMBodygroups = {{ind = 9, bg = 1}}
    },

    ["stock_231_ex"] = {
        VMBodygroups = {{ind = 7, bg = 1}},
    },
    ["stock_231_in"] = {
        VMBodygroups = {{ind = 7, bg = 2}},
    },
    ["stock_231_tube"] = {
        VMBodygroups = {{ind = 7, bg = 3}},
    },
    ["stock_607_ex"] = {
        VMBodygroups = {{ind = 7, bg = 4}},
    },
    ["stock_607_in"] = {
        VMBodygroups = {{ind = 7, bg = 5}},
    },
    ["stock_608"] = {
        VMBodygroups = {{ind = 7, bg = 6}},
    },
    ["stock_carbine_ex"] = {
        VMBodygroups = {{ind = 7, bg = 7}},
    },
    ["stock_carbine_in"] = {
        VMBodygroups = {{ind = 7, bg = 8}},
    },
    ["stock_wood"] = {
        VMBodygroups = {{ind = 7, bg = 9}},
    },
    ["stock_adar"] = {
        VMBodygroups = {
            {ind = 7, bg = 10},
            {ind = 8, bg = 4}
        },
    },
    ["stock_ru556"] = {
        VMBodygroups = {{ind = 7, bg = 11}},
    },
    ["grip_ergo"] = {
        VMBodygroups = {{ind = 8, bg = 1}},
    },
    ["grip_skel"] = {
        VMBodygroups = {{ind = 8, bg = 2}},
    },
    ["grip_wood"] = {
        VMBodygroups = {{ind = 8, bg = 3}},
    },

    ["gasblock_carbine"] = {
        VMBodygroups = {{ind = 6, bg = 3}},
    },
    ["fs_adar"] = {
        VMBodygroups = {{ind = 6, bg = 4}},
    },
    ["remove_lug"] = {
        VMBodygroups = {{ind = 12, bg = 1}},
    },

    ["mount_14"] = {
        AttPosMods = {
            [8] = {
                vpos = Vector(0, 0.3, 17.5),
                vang = Angle(90, 0, -90),
            },
        },
    },
    ["mount_11"] = {
        AttPosMods = {
            [8] = {
                vpos = Vector(0.6, -0.3, 14.2),
                vang = Angle(90, 0, 0),
            },
        },
    },
    ["mount_tactical"] = {
        AttPosMods = {
            [8] = {
                vpos = Vector(-1, -.35, 11.5),
                vang = Angle(-90, 180, 0),
                wang = Angle(90, 0, 0),
            },
        },
        ExcludeFlags = {}
    },
    -- ["mount_tactical_short"] = {
    --     AttPosMods = {
    --         [8] = {
    --             vpos = Vector(-1, -.35, 11.5),
    --             vang = Angle(-90, 180, 0),
    --             wang = Angle(90, 0, 0),
    --         },
    --     },
    --     AttPosMods_Priority = 2,
    --     RequireFlags = {"barrel_short"}
    -- },

    ["barrel_14"] = {
        VMBodygroups = {
            {ind = 4, bg = 1},
            {ind = 6, bg = 2},
        },
        AttPosMods = {
            [4] = {
                vpos = Vector(0, -0.33, 18.85),
                vang = Angle(90, 0, -90),
            },
            [16] = {
                vpos = Vector(0, -1.65, 12.5), -- 21.75 or 15.75
                vang = Angle(90, 0, -90),
            },
        }
    },
    ["barrel_11"] = {
        VMBodygroups = {
            {ind = 4, bg = 4},
            {ind = 6, bg = 2},
        },
        AttPosMods = {
            [4] = {
                vpos = Vector(0, -0.33, 15.7),
                vang = Angle(90, 0, -90),
            },
            [16] = {
                vpos = Vector(0, -1.65, 12.5), -- 21.75 or 15.75
                vang = Angle(90, 0, -90),
            },
        }
    },
    ["barrel_fpw"] = {
        VMBodygroups = {
            {ind = 4, bg = 2},
            {ind = 6, bg = 5},
        },
        AttPosMods = {
            [4] = {
                vpos = Vector(0, -0.07, 21.3),
                vang = Angle(90, 0, -90),
            },
        }
    },
    ["barrel_11_ru556"] = {
        VMBodygroups = {
            {ind = 4, bg = 4},
            {ind = 6, bg = 5},
        },
        AttPosMods = {
            [3] = {
                vpos = Vector(0, -0.07, 21.3),
                vang = Angle(90, 0, -90),
            },
            [6] = {
                vpos = Vector(1.15, 0, 17.9),
                vang = Angle(90, 0, 0),
            },
            [16] = {
                vpos = Vector(0, -1.65, 12.5), -- 21.75 or 15.75
                vang = Angle(90, 0, -90),
            },
        }
    },

    ["hg_m16a4_ris"] = {
        VMBodygroups = {
            {ind = 5, bg = 2},
        },
        AttPosMods = {
            [5] = {
                vpos = Vector(-0.1, 1.05, 12),
                vang = Angle(90, 0, -90),
            },
            [6] = {
                vpos = Vector(1.41, -.1, 20),
                vang = Angle(90, 0, 0),
            },
            [16] = {
                vpos = Vector(0, -1.75, 21.75), -- 21.75 or 15.75
                vang = Angle(90, 0, -90),
            },
        }
    },
    ["hg_m4a1_ris"] = {
        VMBodygroups = {
            {ind = 5, bg = 5},
        },
        AttPosMods = {
            [5] = {
                vpos = Vector(0, 1.4, 12),
                vang = Angle(90, 0, -90),
            },
            [6] = {
                vpos = Vector(-1.41, -.2, 14),
                vang = Angle(90, 0, 180),
            },
            [15] = {
                vpos = Vector(0, -1.75, 15.75), -- 21.75 or 15.75
                vang = Angle(90, 0, -90),
            },
        },
    },
    ["hg_ru556"] = {
        -- VMBodygroups = {
        --     {ind = 5, bg = 7},
        -- },
        AttPosMods = {
            -- [5] = {
            --     vpos = Vector(-0.1, 1.05, 12),
            --     vang = Angle(90, 0, -90),
            -- },
            -- [6] = {
            --     vpos = Vector(1.1, 0, 14),
            --     vang = Angle(90, 0, 0),
            -- },
            [16] = {
                vpos = Vector(0, -1.65, 12.5), -- 21.75 or 15.75
                vang = Angle(90, 0, -90),
            },
        },
    },
    ["hg_m4a1"] = {
        VMBodygroups = {
            {ind = 5, bg = 4},
        }
    },
    ["hg_cqbr"] = {
        VMBodygroups = {
            {ind = 5, bg = 4},
        },
    },
    ["hg_adar"] = {
        VMBodygroups = {
            {ind = 5, bg = 8},
        },
    },
    ["hg_fpw"] = {
        VMBodygroups = {
            {ind = 5, bg = 6},
            --{ind = 6, bg = 4},
        }
    },
    ["hg_m16a1"] = {
        VMBodygroups = {
            {ind = 5, bg = 1},
        }
    },
    ["hg_m16a1_wood"] = {
        VMBodygroups = {
            {ind = 5, bg = 1},
        },
        VMSkin = 1
    },
    ["ud_m16_hg_heat"] = {
        VMElements = {
            {
                Model = "models/weapons/arccw/atts/m203iron.mdl",
                Bone = "m16_parent",
                Scale = Vector(1, 1, 1),
                Offset = {
                    pos = Vector(0, -1.2, 14.9),
                    ang = Angle(90, 0, -90),
                }
            }
        },
        UC_UseClassicM203Mount = true,
    },
    ["hg_m605"] = {
        VMBodygroups = {
            {ind = 5, bg = 1},
            {ind = 4, bg = 1},
        },
        AttPosMods = {
            [3] = {
                vpos = Vector(0, -0.05, 25.58),
                vang = Angle(90, 0, -90),
            },
            [6] = { -- also has no rail
                vpos = Vector(0, 0.9, 22.2),
                vang = Angle(90, 0, -90),
            },
        }
    },
    ["hg_m605_wood"] = {
        VMBodygroups = {
            {ind = 5, bg = 1},
            {ind = 4, bg = 1},
        },
        AttPosMods = {
            [3] = {
                vpos = Vector(0, 0, 25),
                vang = Angle(90, 0, -90),
            },
            [6] = { -- also has no rail
                vpos = Vector(0, 0.8, 22),
                vang = Angle(90, 0, -90),
            },
        },
        VMSkin = 1
    },
    ["hg_lmg"] = {
        VMBodygroups = {
            {ind = 5, bg = 3},
        }
    },
    ["hg_sd"] = {
        VMBodygroups = {
            {ind = 5, bg = 9},
            {ind = 4, bg = 3},
            {ind = 6, bg = 5}
        },
        AttPosMods = { -- no rail, just pretend it's mounted to something
            -- [8] = {
            --     vpos = Vector(0, 0.7, 17.5),
            --     vang = Angle(90, 0, -90),
            -- },
            [16] = {
                vpos = Vector(0, -1.65, 11.5), -- 21.75 or 15.75
                vang = Angle(90, 0, -90),
            },
        }
    },

    ["ud_m16_upper_charm"] = {
        AttPosMods = {
            [1] = {
                vpos = Vector(0, -4, 3),
                vang = Angle(90, 0, -90),
                SlideAmount = {
                    vmin = Vector(0, -3.4, 3 - 1.5),
                    vmax = Vector(0, -3.4, 3 + 1.5),
                }
            },
        },
    },
    ["ud_m16_upper_charm2"] = {
        AttPosMods = {
            [1] = {
                vpos = Vector(0, -4.1, 3.5),
                vang = Angle(90, 0, -90),
                SlideAmount = {
                    vmin = Vector(0, -3.5, 3.5 - 2),
                    vmax = Vector(0, -3.5, 3.5 + 1),
                }
            },
        },
    },
    ["bravo_dicks_going_fart"] = {
        AttPosMods = {
            [8] = {
                vpos = Vector(0.25, -1.4, 12),
                vang = Angle(90, 0, 90),
            },
        },
    },

    ---- Cut content
    ["hg_stub"] = {
        VMBodygroups = {
            {ind = 5, bg = 7},
        },
        AttPosMods = {
            [3] = {
                vpos = Vector(0, -0.35, 7),
                vang = Angle(90, 0, -90)
            },
            [6] = {
                vpos = Vector(1.1, -0.4, 9),
                vang = Angle(90, 0, 0),
            },
        }
    },
    ["barrel_stub"] = {
        VMBodygroups = {
            {ind = 4, bg = 4},
            {ind = 6, bg = 4},
        }
    },
    ["hg_smg"] = {
        VMBodygroups = {
            {ind = 5, bg = 0},
        }
    },
    ["m16_strap"] = {
        VMBodygroups = {
             {ind = 13, bg = 1},
        },
    },
}

-- Animations --

SWEP.Hook_Think = ArcCW.UC.ADSReload

local sr_pmag = {
	[path .. "magout_empty.ogg"] = path .. "pmagout.ogg",
	[path .. "magin.ogg"] = path .. "pmagin.ogg",
}

local pmag1, pmag2 = {}, {"ud_m16_pmag"}
SWEP.Hook_TranslateSound = function(wep, data)
	if wep:CheckFlags(pmag1, pmag2) and sr_pmag[data] then return sr_pmag[data] end
end

local rottle = {common .. "cloth_1.ogg", common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}
local ratel = {common .. "rattle1.ogg", common .. "rattle2.ogg", common .. "rattle3.ogg"}

SWEP.Animations = {
    ["ready"] = {
        Source = "fix",
        Time = 45 / 30,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = common .. "raise.ogg", t = 0},
            {s = common .. "rattle.ogg", t = 0.2},
            {s = path .. "chback.ogg",   t = 0.15},
            {s = common .. "cloth_4.ogg",  t = 0.5},
            {s = path .. "chamber.ogg",  t = 0.5},
        },
        ProcDraw = true,
    },
    ["idle"] = {
        Source = "idle",
    },
    ["idle_empty"] = {
        Source = "idle_empty",
    },
    ["draw"] = {
        Source = "draw",
        SoundTable = {
            {s = common .. "raise.ogg", t = 0},
            {s = common .. "shoulder.ogg", t = 0.15},
            {s = ratel, t = 0.2},
        },
    },
    ["draw_empty"] = {
        Source = "draw_empty",
        Time = 20 / 30,
        SoundTable = {
            {s = common .. "raise.ogg", t = 0},
            {s = common .. "shoulder.ogg", t = 0.15},
            {s = ratel, t = 0.2},
        },
    },
    ["holster"] = {
        Source = "holster",
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = ratel, t = 0},
            {s = common .. "cloth_6.ogg", t = 0.2},
        },
    },
    ["holster_empty"] = {
        Source = "holster_empty",
        Time = 20 / 30,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = ratel, t = 0},
            {s = common .. "cloth_6.ogg", t = 0.2},
        },
    },
    ["trigger"] = {
        Source = "idle",
        MinProgress = .1,
        SoundTable = {
            {s = ")weapons/arccw_ud/uzi/prefire.ogg",         t = 0, c = ci},
        },
    },
    ["fire"] = {
        Source = "fire",
        Time = 13 / 30,
        ShellEjectAt = 0.01,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0, v = 0.25 }},
    },
    ["fire_iron"] = {
        Source = "fire",
        Time = 13 / 30,
        ShellEjectAt = 0.01,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0 }},
    },
    ["fire_empty"] = {
        Source = "fire_empty",
        Time = 13 / 30,
        ShellEjectAt = 0.01,
        SoundTable = {
            {s = path .. "mech_last.ogg", t = 0}, -- Temporary
        },
    },
    ["fire_iron_empty"] = {
        Source = "fire_empty",
        Time = 13 / 30,
        ShellEjectAt = 0.01,
        SoundTable = {
            {s = path .. "mech_last.ogg", t = 0}, -- Temporary
        },
    },

    ["fire_cycle"] = {
        Source = "fire",
        Time = 13 / 30,
    },

    ["cycle"] = {
        Source = "fix",
        Time = 36 / 30 * 0.7,
        ShellEjectAt = 0.3,
        LHIK = true,
        LHIKIn = 0.3 * 0.7,
        LHIKEaseIn = 0.4 * 0.7,
        LHIKEaseOut = 0.15 * 0.7,
        LHIKOut = 0.4 * 0.7,
        SoundTable = {
            {s = path .. "chback.ogg",   t = 0.05},
            {s = common .. "cloth_4.ogg",  t = 0.2},
            {s = path .. "chamber.ogg",  t = 0.3},
        },
    },

    ["fix"] = {
        Source = "fix",
        Time = 45 / 30,
        ShellEjectAt = false,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = path .. "chback.ogg",   t = 0.15},
            {s = common .. "cloth_4.ogg",  t = 0.5},
            {s = path .. "chamber.ogg",  t = 0.5},
        },
    },
    ["fix_empty"] = {
        Source = "fix_empty",
        Time = 45 / 30,
        ShellEjectAt = false,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = path .. "chback.ogg",   t = 0.15},
            {s = common .. "cloth_4.ogg",  t = 0.5},
            {s = path .. "ch_forward_empty.ogg",  t = 0.5},
        },
    },

    -- 30 Round Reloads --

    ["reload"] = {
        Source = "reload",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 71 / 30,
        MinProgress = 1.5,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.7,
        SoundTable = {
            {s = rottle,  t = 0.0},
            {s = common .. "magpouch_gear.ogg", t = 0.2, v = 0.5},
            {s = ratel, t = 0.25},
            {s = path .. "magout_empty.ogg", 	 t = 0.23},
            {s = ratel, t = 0.5},
            {s = path .. "struggle.ogg",    t = 1, v = 0.4},
            {s = path .. "magin.ogg",    t = 0.97},
            {s = ratel, t = 1.1},
            {s = rottle,  t = 1.15},
            {s = common .. "grab-polymer.ogg", t = 1.77, v = 0.25},
            {s = common .. "rattle_b2i_rifle.ogg", t = 1.7},
            {s = common .. "shoulder.ogg", t = 1.8},
        },
    },
    ["reload_empty"] = {
        Source = "reload_empty",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 87 / 30,
        MinProgress = 2,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.9,
        SoundTable = {
            {s = rottle,  t = 0.0},
            {s = ratel, t = 0.25},
            {s = common .. "magpouch_gear.ogg", t = 0.1, v = 0.5},
            {s = path .. "magout_empty.ogg", 	 t = 0.2},
            {s = ratel, t = 0.5},
            {s = common .. "rifle_magdrop.ogg",  t = 0.65},
            {s = path .. "struggle.ogg",    t = 0.95, v = 0.4},
            {s = path .. "magin.ogg",    t = 0.95},
            {s = ratel, t = 1.1},
            {s = rottle,  t = 1.39},
            {s = path .. "boltdrop.ogg", t = 1.7},
            {s = ratel, t = 1.9},
            {s = common .. "rattle_b2i_rifle.ogg", t = 2.0},
            {s = common .. "grab-polymer.ogg", t = 2.1, v = 0.35},
            {s = common .. "shoulder.ogg", t = 2.1},
        },
    },

    -- 20 Round Reloads --

    ["reload_20"] = {
        Source = "reload_20",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 71 / 30,
        MinProgress = 1.5,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.7,
        SoundTable = {
            {s = rottle,  t = 0.0},
            {s = ratel, t = 0.05},
            {s = path .. "magout_empty.ogg", 	 t = 0.09},
            {s = common .. "magpouch_gear.ogg", t = 0.1},
            {s = rottle,  t = 0.75},
            {s = ratel, t = 0.85},
            {s = path .. "struggle.ogg",    t = 0.9, v = 0.4},
            {s = path .. "magin.ogg",    t = 0.95},
            {s = rottle,  t = 1.1},
            {s = ratel, t = 1.125},
            {s = common .. "rattle_b2i_rifle.ogg", t = 1.65},
            {s = common .. "grab-polymer.ogg", t = 1.7, v = 0.25},
            {s = common .. "shoulder.ogg", t = 1.75},
        },
    },
    ["reload_empty_20"] = {
        Source = "reload_empty_20",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 86 / 30,
        MinProgress = 2,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.3,
        LHIKOut = 0.8,
        SoundTable = {
            {s = common .. "magpouch_gear.ogg", t = 0},
            {s = rottle, t = 0.01},
            {s = ratel, t = 0.05},
            {s = path .. "magout_empty.ogg", 	 t = 0.075},
            {s = rottle, t = 0.75},
            {s = ratel, t = 0.9},
            {s = common .. "rifle_magdrop.ogg",  t = 0.65},
            {s = path .. "struggle.ogg",    t = 0.8, v = 0.4},
            {s = path .. "magin.ogg",    t = 0.85},
            {s = rottle, t = 1.4},
            {s = ratel, t = 1.4},
            {s = path .. "chamber_press.ogg", t = 1.72},
            {s = common .. "rattle_b2i_rifle.ogg", t = 1.95},
            {s = common .. "grab-polymer.ogg", t = 2.075, v = 0.25},
            {s = common .. "shoulder.ogg", t = 2.13},
        },
    },

    -- 40 Round Reloads --

    ["reload_40"] = {
        Source = "reload_40",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 71 / 30,
        MinProgress = 1.5,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.7,
        SoundTable = {
            {s = rottle, t = 0.0},
            {s = ratel, t = 0.1},
            {s = path .. "magout_empty.ogg", 	 t = 0.2},
            {s = common .. "magpouch_gear.ogg", t = 0.25},
            {s = rottle, t = 0.75},
            {s = ratel, t = 0.8},
            {s = path .. "struggle.ogg",    t = 0.95, v = 0.4},
            {s = path .. "magin.ogg",    t = 1.0},
            {s = rottle, t = 1.1},
            {s = ratel, t = 1.25},
            {s = common .. "rattle_b2i_rifle.ogg", t = 1.65},
            {s = common .. "shoulder.ogg", t = 1.75},
        },
    },
    ["reload_empty_40"] = {
        Source = "reload_empty_40",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 85 / 30,
        MinProgress = 2,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.8,
        SoundTable = {
            {s = rottle,  t = 0.0},
            {s = path .. "magout_empty.ogg", 	 t = 0.2},
            {s = common .. "magpouch_gear.ogg", t = 0.25},
            {s = rottle,  t = 0.75},
            {s = common .. "rifle_magdrop.ogg",  t = 0.8},
            {s = path .. "struggle.ogg",    t = 1.0, v = 0.4},
            {s = path .. "magin.ogg",    t = 1.05},
            {s = rottle,  t = 1.475},
            {s = ratel,  t = 1.475},
            {s = path .. "boltdrop.ogg", t = 1.78},
            {s = common .. "rattle_b2i_rifle.ogg", t = 2.1},
            {s = common .. "shoulder.ogg", t = 2.2},
        },
    },

    -- 60 Round Reloads --

    ["reload_60"] = {
        Source = "reload_60",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 71 / 30,
        MinProgress = 1.5,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.7,
        SoundTable = {
            {s = rottle, t = 0.0},
            {s = common .. "magpouch_gear.ogg", t = 0.2},
            {s = path .. "magout_empty.ogg", 	 t = 0.25},
            {s = rottle, t = 0.75},
            {s = path .. "struggle.ogg",    t = 1.0, v = 0.4},
            {s = path .. "magin.ogg",    t = 1.1},
            {s = rottle, t = 1.1},
            {s = common .. "grab-polymer.ogg", t = 1.78, v = 0.25},
            {s = common .. "rattle_b2i_rifle.ogg", t = 1.8},
            {s = common .. "shoulder.ogg", t = 1.9},
        },
    },
    ["reload_empty_60"] = {
        Source = "reload_empty_60",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 85 / 30,
        MinProgress = 2,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.8,
        SoundTable = {
            {s = rottle, t = 0.0},
            {s = common .. "magpouch_gear.ogg", t = 0.2},
            {s = path .. "magout_empty.ogg", 	 t = 0.25},
            {s = rottle, t = 0.75},
            {s = common .. "rifle_magdrop.ogg",  t = 0.8},
            {s = path .. "struggle.ogg",    t = 1.0, v = 0.4},
            {s = path .. "magin.ogg",    t = 1.1},
            {s = rottle, t = 1.475},
            {s = ratel, t = 1.475},
            {s = path .. "boltdrop.ogg", t = 1.8},
            {s = common .. "rattle_b2i_rifle.ogg", t = 2.1},
            {s = common .. "grab-polymer.ogg", t = 2.15, v = 0.25},
            {s = common .. "shoulder.ogg", t = 2.2},
        },
    },

    -- 100 Round Reloads --

    ["reload_100"] = {
        Source = "reload_100",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 71 / 30,
        MinProgress = 1.75,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.3,
        LHIKOut = 0.5,
        SoundTable = {
            {s = rottle, t = 0.0},
            {s = path .. "magout_empty.ogg", 	 t = 0.2},
            {s = rottle, t = 0.75},
            {s = path .. "struggle.ogg",    t = 0.95, v = 0.4},
            {s = path .. "magin.ogg",    t = 1.05},
            {s = rottle, t = 1.1},
            {s = path .. "magtap.ogg",   t = 1.59},
            {s = common .. "cloth_4.ogg",  t = 1.65},
            {s = common .. "rattle_b2i_rifle.ogg", t = 1.8},
            {s = common .. "grab-polymer.ogg", t = 1.85, v = 0.25},
            {s = common .. "shoulder.ogg", t = 2.0},
        },
    },
    ["reload_empty_100"] = {
        Source = "reload_empty_100",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 90 / 30,
        MinProgress = 2.5,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.3,
        LHIKOut = 0.6,
        SoundTable = {
            {s = rottle, t = 0.0},
            {s = path .. "magout_empty.ogg", 	 t = 0.2},
            {s = rottle, t = 0.75},
            {s = common .. "magdrop.ogg",  t = 0.65},
            {s = path .. "struggle.ogg",    t = 0.95, v = 0.4},
            {s = path .. "magin.ogg",    t = 1.05},
            {s = path .. "magtap.ogg",   t = 1.59},
            {s = rottle, t = 1.75},
            {s = path .. "chback.ogg",   t = 2.0},
            {s = common .. "cloth_4.ogg",  t = 2.05},
            {s = path .. "chamber.ogg",  t = 2.22},
            {s = common .. "rattle_b2i_rifle.ogg", t = 2.5},
            {s = common .. "grab-polymer.ogg", t = 2.55, v = 0.25},
            {s = common .. "shoulder.ogg", t = 2.6},
        },
    },

    -- 9mm 32 Round Reloads --

    ["reload_9mm"] = {
        Source = "reload_9mm",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 70 / 30,
        MinProgress = 1.5,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.5,
        SoundTable = {
            {s = rottle, t = 0.0},
            {s = common .. "magpouch.ogg", t = 0.15},
            {s = "weapons/arccw_ud/uzi/" .. "magout.ogg", 	 t = 16 / 30},
            {s = rottle, t = 0.75},
            {s = "weapons/arccw_ud/uzi/" .. "magin.ogg",    t = 27 / 30},
            {s = rottle, t = 1.1},
            {s = common .. "magpouchin.ogg", t = 1.55},
            {s = common .. "shoulder.ogg", t = 1.93},
        },
    },
    ["reload_empty_9mm"] = {
        Source = "reload_empty_9mm",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 80 / 30,
        MinProgress = 2,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.1,
        LHIKEaseIn = 0.1,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.9,
        SoundTable = {
            {s = rottle, t = 0.0},
            {s = "weapons/arccw_ud/uzi/" .. "magout.ogg", 	 t = 0.1},
            {s = common .. "magpouch.ogg", t = 0.45},
            {s = rottle, t = 0.75},
            {s = "weapons/arccw_ud/uzi/" .. "magin.ogg",    t = 0.8},
            {s = path .. "chamber_press.ogg", t = 1.7},
            {s = rottle, t = 1.39},
            {s = common .. "shoulder.ogg", t = 2.15},
        },
    },


    ["enter_inspect"] = {
        Source = "inspect_enter",
        -- time = 35 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 2.5,
        SoundTable = {
            {s = rottle, t = 0},
            {s = common .. "movement-rifle-02.ogg", t = 0.1},
        },
    },
    ["idle_inspect"] = {
        Source = "inspect_loop",
        -- time = 72 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 999, -- maybe im dumb
    },
    ["exit_inspect"] = {
        Source = "inspect_exit",
        -- time = 66 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 999, -- maybe im dumb
        SoundTable = {
            {s = common .. "movement-rifle-04.ogg", t = 0.2},
            {s = rottle, t = 0.25},
            {s = rottle, t = 1.2},
            {s = common .. "movement-rifle-03.ogg", t = 1.25},
        },
    },
    ["enter_inspect_empty"] = {
        Source = "inspect_enter_empty",
        -- time = 35 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 2.5,
        SoundTable = {
            {s = rottle, t = 0},
            {s = common .. "movement-rifle-02.ogg", t = 0.1},
        },
    },
    ["idle_inspect_empty"] = {
        Source = "inspect_loop_empty",
        -- time = 72 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 999,
    },
    ["exit_inspect_empty"] = {
        Source = "inspect_exit_empty",
        -- time = 66 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 999,
        SoundTable = {
            {s = common .. "movement-rifle-04.ogg", t = 0.2},
            {s = rottle, t = 0.25},
            {s = rottle, t = 1.2},
            {s = common .. "movement-rifle-03.ogg", t = 1.25},
        },
    },
}

local hgLookup = {
    ["default"]     = {0,4,0},
    ["tactical"]    = {2,5,0},
    ["a1"]          = {1,1,1},
    ["heat"]          = {10,10,1},
    ["heatm203"]          = {11,11,1},
    ["wood"]          = {1,1,1},
    ["lmg"]          = {3,3,1},
    ["fpw"]          = {6,6,2},
    ["ru556"]          = {7,7,3},
    ["adar"]          = {8,8,2},
    ["hk416"]          = {9,9,3},
    ["607"]          = {9,9,0},
}
-- Structure: 20in appearance, 14/11in appearance, gas block mode
-- Gas block modes: 0 standard, 1 always at 20" position, 2 at ADAR position when short, 3 at ADAR position when short and not flat

local barrLookup = {
    ["sd"] = -1,
    ["20in"] = 0,
    ["14in"] = 1,
    ["fpw"] = 1,
    ["10in"] = 2,
}

SWEP.Hook_ModifyBodygroups = function(wep, data)
    local vm = data.vm
    local atts = wep.Attachments
    if !IsValid(vm) then return end

    local barrel = string.Replace(atts[2].Installed or "20in","ud_m16_barrel_","")
    local barr = barrLookup[barrel]
    local hg = string.Replace(atts[3].Installed or "default","ud_m16_hg_","")
    hg = string.Replace(hg,"uf_m16_hg_","")

    local optic = atts[1].Installed
    local muzz = atts[4].Installed or barrel == "sd"
    local laser = atts[8].Installed
    local fs = atts[16].Installed
    local retro = wep:GetBuff_Override("TopMount")

    -- Retro rail
    if optic then
        if retro then
            -- Raised rail (retro)
            vm:SetBodygroup(3, retro)
        else
            -- Flat rail
            vm:SetBodygroup(1, 1)
            vm:SetBodygroup(3, 2)
        end
    end

    -- Dynamic handguard
    if barr == -1 then
        vm:SetBodygroup(5,9)
    elseif barr == 0 and hgLookup[hg] then
        vm:SetBodygroup(5,hgLookup[hg][1])
    elseif hgLookup[hg] then
        vm:SetBodygroup(5,hgLookup[hg][2])
    else
        vm:SetBodygroup(5,9)
    end

    -- Gas block
    if barrel == "sd" or (atts[6].Installed == "ud_m16_receiver_fpw" and barr > 0) then
        vm:SetBodygroup(6,5)
    else
        local gbPos = hgLookup[hg] and hgLookup[hg][3] or 0
        local lwr = atts[6].Installed
        local flat = (
            wep:GetBuff_Override("FrontSight")
            or atts[6].Installed == "ud_m16_receiver_fpw"
            or (optic and fs ~= "ud_m16_charm_fs" and !(wep:GetBuff_Override("IronSight") or wep:GetBuff_Override("TopMount")))
        ) and 1 or 0

        if gbPos == 1 or barr == 0 then
            vm:SetBodygroup(6, 0 + flat)
        elseif gbPos == 2 then
            vm:SetBodygroup(6, 4 + flat * 2)
        elseif gbPos == 3 then
            vm:SetBodygroup(6, 4 - flat)
        else
            vm:SetBodygroup(6, 2 + flat)
        end
    end

    -- Default flash hider
    if !muzz then
        if barr == 0 then
            vm:SetBodygroup(11,1)
        elseif barr == 1 then
            vm:SetBodygroup(11,2)
        else
            vm:SetBodygroup(11,3)
        end
    else
        vm:SetBodygroup(11,0)
    end

    -- Tactical clamp
    if laser and hg ~= "tactical" then
        if barr == 0 then
            vm:SetBodygroup(10,1)
        elseif barr == 1 then
            vm:SetBodygroup(10,3)
        else
            vm:SetBodygroup(10,2)
        end
    else
        vm:SetBodygroup(10,0)
    end

    -- Disable tac rail element with tac hg
    if hg == "tactical" and (atts[7].Installed or atts[18].Installed) then
        vm:SetBodygroup(9,0)
    end

    -- .50 Beowulf magazines
    if atts[5].Installed == "ud_m16_receiver_50beo" and !atts[11].Installed then
        vm:SetBodygroup(2, 8)
    end
end

-- RAYCAR-0, rifle barrel
local bar0_fake = "First variation of the RAYCAR rifle. Tests showed that users were more likely to hit a target if they fired multiple shots, but were likely to spray in full-auto and fail to hit anything. As a result, a ratcheted three-round burst system was implemented which limited the maximum burst a user could fire to three shots.\n\nWell-rounded gun with no major downsides."

-- RAYCAR-1, carbine barrel
local bar1_fake = "Second variation of the RAYCAR rifle. It eventually replaced the RAYCAR-0 across much of the Army for its favorably low weight and comparable performance. The -1 variant has since become one of the most iconic and widespread American service rifles in the modern era.\n\nLight and versatile, but requires discipline to control."

-- RAYCAR-2, commando barrel
local bar2_fake = "Third variation of the RAYCAR rifle. Developed with assistance from the Navy, the \"commando\" barrel allows for the weapon to be very compact, even short enough to be classified as a submachine gun, enhancing usability in vehicles and in enclosed spaces.\n\nVery lightweight and manuverable, but with very aggressive recoil to match."

-- RAYPAW :3
local smgDesc_fake = "Submachine gun based on the RAYCAR rifle. Despite its similar appearance, it uses a different mechanism from its parent rifle.\n\nMore accurate than other submachine guns due to its rifle frame and closed-bolt mechanism."

-- RBY50
local beoDesc_fake = "Aftermarket semi-automatic variant of the RAYCAR rifle firing an oversized magnum cartridge.\n\nProvides extremely high stopping power at close range."

-- RBY300
local blkDesc_fake = "Aftermarket automatic variant of the RAYCAR rifle. The .300 Blackout cartridge has a ballistic performance more akin to the 7.62x39mm Soviet cartridge, with a similarly sized projectile but shorter effective range.\n\nSlightly more inaccurate, made up with a higher stopping power and a subsonic projectile."

-- UKCAR
local ukDesc_fake = "Normally, RAYCAR style rifles are imported with a semi-automatic fire group for the civilian market. This one, however, has been neutered by authority of the British crown with a manual-action receiver.\n\nBit cringe, innit?"

-- RAYSAW
local lmgDesc_fake = "Configuration of the RAYCAR designed for a light machine gun role, used vaguely within the Marine Corps before the adoption of the Minimi.\n\nHeavier than the standard platform, but the integral bipod can be deployed onto surfaces for excellent recoil control."

-- Fallout barrel or sumn idk
local ncrDesc_fake = "Standard-issue rifle of the New California Republic. Traditionally produced with a semi-automatic receiver, the wooden furniture is more readily replaceable and adds additional recoil control for maximum accuracy.\n\nWell-rounded gun with no major downsides."

-- Patriot easter egg. Is it overpowered? I don't think so, a configuration like this is already pretty uncontrollable and imprecise as is, and overheating is the new magazine.
local a1, a2 = {}, {"patr1", "patr2", "patr3", "patr4", "patr5"}
SWEP.O_Hook_Override_BottomlessClip = function(wep, data)
    if wep:CheckFlags(a1, a2) then
        data.current = true
    end
end


SWEP.Hook_NameChange = function(wep, name)
    local trueNames = GetConVar("arccw_truenames"):GetBool()
    local atts = wep.Attachments
    local flat = atts[1].Installed and !wep:GetBuff_Override("TopMount")

    local barrel = string.Replace(atts[2].Installed or "20in","ud_m16_barrel_","")
    local barr = barrLookup[barrel]
    local hg = string.Replace(atts[3].Installed or "default","ud_m16_hg_","")
    local upr = string.Replace(atts[5].Installed or "default","ud_m16_receiver_","")
    local lwr = string.Replace(atts[6].Installed or "default","ud_m16_receiver_","")

    if wep:CheckFlags(a1, a2) then -- Patriot configuration
        wep.Trivia_Desc = patriotDesc
        return "The Patriot"
    elseif !trueNames then -- Custom lore-based fake names
        local pre = (lwr == "auto" and "AM" or "RAY")
        if upr == "9mm" then
            local sd = (barr == -1)
            wep.Trivia_Desc = smgDesc_fake
            if flat then
                return (sd and pre .. "SSMG-NG") or pre .. "PAW-" .. barr .. "NG"
            end
            return (sd and pre .. "SSMG") or pre .. "PAW-" .. barr
        elseif upr == "50beo" then
            wep.Trivia_Desc = beoDesc_fake
            return "RBY"--50"
        elseif upr == "300blk" then
            wep.Trivia_Desc = blkDesc_fake
            return "RBY"--300"
        elseif lwr == "fpw" then
            wep.Trivia_Desc = bar1_fake
            return pre .. "FPW"
        elseif lwr == "cali" then
            wep.Trivia_Desc = ukDesc_fake
            return "UKCAR"
        else
            if barr == 0 then
                if hg == "lmg" then
                    wep.Trivia_Desc = lmgDesc_fake
                    return pre .. "SAW" .. (flat and "-NG" or "")
                elseif flat then
                    return pre .. "CAR-0NG"
                else
                    wep.Trivia_Desc = bar0_fake
                    return pre .. "CAR-0"
                end
            elseif barr == 1 then
                wep.Trivia_Desc = bar1_fake
                if flat then
                    return pre .. "CAR-1NG"
                end
                return pre .. "CAR-1"
            elseif barr == 2 then
                wep.Trivia_Desc = bar2_fake
                if flat then
                    return pre .. "CAR-2NG"
                end
                return pre .. "CAR-2"
            end
        end

        wep.Trivia_Desc = bar0_fake
        return pre .. "CAR-0"

    else

        if upr == "9mm" then
            local sd = (barr == -1)
            wep.Trivia_Desc = smgDesc
            if lwr == "semi" then
                return "AR-15 9mm"
            elseif flat then
                return "R0991"
            end
            return "R0635"

        end

        if lwr == "auto" then
            if upr == "a1" then
                wep.Trivia_Desc = a1Desc
                if barr == 0 then
                    return "M16A1"
                elseif barr == 1 then
                    return "M605"
                end
                wep.Trivia_Desc = carDesc
                return "CAR-15"
            end
            if barr == 0 then
                wep.Trivia_Desc = a3Desc
                if hg == "lmg" then
                    wep.Trivia_Desc = lmgDesc
                    return "Colt LMG"
                elseif flat and hg == "tactical" then
                    return "R0901"
                end
                return "M16A3"
            elseif barr == 1 then
                wep.Trivia_Desc = m4Desc
                if flat then
                    return "M4A1"
                end
                return "XM4"
            else
                wep.Trivia_Desc = carDesc
                if flat then
                    wep.Trivia_Desc = m4Desc
                    if upr == "300blk" then
                        return "Mk 18"
                    end
                    return "Mk 18 Mod 0"
                end
                return "CAR-15"
            end
        elseif lwr == "semi" or upr == "50beo" then
            wep.Trivia_Desc = arDesc
            if hg == "wood" then
                wep.Trivia_Desc = ncrDesc
                if barr == 0 then
                    return "Service Rifle"
                end
                return "Service Carbine"
            elseif flat and hg == "adar" then
                return "ADAR 2-15"
            elseif barr > 0 then
                if barr == 2 and atts[10].Installed == "ud_m16_stock_buffer" then
                    return "AR-15 Pistol"
                elseif upr == "a1" and barr == 1 then
                    return "CRXM177E2B"
                else
                    return "AR-15 SBR"
                end
            elseif upr == "a1" then
                return "CRM16A1"
            end
            return "AR-15"
        elseif lwr == "fpw" then
            wep.Trivia_Desc = m4Desc
            return "M231 FPW"
        elseif lwr == "cali" then
            wep.Trivia_Desc = ukDesc
            return "AR-15GB"
        else
            wep.Trivia_Desc = origDesc
            if barr == 0 and flat then
                return "M16A4"
            elseif barr == 1 then
                wep.Trivia_Desc = m4Desc
                return "M4 Carbine"
            elseif barr == 2 then
                return "M16 Commando"
            end
        end

        wep.Trivia_Desc = origDesc
        return "M16A2"

    end
end



SWEP.Attachments = {
    {
        PrintName = "Optic",
        DefaultAttName = "Iron Sights",
        InstalledEles = {"upper_flat"},
        Slot = {"optic","optic_sniper","ud_m16_rs"},
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(0, -1.75, 3),
            vang = Angle(90, 0, -90),
        },
        SlideAmount = {
            vmin = Vector(0, -1.6, 3 - 2),
            vmax = Vector(0, -1.6, 3 + 1),
        },
    },
    {
        PrintName = "Barrel",
        DefaultAttName = "20\" Standard Barrel",
        DefaultAttIcon = Material("entities/att/acwatt_ud_m16_barrel_20.png", "smooth mips"),
        Slot = "ud_m16_blen",
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(2.8, -4.2, -11.5),
            vang = Angle(90, 0, -90),
        },
    },
    {
        PrintName = "Handguard",
        DefaultAttName = "Ribbed Handguard",
        DefaultAttIcon = Material("entities/att/acwatt_ud_m16_hg_ribbed.png", "smooth mips"),
        Slot = "ud_m16_hg",
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(0, -1.63, -0.41),
            vang = Angle(90, 0, -90),
        },
        ExcludeFlags = {"sd"}
    },
    {
        PrintName = "Muzzle",
        DefaultAttName = "Standard Muzzle",
        Slot = {"muzzle", "ud_m16_muzzle"},
        Bone = "m16_parent",
        VMScale = Vector(1, 1, 1),
        WMScale = VMScale,
        Offset = {
            vpos = Vector(0, -.33, 23.27),
            vang = Angle(90, 0, -90),
        },
        ExcludeFlags = {"sd", "m16_stub"},
    },
    {
        PrintName = "Upper Receiver",
        DefaultAttName = "5.56x45mm Upper",
        DefaultAttIcon = Material("entities/att/uc_bullets/556x45.png", "smooth mips"),
        Slot = {"ud_m16_receiver"},
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(2.8, -4.2, -11.5),
            vang = Angle(90, 0, -90),
        },
        ExcludeFlags = {"ud_m16_fpw"}
    },
    {
        PrintName = "Lower Receiver",
        DefaultAttName = "Burst Lower",
        DefaultAttIcon = Material("entities/att/acwatt_ud_m16_receiver_default.png", "smooth mips"),
        Slot = {"ud_m16_fcg"},
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(2.8, -4.2, -11.5),
            vang = Angle(90, 0, -90),
        },
        ExcludeFlags = {"m16_nolower"}
    },
    {
        PrintName = "Underbarrel",
        Slot = "foregrip",
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(0, 6, 11),
            vang = Angle(90, 0, -90),
        },
        InstalledEles = {"rail_fg"},
        ExcludeFlags = {"m16_lmg", "m16_stub"},
        SlideAmount = {
            vmin = Vector(0, .65, 11.5),
            vmax = Vector(0, .65, 7.5),
        },
		MergeSlots = {18},
    },
    {
        PrintName = "Tactical",
        Slot = {"tac"},
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(0, 0.3, 21.25),
            vang = Angle(90, 0, -90),
        },
        GivesFlags = {"tac"},
        --InstalledEles = {"ud_m16_clamp_fullsize"}
    },
    {
        PrintName = "Grip Type",
        Slot = {"ud_m16_grip"},
        DefaultAttName = "Standard Grip",
        DefaultAttIcon = Material("entities/att/acwatt_ud_m16_grip_default.png", "smooth mips"),
        ExcludeFlags = {"m16_adar"}
    },
    {
        PrintName = "Stock",
        Slot = {"ud_m16_stock","go_stock"},
        DefaultAttName = "Full Stock",
        DefaultAttIcon = Material("entities/att/acwatt_ud_m16_stock_default.png", "smooth mips"),
        -- GSO support
        InstalledEles = {"stock_231_tube"},
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(-0.02, 0, -2.7),
            vang = Angle(90, 0, -90),
        },
    },
    {
        PrintName = "Magazine",
        Slot = {"ud_m16_mag"},
        DefaultAttName = "30-Round Mag",
        DefaultAttIcon = Material("entities/att/acwatt_ud_m16_mag_30.png", "smooth mips"),
    },
    {
        PrintName = "Ammo Type",
        DefaultAttName = "\"FMJ\" Full Metal Jacket",
        DefaultAttIcon = Material("entities/att/arccw_uc_ammo_generic.png", "mips smooth"),
        Slot = "uc_ammo",
    },
    {
        PrintName = "Powder Load",
        Slot = "uc_powder",
        DefaultAttName = "Standard Load"
    },
    {
        PrintName = "Training Package",
        Slot = "uc_tp",
        DefaultAttName = "Basic Training"
    },
    {
        PrintName = "Internals",
        Slot = "uc_fg", -- Fire group
        DefaultAttName = "Standard Internals"
    },
    {
        PrintName = "Front Sight",
        Slot = {"ud_m16_fs", "ud_m16_charm"},
        FreeSlot = true,
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(0, -1.65, 16.75), -- 21.75 or 15.75
            vang = Angle(90, 0, -90),
        },
        ExcludeFlags = {"sight_magpul"}
    },
    {
        PrintName = "Charm",
        Slot = {"charm", "fml_charm"}, -- "ud_m16_charm"
        FreeSlot = true,
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(0.48, 0.5, 3.9),
            vang = Angle(90, 0, -90),
        },
        -- MergeSlots = {17}
    },
    {
        PrintName = "M203 slot",
        Slot = "uc_ubgl",
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(0, -0.4, 7.2),
            vang = Angle(90, 0, -90),
        },
        Hidden = true,
        InstalledEles = {"rail_fg"},
        ExcludeFlags = {"m16_lmg", "m16_stub"},
    }
}
--lua/weapons/arccw_ud_glock.lua:
SWEP.Base = "arccw_base"
SWEP.Spawnable = true
SWEP.Category = "ArcCW - Urban Coalition"
SWEP.UC_CategoryPack = "1Urban Decay"
SWEP.AdminOnly = false
SWEP.UseHands = true

-- Muzzle and shell effects --

SWEP.MuzzleEffect = "muzzleflash_1"
SWEP.ShellEffect = "arccw_uc_shelleffect"
SWEP.ShellModel = "models/weapons/arccw/uc_shells/9x19.mdl"
SWEP.ShellScale = 1
--SWEP.ShellMaterial = "models/weapons/arcticcw/shell_9mm"
SWEP.ShellPitch = 100
SWEP.ShellSounds = ArcCW.PistolShellSoundsTable

SWEP.MuzzleEffectAttachment = 1
SWEP.CaseEffectAttachment = 2
SWEP.CamAttachment = 3
SWEP.TracerNum = 1
SWEP.TracerCol = Color(25, 255, 25)
SWEP.TracerWidth = 2

-- Fake name --

SWEP.PrintName = "GEN3"

-- True name --

SWEP.TrueName = "Glock 17"

-- Trivia --

SWEP.Trivia_Class = "Pistol"
SWEP.Trivia_Desc = [[Handgun originally designed by a curtain rod manufacturer for the Austrian military. Its reliable and cost-effective polymer design has since made it one of the most popular and widely used pistols in the world, common in military, police and civilian use alike.

Great backup weapon due to its quick draw and sight times, but a relatively low damage output makes it a less than ideal primary.]]
SWEP.Trivia_Manufacturer = "Next Generation Weapons Inc."
SWEP.Trivia_Calibre = "9x19mm Parabellum"
SWEP.Trivia_Mechanism = "Short Recoil"
SWEP.Trivia_Country = "Austria"
SWEP.Trivia_Year = 1982

-- Weapon slot --

SWEP.Slot = 1

-- Weapon's manufacturer real name --

if GetConVar("arccw_truenames"):GetBool() then
    SWEP.PrintName = SWEP.TrueName
    SWEP.Trivia_Manufacturer = "Glock Ges.m.b.H."
end

-- Viewmodel / Worldmodel / FOV --

SWEP.ViewModel = "models/weapons/arccw/c_ud_glock.mdl"
SWEP.WorldModel = "models/weapons/arccw/c_ud_glock.mdl"
SWEP.ViewModelFOV = 60
SWEP.AnimShoot = ACT_HL2MP_GESTURE_RANGE_ATTACK_AR2

-- Damage --

SWEP.Damage = ArcCW.UC.StdDmg["9mm"].max -- 4 shot close range kill (3 on chest)
SWEP.DamageMin = ArcCW.UC.StdDmg["9mm"].min -- 5 shot long range kill
SWEP.Penetration = ArcCW.UC.StdDmg["9mm"].pen

SWEP.RangeMin = 15
SWEP.Range = 50 -- 4 shot until ~35m
SWEP.DamageType = DMG_BULLET
SWEP.ShootEntity = nil
SWEP.MuzzleVelocity = 375
SWEP.PhysBulletMuzzleVelocity = 375

SWEP.BodyDamageMults = ArcCW.UC.BodyDamageMults

-- Mag size --

SWEP.ChamberSize = 1
SWEP.Primary.ClipSize = 17
SWEP.ExtendedClipSize = 33
SWEP.ReducedClipSize = 10

-- Recoil --

SWEP.Recoil = 1.0
SWEP.RecoilSide = 0.5

SWEP.RecoilRise = 0.24
SWEP.VisualRecoilMult = 1
SWEP.MaxRecoilBlowback = 0.5
SWEP.MaxRecoilPunch = 0.6

SWEP.Sway = 1

-- Firerate / Firemodes --

SWEP.Delay = 60 / 525
SWEP.Num = 1
SWEP.Firemodes = {
    {
        Mode = 1,
    },
    {
        PrintName = "fcg.safe2",
        Mode = 0,
    }
}

SWEP.ShootPitch = 100
SWEP.ShootVol = 120

SWEP.ProceduralRegularFire = false
SWEP.ProceduralIronFire = false

SWEP.ReloadInSights = true

-- NPC --

SWEP.NPCWeaponType = "weapon_pistol"
SWEP.NPCWeight = 60

-- Accuracy --

SWEP.AccuracyMOA = 7
SWEP.HipDispersion = 500
SWEP.MoveDispersion = 250
SWEP.JumpDispersion = 1000

SWEP.Primary.Ammo = "pistol"
SWEP.MagID = "glock"

SWEP.HeatCapacity = 50
SWEP.HeatDissipation = 20
SWEP.HeatDelayTime = 3

SWEP.MalfunctionMean = 150
SWEP.MalfunctionTakeRound = false

-- Speed multipliers --

SWEP.SpeedMult = 0.975
SWEP.SightedSpeedMult = 0.9
SWEP.SightTime = 0.25
SWEP.ShootSpeedMult = 1

-- Length --

SWEP.BarrelLength = 8
SWEP.ExtraSightDist = 10

-- Ironsights / Customization / Poses --

SWEP.HolsterPos = Vector(-0.5, -2, -1)
SWEP.HolsterAng = Angle(3.5, 7, -20)

SWEP.HolsterPos = Vector(-1, -2, 3)
SWEP.HolsterAng = Angle(-15.5, 2, -7)

SWEP.HoldtypeHolstered = "normal"
SWEP.HoldtypeActive = "pistol"
SWEP.HoldtypeSights = "revolver"

SWEP.IronSightStruct = {
     Pos = Vector(-2.3, 1, 2.52),
     Ang = Angle(0.3, 0, 0),
     Magnification = 1,
     ViewModelFOV = 55,
     SwitchToSound = ratel, -- sound that plays when switching to this sight
     SwitchFromSound = ratel
}

SWEP.ActivePos = Vector(-0.2, -2, 2)
SWEP.ActiveAng = Angle(0, 0, -5)

SWEP.CustomizePos = Vector(7, -2, -2)
SWEP.CustomizeAng = Angle(15, 25, 0)

SWEP.CrouchPos = Vector(-2, -6, 1)
SWEP.CrouchAng = Angle(0, 0, -20)

SWEP.BarrelOffsetHip = Vector(3.5, 0, -3)

SWEP.MirrorVMWM = true
SWEP.WorldModelOffset = {
    pos        =    Vector(-10.5, 3.5, -4.8),
    ang        =    Angle(-6, 0, 180),
    bone    =    "ValveBiped.Bip01_R_Hand",
}

-- Firing sounds --

local path = ")weapons/arccw_ud/glock/"
local path1 = ")weapons/arccw_ud/uzi/"
local common = ")/arccw_uc/common/"
SWEP.ShootSound = {
    path .. "fire-01.ogg",
    path .. "fire-02.ogg",
    path .. "fire-03.ogg",
    path .. "fire-04.ogg",
    path .. "fire-05.ogg",
    path .. "fire-06.ogg"
}
SWEP.ShootSoundSilenced = {
    path .. "fire-sup-01.ogg",
    path .. "fire-sup-02.ogg",
    path .. "fire-sup-03.ogg",
    path .. "fire-sup-04.ogg",
    path .. "fire-sup-05.ogg",
    path .. "fire-sup-06.ogg"
}

SWEP.DistantShootSound = nil
SWEP.DistantShootSoundSilenced = nil
SWEP.ShootDrySound = path .. "dryfire.ogg"

local tail = ")/arccw_uc/common/9x19/"

SWEP.DistantShootSoundOutdoors = {
    tail .. "fire-dist-9x19-pistol-ext-01.ogg",
    tail .. "fire-dist-9x19-pistol-ext-02.ogg",
    tail .. "fire-dist-9x19-pistol-ext-03.ogg",
    tail .. "fire-dist-9x19-pistol-ext-04.ogg",
    tail .. "fire-dist-9x19-pistol-ext-05.ogg",
    tail .. "fire-dist-9x19-pistol-ext-06.ogg"
}
SWEP.DistantShootSoundIndoors = {
    common .. "fire-dist-int-pistol-01.ogg",
    common .. "fire-dist-int-pistol-02.ogg",
    common .. "fire-dist-int-pistol-03.ogg",
    common .. "fire-dist-int-pistol-04.ogg",
    common .. "fire-dist-int-pistol-05.ogg",
    common .. "fire-dist-int-pistol-06.ogg"
}
SWEP.DistantShootSoundOutdoorsSilenced = {
    common .. "sup-tail-01.ogg",
    common .. "sup-tail-02.ogg",
    common .. "sup-tail-03.ogg",
    common .. "sup-tail-04.ogg",
    common .. "sup-tail-05.ogg",
    common .. "sup-tail-06.ogg",
    common .. "sup-tail-07.ogg",
    common .. "sup-tail-08.ogg",
    common .. "sup-tail-09.ogg",
    common .. "sup-tail-10.ogg"
}
SWEP.DistantShootSoundIndoorsSilenced = {
    common .. "fire-dist-int-pistol-light-01.ogg",
    common .. "fire-dist-int-pistol-light-02.ogg",
    common .. "fire-dist-int-pistol-light-03.ogg",
    common .. "fire-dist-int-pistol-light-04.ogg",
    common .. "fire-dist-int-pistol-light-05.ogg",
    common .. "fire-dist-int-pistol-light-06.ogg",
}
SWEP.DistantShootSoundOutdoorsVolume = 1
SWEP.DistantShootSoundIndoorsVolume = 1
SWEP.Hook_AddShootSound = ArcCW.UC.InnyOuty

-- Bodygroups --

SWEP.BulletBones = {
    [2] = "glock_bullet1"
}

SWEP.AttachmentElements = {
    ["ud_glock_skin_tan"] = {
        VMSkin = 1,
    },
    ["ud_glock_skin_olive"] = {
        VMSkin = 2,
    },
    ["ud_glock_skin_custom"] = {
        VMSkin = 3,
    },
    ["ud_glock_mag_10"] = {
        VMBodygroups = {{ind = 1, bg = 1}},
        AttPosMods = {
            [8] = {
            vpos = Vector(0.1, 1, -1.2),
                vang = Angle(90, 0, -90),
            }
        }
    },
    ["ud_glock_frame_subcompact"] = {
        VMBodygroups = {{ind = 0, bg = 2}},
    },
    ["ud_glock_frame_flared"] = {
        VMBodygroups = {{ind = 0, bg = 1}},
    },
    ["ud_glock_mag_33"] = {
        VMBodygroups = {{ind = 1, bg = 2}},
    },
    ["ud_glock_mag_100"] = {
        VMBodygroups = {{ind = 1, bg = 3}},
    },

    ["ud_glock_rail_optic"] = {
        VMBodygroups = {{ind = 2, bg = 1}},
    },
    ["ud_glock_slide_comp"] = {
        VMBodygroups = {{ind = 3, bg = 1}},
        NameChange = "GEN3 Custom",
        TrueNameChange = "Glock 17 Custom",
        Override_IronSightStruct = {
            Pos = Vector(-2.283, 0, 2.506),
            Ang = Angle(0.58, 0, 0),
            Magnification = 1,
        }
    },
    ["ud_glock_slide_lb"] = {
        VMBodygroups = {{ind = 3, bg = 2}},
        NameChange = "GEN3 Extended",
        TrueNameChange = "Glock 17L",
        AttPosMods = {
            [5] = {
                vpos = Vector(0, 0, 1.5),
                vang = Angle(90, 0, -90),
            }
        }
    },
    ["ud_glock_slide_auto"] = {
        VMBodygroups = {{ind = 3, bg = 3}},
        NameChange = "GEN3 Auto",
        TrueNameChange = "Glock 18C",
    },
    ["ud_glock_slide_subcompact"] = {
        VMBodygroups = {{ind = 3, bg = 8}},
        NameChange = "GEN3K",
        TrueNameChange = "Glock 26",
        AttPosMods = {
            [5] = {
                vpos = Vector(0, 0, -0.5),
                vang = Angle(90, 0, -90),
            }
        }
    },
    ["ud_glock_slide_cs"] = {
        VMBodygroups = {{ind = 3, bg = 6}},
        NameChange = "GEN3 CS",
        TrueNameChange = "Glock 18CS",
    },
    ["ud_glock_slide_carbine"] = {
        VMBodygroups = {{ind = 3, bg = 4}},
        NameChange = "GEN3 Euro Carbine",
        TrueNameChange = "Glock 17XXXL",
        AttPosMods = {
            [5] = {
                vpos = Vector(0, 0, 11.2),
                vang = Angle(90, 0, -90),
            }
        }
    },
    ["ud_glock_slide_sd"] = {
        VMBodygroups = {{ind = 3, bg = 5}},
        NameChange = "GEN3 Silent Mistress",
        TrueNameChange = "Glock 17SD",
        GivesFlags = {"sd"},
        AttPosMods = {
            [6] = {
                vpos = Vector(0, 0.1, 5),
                vang = Angle(90, 0, -90),
            },
            [7] = {
                vpos = Vector(0, 0.1, 5),
                vang = Angle(90, 0, -90),
            },
        }
    },
    ["ud_glock_slide_nytesyte"] = {
        VMBodygroups = {{ind = 3, bg = 7}},
        NameChange = "GEN3 Homeboy",
        TrueNameChange = "Glock 17 NyteSyte",
        AttPosMods = {
            [1] = {
                vpos = Vector(-0.5, 0.05, -0.5),
                vang = Angle(90, 0, 0),
            }
        },
        Override_IronSightStruct = {
            Pos = Vector(-3.057, 0, 3.397),
            Ang = Angle(0, 0, -90),
            Magnification = 1,
        }
    },
}

local desg_barr = {
    ["ud_glock_slide_auto"] = 1,
    ["ud_glock_slide_lb"] = 2,
    ["ud_glock_slide_carbine"] = 3,
    ["ud_glock_slide_comp"] = 4,
    ["ud_glock_slide_cs"] = 5,
    ["ud_glock_slide_sd"] = 6,
    ["ud_glock_slide_nytesyte"] = 7,
    ["ud_glock_slide_subcompact"] = 8,
}
local desg_cal = {
    ["ud_glock_caliber_40sw"] = 1,
    ["ud_glock_caliber_357sig"] = 2,
    ["ud_glock_caliber_10auto"] = 3,
    ["ud_glock_caliber_45acp"] = 4,
    ["ud_glock_caliber_22lr"] = 5,
    ["ud_glock_caliber_380acp"] = 6,
    ["ud_glock_caliber_460"] = 7,
    ["ud_glock_caliber_50gi"] = 8,
}

SWEP.Hook_NameChange = function(wep,name)
    barrel = desg_barr[wep.Attachments[2].Installed] or 0
    caliber = desg_cal[wep.Attachments[4].Installed] or 0
    trueNames = GetConVar("arccw_truenames"):GetBool()

    start = ""
    mid = ""
    suffix = ""

    if trueNames then
        start = "Glock "

        if caliber == 0 then
            if barrel == 1 then
                mid = "18C"
            elseif barrel == 2 then
                mid = "17L"
            elseif barrel == 5 then
                mid = "18"
            elseif barrel == 8 then
                mid = "26"
            else
                mid = "17"
            end
        else
            if caliber == 1 then
                if barrel == 2 then
                    mid = "24"
                elseif barrel == 8 then
                    mid = "27"
                else
                    mid = "22"
                end
            elseif caliber == 2 then
                if barrel == 8 then
                    mid = "33"
                else
                    mid = "31"
                end
            elseif caliber == 3 then
                if barrel == 2 then
                    mid = "40"
                elseif barrel == 8 then
                    mid = "29"
                else
                    mid = "20"
                end
            elseif caliber == 4 then
                if barrel == 8 then
                    mid = "30"
                else
                    mid = "21"
                end
            elseif caliber == 5 then
                mid = "44"
            elseif caliber == 6 then
                if barrel == 8 then
                    mid = "28"
                else
                    mid = "25"
                end
            elseif caliber == 7 then
                if barrel == 8 then
                    mid = "30"
                else
                    mid = "21"
                end
            elseif caliber == 8 then
                if barrel == 8 then
                    mid = "30"
                else
                    mid = "21"
                end
            end
        end
    else
        start = "GEN"

        if caliber == 0 then
            mid = "3"
        elseif caliber == 1 then
            mid = "5"
        elseif caliber == 2 then
            mid = "6"
        elseif caliber == 3 then
            mid = "8"
        elseif caliber == 4 then
            mid = "11"
        elseif caliber == 5 then
            mid = "22"
        elseif caliber == 6 then
            mid = "15"
        end

        if barrel == 2 then
            suffix = "L"
        elseif barrel == 8 then
            suffix = "K"
        end
    end

    if barrel == 1 and (caliber ~= 0 or !trueNames) then
        suffix = " Auto"
    elseif barrel == 2 and !trueNames then
        suffix = "L"
    elseif barrel == 3 then
        if trueNames then
            suffix = "XXXL"
        else
            suffix = " Euro Carbine"
        end
    elseif barrel == 4 then
        suffix = " Custom"
    elseif barrel == 5 then
        suffix = "CS"
    elseif barrel == 6 then
        if trueNames then
            suffix = " Hush Puppy"
        else
            suffix = " Silent Mistress"
        end
    elseif barrel == 7 then
        if trueNames then
            suffix = " NyteSyte"
        else
            suffix = " Homeboy"
        end
    end

    -- Todo: Subcompact variants when the barrel variant comes out
    return start .. mid .. suffix
end

-- Animations --

SWEP.Hook_Think = ArcCW.UC.ADSReload

-- CHAN_ITEM doesn't sound too right
local ci = CHAN_AUTO
local ratel = {path .. "pistol_rattle_1.ogg", path .. "pistol_rattle_2.ogg", path .. "pistol_rattle_3.ogg"}
local rottle = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}

SWEP.Animations = {
    ["ready"] = {
        Source = "fix_100",
        Time = 40 / 30,
        ShellEjectAt = false,
        SoundTable = {
            {s = path .. "draw.ogg", t = 0}, -- Not Temporary
            {s = common .. "raise.ogg", t = 0.05},
            {s = ratel, t = 0},
            {s = path .. "slide_pull_new.ogg",  t = 0.4, c = ci},
            {s = path .. "sliderel_deact.ogg",  t = 0.4, c = ci},
            {s = path .. "slide_rel_new.ogg",        t = 0.6, c = ci},
        },
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.1,
        LHIKEaseOut = 0.1,
        LHIKOut = 0.2,
        ProcDraw = true,
    },
    ["idle"] = {
        Source = "idle",
    },
    ["idle_empty"] = {
        Source = "idle_empty",
    },
    ["draw"] = {
        Source = "draw",
        SoundTable = {
            {s = path .. "draw.ogg", t = 0}, -- Not Temporary
            {s = common .. "raise.ogg", t = 0.05},
        },
    },
    ["draw_empty"] = {
        Source = "draw_empty",
        Time = 12 / 30,
        SoundTable = {
            {s = path .. "draw.ogg", t = 0}, -- Not Temporary
            {s = common .. "raise.ogg", t = 0.05},
        },
    },
    ["holster"] = {
        Source = "holster",
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0,
        LHIKOut = 0,
        SoundTable = {
            {s = common .. "cloth_2.ogg", t = 0},
            {s = path .. "holster.ogg", t = 0.2}, -- Not Temporary
        },
    },
    ["holster_empty"] = {
        Source = "holster_empty",
        Time = 12 / 30,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0,
        LHIKOut = 0,
        SoundTable = {
            {s = common .. "cloth_2.ogg", t = 0},
            {s = path .. "holster.ogg", t = 0.2}, -- Not Temporary
        },
    },
    ["fire"] = {
        Source = "fire",
        Time = 16 / 30,
        ShellEjectAt = 0.03,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0, v = 0.5 }},
    },
    ["fire_iron"] = {
        Source = "fire",
        Time = 16 / 30,
        ShellEjectAt = 0.03,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0 }},
    },
    ["fire_empty"] = {
        Source = "fire_empty",
        Time = 16 / 30,
        ShellEjectAt = 0.03,
        SoundTable = {
            {s = path .. "mech_last.ogg", t = 0}, -- Not Temporary
        },
    },
    ["fire_iron_empty"] = {
        Source = "fire_empty",
        Time = 16 / 30,
        ShellEjectAt = 0.03,
        SoundTable = {
            {s = path .. "mech_last.ogg", t = 0}, -- Not Temporary
        },
    },
    ["fire_stock"] = {
        Source = "fire_stock",
        Time = 16 / 30,
        ShellEjectAt = 0.03,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0.03 }},
    },
    ["fire_empty_stock"] = {
        Source = "fire_empty_stock",
        Time = 16 / 30,
        ShellEjectAt = 0.03,
        SoundTable = {
            {s = path .. "mech_last.ogg", t = 0, c = ci}, -- Not Temporary
        },
    },
    ["fire_cycle"] = {
        Source = "fire_cycle",
        Time = 16 / 30,
    },

    ["fix"] = {
        Source = "fix",
        Time = 40 / 30,
        ShellEjectAt = false,
        SoundTable = {
            {s = path .. "magtap.ogg",    t = 0.18, c = ci},
            {s = path .. "slide_pull_new.ogg",  t = 0.5, c = ci},
            {s = path .. "sliderel_deact.ogg",  t = 0.5, c = ci},
            {s = path .. "slide_rel_new.ogg",        t = 0.7, c = ci},
        },
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.1,
        LHIKEaseOut = 0.1,
        LHIKOut = 0.2,
    },
    ["fix_empty"] = {
        Source = "fix_empty",
        Time = 40 / 30,
        ShellEjectAt = false,
        SoundTable = {
            {s = path .. "magtap.ogg",    t = 0.18, c = ci},
            {s = path .. "slide_pull_new.ogg",  t = 0.5, c = ci},
            {s = path .. "sliderel_deact.ogg",  t = 0.5, c = ci},
        },
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.1,
        LHIKEaseOut = 0.1,
        LHIKOut = 0.2,
    },
    ["fix_10"] = {
        Source = "fix_10",
        Time = 40 / 30,
        ShellEjectAt = false,
        SoundTable = {
            {s = path .. "magtap.ogg",    t = 0.18, c = ci},
            {s = path .. "slide_pull_new.ogg",  t = 0.5, c = ci},
            {s = path .. "sliderel_deact.ogg",  t = 0.5, c = ci},
            {s = path .. "slide_rel_new.ogg",        t = 0.7, c = ci},
        },
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.1,
        LHIKEaseOut = 0.1,
        LHIKOut = 0.2,
    },
    ["fix_empty_10"] = {
        Source = "fix_empty_10",
        Time = 40 / 30,
        ShellEjectAt = false,
        SoundTable = {
            {s = path .. "magtap.ogg",    t = 0.18, c = ci},
            {s = path .. "slide_pull_new.ogg",  t = 0.5, c = ci},
            {s = path .. "sliderel_deact.ogg",  t = 0.5, c = ci},
        },
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.1,
        LHIKEaseOut = 0.1,
        LHIKOut = 0.2,
    },
    ["fix_33"] = {
        Source = "fix_33",
        Time = 40 / 30,
        ShellEjectAt = false,
        SoundTable = {
            {s = path .. "magtap.ogg",    t = 0.18, c = ci},
            {s = path .. "slide_pull_new.ogg",  t = 0.5, c = ci},
            {s = path .. "sliderel_deact.ogg",  t = 0.5, c = ci},
            {s = path .. "slide_rel_new.ogg",        t = 0.7, c = ci},
        },
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.1,
        LHIKEaseOut = 0.1,
        LHIKOut = 0.2,
    },
    ["fix_empty_33"] = {
        Source = "fix_empty_33",
        Time = 40 / 30,
        ShellEjectAt = false,
        SoundTable = {
            {s = path .. "magtap.ogg",    t = 0.18, c = ci},
            {s = path .. "slide_pull_new.ogg",  t = 0.5, c = ci},
            {s = path .. "sliderel_deact.ogg",  t = 0.5, c = ci},
        },
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.1,
        LHIKEaseOut = 0.1,
        LHIKOut = 0.2,
    },
    ["fix_100"] = {
        Source = "fix_100",
        Time = 40 / 30,
        ShellEjectAt = false,
        SoundTable = {
            {s = ratel, t = 0},
            {s = path .. "slide_pull_new.ogg",  t = 0.4, c = ci},
            {s = path .. "sliderel_deact.ogg",  t = 0.4, c = ci},
            {s = path .. "slide_rel_new.ogg",        t = 0.6, c = ci},
        },
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.1,
        LHIKEaseOut = 0.1,
        LHIKOut = 0.2,
    },
    ["fix_empty_100"] = {
        Source = "cycle_empty",
        Time = 40 / 30,
        ShellEjectAt = false,
        SoundTable = {
            {s = ratel, t = 0},
            {s = path .. "sliderel_deact.ogg",  t = 0.5, c = ci},
            {s = path .. "slide_pull_new.ogg",  t = 0.5, c = ci},
        },
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.1,
        LHIKEaseOut = 0.1,
        LHIKOut = 0.2,
    },

    ["cycle"] = {
        Source = "cycle",
        Time = 32 / 30,
        ShellEjectAt = 0.4,
        SoundTable = {
            {s = rottle, t = 0, v = 50},
            {s = path .. "slide_pull_new.ogg",  t = 0.3, c = ci, v = 50},
            {s = path .. "sliderel_deact.ogg",  t = 0.3, c = ci, v = 50},
            {s = path .. "slide_rel_new.ogg",        t = 0.55, c = ci, v = 50},
        },
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.1,
        LHIKEaseOut = 0.1,
        LHIKOut = 0.2,
    },
    ["cycle_empty"] = {
        Source = "cycle_empty",
        Time = 32 / 30,
        ShellEjectAt = 0.4,
        SoundTable = {
            {s = rottle, t = 0, v = 50},
            {s = path .. "slide_pull_new.ogg",  t = 0.3, c = ci, v = 50},
            {s = path .. "sliderel_deact.ogg",  t = 0.3, c = ci, v = 50},
        },
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.1,
        LHIKEaseOut = 0.1,
        LHIKOut = 0.2,
    },

    -- 17 Round Reloads --

    ["reload"] = {
        Source = "reload",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
        Time = 56 / 30,
        MinProgress = 1.1,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.3,
        SoundTable = {
            {s = rottle, t = 0},
            {s = common .. "magpouch_pull_small.ogg", t = 0.075},
            {s = ratel, t = 0.3},
            {s = path .. "magout_partial.ogg",        t = 0.35, c = ci},
            {s = ratel, t = 0.4},
            {s = path .. "magin_new.ogg",         t = 0.45, c = ci},
            {s = rottle, t = 0.6},
            {s = common .. "magpouch_replace_small.ogg", t = 1.25},
        },
    },
    ["reload_empty"] = {
        Source = "reload_empty",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
        Time = 65 / 30,
        MinProgress = 1.5,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.3,
        SoundTable = {
            {s = ratel, t = 0},
            {s = path .. "magout_empty.ogg",        t = 0.13, c = ci},
            {s = common .. "magpouch_pull_small.ogg", t = 0.35},
            {s = path .. "magin_new.ogg",         t = 0.5, v = 1.5},
            {s = ratel, t = 0.5},
            {s = common .. "pistol_magdrop.ogg",  t = 0.65},
            {s = rottle, t = 1.15},
            {s = path .. "chamber.ogg",      t = 1.39},
        },
    },
    ["reload_empty_fesiug"] = {
        Source = "reload_empty_fesiug",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
        Time = 78 / 30,
        MinProgress = 1.5,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.3,
        SoundTable = {
            {s = ratel, t = 0},
            {s = path .. "magout_empty.ogg",        t = 0.13, c = ci},
            {s = common .. "magpouch_pull_small.ogg", t = 0.35},
            {s = path .. "magin_new.ogg",         t = 0.55, c = ci},
            {s = ratel, t = 0.5},
            {s = common .. "pistol_magdrop.ogg",  t = 0.65},
            {s = ratel, t = 1.2},
            {s = path .. "sliderel_deact.ogg",  t = 1.62, c = ci},
            {s = path .. "chamber.ogg",        t = 1.85, v = 1.5},
            {s = rottle, t = 1.9},
        },
    },

    -- 10 Round Reloads --

    ["reload_10"] = {
        Source = "reload_10",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
        Time = 56 / 30,
        MinProgress = 1.1,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.3,
        SoundTable = {
            {s = ratel, t = 0},
            {s = common .. "magpouch_pull_small.ogg", t = 0.025, c = ci},
            {s = ratel, t = 0.3},
            {s = path .. "magout_partial.ogg",        t = 0.2, c = ci},
            {s = path .. "magin_new.ogg",         t = 0.33, v = 1.5},
            {s = common .. "magpouch_replace_small.ogg", t = 1.2},
            {s = rottle, t = 0.65},
        },
    },
    ["reload_empty_10"] = {
        Source = "reload_empty_10",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
        Time = 65 / 30,
        MinProgress = 1.5,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.3,
        SoundTable = {
            {s = ratel, t = 0},
            {s = path .. "magrelease.ogg",    t = 0.15, c = ci},
            {s = path .. "magout_empty.ogg",        t = 0.1, c = ci},
            {s = common .. "magpouch_pull_small.ogg", t = 0.3, c = ci},
            {s = path .. "magin_new.ogg",         t = 0.45, c = ci},
            {s = ratel, t = 0.5},
            {s = common .. "pistol_magdrop.ogg",  t = 0.65},
            {s = rottle, t = 0.9},
            {s = path .. "chamber.ogg",      t = 1.35, c = ci},
        },
    },

    -- 33 Round Reloads --

    ["reload_33"] = {
        Source = "reload_33",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
        Time = 56 / 30,
        MinProgress = 1.1,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.3,
        SoundTable = {
            {s = ratel, t = 0},
            {s = common .. "magpouch.ogg", t = 0.05},
            {s = ratel, t = 0.3},
            {s = path .. "magout_partial.ogg",        t = 0.4, c = ci},
            {s = path .. "magin_new.ogg",         t = 0.49},
            {s = rottle, t = 0.75},
            {s = common .. "magpouchin.ogg", t = 1.25, v = .35},
        },
    },
    ["reload_empty_33"] = {
        Source = "reload_empty_33",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
        Time = 66 / 30,
        MinProgress = 1.5,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.3,
        SoundTable = {
            {s = ratel, t = 0},
            {s = path .. "magrelease.ogg",    t = 0.16, c = ci},
            {s = path .. "magout_empty.ogg",        t = 0.16, c = ci},
            {s = common .. "magpouch.ogg", t = 0.35, c = ci},
            {s = path .. "magin_new.ogg",         t = 0.55, c = ci},
            {s = ratel, t = 0.5},
            {s = common .. "pistol_magdrop.ogg",  t = 0.65},
            {s = rottle, t = 1.3},
            {s = path .. "chamber.ogg",      t = 1.42, c = ci},
        },
    },

    -- 100 Round Reloads --

    ["reload_100"] = {
        Source = "reload_100",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
        Time = 56 / 30,
        MinProgress = 1.3,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.3,
        SoundTable = {
            {s = ratel, t = 0},
            {s = path .. "magrelease.ogg",    t = 0.3, c = ci},
            {s = path .. "magout.ogg",        t = 0.3, c = ci},
            {s = ratel, t = 0.7},
            {s = path .. "magin.ogg",         t = 1.0, c = ci},
            {s = rottle, t = 1.1},
        },
    },
    ["reload_empty_100"] = {
        Source = "reload_empty_100",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
        Time = 66 / 30,
        MinProgress = 1.75,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.3,
        SoundTable = {
            {s = ratel, t = 0},
            {s = path .. "magrelease.ogg",      t = 0.12, c = ci},
            {s = path .. "magout.ogg",        t = 0.12, c = ci},
            {s = path .. "magin.ogg",           t = 0.5, c = ci},
            {s = common .. "magdrop.ogg",  t = 0.55},
            {s = ratel, t = 0.7},
            {s = path .. "sliderel_deact.ogg",  t = 1.33, c = ci},
            {s = path .. "chamber.ogg",        t = 1.525, c = ci},
            {s = rottle, t = 1.6},
        },
    },
}

SWEP.AutosolveSourceSeq = "idle"

SWEP.Hook_TranslateAnimation = function(wep, anim)
    if wep.Attachments[9].Installed and (anim == "fire" or anim == "fire_empty") then
        return anim .. "_stock"
    end
end

SWEP.Attachments = {
    {
        PrintName = "Optic",
        DefaultAttName = "Iron Sights",
        Slot = {"optic_lp"},
        Bone = "glock_slide",
        Offset = {
            vpos = Vector(-0.025, -0.4, -0.2),
            vang = Angle(90, 0, -90),
        },
        CorrectivePos = Vector(0, 0, 0.02),
        VMScale = Vector(.9, .9, .9),
        WMScale = VMScale,
        --WMScale = Vector(1.25, 1.25, 1.25),
        --InstalledEles = {"ud_glock_rail_optic"},
    },
    {
        PrintName = "Slide",
        DefaultAttName = "Standard Slide",
        DefaultAttIcon = Material("entities/att/acwatt_ud_glock_slide.png", "smooth mips"),
        Slot = "ud_glock_slide",
        Bone = "glock_flash",
        Offset = {
            vpos = Vector(2.4, -0.2, -29.2), -- Op. CS slide
            vang = Angle(90, 3, -90),
        },
    },
    {
        PrintName = "Frame",
        DefaultAttName = "Standard Frame",
        DefaultAttIcon = Material("entities/att/acwatt_ud_glock_frame.png", "smooth mips"),
        Slot = "ud_glock_frame",
    },
    {
        PrintName = "Caliber",
        DefaultAttName = "9x19mm Parabellum",
        DefaultAttIcon = Material("entities/att/uc_bullets/9x19.png", "smooth mips"),
        Slot = "ud_glock_caliber",
    },
    {
        PrintName = "Muzzle",
        DefaultAttName = "Standard Muzzle",
        Slot = {"muzzle", "ud_glock_muzzle"},
        Bone = "glock_flash",
        Offset = {
            vpos = Vector(0, 0, 0.0),
            vang = Angle(90, 0, -90),
        },
        ExcludeFlags = {"sd"},
        VMScale = Vector(0.8, 0.8, 0.8)
    },
    {
        PrintName = "Tactical",
        Slot = {"tac_pistol", "uce_pistol_foregrip"},
        Bone = "glock_parent",
        Offset = {
            vpos = Vector(0, -1.3, 5),
            vang = Angle(90, 0, -90),
        },
        MergeSlots = {7},
        ExcludeFlags = {"ud_glock_slide_subcompact"}
    },
    {
        Hidden = true,
        PrintName = "Tactical",
        Slot = {"tac_pistol"},
        Bone = "glock_parent",
        Offset = {
            vpos = Vector(0, -1.3, 5),
            vang = Angle(90, 0, -90),
        }, -- This slot is obsolete and exists solely for compatiblity with old loadouts. Do not remove.
    },
    {
        PrintName = "Magazine",
        Slot = {"ud_glock_mag"},
        DefaultAttIcon = Material("entities/att/acwatt_ud_glock_mag_17.png", "smooth mips"),
        DefaultAttName = "17-Round Mag",
    },
    {
        PrintName = "Stock",
        Slot = {"uc_stock", "go_stock_pistol_bt"},
        DefaultAttName = "No Stock",
        Bone = "glock_parent",
        Offset = {
            vpos = Vector(0.1, 2, -1.4),
            vang = Angle(90, 0, -90),
        },
        ExcludeFlags = {"ud_glock_frame_subcompact"}
    },
    {
        PrintName = "Ammo Type",
        DefaultAttName = "\"FMJ\" Full Metal Jacket",
        DefaultAttIcon = Material("entities/att/arccw_uc_ammo_generic.png", "mips smooth"),
        Slot = "uc_ammo",
    },
    {
        PrintName = "Powder Load",
        Slot = "uc_powder",
        DefaultAttName = "Standard Load"
    },
    {
        PrintName = "Training Package",
        Slot = "uc_tp",
        DefaultAttName = "Basic Training"
    },
    {
        PrintName = "Internals",
        Slot = "uc_fg", -- Fire group
        DefaultAttName = "Standard Internals"
    },
    {
        PrintName = "Charm",
        Slot = {"charm", "fml_charm"},
        FreeSlot = true,
        Bone = "glock_slide",
        Offset = {
            vpos = Vector(0.45, 0.1, 4),
            vang = Angle(90, 0, -90),
        },
        VMScale = Vector(0.8, 0.8, 0.8),
    },
    {
        PrintName = "Material",
        DefaultAttName = "Black Polymer",
        DefaultAttIcon = Material("entities/att/acwatt_ud_glock_material.png", "smooth mips"),
        Slot = "ud_glock_skin",
        FreeSlot = true,
    },
}
--lua/weapons/arccw_ud_m1014sport.lua:
return gluapack()()
--lua/weapons/arccw_ud_m1014sport.lua:
if !file.Exists("arccw/shared/languages/ud_en.lua","LUA") then return end

include("weapons/arccw_ud_m1014.lua")

SWEP.Category = "ArcCW - UC Presets"
if GetConVar("arccw_uc_presets_categorize"):GetBool() then
    SWEP.Category = "ArcCW - UC Presets Shotguns"
end

SWEP.PrintName = "FC1040 Sporter"
SWEP.TrueName = "Benelli M4 Sporter"
if GetConVar("arccw_truenames"):GetBool() then
    SWEP.PrintName = SWEP.TrueName
end

SWEP.Attachments[2].Installed = "ud_m1014_barrel_sport"
SWEP.Attachments[4].Installed = "ud_m1014_handguard_sport"
SWEP.Attachments[6].Installed = "ud_m1014_stock_sport"

SWEP.Hook_NameChange = function()
    return (GetConVar("arccw_truenames"):GetBool() and "Benelli M4") or "FC1040"
end

SWEP.NPCWeaponType = nil
--lua/weapons/arccw_ud_m16a1.lua:
if !file.Exists("arccw/shared/languages/ud_en.lua","LUA") then return end

include("weapons/arccw_ud_m16.lua")

SWEP.Category = "ArcCW - UC Presets"
if GetConVar("arccw_uc_presets_categorize"):GetBool() then
    SWEP.Category = "ArcCW - UC Presets Rifles"
end

SWEP.PrintName = "AMCAR-0"
SWEP.TrueName = "M16A1"
if GetConVar("arccw_truenames"):GetBool() then
    SWEP.PrintName = SWEP.TrueName
end

SWEP.Attachments[3].Installed = "ud_m16_hg_a1"
SWEP.Attachments[5].Installed = "ud_m16_receiver_a1"
SWEP.Attachments[6].Installed = "ud_m16_receiver_auto"
SWEP.Attachments[11].Installed = "ud_m16_mag_20"
--lua/weapons/arccw_ud_m16.lua:
SWEP.Base = "arccw_base"
SWEP.Spawnable = true
SWEP.Category = "ArcCW - Urban Coalition"
SWEP.UC_CategoryPack = "1Urban Decay"
SWEP.AdminOnly = false
SWEP.UseHands = true

-- Muzzle and shell effects --

SWEP.MuzzleEffect = "muzzleflash_1"
SWEP.ShellEffect = "arccw_uc_shelleffect"
SWEP.ShellModel = "models/weapons/arccw/uc_shells/556x45.mdl"
SWEP.ShellScale = .666
SWEP.ShellPitch = 100

SWEP.MuzzleEffectAttachment = 1
SWEP.CaseEffectAttachment = 2
SWEP.CamAttachment = 3
SWEP.TracerNum = 1
SWEP.TracerCol = Color(25, 255, 25)
SWEP.TracerWidth = 2

-- Fake name --

SWEP.PrintName = "RAYCAR-0"
-- AMCAR stands for (american) Colt Assault Rifle, not Carbine!! ~Fesiug
-- shut up retard ~zenith

-- True name --

SWEP.TrueName = "M16A2"

-- Trivia --
SWEP.Trivia_Class = "Assault Rifle"
SWEP.Trivia_Desc = "Third generation of America's iconic military rifle. Army tests showed that soldiers were more likely to hit a target if they fired multiple shots, but were likely to spray in full-auto and fail to hit anything. As a result, they implemented a ratcheted three-round burst system which limited the maximum burst a soldier could fire to three shots.\n\nWell-rounded gun with no major downsides."
SWEP.Trivia_Manufacturer = "Rayter Arms Industries"
SWEP.Trivia_Calibre = "5.56x45mm NATO"
SWEP.Trivia_Mechanism = "Gas-Operated Rotating Bolt"
SWEP.Trivia_Country = "USA"
SWEP.Trivia_Year = 1959


if GetConVar("arccw_truenames"):GetBool() then
    SWEP.PrintName = SWEP.TrueName
    SWEP.Trivia_Manufacturer = "Stoner's Legacy Ltd."
end

local origDesc = SWEP.Trivia_Desc
local m4Desc = "Carbine variant of the M16 rifle. Originally designed in response to design faults in the CAR-15 family, it eventually replaced the M16 across much of the Army for its favorably low weight and comparable performance. The M4 variant has since become one of the most iconic and widespread American service rifles in the modern era.\n\nLight and versatile, but requires discipline to control."
local ncrDesc = "Standard-issue rifle of the New California Republic. Traditionally produced with a semi-automatic receiver, the wooden furniture is more readily replaceable and adds additional recoil control for maximum accuracy.\n\nWell-rounded gun with no major downsides."
local smgDesc = "Submachine gun based on the M16 rifle. Despite its similar appearance, it uses a different mechanism from its parent rifle. More accurate than other submachine guns due to its rifle frame and closed-bolt mechanism."
local blkDesc = "Aftermarket automatic variant of the M16 rifle. The .300 Blackout cartridge has a ballistic performance more akin to the 7.62x39mm Soviet cartridge, with a similarly sized projectile but shorter effective range."
local ukDesc = "AR-15 style rifles are a class of rifles linked to the M16, normally with a semi-automatic fire group for the civilian market. This one, however, has been neutered by authority of the British crown with a manual-action receiver. Bit cringe, innit?"
local arDesc = "Semi-automatic variant of the M16 series of rifles, produced for the civilian market. Wildly popular in the United States, this rifle can be seen in the hands of hobbyists, hunters and mass shooters alike.\n\nWell-rounded gun with no major downsides."
local beoDesc = "Aftermarket semi-automatic variant of the M16 rifle firing an oversized magnum cartridge. Provides extremely high stopping power at close range."
local carDesc = "Carbine variant of the M16 rifle, short enough to be classified as a submachine gun. Its features influenced the US Army's interest in the M4 Carbine, which went on to become their new standard rifle. Due to the small barrel, rifles of this family have high maneuverability but poor range compared to their parent platform."
local a1Desc = "Second generation of America's iconic military rifle. Developed to address problems with the original M16, which suffered notoriously frequent jamming that could get its wielder killed. The revised model evolved a positive reputation with those who used it, and is now a universal symbol of the Vietnam War.\n\nA well-rounded rifle, but difficult to control without trigger discipline - something the A2 model eventually addressed."
local a3Desc = "Variant of the M16A2 with the original full-automatic trigger group, relegated to niche roles in the US Army. Well-rounded gun with no major downsides."
local lmgDesc = "Configuration of the M16 designed for a light machine gun role, used vaguely within the Marine Corps before the adoption of the Minimi. Heavier than the standard platform, but the integral bipod can be deployed onto surfaces for excellent recoil control."
local patriotDesc = "An assault pistol developed for The Boss. The feeder mechanism inside the drum magazine forms an \"∞\" shape.\n\nThe bottomless magazine more than makes up for the awkwardness of the configuration."

-- Weapon slot --

SWEP.Slot = 2

-- Weapon's manufacturer real name --

if GetConVar("arccw_truenames"):GetBool() then
    SWEP.PrintName = SWEP.TrueName
    SWEP.Trivia_Manufacturer = "Colt's Manufacturing Company"
end

-- Viewmodel / Worldmodel / FOV --

SWEP.ViewModel = "models/weapons/arccw/c_ud_m16.mdl"
SWEP.WorldModel = "models/weapons/arccw/c_ud_m16.mdl"
SWEP.ViewModelFOV = 80
SWEP.AnimShoot = ACT_HL2MP_GESTURE_RANGE_ATTACK_AR2

-- Damage --

SWEP.Damage = ArcCW.UC.StdDmg["556"].max
SWEP.DamageMin = ArcCW.UC.StdDmg["556"].min
SWEP.RangeMin = 50
SWEP.Range = 350 -- 4 shot until ~250m

SWEP.Penetration = ArcCW.UC.StdDmg["556"].pen
SWEP.DamageType = DMG_BULLET
SWEP.ShootEntity = nil
SWEP.MuzzleVelocity = 960
SWEP.PhysBulletMuzzleVelocity = 960

SWEP.BodyDamageMults = ArcCW.UC.BodyDamageMults

-- Mag size --

SWEP.ChamberSize = 1
SWEP.Primary.ClipSize = 30
SWEP.ExtendedClipSize = 40
SWEP.ReducedClipSize = 20

-- Recoil --

SWEP.Recoil = 0.5
SWEP.RecoilSide = 0.25

SWEP.RecoilRise = 0.1
SWEP.RecoilPunch = 1
SWEP.VisualRecoilMult = 1
SWEP.MaxRecoilBlowback = 1
SWEP.MaxRecoilPunch = 1
SWEP.RecoilPunchBack = 1

SWEP.Sway = 0.5

-- Firerate / Firemodes --

SWEP.Delay = 60 / 900
SWEP.Num = 1
SWEP.Firemodes = {
    {
        Mode = -3,
        PostBurstDelay = 0.1,
        RunawayBurst = false, -- https://en.wikipedia.org/wiki/Burst_mode_(weapons)
    },
    {
        Mode = 1,
    },
    {
        Mode = 0
    }
}

SWEP.ShootPitch = 100
SWEP.ShootVol = 120
SWEP.ShootPitchVariation = 0

SWEP.ProceduralRegularFire = false
SWEP.ProceduralIronFire = false

SWEP.ReloadInSights = true

-- NPC --

SWEP.NPCWeaponType = "weapon_ar2"
SWEP.NPCWeight = 60

-- Accuracy --

SWEP.AccuracyMOA = 4
SWEP.HipDispersion = 800
SWEP.MoveDispersion = 200
SWEP.JumpDispersion = 1000

SWEP.Primary.Ammo = "smg1"
SWEP.MagID = "m16"

SWEP.HeatCapacity = 150
SWEP.HeatDissipation = 10
SWEP.HeatDelayTime = 3

SWEP.MalfunctionMean = 200
SWEP.MalfunctionTakeRound = false

-- Speed multipliers --

SWEP.SpeedMult = 0.925
SWEP.SightedSpeedMult = 0.75
SWEP.SightTime = 0.35
SWEP.ShootSpeedMult = 0.9

-- Length --

SWEP.BarrelLength = 48
SWEP.ExtraSightDist = 2

-- Ironsights / Customization / Poses --

SWEP.HolsterPos = Vector(0.5, -1, 1.2)
SWEP.HolsterAng = Angle(-8.5, 8, -10)

SWEP.HoldtypeHolstered = "passive"
SWEP.HoldtypeActive = "ar2"
SWEP.HoldtypeSights = "rpg"

SWEP.IronSightStruct = {
     Pos = Vector(-2.815, 0, 1.3),
     Ang = Angle(0, 0, 0),
     Magnification = 1.1,
     SwitchToSound = "",
}

SWEP.ActivePos = Vector(0.33, -2, 1.33)
SWEP.ActiveAng = Angle(0, 0, -3)

-- SWEP.CustomizePos = Vector(5, -2, -2)
-- SWEP.CustomizeAng = Angle(15, 25, 0)
SWEP.CustomizePos = Vector(0, 0, 0)
SWEP.CustomizeAng = Angle(0, 0, 0)

SWEP.CrouchPos = Vector(-2.5, -2, -0.6)
SWEP.CrouchAng = Angle(0, 0, -14)

SWEP.BarrelOffsetHip = Vector(2, 0, -5)

SWEP.MirrorVMWM = true
SWEP.WorldModelOffset = {
    pos        =    Vector(-8.5, 4, -5),
    ang        =    Angle(-12, 0, 180),
    bone    =    "ValveBiped.Bip01_R_Hand",
    --scale = .85
}

-- Firing sounds --

local path = ")weapons/arccw_ud/m16/"
local common = ")/arccw_uc/common/"

SWEP.ShootSound = {
    path .. "fire-01.ogg",
    path .. "fire-02.ogg",
    path .. "fire-03.ogg",
    path .. "fire-04.ogg",
    path .. "fire-05.ogg",
    path .. "fire-06.ogg"
}
SWEP.ShootSoundSilenced = {
    path .. "fire-sup-01.ogg",
    path .. "fire-sup-02.ogg",
    path .. "fire-sup-03.ogg",
    path .. "fire-sup-04.ogg",
    path .. "fire-sup-05.ogg",
    path .. "fire-sup-06.ogg"
}

SWEP.DistantShootSound = nil
SWEP.DistantShootSoundSilenced = nil
SWEP.ShootDrySound = path .. "dryfire.ogg"

local tail = ")/arccw_uc/common/556x45/"

SWEP.DistantShootSoundOutdoors = {
    tail .. "fire-dist-556x45-rif-ext-01.ogg",
    tail .. "fire-dist-556x45-rif-ext-02.ogg",
    tail .. "fire-dist-556x45-rif-ext-03.ogg",
    tail .. "fire-dist-556x45-rif-ext-04.ogg",
    tail .. "fire-dist-556x45-rif-ext-05.ogg",
    tail .. "fire-dist-556x45-rif-ext-06.ogg"
}
SWEP.DistantShootSoundIndoors = {
    common .. "fire-dist-int-rifle-01.ogg",
    common .. "fire-dist-int-rifle-02.ogg",
    common .. "fire-dist-int-rifle-03.ogg",
    common .. "fire-dist-int-rifle-04.ogg",
    common .. "fire-dist-int-rifle-05.ogg",
    common .. "fire-dist-int-rifle-06.ogg"
}
SWEP.DistantShootSoundOutdoorsSilenced = {
    common .. "sup-tail-01.ogg",
    common .. "sup-tail-02.ogg",
    common .. "sup-tail-03.ogg",
    common .. "sup-tail-04.ogg",
    common .. "sup-tail-05.ogg",
    common .. "sup-tail-06.ogg",
    common .. "sup-tail-07.ogg",
    common .. "sup-tail-08.ogg",
    common .. "sup-tail-09.ogg",
    common .. "sup-tail-10.ogg"
}
SWEP.DistantShootSoundIndoorsSilenced = {
    common .. "fire-dist-int-pistol-light-01.ogg",
    common .. "fire-dist-int-pistol-light-02.ogg",
    common .. "fire-dist-int-pistol-light-03.ogg",
    common .. "fire-dist-int-pistol-light-04.ogg",
    common .. "fire-dist-int-pistol-light-05.ogg",
    common .. "fire-dist-int-pistol-light-06.ogg"
}
SWEP.DistantShootSoundOutdoorsVolume = 1
SWEP.DistantShootSoundIndoorsVolume = 1
SWEP.Hook_AddShootSound = ArcCW.UC.InnyOuty

-- Bodygroups --

SWEP.BulletBones = {
    [2] = "m16_bullets1",    [3] = "m16_bullets2"
}

SWEP.DefaultBodygroups = "00000000000000000000000"

SWEP.AttachmentElements = {

    ["ud_m16_mag_20"] = {
        VMBodygroups = {{ind = 2, bg = 1}},
    },
    ["ud_m16_mag_40"] = {
        VMBodygroups = {{ind = 2, bg = 2}},
    },
    ["ud_m16_pmag"] = {
        VMBodygroups = {{ind = 2, bg = 9}},
    },
    ["ud_m16_mag_60"] = {
        VMBodygroups = {{ind = 2, bg = 3}},
    },
    ["ud_m16_mag_100"] = {
        VMBodygroups = {{ind = 2, bg = 4}},
    },
    ["ud_m16_9mm_mag"] = {
        VMBodygroups = {{ind = 2, bg = 5}},
    },
    ["ud_m16_9mm_mag_32"] = {
        VMBodygroups = {{ind = 2, bg = 6}},
    },
    ["ud_m16_mag_50beo"] = {
        VMBodygroups = {{ind = 2, bg = 8}},
    },
    ["ud_m16_mag_50beo_12"] = {
        VMBodygroups = {{ind = 2, bg = 0}},
    },

    ["upper_flat"] = {
        -- handled by code
        --[[]
        VMBodygroups = {
            {ind = 1, bg = 1},
            {ind = 3, bg = 3}
        },
        ]]
    },
    ["upper_classic"] = {
        VMBodygroups = {
            {ind = 1, bg = 3},
        },
    },
    ["rail_fg"] = {
        VMBodygroups = {{ind = 9, bg = 1}}
    },

    ["stock_231_ex"] = {
        VMBodygroups = {{ind = 7, bg = 1}},
    },
    ["stock_231_in"] = {
        VMBodygroups = {{ind = 7, bg = 2}},
    },
    ["stock_231_tube"] = {
        VMBodygroups = {{ind = 7, bg = 3}},
    },
    ["stock_607_ex"] = {
        VMBodygroups = {{ind = 7, bg = 4}},
    },
    ["stock_607_in"] = {
        VMBodygroups = {{ind = 7, bg = 5}},
    },
    ["stock_608"] = {
        VMBodygroups = {{ind = 7, bg = 6}},
    },
    ["stock_carbine_ex"] = {
        VMBodygroups = {{ind = 7, bg = 7}},
    },
    ["stock_carbine_in"] = {
        VMBodygroups = {{ind = 7, bg = 8}},
    },
    ["stock_wood"] = {
        VMBodygroups = {{ind = 7, bg = 9}},
    },
    ["stock_adar"] = {
        VMBodygroups = {
            {ind = 7, bg = 10},
            {ind = 8, bg = 4}
        },
    },
    ["stock_ru556"] = {
        VMBodygroups = {{ind = 7, bg = 11}},
    },
    ["grip_ergo"] = {
        VMBodygroups = {{ind = 8, bg = 1}},
    },
    ["grip_skel"] = {
        VMBodygroups = {{ind = 8, bg = 2}},
    },
    ["grip_wood"] = {
        VMBodygroups = {{ind = 8, bg = 3}},
    },

    ["gasblock_carbine"] = {
        VMBodygroups = {{ind = 6, bg = 3}},
    },
    ["fs_adar"] = {
        VMBodygroups = {{ind = 6, bg = 4}},
    },
    ["remove_lug"] = {
        VMBodygroups = {{ind = 12, bg = 1}},
    },

    ["mount_14"] = {
        AttPosMods = {
            [8] = {
                vpos = Vector(0, 0.3, 17.5),
                vang = Angle(90, 0, -90),
            },
        },
    },
    ["mount_11"] = {
        AttPosMods = {
            [8] = {
                vpos = Vector(0.6, -0.3, 14.2),
                vang = Angle(90, 0, 0),
            },
        },
    },
    ["mount_tactical"] = {
        AttPosMods = {
            [8] = {
                vpos = Vector(-1, -.35, 11.5),
                vang = Angle(-90, 180, 0),
                wang = Angle(90, 0, 0),
            },
        },
        ExcludeFlags = {}
    },
    -- ["mount_tactical_short"] = {
    --     AttPosMods = {
    --         [8] = {
    --             vpos = Vector(-1, -.35, 11.5),
    --             vang = Angle(-90, 180, 0),
    --             wang = Angle(90, 0, 0),
    --         },
    --     },
    --     AttPosMods_Priority = 2,
    --     RequireFlags = {"barrel_short"}
    -- },

    ["barrel_14"] = {
        VMBodygroups = {
            {ind = 4, bg = 1},
            {ind = 6, bg = 2},
        },
        AttPosMods = {
            [4] = {
                vpos = Vector(0, -0.33, 18.85),
                vang = Angle(90, 0, -90),
            },
            [16] = {
                vpos = Vector(0, -1.65, 12.5), -- 21.75 or 15.75
                vang = Angle(90, 0, -90),
            },
        }
    },
    ["barrel_11"] = {
        VMBodygroups = {
            {ind = 4, bg = 4},
            {ind = 6, bg = 2},
        },
        AttPosMods = {
            [4] = {
                vpos = Vector(0, -0.33, 15.7),
                vang = Angle(90, 0, -90),
            },
            [16] = {
                vpos = Vector(0, -1.65, 12.5), -- 21.75 or 15.75
                vang = Angle(90, 0, -90),
            },
        }
    },
    ["barrel_fpw"] = {
        VMBodygroups = {
            {ind = 4, bg = 2},
            {ind = 6, bg = 5},
        },
        AttPosMods = {
            [4] = {
                vpos = Vector(0, -0.07, 21.3),
                vang = Angle(90, 0, -90),
            },
        }
    },
    ["barrel_11_ru556"] = {
        VMBodygroups = {
            {ind = 4, bg = 4},
            {ind = 6, bg = 5},
        },
        AttPosMods = {
            [3] = {
                vpos = Vector(0, -0.07, 21.3),
                vang = Angle(90, 0, -90),
            },
            [6] = {
                vpos = Vector(1.15, 0, 17.9),
                vang = Angle(90, 0, 0),
            },
            [16] = {
                vpos = Vector(0, -1.65, 12.5), -- 21.75 or 15.75
                vang = Angle(90, 0, -90),
            },
        }
    },

    ["hg_m16a4_ris"] = {
        VMBodygroups = {
            {ind = 5, bg = 2},
        },
        AttPosMods = {
            [5] = {
                vpos = Vector(-0.1, 1.05, 12),
                vang = Angle(90, 0, -90),
            },
            [6] = {
                vpos = Vector(1.41, -.1, 20),
                vang = Angle(90, 0, 0),
            },
            [16] = {
                vpos = Vector(0, -1.75, 21.75), -- 21.75 or 15.75
                vang = Angle(90, 0, -90),
            },
        }
    },
    ["hg_m4a1_ris"] = {
        VMBodygroups = {
            {ind = 5, bg = 5},
        },
        AttPosMods = {
            [5] = {
                vpos = Vector(0, 1.4, 12),
                vang = Angle(90, 0, -90),
            },
            [6] = {
                vpos = Vector(-1.41, -.2, 14),
                vang = Angle(90, 0, 180),
            },
            [15] = {
                vpos = Vector(0, -1.75, 15.75), -- 21.75 or 15.75
                vang = Angle(90, 0, -90),
            },
        },
    },
    ["hg_ru556"] = {
        -- VMBodygroups = {
        --     {ind = 5, bg = 7},
        -- },
        AttPosMods = {
            -- [5] = {
            --     vpos = Vector(-0.1, 1.05, 12),
            --     vang = Angle(90, 0, -90),
            -- },
            -- [6] = {
            --     vpos = Vector(1.1, 0, 14),
            --     vang = Angle(90, 0, 0),
            -- },
            [16] = {
                vpos = Vector(0, -1.65, 12.5), -- 21.75 or 15.75
                vang = Angle(90, 0, -90),
            },
        },
    },
    ["hg_m4a1"] = {
        VMBodygroups = {
            {ind = 5, bg = 4},
        }
    },
    ["hg_cqbr"] = {
        VMBodygroups = {
            {ind = 5, bg = 4},
        },
    },
    ["hg_adar"] = {
        VMBodygroups = {
            {ind = 5, bg = 8},
        },
    },
    ["hg_fpw"] = {
        VMBodygroups = {
            {ind = 5, bg = 6},
            --{ind = 6, bg = 4},
        }
    },
    ["hg_m16a1"] = {
        VMBodygroups = {
            {ind = 5, bg = 1},
        }
    },
    ["hg_m16a1_wood"] = {
        VMBodygroups = {
            {ind = 5, bg = 1},
        },
        VMSkin = 1
    },
    ["ud_m16_hg_heat"] = {
        VMElements = {
            {
                Model = "models/weapons/arccw/atts/m203iron.mdl",
                Bone = "m16_parent",
                Scale = Vector(1, 1, 1),
                Offset = {
                    pos = Vector(0, -1.2, 14.9),
                    ang = Angle(90, 0, -90),
                }
            }
        },
        UC_UseClassicM203Mount = true,
    },
    ["hg_m605"] = {
        VMBodygroups = {
            {ind = 5, bg = 1},
            {ind = 4, bg = 1},
        },
        AttPosMods = {
            [3] = {
                vpos = Vector(0, -0.05, 25.58),
                vang = Angle(90, 0, -90),
            },
            [6] = { -- also has no rail
                vpos = Vector(0, 0.9, 22.2),
                vang = Angle(90, 0, -90),
            },
        }
    },
    ["hg_m605_wood"] = {
        VMBodygroups = {
            {ind = 5, bg = 1},
            {ind = 4, bg = 1},
        },
        AttPosMods = {
            [3] = {
                vpos = Vector(0, 0, 25),
                vang = Angle(90, 0, -90),
            },
            [6] = { -- also has no rail
                vpos = Vector(0, 0.8, 22),
                vang = Angle(90, 0, -90),
            },
        },
        VMSkin = 1
    },
    ["hg_lmg"] = {
        VMBodygroups = {
            {ind = 5, bg = 3},
        }
    },
    ["hg_sd"] = {
        VMBodygroups = {
            {ind = 5, bg = 9},
            {ind = 4, bg = 3},
            {ind = 6, bg = 5}
        },
        AttPosMods = { -- no rail, just pretend it's mounted to something
            -- [8] = {
            --     vpos = Vector(0, 0.7, 17.5),
            --     vang = Angle(90, 0, -90),
            -- },
            [16] = {
                vpos = Vector(0, -1.65, 11.5), -- 21.75 or 15.75
                vang = Angle(90, 0, -90),
            },
        }
    },

    ["ud_m16_upper_charm"] = {
        AttPosMods = {
            [1] = {
                vpos = Vector(0, -4, 3),
                vang = Angle(90, 0, -90),
                SlideAmount = {
                    vmin = Vector(0, -3.4, 3 - 1.5),
                    vmax = Vector(0, -3.4, 3 + 1.5),
                }
            },
        },
    },
    ["ud_m16_upper_charm2"] = {
        AttPosMods = {
            [1] = {
                vpos = Vector(0, -4.1, 3.5),
                vang = Angle(90, 0, -90),
                SlideAmount = {
                    vmin = Vector(0, -3.5, 3.5 - 2),
                    vmax = Vector(0, -3.5, 3.5 + 1),
                }
            },
        },
    },
    ["bravo_dicks_going_fart"] = {
        AttPosMods = {
            [8] = {
                vpos = Vector(0.25, -1.4, 12),
                vang = Angle(90, 0, 90),
            },
        },
    },

    ---- Cut content
    ["hg_stub"] = {
        VMBodygroups = {
            {ind = 5, bg = 7},
        },
        AttPosMods = {
            [3] = {
                vpos = Vector(0, -0.35, 7),
                vang = Angle(90, 0, -90)
            },
            [6] = {
                vpos = Vector(1.1, -0.4, 9),
                vang = Angle(90, 0, 0),
            },
        }
    },
    ["barrel_stub"] = {
        VMBodygroups = {
            {ind = 4, bg = 4},
            {ind = 6, bg = 4},
        }
    },
    ["hg_smg"] = {
        VMBodygroups = {
            {ind = 5, bg = 0},
        }
    },
    ["m16_strap"] = {
        VMBodygroups = {
             {ind = 13, bg = 1},
        },
    },
}

-- Animations --

SWEP.Hook_Think = ArcCW.UC.ADSReload

local sr_pmag = {
	[path .. "magout_empty.ogg"] = path .. "pmagout.ogg",
	[path .. "magin.ogg"] = path .. "pmagin.ogg",
}

local pmag1, pmag2 = {}, {"ud_m16_pmag"}
SWEP.Hook_TranslateSound = function(wep, data)
	if wep:CheckFlags(pmag1, pmag2) and sr_pmag[data] then return sr_pmag[data] end
end

local rottle = {common .. "cloth_1.ogg", common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}
local ratel = {common .. "rattle1.ogg", common .. "rattle2.ogg", common .. "rattle3.ogg"}

SWEP.Animations = {
    ["ready"] = {
        Source = "fix",
        Time = 45 / 30,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = common .. "raise.ogg", t = 0},
            {s = common .. "rattle.ogg", t = 0.2},
            {s = path .. "chback.ogg",   t = 0.15},
            {s = common .. "cloth_4.ogg",  t = 0.5},
            {s = path .. "chamber.ogg",  t = 0.5},
        },
        ProcDraw = true,
    },
    ["idle"] = {
        Source = "idle",
    },
    ["idle_empty"] = {
        Source = "idle_empty",
    },
    ["draw"] = {
        Source = "draw",
        SoundTable = {
            {s = common .. "raise.ogg", t = 0},
            {s = common .. "shoulder.ogg", t = 0.15},
            {s = ratel, t = 0.2},
        },
    },
    ["draw_empty"] = {
        Source = "draw_empty",
        Time = 20 / 30,
        SoundTable = {
            {s = common .. "raise.ogg", t = 0},
            {s = common .. "shoulder.ogg", t = 0.15},
            {s = ratel, t = 0.2},
        },
    },
    ["holster"] = {
        Source = "holster",
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = ratel, t = 0},
            {s = common .. "cloth_6.ogg", t = 0.2},
        },
    },
    ["holster_empty"] = {
        Source = "holster_empty",
        Time = 20 / 30,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = ratel, t = 0},
            {s = common .. "cloth_6.ogg", t = 0.2},
        },
    },
    ["trigger"] = {
        Source = "idle",
        MinProgress = .1,
        SoundTable = {
            {s = ")weapons/arccw_ud/uzi/prefire.ogg",         t = 0, c = ci},
        },
    },
    ["fire"] = {
        Source = "fire",
        Time = 13 / 30,
        ShellEjectAt = 0.01,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0, v = 0.25 }},
    },
    ["fire_iron"] = {
        Source = "fire",
        Time = 13 / 30,
        ShellEjectAt = 0.01,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0 }},
    },
    ["fire_empty"] = {
        Source = "fire_empty",
        Time = 13 / 30,
        ShellEjectAt = 0.01,
        SoundTable = {
            {s = path .. "mech_last.ogg", t = 0}, -- Temporary
        },
    },
    ["fire_iron_empty"] = {
        Source = "fire_empty",
        Time = 13 / 30,
        ShellEjectAt = 0.01,
        SoundTable = {
            {s = path .. "mech_last.ogg", t = 0}, -- Temporary
        },
    },

    ["fire_cycle"] = {
        Source = "fire",
        Time = 13 / 30,
    },

    ["cycle"] = {
        Source = "fix",
        Time = 36 / 30 * 0.7,
        ShellEjectAt = 0.3,
        LHIK = true,
        LHIKIn = 0.3 * 0.7,
        LHIKEaseIn = 0.4 * 0.7,
        LHIKEaseOut = 0.15 * 0.7,
        LHIKOut = 0.4 * 0.7,
        SoundTable = {
            {s = path .. "chback.ogg",   t = 0.05},
            {s = common .. "cloth_4.ogg",  t = 0.2},
            {s = path .. "chamber.ogg",  t = 0.3},
        },
    },

    ["fix"] = {
        Source = "fix",
        Time = 45 / 30,
        ShellEjectAt = false,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = path .. "chback.ogg",   t = 0.15},
            {s = common .. "cloth_4.ogg",  t = 0.5},
            {s = path .. "chamber.ogg",  t = 0.5},
        },
    },
    ["fix_empty"] = {
        Source = "fix_empty",
        Time = 45 / 30,
        ShellEjectAt = false,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = path .. "chback.ogg",   t = 0.15},
            {s = common .. "cloth_4.ogg",  t = 0.5},
            {s = path .. "ch_forward_empty.ogg",  t = 0.5},
        },
    },

    -- 30 Round Reloads --

    ["reload"] = {
        Source = "reload",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 71 / 30,
        MinProgress = 1.5,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.7,
        SoundTable = {
            {s = rottle,  t = 0.0},
            {s = common .. "magpouch_gear.ogg", t = 0.2, v = 0.5},
            {s = ratel, t = 0.25},
            {s = path .. "magout_empty.ogg", 	 t = 0.23},
            {s = ratel, t = 0.5},
            {s = path .. "struggle.ogg",    t = 1, v = 0.4},
            {s = path .. "magin.ogg",    t = 0.97},
            {s = ratel, t = 1.1},
            {s = rottle,  t = 1.15},
            {s = common .. "grab-polymer.ogg", t = 1.77, v = 0.25},
            {s = common .. "rattle_b2i_rifle.ogg", t = 1.7},
            {s = common .. "shoulder.ogg", t = 1.8},
        },
    },
    ["reload_empty"] = {
        Source = "reload_empty",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 87 / 30,
        MinProgress = 2,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.9,
        SoundTable = {
            {s = rottle,  t = 0.0},
            {s = ratel, t = 0.25},
            {s = common .. "magpouch_gear.ogg", t = 0.1, v = 0.5},
            {s = path .. "magout_empty.ogg", 	 t = 0.2},
            {s = ratel, t = 0.5},
            {s = common .. "rifle_magdrop.ogg",  t = 0.65},
            {s = path .. "struggle.ogg",    t = 0.95, v = 0.4},
            {s = path .. "magin.ogg",    t = 0.95},
            {s = ratel, t = 1.1},
            {s = rottle,  t = 1.39},
            {s = path .. "boltdrop.ogg", t = 1.7},
            {s = ratel, t = 1.9},
            {s = common .. "rattle_b2i_rifle.ogg", t = 2.0},
            {s = common .. "grab-polymer.ogg", t = 2.1, v = 0.35},
            {s = common .. "shoulder.ogg", t = 2.1},
        },
    },

    -- 20 Round Reloads --

    ["reload_20"] = {
        Source = "reload_20",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 71 / 30,
        MinProgress = 1.5,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.7,
        SoundTable = {
            {s = rottle,  t = 0.0},
            {s = ratel, t = 0.05},
            {s = path .. "magout_empty.ogg", 	 t = 0.09},
            {s = common .. "magpouch_gear.ogg", t = 0.1},
            {s = rottle,  t = 0.75},
            {s = ratel, t = 0.85},
            {s = path .. "struggle.ogg",    t = 0.9, v = 0.4},
            {s = path .. "magin.ogg",    t = 0.95},
            {s = rottle,  t = 1.1},
            {s = ratel, t = 1.125},
            {s = common .. "rattle_b2i_rifle.ogg", t = 1.65},
            {s = common .. "grab-polymer.ogg", t = 1.7, v = 0.25},
            {s = common .. "shoulder.ogg", t = 1.75},
        },
    },
    ["reload_empty_20"] = {
        Source = "reload_empty_20",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 86 / 30,
        MinProgress = 2,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.3,
        LHIKOut = 0.8,
        SoundTable = {
            {s = common .. "magpouch_gear.ogg", t = 0},
            {s = rottle, t = 0.01},
            {s = ratel, t = 0.05},
            {s = path .. "magout_empty.ogg", 	 t = 0.075},
            {s = rottle, t = 0.75},
            {s = ratel, t = 0.9},
            {s = common .. "rifle_magdrop.ogg",  t = 0.65},
            {s = path .. "struggle.ogg",    t = 0.8, v = 0.4},
            {s = path .. "magin.ogg",    t = 0.85},
            {s = rottle, t = 1.4},
            {s = ratel, t = 1.4},
            {s = path .. "chamber_press.ogg", t = 1.72},
            {s = common .. "rattle_b2i_rifle.ogg", t = 1.95},
            {s = common .. "grab-polymer.ogg", t = 2.075, v = 0.25},
            {s = common .. "shoulder.ogg", t = 2.13},
        },
    },

    -- 40 Round Reloads --

    ["reload_40"] = {
        Source = "reload_40",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 71 / 30,
        MinProgress = 1.5,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.7,
        SoundTable = {
            {s = rottle, t = 0.0},
            {s = ratel, t = 0.1},
            {s = path .. "magout_empty.ogg", 	 t = 0.2},
            {s = common .. "magpouch_gear.ogg", t = 0.25},
            {s = rottle, t = 0.75},
            {s = ratel, t = 0.8},
            {s = path .. "struggle.ogg",    t = 0.95, v = 0.4},
            {s = path .. "magin.ogg",    t = 1.0},
            {s = rottle, t = 1.1},
            {s = ratel, t = 1.25},
            {s = common .. "rattle_b2i_rifle.ogg", t = 1.65},
            {s = common .. "shoulder.ogg", t = 1.75},
        },
    },
    ["reload_empty_40"] = {
        Source = "reload_empty_40",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 85 / 30,
        MinProgress = 2,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.8,
        SoundTable = {
            {s = rottle,  t = 0.0},
            {s = path .. "magout_empty.ogg", 	 t = 0.2},
            {s = common .. "magpouch_gear.ogg", t = 0.25},
            {s = rottle,  t = 0.75},
            {s = common .. "rifle_magdrop.ogg",  t = 0.8},
            {s = path .. "struggle.ogg",    t = 1.0, v = 0.4},
            {s = path .. "magin.ogg",    t = 1.05},
            {s = rottle,  t = 1.475},
            {s = ratel,  t = 1.475},
            {s = path .. "boltdrop.ogg", t = 1.78},
            {s = common .. "rattle_b2i_rifle.ogg", t = 2.1},
            {s = common .. "shoulder.ogg", t = 2.2},
        },
    },

    -- 60 Round Reloads --

    ["reload_60"] = {
        Source = "reload_60",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 71 / 30,
        MinProgress = 1.5,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.7,
        SoundTable = {
            {s = rottle, t = 0.0},
            {s = common .. "magpouch_gear.ogg", t = 0.2},
            {s = path .. "magout_empty.ogg", 	 t = 0.25},
            {s = rottle, t = 0.75},
            {s = path .. "struggle.ogg",    t = 1.0, v = 0.4},
            {s = path .. "magin.ogg",    t = 1.1},
            {s = rottle, t = 1.1},
            {s = common .. "grab-polymer.ogg", t = 1.78, v = 0.25},
            {s = common .. "rattle_b2i_rifle.ogg", t = 1.8},
            {s = common .. "shoulder.ogg", t = 1.9},
        },
    },
    ["reload_empty_60"] = {
        Source = "reload_empty_60",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 85 / 30,
        MinProgress = 2,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.8,
        SoundTable = {
            {s = rottle, t = 0.0},
            {s = common .. "magpouch_gear.ogg", t = 0.2},
            {s = path .. "magout_empty.ogg", 	 t = 0.25},
            {s = rottle, t = 0.75},
            {s = common .. "rifle_magdrop.ogg",  t = 0.8},
            {s = path .. "struggle.ogg",    t = 1.0, v = 0.4},
            {s = path .. "magin.ogg",    t = 1.1},
            {s = rottle, t = 1.475},
            {s = ratel, t = 1.475},
            {s = path .. "boltdrop.ogg", t = 1.8},
            {s = common .. "rattle_b2i_rifle.ogg", t = 2.1},
            {s = common .. "grab-polymer.ogg", t = 2.15, v = 0.25},
            {s = common .. "shoulder.ogg", t = 2.2},
        },
    },

    -- 100 Round Reloads --

    ["reload_100"] = {
        Source = "reload_100",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 71 / 30,
        MinProgress = 1.75,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.3,
        LHIKOut = 0.5,
        SoundTable = {
            {s = rottle, t = 0.0},
            {s = path .. "magout_empty.ogg", 	 t = 0.2},
            {s = rottle, t = 0.75},
            {s = path .. "struggle.ogg",    t = 0.95, v = 0.4},
            {s = path .. "magin.ogg",    t = 1.05},
            {s = rottle, t = 1.1},
            {s = path .. "magtap.ogg",   t = 1.59},
            {s = common .. "cloth_4.ogg",  t = 1.65},
            {s = common .. "rattle_b2i_rifle.ogg", t = 1.8},
            {s = common .. "grab-polymer.ogg", t = 1.85, v = 0.25},
            {s = common .. "shoulder.ogg", t = 2.0},
        },
    },
    ["reload_empty_100"] = {
        Source = "reload_empty_100",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 90 / 30,
        MinProgress = 2.5,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.3,
        LHIKOut = 0.6,
        SoundTable = {
            {s = rottle, t = 0.0},
            {s = path .. "magout_empty.ogg", 	 t = 0.2},
            {s = rottle, t = 0.75},
            {s = common .. "magdrop.ogg",  t = 0.65},
            {s = path .. "struggle.ogg",    t = 0.95, v = 0.4},
            {s = path .. "magin.ogg",    t = 1.05},
            {s = path .. "magtap.ogg",   t = 1.59},
            {s = rottle, t = 1.75},
            {s = path .. "chback.ogg",   t = 2.0},
            {s = common .. "cloth_4.ogg",  t = 2.05},
            {s = path .. "chamber.ogg",  t = 2.22},
            {s = common .. "rattle_b2i_rifle.ogg", t = 2.5},
            {s = common .. "grab-polymer.ogg", t = 2.55, v = 0.25},
            {s = common .. "shoulder.ogg", t = 2.6},
        },
    },

    -- 9mm 32 Round Reloads --

    ["reload_9mm"] = {
        Source = "reload_9mm",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 70 / 30,
        MinProgress = 1.5,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.5,
        SoundTable = {
            {s = rottle, t = 0.0},
            {s = common .. "magpouch.ogg", t = 0.15},
            {s = "weapons/arccw_ud/uzi/" .. "magout.ogg", 	 t = 16 / 30},
            {s = rottle, t = 0.75},
            {s = "weapons/arccw_ud/uzi/" .. "magin.ogg",    t = 27 / 30},
            {s = rottle, t = 1.1},
            {s = common .. "magpouchin.ogg", t = 1.55},
            {s = common .. "shoulder.ogg", t = 1.93},
        },
    },
    ["reload_empty_9mm"] = {
        Source = "reload_empty_9mm",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 80 / 30,
        MinProgress = 2,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.1,
        LHIKEaseIn = 0.1,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.9,
        SoundTable = {
            {s = rottle, t = 0.0},
            {s = "weapons/arccw_ud/uzi/" .. "magout.ogg", 	 t = 0.1},
            {s = common .. "magpouch.ogg", t = 0.45},
            {s = rottle, t = 0.75},
            {s = "weapons/arccw_ud/uzi/" .. "magin.ogg",    t = 0.8},
            {s = path .. "chamber_press.ogg", t = 1.7},
            {s = rottle, t = 1.39},
            {s = common .. "shoulder.ogg", t = 2.15},
        },
    },


    ["enter_inspect"] = {
        Source = "inspect_enter",
        -- time = 35 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 2.5,
        SoundTable = {
            {s = rottle, t = 0},
            {s = common .. "movement-rifle-02.ogg", t = 0.1},
        },
    },
    ["idle_inspect"] = {
        Source = "inspect_loop",
        -- time = 72 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 999, -- maybe im dumb
    },
    ["exit_inspect"] = {
        Source = "inspect_exit",
        -- time = 66 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 999, -- maybe im dumb
        SoundTable = {
            {s = common .. "movement-rifle-04.ogg", t = 0.2},
            {s = rottle, t = 0.25},
            {s = rottle, t = 1.2},
            {s = common .. "movement-rifle-03.ogg", t = 1.25},
        },
    },
    ["enter_inspect_empty"] = {
        Source = "inspect_enter_empty",
        -- time = 35 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 2.5,
        SoundTable = {
            {s = rottle, t = 0},
            {s = common .. "movement-rifle-02.ogg", t = 0.1},
        },
    },
    ["idle_inspect_empty"] = {
        Source = "inspect_loop_empty",
        -- time = 72 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 999,
    },
    ["exit_inspect_empty"] = {
        Source = "inspect_exit_empty",
        -- time = 66 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 999,
        SoundTable = {
            {s = common .. "movement-rifle-04.ogg", t = 0.2},
            {s = rottle, t = 0.25},
            {s = rottle, t = 1.2},
            {s = common .. "movement-rifle-03.ogg", t = 1.25},
        },
    },
}

local hgLookup = {
    ["default"]     = {0,4,0},
    ["tactical"]    = {2,5,0},
    ["a1"]          = {1,1,1},
    ["heat"]          = {10,10,1},
    ["heatm203"]          = {11,11,1},
    ["wood"]          = {1,1,1},
    ["lmg"]          = {3,3,1},
    ["fpw"]          = {6,6,2},
    ["ru556"]          = {7,7,3},
    ["adar"]          = {8,8,2},
    ["hk416"]          = {9,9,3},
    ["607"]          = {9,9,0},
}
-- Structure: 20in appearance, 14/11in appearance, gas block mode
-- Gas block modes: 0 standard, 1 always at 20" position, 2 at ADAR position when short, 3 at ADAR position when short and not flat

local barrLookup = {
    ["sd"] = -1,
    ["20in"] = 0,
    ["14in"] = 1,
    ["fpw"] = 1,
    ["10in"] = 2,
}

SWEP.Hook_ModifyBodygroups = function(wep, data)
    local vm = data.vm
    local atts = wep.Attachments
    if !IsValid(vm) then return end

    local barrel = string.Replace(atts[2].Installed or "20in","ud_m16_barrel_","")
    local barr = barrLookup[barrel]
    local hg = string.Replace(atts[3].Installed or "default","ud_m16_hg_","")
    hg = string.Replace(hg,"uf_m16_hg_","")

    local optic = atts[1].Installed
    local muzz = atts[4].Installed or barrel == "sd"
    local laser = atts[8].Installed
    local fs = atts[16].Installed
    local retro = wep:GetBuff_Override("TopMount")

    -- Retro rail
    if optic then
        if retro then
            -- Raised rail (retro)
            vm:SetBodygroup(3, retro)
        else
            -- Flat rail
            vm:SetBodygroup(1, 1)
            vm:SetBodygroup(3, 2)
        end
    end

    -- Dynamic handguard
    if barr == -1 then
        vm:SetBodygroup(5,9)
    elseif barr == 0 and hgLookup[hg] then
        vm:SetBodygroup(5,hgLookup[hg][1])
    elseif hgLookup[hg] then
        vm:SetBodygroup(5,hgLookup[hg][2])
    else
        vm:SetBodygroup(5,9)
    end

    -- Gas block
    if barrel == "sd" or (atts[6].Installed == "ud_m16_receiver_fpw" and barr > 0) then
        vm:SetBodygroup(6,5)
    else
        local gbPos = hgLookup[hg] and hgLookup[hg][3] or 0
        local lwr = atts[6].Installed
        local flat = (
            wep:GetBuff_Override("FrontSight")
            or atts[6].Installed == "ud_m16_receiver_fpw"
            or (optic and fs ~= "ud_m16_charm_fs" and !(wep:GetBuff_Override("IronSight") or wep:GetBuff_Override("TopMount")))
        ) and 1 or 0

        if gbPos == 1 or barr == 0 then
            vm:SetBodygroup(6, 0 + flat)
        elseif gbPos == 2 then
            vm:SetBodygroup(6, 4 + flat * 2)
        elseif gbPos == 3 then
            vm:SetBodygroup(6, 4 - flat)
        else
            vm:SetBodygroup(6, 2 + flat)
        end
    end

    -- Default flash hider
    if !muzz then
        if barr == 0 then
            vm:SetBodygroup(11,1)
        elseif barr == 1 then
            vm:SetBodygroup(11,2)
        else
            vm:SetBodygroup(11,3)
        end
    else
        vm:SetBodygroup(11,0)
    end

    -- Tactical clamp
    if laser and hg ~= "tactical" then
        if barr == 0 then
            vm:SetBodygroup(10,1)
        elseif barr == 1 then
            vm:SetBodygroup(10,3)
        else
            vm:SetBodygroup(10,2)
        end
    else
        vm:SetBodygroup(10,0)
    end

    -- Disable tac rail element with tac hg
    if hg == "tactical" and (atts[7].Installed or atts[18].Installed) then
        vm:SetBodygroup(9,0)
    end

    -- .50 Beowulf magazines
    if atts[5].Installed == "ud_m16_receiver_50beo" and !atts[11].Installed then
        vm:SetBodygroup(2, 8)
    end
end

-- RAYCAR-0, rifle barrel
local bar0_fake = "First variation of the RAYCAR rifle. Tests showed that users were more likely to hit a target if they fired multiple shots, but were likely to spray in full-auto and fail to hit anything. As a result, a ratcheted three-round burst system was implemented which limited the maximum burst a user could fire to three shots.\n\nWell-rounded gun with no major downsides."

-- RAYCAR-1, carbine barrel
local bar1_fake = "Second variation of the RAYCAR rifle. It eventually replaced the RAYCAR-0 across much of the Army for its favorably low weight and comparable performance. The -1 variant has since become one of the most iconic and widespread American service rifles in the modern era.\n\nLight and versatile, but requires discipline to control."

-- RAYCAR-2, commando barrel
local bar2_fake = "Third variation of the RAYCAR rifle. Developed with assistance from the Navy, the \"commando\" barrel allows for the weapon to be very compact, even short enough to be classified as a submachine gun, enhancing usability in vehicles and in enclosed spaces.\n\nVery lightweight and manuverable, but with very aggressive recoil to match."

-- RAYPAW :3
local smgDesc_fake = "Submachine gun based on the RAYCAR rifle. Despite its similar appearance, it uses a different mechanism from its parent rifle.\n\nMore accurate than other submachine guns due to its rifle frame and closed-bolt mechanism."

-- RBY50
local beoDesc_fake = "Aftermarket semi-automatic variant of the RAYCAR rifle firing an oversized magnum cartridge.\n\nProvides extremely high stopping power at close range."

-- RBY300
local blkDesc_fake = "Aftermarket automatic variant of the RAYCAR rifle. The .300 Blackout cartridge has a ballistic performance more akin to the 7.62x39mm Soviet cartridge, with a similarly sized projectile but shorter effective range.\n\nSlightly more inaccurate, made up with a higher stopping power and a subsonic projectile."

-- UKCAR
local ukDesc_fake = "Normally, RAYCAR style rifles are imported with a semi-automatic fire group for the civilian market. This one, however, has been neutered by authority of the British crown with a manual-action receiver.\n\nBit cringe, innit?"

-- RAYSAW
local lmgDesc_fake = "Configuration of the RAYCAR designed for a light machine gun role, used vaguely within the Marine Corps before the adoption of the Minimi.\n\nHeavier than the standard platform, but the integral bipod can be deployed onto surfaces for excellent recoil control."

-- Fallout barrel or sumn idk
local ncrDesc_fake = "Standard-issue rifle of the New California Republic. Traditionally produced with a semi-automatic receiver, the wooden furniture is more readily replaceable and adds additional recoil control for maximum accuracy.\n\nWell-rounded gun with no major downsides."

-- Patriot easter egg. Is it overpowered? I don't think so, a configuration like this is already pretty uncontrollable and imprecise as is, and overheating is the new magazine.
local a1, a2 = {}, {"patr1", "patr2", "patr3", "patr4", "patr5"}
SWEP.O_Hook_Override_BottomlessClip = function(wep, data)
    if wep:CheckFlags(a1, a2) then
        data.current = true
    end
end


SWEP.Hook_NameChange = function(wep, name)
    local trueNames = GetConVar("arccw_truenames"):GetBool()
    local atts = wep.Attachments
    local flat = atts[1].Installed and !wep:GetBuff_Override("TopMount")

    local barrel = string.Replace(atts[2].Installed or "20in","ud_m16_barrel_","")
    local barr = barrLookup[barrel]
    local hg = string.Replace(atts[3].Installed or "default","ud_m16_hg_","")
    local upr = string.Replace(atts[5].Installed or "default","ud_m16_receiver_","")
    local lwr = string.Replace(atts[6].Installed or "default","ud_m16_receiver_","")

    if wep:CheckFlags(a1, a2) then -- Patriot configuration
        wep.Trivia_Desc = patriotDesc
        return "The Patriot"
    elseif !trueNames then -- Custom lore-based fake names
        local pre = (lwr == "auto" and "AM" or "RAY")
        if upr == "9mm" then
            local sd = (barr == -1)
            wep.Trivia_Desc = smgDesc_fake
            if flat then
                return (sd and pre .. "SSMG-NG") or pre .. "PAW-" .. barr .. "NG"
            end
            return (sd and pre .. "SSMG") or pre .. "PAW-" .. barr
        elseif upr == "50beo" then
            wep.Trivia_Desc = beoDesc_fake
            return "RBY"--50"
        elseif upr == "300blk" then
            wep.Trivia_Desc = blkDesc_fake
            return "RBY"--300"
        elseif lwr == "fpw" then
            wep.Trivia_Desc = bar1_fake
            return pre .. "FPW"
        elseif lwr == "cali" then
            wep.Trivia_Desc = ukDesc_fake
            return "UKCAR"
        else
            if barr == 0 then
                if hg == "lmg" then
                    wep.Trivia_Desc = lmgDesc_fake
                    return pre .. "SAW" .. (flat and "-NG" or "")
                elseif flat then
                    return pre .. "CAR-0NG"
                else
                    wep.Trivia_Desc = bar0_fake
                    return pre .. "CAR-0"
                end
            elseif barr == 1 then
                wep.Trivia_Desc = bar1_fake
                if flat then
                    return pre .. "CAR-1NG"
                end
                return pre .. "CAR-1"
            elseif barr == 2 then
                wep.Trivia_Desc = bar2_fake
                if flat then
                    return pre .. "CAR-2NG"
                end
                return pre .. "CAR-2"
            end
        end

        wep.Trivia_Desc = bar0_fake
        return pre .. "CAR-0"

    else

        if upr == "9mm" then
            local sd = (barr == -1)
            wep.Trivia_Desc = smgDesc
            if lwr == "semi" then
                return "AR-15 9mm"
            elseif flat then
                return "R0991"
            end
            return "R0635"

        end

        if lwr == "auto" then
            if upr == "a1" then
                wep.Trivia_Desc = a1Desc
                if barr == 0 then
                    return "M16A1"
                elseif barr == 1 then
                    return "M605"
                end
                wep.Trivia_Desc = carDesc
                return "CAR-15"
            end
            if barr == 0 then
                wep.Trivia_Desc = a3Desc
                if hg == "lmg" then
                    wep.Trivia_Desc = lmgDesc
                    return "Colt LMG"
                elseif flat and hg == "tactical" then
                    return "R0901"
                end
                return "M16A3"
            elseif barr == 1 then
                wep.Trivia_Desc = m4Desc
                if flat then
                    return "M4A1"
                end
                return "XM4"
            else
                wep.Trivia_Desc = carDesc
                if flat then
                    wep.Trivia_Desc = m4Desc
                    if upr == "300blk" then
                        return "Mk 18"
                    end
                    return "Mk 18 Mod 0"
                end
                return "CAR-15"
            end
        elseif lwr == "semi" or upr == "50beo" then
            wep.Trivia_Desc = arDesc
            if hg == "wood" then
                wep.Trivia_Desc = ncrDesc
                if barr == 0 then
                    return "Service Rifle"
                end
                return "Service Carbine"
            elseif flat and hg == "adar" then
                return "ADAR 2-15"
            elseif barr > 0 then
                if barr == 2 and atts[10].Installed == "ud_m16_stock_buffer" then
                    return "AR-15 Pistol"
                elseif upr == "a1" and barr == 1 then
                    return "CRXM177E2B"
                else
                    return "AR-15 SBR"
                end
            elseif upr == "a1" then
                return "CRM16A1"
            end
            return "AR-15"
        elseif lwr == "fpw" then
            wep.Trivia_Desc = m4Desc
            return "M231 FPW"
        elseif lwr == "cali" then
            wep.Trivia_Desc = ukDesc
            return "AR-15GB"
        else
            wep.Trivia_Desc = origDesc
            if barr == 0 and flat then
                return "M16A4"
            elseif barr == 1 then
                wep.Trivia_Desc = m4Desc
                return "M4 Carbine"
            elseif barr == 2 then
                return "M16 Commando"
            end
        end

        wep.Trivia_Desc = origDesc
        return "M16A2"

    end
end



SWEP.Attachments = {
    {
        PrintName = "Optic",
        DefaultAttName = "Iron Sights",
        InstalledEles = {"upper_flat"},
        Slot = {"optic","optic_sniper","ud_m16_rs"},
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(0, -1.75, 3),
            vang = Angle(90, 0, -90),
        },
        SlideAmount = {
            vmin = Vector(0, -1.6, 3 - 2),
            vmax = Vector(0, -1.6, 3 + 1),
        },
    },
    {
        PrintName = "Barrel",
        DefaultAttName = "20\" Standard Barrel",
        DefaultAttIcon = Material("entities/att/acwatt_ud_m16_barrel_20.png", "smooth mips"),
        Slot = "ud_m16_blen",
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(2.8, -4.2, -11.5),
            vang = Angle(90, 0, -90),
        },
    },
    {
        PrintName = "Handguard",
        DefaultAttName = "Ribbed Handguard",
        DefaultAttIcon = Material("entities/att/acwatt_ud_m16_hg_ribbed.png", "smooth mips"),
        Slot = "ud_m16_hg",
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(0, -1.63, -0.41),
            vang = Angle(90, 0, -90),
        },
        ExcludeFlags = {"sd"}
    },
    {
        PrintName = "Muzzle",
        DefaultAttName = "Standard Muzzle",
        Slot = {"muzzle", "ud_m16_muzzle"},
        Bone = "m16_parent",
        VMScale = Vector(1, 1, 1),
        WMScale = VMScale,
        Offset = {
            vpos = Vector(0, -.33, 23.27),
            vang = Angle(90, 0, -90),
        },
        ExcludeFlags = {"sd", "m16_stub"},
    },
    {
        PrintName = "Upper Receiver",
        DefaultAttName = "5.56x45mm Upper",
        DefaultAttIcon = Material("entities/att/uc_bullets/556x45.png", "smooth mips"),
        Slot = {"ud_m16_receiver"},
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(2.8, -4.2, -11.5),
            vang = Angle(90, 0, -90),
        },
        ExcludeFlags = {"ud_m16_fpw"}
    },
    {
        PrintName = "Lower Receiver",
        DefaultAttName = "Burst Lower",
        DefaultAttIcon = Material("entities/att/acwatt_ud_m16_receiver_default.png", "smooth mips"),
        Slot = {"ud_m16_fcg"},
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(2.8, -4.2, -11.5),
            vang = Angle(90, 0, -90),
        },
        ExcludeFlags = {"m16_nolower"}
    },
    {
        PrintName = "Underbarrel",
        Slot = "foregrip",
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(0, 6, 11),
            vang = Angle(90, 0, -90),
        },
        InstalledEles = {"rail_fg"},
        ExcludeFlags = {"m16_lmg", "m16_stub"},
        SlideAmount = {
            vmin = Vector(0, .65, 11.5),
            vmax = Vector(0, .65, 7.5),
        },
		MergeSlots = {18},
    },
    {
        PrintName = "Tactical",
        Slot = {"tac"},
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(0, 0.3, 21.25),
            vang = Angle(90, 0, -90),
        },
        GivesFlags = {"tac"},
        --InstalledEles = {"ud_m16_clamp_fullsize"}
    },
    {
        PrintName = "Grip Type",
        Slot = {"ud_m16_grip"},
        DefaultAttName = "Standard Grip",
        DefaultAttIcon = Material("entities/att/acwatt_ud_m16_grip_default.png", "smooth mips"),
        ExcludeFlags = {"m16_adar"}
    },
    {
        PrintName = "Stock",
        Slot = {"ud_m16_stock","go_stock"},
        DefaultAttName = "Full Stock",
        DefaultAttIcon = Material("entities/att/acwatt_ud_m16_stock_default.png", "smooth mips"),
        -- GSO support
        InstalledEles = {"stock_231_tube"},
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(-0.02, 0, -2.7),
            vang = Angle(90, 0, -90),
        },
    },
    {
        PrintName = "Magazine",
        Slot = {"ud_m16_mag"},
        DefaultAttName = "30-Round Mag",
        DefaultAttIcon = Material("entities/att/acwatt_ud_m16_mag_30.png", "smooth mips"),
    },
    {
        PrintName = "Ammo Type",
        DefaultAttName = "\"FMJ\" Full Metal Jacket",
        DefaultAttIcon = Material("entities/att/arccw_uc_ammo_generic.png", "mips smooth"),
        Slot = "uc_ammo",
    },
    {
        PrintName = "Powder Load",
        Slot = "uc_powder",
        DefaultAttName = "Standard Load"
    },
    {
        PrintName = "Training Package",
        Slot = "uc_tp",
        DefaultAttName = "Basic Training"
    },
    {
        PrintName = "Internals",
        Slot = "uc_fg", -- Fire group
        DefaultAttName = "Standard Internals"
    },
    {
        PrintName = "Front Sight",
        Slot = {"ud_m16_fs", "ud_m16_charm"},
        FreeSlot = true,
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(0, -1.65, 16.75), -- 21.75 or 15.75
            vang = Angle(90, 0, -90),
        },
        ExcludeFlags = {"sight_magpul"}
    },
    {
        PrintName = "Charm",
        Slot = {"charm", "fml_charm"}, -- "ud_m16_charm"
        FreeSlot = true,
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(0.48, 0.5, 3.9),
            vang = Angle(90, 0, -90),
        },
        -- MergeSlots = {17}
    },
    {
        PrintName = "M203 slot",
        Slot = "uc_ubgl",
        Bone = "m16_parent",
        Offset = {
            vpos = Vector(0, -0.4, 7.2),
            vang = Angle(90, 0, -90),
        },
        Hidden = true,
        InstalledEles = {"rail_fg"},
        ExcludeFlags = {"m16_lmg", "m16_stub"},
    }
}
--lua/weapons/arccw_ud_m79.lua:
SWEP.Base = "arccw_base"
SWEP.Spawnable = true
SWEP.Category = "ArcCW - Urban Coalition"
SWEP.UC_CategoryPack = "1Urban Decay"
SWEP.AdminOnly = false
SWEP.UseHands = true

-- Muzzle and shell effects --

SWEP.MuzzleEffect = "muzzleflash_m79"
SWEP.ShellEffect = "arccw_uc_shelleffect"
SWEP.ShellModel = "models/weapons/arccw/ud_shells/12.mdl"
SWEP.ShellPitch = 100
SWEP.ShellSounds = ArcCW.ShotgunShellSoundsTable
SWEP.ShellScale = 0

SWEP.MuzzleEffectAttachment = 1
SWEP.CaseEffectAttachment = 3
SWEP.CamAttachment = 2

-- Fake name --

SWEP.PrintName = "AMSGL"
-- (American) Squad Grenade Launcher or something. similar to M16's fake name

-- True name --

SWEP.TrueName = "M79"

-- Trivia --

SWEP.Trivia_Class = "Grenade Launcher"
SWEP.Trivia_Desc = "Single-shot 40mm grenade launcher intended to provide infantry with portable long-range explosive firepower. Accurate, flexible and reliable, it is well-respected among American soldiers."
SWEP.Trivia_Manufacturer = "Stoner's Legacy Ltd."
SWEP.Trivia_Calibre = "40x46mm"
SWEP.Trivia_Mechanism = "Break-action"
SWEP.Trivia_Country = "USA"
SWEP.Trivia_Year = 1961

-- Weapon slot --

SWEP.Slot = 4

-- Weapon's manufacturer real name --

if GetConVar("arccw_truenames"):GetBool() then
    SWEP.PrintName = SWEP.TrueName
    SWEP.Trivia_Manufacturer = "Springfield Armory"
end

-- Viewmodel / Worldmodel / FOV --

SWEP.ViewModel = "models/weapons/arccw/c_ud_m79.mdl"
SWEP.WorldModel = "models/weapons/arccw/c_ud_m79.mdl"
SWEP.ViewModelFOV = 60
SWEP.AnimShoot = ACT_HL2MP_GESTURE_RANGE_ATTACK_SHOTGUN

SWEP.MirrorVMWM = true
SWEP.WorldModelOffset = {
    pos        =    Vector(-8, 5.5, -4.5),
    ang        =    Angle(-12, 0, 180),
    bone    =    "ValveBiped.Bip01_R_Hand",
    scale = 1 - ( 0.35 * 0.5 )
}

-- Damage parameters --

SWEP.Damage = 200
SWEP.DamageMin = 200
SWEP.Range = 40
SWEP.RangeMin = 0

SWEP.Num = 1
SWEP.Penetration = 0

SWEP.ShootEntity = "arccw_uc_40mm_he"
SWEP.MuzzleVelocity = 5000

-- Mag size --

SWEP.ChamberSize = 0
SWEP.Primary.ClipSize = 1
SWEP.ExtendedClipSize = 1
SWEP.ReducedClipSize = 1

-- Recoil --

SWEP.Recoil = 4
SWEP.RecoilSide = 2
SWEP.RecoilSide = 1

SWEP.RecoilRise = 0.24
SWEP.VisualRecoilMult = 1
SWEP.MaxRecoilBlowback = 1
SWEP.MaxRecoilPunch = 1

SWEP.Sway = 0.5

-- Firerate / Firemodes --

SWEP.Delay = 60 / 220
SWEP.Firemodes = {
    {
        Mode = 1,
    },
    {
        Mode = 0
    }
}

SWEP.ShootVol = 160
SWEP.ShootPitch = 100

SWEP.ProceduralRegularFire = false
SWEP.ProceduralIronFire = false

-- NPC --

SWEP.NPCWeaponType = "weapon_rpg"
SWEP.NPCWeight = 210

-- Accuracy --

SWEP.AccuracyMOA = 30
SWEP.HipDispersion = 500
SWEP.MoveDispersion = 200
SWEP.JumpDispersion = 1000

SWEP.Primary.Ammo = "smg1_grenade"

-- Speed multipliers --

SWEP.SpeedMult = 0.92
SWEP.SightedSpeedMult = 0.5
SWEP.SightTime = 0.4
SWEP.ShootSpeedMult = 0.75

-- Length --

SWEP.BarrelLength = 48
SWEP.ExtraSightDist = 2

-- Ironsights / Customization / Poses --

SWEP.HoldtypeHolstered = "passive"
SWEP.HoldtypeActive = "ar2"
SWEP.HoldtypeSights = "rpg"

SWEP.IronSightStruct = {
    Pos = Vector(-3.51, -5, 2.2),
    Ang = Angle(0, 0, 0),
    Midpoint = {
    Pos = Vector(0, 0, 0),
    Ang = Angle(0, -1, 0),
    },
    Magnification = 1,
    SwitchToSound = "",
    CrosshairInSights = false,
}

SWEP.HolsterPos = Vector(-0.5, -4, -3)
SWEP.HolsterAng = Angle(3.5, 7, -20)

SWEP.ActivePos = Vector(0, 0, 0)
SWEP.ActiveAng = Angle(0, 0, 0)

SWEP.CrouchPos = Vector(-4, -2, 0)
SWEP.CrouchAng = Angle(0, 0, -30)

SWEP.BarrelOffsetSighted = Vector(0, 0, -4)
SWEP.BarrelOffsetHip = Vector(6, 0, -8)

-- Firing sounds --

local common = ")/arccw_uc/common/"
local path = ")/arccw_uc/common/40mm/"
local rottle = {common .. "cloth_1.ogg", common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}

--SWEP.Hook_AddShootSound = ArcCW.UC.InnyOuty

SWEP.ShootSound = {
    path .. "fire-01.ogg",
    path .. "fire-02.ogg",
    path .. "fire-03.ogg",
    path .. "fire-04.ogg",
    path .. "fire-05.ogg",
    path .. "fire-06.ogg"
}
SWEP.DistantShootSound = {
    path .. "fire-dist-01.ogg",
    path .. "fire-dist-02.ogg",
    path .. "fire-dist-03.ogg",
    path .. "fire-dist-04.ogg",
    path .. "fire-dist-05.ogg",
    path .. "fire-dist-06.ogg"
}
--[[SWEP.DistantShootSoundOutdoors = {
    path .. "fire-dist-01.ogg",
    path .. "fire-dist-02.ogg",
    path .. "fire-dist-03.ogg",
    path .. "fire-dist-04.ogg",
    path .. "fire-dist-05.ogg",
    path .. "fire-dist-06.ogg"
}
SWEP.DistantShootSoundIndoors = {
    common .. "fire-dist-int-shotgun-01.ogg",
    common .. "fire-dist-int-shotgun-02.ogg",
    common .. "fire-dist-int-shotgun-03.ogg",
    common .. "fire-dist-int-shotgun-04.ogg",
    common .. "fire-dist-int-shotgun-05.ogg",
    common .. "fire-dist-int-shotgun-06.ogg"
}]]

-- Animations --

SWEP.Hook_Think = ArcCW.UC.ADSReload

SWEP.Animations = {
    ["idle"] = {
        Source = "idle",
    },
    ["draw"] = {
        Source = "draw",
        SoundTable = ArcCW.UC.DrawSounds,
    },
    ["holster"] = {
        Source = "holster",
        SoundTable = ArcCW.UC.HolsterSounds,
    },
    ["fire"] = {
        Source = "fire",
        Time = 20 / 30,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0, v = 0.25 }},
    },
    ["fire_iron"] = {
        Source = "fire",
        Time = 20 / 30,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0}},
    },
    ["reload"] = {
        Source = "reload",
        Time = 101 / 30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SHOTGUN,
        LHIK = true,
        LHIKIn = 0.6,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.2,
        LHIKOut = 0.5,
        LastClip1OutTime = 1.5,
        MinProgress = 2.2,
        SoundTable = {
            {s = rottle, t = 0},
            {s = common .. "breaker_open.ogg",  t = 0.3},
            {s = common .. "gl_remove.ogg",  t = 0.9},
            {s = rottle, t = 1.0},
            {s = common .. "magpouch.ogg", t = 1.4},
            {s = common .. "40mm_casing_1.ogg",  t = 1.6},
            {s = common .. "gl_insert.ogg",  t = 2.0},
            {s = rottle, t = 2.25},
            {s = common .. "breaker_close.ogg",  t = 2.5},
            -- {
            --     t = 0.6,
            --     e = "RagdollImpact",  -- Please add some kind of smoke particle after opening the chamber
            --     att = 1,
            --     mag = 100,
            -- }
        },
    },["reload_shotgun"] = {
        Source = "reload",
        Time = 101 / 30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SHOTGUN,
        LHIK = true,
        LHIKIn = 0.6,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.2,
        LHIKOut = 0.5,
        LastClip1OutTime = 1.5,
        SoundTable = {
            {s = rottle, t = 0},
            {s = common .. "breaker_open.ogg",  t = 0.3},
            {s = common .. "gl_remove.ogg",  t = 0.9},
            {s = rottle, t = 1.0},
            {s = common .. "40mm_casing_1.ogg",  t = 1.6},
            {s = common .. "gl_insert.ogg",  t = 2.0},
            {s = rottle, t = 2.25},
            {s = common .. "breaker_close.ogg",  t = 2.5},
            {
                t = 1, ind = 1, bg = 2, -- Empty shell bodygroup
            },
            {
                t = 1.5, ind = 1, bg = 1,
            }
        },
    },
    ["reload_caseless"] = {
        Source = "reload_caseless",
        Time = 101 / 30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SHOTGUN,
        LHIK = true,
        LHIKIn = 0.74,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.2,
        LHIKOut = 0.6,
        SoundTable = {
            {s = rottle, t = 0},
            {s = common .. "breaker_open.ogg",  t = 0.3},
            {s = rottle, t = 0.75},
            {s = common .. "gl_insert.ogg",  t = 1.5},
            {s = rottle, t = 2.0},
            {s = common .. "breaker_close.ogg",  t = 2.25},
            -- {
            --     t = 0.6,
            --     e = "muzzleflash_m79",  -- Please add some kind of smoke particle after opening the chamber
            --     att = nil,
            --     mag = 100,
            -- }
        },
    },
}

SWEP.BulletBones = {
    [1] = "m79_grenade",
}

-- Bodygroups --

SWEP.AttachmentElements = {
    ["m79_pirategun"] = {
        VMBodygroups = {{ind = 0, bg = 1}},
    },
    ["m79_nostock"] = {
        VMBodygroups = {{ind = 2, bg = 1}},
    },
    ["m79_rail"] = {
        VMBodygroups = {{ind = 3, bg = 1}},
    },

    ["40mm_buckshot"] = {
        VMBodygroups = {{ind = 1, bg = 1}},
    },
    ["40mm_buckshot_empty"] = {
        VMBodygroups = {{ind = 1, bg = 2}},
    },
    ["40mm_caseless"] = {
        VMBodygroups = {{ind = 1, bg = 3}},
    },
    ["40mm_hornetnest"] = {
        VMBodygroups = {{ind = 1, bg = 4}},
    },
    ["40mm_incendiary"] = {
        VMBodygroups = {{ind = 1, bg = 5}},
    },
    ["40mm_napalm"] = {
        VMBodygroups = {{ind = 1, bg = 5}},
    },
}

SWEP.Attachments = {
    {
        PrintName = "Optic",
        DefaultAttName = "Iron Sights",
        Slot = {"optic_lp", "optic", "optic_sniper"},
        Bone = "m79_front",
        Offset = {
            vpos = Vector(0, -3.6, 1),
            vang = Angle(90, 2, -90),
        },
        InstalledEles = {"m79_rail"},
        ExcludeFlags = {"m79_pirategun"},
    },
    {
        PrintName = "Tube",
        DefaultAttName = "Standard Tube",
        DefaultAttIcon = Material("entities/att/acwatt_ud_m79_barrel.png", "smooth mips"),
        Slot = "ud_m79_barrel",
        Bone = "m79_front",
        Offset = {
            vpos = Vector(3.45, -5.3, -22),
            vang = Angle(90, 2, -90),
        },
    },
    {
        PrintName = "Underbarrel",
        Slot = {"foregrip"},
        Bone = "m79_front",
        Offset = {
            vpos = Vector(0, 0.4, 1.25),
            vang = Angle(90, 0, -90),
        },
        InstalledEles = {"m79_rail"},
        ExcludeFlags = {"m79_pirategun"},
        MergeSlots = {10},
    },
    {
        PrintName = "Tactical",
        Slot = {"tac_pistol"},
        Bone = "m79_front",
        Offset = {
            vpos = Vector(0.25, 0, 5),
            vang = Angle(90, 0, -90),
        },
        ExcludeFlags = {"m79_pirategun"},
    },
    {
        PrintName = "Stock",
        Slot = {"ud_m79_stock"},
        DefaultAttName = "Wooden Stock",
        DefaultAttIcon = Material("entities/att/acwatt_ud_m79_stock.png", "smooth mips"),
    },
    {
        PrintName = "Grenade Type",
        DefaultAttName = "High Explosive",
        DefaultAttIcon = Material("entities/att/arccw_uc_40mm_generic.png", "smooth mips"),
        Slot = "uc_40mm",
    },
    {
        PrintName = "Training Package",
        Slot = "uc_tp",
        DefaultAttName = "Basic Training"
    },
    {
        PrintName = "Internals",
        Slot = "uc_fg_singleshot", -- Fire group
        DefaultAttName = "Standard Internals",
    },
    {
        PrintName = "Charm",
        Slot = {"charm", "fml_charm"},
        FreeSlot = true,
        Bone = "m79_front",
        Offset = {
            vpos = Vector(0.8, -1, 0),
            vang = Angle(90, 0, -90),
        },
    },
    {
        PrintName = "M203 slot",
        Slot = "uc_ubgl",
        Bone = "m79_front",
        Offset = {
            vpos = Vector(0, -1.1, 0.9),
            vang = Angle(90, 0, -90),
        },
        InstalledEles = {"m79_rail"},
        ExcludeFlags = {"m79_pirategun"},
        Hidden = true,
    }
}
--lua/weapons/arccw_ud_mini14.lua:
SWEP.Base = "arccw_base"
SWEP.Spawnable = true
SWEP.Category = "ArcCW - Urban Coalition"
SWEP.UC_CategoryPack = "1Urban Decay"
SWEP.AdminOnly = false
SWEP.UseHands = true

-- Effects --

SWEP.MuzzleEffect = "muzzleflash_1"
SWEP.ShellEffect = "arccw_uc_shelleffect"
SWEP.ShellModel = "models/weapons/arccw/uc_shells/556x45.mdl"
SWEP.ShellScale = 0.666
--SWEP.ShellMaterial = "models/weapons/arcticcw/shell_556"
SWEP.ShellPitch = 100

SWEP.MuzzleEffectAttachment = 1
SWEP.CaseEffectAttachment = 2
SWEP.CamAttachment = 3
SWEP.TracerNum = 1
SWEP.TracerCol = Color(25, 255, 25)
SWEP.TracerWidth = 2

-- Fake name --

SWEP.PrintName = "Patriot 809"

-- True name --

SWEP.TrueName = "Mini-14"

-- Trivia --

SWEP.Trivia_Class = "Semi-Automatic Rifle"
SWEP.Trivia_Desc = [[Autoloading rifle designed for better accuracy than competing models. Due to its appearance, it is sometimes exempted from gun control laws targeting "Assault Weapons" despite its identical ability to kill. This has helped it find success despite its higher cost and non-standard magazine well.

While it can perform well in close-quarters combat, its high accuracy excels in mid-range engagements.]]
SWEP.Trivia_Manufacturer = "Rifles International"
SWEP.Trivia_Calibre = "5.56x45mm NATO"
SWEP.Trivia_Mechanism = "Gas-Operated Rotating Bolt"
SWEP.Trivia_Country = "USA"
SWEP.Trivia_Year = 1973

-- Weapon slot --

SWEP.Slot = 2

-- Weapon's manufacturer real name --

if GetConVar("arccw_truenames"):GetBool() then
    SWEP.PrintName = SWEP.TrueName
    SWEP.Trivia_Manufacturer = "Sturm, Ruger & Company"
end

-- Viewmodel / Worldmodel / FOV --

SWEP.ViewModel = "models/weapons/arccw/c_ud_mini14.mdl"
SWEP.WorldModel = "models/weapons/arccw/c_ud_mini14.mdl"
SWEP.ViewModelFOV = 70
SWEP.AnimShoot = ACT_HL2MP_GESTURE_RANGE_ATTACK_AR2
SWEP.DefaultSkin = 0
SWEP.DefaultPoseParams = {["grip"] = 0}

-- Damage --

SWEP.Damage = ArcCW.UC.StdDmg["556"].max
SWEP.DamageMin = ArcCW.UC.StdDmg["556"].min
SWEP.RangeMin = 50
SWEP.Range = 400 -- 4 shot until ~275m

SWEP.Penetration = ArcCW.UC.StdDmg["556"].pen
SWEP.DamageType = DMG_BULLET
SWEP.ShootEntity = nil
SWEP.MuzzleVelocity = 990
SWEP.PhysBulletMuzzleVelocity = 960

SWEP.BodyDamageMults = ArcCW.UC.BodyDamageMults

-- Mag size --

SWEP.ChamberSize = 1
SWEP.Primary.ClipSize = 20
SWEP.ExtendedClipSize = 30
SWEP.ReducedClipSize = 10

-- Recoil --

SWEP.Recoil = 0.45
SWEP.RecoilSide = 0.2

SWEP.RecoilRise = 0.1
SWEP.RecoilPunch = 1
SWEP.VisualRecoilMult = 1
SWEP.MaxRecoilBlowback = 1
SWEP.MaxRecoilPunch = 1
SWEP.RecoilPunchBack = 1

SWEP.Sway = 0.25

-- Firerate / Firemodes --

SWEP.Delay = 60 / 540
SWEP.Num = 1
SWEP.Firemodes = {
    {
        Mode = 1,
    },
    {
        Mode = 0,
    },
}

SWEP.ShootPitch = 100
SWEP.ShootVol = 120

SWEP.ProceduralRegularFire = false
SWEP.ProceduralIronFire = false

SWEP.ReloadInSights = true

-- NPC --

SWEP.NPCWeaponType = "weapon_ar2"
SWEP.NPCWeight = 60

-- Accuracy --

SWEP.AccuracyMOA = 2
SWEP.HipDispersion = 800
SWEP.MoveDispersion = 150
SWEP.JumpDispersion = 1000

SWEP.Primary.Ammo = "smg1"
SWEP.MagID = "mini14"

SWEP.HeatCapacity = 75
SWEP.HeatDissipation = 5
SWEP.HeatDelayTime = 3

SWEP.MalfunctionMean = 100

-- Speed multipliers --

SWEP.SpeedMult = 0.9
SWEP.SightedSpeedMult = 0.75
SWEP.SightTime = 0.35
SWEP.ShootSpeedMult = 0.9

-- Length --

SWEP.BarrelLength = 36
SWEP.ExtraSightDist = 2

-- Ironsights / Customization / Poses --

SWEP.HolsterPos = Vector(2, 0, -2)
SWEP.HolsterAng = Angle(-5.5, 20, -20)

SWEP.SprintPos = Vector(-0.5, -4, -2)
SWEP.SprintAng = Angle(3.5, 7, -20)

SWEP.HoldtypeHolstered = "passive"
SWEP.HoldtypeActive = "ar2"
SWEP.HoldtypeSights = "rpg"

SWEP.IronSightStruct = {
    Pos = Vector(-4.305, -7, 2.55),
    Ang = Angle(0, 0, 0),
    Magnification = 1,
    SwitchToSound = "",
    CrosshairInSights = false,
}

SWEP.ActivePos = Vector(-1, -1, 1)
SWEP.ActiveAng = Angle(0, 0, -3)

SWEP.CustomizePos = Vector(5, -2, -2)
SWEP.CustomizeAng = Angle(15, 25, 0)

SWEP.CrouchPos = Vector(-5, -4, 0)
SWEP.CrouchAng = Angle(0, 0, -30)

SWEP.BarrelOffsetHip = Vector(3, 0, -3)

SWEP.MirrorVMWM = true
SWEP.WorldModelOffset = {
    pos        =    Vector(-10, 6.5, -6),
    ang        =    Angle(-12, 0, 180),
    bone    =    "ValveBiped.Bip01_R_Hand",
    scale = 1 - ( 0.35 * 0.75 )
}

-- Firing sounds --

local path = ")weapons/arccw_ud/mini14/"
local common = ")/arccw_uc/common/"
SWEP.ShootSound = {
    path .. "fire-01.ogg",
    path .. "fire-02.ogg",
    path .. "fire-03.ogg",
    path .. "fire-04.ogg",
    path .. "fire-05.ogg",
    path .. "fire-06.ogg"
}
SWEP.ShootSoundSilenced = path .. "fire_supp.ogg"
SWEP.DistantShootSound = nil
SWEP.DistantShootSoundSilenced = common .. "sup_tail.ogg"
SWEP.ShootDrySound = path .. "dryfire.ogg"

local tail = ")/arccw_uc/common/556x45/"

SWEP.DistantShootSoundOutdoors = {
    tail .. "fire-dist-556x45-rif-ext-01.ogg",
    tail .. "fire-dist-556x45-rif-ext-02.ogg",
    tail .. "fire-dist-556x45-rif-ext-03.ogg",
    tail .. "fire-dist-556x45-rif-ext-04.ogg",
    tail .. "fire-dist-556x45-rif-ext-05.ogg",
    tail .. "fire-dist-556x45-rif-ext-06.ogg"
}
SWEP.DistantShootSoundIndoors = {
    common .. "fire-dist-int-rifle-01.ogg",
    common .. "fire-dist-int-rifle-02.ogg",
    common .. "fire-dist-int-rifle-03.ogg",
    common .. "fire-dist-int-rifle-04.ogg",
    common .. "fire-dist-int-rifle-05.ogg",
    common .. "fire-dist-int-rifle-06.ogg"
}
SWEP.DistantShootSoundOutdoorsSilenced = {
    common .. "sup-tail-01.ogg",
    common .. "sup-tail-02.ogg",
    common .. "sup-tail-03.ogg",
    common .. "sup-tail-04.ogg",
    common .. "sup-tail-05.ogg",
    common .. "sup-tail-06.ogg",
    common .. "sup-tail-07.ogg",
    common .. "sup-tail-08.ogg",
    common .. "sup-tail-09.ogg",
    common .. "sup-tail-10.ogg"
}
SWEP.DistantShootSoundIndoorsSilenced = {
    common .. "fire-dist-int-pistol-light-01.ogg",
    common .. "fire-dist-int-pistol-light-02.ogg",
    common .. "fire-dist-int-pistol-light-03.ogg",
    common .. "fire-dist-int-pistol-light-04.ogg",
    common .. "fire-dist-int-pistol-light-05.ogg",
    common .. "fire-dist-int-pistol-light-06.ogg"
}
SWEP.DistantShootSoundOutdoorsVolume = 1
SWEP.DistantShootSoundIndoorsVolume = 1
SWEP.Hook_AddShootSound = ArcCW.UC.InnyOuty

-- Bodygroups --

SWEP.BulletBones = {
    [2] = "mini14_bullet1", [3] = "mini14_bullet2"
}

SWEP.AttachmentElements = {
    ["ud_mini14_mag_10"] = {
        VMBodygroups = {{ind = 4, bg = 2}},
    },
    ["ud_mini14_mag_30"] = {
        VMBodygroups = {{ind = 4, bg = 1}},
    },
    ["ud_mini14_mag_42"] = {
        VMBodygroups = {{ind = 4, bg = 4}},
    },
    ["ud_mini14_mag_60"] = {
        VMBodygroups = {{ind = 4, bg = 5}},
    },
    ["ud_mini14_mag_15_22lr"] = {
        VMBodygroups = {{ind = 4, bg = 3}},
    },
    ["ud_mini14_mag_30_762"] = {
        VMBodygroups = {{ind = 4, bg = 6}},
    },
    ["ud_mini14_rail_optic"] = {
        VMBodygroups = {{ind = 2, bg = 1}},
    },

    ["ud_mini14_rail_fg"] = {
        VMBodygroups = {{ind = 5, bg = 1}},
    },

    ["ud_mini14_barrel_long"] = {
        VMBodygroups = {{ind = 3, bg = 1}},
        AttPosMods = {
            [3] = {
                vpos = Vector(0, -2.15, 34.5),
            },
        },
    },
    ["ud_mini14_barrel_short"] = {
        VMBodygroups = {{ind = 3, bg = 2}},
        AttPosMods = {
            [3] = {
                vpos = Vector(0, -2.15, 27.5),
            },
        },
    },
    ["ud_mini14_barrel_stub"] = {
        VMBodygroups = {{ind = 3, bg = 3}},
        AttPosMods = {
            [3] = {
                vpos = Vector(0, -2.1, 25),
            },
        },
    },

    ["ud_mini14_receiver_762"] = {
        TrueNameChange = "Mini-30",
        NameChange = "Patriot 816"
    },
    ["ud_mini14_receiver_auto"] = {
        TrueNameChange = "AC-556",
        NameChange = "Patriot ACC"
    },
    ["ud_mini14_receiver_22lr"] = {
        TrueNameChange = "Mini-14 .22 LR",
        NameChange = "Patriot 822"
    },

    ["ud_mini14_stock_polymer"] = {
        VMBodygroups = {{ind = 1, bg = 1}},
        VMPoseParams = {["grip"] = 0}
    },
    ["ud_mini14_stock_sawnoff"] = {
        VMBodygroups = {{ind = 1, bg = 2}},
        VMPoseParams = {["grip"] = 0}
    },
    ["ud_mini14_stock_tactical"] = {
        VMBodygroups = {{ind = 1, bg = 4}},
        VMPoseParams = {["grip"] = 1}
    },
    ["ud_mini14_stock_tactical_polymer"] = {
        VMBodygroups = {{ind = 1, bg = 3}},
        VMSkin = 1,
        VMPoseParams = {["grip"] = 1}
    },

    ["ud_mini14_clamp"] = {
        VMBodygroups = {{ind = 6, bg = 1}},
    },
}

-- Animations --

SWEP.Hook_Think = ArcCW.UC.ADSReload

SWEP.Animations = {
    ["ready"] = {
        Source = "unjam",
        Time = 40 / 30,
        SoundTable = {
            {s = common .. "raise.ogg", t = 0},
            {s = common .. "rattle.ogg", t = 0.2},
            {s = path .. "chback.ogg",  t = 0.25},
            {s = path .. "chamber.ogg", t = 0.35},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.8},
            {s = common .. "shoulder.ogg",  t = 1},
        },
        LHIK = true,
        LHIKIn = 0.5,
        LHIKEaseIn = 0.5,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.5,
        ProcDraw = true,
    },
    ["idle"] = {
        Source = "idle",
    },
    ["idle_empty"] = {
        Source = "idle_empty",
    },
    ["draw"] = {
        Source = "draw",
        SoundTable = ArcCW.UC.DrawSounds,
    },
    ["draw_empty"] = {
        Source = "draw_empty",
        Time = 12 / 30,
        SoundTable = ArcCW.UC.DrawSounds,
    },
    ["holster"] = {
        Source = "holster",
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0,
        LHIKOut = 0,
        SoundTable = ArcCW.UC.HolsterSounds,
    },
    ["holster_empty"] = {
        Source = "holster_empty",
        Time = 12 / 30,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0,
        LHIKOut = 0,
        SoundTable = ArcCW.UC.HolsterSounds,
    },
    ["fire"] = {
        Source = "fire",
        Time = 20 / 30,
        ShellEjectAt = 0.01,
        LastClip1OutTime = 0,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0, v = 0.25 }},
    },
    ["fire_iron"] = {
        Source = "fire",
        Time = 20 / 30,
        ShellEjectAt = 0.01,
        LastClip1OutTime = 0,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0 }},
    },
    ["fire_empty"] = {
        Source = "fire_empty",
        Time = 20 / 30,
        ShellEjectAt = 0.01,
        SoundTable = {
            {s = path .. "mech_last.ogg", t = 0}, -- Temporary
        },
    },
    ["fire_iron_empty"] = {
        Source = "fire_empty",
        Time = 20 / 30,
        ShellEjectAt = 0.01,
        SoundTable = {
            {s = path .. "mech_last.ogg", t = 0}, -- Temporary
        },
    },
    ["unjam"] = {
        Source = "unjam",
        Time = 40 / 30,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.0},
            {s = path .. "chback.ogg",  t = 0.25},
            {s = path .. "chamber.ogg", t = 0.35},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.8},
            {s = common .. "shoulder.ogg",  t = 1},
        },
        LHIK = true,
        LHIKIn = 0.5,
        LHIKEaseIn = 0.5,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.5,
        ShellEjectAt = .35,
    },
    -- 20 Round Reloads --

    ["reload"] = {
        Source = "reload",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 66 / 30,
        MinProgress = 1.4,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.0},
            {s = path .. "magout.ogg", 	t = 0.25},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.4},
            {s = common .. "magpouch.ogg", t = 0.6},
            {s = path .. "magin.ogg",   t = 1.05},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 1.3},
            {s = common .. "shoulder.ogg",  t = 1.75},
        },
    },
    ["reload_empty"] = {
        Source = "reload_empty",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 86 / 30,
        MinProgress = 2.1,
        LastClip1OutTime = 1,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.0},
            {s = path .. "magout.ogg", 	t = 0.15},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.4},
            {s = common .. "magpouch.ogg", t = 0.6},
            {s = common .. "rifle_magdrop.ogg",  t = 0.9},
            {s = path .. "magin.ogg",   t = 1.10},
            {s = path .. "chback.ogg",  t = 1.85},
            {s = path .. "chamber.ogg", t = 1.95},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 2.2},
            {s = common .. "shoulder.ogg",  t = 2.4},
        },
    },

    -- 10 Round Reloads --

    ["reload_10"] = {
        Source = "reload_10",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 67 / 30,
        MinProgress = 1.6,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.0},
            {s = path .. "magout.ogg", 	t = 0.15},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.3},
            {s = common .. "magpouch.ogg", t = 0.6, c = ci},
            {s = path .. "magin.ogg",   t = 1.10},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 1.5},
        },
    },
    ["reload_empty_10"] = {
        Source = "reload_empty_10",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 86 / 30,
        MinProgress = 2.1,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.0},
            {s = path .. "magout.ogg", 	t = 0.15},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.4},
            {s = common .. "magpouch.ogg", t = 0.6, c = ci},
            {s = common .. "rifle_magdrop.ogg",  t = 0.9},
            {s = path .. "magin.ogg",   t = 1.10},
            {s = path .. "chback.ogg",  t = 1.90},
            {s = path .. "chamber.ogg", t = 2.00},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 2.4},
            {s = common .. "shoulder.ogg",  t = 2.5},
        },
    },

    -- 30 Round Reloads --

    ["reload_30"] = {
        Source = "reload_30",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 67 / 30,
        MinProgress = 1.4,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.0},
            {s = path .. "magout.ogg", 	t = 0.3},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.3},
            {s = common .. "magpouch.ogg", t = 0.7, c = ci},
            {s = path .. "magin.ogg",   t = 1.10},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 1.4},
            {s = common .. "shoulder.ogg",  t = 1.85},
        },
    },
    ["reload_empty_30"] = {
        Source = "reload_empty_30",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 86 / 30,
        MinProgress = 2.3,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.0},
            {s = path .. "magout.ogg", 	t = 0.2},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.3},
            {s = common .. "magpouch.ogg", t = 0.65, c = ci},
            {s = common .. "rifle_magdrop.ogg",  t = 0.9},
            {s = path .. "magin.ogg",   t = 1.20},
            {s = path .. "chback.ogg",  t = 2},
            {s = path .. "chamber.ogg", t = 2.1},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 2.3},
            {s = common .. "shoulder.ogg",  t = 2.65},
        },
    },

    -- 30 polymer Reloads --

    ["reload_30_tac"] = {
        Source = "reload_30_tac",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 67 / 30,
        MinProgress = 1.4,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.0},
            {s = path .. "magout.ogg", 	t = 0.3},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.3},
            {s = common .. "magpouch.ogg", t = 0.7, c = ci},
            {s = path .. "magin.ogg",   t = 1.10},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 1.4},
            {s = common .. "shoulder.ogg",  t = 1.85},
        },
    },
    ["reload_empty_30_tac"] = {
        Source = "reload_empty_30_tac",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 86 / 30,
        MinProgress = 2.3,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.0},
            {s = path .. "magout.ogg", 	t = 0.2},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.3},
            {s = common .. "magpouch.ogg", t = 0.65, c = ci},
            {s = common .. "rifle_magdrop.ogg",  t = 0.9},
            {s = path .. "magin.ogg",   t = 1.20},
            {s = path .. "chback.ogg",  t = 2},
            {s = path .. "chamber.ogg", t = 2.1},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 2.3},
            {s = common .. "shoulder.ogg",  t = 2.65},
        },
    },

    -- 7.62 reloads --

    ["reload_762"] = {
        Source = "reload_762",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 67 / 30,
        MinProgress = 1.4,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.0},
            {s = path .. "magout.ogg", 	t = 0.3},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.3},
            {s = common .. "magpouch.ogg", t = 0.7, c = ci},
            {s = path .. "magin.ogg",   t = 1.10},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 1.4},
            {s = common .. "shoulder.ogg",  t = 1.85},
        },
    },
    ["reload_empty_762"] = {
        Source = "reload_empty_762",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 86 / 30,
        MinProgress = 2.3,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.0},
            {s = path .. "magout.ogg", 	t = 0.2},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.3},
            {s = common .. "magpouch.ogg", t = 0.65, c = ci},
            {s = common .. "rifle_magdrop.ogg",  t = 0.9},
            {s = path .. "magin.ogg",   t = 1.20},
            {s = path .. "chback.ogg",  t = 2},
            {s = path .. "chamber.ogg", t = 2.1},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 2.3},
            {s = common .. "shoulder.ogg",  t = 2.65},
        },
    },

    -- 60 round reloads (?) --

    ["reload_60"] = {
        Source = "reload_60",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 67 / 30,
        MinProgress = 1.4,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.0},
            {s = path .. "magout.ogg", 	t = 0.35},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.3},
            {s = common .. "magpouch.ogg", t = 0.7, c = ci},
            {s = path .. "magin.ogg",   t = 1.10},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 1.4},
            {s = common .. "shoulder.ogg",  t = 1.85},
        },
    },
    ["reload_empty_60"] = {
        Source = "reload_empty_60",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 86 / 30,
        MinProgress = 2.3,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.0},
            {s = path .. "magout.ogg", 	t = 0.35},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.3},
            {s = common .. "magpouch.ogg", t = 0.7, c = ci},
            {s = common .. "rifle_magdrop.ogg",  t = 0.9},
            {s = path .. "magin.ogg",   t = 1.20},
            {s = path .. "chback.ogg",  t = 1.9},
            {s = path .. "chamber.ogg", t = 2},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 2.3},
            {s = common .. "shoulder.ogg",  t = 2.65},
        },
    },

    -- 15 22lr Round Reloads --

    ["reload_15_22lr"] = {
        Source = "reload_15_22lr",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 67 / 30,
        MinProgress = 1.6,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.45,
        LHIKOut = 0.7,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.0},
            {s = path .. "magout.ogg", 	t = 0.15},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.3},
            {s = common .. "magpouch.ogg", t = 0.65, c = ci},
            {s = path .. "magin.ogg",   t = .9},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 1.4},
        },
    },
    ["reload_empty_15_22lr"] = {
        Source = "reload_empty_15_22lr",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        Time = 86 / 30,
        MinProgress = 2.2,
        LastClip1OutTime = 0.7,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.45,
        LHIKOut = 0.6,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.0},
            {s = path .. "magout.ogg", 	t = 0.15},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.5},
            {s = common .. "pistol_magdrop.ogg",  t = 0.9},
            {s = common .. "magpouch.ogg", t = 0.7, c = ci},
            {s = path .. "magin.ogg",   t = 1.10},
            {s = path .. "chback.ogg",  t = 1.9},
            {s = path .. "chamber.ogg", t = 2.0},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 2.3},
        },
    },
}

SWEP.Hook_ModifyBodygroups = function(wep,data)
    local vm = data.vm
    if !IsValid(vm) then return end

    local atts = wep.Attachments
    local barr = string.Replace(atts[2].Installed or "default","ud_mini14_barrel_","")
    local muzz = atts[3].Installed
    local tac = atts[6].Installed

    if muzz or barr == "stub" or barr == "default" then
        vm:SetBodygroup(7,2)
    elseif barr == "short" then
        vm:SetBodygroup(7,1)
    elseif barr == "long" then
        vm:SetBodygroup(7,0)
    end

    if !tac then
       vm:SetBodygroup(6,0)
    end
end

SWEP.Attachments = {
    {
        PrintName = "Optic",
        DefaultAttName = "Iron Sights",
        Slot = {"optic_lp","optic","optic_sniper"},
        Bone = "mini14_parent",
        Offset = {
            vpos = Vector(0, -3.6, 6),
            vang = Angle(90, 2, -90),
        },
        VMScale = Vector(1.2,1.2,1.2),
        WMScale = VMScale,
        InstalledEles = {"ud_mini14_rail_optic"},
    },
    {
        PrintName = "Barrel",
        DefaultAttName = "20\" Standard Barrel",
        DefaultAttIcon = Material("entities/att/acwatt_ud_mini14_barrel.png", "smooth mips"),
        Slot = "ud_mini14_barrel",
    },
    {
        PrintName = "Muzzle",
        DefaultAttName = "Standard Muzzle",
        Slot = {"muzzle"},
        Bone = "mini14_parent",
        Offset = {
            vpos = Vector(0, -2.15, 30),
            vang = Angle(90, 0, -90),
            wpos = vpos,
        },
        VMScale = Vector(1.5,1.5,1.5),
        WMScale = VMScale,
        ExcludeFlags = {"nomuzzle"},
    },
    {
        PrintName = "Receiver",
        DefaultAttName = "Mini-14 Receiver",
        DefaultAttIcon = Material("entities/att/acwatt_ud_mini14_receiver.png", "smooth mips"),
        Slot = "ud_mini14_receiver",
    },
    {
        PrintName = "Underbarrel",
        Slot = {"foregrip"},
        Bone = "mini14_parent",
        Offset = {
            vpos = Vector(0, 0, 14),
            vang = Angle(90, 0, -90),
        },
        InstalledEles = {"ud_mini14_rail_fg"},
        MergeSlots = {14}
    },
    {
        PrintName = "Tactical",
        Slot = {"tac"},
        Bone = "mini14_parent",
        Offset = {
            vpos = Vector(0, -1.5, 22.3),
            vang = Angle(90, 0, -90),
        },
        InstalledEles = {"ud_mini14_clamp"},
    },
    {
        PrintName = "Magazine",
        Slot = {"ud_mini14_mag"},
        DefaultAttName = "20-Round Mag",
        DefaultAttIcon = Material("entities/att/acwatt_ud_mini14_mag_20.png", "smooth mips"),
    },
    {
        PrintName = "Stock",
        Slot = {"ud_mini14_stock"},
        DefaultAttName = "Wooden Stock",
        DefaultAttIcon = Material("entities/att/acwatt_ud_mini14_stock.png", "smooth mips"),
    },
    {
        PrintName = "Ammo Type",
        DefaultAttName = "\"FMJ\" Full Metal Jacket",
        DefaultAttIcon = Material("entities/att/arccw_uc_ammo_generic.png", "mips smooth"),
        Slot = "uc_ammo",
    },
    {
        PrintName = "Powder Load",
        Slot = "uc_powder",
        DefaultAttName = "Standard Load"
    },
    {
        PrintName = "Training Package",
        Slot = "uc_tp",
        DefaultAttName = "Basic Training"
    },
    {
        PrintName = "Internals",
        Slot = "uc_fg", -- Fire group
        DefaultAttName = "Standard Internals"
    },
    {
        PrintName = "Charm",
        Slot = {"charm", "fml_charm"},
        FreeSlot = true,
        Bone = "mini14_parent",
        Offset = {
            vpos = Vector(1.1, -0.5, 6),
            vang = Angle(90, 0, -90),
        },
    },
    {
        PrintName = "M203 slot",
        Slot = "uc_ubgl",
        Bone = "mini14_parent",
        Offset = {
            vpos = Vector(0, -1.2, 10),
            vang = Angle(90, 0, -90),
        },
        InstalledEles = {"ud_mini14_rail_fg"},
        ExcludeFlags = {"ak_noubs","barrel_rpk"},
        Hidden = true,
    }
}
--lua/weapons/arccw_ud_mk18.lua:
if !file.Exists("arccw/shared/languages/ud_en.lua","LUA") then return end

include("weapons/arccw_ud_m16.lua")

SWEP.Category = "ArcCW - UC Presets"
if GetConVar("arccw_uc_presets_categorize"):GetBool() then
    SWEP.Category = "ArcCW - UC Presets Rifles"
end

SWEP.PrintName = "AMCAR-2NG"
SWEP.TrueName = "Mk 18 Mod 0"
if GetConVar("arccw_truenames"):GetBool() then
    SWEP.PrintName = SWEP.TrueName
end

SWEP.Attachments[1].Installed = "ud_m16_rs_kac"
SWEP.Attachments[2].Installed = "ud_m16_barrel_10in"
SWEP.Attachments[3].Installed = "ud_m16_hg_tactical"
SWEP.Attachments[6].Installed = "ud_m16_receiver_auto"
SWEP.Attachments[10].Installed = "ud_m16_grip_ergo"
SWEP.Attachments[10].Installed = "ud_m16_stock_sopmod"
SWEP.Attachments[16].Installed = "ud_m16_fs_kac"

SWEP.NPCWeaponType = "weapon_smg1"
SWEP.Attachments[10].ToggleNum = 2
SWEP.Attachments[10].ToggleLock = true
--lua/weapons/arccw_ud_870.lua:
SWEP.Base = "arccw_base"
SWEP.Spawnable = true
SWEP.Category = "ArcCW - Urban Coalition"
SWEP.UC_CategoryPack = "1Urban Decay"
SWEP.AdminOnly = false
SWEP.UseHands = true

-- Muzzle and shell effects --

SWEP.MuzzleEffect = "muzzleflash_shotgun"
SWEP.ShellEffect = "arccw_uc_shelleffect"
SWEP.ShellModel = "models/weapons/arccw/uc_shells/12g.mdl"
SWEP.ShellPitch = 100
SWEP.ShellSounds = ArcCW.ShotgunShellSoundsTable
SWEP.ShellScale = 1
SWEP.UC_ShellColor = Color(0.7*255, 0.2*255, 0.2*255)

SWEP.MuzzleEffectAttachment = 1
SWEP.CaseEffectAttachment = 2
SWEP.CamAttachment = 3

-- Fake name --

SWEP.PrintName = "Express-12"

-- True name --

SWEP.TrueName = "Remington 870"

-- Trivia --

SWEP.Trivia_Class = "Shotgun"
SWEP.Trivia_Desc = "Classic pump-action shotgun, renowned for its high quality parts and assembly. A simple firearm with a simple purpose. Marketed primarily to civilians for use in hunting game and self-defense, but it has found popularity among police departments for a relatively innocuous appearance and ability to accept custom loaded less-lethal shells."
SWEP.Trivia_Manufacturer = "Mauer Armaments"
SWEP.Trivia_Calibre = "12 Gauge"
SWEP.Trivia_Mechanism = "Pump Action"
SWEP.Trivia_Country = "USA"
SWEP.Trivia_Year = 1950

-- Weapon slot --

SWEP.Slot = 3

-- Weapon's manufacturer real name --

if GetConVar("arccw_truenames"):GetBool() then
    SWEP.PrintName = SWEP.TrueName
    SWEP.Trivia_Manufacturer = "Remington Arms"
end

-- Viewmodel / Worldmodel / FOV --

SWEP.ViewModel = "models/weapons/arccw/c_ud_870.mdl"
SWEP.WorldModel = "models/weapons/arccw/c_ud_870.mdl"
SWEP.ViewModelFOV = 60
SWEP.AnimShoot = ACT_HL2MP_GESTURE_RANGE_ATTACK_SHOTGUN
SWEP.DefaultBodygroups = "000000000"

SWEP.MirrorVMWM = true
SWEP.WorldModelOffset = {
    pos        =    Vector(-5.5, 5, -5.5),
    ang        =    Angle(-12, 0, 180),
    bone    =    "ValveBiped.Bip01_R_Hand",
    scale = 1 - ( 0.35 * 0.5 )
}

-- Damage parameters --

SWEP.Damage = ArcCW.UC.StdDmg["12g_p"].max
SWEP.DamageMin = ArcCW.UC.StdDmg["12g_p"].min
SWEP.Penetration = ArcCW.UC.StdDmg["12g_p"].pen
SWEP.Num = ArcCW.UC.StdDmg["12g_p"].num

SWEP.Range = 50
SWEP.RangeMin = 5
SWEP.DamageType = DMG_BUCKSHOT
SWEP.ShootEntity = nil
SWEP.MuzzleVelocity = 200

SWEP.HullSize = 0.5

SWEP.BodyDamageMults = ArcCW.UC.BodyDamageMults_Shotgun

-- Mag size --

SWEP.ChamberSize = 1
SWEP.Primary.ClipSize = 6
SWEP.ExtendedClipSize = 8
SWEP.ReducedClipSize = 6

-- Recoil --

SWEP.Recoil = 3.1
SWEP.RecoilSide = 1

SWEP.RecoilRise = 0.24
SWEP.VisualRecoilMult = 1
SWEP.MaxRecoilBlowback = 1
SWEP.MaxRecoilPunch = 1

SWEP.Sway = 0.5

-- Firerate / Firemodes --

SWEP.Delay = 60 / 60
SWEP.Firemodes = {
    {
        PrintName = "fcg.pump",
        Mode = 1,
    },
    {
        Mode = 0
    }
}

SWEP.NoLastCycle = true
SWEP.ManualAction = true
SWEP.ShotgunReload = true

SWEP.ShootVol = 160
SWEP.ShootPitch = 100

SWEP.ProceduralRegularFire = false
SWEP.ProceduralIronFire = false

SWEP.ReloadInSights = true

-- NPC --

SWEP.NPCWeaponType = "weapon_shotgun"
SWEP.NPCWeight = 210

-- Accuracy --

SWEP.AccuracyMOA = 30
SWEP.HipDispersion = 400
SWEP.MoveDispersion = 100
SWEP.JumpDispersion = 1000

SWEP.Primary.Ammo = "buckshot"

-- Speed multipliers --

SWEP.SpeedMult = 0.9
SWEP.SightedSpeedMult = 0.75
SWEP.SightTime = 0.4
SWEP.ShootSpeedMult = 0.75

-- Length --

SWEP.BarrelLength = 32
SWEP.ExtraSightDist = 2

-- Ironsights / Customization / Poses --

SWEP.HoldtypeHolstered = "passive"
SWEP.HoldtypeActive = "ar2"
SWEP.HoldtypeSights = "rpg"

SWEP.IronSightStruct = {
     Pos = Vector(-3.66, -3, 2.2),
     Ang = Angle(-0.75, 0, 2.8),
     Magnification = 1.1,
     SwitchToSound = "",
}

SWEP.HolsterPos = Vector(2, 0, -2)
SWEP.HolsterAng = Angle(-5.5, 20, -20)

SWEP.SprintPos = Vector(-0.5, -4, -2)
SWEP.SprintAng = Angle(3.5, 7, -20)

SWEP.ActivePos = Vector(-0.75, -2, 1)
SWEP.ActiveAng = Angle(0, 0, -3)

SWEP.CrouchPos = Vector(-3.8, -2, 0)
SWEP.CrouchAng = Angle(0, 0, -30)

SWEP.BarrelOffsetSighted = Vector(0, 0, -1)
SWEP.BarrelOffsetHip = Vector(3, 0, -4)



SWEP.Malfunction = true
SWEP.MalfunctionTakeRound = true
SWEP.MalfunctionMean = 500
SWEP.MalfunctionVariance = 0.99
-- Firing sounds --

local path = ")weapons/arccw_ud/870/"
local common = ")/arccw_uc/common/"
SWEP.ShootSound = {
    path .. "fire-01.ogg",
    path .. "fire-02.ogg",
    path .. "fire-03.ogg",
    path .. "fire-04.ogg",
    path .. "fire-05.ogg",
    path .. "fire-06.ogg"
}
SWEP.ShootSoundSilenced = {
    path .. "fire-sup-01.ogg",
    path .. "fire-sup-02.ogg",
    path .. "fire-sup-03.ogg",
    path .. "fire-sup-04.ogg",
    path .. "fire-sup-05.ogg",
    path .. "fire-sup-06.ogg"
}
--[[SWEP.DistantShootSound = path .. "fire_dist.ogg"
SWEP.DistantShootSoundSilenced = common .. "sup_tail.ogg"]]
SWEP.ShootDrySound = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}

local tail = ")/arccw_uc/common/12ga/"

SWEP.DistantShootSoundOutdoors = {
    tail .. "fire-dist-12ga-pasg-ext-01.ogg",
    tail .. "fire-dist-12ga-pasg-ext-02.ogg",
    tail .. "fire-dist-12ga-pasg-ext-03.ogg",
    tail .. "fire-dist-12ga-pasg-ext-04.ogg",
    tail .. "fire-dist-12ga-pasg-ext-05.ogg",
    tail .. "fire-dist-12ga-pasg-ext-06.ogg"
}
SWEP.DistantShootSoundIndoors = {
    common .. "fire-dist-int-shotgun-01.ogg",
    common .. "fire-dist-int-shotgun-02.ogg",
    common .. "fire-dist-int-shotgun-03.ogg",
    common .. "fire-dist-int-shotgun-04.ogg",
    common .. "fire-dist-int-shotgun-05.ogg",
    common .. "fire-dist-int-shotgun-06.ogg"
}
SWEP.DistantShootSoundOutdoorsSilenced = {
    common .. "sup-tail-01.ogg",
    common .. "sup-tail-02.ogg",
    common .. "sup-tail-03.ogg",
    common .. "sup-tail-04.ogg",
    common .. "sup-tail-05.ogg",
    common .. "sup-tail-06.ogg",
    common .. "sup-tail-07.ogg",
    common .. "sup-tail-08.ogg",
    common .. "sup-tail-09.ogg",
    common .. "sup-tail-10.ogg"
}
SWEP.DistantShootSoundIndoorsSilenced = {
    common .. "fire-dist-int-pistol-light-01.ogg",
    common .. "fire-dist-int-pistol-light-02.ogg",
    common .. "fire-dist-int-pistol-light-03.ogg",
    common .. "fire-dist-int-pistol-light-04.ogg",
    common .. "fire-dist-int-pistol-light-05.ogg",
    common .. "fire-dist-int-pistol-light-06.ogg"
}
SWEP.DistantShootSoundOutdoorsVolume = 1
SWEP.DistantShootSoundIndoorsVolume = 1
SWEP.Hook_AddShootSound = ArcCW.UC.InnyOuty

SWEP.Hook_Think = ArcCW.UC.ADSReload

local shellin = {path .. "shell-insert-01.ogg", path .. "shell-insert-02.ogg", path .. "shell-insert-03.ogg"}

SWEP.Animations = {
    ["ready"] = {
        Source = "sgreload_finish_empty",
        Time = 37 / 30,
        LHIK = true,
        LHIKIn = 0,
        LHIKEaseOut = 1.2,
        LHIKOut = 1.4,
        SoundTable = {
            {s = common .. "raise.ogg", t = 0.2},
            {s = common .. "rattle.ogg", t = 0.2},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.5},
            {s = path .. "rack_1.ogg",  t = 0.4},
            {s = path .. "rack_2.ogg",  t = 0.6},
            {s = common .. "shoulder.ogg",  t = 0.9},
        },
        ProcDraw = true,
    },
    ["idle"] = {
        Source = "idle",
    },
    ["idle_empty"] = {
        Source = "idle",
    },
    ["draw"] = {
        Source = "draw",
        Time = 20 / 30,
        SoundTable = ArcCW.UC.DrawSounds,
    },
    ["holster"] = {
        Source = "holster",
        Time = 20 / 30,
        SoundTable = ArcCW.UC.HolsterSounds,
    },
    ["fire"] = {
        Source = "fire",
        --Time = 23 / 30,
        MinProgress = 8 / 30,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0, v = 0.25 }},
    },
    ["fire_iron"] = {
        Source = "fire",
        --Time = 23 / 30,
        MinProgress = 8 / 30,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0 }},
    },
    ["cycle"] = {
        Source = "cycle",
        --Time = 20 / 30,
        ShellEjectAt = 0.1,
        MinProgress = 0.26,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0},
            {s = path .. "rack_1.ogg",  t = 0},
            {s = path .. "eject.ogg",  t = 0.1},
            {s = path .. "rack_2.ogg",  t = 0.11},
        },
    },

    ["cycle_jammed"] = {
        Source = "jamcycle",
        --Time = 20 / 30,
        ShellEjectAt = 0.1,
        MinProgress = 0.26,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0},
            {s = path .. "rack_1.ogg",  t = 0},
            {s = path .. "eject.ogg",  t = 0.1},
            {s = path .. "rack_2.ogg",  t = 0.11},
        },
    },

    ["fix"] = {
        Source = "fix",
        Time = 50 / 30,
        ShellEjectAt = 0.7, -- should make the shell eject offscreen cuz the anim already has it
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.5},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 1},
            {s = path .. "rack_1.ogg",  t = 0.6},
            {s = path .. "eject.ogg",  t = 0.7},
            {s = path .. "rack_2.ogg",  t = 0.9},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 1.7},
        }
    },
    ["sgreload_start"] = {
        Source = "sgreload_start",
        Time = 16 / 30,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SHOTGUN,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKOut = 0,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0},
            {s = common .. "shoulder.ogg",  t = 0.1},
        },
    },
    ["sgreload_insert"] = {
        Source = "sgreload_insert",
        Time = 18 / 30,
        MinProgress = 0.24,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SHOTGUN,
        TPAnimStartTime = 0.3,
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0,
        SoundTable = {
            {s = shellin, t = 0},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0},
        },
    },
    ["sgreload_finish"] = {
        Source = "sgreload_finish",
        Time = 20 / 30,
        LHIK = true,
        LHIKIn = 0,
        LHIKEaseOut = 0.3,
        LHIKOut = 0.4,
        TPAnimStartTime = 0.8,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SHOTGUN,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0},
            {s = common .. "shoulder.ogg",  t = 0.27},
        },
    },
    ["sgreload_finish_empty"] = {
        Source = "sgreload_finish_empty",
        Time = 37 / 30,
        LHIK = true,
        LHIKIn = 0,
        LHIKEaseOut = 0.6,
        LHIKOut = 0.8,
        TPAnimStartTime = 0.5,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SHOTGUN,
        ShellEjectAt = 0.5,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.5},
            {s = path .. "rack_1.ogg",  t = 0.4},
            {s = path .. "eject.ogg",  t = 0.5},
            {s = path .. "rack_2.ogg",  t = 0.525},
            {s = common .. "shoulder.ogg",  t = 0.9},
        },
    },
}

SWEP.Hook_ModifyBodygroups = function(wep, data)
    local vm = data.vm
    if !IsValid(vm) then return end
    -- if wep.Attachments[1].Installed then
    --     vm:SetBodygroup(8, 2)
    -- elseif wep.Attachments[2].Installed == "ud_870_barrel_long" then
    --     vm:SetBodygroup(8, 1)
    -- else
    --     vm:SetBodygroup(8, 0)
    -- end

    -- 8rnd tube and either barrel should remove the clamp
    if vm:GetBodygroup(7) == 1 and vm:GetBodygroup(1) != 0 then
        vm:SetBodygroup(7, 2)
    end
end


SWEP.BulletBones = {
    [0] = "870_shell1",
}

SWEP.DefaultSkin = 1

-- Bodygroups --

SWEP.AttachmentElements = {
    ["ud_870_optic_ringsight"] = {
        VMBodygroups = {
            {ind = 8, bg = 1},
        },
        Override_IronSightStruct = {
            Pos = Vector(-3.665, -2.75, 2.1),
            Ang = Angle(-0.6, 0, 1),
            Magnification = 1.1,
            SwitchToSound = "",
        },
    },
    ["optic_rail"] = {
        VMBodygroups = {
            {ind = 8, bg = 2},
        }
    },
    ["ud_shotgun_rail_fg"] = {
        VMBodygroups = {{ind = 3, bg = 1}},
    },
    ["ud_870_slide_moe"] = {
        VMBodygroups = {{ind = 6, bg = 1}},
    },
    ["ud_870_slide_long"] = {
        VMBodygroups = {{ind = 6, bg = 2}},
    },
    ["ud_870_slide_poly"] = {
        VMBodygroups = {{ind = 6, bg = 3}},
    },
    ["ud_shotgun_rail_fg"] = {
        VMBodygroups = {{ind = 3, bg = 1}},
    },
    ["ud_870_barrel_long"] = {
        AttPosMods = {
            [3] = {
                vpos = Vector(-0.03, -0.65, 39.5),
            }
        },
        VMBodygroups = {
            {ind = 1, bg = 1},
        },
    },
    ["ud_870_barrel_sawnoff"] = {
        VMBodygroups = {
        {ind = 1, bg = 2},
        {ind = 7, bg = 2}
        },
        AttPosMods = {
            [3] = {
                vpos = Vector(-0.03, -0.9, 19),
            }
        },
    },
    ["ud_870_tube_reduced"] = {
        VMBodygroups = {
            {ind = 2, bg = 2},
            {ind = 7, bg = 2}
        },
    },
    ["ud_870_tube_ext"] = {
        VMBodygroups = {
            {ind = 2, bg = 1},
            {ind = 7, bg = 1}
        },
    },
    ["ud_870_stock_poly"] = {
        VMBodygroups = {{ind = 4, bg = 1}},
    },
    ["ud_870_stock_sawnoff"] = {
        VMBodygroups = {{ind = 4, bg = 2}},
    },
    ["ud_870_stock_raptor"] = {
        VMBodygroups = {{ind = 4, bg = 3}},
    },

    ["ud_870_skin_dirty"] = {
        VMSkin = 0
    },
    ["ud_870_skin_custom"] = {
        VMSkin = 3
    },
}

SWEP.Attachments = {
    {
        PrintName = "Optic",
        DefaultAttName = "Iron Sights",
        Slot = {"optic_lp","optic","optic_sniper","ud_870_optic"},
        Bone = "870_parent",
        Offset = {
            vpos = Vector(0, -1.75, -2),
            vang = Angle(90, 0, -90),
        },
        VMScale = Vector(1, 1, 1),
        CorrectiveAng = Angle(1.8, 0.1, 0),
        InstalledEles = {"optic_rail"}
    },
    {
        PrintName = "Barrel",
        DefaultAttName = "16\" Standard Barrel",
        DefaultAttIcon = Material("entities/att/acwatt_ud_870_barrel.png", "smooth mips"),
        Slot = "ud_870_barrel",
    },
    {
        PrintName = "Muzzle",
        DefaultAttName = "Standard Muzzle",
        Slot = {"choke", "muzzle_shotgun"},
        Bone = "870_parent",
        Offset = {
            vpos = Vector(-0.03, -0.75, 26.3),
            vang = Angle(90, 0, -90),
        },
    },
    {
        PrintName = "Forend",
        DefaultAttName = "Factory Forend",
        DefaultAttIcon = Material("entities/att/acwatt_ud_870_slide.png", "smooth mips"),
        Slot = {"ud_870_slide"},
        Bone = "870_slide",
        Offset = {
            vpos = Vector(3, -4.4, -29),
            vang = Angle(90, 0, -90),
        },
    },
    {
        PrintName = "Underbarrel",
        Slot = {"foregrip"},
        Bone = "870_slide",
        Offset = {
            vpos = Vector(0, 1.1, 0),
            vang = Angle(90, 0, -90),
        },
        InstalledEles = {"ud_shotgun_rail_fg"}
    },
    {
        PrintName = "Tactical",
        Slot = {"tac_pistol"},
        Bone = "870_slide",
        Offset = {
            vpos = Vector(0, 1, 4.25),
            vang = Angle(90, 0, -90),
        },
    },
    {
        PrintName = "Stock",
        DefaultAttName = "Wooden Stock",
        DefaultAttIcon = Material("entities/att/acwatt_ud_870_stock.png", "smooth mips"),
        Slot = {"ud_870_stock"},
    },
    {
        PrintName = "Tube Type",
        Slot = {"ud_870_tube"},
        DefaultAttName = "6 Shell Tube",
        DefaultAttIcon = Material("entities/att/acwatt_ud_870_tube.png", "smooth mips"),
    },
    {
        PrintName = "Ammo Type",
        DefaultAttName = "\"BUCK\" #00 Buckshot",
        DefaultAttIcon = Material("entities/att/arccw_uc_ammo_shotgun_generic.png", "mips smooth"),
        Slot = "ud_ammo_shotgun",
    },
    {
        PrintName = "Training Package",
        Slot = "uc_tp",
        DefaultAttName = "Basic Training"
    },
    {
        PrintName = "Internals",
        Slot = "uc_fg", -- Fire group
        DefaultAttName = "Standard Internals"
    },
    {
        PrintName = "Charm",
        Slot = {"charm", "fml_charm"},
        FreeSlot = true,
        Bone = "870_parent",
        Offset = {
            vpos = Vector(0.7, 0, 5),
            vang = Angle(90, 0, -90),
        },
    },
    {
        PrintName = "Skin",
        Slot = "ud_870_skin",
        DefaultAttName = "Polished Steel",
        FreeSlot = true
    }
}

local lookup_barrel = {
    default = 1,
    ud_870_barrel_long = 2,
    ud_870_barrel_sawnoff = 0,
}

local lookup_tube = {
    default = 1,
    ud_870_tube_ext = 2,
    ud_870_tube_reduced = 0,
}

SWEP.Hook_ExtraFlags = function(wep, data)

    local barrel = wep.Attachments[2].Installed and lookup_barrel[wep.Attachments[2].Installed] or lookup_barrel["default"]
    local tube = wep.Attachments[8].Installed and lookup_tube[wep.Attachments[8].Installed] or lookup_tube["default"]

    if barrel < tube then
        table.insert(data, "nomuzzleblocking")
    end
end
--lua/weapons/arccw_ud_uzi.lua:
SWEP.Base = "arccw_base"
SWEP.Spawnable = true
SWEP.Category = "ArcCW - Urban Coalition"
SWEP.UC_CategoryPack = "1Urban Decay"
SWEP.AdminOnly = false
SWEP.UseHands = true

-- Effects --

SWEP.MuzzleEffect = "muzzleflash_1"
SWEP.ShellEffect = "arccw_uc_shelleffect"
SWEP.ShellModel = "models/weapons/arccw/uc_shells/9x19.mdl"
SWEP.ShellScale = 1
--SWEP.ShellMaterial = "models/weapons/arcticcw/shell_9mm"
SWEP.ShellPitch = 100
SWEP.ShellSounds = ArcCW.PistolShellSoundsTable

SWEP.MuzzleEffectAttachment = 1
SWEP.CaseEffectAttachment = 2
SWEP.CamAttachment = 3
SWEP.TracerNum = 1
SWEP.TracerCol = Color(25, 255, 25)
SWEP.TracerWidth = 2

-- Fake name --

SWEP.PrintName = "IAL-9"

-- True name --

SWEP.TrueName = "Uzi"

-- Trivia --

SWEP.Trivia_Class = "Submachine Gun"
SWEP.Trivia_Desc = "Revolutionary submachine gun developed to arm a young State of Israel following the Second World War. Its ergonomic design, low cost, reliability, and great handling made it popular among militaries, police forces, and private security firms worldwide.\n\nBoasts excellent recoil control partially due to a below average cyclic rate. Good for hip firing in close quarters."
SWEP.Trivia_Manufacturer = "IAL Metal Industries"
SWEP.Trivia_Calibre = "9x19mm Parabellum"
SWEP.Trivia_Mechanism = "Open Bolt"
SWEP.Trivia_Country = "Israel"
SWEP.Trivia_Year = 1950

-- Weapon slot --

SWEP.Slot = 2

-- Weapon's manufacturer real name --

if GetConVar("arccw_truenames"):GetBool() then
    SWEP.PrintName = SWEP.TrueName
    SWEP.Trivia_Manufacturer = "Israeli Military Industries"
end

-- Viewmodel / Worldmodel / FOV --

SWEP.ViewModel = "models/weapons/arccw/c_ud_uzi.mdl"
SWEP.WorldModel = "models/weapons/arccw/c_ud_uzi.mdl"
SWEP.ViewModelFOV = 70
SWEP.AnimShoot = ACT_HL2MP_GESTURE_RANGE_ATTACK_AR2

-- Damage --

SWEP.Damage = ArcCW.UC.StdDmg["9mm"].max
SWEP.DamageMin = ArcCW.UC.StdDmg["9mm"].min
SWEP.Penetration = ArcCW.UC.StdDmg["9mm"].pen

SWEP.RangeMin = 15
SWEP.Range = 100 -- 4 shot until ~35m

SWEP.DamageType = DMG_BULLET
SWEP.ShootEntity = nil
SWEP.MuzzleVelocity = 400
SWEP.PhysBulletMuzzleVelocity = 400

SWEP.BodyDamageMults = ArcCW.UC.BodyDamageMults

-- Mag size --

SWEP.ChamberSize = 0
SWEP.Primary.ClipSize = 32
SWEP.ExtendedClipSize = 40
SWEP.ReducedClipSize = 16

-- Recoil --

SWEP.Recoil = 0.28
SWEP.RecoilSide = 0.35

SWEP.RecoilRise = 0.2
SWEP.RecoilPunch = 1
SWEP.VisualRecoilMult = 1
SWEP.MaxRecoilBlowback = 1
SWEP.MaxRecoilPunch = 0.6
SWEP.RecoilPunchBack = 1.5

SWEP.Sway = 0.3

-- Firerate / Firemodes --

SWEP.TriggerDelay = true

SWEP.Delay = 60 / 700
SWEP.Num = 1
SWEP.Firemodes = {
    {
        Mode = 2,
        Mult_TriggerDelayTime = 2,
    },
    {
        Mode = 1,
        Mult_TriggerDelayTime = 1,
    },
    {
        Mode = 0,
    },
}

SWEP.ShootPitch = 100
SWEP.ShootVol = 120

SWEP.ProceduralRegularFire = false
SWEP.ProceduralIronFire = false

SWEP.ReloadInSights = true

-- NPC --

SWEP.NPCWeaponType = "weapon_smg1"
SWEP.NPCWeight = 60

-- Accuracy --

SWEP.AccuracyMOA = 6
SWEP.HipDispersion = 400
SWEP.MoveDispersion = 100
SWEP.JumpDispersion = 1000

SWEP.Primary.Ammo = "pistol"
SWEP.MagID = "uzi"

SWEP.HeatCapacity = 75
SWEP.HeatDissipation = 15
SWEP.HeatDelayTime = 3

SWEP.MalfunctionMean = 200
SWEP.MalfunctionTakeRound = false

-- Speed multipliers --

SWEP.SpeedMult = 0.95
SWEP.SightedSpeedMult = 0.75
SWEP.SightTime = 0.3
SWEP.ShootSpeedMult = 0.95

-- Length --

SWEP.BarrelLength = 24
SWEP.ExtraSightDist = 7

-- Ironsights / Customization / Poses --

SWEP.HolsterPos = Vector(0.5, -2, 1)
SWEP.HolsterAng = Angle(-8.5, 8, -10)

SWEP.HoldtypeHolstered = "normal"
SWEP.HoldtypeActive = "ar2"
SWEP.HoldtypeSights = "rpg"

SWEP.IronSightStruct = {
     Pos = Vector(-2.869, -6, 1.95),
     Ang = Angle(0, 0, 0),
     Magnification = 1,
     SwitchToSound = "",
     ViewModelFOV = 55,
}

SWEP.ActivePos = Vector(0.4, -1.9, 1.4)
SWEP.ActiveAng = Angle(0, 0, -3)

SWEP.CustomizePos = Vector(5, -2, -2)
SWEP.CustomizeAng = Angle(15, 25, 0)

SWEP.CrouchPos = Vector(-3, -3, 0)
SWEP.CrouchAng = Angle(0, 0, -30)

SWEP.BarrelOffsetHip = Vector(4, 0, -4)

SWEP.MirrorVMWM = true
SWEP.WorldModelOffset = {
    pos        =    Vector(-16, 4, -3),
    ang        =    Angle(-12, 0, 180),
    bone    =    "ValveBiped.Bip01_R_Hand",
    scale = 1
}

-- Firing sounds --
local path = ")weapons/arccw_ud/uzi/"
local path1 = ")weapons/arccw_ud/glock/"
local common = ")/arccw_uc/common/"
--SWEP.FirstShootSound = path .. "fire.ogg"
--SWEP.ShootSound = path .. "fire_auto.ogg"
SWEP.ShootSoundSilenced = path1 .. "fire_supp.ogg"
SWEP.ShootDrySound = path .. "dryfire.ogg"

SWEP.ShootSound = {
    path .. "fire-01.ogg",
    path .. "fire-02.ogg",
    path .. "fire-03.ogg",
    path .. "fire-04.ogg",
    path .. "fire-05.ogg",
    path .. "fire-06.ogg"
}

local tail = ")/arccw_uc/common/9x19/"

SWEP.DistantShootSoundOutdoors = {
    tail .. "fire-dist-9x19-smg-ext-01.ogg",
    tail .. "fire-dist-9x19-smg-ext-02.ogg",
    tail .. "fire-dist-9x19-smg-ext-03.ogg",
    tail .. "fire-dist-9x19-smg-ext-04.ogg",
    tail .. "fire-dist-9x19-smg-ext-05.ogg",
    tail .. "fire-dist-9x19-smg-ext-06.ogg"
}
SWEP.DistantShootSoundIndoors = {
    common .. "fire-dist-int-pistol-01.ogg",
    common .. "fire-dist-int-pistol-02.ogg",
    common .. "fire-dist-int-pistol-03.ogg",
    common .. "fire-dist-int-pistol-04.ogg",
    common .. "fire-dist-int-pistol-05.ogg",
    common .. "fire-dist-int-pistol-06.ogg"
}
SWEP.DistantShootSoundOutdoorsSilenced = {
    common .. "sup-tail-01.ogg",
    common .. "sup-tail-02.ogg",
    common .. "sup-tail-03.ogg",
    common .. "sup-tail-04.ogg",
    common .. "sup-tail-05.ogg",
    common .. "sup-tail-06.ogg",
    common .. "sup-tail-07.ogg",
    common .. "sup-tail-08.ogg",
    common .. "sup-tail-09.ogg",
    common .. "sup-tail-10.ogg"
}
SWEP.DistantShootSoundIndoorsSilenced = {
    common .. "fire-dist-int-pistol-light-01.ogg",
    common .. "fire-dist-int-pistol-light-02.ogg",
    common .. "fire-dist-int-pistol-light-03.ogg",
    common .. "fire-dist-int-pistol-light-04.ogg",
    common .. "fire-dist-int-pistol-light-05.ogg",
    common .. "fire-dist-int-pistol-light-06.ogg"
}
SWEP.DistantShootSoundOutdoorsVolume = 1
SWEP.DistantShootSoundIndoorsVolume = 0.5
SWEP.Hook_AddShootSound = ArcCW.UC.InnyOuty

-- Bodygroups --

SWEP.BulletBones = {
    [1] = "uzi_b1", [2] = "uzi_b2", [3] = "uzi_b3", [4] = "uzi_b4"
}

SWEP.AttachmentElements = {

    ["ud_uzi_mag_20"] = {
        VMBodygroups = {{ind = 2, bg = 1}},
    },
    ["ud_uzi_mag_40"] = {
        VMBodygroups = {{ind = 2, bg = 2}},
    },
    ["ud_uzi_mag_100"] = {
        VMBodygroups = {{ind = 2, bg = 3}},
    },
    ["ud_uzi_mag_45_10"] = {
        VMBodygroups = {{ind = 2, bg = 1}},
    },
    ["ud_uzi_mag_45_22"] = {
        VMBodygroups = {{ind = 2, bg = 2}},
    },

    ["ud_uzi_rail_optic"] = {
        VMBodygroups = {{ind = 4, bg = 2}},
    },

    ["ud_uzi_clamp"] = {
        VMBodygroups = {{ind = 6, bg = 1}},
    },

    ["ud_uzi_rail_fg"] = {
        VMBodygroups = {{ind = 5, bg = 1}},
    },

    ["ud_uzi_stock_wood"] = {
        VMBodygroups = {{ind = 3, bg = 2}},
    },
    ["ud_uzi_stock_polymer"] = {
        VMBodygroups = {{ind = 3, bg = 3}},
    },
    ["ud_uzi_stock_folded"] = {
        VMBodygroups = {{ind = 3, bg = 1}},
    },
    ["ud_uzi_stock_remove"] = {
        VMBodygroups = {{ind = 3, bg = 4}},
    },

    ["ud_uzi_body_carbine"] = {
        VMBodygroups = {{ind = 1, bg = 1}},
        NameChange = "IAL-C9",
        TrueNameChange = "Uzi Carbine",
        AttPosMods = {
            [4] = {
                vpos = Vector(-0.2, 0.5, 20.8),
            },
        },
    },
    ["ud_uzi_body_mini"] = {
        VMBodygroups = {{ind = 1, bg = 2}},
        NameChange = "IAL-S9",
        TrueNameChange = "Mini Uzi",
        AttPosMods = {
            [4] = {
                vpos = Vector(-0.2, 0.5, 11.8),
            },
        },
    },
    ["ud_uzi_body_micro"] = {
        VMBodygroups = {{ind = 1, bg = 3},{ind = 4, bg = 1},{ind = 3, bg = 4}},
        NameChange = "IAL-M9",
        TrueNameChange = "Micro Uzi",
        Override_IronSightStruct = {
            Pos = Vector(-2.869, 3, 1.95),
            Ang = Angle(-0, 0.035, 0),
            Magnification = 1,
            CrosshairInSights = false
        },
        AttPosMods = {
            [1] = {
                vpos = Vector(-0.2, -1.8, -1.5),
            },
            [4] = {
                vpos = Vector(-0.2, 0.3, 7.8),
            },
            [6] = {
                vpos = Vector(-0.25, 1.4, 6),
                vang = Angle(90, 0, -90),
            },
        },
    },
    ["ud_uzi_body_civvy"] = {
        VMBodygroups = {{ind = 1, bg = 4}},
        NameChange = "IAL-C9 Model GB",
        TrueNameChange = "Uzi Action-B",
        AttPosMods = {
            [4] = {
                vpos = Vector(-0.2, 0.5, 23.8),
            },
        },
    },
}

SWEP.Hook_ModifyBodygroups = function(wep, data)
    local vm = data.vm
    if !IsValid(vm) then return end
    local barrel = wep.Attachments[2].Installed
    if barrel == "ud_uzi_body_micro" then
        if wep.Attachments[1].Installed then
            vm:SetBodygroup(4, 3)
        end
        if wep.Attachments[6].Installed then
            vm:SetBodygroup(6, 0)
            vm:SetBodygroup(5, 2)
        end
    end
end

-- Animations --

SWEP.Hook_Think = ArcCW.UC.ADSReload

SWEP.Animations = {
    ["ready"] = {
        Source = "fix",
        Time = 40 / 30,
        ShellEjectAt = false,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = common .. "raise.ogg", t = 0},
            {s = common .. "rattle.ogg", t = 0.2},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.15},
            {s = path .. "chback.ogg",         t = 0.3, c = ci},
            {s = path .. "chforward.ogg",         t = 0.65, c = ci},
        },
        ProcDraw = true,
    },
    ["idle"] = {
        Source = "idle",
    },
    ["idle_empty"] = {
        Source = "idle_empty",
    },
    ["draw"] = {
        Source = "draw",
        SoundTable = ArcCW.UC.DrawSounds,
    },
    ["draw_empty"] = {
        Source = "draw_empty",
        SoundTable = ArcCW.UC.DrawSounds,
    },
    ["holster"] = {
        Source = "holster",
        Time = 0.25,
        SoundTable = ArcCW.UC.HolsterSounds,
    },
    ["holster_empty"] = {
        Source = "holster_empty",
        Time = 0.25,
        SoundTable = ArcCW.UC.HolsterSounds,
    },
    ["fire"] = {
        Source = "fire",
        Time = 13 / 30,
        ShellEjectAt = 0.03,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg"}, t = 0, v = 0.25 }},
    },
    ["fire_iron"] = {
        Source = "fire",
        Time = 13 / 30,
        ShellEjectAt = 0.03,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg"}, t = 0 }},
    },
    ["fire_empty"] = {
        Source = "fire_empty",
        Time = 13 / 30,
        ShellEjectAt = 0.03,
        SoundTable = {{ s = path .. "chforward.ogg", t = 0 }},
    },

    ["trigger"] = {
        Source = "idle",
        Time = 0.025,
        SoundTable = {
            {s = path .. "prefire.ogg",         t = 0, c = ci},
        },
    },
    ["trigger_empty"] = {
        Source = "idle",
        Time = 0,
        SoundTable = nil,
    },

    ["fix"] = {
        Source = "fix",
        Time = 40 / 30,
        ShellEjectAt = false,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.15},
            {s = path .. "chback.ogg",         t = 0.3, c = ci},
            {s = path .. "chforward.ogg",         t = 0.65, c = ci},
        },
    },
    ["fix_empty"] = {
        Source = "fix_empty",
        Time = 40 / 30,
        ShellEjectAt = false,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.15},
            {s = path .. "chback.ogg",         t = 0.3, c = ci},
            {s = path .. "chforward.ogg",         t = 0.65, c = ci},
        },
    },

    ["fix_micro"] = {
        Source = "fix_micro",
        Time = 40 / 30,
        ShellEjectAt = false,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.15},
            {s = path .. "chback.ogg",         t = 0.3, c = ci},
            {s = path .. "chforward.ogg",         t = 0.65, c = ci},
        },
    },
    ["fix_empty_micro"] = {
        Source = "fix_empty_micro",
        Time = 40 / 30,
        ShellEjectAt = false,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.15},
            {s = path .. "chback.ogg",         t = 0.3, c = ci},
            {s = path .. "chforward.ogg",         t = 0.65, c = ci},
        },
    },

    -- 32 Round Reloads --

    ["reload"] = {
        Source = "reload",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        Time = 67 / 30,
        MinProgress = 1.2,
        LastClip1OutTime = 67 / 30,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.6,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0},
            {s = common .. "magpouch.ogg", t = 0.025},
            {s = path .. "magout.ogg",        t = 0.25, c = ci},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.25},
            {s = path .. "magin.ogg",         t = 0.55, c = ci},
            {s = common .. "magpouchin.ogg", t = 1.35, v = .35},
            {s = common .. "shoulder.ogg",  t = 1.75},
        },
    },
    ["reload_empty"] = {
        Source = "reload_empty",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        Time = 90 / 30,
        MinProgress = 2.2,
        LastClip1OutTime = 1.8,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.3,
        LHIKEaseOut = 0.2,
        LHIKOut = 0.55,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0},
            {s = path .. "magout.ogg",        t = 0.4, c = ci},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.25},
            {s = common .. "magpouch.ogg", t = 0.85},
            {s = common .. "magdrop_smg.ogg",  t = 1.0},
            {s = path .. "magin.ogg",         t = 1.1, c = ci},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 1.25},
            {s = path .. "chback.ogg",         t = 1.935, c = ci},
            {s = path .. "chforward.ogg",         t = 2.15, c = ci},
            {s = common .. "shoulder.ogg",  t = 2.6},
        },
    },

    -- 16 Round Reloads --

    ["reload_16"] = {
        Source = "reload_16",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        Time = 67 / 30,
        MinProgress = 1.2,
        LastClip1OutTime = 67 / 30,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.6,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0},
            {s = common .. "magpouch.ogg", t = 0.025},
            {s = path .. "magout.ogg",        t = 0.25, c = ci},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.25},
            {s = path .. "magin.ogg",         t = 0.55, c = ci},
            {s = common .. "magpouchin.ogg", t = 1.35, v = .35},
            {s = common .. "shoulder.ogg",  t = 1.75},
        },
    },
    ["reload_empty_16"] = {
        Source = "reload_empty_16",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        Time = 90 / 30,
        MinProgress = 2.2,
        LastClip1OutTime = 1.8,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.3,
        LHIKEaseOut = 0.2,
        LHIKOut = 0.55,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0},
            {s = path .. "magout.ogg",        t = 0.4, c = ci},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.25},
            {s = common .. "magpouch.ogg", t = 0.85},
            {s = common .. "magdrop_smg.ogg",  t = 1.0},
            {s = path .. "magin.ogg",         t = 1.1, c = ci},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 1.25},
            {s = path .. "chback.ogg",         t = 1.947, c = ci},
            {s = path .. "chforward.ogg",         t = 2.15, c = ci},
            {s = common .. "shoulder.ogg",  t = 2.45},
        },
    },

    -- 41 Round Reloads --

    ["reload_41"] = {
        Source = "reload_41",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        Time = 67 / 30,
        MinProgress = 1.2,
        LastClip1OutTime = 67 / 30,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.6,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0},
            {s = common .. "magpouch.ogg", t = 0.025},
            {s = path .. "magout.ogg",        t = 0.35, c = ci},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.25},
            {s = path .. "magin.ogg",         t = 0.65, c = ci},
            {s = common .. "magpouchin.ogg", t = 1.35, v = .35},
            {s = common .. "shoulder.ogg",  t = 1.75},
        },
    },
    ["reload_empty_41"] = {
        Source = "reload_empty_41",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        Time = 90 / 30,
        MinProgress = 2.2,
        LastClip1OutTime = 1.8,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.3,
        LHIKEaseOut = 0.2,
        LHIKOut = 0.55,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0},
            {s = path .. "magout.ogg",        t = 0.4, c = ci},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.25},
            {s = common .. "magpouch.ogg", t = 0.85},
            {s = common .. "magdrop_smg.ogg",  t = 1.0},
            {s = path .. "magin.ogg",         t = 1.1, c = ci},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 1.25},
            {s = path .. "chback.ogg",         t = 1.947, c = ci},
            {s = path .. "chforward.ogg",         t = 2.15, c = ci},
            {s = common .. "shoulder.ogg",  t = 2.6},
        },
    },

    -- 100 Round Reloads --

    ["reload_100"] = {
        Source = "reload_100",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        Time = 67 / 30,
        MinProgress = 1.6,
        LastClip1OutTime = 1,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0},
            {s = path .. "magout.ogg",        t = 0.25, c = ci},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.25},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.75},
            {s = path .. "magin.ogg",         t = 1.15, c = ci},
            {s = common .. "cloth_4.ogg",  t = 1.65},
            {s = common .. "shoulder.ogg",  t = 1.95},
        },
    },
    ["reload_empty_100"] = {
        Source = "reload_empty_100",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        Time = 90 / 30,
        MinProgress = 2.4,
        LastClip1OutTime = 1.8,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.3,
        LHIKEaseOut = 0.2,
        LHIKOut = 0.55,
        SoundTable = {
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0},
            {s = path .. "magout.ogg",        t = 0.25, c = ci},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.25},
            {s = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}, t = 0.75},
            {s = common .. "magdrop.ogg",  t = 1.0},
            {s = path .. "magin.ogg",         t = 1.15, c = ci},
            {s = common .. "cloth_4.ogg",  t = 1.65},
            {s = path .. "chback.ogg",         t = 2.0, c = ci},
            {s = path .. "chforward.ogg",         t = 2.25, c = ci},
            {s = common .. "shoulder.ogg",  t = 2.7},
        },
    },
}

SWEP.AutosolveSourceSeq = "idle"

SWEP.Attachments = {
    {
        PrintName = "Optic",
        DefaultAttName = "Iron Sights",
        Slot = {"optic_lp","optic"}, -- ,"optic"
        Bone = "uzi_parent",
        Offset = {
            vpos = Vector(-0.2, -1.55, -0.5),
            vang = Angle(90, 0, -90),
        },
        InstalledEles = {"ud_uzi_rail_optic"}
    },
    {
        PrintName = "Barrel",
        DefaultAttName = "10\" Standard Barrel",
        DefaultAttIcon = Material("entities/att/acwatt_ud_uzi_body.png", "smooth mips"),
        Slot = "ud_uzi_frame",
        Bone = "uzi_parent",
        Offset = {
            vpos = Vector(2.6, -3.7, -17.3),
            vang = Angle(90, 0, -90),
        },
    },
    {
        PrintName = "Caliber",
        DefaultAttName = "9x19mm Parabellum",
        DefaultAttIcon = Material("entities/att/uc_bullets/9x19.png", "smooth mips"),
        Slot = "ud_uzi_caliber",
    },
    {
        PrintName = "Muzzle",
        DefaultAttName = "Standard Muzzle",
        Slot = {"muzzle"},
        Bone = "uzi_parent",
        Offset = {
            vpos = Vector(-0.2, 0.5, 14.8),
            vang = Angle(90, 0, -90),
        },
    },
    {
        PrintName = "Underbarrel",
        Slot = {"foregrip"},
        Bone = "uzi_parent",
        Offset = {
            vpos = Vector(-0.2, 1.85, 6.9), -- nice
            vang = Angle(90, 0, -90),
        },
        InstalledEles = {"ud_uzi_rail_fg"},
        ExcludeFlags = {"micro"}
    },
    {
        PrintName = "Tactical",
        Slot = {"tac_pistol"},
        Bone = "uzi_parent",
        Offset = {
            vpos = Vector(-1.35, 0.9,5.8),
            vang = Angle(90, 0, 180),
        },
        InstalledEles = {"ud_uzi_clamp"}
    },
    {
        PrintName = "Stock",
        Slot = {"ud_uzi_stock"},
        DefaultAttName = "Folding Stock",
        DefaultAttIcon = Material("entities/att/acwatt_ud_uzi_stock.png", "smooth mips"),
        ExcludeFlags = {"micro"},
    },
    {
        PrintName = "Magazine",
        Slot = {"ud_uzi_mag"},
        DefaultAttName = "32-Round Mag",
        DefaultAttIcon = Material("entities/att/acwatt_ud_uzi_mag_32.png", "smooth mips"),
    },
    {
        PrintName = "Ammo Type",
        DefaultAttName = "\"FMJ\" Full Metal Jacket",
        DefaultAttIcon = Material("entities/att/arccw_uc_ammo_generic.png", "mips smooth"),
        Slot = "uc_ammo",
    },
    {
        PrintName = "Powder Load",
        Slot = "uc_powder",
        DefaultAttName = "Standard Load"
    },
    {
        PrintName = "Training Package",
        Slot = "uc_tp",
        DefaultAttName = "Basic Training"
    },
    {
        PrintName = "Internals",
        Slot = "uc_fg", -- Fire group
        DefaultAttName = "Standard Internals"
    },
    {
        PrintName = "Charm",
        Slot = {"charm", "fml_charm"},
        FreeSlot = true,
        Bone = "uzi_parent",
        Offset = {
            vpos = Vector(0.4, 1.3, 2.3),
            vang = Angle(90, 0, -90),
        },
    },
}

--lua/weapons/arccw_ur_ak101.lua:
if !file.Exists("arccw/shared/sh_1_ur.lua","LUA") then return end

include("weapons/arccw_ur_ak.lua")

SWEP.Category = "ArcCW - UC Presets"
if GetConVar("arccw_uc_presets_categorize"):GetBool() then
    SWEP.Category = "ArcCW - UC Presets Rifles"
end

SWEP.PrintName = "KF-45" -- make this something russian and cool
SWEP.TrueName = "AK-101"
if GetConVar("arccw_truenames"):GetBool() then
    SWEP.PrintName = SWEP.TrueName
end

SWEP.Attachments[3].Installed = "ur_ak_hg_74m"
SWEP.Attachments[5].Installed = "ur_ak_cal_556"
SWEP.Attachments[9].Installed = "ur_ak_grip_alpha"
SWEP.Attachments[10].Installed = "ur_ak_stock_ak74m"
SWEP.Attachments[15].Installed = "ur_ak_cover_smooth"

SWEP.Attachments[3].ToggleLock = true
SWEP.Attachments[10].ToggleLock = true
--lua/weapons/arccw_ur_aks74.lua:
return gluapack()()
--lua/weapons/arccw_ur_annihilator.lua:
if !file.Exists("arccw/shared/sh_1_ur.lua","LUA") then return end

include("weapons/arccw_ur_deagle.lua")

SWEP.Category = "ArcCW - UC Presets"
if GetConVar("arccw_uc_presets_categorize"):GetBool() then
    SWEP.Category = "ArcCW - UC Presets Pistols"
end

SWEP.PrintName = "Annihilator"

SWEP.Attachments[1].Installed = "uc_optic_annihilator"
SWEP.Attachments[2].Installed = "ur_deagle_barrel_annihilator"
--lua/weapons/arccw_ur_aw.lua:
SWEP.Base = "arccw_base"
SWEP.Spawnable = true -- this obviously has to be set to true
SWEP.Category = "ArcCW - Urban Coalition" -- edit this if you like
SWEP.UC_CategoryPack = "2Urban Renewal"
SWEP.AdminOnly = false

SWEP.PrintName = "AWP"

SWEP.Trivia_Class = "Sniper Rifle"
SWEP.Trivia_Desc = "A heavy rifle purpose-built for extreme range combat under extreme climates, first developed for the British military but quickly adopted by many more. Iconic for its appearance among military and police marksmen, this rifle is a symbol of discipline and order.\n\nOffers outstanding precision and kill potential, but its long bolt pull and reload time can become a hinderance outside its ideal engagement range.\n\nOne shot. One kill. You know the routine."
SWEP.Trivia_Manufacturer = "Accuracy International"
SWEP.Trivia_Calibre = "7.62x51mm NATO"
SWEP.Trivia_Mechanism = "Bolt Action"
SWEP.Trivia_Country = "United Kingdom"
SWEP.Trivia_Year = 1982

if !GetConVar("arccw_truenames"):GetBool() then
    SWEP.PrintName = "Apex Precision"
    SWEP.Trivia_Manufacturer = "Marksman Institute"
end


SWEP.Slot = 3
SWEP.CamAttachment = 3

SWEP.UseHands = true

SWEP.ViewModel = "models/weapons/arccw/c_ur_aw.mdl"
SWEP.WorldModel = "models/weapons/arccw/c_ur_aw.mdl"
SWEP.ViewModelFOV = 70

SWEP.DefaultBodygroups = "000000000000"

SWEP.BulletBones = {
    --[1] = "top_round",
    [2] = "mag_round",
}

-- Damage --

SWEP.Damage = 80 -- 2 shot close range
SWEP.DamageMin = 50 -- 2 shot long range
SWEP.RangeMin = 100
SWEP.Range = 400 -- 2 shot at ~300m

SWEP.Penetration = 18
SWEP.DamageType = DMG_BULLET
SWEP.ShootEntity = nil
SWEP.MuzzleVelocity = 850
SWEP.PhysBulletMuzzleVelocity = 850

SWEP.BodyDamageMults = ArcCW.UC.BodyDamageMults

-- Mag size --

SWEP.ChamberSize = 1
SWEP.Primary.ClipSize = 5
SWEP.ExtendedClipSize = 10
SWEP.ReducedClipSize = 5

-- Recoil --

SWEP.Recoil = 1.75
SWEP.RecoilSide = 0.75

SWEP.RecoilRise = 0.6
SWEP.RecoilPunch = 0.3
SWEP.VisualRecoilMult = 5
SWEP.MaxRecoilBlowback = 4
SWEP.MaxRecoilPunch = 4
SWEP.RecoilPunchBack = 3
SWEP.RecoilPunchBackMax = 3.5
SWEP.RecoilPunchBackMaxSights = 2.5

SWEP.Sway = 0.2

-- Firerate / Firemodes --

SWEP.Delay = 60 / 80
SWEP.Num = 1
SWEP.Firemodes = {
    {
        PrintName = "fcg.bolt",
        Mode = 1,
    },
    {
        Mode = 0,
    },
}

SWEP.ShootPitch = 100
SWEP.ShootVol = 120

SWEP.ProceduralRegularFire = false
SWEP.ProceduralIronFire = false

SWEP.ReloadInSights = true

-- NPC --

SWEP.NPCWeaponType = "weapon_crossbow"
SWEP.NPCWeight = 60

-- Accuracy --

SWEP.AccuracyMOA = .25
SWEP.HipDispersion = 1250
SWEP.MoveDispersion = 500
SWEP.JumpDispersion = 700 -- tactical unrealism    set to 700 later

SWEP.Primary.Ammo = "ar2"
SWEP.MagID = "awp"

SWEP.HeatCapacity = 75
SWEP.HeatDissipation = 15
SWEP.HeatDelayTime = 3

-- SWEP.Malfunction = true
SWEP.MalfunctionMean = 200
--SWEP.MeleeTime = 1.5

-- Speed multipliers --

SWEP.SpeedMult = 0.8
SWEP.SightedSpeedMult = 0.625
SWEP.SightTime = 0.35
SWEP.ShootSpeedMult = 0.625

local path = ")weapons/arccw_ur/ak/"

local testpath = ")weapons/arccw_ur/aw_placeholders/"
local path1 = ")weapons/arccw_ur/aw_placeholders/338/"

local path1 = ")weapons/arccw_ur/mp5/"
local common = ")/arccw_uc/common/"
local rottle = {common .. "cloth_1.ogg", common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}
local ratel = {common .. "rattle1.ogg", common .. "rattle2.ogg", common .. "rattle3.ogg"}
local rutle = {common .. "movement-sniper-03.ogg",common .. "movement-sniper-04.ogg"}

SWEP.ShootSound = {
    testpath .. "fire-01.ogg",
    testpath .. "fire-02.ogg",
    testpath .. "fire-03.ogg",
    testpath .. "fire-04.ogg",
    testpath .. "fire-05.ogg",
    testpath .. "fire-06.ogg"
}
SWEP.ShootSoundSilenced = {
    testpath .. "fire-sup-01.ogg",
    testpath .. "fire-sup-02.ogg",
    testpath .. "fire-sup-03.ogg",
    testpath .. "fire-sup-04.ogg",
    testpath .. "fire-sup-05.ogg",
    testpath .. "fire-sup-06.ogg"
}
SWEP.DistantShootSound = nil
SWEP.DistantShootSoundSilenced = nil
SWEP.ShootDrySound = testpath .. "dryfire.ogg"

local tail = ")/arccw_uc/common/308/"

SWEP.DistantShootSoundOutdoors = {
    tail .. "fire-dist-308-rif-ext-01.ogg",
    tail .. "fire-dist-308-rif-ext-02.ogg",
    tail .. "fire-dist-308-rif-ext-03.ogg",
    tail .. "fire-dist-308-rif-ext-04.ogg",
    tail .. "fire-dist-308-rif-ext-05.ogg",
    tail .. "fire-dist-308-rif-ext-06.ogg"
}
SWEP.DistantShootSoundIndoors = {
    common .. "fire-dist-int-shotgun-01.ogg",
    common .. "fire-dist-int-shotgun-02.ogg",
    common .. "fire-dist-int-shotgun-03.ogg",
    common .. "fire-dist-int-shotgun-04.ogg",
    common .. "fire-dist-int-shotgun-05.ogg",
    common .. "fire-dist-int-shotgun-06.ogg"
}
SWEP.DistantShootSoundOutdoorsSilenced = {
    common .. "sup-tail-01.ogg",
    common .. "sup-tail-02.ogg",
    common .. "sup-tail-03.ogg",
    common .. "sup-tail-04.ogg",
    common .. "sup-tail-05.ogg",
    common .. "sup-tail-06.ogg",
    common .. "sup-tail-07.ogg",
    common .. "sup-tail-08.ogg",
    common .. "sup-tail-09.ogg",
    common .. "sup-tail-10.ogg"
}
SWEP.DistantShootSoundIndoorsSilenced = {
    common .. "fire-dist-int-pistol-light-01.ogg",
    common .. "fire-dist-int-pistol-light-02.ogg",
    common .. "fire-dist-int-pistol-light-03.ogg",
    common .. "fire-dist-int-pistol-light-04.ogg",
    common .. "fire-dist-int-pistol-light-05.ogg",
    common .. "fire-dist-int-pistol-light-06.ogg"
}
SWEP.DistantShootSoundOutdoorsVolume = 1
SWEP.DistantShootSoundIndoorsVolume = 1
SWEP.Hook_AddShootSound = ArcCW.UC.InnyOuty

SWEP.MuzzleEffect = "muzzleflash_ak47"
SWEP.ShellEffect = "arccw_uc_shelleffect"
SWEP.ShellModel = "models/weapons/arccw/uc_shells/556x45.mdl"
SWEP.ShellPitch = 90
SWEP.ShellScale = 1.145
SWEP.ShellRotateAngle = Angle(0, 0, 0)

SWEP.ManualAction = true
-- SWEP.ManualAction = false
SWEP.NoLastCycle = true

SWEP.MuzzleEffectAttachment = 1 -- which attachment to put the muzzle on
SWEP.CaseEffectAttachment = 2 -- which attachment to put the case effect on

SWEP.IronSightStruct = {
    Pos = Vector(-3.37, -5, 0.68),
    Ang = Angle(0, 0, 2),
    Magnification = 1.1,
    SwitchToSound = "", -- sound that plays when switching to this sight
    CrosshairInSights = false
}
SWEP.LaserOffsetAngle = Angle(0, 0, 0)
SWEP.LaserIronsAngle = Angle(0, 1.5, 0)

SWEP.HoldtypeHolstered = "passive"
SWEP.HoldtypeActive = "ar2"
SWEP.HoldtypeSights = "rpg"

SWEP.AnimShoot = ACT_HL2MP_GESTURE_RANGE_ATTACK_AR2

SWEP.ActivePos = Vector(-0.1, 0.1, 0.2)
SWEP.ActiveAng = Angle(0, 0, -1)

SWEP.SprintPos = Vector(-1, -1, 1.2)
SWEP.SprintAng = Angle(-15, 8, -10)

SWEP.CrouchPos = Vector(-2, -2, -0.8)
SWEP.CrouchAng = Angle(0, 0, -14)

SWEP.HolsterPos = Vector(-1, -1, 1.2)
SWEP.HolsterAng = Angle(-15, 8, -10)

SWEP.BarrelOffsetSighted = Vector(0, 0, 0)
SWEP.BarrelOffsetHip = Vector(0, 0, 0)

SWEP.CustomizePos = Vector(0, 0, 0)
SWEP.CustomizeAng = Angle(0, 0, 0)

-- SWEP.CustomizePos = Vector(6.5, 0.8, -0.2)
-- SWEP.CustomizeAng = Angle(8, 18, 15)

SWEP.BarrelLength = 54

SWEP.AttachmentElements = {
    ["barrel_long"] = {
        VMBodygroups = {{ind = 2, bg = 1}},
        AttPosMods = {[3] = {
            vpos = Vector(0, 40, 1.75),
            vang = Angle(0, 270, 0),
        }}
    },
    ["barrel_short"] = {
        VMBodygroups = {{ind = 2, bg = 2}},
        AttPosMods = {[3] = {
            vpos = Vector(0, 28, 1.75),
            vang = Angle(0, 270, 0),
        }}
    },
    ["barrel_sd"] = {
        VMBodygroups = {{ind = 2, bg = 3}}
    },

    ["mag_338"] = {
        --VMBodygroups = {{ind = 3, bg = 2}}
    },
    ["mag_300"] = {
        --VMBodygroups = {{ind = 3, bg = 2}}
    },
    ["mag_ext"] = {
        --VMBodygroups = {{ind = 3, bg = 1}}
    },
    ["mag_ext_magnum"] = {
        --VMBodygroups = {{ind = 3, bg = 3}}
    },

    ["rail_bottom"] = {
        VMBodygroups = {{ind = 6, bg = 1}}
    },
    ["rail_top"] = {
        VMBodygroups = {{ind = 7, bg = 1}}
    },
    ["sights_compact"] = {
        VMBodygroups = {{ind = 8, bg = 2}},
        Override_IronSightStruct = {
            Pos = Vector(-3.395, -5, 1.35),
            Ang = Angle(0, 0, 2),
            Magnification = 1,
        }
    },
    ["sights_flipped"] = {
        VMBodygroups = {{ind = 8, bg = 1}}
    },

    ["skin_black"] = {
        VMSkin = 1
    },
    ["skin_tan"] = {
        VMSkin = 2
    },
    ["skin_cust"] = {
        VMSkin = 3
    },

    ["stock_at"] = {
        VMBodygroups = {{ind = 4, bg = 1}}
    },
    ["stock_ru"] = {
        VMBodygroups = {{ind = 4, bg = 2}}
    },
    ["stock_ru_rubber"] = {
        VMBodygroups = {{ind = 4, bg = 3}}
    },
    ["stock_fixed"] = {
        VMBodygroups = {
            {ind = 4, bg = 4},
            {ind = 5, bg = 1},
        }
    },
    ["stock_none"] = {
        VMBodygroups = {
            {ind = 4, bg = 5},
        }
    },
}

SWEP.ExtraSightDist = 2
SWEP.GuaranteeLaser = true

SWEP.WorldModelOffset = {
    pos = Vector(-7, 5, -4.8),
    ang = Angle(-12, 0, 180)
}

SWEP.MirrorVMWM = true

SWEP.Attachments = {
    {
        PrintName = "Optic",
        DefaultAttName = "Iron Sights",
        DefaultAttIcon = Material("entities/att/ur_aw/ironsights.png", "mips smooth"),
        Slot = {"optic","optic_lp","optic_sniper"},
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(0, 6, 2.65),
            vang = Angle(0, -90, 0),
        },
        CorrectivePos = Vector(0, 0, 0),
        CorrectiveAng = Angle(0, 180, 0),
        VMScale = Vector(1.05, 1.05, 1.05),
        SlideAmount = {
            vmin = Vector(0, 5.5, 2.65),
            vmax = Vector(0, 7, 2.65),
        },
    },
    {
        PrintName = "Barrel",
        DefaultAttName = "24\" Police Barrel",
        DefaultAttIcon = Material("entities/att/ur_aw/bar_def.png", "mips smooth"),
        Slot = "ur_aw_barrel",
    },
    {
        PrintName = "Muzzle",
        DefaultAttName = "Standard Muzzle",
        Slot = {"muzzle","ur_aw_muzzle"},
        Bone = "tag_weapon",
        VMScale = Vector(1.5, 1.5, 1.5),
        WMScale = VMScale,
        Offset = {
            vpos = Vector(0, 35.2, 1.675),
            vang = Angle(0, 270, 0),
        },
        ExcludeFlags = {"barrel_sd"},
        Installed = "ur_aw_muzzle_brake",
    },
    {
        PrintName = "Caliber",
        DefaultAttName = "7.62x51mm NATO",
        DefaultAttIcon = Material("entities/att/uc_bullets/762x51.png", "mips smooth"),
        Slot = {"ur_aw_cal"},
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(2.8, -4.2, -11.5),
            vang = Angle(90, 0, -90),
        },
    },
    {
        PrintName = "Magazine",
        Slot = {"ur_aw_mag"},
        DefaultAttName = "5-Round Mag",
        DefaultAttIcon = Material("entities/att/ur_aw/mag308_5.png", "mips smooth"),
        ExcludeFlags = {"mag_338"}
    },
    {
        PrintName = "Underbarrel",
        Slot = {"foregrip"},
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(0,16, -.6),
            vang = Angle(90, -90, -90),
        },
        VMScale = Vector(1, 1, 1),
        InstalledEles = {"rail_bottom"},
    },
    {
        PrintName = "Tactical",
        Slot = {"tac"},
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(-1.2, 16, 1.1),
            vang = Angle(-90, 270, 0),
        },
        GivesFlags = {"tac"},
        InstalledEles = {"rail_top"}
    },
    {
        PrintName = "Stock",
        Slot = {"ur_aw_stock"},
        DefaultAttName = "Factory Stock",
        DefaultAttIcon = Material("entities/att/ur_aw/stock_def.png", "mips smooth"),
    },
    {
        PrintName = "Ammo Type",
        DefaultAttName = "\"FMJ\" Full Metal Jacket",
        DefaultAttIcon = Material("entities/att/arccw_uc_ammo_generic.png", "mips smooth"),
        Slot = "uc_ammo",
        HideIfBlocked = true
    },
    {
        PrintName = "Powder Load",
        Slot = "uc_powder",
        DefaultAttName = "Standard Load"
    },
    {
        PrintName = "Training Package",
        Slot = "uc_tp",
        DefaultAttName = "Basic Training"
    },
    {
        PrintName = "Internals",
        Slot = "uc_fg", -- Fire group
        DefaultAttName = "Standard Internals"
    },
    {
        PrintName = "Charm",
        Slot = {"charm", "fml_charm"},
        FreeSlot = true,
        Bone = "tag_weapon",
        Offset = {
            vpos = Vector(.85, 4.6, 0.5),
            vang = Angle(90, -90, -90),
        },
    },
    {
        PrintName = "Finish",
        Slot = {"ur_aw_skin"},
        FreeSlot = true,
        DefaultAttName = "Olive Drab",
        DefaultAttIcon = Material("entities/att/ur_aw/skin_green.png", "mips smooth"),
    }
}


function SWEP:Hook_TranslateAnimation(anim)

end

SWEP.Hook_NameChange = function(wep,name)
    local atts = wep.Attachments
    local barr = string.Replace(atts[2].Installed or "default", "ur_aw_barrel_", "")
    local cal = string.Replace(atts[4].Installed or "default", "ur_aw_cal_", "")
    local stock = string.Replace(atts[8].Installed or "default", "ur_aw_stock_", "")

    if GetConVar("arccw_truenames"):GetBool() then
        if cal ~= "default" then
            return "AWM"
        elseif barr == "sd" then
            return "AWS"
        elseif stock == "at" then
            return "AT"
        end
    else
        if cal == "338" then
            return "Apex Magnum"
        elseif barr == "sd" then
            return "Apex Spectre"
        elseif stock == "at" then
            return "Apex Tactical"
        end
    end
end

SWEP.Hook_ModifyBodygroups = function(wep, data)
    local vm = data.vm
    if !IsValid(vm) then return end

    local atts = wep.Attachments
    local cal = string.Replace(atts[4].Installed or "default", "ur_aw_cal_", "")
    local mag = string.Replace(atts[5].Installed or "default", "ur_aw_mag_", "")
    local flags = wep:GetWeaponFlags()

    local pistolGrip = table.HasValue(flags,"pistolgrip")

    if cal ~= "default" then
        if pistolGrip then
            vm:SetBodygroup(1,3)
        else
            vm:SetBodygroup(1,1)
        end
    elseif pistolGrip then
        vm:SetBodygroup(1,2)
    else
        vm:SetBodygroup(1,0)
    end

    if atts[1].Installed then
        if table.HasValue(flags,"sights_compact") then
            vm:SetBodygroup(8,3)
        else
            vm:SetBodygroup(8,1)
        end
    end

    if mag == "10" then
        vm:SetBodygroup(3,1)
    elseif mag == "10m" then
        vm:SetBodygroup(3,3)
    elseif cal ~= "default" then
        vm:SetBodygroup(3,2)
    end
end

SWEP.Animations = {
    ["ready"] = {
        Source = "cycle",
         Time = 1.47,
        MinProgress = 1.3,
        SoundTable = {
            {s = ratel,                             t = 0.07},
            {s = testpath .. "boltup.ogg",          t = 0.1},
            {s = testpath .. "boltback.ogg",        t = 0.2},
            {s = testpath .. "boltforward.ogg",     t = 0.32},
            {s = testpath .. "boltdown.ogg",        t = 0.6},
        },
        ProcDraw = true,
    },
    ["idle"] = {
        Source = "idle"
    },
    ["idle_empty"] = {
        Source = "idle_empty"
    },
    ["draw"] = {
        Source = "draw",
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 0.5,
        Time = 35 / 30,
        MinProgess = .5,
        SoundTable = {
            {s = ratel, t = 0},
            {s = common .. "raise.ogg", t = 0.2},
        },
    },
    ["holster"] = {
        Source = "holster",
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 0.5,
        Time = .75,
        SoundTable = {
            {s = ratel, t = 0},
        },
    },
    ["draw_empty"] = {
        Source = "draw_empty",
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 35 / 30,
        SoundTable = {
            {s = ratel, t = 0},
            {s = common .. "raise.ogg", t = 0.2},
        },
    },
    ["holster_empty"] = {
        Source = "holster_empty",
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 0.5,
        SoundTable = {
            {s = ratel, t = 0},
        },
    },
    ["fire"] = {
        Source = {"fire"},
        Time = 27 / 30,
        MinProgress = 0.2,
        SoundTable = {
            SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0, v = 0.25 }},
        },
    },

    ["fire_iron"] = {
        Source = {"fire_iron"},
        Time = 27 / 30,
        MinProgress = 0.2,
        SoundTable = {
            SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0 }},
        },
    },

    ["reload"] = {
        Source = "reload",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 1,
        Time = 85 / 30,
        LHIKEaseOut = 0.25,
        MinProgress = 1.5,
        SoundTable = {
            {s = rottle,                             t = 0.1},
            {s = testpath .. "magrel.ogg", 	t = 0.2},
            {s = testpath .. "magout.ogg",          t = 0.3},
            {s = rottle,    t = 0.75},
            {s = common .. "magpouch.ogg",           t = 0.8, v = 0.4},
            {s = testpath .. "struggle.ogg",   t = 0.9},
            {s = testpath .. "magin.ogg",   t = 1.2},
            {s = rottle,    t = 1.4},
            {s = ratel,   t = 1.5},
        },
    },
    ["reload_10"] = {
        Source = "reload_exte",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 1.15,
        LHIKEaseOut = 0.25,
        MinProgress = 2.5,
        SoundTable = {
            {s = rottle,                             t = 0.1},
            {s = testpath .. "magrel.ogg", 	t = 0.2},
            {s = testpath .. "magout.ogg",          t = 0.3},
            {s = rottle,    t = 0.75},
            {s = common .. "magpouch.ogg",           t = 0.8, v = 0.4},
            {s = testpath .. "struggle.ogg",   t = 0.9},
            {s = testpath .. "magin.ogg",   t = 1.2},
            {s = rottle,    t = 1.4},
            {s = ratel,   t = 1.5},
        },
    },
    ["reload_338"] = {
        Source = "reload_magnum",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 1.15,
        LHIKEaseOut = 0.25,
        MinProgress = 2.5,
        Time = 3.4,
        SoundTable = {
            {s = rottle,                             t = 0.1},
            {s = testpath .. "magrel.ogg", 	t = 0.2},
            {s = testpath .. "magout.ogg",          t = 0.4},
            {s = rottle,    t = 0.75},
            {s = common .. "magpouch.ogg",           t = 0.8, v = 0.4},
            {s = testpath .. "struggle.ogg",   t = 1.1, v = 1.1},
            {s = testpath .. "magin.ogg",   t = 1.3},
            {s = testpath .. "magtap.ogg",   t = 1.95},
            {s = rottle,    t = 2.3, v = 0.6},
            {s = ratel,   t = 2.35, v = 0.6},
        },
    },
    ["reload_empty"] = {
        Source = "reload_empty",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        LHIK = false,
        LHIKIn = 0.9,
        LHIKOut = 1.25,
        LHIKEaseIn = 0.1,
        LHIKEaseOut = 0.5,
        MinProgress = 3.0,
        ShellEjectAt = .45,
        LastClip1OutTime = 1.8,
        Time = 4.5,
        SoundTable = {
            {s = ratel,                             t = 0.05},
            {s = testpath .. "boltup.ogg",          t = 0.15},
            {s = testpath .. "boltback_reload.ogg",        t = 0.18},
            {s = testpath .. "eject.ogg",           t = 0.45},
            {s = rottle,    t = 0.6},
            {s = testpath .. "magrel.ogg", 	t = 1.0},
            {s = testpath .. "magout_empty.ogg",          t = 1.2},
            {s = rottle,    t = 1.25},
            {s = testpath .. "magdrop_metal.ogg",          t = 1.5, v = 0.4},
            {s = common .. "magpouch.ogg",           t = 1.6, v = 0.4},
            {s = rottle,    t = 1.65},
            {s = testpath .. "struggle.ogg",   t = 2},
            {s = testpath .. "magin.ogg",   t = 2.1},
            {s = rottle,    t = 2.4},
            {s = ratel,   t = 2.6},
            {s = testpath .. "boltforward_reload.ogg",     t = 2.7},
            {s = testpath .. "boltdown.ogg",        t = 3.1},
            {s = common .. "shoulder.ogg",        t = 3.15},
        },
    },
    ["reload_empty_10"] = {
        Source = "reload_empty_exte",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        LHIK = false,
        LHIKIn = 0.9,
        LHIKOut = 1.25,
        LHIKEaseIn = 0.1,
        LHIKEaseOut = 0.5,
        ShellEjectAt = .5,
        MinProgress = 3.5,
        LastClip1OutTime = 1.8,
        Time = 4.5,
        SoundTable = {
            {s = ratel,                             t = 0.05},
            {s = testpath .. "boltup.ogg",          t = 0.15},
            {s = testpath .. "boltback_reload.ogg",        t = 0.18},
            {s = testpath .. "eject.ogg",           t = 0.45},
            {s = rottle,    t = .6},
            {s = testpath .. "magrel.ogg", 	t = 1.0},
            {s = testpath .. "magout_empty.ogg",          t = 1.2},
            {s = rottle,    t = 1.25},
            {s = testpath .. "magdrop_metal.ogg",          t = 1.6, v = 0.4},
            {s = common .. "magpouch.ogg",           t = 1.6, v = 0.4},
            {s = rottle,    t = 1.65},
            {s = testpath .. "struggle.ogg",   t = 2.1},
            {s = testpath .. "magin.ogg",   t = 2.2},
            {s = rottle,    t = 2.5},
            {s = testpath .. "boltforward_reload.ogg",     t = 2.8},
            {s = ratel,   t = 2.7},
            {s = testpath .. "boltdown.ogg",        t = 3.2},
            {s = common .. "shoulder.ogg",        t = 3.2},
        },
    },
    ["reload_empty_338"] = {
        Source = "reload_empty_magnum",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        LHIK = false,
        LHIKIn = 0.9,
        LHIKOut = 1.25,
        LHIKEaseIn = 0.1,
        LHIKEaseOut = 0.5,
        ShellEjectAt = .5,
        LastClip1OutTime = 1.5,
        MinProgress = 4,
        Time = 4.25,
        SoundTable = {
            {s = ratel,                             t = 0.05},
            {s = testpath .. "boltup.ogg",          t = 0.15},
            {s = testpath .. "boltback_reload.ogg",        t = 0.18},
            {s = testpath .. "eject.ogg",           t = 0.45},
            {s = rottle,    t = 0.6},
            {s = testpath .. "magrel.ogg", 	t = 1.0},
            {s = testpath .. "magout_empty.ogg",          t = 1.1},
            {s = rottle,    t = 1.25},
            {s = testpath .. "magdrop_metal.ogg",          t = 1.5, v = 0.4},
            {s = common .. "magpouch.ogg",           t = 1.6, v = 0.4},
            {s = rottle,    t = 1.65},
            {s = testpath .. "struggle.ogg",   t = 1.8},
            {s = testpath .. "magin.ogg",   t = 1.9},
            {s = rottle,    t = 2.4},
            {s = testpath .. "magtap.ogg",   t = 2.5},
            {s = ratel,   t = 2.6},
            {s = testpath .. "boltforward_reload.ogg",     t = 2.7},
            {s = testpath .. "boltdown.ogg",        t = 3.1},
            {s = common .. "shoulder.ogg",        t = 3.15},
        },
    },
    ["reload_empty_10_338"] = {
        Source = "reload_empty_exte_magnum",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        LHIK = true,
        LHIKIn = 0.9,
        LHIKOut = 1.25,
        LHIKEaseIn = 0.1,
        LHIKEaseOut = 0.5,
        MinProgress = 4,
        LastClip1OutTime = 2.3,
        Time = 4.5,
        ShellEjectAt = .5,
        SoundTable = {
            {s = ratel,                             t = 0.05},
            {s = testpath .. "boltup.ogg",          t = 0.15},
            {s = testpath .. "boltback_reload.ogg",        t = 0.18},
            {s = testpath .. "eject.ogg",           t = 0.45},
            {s = rottle,    t = 0.6},
            {s = testpath .. "magrel.ogg", 	t = 1.0},
            {s = testpath .. "magout_empty.ogg",          t = 1.1},
            {s = rottle,    t = 1.25},
            {s = testpath .. "magdrop_metal.ogg",          t = 1.5, v = 0.4},
            {s = common .. "magpouch.ogg",           t = 1.6, v = 0.4},
            {s = rottle,    t = 1.65},
            {s = testpath .. "struggle.ogg",   t = 1.85},
            {s = testpath .. "magin.ogg",   t = 2.0},
            {s = rottle,    t = 2.4},
            {s = testpath .. "magtap.ogg",   t = 2.6},
            {s = ratel,   t = 2.6},
            {s = testpath .. "boltforward_reload.ogg",     t = 2.9},
            {s = testpath .. "boltdown.ogg",        t = 3.3},
            {s = common .. "shoulder.ogg",        t = 3.35},
        },
    },
    ["reload_10_338"] = {
        Source = "reload_exte_magnum",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0.65,
        LHIKEaseOut = 0.25,
        MinProgress = 3,
        Time = 3.5,
        SoundTable = {
            {s = rottle,                             t = 0.1},
            {s = testpath .. "magrel.ogg", 	t = 0.2},
            {s = testpath .. "magout.ogg",          t = 0.4},
            {s = rottle,    t = 0.75},
            {s = common .. "magpouch.ogg",           t = 0.8, v = 0.4},
            {s = testpath .. "struggle.ogg",   t = 1.1, v = 1},
            {s = testpath .. "magin.ogg",   t = 1.4},
            {s = testpath .. "magtap.ogg",   t = 2.0},
            {s = rottle,    t = 2.3, v = 0.6},
            {s = ratel,   t = 2.35, v = 0.6},
        },
    },
    ["cycle"] = {
        Source = "cycle",
        Time = 1.47,
        ShellEjectAt = 0.4,
        MinProgress = 0.9,
        SoundTable = {
            {s = ratel,                             t = 0.07},
            {s = testpath .. "boltup.ogg",          t = 0.1},
            {s = testpath .. "boltback.ogg",        t = 0.2},
            {s = testpath .. "boltforward.ogg",     t = 0.32},
            {s = testpath .. "eject.ogg",           t = 0.4},
            {s = testpath .. "boltdown.ogg",        t = 0.6},

            --{s = common .. "shoulder.ogg",          t = 0.7},
        },
    },

    ["enter_inspect"] = {
        Source = "inspect_enter",
        -- time = 35 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 2.5,
        SoundTable = {
            {s = rottle, t = 0},
            {s = common .. "movement-sniper-03.ogg", t = 0.05},
        },
    },
    ["idle_inspect"] = {
        Source = "inspect_loop",
        -- time = 72 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 999, -- maybe im dumb
    },
    ["exit_inspect"] = {
        Source = "inspect_exit",
        -- time = 66 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 999, -- maybe im dumb
        SoundTable = {
            {s = common .. "movement-sniper-01.ogg", t = 0},
            {s = rottle, t = 0.25},
            {s = testpath .. "boltup_inspect.ogg",          t = 1.2},
            {s = common .. "movement-sniper-03.ogg", t = 1.25},
            {s = testpath .. "boltback_inspect.ogg",        t = 1.35},
            {s = testpath .. "boltforward_inspect.ogg",     t = 1.8},
            {s = testpath .. "boltdown_inspect.ogg",        t = 1.9},
            {s = rottle, t = 2.0},
            {s = common .. "movement-sniper-04.ogg", t = 2.2},
        },
    },
    ["enter_inspect_empty"] = { -- Animations needed!
        Source = "inspect_enter",
        -- time = 35 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 2.5,
        SoundTable = {
            {s = rottle, t = 0},
            {s = rutle, t = 0.1},
        },
    },
    ["idle_inspect_empty"] = {
        Source = "inspect_loop",
        -- time = 72 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 999, -- maybe im dumb
    },
    ["exit_inspect_empty"] = {
        Source = "inspect_exit",
        -- time = 66 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 999, -- maybe im dumb
        SoundTable = {
            {s = common .. "movement-sniper-01.ogg", t = 0.05},
            {s = rottle, t = 0.25},
            {s = testpath .. "boltup_inspect.ogg",          t = 1.2},
            {s = common .. "movement-sniper-03.ogg", t = 1.25},
            {s = testpath .. "boltback_inspect.ogg",        t = 1.35},
            {s = testpath .. "boltforward_inspect.ogg",     t = 1.8},
            {s = testpath .. "boltdown_inspect.ogg",        t = 1.9},
            {s = rottle, t = 2.0},
            {s = common .. "movement-sniper-04.ogg", t = 2.2},
        },
    },
}

SWEP.Hook_Think = ArcCW.UC.ADSReload

--lua/weapons/arccw_ur_hk33ka3.lua:
return gluapack()()
--lua/weapons/arccw_ur_g3.lua:
SWEP.Base = "arccw_base"
SWEP.Spawnable = true -- this obviously has to be set to true
SWEP.Category = "ArcCW - Urban Coalition" -- edit this if you like
SWEP.UC_CategoryPack = "2Urban Renewal"
SWEP.AdminOnly = false

SWEP.PrintName = "AG58"
SWEP.TrueName = "G3A3"

SWEP.Trivia_Class = "Battle Rifle"
SWEP.Trivia_Desc = [[Heckler & Koch's earliest major weapon design, conceived in collaboration with Spanish research group CETME. As a pioneer of the roller-delay system, its success within the Bundeswehr inspired HK to derive subsequent designs from its layout, including the MP5 submachine gun.

Well known for its excellent accuracy and range, but its powerful cartridge makes sustained fire difficult.]]
SWEP.Trivia_Manufacturer = "Crowdley & Nelson"
SWEP.Trivia_Calibre = "7.62x51mm NATO"
SWEP.Trivia_Mechanism = "Roller-Delayed Blowback"
SWEP.Trivia_Country = "Germany"
SWEP.Trivia_Year = 1958

if GetConVar("arccw_truenames"):GetBool() then
    SWEP.PrintName = SWEP.TrueName
    SWEP.Trivia_Manufacturer = "Heckler & Koch"
end

SWEP.Slot = 2
SWEP.CamAttachment = 3

SWEP.UseHands = true

SWEP.ViewModel = "models/weapons/arccw/c_ur_g3.mdl"
SWEP.WorldModel = "models/weapons/arccw/c_ur_g3.mdl"
SWEP.ViewModelFOV = 70

SWEP.DefaultBodygroups = "000000000000"

-- Damage --

SWEP.Damage = 65
SWEP.DamageMin = 35
SWEP.RangeMin = 50
SWEP.Range = 400
SWEP.Penetration = 20
SWEP.DamageType = DMG_BULLET
SWEP.ShootEntity = nil
SWEP.MuzzleVelocity = 715
SWEP.PhysBulletMuzzleVelocity = 715

SWEP.BodyDamageMults = ArcCW.UC.BodyDamageMults

-- Mag size --

SWEP.ChamberSize = 1
SWEP.Primary.ClipSize = 20

-- Recoil --

SWEP.Recoil = 1.4
SWEP.RecoilSide = 0.6

SWEP.RecoilRise = 0.6
SWEP.RecoilPunch = 1
SWEP.VisualRecoilMult = 1
SWEP.MaxRecoilBlowback = 1
SWEP.MaxRecoilPunch = 1
SWEP.RecoilPunchBack = 2

SWEP.Sway = 0.4

-- Firerate / Firemodes --

SWEP.Delay = 60 / 520
SWEP.Num = 1
SWEP.Firemodes = {
    {
        Mode = 2,
    },
    {
        Mode = 1,
    },
    {
        Mode = 0,
    },
}

SWEP.ShootPitch = 100
SWEP.ShootVol = 120

SWEP.ProceduralRegularFire = false
SWEP.ProceduralIronFire = false

SWEP.ReloadInSights = true

-- NPC --

SWEP.NPCWeaponType = "weapon_ar2"
SWEP.NPCWeight = 60

-- Accuracy --

SWEP.AccuracyMOA = 2
SWEP.HipDispersion = 900
SWEP.MoveDispersion = 200
SWEP.JumpDispersion = 1000

SWEP.Primary.Ammo = "ar2"
SWEP.MagID = "ak"

SWEP.HeatCapacity = 75
SWEP.HeatDissipation = 15
SWEP.HeatDelayTime = 3

-- SWEP.Malfunction = true
SWEP.MalfunctionMean = 200
--SWEP.MeleeTime = 1.5

-- Speed multipliers --

SWEP.SpeedMult = 0.9
SWEP.SightedSpeedMult = 0.75
SWEP.SightTime = 0.35
SWEP.ShootSpeedMult = 0.75

local path = ")weapons/arccw_ur/g3/"
local path1 = ")weapons/arccw_ur/mp5/"
local common = ")/arccw_uc/common/"
local rottle = {common .. "cloth_1.ogg", common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}
local ratel = {common .. "rattle1.ogg", common .. "rattle2.ogg", common .. "rattle3.ogg"}
--SWEP.FirstShootSound = path .. "fire_first.ogg"

SWEP.ShootSound = {
    path .. "fire-01.ogg",
    path .. "fire-02.ogg",
    path .. "fire-03.ogg",
    path .. "fire-04.ogg",
    path .. "fire-05.ogg",
    path .. "fire-06.ogg"
}
SWEP.ShootSoundSilenced = {
    path .. "fire-sup-01.ogg",
    path .. "fire-sup-02.ogg",
    path .. "fire-sup-03.ogg",
    path .. "fire-sup-04.ogg",
    path .. "fire-sup-05.ogg",
    path .. "fire-sup-06.ogg"
}
SWEP.DistantShootSound = nil
SWEP.DistantShootSoundSilenced = nil
SWEP.ShootDrySound = path .. "dryfire.ogg"

local tail = ")/arccw_uc/common/308/"

SWEP.DistantShootSoundOutdoors = {
    tail .. "fire-dist-308-rif-ext-01.ogg",
    tail .. "fire-dist-308-rif-ext-02.ogg",
    tail .. "fire-dist-308-rif-ext-03.ogg",
    tail .. "fire-dist-308-rif-ext-04.ogg",
    tail .. "fire-dist-308-rif-ext-05.ogg",
    tail .. "fire-dist-308-rif-ext-06.ogg"
}
SWEP.DistantShootSoundIndoors = {
    common .. "fire-dist-int-rifle-01.ogg",
    common .. "fire-dist-int-rifle-02.ogg",
    common .. "fire-dist-int-rifle-03.ogg",
    common .. "fire-dist-int-rifle-04.ogg",
    common .. "fire-dist-int-rifle-05.ogg",
    common .. "fire-dist-int-rifle-06.ogg"
}
SWEP.DistantShootSoundOutdoorsSilenced = {
    common .. "sup-tail-01.ogg",
    common .. "sup-tail-02.ogg",
    common .. "sup-tail-03.ogg",
    common .. "sup-tail-04.ogg",
    common .. "sup-tail-05.ogg",
    common .. "sup-tail-06.ogg",
    common .. "sup-tail-07.ogg",
    common .. "sup-tail-08.ogg",
    common .. "sup-tail-09.ogg",
    common .. "sup-tail-10.ogg"
}
SWEP.DistantShootSoundIndoorsSilenced = {
    common .. "sup_tail.ogg"
}
SWEP.DistantShootSoundOutdoorsVolume = 1
SWEP.DistantShootSoundIndoorsVolume = 1
SWEP.Hook_AddShootSound = ArcCW.UC.InnyOuty

SWEP.MuzzleEffect = "muzzleflash_6"
SWEP.ShellEffect = "arccw_uc_shelleffect"
SWEP.ShellModel = "models/weapons/arccw/uc_shells/556x45.mdl"
SWEP.ShellScale = 1.145
SWEP.ShellPitch = 90
SWEP.ShellScale = 1
SWEP.ShellRotateAngle = Angle(0, 0, 0)
SWEP.UC_ShellColor = Color(0.7*255, 0.2*255, 0.2*255)

SWEP.MuzzleEffectAttachment = 1 -- which attachment to put the muzzle on
SWEP.CaseEffectAttachment = 2 -- which attachment to put the case effect on

SWEP.BulletBones = {
    --[1] = "tag_mag2",
}

SWEP.IronSightStruct = {
    Pos = Vector(-2.3, -1, 0.9),
    Ang = Angle(0, 0.02, 0),
    Magnification = 1.1,
    ViewModelFOV = 65,
    SwitchToSound = "", -- sound that plays when switching to this sight
    CrosshairInSights = false
}
SWEP.LaserOffsetAngle = Angle(0, 0, 0)
SWEP.LaserIronsAngle = Angle(0, 0, 0)

SWEP.HoldtypeHolstered = "passive"
SWEP.HoldtypeActive = "ar2"
SWEP.HoldtypeSights = "rpg"

SWEP.AnimShoot = ACT_HL2MP_GESTURE_RANGE_ATTACK_AR2

SWEP.ActivePos = Vector(0.3, 1, 0.8)
SWEP.ActiveAng = Angle(0, 0, 0)

SWEP.SprintPos = Vector(0.5, 1, 0.5)
SWEP.SprintAng = Angle(-8.5, 15, -10)

SWEP.CrouchPos = Vector(-0.7, 0.6, 0)
SWEP.CrouchAng = Angle(0, 0, -14)

SWEP.HolsterPos = Vector(-1, -1, 1.2)
SWEP.HolsterAng = Angle(-15, 8, -10)

SWEP.BarrelOffsetSighted = Vector(0, 0, 0)
SWEP.BarrelOffsetHip = Vector(0, 0, 0)

-- SWEP.CustomizePos = Vector(10.5, 4, 1)
-- SWEP.CustomizeAng = Angle(8, 30, 15)
SWEP.CustomizePos = Vector(0.3, 1, 0.8)
SWEP.CustomizeAng = Angle(0, 0, 0)

SWEP.BarrelLength = 24

SWEP.AttachmentElements = {
    ["ur_g3_skin_wood"] = { VMSkin = 1 },
    ["ur_g3_skin_olive"] = { VMSkin = 2 },
    ["ur_g3_skin_tan"] = { VMSkin = 3 },
    ["ur_g3_skin_custom"] = { VMSkin = 4 },

    ["stock_g3_collapsible"] = {
        VMBodygroups = {
            {ind = 5, bg = 2},
        }
    },
    ["stock_g3_collapsed"] = {
        VMBodygroups = {
            {ind = 5, bg = 3},
        }
    },
    ["ur_g3_stock_psg"] = {
        VMBodygroups = {
            {ind = 5, bg = 4},
        }
    },
    ["ur_g3_stock_sg"] = {
        VMBodygroups = {
            {ind = 5, bg = 1},
        }
    },
    ["ur_g3_stock_rucar"] = {
        VMBodygroups = {
            {ind = 5, bg = 5},
        }
    },

    ["ur_g3_rec_hk33"] = {
        VMBodygroups = {
            {ind = 0, bg = 1},
            {ind = 3, bg = 1},
            {ind = 4, bg = 4},
        },
    },
    ["ur_g3_rec_psg"] = {
        VMBodygroups = {
            -- {ind = 1, bg = 1},
            {ind = 3, bg = 2},
        },
        NameChange = "PMR-2",
        TrueNameChange = "PSG1",
    },

    ["ur_g3_mag_10"] = {
        VMBodygroups = {
            {ind = 4, bg = 1},
        }
    },
    ["ur_g3_mag_50"] = {
        VMBodygroups = {
            {ind = 4, bg = 2},
        }
    },
    ["ur_g3_mag_20_556"] = {
        VMBodygroups = {
            {ind = 4, bg = 3},
        }
    },
    ["ur_g3_mag_40_556"] = {
        VMBodygroups = {
            {ind = 4, bg = 5},
        }
    },

    ["ur_g3_barrel_12"] = {
        VMBodygroups = {
            {ind = 2, bg = 1},
        },
        AttPosMods = {
            [5] = {
                vpos = Vector(0, 0.06, 17.7),
                vang = Angle(90, 0, -90),
            },
            [7] = {
                vpos = Vector(-0.94, 0.2, 14),
                vang = Angle(90, 0, 180),
            },
        }
    },
    ["ur_g3_barrel_15"] = {
        VMBodygroups = {
            {ind = 2, bg = 4},
        },
        AttPosMods = {
            [5] = {
                vpos = Vector(0, 0.06, 20),
                vang = Angle(90, 0, -90),
            },
            [7] = {
                vpos = Vector(-0.94, 0.2, 14),
                vang = Angle(90, 0, 180),
            },
        }
    },
    ["ur_g3_barrel_8"] = {
        VMBodygroups = {
            {ind = 2, bg = 2},
        },
        AttPosMods = {
            [5] = {
                vpos = Vector(0, 0.06, 13.7),
                vang = Angle(90, 0, -90),
            },
            [7] = {
                vpos = Vector(-0.94, 0.2, 11),
                vang = Angle(90, 0, 180),
            },
        }
    },
    ["ur_g3_barrel_26"] = {
        VMBodygroups = {
            {ind = 2, bg = 3},
        },
        AttPosMods = {
            [5] = {
                vpos = Vector(0, 0.06, 29.7),
                vang = Angle(90, 0, -90),
            },
            [7] = {
                vpos = Vector(-0.94, 0.2, 17),
                vang = Angle(90, 0, 180),
            },
        }
    },

    ["ur_g3_hg_slim"] = {
        AttPosMods = {
            [6] = {
                vpos = Vector(0, 0.66, 9),
                vang = Angle(90, 0, -90),
            },
        }
    },
    ["ur_g3_hg_pica"] = {
        AttPosMods = {
            [6] = {
                vpos = Vector(0, 0.75, 9.2),
                vang = Angle(90, 0, -90),
            },
        }
    },
}

local hgbg = {
    ["ur_g3_hg_slim"] = 1,
    ["ur_g3_hg_pica"] = 2,
    ["ur_mp5_ub_mlok"] = 3,
    ["ur_mp5_ub_surefire"] = 4,
}
local muzzlebg = {
    ["ur_g3_barrel_8"] = 2,
    ["ur_g3_barrel_12"] = 1,
    ["ur_g3_barrel_15"] = 4,
    ["ur_g3_barrel_26"] = 3,
    ["default"] = 0,
}
local opticbg = {
    ["ur_g3_optic_psg1"] = 2,
    ["ur_g3_optic_sg1"] = 3,
}
local ubmountbg = {
    ["ur_g3_hg_slim"] = 2,
    ["ur_g3_hg_pica"] = 0,
}

SWEP.Hook_ModifyBodygroups = function(wep,data)
    local vm = data.vm
    if !IsValid(vm) then return end

    local atts = wep.Attachments
    local barrel = atts[2].Installed or "default"
    local hg = atts[4].Installed
    local muzzle = atts[5].Installed
    local ub = atts[6].Installed or atts[15].Installed
    local optic = atts[1].Installed
    local charm = atts[14].Installed
    local bayobipod = atts[17].Installed

    local hgind = hgbg[hg] or 0

    if barrel == "ur_g3_barrel_12" or barrel == "ur_g3_barrel_15" then
        vm:SetBodygroup(6, hgind + 3)

        if ub == "ur_g3_ub_bayonet" then
            vm:SetBodygroup(7, 2)
        elseif ub == "ur_g3_ub_bipod" then
            vm:SetBodygroup(7, 4)
        end
    elseif barrel == "ur_g3_barrel_8" then
        vm:SetBodygroup(6, hgind + 6)
    elseif barrel == "ur_g3_barrel_26" then
        vm:SetBodygroup(6, 11)
    else
        vm:SetBodygroup(6, hgind)
    end

    if (barrel == "default" or barrel == "ur_g3_barrel_12" or barrel == "ur_g3_barrel_15" or barrel == "ur_g3_barrel_8") and ub == "uc_ubgl_hk79" then
        vm:SetBodygroup(6, 11)
        atts[15].Offset.vpos = Vector(0, -0.7, 7.3)
    else
        atts[15].Offset.vpos = Vector(0, 0.1, 6.9)
    end

    if barrel == "ur_g3_barrel_26" then
        vm:SetBodygroup(1, 1)
    end

    vm:SetBodygroup(9, !muzzle and muzzlebg[barrel] or 3)

    vm:SetBodygroup(10, (optic or charm == "ur_mp5_optic_mount") and (opticbg[optic] and 0 or 1) or 0)

    vm:SetBodygroup(8, ub and (ubmountbg[hg] or 1) or 0)

    local todo = 0
    local short = barrel == "ur_g3_barrel_12" or barrel == "ur_g3_barrel_15"
    if bayobipod == "ur_g3_bayobipod_bayonet" then
        todo = short and 2 or 1
    elseif bayobipod == "ur_g3_bayobipod_bipod" then
        todo = short and 4 or 3
    end
    vm:SetBodygroup(7, todo)
end

SWEP.Hook_NameChange = function(wep)
    local atts = wep.Attachments
    local barr = string.Replace(atts[2].Installed or "default","ur_g3_barrel_","")
    local rec = string.Replace(atts[3].Installed or "default","ur_g3_rec_","")
    local stock = string.Replace(atts[8].Installed or "default","ur_g3_stock_","")
    local trueNames = GetConVar("arccw_truenames"):GetBool()


    if rec == "hk33" then
        if trueNames then
            local bLookup = {
                ["8"] = "HK53",
                ["12"] = "HK33KA3",
            }

            if bLookup[barr] then
                return bLookup[barr]
            elseif atts[1].Installed == "ur_g3_optic_sg1" then
                return "HK33SG/1"
            else
                return (stock == "collapsible" and "HK33A3") or "HK33A2"
            end
        else
            local bLookup = {
                ["8"] = "CN109",
                ["12"] = "CN66K",
            }

            if bLookup[barr] then
                return bLookup[barr]
            elseif atts[1].Installed == "ur_g3_optic_sg1" then
                return "CN66-SSR"
            else
                return "CN66"
            end
        end
    elseif rec == "default" then -- not "else" here to allow the base's PSG1 namechange to happen
        if trueNames then
            if atts[13].Installed == "uc_fg_civvy" then return "HK91" end

            local bLookup = {
                ["8"] = "HK51",
                ["12"] = "G3KA4",
            }

            if bLookup[barr] then
                return bLookup[barr]
            elseif atts[1].Installed == "ur_g3_optic_sg1" then
                return "G3SG/1"
            else
                return (stock == "collapsible" and "G3A4") or wep.TrueName
            end
        else
            local bLookup = {
                ["8"] = "CN102",
                ["12"] = "AG58K",
            }
            if bLookup[barr] then
                return bLookup[barr]
            elseif atts[1].Installed == "ur_g3_optic_sg1" then
                return "AG-SSR"
            else
                return "AG58"
            end
        end
    end
end

SWEP.O_Hook_UC_UseClassicHK79Mount = function(wep, data)
    local atts = wep.Attachments
    local barrel = atts[2].Installed or "default"
    local ub = atts[6].Installed or atts[15].Installed

    if ub == "uc_ubgl_hk79" and (barrel == "default" or barrel == "ur_g3_barrel_12" or barrel == "ur_g3_barrel_15" or barrel == "ur_g3_barrel_8") then
        data.current = true
    end
end

SWEP.ExtraSightDist = 2
SWEP.GuaranteeLaser = false

SWEP.WorldModelOffset = {
    pos = Vector(-5, 3, -5),
    ang = Angle(-12, 0, 180)
}

SWEP.MirrorVMWM = true


SWEP.Attachments = {
    {
        PrintName = "Optic",
        Slot = {"ur_g3_optic", "optic"},
        Bone = "body",
        Offset = {
            vpos = Vector(0, -1.6, -0.55),
            vang = Angle(90, 0, -90),
        },
        InstalledEles = {"mount_optic"},
        CorrectivePos = Vector(0.018, 0, -0.0),
        CorrectiveAng = Angle(0, 0.3, 0.45),
    },
    {
        PrintName = "Barrel",
        Slot = "ur_g3_barrel",
        DefaultAttName = "18\" Standard Barrel",
        DefaultAttIcon = Material("entities/att/ur_g3/barrel_std.png", "smooth mips"),
        DefaultFlags = {"g3_not8"}
    },
    {
        PrintName = "Reciever",
        Slot = "ur_g3_rec",
        DefaultAttName = "Standard Reciever",
        DefaultAttIcon = Material("entities/att/ur_g3/rec_std.png", "smooth mips"),
    },
    {
        PrintName = "Handguard",
        Slot = "ur_g3_handguard",
        Bone = "body",
        Offset = {
            vpos = Vector(0, 1.5, 10),
            vang = Angle(90, 0, -90),
        },
        DefaultAttName = "Standard Handguard",
        DefaultAttIcon = Material("entities/att/ur_g3/hg_std.png", "smooth mips"),
        ExcludeFlags = {"hk79_pro","g3_nohg"},
    },
    {
        PrintName = "Muzzle",
        Slot = "muzzle",
        Bone = "body",
        Offset = {
            vpos = Vector(0, 0.06, 22.5),
            vang = Angle(90, 0, -90),
        },
        MergeSlots = {17},
    },
    {
        PrintName = "Underbarrel",
        Slot = "foregrip",
        Bone = "body",
        Offset = {
            vpos = Vector(0, 1.17, 8.6),
            vang = Angle(90, 0, -90),
        },
        InstalledEles = {"mount_underbarrel"},
        ExcludeFlags = {"g3_noub"},
        MergeSlots = {15},
    },
    {
        PrintName = "Tactical",
        Slot = "tac",
        Bone = "body",
        Offset = {
            vpos = Vector(-0.8, 0, 17),
            vang = Angle(90, 0, 180),
        },
        InstalledEles = {"mount_tactical"},
    },
    {
        PrintName = "Stock",
        Slot = "ur_g3_stock",
        DefaultAttName = "Factory Stock",
        DefaultAttIcon = Material("entities/att/ur_g3/stock_std.png", "smooth mips"),
    },
    {
        PrintName = "Magazine",
        Slot = "ur_g3_mag",
        DefaultAttName = "20-Round Mag",
        DefaultAttIcon = Material("entities/att/ur_g3/mag20.png", "smooth mips"),
    },
    {
        PrintName = "Ammo Type",
        DefaultAttName = "\"FMJ\" Full Metal Jacket",
        DefaultAttIcon = Material("entities/att/arccw_uc_ammo_generic.png", "mips smooth"),
        Slot = "uc_ammo",
    },
    {
        PrintName = "Powder Load",
        Slot = "uc_powder",
        DefaultAttName = "Standard Load"
    },
    {
        PrintName = "Training Package",
        Slot = "uc_tp",
        DefaultAttName = "Basic Training"
    },
    {
        PrintName = "Internals",
        Slot = "uc_fg",
        DefaultAttName = "Standard Internals"
    },
    {
        PrintName = "Charm",
        Slot = {"charm", "fml_charm", "mp5_charm"},
        FreeSlot = true,
        Bone = "body",
        Offset = {
            vpos = Vector(0.5, 1.3, 3),
            vang = Angle(90, 0, -90),
        },
    },
    {
        PrintName = "M203 slot",
        Slot = "uc_ubgl",
        Bone = "body",
        Offset = {
            vpos = Vector(0, 0.1, 6.9), -- this is also changed by ModifyBodygroups
            vang = Angle(90, 0, -90),
        },
        Hidden = true,
        InstalledEles = {"mount_underbarrel"},
    },
    {
        PrintName = "Furniture",
        Slot = "ur_g3_skin",
        DefaultAttName = "Gray",
        DefaultAttIcon = Material("entities/att/ur_g3/skin_gray.png", "smooth mips"),
    },
    {
        PrintName = "UR G3 bayobipod slot",
        Slot = "ur_g3_bayobipod",
        ExcludeFlags = {"g3_hk51hg"},
    },
}

SWEP.Animations = {
    ["idle"] = {
        Source = "idle"
    },
    ["draw"] = {
        Source = "draw",
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 0.5,
        SoundTable = {
            {s = ratel, t = 0},
            {s = common .. "raise.ogg", t = 0.2},
            {s = common .. "shoulder.ogg",    t = 0.2},
        },
    },
    ["holster"] = {
        Source = "holster",
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 0.5,
        SoundTable = {
            {s = ratel, t = 0},
           -- {s = common .. "raise.ogg", t = 0.2},
            -- {s = common .. "shoulder.ogg",    t = 0.2},
        },
    },
    ["ready"] = {
        Source = "ready",
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0.6,
        LHIKEaseOut = 0.25,
        SoundTable = {
            {s = ratel, t = 0},
            {s = path .. "chback.ogg",    t = 0.2},
            {s = path .. "chamber.ogg",    t = 0.3},
            {s = common .. "shoulder.ogg",    t = .6},
        },
    },

    ["fire"] = {
        Source = {"fire_01","fire_02","fire_03"},
        ShellEjectAt = 0,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0, v = 0.25 }},
    },
    ["fire_iron"] = {
        Source = {"fire_01","fire_02","fire_03"},
        ShellEjectAt = 0,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0 }},
    },

   ["reload"] = {
       Source = "reload",
       TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
       LHIK = true,
       LHIKIn = 0.3,
       LHIKOut = 0.65,
       LHIKEaseOut = 0.25,
       MinProgress = 1.3,
       SoundTable = {
            {s = rottle,  t = 0.0},
            {s = ratel, t = 3/30},
            {s = common .. "magpouch_gear.ogg", t = 9/30},
            {s = path .. "magout.ogg", 	 t = 11/30},
            {s = ratel, t = 0.5},
            {s = rottle,  t = 0.75},
            {s = path .. "struggle.ogg", t = 36/30},
            {s = path .. "magin.ogg", t = 42/30},
            {s = ratel, t = 1.1},
            {s = rottle,  t = 1.15},
            {s = common .. "grab.ogg", t = 52/30},
            {s = common .. "shoulder.ogg", t = 54/30},
       },
   },
    ["reload_empty"] = {
        Source = "reload_empty",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0.5,
        LHIKEaseOut = 0.25,
        MinProgress = 2.1,
        LastClip1OutTime = 50/30,
        SoundTable = {
            {s = rottle,  t = 0.0},
            {s = path .. "chback.ogg", t = 5/30, v = 1.95},
            {s = path .. "chlock.ogg", t = 13/30, v = 1.95},
            {s = ratel,  t = 23/30},
            {s = rottle,  t = 24/30},
            {s = common .. "magpouch_gear.ogg", t = 25/30},
            {s = path .. "magrel.ogg", t = 27/30},
            {s = path .. "magout.ogg", t = 30/30},
            {s = rottle,  t = 49/30},
            {s = rottle,  t = 55/30},
            {s = {common .. "rifle_magdrop_1.ogg",common .. "rifle_magdrop_2.ogg",common .. "rifle_magdrop_3.ogg",common .. "rifle_magdrop_4.ogg",common .. "rifle_magdrop.ogg"}, t = 51/30, v = 0.25},
            {s = path .. "struggle.ogg", t = 57/30},
            {s = path .. "magin.ogg", t = 62/30},
            {s = rottle,  t = 75/30},
            {s = path .. "chslap.ogg", t = 80/30},
            {s = ratel,  t = 81/30},
            {s = common .. "grab.ogg", t = 87/30},
            {s = common .. "shoulder.ogg", t = 88/30},
        },
    },
    ["reload_empty_scope"] = {
        Source = "reload_empty_scope",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0.5,
        LHIKEaseOut = 0.25,
        MinProgress = 2.1,
        LastClip1OutTime = 50/30,
        SoundTable = {
            {s = rottle,  t = 0.0},
            {s = path .. "chback.ogg", t = 6/30, v = 1.95},
            {s = path .. "chlock.ogg", t = 13/30, v = 1.95},
            {s = ratel,  t = 23/30},
            {s = rottle,  t = 24/30},
            {s = common .. "magpouch.ogg", t = 26/30},
            {s = path .. "magrel.ogg", t = 27/30},
            {s = path .. "magout.ogg", t = 30/30},
            {s = rottle,  t = 49/30},
            {s = rottle,  t = 55/30},
            {s = {common .. "rifle_magdrop_1.ogg",common .. "rifle_magdrop_2.ogg",common .. "rifle_magdrop_3.ogg",common .. "rifle_magdrop_4.ogg",common .. "rifle_magdrop.ogg"}, t = 51/30, v = 0.25},
            {s = path .. "struggle.ogg", t = 57/30},
            {s = path .. "magin.ogg", t = 62/30},
            {s = rottle,  t = 75/30},
            {s = path .. "chlock.ogg", t = 75/30, v = 1.95},
            {s = path .. "chamber.ogg", t = 80/30},
            {s = ratel,  t = 81/30},
            {s = common .. "grab.ogg", t = 92/30},
            {s = common .. "shoulder.ogg", t = 93/30},
        },
    },
   ["reload_30rnd"] = {
       Source = "reload_30rnd",
       TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
       LHIK = true,
       LHIKIn = 0.3,
       LHIKOut = 0.65,
       LHIKEaseOut = 0.25,
       MinProgress = 1.3,
       SoundTable = {
            {s = rottle,  t = 0.0},
            {s = ratel, t = 3/30},
            {s = path .. "magout.ogg", 	 t = 11/30},
            {s = common .. "magpouch.ogg", t = 26/30},
            {s = ratel, t = 0.5},
            {s = rottle,  t = 0.75},
            {s = path .. "struggle.ogg", t = 39/30},
            {s = path .. "magin.ogg", t = 44/30},
            {s = ratel, t = 1.1},
            {s = rottle,  t = 1.15},
            {s = common .. "grab.ogg", t = 56/30},
            {s = common .. "shoulder.ogg", t = 61/30},
       },
   },
    ["reload_empty_30rnd"] = {
        Source = "reload_empty_30rnd",
        RareSource = "reload_empty_30rnd_rare",
        RareSourceChance = 100,
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0.5,
        LHIKEaseOut = 0.25,
        MinProgress = 2.1,
        LastClip1OutTime = 50/30,
        SoundTable = {
            {s = rottle,  t = 0.0},
            {s = path .. "chback.ogg", t = 6/30, v = 1.95},
            {s = path .. "chlock.ogg", t = 13/30, v = 1.95},
            {s = ratel,  t = 22/30},
            {s = rottle,  t = 23/30},
            {s = path .. "magrel.ogg", t = 27/30},
            {s = path .. "magout.ogg", t = 30/30},
            {s = common .. "magpouch.ogg", t = 47/30},
            {s = rottle,  t = 49/30},
            {s = rottle,  t = 55/30},
            {s = {common .. "rifle_magdrop_1.ogg",common .. "rifle_magdrop_2.ogg",common .. "rifle_magdrop_3.ogg",common .. "rifle_magdrop_4.ogg",common .. "rifle_magdrop.ogg"}, t = 51/30, v = 0.25},
            {s = path .. "struggle.ogg", t = 57/30},
            {s = path .. "magin.ogg", t = 62/30},
            {s = rottle,  t = 75/30},
            {s = path .. "chslap.ogg", t = 80/30},
            {s = ratel,  t = 81/30},
            {s = common .. "grab.ogg", t = 92/30},
            {s = common .. "shoulder.ogg", t = 93/30},
        },
    },
    ["reload_empty_30rnd_scope"] = {
        Source = "reload_empty_scope_30rnd",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0.5,
        LHIKEaseOut = 0.25,
        MinProgress = 2.1,
        LastClip1OutTime = 50/30,
        SoundTable = {
            {s = rottle,  t = 0.0},
            {s = path .. "chback.ogg", t = 6/30, v = 1.95},
            {s = path .. "chlock.ogg", t = 13/30, v = 1.95},
            {s = ratel,  t = 22/30},
            {s = rottle,  t = 23/30},
            {s = path .. "magrel.ogg", t = 27/30},
            {s = path .. "magout.ogg", t = 30/30},
            {s = common .. "magpouch.ogg", t = 47/30},
            {s = rottle,  t = 49/30},
            {s = rottle,  t = 55/30},
            {s = {common .. "rifle_magdrop_1.ogg",common .. "rifle_magdrop_2.ogg",common .. "rifle_magdrop_3.ogg",common .. "rifle_magdrop_4.ogg",common .. "rifle_magdrop.ogg"}, t = 51/30, v = 0.25},
            {s = path .. "struggle.ogg", t = 57/30},
            {s = path .. "magin.ogg", t = 62/30},
            {s = rottle,  t = 75/30},
            {s = path .. "chlock.ogg", t = 75/30, v = 1.95},
            {s = path .. "chamber.ogg", t = 80/30},
            {s = ratel,  t = 81/30},
            {s = common .. "grab.ogg", t = 92/30},
            {s = common .. "shoulder.ogg", t = 93/30},
        },
    },
   ["reload_10rnd"] = {
       Source = "reload_10rnd",
       TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
       LHIK = true,
       LHIKIn = 0.3,
       LHIKOut = 0.65,
       LHIKEaseOut = 0.25,
       MinProgress = 1.3,
       SoundTable = {
            {s = rottle,  t = 0.0},
            {s = ratel, t = 3/30},
            {s = path .. "magout.ogg", 	 t = 10/30},
            {s = common .. "magpouch.ogg", t = 26/30},
            {s = ratel, t = 0.5},
            {s = rottle,  t = 0.75},
            {s = path .. "struggle.ogg", t = 36/30},
            {s = path .. "magin.ogg", t = 42/30},
            {s = ratel, t = 1.1},
            {s = rottle,  t = 1.15},
            {s = common .. "grab.ogg", t = 52/30},
            {s = common .. "shoulder.ogg", t = 56/30},
       },
   },
    ["reload_empty_10rnd"] = {
        Source = "reload_empty_10rnd",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0.5,
        LHIKEaseOut = 0.25,
        MinProgress = 2.1,
        LastClip1OutTime = 50/30,
        SoundTable = {
            {s = rottle,  t = 0.0},
            {s = path .. "chback.ogg", t = 6/30, v = 1.95},
            {s = path .. "chlock.ogg", t = 13/30, v = 1.95},
            {s = ratel,  t = 22/30},
            {s = rottle,  t = 23/30},
            {s = path .. "magrel.ogg", t = 27/30},
            {s = path .. "magout.ogg", t = 30/30},
            {s = common .. "magpouch.ogg", t = 47/30},
            {s = rottle,  t = 49/30},
            {s = rottle,  t = 55/30},
            {s = {common .. "rifle_magdrop_1.ogg",common .. "rifle_magdrop_2.ogg",common .. "rifle_magdrop_3.ogg",common .. "rifle_magdrop_4.ogg",common .. "rifle_magdrop.ogg"}, t = 51/30, v = 0.25},
            {s = path .. "struggle.ogg", t = 57/30},
            {s = path .. "magin.ogg", t = 62/30},
            {s = rottle,  t = 75/30},
            {s = path .. "chslap.ogg", t = 80/30},
            {s = ratel,  t = 81/30},
            {s = common .. "grab.ogg", t = 92/30},
            {s = common .. "shoulder.ogg", t = 93/30},
        },
    },
    ["reload_empty_10rnd_scope"] = {
        Source = "reload_empty_scope_10rnd",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0.5,
        LHIKEaseOut = 0.25,
        MinProgress = 2.1,
        LastClip1OutTime = 50/30,
        SoundTable = {
            {s = rottle,  t = 0.0},
            {s = path .. "chback.ogg", t = 6/30, v = 1.95},
            {s = path .. "chlock.ogg", t = 13/30, v = 1.95},
            {s = ratel,  t = 22/30},
            {s = rottle,  t = 23/30},
            {s = path .. "magrel.ogg", t = 27/30},
            {s = path .. "magout.ogg", t = 30/30},
            {s = common .. "magpouch.ogg", t = 47/30},
            {s = rottle,  t = 49/30},
            {s = rottle,  t = 55/30},
            {s = {common .. "rifle_magdrop_1.ogg",common .. "rifle_magdrop_2.ogg",common .. "rifle_magdrop_3.ogg",common .. "rifle_magdrop_4.ogg",common .. "rifle_magdrop.ogg"}, t = 51/30, v = 0.25},
            {s = path .. "struggle.ogg", t = 57/30},
            {s = path .. "magin.ogg", t = 62/30},
            {s = rottle,  t = 74/30},
            {s = path .. "chlock.ogg", t = 75/30, v = 1.95},
            {s = path .. "chamber.ogg", t = 80/30},
            {s = ratel,  t = 81/30},
            {s = common .. "grab.ogg", t = 92/30},
            {s = common .. "shoulder.ogg", t = 93/30},
        },
    },
   ["reload_50rnd"] = {
       Source = "reload_50rnd",
       TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
       LHIK = true,
       LHIKIn = 0.3,
       LHIKOut = 0.65,
       LHIKEaseOut = 0.25,
       MinProgress = 1.3,
       SoundTable = {
            {s = rottle,  t = 0.0},
            {s = ratel, t = 3/30},
            {s = path .. "magout.ogg", 	 t = 11/30},
            {s = common .. "magpouch.ogg", t = 26/30},
            {s = ratel, t = 0.5},
            {s = rottle,  t = 0.75},
            {s = path .. "struggle.ogg", t = 42/30},
            {s = path .. "magin.ogg", t = 48/30},
            {s = ratel, t = 1.1+5/30},
            {s = rottle,  t = 1.15+5/30},
            {s = common .. "grab.ogg", t = 58/30},
            {s = common .. "shoulder.ogg", t = 62/30},
       },
   },
    ["reload_empty_50rnd"] = {
        Source = "reload_empty_50rnd",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0.5,
        LHIKEaseOut = 0.25,
        MinProgress = 2.1,
        LastClip1OutTime = 50/30,
        SoundTable = {
            {s = rottle,  t = 0.0},
            {s = path .. "chback.ogg", t = 6/30, v = 1.95},
            {s = path .. "chlock.ogg", t = 13/30, v = 1.95},
            {s = ratel,  t = 22/30},
            {s = rottle,  t = 23/30},
            {s = path .. "magrel.ogg", t = 27/30},
            {s = path .. "magout.ogg", t = 30/30},
            {s = common .. "magpouch.ogg", t = 47/30},
            {s = rottle,  t = 49/30},
            {s = rottle,  t = 55/30},
            {s = {common .. "rifle_magdrop_1.ogg",common .. "rifle_magdrop_2.ogg",common .. "rifle_magdrop_3.ogg",common .. "rifle_magdrop_4.ogg",common .. "rifle_magdrop.ogg"}, t = 51/30, v = 0.25},
            {s = path .. "struggle.ogg", t = 62/30},
            {s = path .. "magin.ogg", t = 67/30},
            {s = rottle,  t = 80/30},
            {s = path .. "chslap.ogg", t = 85/30},
            {s = ratel,  t = 86/30},
            {s = common .. "grab.ogg", t = 97/30},
            {s = common .. "shoulder.ogg", t = 98/30},
        },
    },
    ["reload_empty_50rnd_scope"] = {
        Source = "reload_empty_scope_50rnd",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_AR2,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0.5,
        LHIKEaseOut = 0.25,
        MinProgress = 2.1,
        LastClip1OutTime = 50/30,
        SoundTable = {
            {s = rottle,  t = 0.0},
            {s = path .. "chback.ogg", t = 6/30, v = 1.95},
            {s = path .. "chlock.ogg", t = 13/30, v = 1.95},
            {s = ratel,  t = 22/30},
            {s = rottle,  t = 23/30},
            {s = path .. "magrel.ogg", t = 27/30},
            {s = path .. "magout.ogg", t = 30/30},
            {s = common .. "magpouch.ogg", t = 47/30},
            {s = rottle,  t = 49/30},
            {s = rottle,  t = 55/30},
            {s = {common .. "rifle_magdrop_1.ogg",common .. "rifle_magdrop_2.ogg",common .. "rifle_magdrop_3.ogg",common .. "rifle_magdrop_4.ogg",common .. "rifle_magdrop.ogg"}, t = 51/30, v = 0.25},
            {s = path .. "struggle.ogg", t = 62/30},
            {s = path .. "magin.ogg", t = 67/30},
            {s = rottle,  t = 80/30},
            {s = path .. "chlock.ogg", t = 75/30, v = 1.95},
            {s = path .. "chamber.ogg", t = 85/30},
            {s = ratel,  t = 86/30},
            {s = common .. "grab.ogg", t = 97/30},
            {s = common .. "shoulder.ogg", t = 98/30},
        },
    },
    ["unjam"] = {
        Source = "jamfix",
        ShellEjectAt = 0.5,
        SoundTable = {
            {s = common .. "cloth_4.ogg",  t = 0.1},
            {s = path .. "chback.ogg",    t = 0.3},
            {s = path .. "chamber.ogg",    t = 0.6},
            {s = common .. "grab.ogg", t = 0.9},
            {s = common .. "shoulder.ogg", t = 0.95},
        },
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseOut = 0.3,
        LHIKOut = 0.6,
    },

    ["enter_inspect"] = {
        Source = "inspect_enter",
        -- time = 35 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 2.5,
        SoundTable = {
            {s = rottle, t = 0},
            {s = common .. "movement-rifle-02.ogg", t = 0.1},
        },
    },
    ["idle_inspect"] = {
        Source = "inspect_loop",
        -- time = 72 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 999, -- maybe im dumb
    },
    ["exit_inspect"] = {
        Source = "inspect_exit",
        -- time = 66 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 999, -- maybe im dumb
        SoundTable = {
            {s = common .. "movement-rifle-04.ogg", t = 0.2},
            {s = rottle, t = 0.25},
            {s = rottle, t = 1.2},
            {s = common .. "movement-rifle-03.ogg", t = 1.25},
        },
    },
}

-- SWEP.Hook_Think = ArcCW.UC.ADSReload

SWEP.Hook_Think = function(wep)
    local vm = wep:GetOwner():GetViewModel()

    vm:SetPoseParameter("short", wep.Attachments[2].Installed == "ur_g3_barrel_8" and 1 or 0)

    ArcCW.UC.ADSReload(wep)
end

SWEP.Hook_SelectReloadAnimation = function(wep, anim) -- not in atts cause _scope wont work
    local seq = anim

    if wep.Attachments[9].Installed == "ur_g3_mag_50" then
        seq = seq .. "_50rnd"
    elseif wep.Attachments[9].Installed == "ur_g3_mag_10" then
        seq = seq .. "_10rnd"
    elseif wep.Attachments[9].Installed == "ur_g3_mag_40_556" or wep.Attachments[3].Installed == "ur_g3_rec_hk33" and !wep.Attachments[9].Installed then
        seq = seq .. "_30rnd"
    end
    if anim == "reload_empty" and wep.Attachments[1].Installed then
        seq = seq .. "_scope"
    end

    return seq
end
--lua/weapons/arccw_ur_mp5.lua:
SWEP.Base = "arccw_base"
SWEP.Spawnable = true
SWEP.Category = "ArcCW - Urban Coalition"
SWEP.UC_CategoryPack = "2Urban Renewal"
SWEP.AdminOnly = false
SWEP.UseHands = true

-- Effects --

SWEP.MuzzleEffect = "muzzleflash_mp5"
SWEP.ShellEffect = "arccw_uc_shelleffect"
SWEP.ShellModel = "models/weapons/arccw/uc_shells/9x19.mdl"
SWEP.ShellScale = 1
--SWEP.ShellMaterial = "models/weapons/arcticcw/shell_9mm"
SWEP.ShellPitch = 100
SWEP.ShellSounds = ArcCW.PistolShellSoundsTable

SWEP.MuzzleEffectAttachment = 1
SWEP.CaseEffectAttachment = 2
-- SWEP.CamAttachment = 3 ---------------------------------------------------------------------------
-- SWEP.TracerNum = 1
-- SWEP.TracerCol = Color(25, 255, 25)
-- SWEP.TracerWidth = 2

-- Fake name --

SWEP.PrintName = "PK5-4"

-- True name --

SWEP.TrueName = "MP5A4"

-- Trivia --

SWEP.Trivia_Class = "Submachine Gun"
SWEP.Trivia_Desc = [[Versatile submachine gun known for its use by high profile police units around the world, most famously by the British SAS during the Iranian embassy siege. Its reliable closed-bolt design and craftsmanship allowed it to remain relevant among new generations of submachine guns.

If accurate, sophisticated close-combat performance is what you're looking for, no weapon has a better track record.

Switch to burst fire mode to reduce dispersion from moving and hipfiring.]]
SWEP.Trivia_Manufacturer = "Crowdley & Nelson"
SWEP.Trivia_Calibre = "9x19mm Parabellum"
SWEP.Trivia_Mechanism = "Roller-Delayed Blowback"
SWEP.Trivia_Country = "Germany"
SWEP.Trivia_Year = 1966

-- Weapon slot --

SWEP.Slot = 2

-- Weapon's manufacturer real name --

if GetConVar("arccw_truenames"):GetBool() then
    SWEP.PrintName = SWEP.TrueName
    SWEP.Trivia_Manufacturer = "Heckler & Koch"
end

-- Viewmodel / Worldmodel / FOV --

SWEP.ViewModel = "models/weapons/arccw/c_ur_mp5.mdl"
SWEP.WorldModel = "models/weapons/arccw/c_ur_mp5.mdl"
SWEP.ViewModelFOV = 70
SWEP.AnimShoot = ACT_HL2MP_GESTURE_RANGE_ATTACK_AR2
SWEP.ProceduralIronFire = true

-- Damage --

SWEP.Damage = ArcCW.UC.StdDmg["9mm"].max
SWEP.DamageMin = ArcCW.UC.StdDmg["9mm"].min
SWEP.Penetration = ArcCW.UC.StdDmg["9mm"].pen
SWEP.RangeMin = 20
SWEP.Range = 100

SWEP.DamageType = DMG_BULLET
SWEP.ShootEntity = nil
SWEP.MuzzleVelocity = 400
SWEP.PhysBulletMuzzleVelocity = 400

SWEP.BodyDamageMults = ArcCW.UC.BodyDamageMults

-- Mag size --

SWEP.ChamberSize = 1
SWEP.Primary.ClipSize = 30
SWEP.ExtendedClipSize = 40
SWEP.ReducedClipSize = 15

-- Recoil --

SWEP.Recoil = 0.22
SWEP.RecoilSide = 0.17

SWEP.RecoilRise = 0.6
SWEP.RecoilPunch = 1
SWEP.VisualRecoilMult = 1.25
SWEP.MaxRecoilBlowback = 1
SWEP.MaxRecoilPunch = 0.6
SWEP.RecoilPunchBack = 1.5

SWEP.Sway = 0.25

-- Firerate / Firemodes --

SWEP.Delay = 60 / 800
SWEP.Num = 1
SWEP.Firemodes = {
    {
        Mode = 2,
    },
    {
        Mode = -3,
        Mult_MoveDispersion = 0.75,
        Mult_HipDispersion = 0.9,
    },
    {
        Mode = 1,
    },
    {
        Mode = 0,
    },
}

SWEP.ShootPitch = 100
SWEP.ShootVol = 120

SWEP.ProceduralRegularFire = false
SWEP.ProceduralIronFire = false

SWEP.ReloadInSights = true

-- NPC --

SWEP.NPCWeaponType = "weapon_smg1"
SWEP.NPCWeight = 60

-- Accuracy --

SWEP.AccuracyMOA = 3
SWEP.HipDispersion = 500
SWEP.MoveDispersion = 150
SWEP.JumpDispersion = 1000

SWEP.Primary.Ammo = "pistol"
SWEP.MagID = "mp5"

SWEP.HeatCapacity = 75
SWEP.HeatDissipation = 15
SWEP.HeatDelayTime = 3

SWEP.MalfunctionMean = 200

-- Speed multipliers --

SWEP.SpeedMult = 0.925
SWEP.SightedSpeedMult = 0.75
SWEP.SightTime = 0.3
SWEP.ShootSpeedMult = 0.95

-- Length --

SWEP.BarrelLength = 24
SWEP.ExtraSightDist = 2

-- Ironsights / Customization / Poses --

SWEP.HolsterPos = Vector(0.5, -2, 1)
SWEP.HolsterAng = Angle(-8.5, 8, -10)

SWEP.HoldtypeHolstered = "passive"
SWEP.HoldtypeActive = "ar2"
SWEP.HoldtypeSights = "rpg"

SWEP.IronSightStruct = {
     Pos = Vector(-3.17, -1, 0.6),
     Ang = Angle(0.45, 0, 0),
     Magnification = 1,
     SwitchToSound = "",
     ViewModelFOV = 60,
}

SWEP.ActivePos = Vector(-0.3, 1.1, 0.6)
SWEP.ActiveAng = Angle(0, 0, -1)

-- SWEP.SprintPos = Vector(-0.5, 3, 1.5)
-- SWEP.SprintAng = Angle(-12, 15, -15)

SWEP.SprintPos = Vector(0, -3, 0)
SWEP.SprintAng = Angle(0, 0, 0)
-- SWEP.CustomizePos = Vector(6, -2, -1.5)
-- SWEP.CustomizeAng = Angle(16, 28, 0)
SWEP.CustomizePos = Vector(0, 0, 0)
SWEP.CustomizeAng = Angle(0, 0, 0)

SWEP.CrouchPos = Vector(-2, 0.5, 0)
SWEP.CrouchAng = Angle(0, 0, -14)

SWEP.BarrelOffsetHip = Vector(4, 0, -4)

SWEP.MirrorVMWM = true
SWEP.WorldModelOffset = {
    pos        =    Vector(-8, 4, -5),
    ang        =    Angle(-12, 0, 180),
    bone    =    "ValveBiped.Bip01_R_Hand",
    scale = 1
}

-- Firing sounds --
local path = ")weapons/arccw_ur/mp5/"
local common = ")/arccw_uc/common/"

SWEP.ShootSound = {
    path .. "fire-01.ogg",
    path .. "fire-02.ogg",
    path .. "fire-03.ogg"
}
SWEP.ShootSoundSilenced = {
    path .. "fire-sup-01.ogg",
    path .. "fire-sup-02.ogg",
    path .. "fire-sup-03.ogg",
    path .. "fire-sup-04.ogg",
    path .. "fire-sup-05.ogg",
    path .. "fire-sup-06.ogg"
}
SWEP.DistantShootSound = nil
SWEP.DistantShootSoundSilenced = nil
SWEP.ShootDrySound = path .. "dryfire.ogg"

SWEP.DistantShootSoundOutdoors = {
    path .. "fire-dist-01.ogg",
    path .. "fire-dist-02.ogg",
    path .. "fire-dist-03.ogg",
    path .. "fire-dist-04.ogg",
    path .. "fire-dist-05.ogg",
    path .. "fire-dist-06.ogg"
}
SWEP.DistantShootSoundIndoors = {
    common .. "fire-dist-int-pistol-01.ogg",
    common .. "fire-dist-int-pistol-02.ogg",
    common .. "fire-dist-int-pistol-03.ogg",
    common .. "fire-dist-int-pistol-04.ogg",
    common .. "fire-dist-int-pistol-05.ogg",
    common .. "fire-dist-int-pistol-06.ogg"
}
SWEP.DistantShootSoundOutdoorsSilenced = {
    common .. "sup-tail-01.ogg",
    common .. "sup-tail-02.ogg",
    common .. "sup-tail-03.ogg",
    common .. "sup-tail-04.ogg",
    common .. "sup-tail-05.ogg",
    common .. "sup-tail-06.ogg",
    common .. "sup-tail-07.ogg",
    common .. "sup-tail-08.ogg",
    common .. "sup-tail-09.ogg",
    common .. "sup-tail-10.ogg"
}
SWEP.DistantShootSoundIndoorsSilenced = {
    common .. "fire-dist-int-pistol-light-01.ogg",
    common .. "fire-dist-int-pistol-light-02.ogg",
    common .. "fire-dist-int-pistol-light-03.ogg",
    common .. "fire-dist-int-pistol-light-04.ogg",
    common .. "fire-dist-int-pistol-light-05.ogg",
    common .. "fire-dist-int-pistol-light-06.ogg"
}
SWEP.DistantShootSoundOutdoorsVolume = 1
SWEP.DistantShootSoundIndoorsVolume = 0.6
SWEP.Hook_AddShootSound = ArcCW.UC.InnyOuty

-- Bodygroups --

SWEP.BulletBones = {
    -- [1] = "uzi_b1", [2] = "uzi_b2", [3] = "uzi_b3", [4] = "uzi_b4"
}

--[[

1 --- 	id: 0
     [	name: iron
    num: 1
    submodels:
    0 --- ironSIGHT.smd
2 --- 	id: 1
     [	name: 1
    num: 4
    submodels:
    0 --- mp5UPPER.smd
    1 --- mp5sdUPPER.smd
    2 --- mp5kUPPER.smd
    3 --- swordUPPER.smd
3 --- 	id: 2
     [	name: 2
    num: 2
    submodels:
    0 --- fourLOWER.smd
    1 --- sefLOWER.smd
4 --- 	id: 3
     [	name: 3
    num: 11
    submodels:
    0 --- fixedSTOCK.smd
    1 --- collapseSTOCK.smd
    2 --- collapseSTOCKcoll.smd
    3 --- pdwSTOCK.smd
    4 --- pdwSTOCKfold.smd
    5 --- tacticSTOCK.smd
    6 --- tacticSTOCKfold.smd
    7 --- futureSTOCK.smd
    8 --- futureSTOCKcoll.smd
    9 --- futureSTOCKfold.smd
    10 --- buttSTOCK.smd
5 --- 	id: 4
     [	name: 4
    num: 10
    submodels:
    0 --- standardHG.smd
    1 --- flashHG.smd
    2 --- flashmlokHG.smd
    3 --- slimHG.smd
    4 --- picaHG.smd
    5 --- mlokHG.smd
    6 --- kurzgripHG.smd
    7 --- kurzslimHG.smd
    8 --- kurzmlokHG.smd
    9 ---
6 --- 	id: 5
     [	name: 5
    num: 4
    submodels:
    0 --- standardMAG.smd
    1 --- smallMAG.smd
    2 --- straightMAG.smd
    3 --- drumMAG.smd
7 --- 	id: 6
     [	name: 6
    num: 2
    submodels:
    0 ---
    1 --- mp5RAIL.smd

]]

SWEP.AttachmentElements = {
    ["ur_mp5_barrel_sd"] = {
        VMBodygroups = {
            {ind = 1, bg = 1},
            {ind = 4, bg = 9},
            //{ind = 8, bg = 1},
        },
        AttPosMods = {
            [6] = {
                vpos = Vector(0, 1.3, 10),
                vang = Angle(90, 0, -90),
            },
            [7] = {
				vpos = Vector(-1.15, 0.3, 8),
				vang = Angle(90, 0, 180),
			},
        },
    },
    ["ur_mp5_barrel_eod"] = {
        VMBodygroups = {
            {ind = 4, bg = 10},
            //{ind = 8, bg = 2},
        },
        AttPosMods = {
            [6] = {
                vpos = Vector(0, 1.5, 10),
                vang = Angle(90, 0, -90),
            },
            [7] = {
				vpos = Vector(-0.95, 0.3, 8),
				vang = Angle(90, 0, 180),
			},
		}
    },
    ["ur_mp5_barrel_kurz"] = {
        VMBodygroups = {
            {ind = 1, bg = 2},
            {ind = 4, bg = 7},
        },
        AttPosMods = {[4] = {
            vpos = Vector(-0.1, 0.3, 11.5),
            vang = Angle(90, 0, -90),
        }}
    },
    ["ur_mp5_barrel_swordfish"] = {
        VMBodygroups = {
            --{ind = 0, bg = 1},
            {ind = 1, bg = 3},
            {ind = 6, bg = 0},
        },
    },

    ["ur_mp5_rail_fg"] = {
        VMBodygroups = {{ind = 4, bg = 4}},
    },
    ["ur_mp5_ub_classic"] = {
        VMBodygroups = {{ind = 4, bg = 3}},
    },
    ["ur_mp5_ub_surefire"] = {
        VMBodygroups = {{ind = 4, bg = 1}},
    },
    ["ur_mp5_ub_surelock"] = {
        VMBodygroups = {{ind = 4, bg = 2}},
    },
    ["ur_mp5_ub_kurzgrip"] = {
        VMBodygroups = {{ind = 4, bg = 6}},
    },
    ["ur_mp5_ub_kurzmlok"] = {
        VMBodygroups = {{ind = 4, bg = 8}},
    },
    ["ur_mp5_ub_wood"] = {
        VMBodygroups = {{ind = 4, bg = 3}}, -- insert wood handguard here
    },

    ["ur_mp5_mag_15"] = {
        VMBodygroups = {{ind = 5, bg = 1}},
    },
    ["ur_mp5_mag_40"] = {
        VMBodygroups = {{ind = 5, bg = 3}},
    },
    ["ur_mp5_mag_50"] = {
        VMBodygroups = {{ind = 5, bg = 3}},
    },
    ["ur_mp5_mag_waffle"] = {
        VMBodygroups = {{ind = 5, bg = 2}},
    },

    ["ur_mp5_rail_optic"] = {
        VMBodygroups = {{ind = 6, bg = 1}},
    },

    ["ur_mp5_clamp"] = {
        VMBodygroups = {{ind = 5, bg = 1}},
    },

    ["receiver_lower"] = {
        VMBodygroups = {{ind = 2, bg = 1}},
    },
    ["receiver_lower_semi"] = {
        VMBodygroups = {{ind = 2, bg = 2}},
    },
    ["receiver_lower_0"] = {
        VMBodygroups = {{ind = 2, bg = 0}},
    },
    ["receiver_upper_0"] = {
        VMBodygroups = {{ind = 7, bg = 0}},
    },

    ["stock_a3"] = {
        VMBodygroups = {
            {ind = 3, bg = 1},
        },
    },
    ["stock_a3_folded"] = {
        VMBodygroups = {
            {ind = 3, bg = 2},
        },
    },
    ["ur_mp5_stock_remove"] = {
        VMBodygroups = {{ind = 3, bg = 10}},
    },
    ["ur_mp5_stock_wood"] = {
        -- VMBodygroups = {{ind = 0, bg = 4}},
        -- Make this part of the VMSkin
    },
    ["stock_pdw"] = {
        VMBodygroups = {{ind = 3, bg = 3}},
    },
    ["stock_pdw_folded"] = {
        VMBodygroups = {{ind = 3, bg = 4}},
    },
    ["stock_ump"] = {
        VMBodygroups = {{ind = 3, bg = 5}},
    },
    ["stock_ump_folded"] = {
        VMBodygroups = {{ind = 3, bg = 6}},
    },
    ["stock_future"] = {
        VMBodygroups = {{ind = 3, bg = 7}},
    },
    ["stock_future_folded"] = {
        VMBodygroups = {{ind = 3, bg = 8}},
    },
    ["ur_mp5_precision_irons"] = {
        VMBodygroups = {
            {ind = 0, bg = 2},
            {ind = 6, bg = 0},
            },
    },
}

SWEP.Hook_ModifyBodygroups = function(wep, data)
    local atts = wep.Attachments
    local vm = data.vm
    if IsValid(vm) then
        local barr = string.Replace(atts[2].Installed or "default","ur_mp5_barrel_","")
        local hg = string.Replace(atts[5].Installed or "default","ur_mp5_ub_","")
        
        if atts[6].Installed or atts[7].Installed then
            if barr == "sd" then
                vm:SetBodygroup(8, 1)
            elseif barr == "eod" then
                vm:SetBodygroup(8, 2)
            elseif hg == "default" or hg == "classic" then
                vm:SetBodygroup(4, 4)
                vm:SetBodygroup(8, 0)
            else
                vm:SetBodygroup(8, 0)
            end
        else
            vm:SetBodygroup(8, 0)
        end

        if hg == "mlok" then
            if barr == "kurz" then
                vm:SetBodygroup(4,8)
            else
                vm:SetBodygroup(4,5)
            end
        end

        if barr == "sword" then
            vm:SetBodygroup(0,(atts[1].Installed and 3) or 1)
        end
    end
end

SWEP.Hook_NameChange = function(wep,name)
    local atts = wep.Attachments
    local barr = string.Replace(atts[2].Installed or "default","ur_mp5_barrel_","")
    local cal = string.Replace(atts[3].Installed or "default","ur_mp5_caliber_","")
    local stock = string.Replace(atts[8].Installed or "default","ur_mp5_stock_","")
    local fakeNames = !GetConVar("arccw_truenames"):GetBool()
    local defaultCals = {
        ["default"] = true,
        ["noburst"] = true,
        ["semi"] = true
    }

    local start = "MP5"
    local mid = "A"
    local num = "4"
    if fakeNames then
        start = "PK5"
        mid = "-"
    end

    if cal == "semi" or atts[12].Installed == "uc_fg_civvy" then
        if fakeNames then
            return "PK5-CIV"
        else
            if barr == "long" or barr == "sd" then
                start = "HK94" -- I know how prolific civies can get with their gunbuilds, so the nonsensical names will continue
            else
                return "SP5" .. ((barr == "kurz" and "K-PDW") or "")
            end
        end
    end

    if !defaultCals[cal] then
        if barr == "sd" then
            num = "SD"
        else
            num = ""
        end
        if cal == "10auto" then
            mid = "/10"
        elseif cal == "40sw" then
            mid = "/40"
        elseif cal == "22lr" then
            if barr == "sd" then
                mid = "SD"
                num = " .22 LR"
            else
                mid = " .22 LR"
            end
        end
    else
        if barr == "kurz" then
            if fakeNames then
                mid = "C"
            else
                mid = "K"
            end
            if stock == "pdw" then
                num = "-PDW"
            elseif cal == "default" then
                if fakeNames then
                    num = "-4"
                else
                    num = "A4"
                end
            else
                num = ""
            end
        else
            if barr == "sd" then
                mid = "SD"
            end

            if cal == "noburst" or cal == "semi" then
                if stock == "a3" then
                    num = "3"
                elseif stock == "none" then
                    num = "1"
                else
                    num = "2"
                end
            else
                if stock == "a3" then
                    if barr == "sd" then
                        num = "6"
                    else
                        num = "5"
                    end
                elseif stock == "none" then
                    if barr == "sd" then
                        num = "4"
                    end
                else
                    if barr == "sd" then
                        num = "5"
                    end
                end
            end
        end
    end

    return start .. mid .. num
end

-- Animations --

SWEP.Hook_Think = ArcCW.UC.ADSReload

local ratel = {common .. "rattle1.ogg", common .. "rattle2.ogg", common .. "rattle3.ogg"}
local rottle = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}
local rutle = {common .. "movement-smg-03.ogg",common .. "movement-smg-04.ogg"}

SWEP.Animations = {
    ["idle"] = {
        Source = "idle",
    },
    -- ["idle_empty"] = {
    --     Source = "idle",
    -- },
    ["ready"] = {
        Source = "ready",
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.6,
        SoundTable = {
            {s = rottle, t = 0.15},
            {s = path .. "rack1.ogg",         t = 0.15, c = ci},
            {s = path .. "rack2.ogg",         t = 0.38, c = ci},
            {s = ratel,         t = 0.75},
        }
    },
    ["draw"] = {
        Source = "draw",
        SoundTable = ArcCW.UC.DrawSounds,
    },
    -- ["draw_empty"] = {
    --     Source = "draw_empty",
    --     SoundTable = ArcCW.UC.DrawSounds,
    -- },
    ["holster"] = {
        Source = "holster",
        --Time = 0.25,
        SoundTable = ArcCW.UC.HolsterSounds,
    },
    -- ["holster_empty"] = {
    --     Source = "holster_empty",
    --     --Time = 0.25,
    --     SoundTable = ArcCW.UC.HolsterSounds,
    -- },
    ["fire"] = {
        Source = "fire",
        Time = 13 / 30,
        ShellEjectAt = 0.03,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0, v = 0.25 }},
    },
    -- ["fire_empty"] = {
    --     Source = "fire",
    --     Time = 13 / 30,
    --     ShellEjectAt = 0.03,
    --     SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0 }},
    -- },
    ["fire_iron"] = {
        Source = "idle",
        Time = 13 / 30,
        ShellEjectAt = 0.03,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0 }},
    },
    -- ["fire_empty_iron"] = {
    --     Source = "idle",
    --     Time = 13 / 30,
    --     ShellEjectAt = 0.03,
    --     SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0 }},
    -- },

    ["fix"] = {
        Source = "fix",
        Time = 40 / 30,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.4,
        ShellEjectAt = 0.36,
        SoundTable = {
            {s = rottle, t = 0.15},
            {s = path .. "rack1.ogg",         t = 0.27, c = ci},
            {s = path .. "rack2.ogg",         t = 0.5, c = ci},
        },
    },

    -- 30 Round Reloads --

    ["reload"] = {
        Source = "reload",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        -- Time = 2,
        MinProgress = 1.2,
        LastClip1OutTime = 2,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.6,
        SoundTable = {
            {s = rottle, t = 0},
            {s = common .. "magpouch.ogg", t = 0.05},
            {s = path .. "magout.ogg",        t = 0.4, c = ci},
            {s = rottle, t = 0.25},
            {s = path .. "magin.ogg",         t = 0.61, c = ci},
            {s = common .. "magpouchin.ogg", t = 1.25},
            {s = ratel,  t = 1.55},
            {s = common .. "shoulder.ogg",  t = 1.5},
        },
    },
    ["reload_empty"] = {
        Source = "reload_empty",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        -- Time = 90 / 30,
        MinProgress = 2.2,
        LastClip1OutTime = 1.8,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.3,
        LHIKEaseOut = 0.2,
        LHIKOut = 0.55,
        SoundTable = {
            {s = rottle, t = 0},
            {s = path .. "chback.ogg",         t = 0.045, c = ci},
            {s = path .. "chlock.ogg",         t = 0.18, c = ci},
            {s = common .. "magpouch.ogg", t = 0.4},
            {s = path .. "magout.ogg",        t = 0.86, c = ci},
            {s = rottle, t = 0.25},
            {s = path .. "magin.ogg",         t = 1.13, c = ci},
            {s = common .. "magdrop_smg.ogg",  t = 1.5},
            {s = rottle, t = 1.25},
            {s = path .. "chamber.ogg",         t = 2.05, c = ci},
            {s = ratel,  t = 2.4},
            {s = common .. "shoulder.ogg",  t = 2.6},
        },
    },
    ["reload_kurz"] = {
        Source = "reload",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        -- Time = 2,
        MinProgress = 1.2,
        LastClip1OutTime = 2,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.6,
        SoundTable = {
            {s = rottle, t = 0},
            {s = common .. "magpouch.ogg", t = 0.05},
            {s = path .. "magout.ogg",        t = 0.4, c = ci},
            {s = rottle, t = 0.25},
            {s = path .. "magin.ogg",         t = 0.63, c = ci},
            {s = common .. "magpouchin.ogg", t = 1.25},
            {s = ratel,  t = 1.55},
            {s = common .. "shoulder.ogg",  t = 1.5},
        },
    },
    ["reload_empty_kurz"] = {
        Source = "reload_empty_kurz",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        -- Time = 90 / 30,
        MinProgress = 2.2,
        LastClip1OutTime = 1.8,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.3,
        LHIKEaseOut = 0.2,
        LHIKOut = 0.55,
        SoundTable = {
            {s = rottle, t = 0},
            {s = path .. "chback.ogg",         t = 0.066, c = ci},
            {s = path .. "chlock.ogg",         t = 0.2, c = ci},
            {s = common .. "magpouch.ogg", t = 0.4},
            {s = path .. "magout.ogg",        t = 0.86, c = ci},
            {s = rottle, t = 0.25},
            {s = path .. "magin.ogg",         t = 1.13, c = ci},
            {s = common .. "magdrop_smg.ogg",  t = 1.5},
            {s = rottle, t = 1.25},
            {s = path .. "chamber.ogg",         t = 2.1, c = ci},
            {s = ratel,  t = 2.4},
            {s = common .. "shoulder.ogg",  t = 2.6},
        },
    },

    -- 15 Round Reloads --

    ["reload_15"] = {
        Source = "reload",--"reload_15",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        -- Time = 67 / 30,
        MinProgress = 1.2,
        LastClip1OutTime = 67 / 30,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.6,
        SoundTable = {
            {s = rottle, t = 0},
            {s = common .. "magpouch.ogg", t = 0.05},
            {s = path .. "magout.ogg",        t = 0.25, c = ci},
            {s = rottle, t = 0.25},
            {s = path .. "magin.ogg",         t = 0.5, c = ci},
            {s = common .. "magpouchin.ogg", t = 1.25},
            {s = ratel,  t = 1.55},
            {s = common .. "shoulder.ogg",  t = 1.5},
        },
    },
    ["reload_empty_15"] = {
        Source = "reload_empty",--"reload_empty_15",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        -- Time = 90 / 30,
        MinProgress = 2.2,
        LastClip1OutTime = 1.8,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.3,
        LHIKEaseOut = 0.2,
        LHIKOut = 0.55,
        SoundTable = {
            {s = rottle, t = 0},
            {s = path .. "chback.ogg",         t = 0.1, c = ci},
            {s = path .. "chlock.ogg",         t = 0.19, c = ci},
            {s = common .. "magpouch.ogg", t = 0.4},
            {s = path .. "magout.ogg",        t = .9, c = ci},
            {s = rottle, t = 0.25},
            {s = path .. "magin.ogg",         t = 1.2, c = ci},
            {s = common .. "magdrop_smg.ogg",  t = 1.5},
            {s = rottle, t = 1.25},
            {s = path .. "chamber.ogg",         t = 2.13, c = ci},
            {s = ratel,  t = 2.4},
            {s = common .. "shoulder.ogg",  t = 2.6},
        },
    },
    ["reload_empty_kurz_15"] = {
        Source = "reload_empty_kurz",--"reload_empty_15",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        -- Time = 90 / 30,
        MinProgress = 2.2,
        LastClip1OutTime = 1.8,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.3,
        LHIKEaseOut = 0.2,
        LHIKOut = 0.55,
        SoundTable = {
            {s = rottle, t = 0},
            {s = path .. "chback.ogg",         t = 0.1, c = ci},
            {s = path .. "chlock.ogg",         t = 0.19, c = ci},
            {s = common .. "magpouch.ogg", t = 0.4},
            {s = path .. "magout.ogg",        t = .9, c = ci},
            {s = rottle, t = 0.25},
            {s = path .. "magin.ogg",         t = 1.2, c = ci},
            {s = common .. "magdrop_smg.ogg",  t = 1.5},
            {s = rottle, t = 1.25},
            {s = path .. "chamber.ogg",         t = 2.13, c = ci},
            {s = ratel,  t = 2.4},
            {s = common .. "shoulder.ogg",  t = 2.6},
        },
    },

    -- 40 Round Reloads --

    ["reload_40"] = {
        Source = "reload",--"reload_40",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        -- Time = 67 / 30,
        MinProgress = 1.2,
        LastClip1OutTime = 67 / 30,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.6,
        SoundTable = {
            {s = rottle, t = 0},
            {s = common .. "magpouch.ogg", t = 0.05},
            {s = path .. "magout.ogg",        t = 0.25, c = ci},
            {s = rottle, t = 0.25},
            {s = path .. "magin.ogg",         t = 0.5, c = ci},
            {s = common .. "magpouchin.ogg", t = 1.25},
            {s = ratel,  t = 1.55},
            {s = common .. "shoulder.ogg",  t = 1.5},
        },
    },
    ["reload_empty_40"] = {
        Source = "reload_empty",--"reload_empty_40",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        -- Time = 90 / 30,
        MinProgress = 2.2,
        LastClip1OutTime = 1.8,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.3,
        LHIKEaseOut = 0.2,
        LHIKOut = 0.55,
        SoundTable = {
            {s = rottle, t = 0},
            {s = path .. "chback.ogg",         t = 0.1, c = ci},
            {s = path .. "chlock.ogg",         t = 0.19, c = ci},
            {s = common .. "magpouch.ogg", t = 0.4},
            {s = path .. "magout.ogg",        t = .9, c = ci},
            {s = rottle, t = 0.25},
            {s = path .. "magin.ogg",         t = 1.2, c = ci},
            {s = common .. "magdrop_smg.ogg",  t = 1.5},
            {s = rottle, t = 1.25},
            {s = path .. "chamber.ogg",         t = 2.13, c = ci},
            {s = ratel,  t = 2.4},
            {s = common .. "shoulder.ogg",  t = 2.6},
        },
    },
    ["reload_empty_kurz_40"] = {
        Source = "reload_empty_kurz",--"reload_empty_40",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        -- Time = 90 / 30,
        MinProgress = 2.2,
        LastClip1OutTime = 1.8,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.3,
        LHIKEaseOut = 0.2,
        LHIKOut = 0.55,
        SoundTable = {
            {s = rottle, t = 0},
            {s = path .. "chback.ogg",         t = 0.1, c = ci},
            {s = path .. "chlock.ogg",         t = 0.19, c = ci},
            {s = common .. "magpouch.ogg", t = 0.4},
            {s = path .. "magout.ogg",        t = .9, c = ci},
            {s = rottle, t = 0.25},
            {s = path .. "magin.ogg",         t = 1.2, c = ci},
            {s = common .. "magdrop_smg.ogg",  t = 1.5},
            {s = rottle, t = 1.25},
            {s = path .. "chamber.ogg",         t = 2.13, c = ci},
            {s = ratel,  t = 2.4},
            {s = common .. "shoulder.ogg",  t = 2.6},
        },
    },

    -- 100 Round Reloads --

    ["reload_drum"] = {
        Source = "reload_drum",--"reload_50",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        -- Time = 67 / 30,
        MinProgress = 1.6,
        LastClip1OutTime = 1,
        LHIK = true,
        LHIKIn = 0.4,
        LHIKEaseIn = 0.4,
        LHIKEaseOut = 0.15,
        LHIKOut = 0.9,
        SoundTable = {
            {s = rottle, t = 0},
            {s = path .. "magout.ogg",        t = 0.32, c = ci},
            {s = rottle, t = 0.25},
            {s = rottle, t = 0.75},
            {s = path .. "magin.ogg",         t = 1.05, c = ci},
            {s = common .. "cloth_4.ogg",  t = 1.65},
            {s = path .. "magtap.ogg",         t = 1.755, c = ci},
            {s = common .. "shoulder.ogg",  t = 2.25},
        },
    },
    ["reload_empty_drum"] = {
        Source = "reload_empty_drum",--"reload_empty_50",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_SMG1,
        -- Time = 90 / 30,
        MinProgress = 2.4,
        LastClip1OutTime = 1.8,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKEaseIn = 0.3,
        LHIKEaseOut = 0.2,
        LHIKOut = 1,
        SoundTable = {
            {s = rottle, t = 0},
            {s = path .. "magout.ogg",        t = 0.3, c = ci},
            {s = rottle, t = 0.25},
            {s = rottle, t = 0.75},
            {s = common .. "magdrop.ogg",  t = 1.0},
            {s = path .. "magin.ogg",         t = 1.05, c = ci},
            {s = common .. "cloth_4.ogg",  t = 1.65},
            {s = path .. "magtap.ogg",         t = 1.755, c = ci},
            {s = path .. "rack1.ogg",         t = 2.3, c = ci},
            {s = path .. "rack2.ogg",         t = 2.5, c = ci},
            {s = common .. "shoulder.ogg",  t = 3.0},
        },
    },

    ["enter_inspect"] = {
        Source = "inspect_enter",
        -- time = 35 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 2.5,
        SoundTable = {
            {s = rottle, t = 0},
            {s = common .. "movement-smg-03.ogg", t = 0},
        },
    },
    ["idle_inspect"] = {
        Source = "inspect_loop",
        -- time = 72 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 999, -- maybe im dumb
    },
    ["exit_inspect"] = {
        Source = "inspect_exit",
        -- time = 66 / 60,
        LHIK = false,
        LHIKIn = 0,
        LHIKOut = 999, -- maybe im dumb
        SoundTable = {
            {s = common .. "movement-smg-01.ogg", t = 0.2},
            {s = rottle, t = 0.25},
            {s = rottle, t = 1.2},
            {s = common .. "movement-smg-04.ogg", t = 1.25},
        },
    },

    ["enter_sprint"] = {
        Source = "sprint_enter",
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKOut = 0,
        Time = .5,
    },
    ["idle_sprint"] = {
        Source = "sprint_loop",
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0,
    },
    ["exit_sprint"] = {
        Source = "sprint_exit",
        LHIK = true,
        LHIKIn = 0,
        LHIKEaseOut = 0.4,
        LHIKOut = 0.5,
        Time = .5,
    },
}

SWEP.AutosolveSourceSeq = "idle"

SWEP.Attachments = {
    {
        PrintName = "Optic",
        DefaultAttName = "Iron Sights",
        Slot = {"optic_lp","optic","ur_mp5_optic"}, -- ,"optic"
        Bone = "body",
        Offset = {
            vpos = Vector(-0.1, -1.6, 3),
            vang = Angle(90, 0, -90),
        },
        CorrectivePos = Vector(-0.09, 0, 0),
        CorrectiveAng = Angle(1, 0.6, -4.0),
        InstalledEles = {"ur_mp5_rail_optic"}
    },
    {
        PrintName = "Upper Receiver",
        DefaultAttName = "9\" Standard Upper",
        DefaultAttIcon = Material("entities/att/ur_mp5/upper_std.png", "smooth mips"),
        Slot = "ur_mp5_barrel",
        Bone = "body",
        Offset = {
            vpos = Vector(2.6, -3.7, -17.3),
            vang = Angle(90, 0, -90),
        },
    },
    {
        PrintName = "Lower Receiver",
        DefaultAttName = "Navy Lower",
        DefaultAttIcon = Material("entities/att/ur_mp5/grip.png", "smooth mips"),
        Slot = "ur_mp5_caliber",
        DefaultEles = {"receiver_lower_0"}
    },
    {
        PrintName = "Muzzle",
        DefaultAttName = "Standard Muzzle",
        Slot = {"muzzle"},
        Bone = "body",
        Offset = {
            vpos = Vector(0, 0.3, 14.8),
            vang = Angle(90, 0, -90),
        },
        ExcludeFlags = {"barrel_sd","barrel_eod","barrel_sword"}
    },
    {
        PrintName = "Handguard",
        DefaultAttName = "Tropical Handguard",
        DefaultAttIcon = Material("entities/att/ur_mp5/hg_std.png", "smooth mips"),
        Slot = {"ur_mp5_hg"},
        ExcludeFlags = {"barrel_sd", "barrel_eod"},
        Bone = "body",
        Offset = {
            vpos = Vector(0, .9, 10),
            vang = Angle(90, 0, -90),
        },
        --VMScale = Vector(.8, .8, .8),
    },
    {
        PrintName = "Underbarrel",
        Slot = {"foregrip"},
        Bone = "body",
        Offset = {
            vpos = Vector(0, .9, 10),
            vang = Angle(90, 0, -90),
        },
        --VMScale = Vector(.8, .8, .8),
        --InstalledEles = {"ur_mp5_rail_fg"},
        GivesFlags = {"mp5_rail"},
        ExcludeFlags = {"mp5_badhg","mp5_kurz"},
        MergeSlots = {15},
    },
    {
        PrintName = "Tactical",
        Slot = "tac",
        Bone = "body",
        Offset = {
            vpos = Vector(-0.9, 0.2, 8),
            vang = Angle(90, 0, 180),
        },
        VMScale = Vector(.8,.8,.8),
        --InstalledEles = {"ur_mp5_clamp"}
        GivesFlags = {"mp5_rail"},
    },
    {
        PrintName = "Stock",
        Slot = {"ur_mp5_stock"},
        DefaultAttName = "Full Stock",
        DefaultAttIcon = Material("entities/att/ur_mp5/stock_std.png", "smooth mips"),
    },
    {
        PrintName = "Magazine",
        Slot = {"ur_mp5_mag"},
        DefaultAttName = "30-Round Mag",
        DefaultAttIcon = Material("entities/att/ur_mp5/mag30.png", "smooth mips"),
        ExcludeFlags = {"ur_mp5_cal_40sw","ur_mp5_cal_10mm"}
    },
    {
        PrintName = "Ammo Type",
        DefaultAttName = "\"FMJ\" Full Metal Jacket",
        DefaultAttIcon = Material("entities/att/arccw_uc_ammo_generic.png", "mips smooth"),
        Slot = "uc_ammo",
    },
    {
        PrintName = "Powder Load",
        Slot = "uc_powder",
        DefaultAttName = "Standard Load",
        ExcludeFlags = {"barrel_sd"}
    },
    {
        PrintName = "Training Package",
        Slot = "uc_tp",
        DefaultAttName = "Basic Training"
    },
    {
        PrintName = "Internals",
        Slot = "uc_fg", -- Fire group
        DefaultAttName = "Standard Internals"
    },
    {
        PrintName = "Charm",
        Slot = {"charm", "fml_charm", "mp5_charm"},
        FreeSlot = true,
        Bone = "Body",
        Offset = {
            vpos = Vector(0.6, 1.1, 2.5),
            vang = Angle(90, 0, -90),
        },
    },
    {
        PrintName = "M203 slot",
        Slot = "uc_ubgl",
        Bone = "Body",
        Offset = {
            vpos = Vector(0, 0, 7.9),
            vang = Angle(90, 0, -90),
        },
        Hidden = true,
        --RequireFlags = {"barrel_eod"},
        ExcludeFlags = {"mp5_badhg","mp5_kurz"},
    }
}

-- SWEP.AttachmentOverrides = {
--     ["uc_grip_handstop"] = {
--         LHIK = false
--     }
-- } -- THIS SHIT DOESN'T WORK

--lua/weapons/arccw_ur_m1911.lua:
SWEP.Base = "arccw_base"
SWEP.Spawnable = true
SWEP.Category = "ArcCW - Urban Coalition"
SWEP.UC_CategoryPack = "2Urban Renewal"
SWEP.AdminOnly = false
SWEP.UseHands = true

-- Muzzle and shell effects --

SWEP.MuzzleEffect = "muzzleflash_pistol"
SWEP.ShellEffect = "arccw_uc_shelleffect"
SWEP.ShellModel = "models/weapons/arccw/uc_shells/9x19.mdl"
SWEP.ShellScale = 1
--SWEP.ShellMaterial = "models/weapons/arcticcw/shell_9mm"
SWEP.ShellPitch = 90

SWEP.MuzzleEffectAttachment = 1
SWEP.CaseEffectAttachment = 2
SWEP.CamAttachment = 5
SWEP.TracerNum = 0 -- subsonic by default
SWEP.TracerWidth = 1
SWEP.ShootPitch = 100

-- Fake name --

SWEP.PrintName = "AMAS" -- American Automatic Sidearm

-- True name --

SWEP.TrueName = "M1911"

-- Trivia --

SWEP.Trivia_Class = "Pistol"
SWEP.Trivia_Desc = [[Venerable semi-automatic pistol issued by the US Army throughout both World Wars and then some. Even after more than a century of service, it is rarely considered an obsolete design, and its short recoil mechanism has been inherited by most modern pistols.

Easy to handle and packing respectable stopping power, the antiquated single-stack magazine is its only notable downside.]]
SWEP.Trivia_Manufacturer = "Stoner's Legacy Ltd."
SWEP.Trivia_Calibre = ".45 ACP"
SWEP.Trivia_Mechanism = "Short Recoil"
SWEP.Trivia_Country = "USA"
SWEP.Trivia_Year = 1911

-- Weapon slot --

SWEP.Slot = 1

-- Weapon's manufacturer real name --

if GetConVar("arccw_truenames"):GetBool() then
    SWEP.PrintName = SWEP.TrueName
    SWEP.Trivia_Manufacturer = "Colt's Manufacturing Company"
end

-- Viewmodel / Worldmodel / FOV --

SWEP.ViewModel = "models/weapons/arccw/c_ur_m1911.mdl"
SWEP.WorldModel = "models/weapons/arccw/c_ur_m1911.mdl"
SWEP.ViewModelFOV = 66
SWEP.AnimShoot = ACT_HL2MP_GESTURE_RANGE_ATTACK_REVOLVER

-- Damage parameters --

SWEP.Damage = 45 -- 3 shot short range kill (2 shot chest point-blank)
SWEP.DamageMin = 15 -- 7 shot long range kill
SWEP.RangeMin = 10
SWEP.Range = 80 -- 3 shot until ~40m
SWEP.Penetration = 9
SWEP.DamageType = DMG_BULLET
SWEP.ShootEntity = nil

SWEP.PhysBulletMuzzleVelocity = 253

SWEP.BodyDamageMults = ArcCW.UC.BodyDamageMults

-- Jamming --

--SWEP.Malfunction = true
SWEP.MalfunctionJam = true
--SWEP.MalfunctionMean = 21
SWEP.MalfunctionPostFire = false
SWEP.MalfunctionTakeRound = true

-- Mag size --

SWEP.ChamberSize = 1
SWEP.Primary.ClipSize = 7

-- Recoil --

SWEP.Recoil = 1.25
SWEP.RecoilSide = 0.75

SWEP.RecoilRise = 0.25
SWEP.VisualRecoilMult = 1.0
SWEP.MaxRecoilBlowback = .5
SWEP.MaxRecoilPunch = .8

SWEP.Sway = 1

-- Firerate / Firemodes --

SWEP.Delay = 60 / 400
SWEP.Num = 1
SWEP.Firemodes = {
    {
        Mode = 1,
    },
    {
        Mode = 0
    }
}

SWEP.ShootPitch = 100
SWEP.ShootVol = 120

SWEP.ProceduralRegularFire = false
SWEP.ProceduralIronFire = false

SWEP.ReloadInSights = true

-- NPC --

SWEP.NPCWeaponType = "weapon_pistol"
SWEP.NPCWeight = 70

-- Accuracy --

SWEP.AccuracyMOA = 5
SWEP.HipDispersion = 400
SWEP.MoveDispersion = 150
SWEP.JumpDispersion = 1000

SWEP.Primary.Ammo = "pistol"
SWEP.MagID = "m1911"

-- Speed multipliers --

SWEP.SpeedMult = 0.97
SWEP.SightedSpeedMult = 0.875
SWEP.SightTime = 0.25
SWEP.ShootSpeedMult = 1

-- Length --

SWEP.BarrelLength = 8
SWEP.ExtraSightDist = 10

-- Ironsights / Customization / Poses --

SWEP.HolsterPos = Vector(0.3, 3, 1.6)
SWEP.HolsterAng = Angle(-14, 0, -0.5)

SWEP.SprintPos = Vector(0.3, 3, 1)
SWEP.SprintAng = Angle(-5, 15, -20)

SWEP.HoldtypeHolstered = "normal"
SWEP.HoldtypeActive = "pistol"
SWEP.HoldtypeSights = "revolver"

SWEP.IronSightStruct = {
     Pos = Vector(-2.33, 10, 1.5),
     Ang = Angle(0.2, 0.02, 5.5),
     Magnification = 1,
     SwitchToSound = "",
}

SWEP.ActivePos = Vector(0.3, 3, 1.3)
SWEP.ActiveAng = Angle(0, 0, -0.5)

SWEP.CustomizePos = Vector(0, 0, 0)
SWEP.CustomizeAng = Angle(0, 0, 0)

SWEP.CrouchPos = Vector(-2, 0, 0)
SWEP.CrouchAng = Angle(0, 0, -8)

SWEP.MirrorVMWM = true
SWEP.WorldModelOffset = {
    pos        =    Vector(-9, 4, -4.25),
    ang        =    Angle(-6, 0, 180),
    bone    =    "ValveBiped.Bip01_R_Hand",
}

-- Weapon sounds --

local path = ")weapons/arccw_ur/1911/"
local common = ")/arccw_uc/common/"
local rottle = {common .. "cloth_2.ogg", common .. "cloth_3.ogg", common .. "cloth_4.ogg", common .. "cloth_6.ogg", common .. "rattle.ogg"}
local rutle = {common .. "movement-pistol-01.ogg",common .. "movement-pistol-02.ogg",common .. "movement-pistol-03.ogg",common .. "movement-pistol-04.ogg"}

SWEP.ShootSound = {
    path .. "fire-01.ogg",
    path .. "fire-02.ogg",
    path .. "fire-03.ogg",
    path .. "fire-04.ogg",
    path .. "fire-05.ogg",
    path .. "fire-06.ogg"
}
SWEP.ShootSoundSilenced = {
    path .. "fire-sup-01.ogg",
    path .. "fire-sup-02.ogg",
    path .. "fire-sup-03.ogg",
    path .. "fire-sup-04.ogg",
    path .. "fire-sup-05.ogg",
    path .. "fire-sup-06.ogg"
}

SWEP.DistantShootSound = nil
SWEP.DistantShootSoundSilenced = nil
SWEP.ShootDrySound = path .. "dryfire.ogg"

local tail = ")/arccw_uc/common/45acp/"

SWEP.DistantShootSoundOutdoors = {
    tail .. "fire-dist-45acp-pistol-ext-01.ogg",
    tail .. "fire-dist-45acp-pistol-ext-02.ogg",
    tail .. "fire-dist-45acp-pistol-ext-03.ogg",
    tail .. "fire-dist-45acp-pistol-ext-04.ogg",
    tail .. "fire-dist-45acp-pistol-ext-05.ogg",
    tail .. "fire-dist-45acp-pistol-ext-06.ogg"
}
SWEP.DistantShootSoundIndoors = {
    common .. "fire-dist-int-pistol-01.ogg",
    common .. "fire-dist-int-pistol-02.ogg",
    common .. "fire-dist-int-pistol-03.ogg",
    common .. "fire-dist-int-pistol-04.ogg",
    common .. "fire-dist-int-pistol-05.ogg",
    common .. "fire-dist-int-pistol-06.ogg"
}
SWEP.DistantShootSoundOutdoorsSilenced = {
    common .. "sup-tail-01.ogg",
    common .. "sup-tail-02.ogg",
    common .. "sup-tail-03.ogg",
    common .. "sup-tail-04.ogg",
    common .. "sup-tail-05.ogg",
    common .. "sup-tail-06.ogg",
    common .. "sup-tail-07.ogg",
    common .. "sup-tail-08.ogg",
    common .. "sup-tail-09.ogg",
    common .. "sup-tail-10.ogg"
}
SWEP.DistantShootSoundIndoorsSilenced = {
    common .. "fire-dist-int-pistol-light-01.ogg",
    common .. "fire-dist-int-pistol-light-02.ogg",
    common .. "fire-dist-int-pistol-light-03.ogg",
    common .. "fire-dist-int-pistol-light-04.ogg",
    common .. "fire-dist-int-pistol-light-05.ogg",
    common .. "fire-dist-int-pistol-light-06.ogg"
}
SWEP.DistantShootSoundOutdoorsVolume = 1
SWEP.DistantShootSoundIndoorsVolume = 1
SWEP.Hook_AddShootSound = ArcCW.UC.InnyOuty

-- Bodygroups --
SWEP.BulletBones = {
    [1] = "mag_round1",
    [2] = "mag_round2",
    [3] = "mag_round3",
    [4] = "mag_round4",
    [5] = "mag_round5",
    [6] = "mag_round6",
    [7] = "mag_round7"
}
SWEP.DefaultBodygroups = "000000000"

SWEP.AttachmentElements = {
    ["ur_1911_slide_compact"] = {
        VMBodygroups = {
            {ind = 0, bg = 1},
            {ind = 1, bg = 1}
        },
        AttPosMods = {
            [4] = {
                vpos = Vector(0, -3.58, .22),
                vang = Angle(0, 90, 0),
            }
        },
        NameChange = "AMAD",
        TrueNameChange = "Colt Officer's ACP",
    },

    ["ur_1911_slide_compact_custom"] = {
        VMBodygroups = {
            {ind = 0, bg = 1},
            {ind = 1, bg = 5}
        },
        AttPosMods = {
            [4] = {
                vpos = Vector(0, -3.58, .22),
                vang = Angle(0, 90, 0),
            }
        },
        NameChange = "AMAD",
        TrueNameChange = "Colt Officer's ACP",
    },

    ["ur_1911_slide_custom"] = {
        VMBodygroups = {
            {ind = 1, bg = 4}
        },
    },

    ["ur_1911_slide_m45"] = {
        VMBodygroups = {
            {ind = 1, bg = 2},
            {ind = 4, bg = 1},
            {ind = 5, bg = 1},
        },
        --VMSkin = 1,
        NameChange = "AMASIN",
        TrueNameChange = "M45",
        Override_IronSightStruct = {
            Pos = Vector(-2.3, 10, 1.4),
            Ang = Angle(0.275, 0.07, 5.5),
        },
    },

    ["ur_1911_slide_m45_custom"] = {
        VMBodygroups = {
            {ind = 1, bg = 3},
            {ind = 4, bg = 1},
            {ind = 5, bg = 1},
        },
        --VMSkin = 1,
        NameChange = "AMASIN",
        TrueNameChange = "M45",
        Override_IronSightStruct = {
            Pos = Vector(-2.3, 10, 1.4),
            Ang = Angle(0.275, 0.07, 5.5),
        },
    },

    ["ur_1911_mag_ext"] = {
        VMBodygroups = {
            {ind = 3, bg = 1}
        }
    },

    ["ur_1911_grip_snake"] = {
        VMBodygroups = {
            {ind = 6, bg = 1}
        }
    },
    ["ur_1911_grip_pachmayr"] = {
        VMBodygroups = {
            {ind = 6, bg = 2}
        }
    },

    ["ur_1911_skin_silver"] = {
        VMSkin = 1
    },
    ["ur_1911_skin_tan"] = {
        VMSkin = 2
    },
    ["ur_1911_skin_custom"] = {
        VMSkin = 3
    },

    ["ur_1911_cal_9mm"] = {
        NameChange = "AMAS-9",
        TrueNameChange = "SR1911",
    },
    ["ur_1911_cal_10auto"] = {
        NameChange = "AMAS Elite",
        TrueNameChange = "Delta Elite",
    },

    ["optic_rail"] = {
        VMBodygroups = {
            {ind = 7, bg = 1}
        }
    },
    ["tac_rail"] = {
        VMBodygroups = {
            {ind = 8, bg = 1}
        }
    },
}

SWEP.Hook_ModifyBodygroups = function(wep, data)
    -- local vm = data.vm
    -- if !IsValid(vm) then return end

    -- local att_skin = wep.Attachments[14].Installed
    -- local att_slide = wep.Attachments[2].Installed

    -- if att_slide == "ur_1911_slide_m45" and att_skin == "ur_1911_skin_custom" then
    --     vm:SetBodygroup(1, 3)
    -- end
end

-- SWEP.Hook_NameChange = function(wep,name)
--     if GetConVar("arccw_truenames"):GetBool() then
--         local atts = wep.Attachments
--         local cal = string.Replace(atts[3].Installed or "45acp", "ur_1911_cal_", "")

--         if cal == "10auto" then return GetConVar("arccw_truenames"):GetBool() and "Delta Elite" or ""
--         elseif cal == "9mm" then return GetConVar("arccw_truenames"):GetBool() and "SR1911" or ""
--         end

--         return "M1911"
--     else
--         return "AMAS"
--     end
-- end

-- Animations --

SWEP.Animations = {
    ["idle"] = {
        Source = "idle",
        Time = 10 / 30,
    },
    ["idle_empty"] = {
        Source = "idle_empty",
        Time = 10 / 30,
    },
    ["ready"] = {
        Source = "fix",
        Time = 1.6,
        MinProgress = 1.2,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0,
        ShellEjectAt = false,
        ProcDraw = true,
        SoundTable = {
            { s = rottle, t = 0 / 60 },
            {s = path .. "draw.ogg", t = 0.05},
            { s = path .. "mech.ogg",t = 28 / 60}, -- Temporary
            { s = path .. "slidedrop.ogg",t = 35 / 60},
        },
    },
    ["draw"] = {
        Source = "draw",
        Time = .75,
        MinProgress = .4,
        --ProcDraw = true,
        SoundTable = {
            {s = rottle, t = 0},
            {s = path .. "draw.ogg", t = 0.05}, -- Not Temporary
            {s = rutle, t = 0.1},
            --{s = common .. "raise.ogg", t = 0.05},
        },
    },
    ["draw_empty"] = {
        Source = "draw_empty",
        Time = .75,
        MinProgress = .4,
        --ProcDraw = true,
        SoundTable = {
            {s = rottle, t = 0},
            {s = path .. "draw.ogg", t = 0.05}, -- Not Temporary
            {s = rutle, t = 0.1},
            --{s = common .. "raise.ogg", t = 0.05},
        },
    },
    ["draw_jam"] = {
        Source = "draw_jam",
        Time = .75,
        MinProgress = .4,
        SoundTable = {
            {s = rottle, t = 0},
            {s = path .. "draw.ogg", t = 0.05}, -- Not Temporary
            {s = rutle, t = 0.1},
            --{s = common .. "raise.ogg", t = 0.05},
        },
    },
    ["holster"] = {
        Source = "holster",
        Time = .75,
        SoundTable = {
            {s = rutle, t = 0.05},
            {s = path .. "holster.ogg", t = 0.2}, -- Not Temporary
        },
    },
    ["holster_empty"] = {
        Source = "holster_empty",
        Time = .75,
        SoundTable = {
            {s = rutle, t = 0.05},
            {s = path .. "holster.ogg", t = 0.2}, -- Not Temporary
        },
    },
    ["holster_jam"] = {
        Source = "holster_jam",
        Time = 18 / 30,
        SoundTable = {
            {s = rutle, t = 0.05},
            {s = path .. "holster.ogg", t = 0.2}, -- Not Temporary
        },
    },

    ["fire"] = {
        Source = "fire",
        Time = 30 / 30,
        ShellEjectAt = 0,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0, v = 0.25 }},
    },
    ["fire_iron"] = {
        Source = "fire",
        Time = 30 / 30,
        ShellEjectAt = 0,
        SoundTable = {{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0 }},
    },
    ["fire_empty"] = {
        Source = "fire_empty",
        Time = 24 / 30,
        ShellEjectAt = 0,
        SoundTable = {
            { s = path .. "mech_last.ogg", t = 0 },
        },
    },
    ["fire_iron_empty"] = {
        Source = "fire_empty",
        Time = 24 / 30,
        ShellEjectAt = 0,
        SoundTable = {
            { s = path .. "mech_last.ogg", t = 0 },
        },
    },
    ["fire_jammed"] = {
        Source = "fire_jam",
        Time = 30 / 30,
        MinProgress = 0.5,
        ShellEjectAt = false,
        SoundTable = {
            --{ s = {path .. "mech-01.ogg", path .. "mech-02.ogg", path .. "mech-03.ogg", path .. "mech-04.ogg", path .. "mech-05.ogg", path .. "mech-06.ogg"}, t = 0 }
        },
    },

    -- 7-R Reloads --

    ["reload_10"] = {
        Source = "reload_ext",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
        MinProgress = 1.3525,
        Time = 65 / 30,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.2,
        LHIKOut = 0.62,
        SoundTable = {
            { s = rottle, t = 0 / 60 },
            { s = common .. "magpouch_pull_small.ogg", t = 0 / 60 },
            { s = common .. "magrelease.ogg", t = 17 / 60 },
            { s = path .. "magout.ogg", t = 26 / 60 },
            { s = rottle, t = 10 / 60 },
            { s = rottle, t = 55 / 60 },
            { s = common ..  "magpouch_replace_small.ogg", t = 80 / 60 },
            { s = path .. "magin.ogg", t = 50 / 60 },
        },
    },
    ["reload_empty_10"] = {
        Source = "reload_empty_ext",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
        MinProgress = 1.75,
        Time = 75 / 30,
        LastClip1OutTime = 0.76,
        LHIK = true,
        LHIKIn = 0.1,
        LHIKEaseIn = 0.1,
        LHIKEaseOut = 0.55,
        LHIKOut = 0.7,
        SoundTable = {
            { s = rottle, t = 0 / 60 },
            { s = common .. "magrelease.ogg", t = 7 / 60 },
            { s = path .. "magout.ogg", t = 16 / 60 },
            { s = rottle, t = 10 / 60 },
            { s = common .. "magpouch_pull_small.ogg", t = 29 / 60 },
            { s = common .. "pistol_magdrop.ogg", t = 40 / 60 },
            { s = rottle, t = 55 / 60 },
            { s = path .. "magin.ogg", t = 64 / 60 },
            { s = rottle, t = 90 / 60 },
            { s = path .. "slidedrop.ogg", t = 94 / 60 },
        },
    },

    ["reload"] = {
        Source = "reload",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
        MinProgress = 1.3525,
        Time = 65 / 30,
        LastClip1OutTime = 0.9,
        LHIK = true,
        LHIKIn = 0.2,
        LHIKEaseIn = 0.2,
        LHIKEaseOut = 0.2,
        LHIKOut = 0.62,
        SoundTable = {
            { s = rottle,                                   t = 0 / 60 },
            { s = common .. "magpouch_pull_small.ogg",      t = 5 / 60 },
            { s = rottle,                                   t = 10 / 60 },
            { s = common .. "magrelease.ogg",               t = 17 / 60 },
            { s = path .. "magout.ogg",                     t = 26 / 60 },
            { s = path .. "magin.ogg",                      t = 45 / 60 },
            { s = rottle,                                   t = 55 / 60 },
            { s = common ..  "magpouch_replace_small.ogg",  t = 80 / 60 },
            { s = path .. "grab.ogg",                       t = 110 / 60 },
        },
    },
    ["reload_empty"] = {
        Source = "reload_empty",
        TPAnim = ACT_HL2MP_GESTURE_RELOAD_PISTOL,
        MinProgress = 1.75,
        Time = 75 / 30,
        LastClip1OutTime = 0.76,
        LHIK = true,
        LHIKIn = 0.1,
        LHIKEaseIn = 0.1,
        LHIKEaseOut = 0.55,
        LHIKOut = 0.7,
        SoundTable = {
            { s = rottle, t = 0 / 60 },
            { s = common .. "magrelease.ogg", t = 7 / 60 },
            { s = path .. "magout.ogg", t = 16 / 60 },
            { s = rottle, t = 10 / 60 },
            { s = common .. "magpouch_pull_small.ogg", t = 29 / 60 },
            { s = common .. "pistol_magdrop.ogg", t = 40 / 60 },
            { s = rottle, t = 55 / 60 },
            { s = path .. "magin.ogg", t = 64 / 60 },
            { s = rottle, t = 90 / 60 },
            { s = path .. "slidedrop.ogg", t = 94 / 60 },
            { s = path .. "grab.ogg", t = 125 / 60 },
        },
    },

    -- Jam Animations --

    ["fix"] = {
        Source = "fix",
        --Time = 40 / 30,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0,
        ShellEjectAt = 30 / 60,
        SoundTable = {
            { s = rottle, t = 0 / 60 },
            { s = path .. "mech.ogg",t = 28 / 60}, -- Temporary
            { s = path .. "slidedrop.ogg",t = 35 / 60},
        },
    },

    ["fix_empty"] = {
        Source = "fix_empty",
        --Time = 40 / 30,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0,
        ShellEjectAt = 30 / 60,
        SoundTable = {
            { s = rottle, t = 0 / 60 },
            { s = path .. "mech.ogg",t = 28 / 60},
        },
    },

    ["idle_jammed"] = {
        Source = "idle_jam",
        -- time = 35 / 60,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0,
       -- SoundTable = {
        -- },
    },

    -- -- Inspecc --

    ["enter_inspect"] = {
        Source = "enter_inspect",
        time = 35 / 60,
        LHIK = true,
        LHIKIn = 0.3,
        LHIKOut = 0,
        SoundTable = {
            {s = rottle, t = 0},
            {s = common .. "movement-pistol-04.ogg", t = 0},
        },
    },
    ["idle_inspect"] = {
        Source = "idle_inspect",
        time = 72 / 60,
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0,
    },
    ["exit_inspect"] = {
        Source = "exit_inspect",
        time = 66 / 60,
        LHIK = true,
        LHIKIn = 0,
        LHIKEaseOut = 0.3,
        LHIKOut = 0.84,
        SoundTable = {
            {s = rottle, t = 0.05},
            {s = common .. "movement-pistol-03.ogg", t = 0.1},
            {s = common .. "movement-pistol-01.ogg", t = 1},
            {s = rottle, t = 1},
        },
    },

    ["enter_inspect_empty"] = {
        Source = "enter_inspect_empty",
        time = 35 / 60,
        LHIK = true,
        LHIKIn = 0.1,
        LHIKOut = 0,
        SoundTable = {
            {s = rottle, t = 0},
            {s = common .. "movement-pistol-04.ogg", t = 0},
        },
    },
    ["idle_inspect_empty"] = {
        Source = "idle_inspect_empty",
        time = 72 / 60,
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0,
    },
    ["exit_inspect_empty"] = {
        Source = "exit_inspect_empty",
        time = 66 / 60,
        LHIK = true,
        LHIKIn = 0,
        LHIKEaseOut = 0.3,
        LHIKOut = 0.84,
        SoundTable = {
            {s = rottle, t = 0.05},
            {s = common .. "movement-pistol-03.ogg", t = 0.1},
            {s = common .. "movement-pistol-01.ogg", t = 1},
            {s = rottle, t = 1},
        },
    },
    ["enter_inspect_jammed"] = {
        Source = "enter_inspect_jam",
        time = 35 / 60,
        LHIK = true,
        LHIKIn = 0.1,
        LHIKOut = 0,
        SoundTable = {
            {s = rottle, t = 0},
            {s = common .. "movement-pistol-04.ogg", t = 0},
        },
    },
    ["idle_inspect_jammed"] = {
        Source = "idle_inspect_jam",
        time = 72 / 60,
        LHIK = true,
        LHIKIn = 0,
        LHIKOut = 0,
    },
    ["exit_inspect_jammed"] = {
        Source = "exit_inspect_jam",
        time = 66 / 60,
        LHIK = true,
        LHIKIn = 0,
        LHIKEaseOut = 0.3,
        LHIKOut = 0.84,
        SoundTable = {
            {s = rottle, t = 0.05},
            {s = common .. "movement-pistol-03.ogg", t = 0.1},
            {s = common .. "movement-pistol-01.ogg", t = 1},
            {s = rottle, t = 1},
        },
    },
}

-- ADS animation blending, thanks fesiug -- 

SWEP.Hook_Think = ArcCW.UC.ADSReload


-- Attachments --

SWEP.Attachments = {
    {
        PrintName = "Optic",
        Slot = {"optic_lp"},
        DefaultAttName = "Iron Sights",
        Bone = "vm_pivot",
        Offset = {
            vpos = Vector(-0.01, -2.3, 1.6),
            vang = Angle(90, 0, -90),
        },
        InstalledEles = {"optic_rail"},
    },
    {
        PrintName = "Slide",
        Slot = {"ur_m1911_slide"},
        DefaultAttIcon = Material("entities/att/ur_1911/slide_std.png","mips smooth"),
        DefaultAttName = "5\" Government Slide",
    },
    {
        PrintName = "Caliber",
        Slot = {"ur_m1911_caliber"},
        DefaultAttIcon = Material("entities/att/uc_bullets/45acp.png","mips smooth"),
        DefaultAttName = ".45 ACP",
        Bone = "vm_pivot",
        Offset = {
            vpos = Vector(3.07, -3.8, -27),
            vang = Angle(90, 0, -90),
        },
        DefaultFlags = {"cal_subsonic"},
    },
    {
        PrintName = "Muzzle",
        DefaultAttName = "Standard Muzzle",
        Slot = {"muzzle"},
        Bone = "vm_barrel",
        Offset = {
            vpos = Vector(0.02, -4.4, 0.12),
            vang = Angle(0, 90, 0),
        },
        InstalledEles = {"nofh"},
        ExcludeFlags = {"barrel_annihilator"},
    },
    {
        PrintName = "Tactical",
        Slot = {"tac_pistol"},
        Bone = "vm_pivot",
        Offset = {
            vpos = Vector(0, 0, 4),
            vang = Angle(90, 0, -90),
        },
        InstalledEles = {"tac_rail"},
    },
    {
        PrintName = "Magazine",
        Slot = {"ur_m1911_mag"},
        DefaultAttIcon = Material("entities/att/ur_1911/mag7.png","mips smooth"),
        DefaultAttName = "7-Round Mag",
    },
    {
        PrintName = "Stock",
        Slot = {"uc_stock", "go_stock_pistol_bt"},
        VMScale = Vector(1, 1, 1),
        Bone = "vm_pivot",
        Offset = {
            vpos = Vector(0, 3, -3),
            vang = Angle(90, 0, -90),
        },
    },
    {
        PrintName = "Grip",
        DefaultAttName = "Factory Grip",
        DefaultAttIcon = Material("entities/att/ur_1911/grip.png","mips smooth"),
        Slot = "ur_m1911_grip"
    },
    {
        PrintName = "Ammo Type",
        DefaultAttName = "\"FMJ\" Full Metal Jacket",
        DefaultAttIcon = Material("entities/att/arccw_uc_ammo_generic.png", "mips smooth"),
        Slot = "uc_ammo",
    },
    {
        PrintName = "Powder Load",
        Slot = "uc_powder",
        DefaultAttName = "Standard Load"
    },
    {
        PrintName = "Training Package",
        Slot = "uc_tp",
        DefaultAttName = "Basic Training"
    },
    {
        PrintName = "Internals",
        Slot = "uc_fg", -- Fire group
        DefaultAttName = "Standard Internals"
    },
    {
        PrintName = "Charm",
        Slot = {"charm", "fml_charm"},
        FreeSlot = true,
        Bone = "vm_pivot",
        Offset = {
            vpos = Vector(0.35, -0.5, 3),
            vang = Angle(90, 0, -90),
        },
        VMScale = Vector(.75,.75,.75),
    },
    {
        PrintName = "Finish",
        Slot = {"ur_m1911_skin"},
        DefaultAttName = "Grey",
        DefaultAttIcon = Material("entities/att/ur_1911/skin.png","mips smooth"),
        FreeSlot = true,
    },
}

--addons/ch_bitminers_dlc/lua/weapons/ch_bitminers_repair_wrench/shared.lua:
return gluapack()()
--addons/ch_mining/lua/weapons/ch_mining_jackhammer/shared.lua:
--[[ INFO
models/craphead_scripts/mining/c_jackhammer.mdl
models/craphead_scripts/mining/w_jackhammer.mdl
fov 		70
Hold type 	smg
idle 		ACT_VM_IDLE
trtrtr 		ACT_VM_PRIMARYATTACK
draw 		ACT_VM_DRAW
arrow 		0-100
76561198314224586
--]]

if SERVER then
	SWEP.Weight				= 5
	SWEP.AutoSwitchTo		= true
	SWEP.AutoSwitchFrom		= true
	AddCSLuaFile( "shared.lua" )
end

if CLIENT then
	SWEP.PrintName			= "Jackhammer"
	SWEP.Author				= "Crap-Head"
	SWEP.Slot				= 2
	SWEP.SlotPos			= 1
	SWEP.DrawAmmo			= false
	SWEP.DrawWeaponInfoBox	= false
	SWEP.BounceWeaponIcon   = false
	SWEP.SwayScale			= 1.0
	SWEP.BobScale			= 1.0
end

SWEP.Author					= "Crap-Head"
SWEP.Instructions 			= "Left Click: Mine rocks"
SWEP.Category 				= "Mining by Crap-Head"

SWEP.UseHands				= true
SWEP.ViewModelFOV			= 70

SWEP.ViewModel 				= "models/craphead_scripts/mining/c_jackhammer.mdl"
SWEP.WorldModel				= "models/craphead_scripts/mining/w_jackhammer.mdl"

SWEP.Spawnable				= true
SWEP.AdminSpawnable			= true

SWEP.Primary.Range			= 120
SWEP.Primary.Recoil			= 4.6
SWEP.Primary.Damage			= 100
SWEP.Primary.Cone			= 0.005
SWEP.Primary.NumShots		= 1

SWEP.Primary.ClipSize		= -1
SWEP.Primary.DefaultClip	= -1
SWEP.Primary.Automatic		= true	
SWEP.Primary.Ammo			= "none"

SWEP.Secondary.ClipSize		= -1
SWEP.Secondary.DefaultClip	= -1
SWEP.Secondary.Automatic	= true
SWEP.Secondary.Ammo			= "none"

function SWEP:SetupDataTables()	
	self:NetworkVar( "Float", 0, "Temperature" )
	
	self:NetworkVar( "Bool", 0, "IsMining" )
	self:NetworkVar( "Bool", 1, "IsOverheated" )
	
	self:NetworkVar( "Float" , 1, "NextIdle" )
end

function SWEP:Initialize()
	self:SetWeaponHoldType( "smg" )
	self:SetNextIdle( 0 )
	
	self:SetIsMining( false )
	self:SetIsOverheated( false )
	
	self.MiningSound = CreateSound( self, "craphead_scripts/ch_mining/weapons/jackhammer_loop.wav" )
	self.MiningSound:SetSoundLevel( CH_Mining.Config.WeaponSoundLevel )
	
    return true
end

function SWEP:Deploy()
	local cur_time = CurTime()
	local ply = self:GetOwner()
	
	self:SendWeaponAnim( ACT_VM_DRAW )
	self:SetNextIdle( cur_time + self:SequenceDuration() )
	
	-- Update temperature
	self:SetTemperature( ply.CH_Mining_JackhammerTemperature or 0 )
	
	-- Do delay
	self:SetNextPrimaryFire( cur_time + self:SequenceDuration() )
	self:SetNextSecondaryFire( cur_time + self:SequenceDuration() )
	
	return true
end

function SWEP:Holster( wep )
	if not IsFirstTimePredicted() then return end
	
	if self.MiningSound then 
		self.MiningSound:Stop() 
	end

	return true
end

function SWEP:PrimaryAttack()
	local ply = self:GetOwner()
	local trace = ply:GetEyeTrace()
	local target = trace.Entity
	local cur_time = CurTime()
	
	-- Check if overheated and stop everything
	if self:GetIsOverheated() then
		return
	end
	
	-- Updating is mining and update temperature
	self:SetIsMining( true )
	self:SetTemperature( self:GetTemperature() + CH_Mining.Config.IncreaseTemperaturePerHit )
	
	-- Store variable for gauge meter on player
	ply.CH_Mining_JackhammerTemperature = self:GetTemperature()
	
    if CLIENT then return end
	
	-- Do delay
	self:SetNextPrimaryFire( cur_time + 1 )
	self:SetNextSecondaryFire( cur_time + 1 )
	
	-- Send anim
	self:SendWeaponAnim( ACT_VM_PRIMARYATTACK )

	self.MiningSound:Play()
	
	if not IsValid( self ) or not IsValid( target ) then
		return
	end
	
	-- Check distance to target
	if ply:GetPos():DistToSqr( target:GetPos() ) > CH_Mining.Config.DistanceToRockMining then
		return
	end
	
	if target:GetClass() == "ch_mining_rock" then
		-- Check if rock is dead
		if target:GetIsDead() then
			return
		end
	
		CH_Mining.HitRock( ply, target, CH_Mining.Config.TakeDurabilityPerHitJackhammer )
	elseif target:IsPlayer() or target:IsNPC() then
		self:EmitSound( "physics/flesh/flesh_impact_hard" .. math.random( 1, 6 ) .. ".wav" )

		target:TakeDamage( math.random( 2, 4 ), ply, self )
	elseif target:GetClass() == "func_breakable_surf" then
		target:Fire( "Shatter" )
	end
end 

function SWEP:SecondaryAttack()
	return false
end

function SWEP:Think()
	local ply = self:GetOwner()
	
	-- Return to idle after deployment
	if self:GetNextIdle() ~= 0 and self:GetNextIdle() < CurTime() then
		self:SendWeaponAnim( ACT_VM_IDLE )
		self:SetNextIdle( 0 )
	end
	
	-- Update the arrow / temperature on the weapon
	if CLIENT then
		local vm = ply:GetViewModel()
		
		if self:GetTemperature() >= 0 then
			vm:SetPoseParameter( "arrow", self:GetTemperature() )
			
			vm:InvalidateBoneCache()
		end
	end

	if self:GetTemperature() >= 100 and not self:GetIsOverheated() then
		self:SendWeaponAnim( ACT_VM_IDLE )
		self:SetNextIdle( 0 )
		
		self:SetIsMining( false )
		self:SetIsOverheated( true )
		
		if self.MiningSound then 
			self.MiningSound:Stop() 
		end
	end
	
	-- If we're mining
	if self:GetIsMining() then
		local trace = ply:GetEyeTrace()
		local target = trace.Entity
		
		-- Check to see if we let go and return to idle and stop calling the code
		if not ply:KeyDown( IN_ATTACK ) then
			self:SendWeaponAnim( ACT_VM_IDLE )
			self:SetIsMining( false )
			
			if self.MiningSound then 
				self.MiningSound:Stop() 
			end
		end
		
		--[[ Emit spark effect from rock
		if ( IsFirstTimePredicted() ) then
			if target:GetClass() == "ch_mining_rock" then
				if not self:GetIsOverheated() and not target:GetIsDead() and ply:GetPos():DistToSqr( target:GetPos() ) < CH_Mining.Config.DistanceToRockMining then
					timer.Simple( 0, function()
						local effect = EffectData()
						effect:SetOrigin( trace.HitPos )
						util.Effect( "rock_spark" , effect )
					end )
					
				end
			end
		end
		--]]
	else
		self:SetTemperature( math.Clamp( self:GetTemperature() - ( ply.CH_Mining_JackhammerCooling or 0 ), 0, 100 ) )

		-- Store variable for gauge meter on player
		ply.CH_Mining_JackhammerTemperature = self:GetTemperature()
		
		if self:GetTemperature() <= CH_Mining.Config.RegainAfterOverheatingTemperature then
			self:SetIsOverheated( false )
		end
		
		self:NextThink( CurTime() + 2 )
		return true
	end
end

function SWEP:DoDrawCrosshair( x, y )
	local size = 16

	surface.SetDrawColor( color_white )
	surface.SetMaterial( CH_Mining.Materials.CrosshairIcon )
	surface.DrawTexturedRect( x - 8, y - 8, size, size )
	return true
end
--addons/ledscreen/lua/weapons/gmod_tool/stools/ledscreen.lua:
return gluapack()()
--addons/pcasino/lua/weapons/gmod_tool/stools/pcasino_creator.lua:
TOOL.Category = "pCasino"
TOOL.Name = "#tool.pcasino_creator.name"
TOOL.Command = nil
TOOL.Information = {
	{name = "left"},
	{name = "right"},
	{name = "reload"}
} 


if CLIENT then
	language.Add("tool.pcasino_creator.name", "Entity Creation")
	language.Add("tool.pcasino_creator.desc", "Used to place all the pCasino entities.")

    language.Add("tool.pcasino_creator.left", "Place the configured entity.")
    language.Add("tool.pcasino_creator.right", "Open the menu to configure an entity.")
    language.Add("tool.pcasino_creator.reload", "Remove the entity permanently.")
end

local cooldown = 0
local currentEnt
local offset = {
	["pcasino_slot_machine"] = function(ent) return Vector(0, 0, 48) end,
	["pcasino_roulette_table"] = function(ent) return Vector(0, 0, 20) end,
	["pcasino_blackjack_table"] = function(ent) return Vector(0, 0, 22) end,
	["pcasino_wheel_slot_machine"] = function(ent) return Vector(0, 0, 44) end,
	["pcasino_mystery_wheel"] = function(ent) return Vector(0, 0, 61) end,
	["pcasino_sign_plaque"] = function(ent) return ent:GetForward() * 4 end,
	["pcasino_sign_stand"] = function(ent) return Vector(0, 0, 27) end,
	["pcasino_sign_wall_logo"] = function(ent) return ent:GetForward() * 6 end,
	["pcasino_sign_interior_standing"] = function(ent) return Vector(0, 0, 29	) end,
	["pcasino_sign_interior_wall"] = function(ent) return ent:GetForward() * 2.5 end,
	["pcasino_chair"] = function(ent) return Vector(0, 0, 26) end,
	["pcasino_prize_plinth"] = function(ent) return Vector(0, 0, 0) end,
	["pcasino_npc"] = function(ent) return Vector(0, 0, 1) end
}
local ang = {
	["pcasino_chair"] = function(ent) return Angle(0, 180, 0) end
}

function TOOL:LeftClick(trace)
	if SERVER then return end
	if PerfectCasino.Cooldown.Check("ToolGun:Cooldown", 1) then return end
	if not PerfectCasino.Core.Access(LocalPlayer()) then return end
	if not PerfectCasino.UI.CurrentSettings.Entity then
		PerfectCasino.Core.Msg(PerfectCasino.Translation.ToolGun.NoEntity)
		return
	end

	if cooldown > CurTime() then return end
	cooldown = CurTime() + 1

	plyAngle = LocalPlayer():GetAngles()
	net.Start("pCasino:ToolGun:CreateEntity")
		net.WriteString(PerfectCasino.UI.CurrentSettings.Entity)
		net.WriteTable(PerfectCasino.UI.CurrentSettings.Settings)
		net.WriteVector(trace.HitPos + plyAngle:Forward() + plyAngle:Up() + (offset[PerfectCasino.UI.CurrentSettings.Entity] and offset[PerfectCasino.UI.CurrentSettings.Entity](currentEnt) or vector_origin))
		net.WriteAngle(Angle(0, math.Round(plyAngle.y/10)*10 + 180, plyAngle.z) + (ang[PerfectCasino.UI.CurrentSettings.Entity] and ang[PerfectCasino.UI.CurrentSettings.Entity](currentEnt) or angle_zero))
	net.SendToServer()
end

function TOOL:RightClick(trace)
	if SERVER then return end
	if PerfectCasino.Cooldown.Check("ToolGun:Cooldown", 1) then return end
	if not PerfectCasino.Core.Access(LocalPlayer()) then return end
	if cooldown > CurTime() then return end
	cooldown = CurTime() + 1
	PerfectCasino.UI.Config()
end

function TOOL:Reload(trace)
	if CLIENT then return end
	if not PerfectCasino.Core.Access(self:GetOwner()) then return end
	local entity = trace.Entity
	if not entity.DatabaseID then return end
	PerfectCasino.Database.DeleteEntityByID(entity.DatabaseID)
	entity:Remove()
end

concommand.Add("pcasino_remove_ent", function(ply)
	if CLIENT then return end
	if not PerfectCasino.Core.Access(ply) then return end
	local entity = ply:GetEyeTrace().Entity
	if not entity.DatabaseID then return end
	PerfectCasino.Database.DeleteEntityByID(entity.DatabaseID)
	entity:Remove()
end)

concommand.Add("pcasino_update_pos", function(ply)
	if CLIENT then return end
	if not IsValid(ply) then return end
	if not PerfectCasino.Core.Access(ply) then return end

	PerfectCasino.Database.UpdateAllPositions()
end)


function TOOL:Think()
	if SERVER then return end
	if not PerfectCasino.Core.Access(LocalPlayer()) then return end
	if not PerfectCasino.UI.CurrentSettings.Entity then
		if IsValid(currentEnt) then currentEnt:Remove() end
		return
	end

	if not IsValid(currentEnt) then
		currentEnt = ents.CreateClientProp()
		currentEnt:SetModel(PerfectCasino.Core.Entites[PerfectCasino.UI.CurrentSettings.Entity].model)
		currentEnt:SetMaterial("models/wireframe")
		currentEnt:Spawn()
	end
	if not (currentEnt:GetModel() == PerfectCasino.Core.Entites[PerfectCasino.UI.CurrentSettings.Entity].model) then
		currentEnt:SetModel(PerfectCasino.Core.Entites[PerfectCasino.UI.CurrentSettings.Entity].model)
	end
	trace = LocalPlayer():GetEyeTrace()
	plyAngle = LocalPlayer():GetAngles()
	currentEnt:SetPos(trace.HitPos + plyAngle:Forward() + plyAngle:Up() + (offset[PerfectCasino.UI.CurrentSettings.Entity] and offset[PerfectCasino.UI.CurrentSettings.Entity](currentEnt) or vector_origin))
	currentEnt:SetAngles(Angle(0, math.Round(plyAngle.y/10)*10 + 180, plyAngle.z) + (ang[PerfectCasino.UI.CurrentSettings.Entity] and ang[PerfectCasino.UI.CurrentSettings.Entity](currentEnt) or angle_zero))
end

function TOOL:Holster()
	if IsValid(currentEnt) then
		currentEnt:Remove()
		currentEnt = nil
	end
end

local darBack = Color(0, 0, 0, 240)
local red = Color(200, 0, 0)
function TOOL:DrawHUD()
	if not FPP then return end
	
	local ent = self.Owner:GetEyeTrace().Entity
	if not IsValid(ent) then return end
	if not PerfectCasino.Core.Entites[ent:GetClass()] then return end
	if FPP.canTouchEnt(self.Owner:GetEyeTrace().Entity, "Toolgun") then return end
	
	draw.RoundedBox(0, 0, ScrH()*0.5-50, ScrW(), 100, darBack)
	draw.SimpleText(PerfectCasino.Translation.ToolGun.DeletePermissions, "pCasino.Main.Static", ScrW()*0.5, ScrH()*0.5, red, TEXT_ALIGN_CENTER, TEXT_ALIGN_BOTTOM)
	draw.SimpleText(PerfectCasino.Translation.ToolGun.FPPCheck, "pCasino.Nav.Static", ScrW()*0.5, ScrH()*0.5, color_white, TEXT_ALIGN_CENTER, TEXT_ALIGN_TOP)
end
--addons/zeros_growop2_v1.6.1/lua/weapons/gmod_tool/stools/zgo2_dropzone.lua:
/*
    Addon id: 64edeaec-8955-454a-aac4-1d19d72ee4af
    Version: v1.6.1 (stable)
*/

AddCSLuaFile()
TOOL.Category = "Zeros GrowOP 2"
TOOL.Name = "#DropZone"
TOOL.Command = nil
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 70b873f322570e153a05d9cee15c50a5d97bffffec86f684a14bf17014b60342
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 5f074b2717244cb0b28afc4f82cbfebeed301ee81f5a05ae65232daad257b16a

if (CLIENT) then
	language.Add("tool.zgo2_dropzone.name", "Zeros GrowOP 2 - DropZone")
	language.Add("tool.zgo2_dropzone.desc", "LeftClick: Creates a new DropZone. \nRightClick: Cancels / Removes a DropZone.")
	language.Add("tool.zgo2_dropzone.0", "LeftClick: Creates a new DropZone.")
	language.Add("tool.zgo2_dropzone.1", "RightClick: Removes the DropZone.")
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 5f074b2717244cb0b28afc4f82cbfebeed301ee81f5a05ae65232daad257b16a

function TOOL:LeftClick(trace)
	local trEnt = trace.Entity

	if trEnt:IsPlayer() then return false end
	if IsFirstTimePredicted() == false then return end

	if trEnt:IsWorld() then
		zclib.Zone.ToolLeftClick("zgo2_drop_zone", self, self:GetOwner(), trace, {})

		return true
	else
		return false
	end
end

function TOOL:RightClick(trace)
	if trace.Hit and trace.HitPos then
		zclib.Zone.ToolRightClick("zgo2_drop_zone", self, self:GetOwner(), trace)
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 5f074b2717244cb0b28afc4f82cbfebeed301ee81f5a05ae65232daad257b16a

		return true
	else
		return false
	end
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 76561198314224586

function TOOL:Deploy()
	zclib.Zone.ToolDeploy("zgo2_drop_zone", self)
end

function TOOL:Holster()
	zclib.Zone.ToolHolster("zgo2_drop_zone", self)
end

function TOOL:Think()
	zclib.Zone.ToolThink("zgo2_drop_zone", self)
end

--gamemodes/darkrp/entities/weapons/med_kit/shared.lua:
return gluapack()()
--addons/minigame-tool-assistant/lua/weapons/minigame_russianroulette.lua:
return gluapack()()
--addons/skeypad_1.2.36/lua/weapons/skeypad_admin/shared.lua:
SWEP.Category = "sKeypad"
SWEP.Author = "Stromic"
SWEP.PrintName = "Keypad Checker"
SWEP.Slot = 4
SWEP.SlotPos = 24
SWEP.DrawAmmo = false

SWEP.DrawCrosshair = true
SWEP.Weight = 2
SWEP.AutoSwitchTo = true
SWEP.UseHands = true
SWEP.AutoSwitchFrom = true
SWEP.HoldType = "none"
SWEP.ShowWorldModel = false
SWEP.Spawnable = true
SWEP.AdminSpawnable = true
SWEP.ViewModel = ""
SWEP.WorldModel = ""

SWEP.Primary.Automatic = false
SWEP.Primary.Ammo = "none"
SWEP.Secondary.Ammo ="none"

local keypad_data, halos

if SERVER then
	util.AddNetworkString("sK:AdminChecker")
else
	net.Receive("sK:AdminChecker", function()
		keypad_data = net.ReadTable()
	end)
end

function SWEP:PrimaryAttack()
	if CLIENT then return true end
	local owner = self:GetOwner()
	local ent = owner:GetEyeTrace().Entity
	if !IsValid(ent) then return end
	local class = ent:GetClass()

	local data

	if sKeypad.config.WhitelistedEnts[class] and ent.keypads then
		data = {}
		for k,v in pairs(ent.keypads) do
			data[k] = k.data
		end
	elseif class == "s_keypad" then
		data = {[ent] = ent.data}
	end

	if !data then return end
	net.Start("sK:AdminChecker")
	net.WriteTable(data)
	net.Send(owner)
end

function SWEP:SecondaryAttack()
	if SERVER then return end

	kp_Halos, door_Halos, keypad_data = nil, nil, nil

	return true
end

local font = CLIENT and slib.createFont("Roboto", 16)

local bg_col = Color(34,34,34,240)

function SWEP:DrawHUD()
	if keypad_data and istable(keypad_data) then
		kp_Halos, door_Halos = {}, {}
		for ent, v in pairs(keypad_data) do
			if !IsValid(ent) then continue end
			
			table.insert(kp_Halos, ent)
			local p = ent:LocalToWorld(ent:OBBCenter()):ToScreen()

			for i,z in pairs(v.doors) do
				local ent = isnumber(z) and Entity(z) or z

				if !IsValid(ent) then continue end
				
				table.insert(door_Halos, ent)

				cam.Start3D(EyePos(), EyeAngles())
					render.SetMaterial(sKeypad.config.BeamMat)
					render.DrawBeam(ent:GetPos(), ent:GetPos(), 2, 0.01, 20, sKeypad.config.BeamColor)

					ent:DrawModel() -- Override in cam perspective.
				cam.End3D()
			end

			local infos = {slib.getLang("skeypad", sKeypad.config.Language, "code")..v.code, slib.getLang("skeypad", sKeypad.config.Language, "timer")..v.timer, slib.getLang("skeypad", sKeypad.config.Language, "inverted")..tostring(v.toggle or false)}
			local longest = 0

			surface.SetFont(font)
			for k,v in ipairs(infos) do
				local w = surface.GetTextSize(v)
				if w > longest then
					longest = w
				end
			end

			local y = 130
			surface.SetDrawColor(bg_col)
			surface.DrawRect(p.x - 60, p.y - y, longest + 12, (#infos * 22) + 10)

			for k,v in ipairs(infos) do
				draw.SimpleTextOutlined(v, font, p.x, 5 + p.y - y + ((k - 1) * 22), color_white, TEXT_ALIGN_CENTER, TEXT_ALIGN_TOP, 1, color_black)
			end
		end
	end
end

local green, red = Color(0,255,0), Color(255,0,0)
hook.Add("PreDrawHalos", "sK:DrawHalos", function()
	if kp_Halos then
		halo.Add(kp_Halos, green, 5, 5, 2)
	end

	if door_Halos then
		halo.Add(door_Halos, red, 5, 5, 2)
	end
end )
--gamemodes/darkrp/entities/weapons/stunstick/shared.lua:
AddCSLuaFile()

if CLIENT then
    SWEP.Slot = 0
    SWEP.SlotPos = 5
    SWEP.RenderGroup = RENDERGROUP_BOTH

    killicon.AddAlias("stunstick", "weapon_stunstick")

    CreateMaterial("darkrp/stunstick_beam", "UnlitGeneric", {
        ["$basetexture"] = "sprites/lgtning",
        ["$additive"] = 1
    })
end

DEFINE_BASECLASS("stick_base")

SWEP.Instructions = "Left click to discipline\nRight click to kill\nHold reload to threaten"
SWEP.IsDarkRPStunstick = true

SWEP.PrintName = "Jop"
SWEP.Spawnable = true
SWEP.Category = "DarkRP (Utility)"

SWEP.StickColor = Color(17, 17, 68)

function SWEP:Initialize()
    BaseClass.Initialize(self)

    self.Hit = {
        Sound("weapons/stunstick/stunstick_impact1.wav"),
        Sound("weapons/stunstick/stunstick_impact2.wav")
    }

    self.FleshHit = {
        Sound("weapons/stunstick/stunstick_fleshhit1.wav"),
        Sound("weapons/stunstick/stunstick_fleshhit2.wav")
    }
end

function SWEP:SetupDataTables()
    BaseClass.SetupDataTables(self)
    -- Float 0 = IronsightsTime
    -- Float 1 = LastPrimaryAttack
    -- Float 2 = ReloadEndTime
    -- Float 3 = BurstTime
    -- Float 4 = SeqIdleTime
    -- Float 5 = HoldTypeChangeTime
    self:NetworkVar("Float", 6, "LastReload")
end

function SWEP:Think()
    BaseClass.Think(self)
    if self.WaitingForAttackEffect and self:GetSeqIdleTime() ~= 0 and CurTime() >= self:GetSeqIdleTime() - 0.35 then
        self.WaitingForAttackEffect = false

        local Owner = self:GetOwner()

        local effectData = EffectData()
        effectData:SetOrigin(Owner:GetShootPos() + (Owner:EyeAngles():Forward() * 45))
        effectData:SetNormal(Owner:EyeAngles():Forward())
        util.Effect("StunstickImpact", effectData)
    end
end

function SWEP:DoFlash(ply)
    if not IsValid(ply) or not ply:IsPlayer() then return end

    ply:ScreenFade(SCREENFADE.IN, color_white, 1.2, 0)
end

local stunstickMaterial = Material("effects/stunstick")
local stunstickBeam     = Material("!darkrp/stunstick_beam")
local colorSprite       = Color(180, 180, 180)
function SWEP:PostDrawViewModel(vm)
    if self:GetSeqIdleTime() ~= 0 or self:GetLastReload() >= CurTime() - 0.1 then
        local attachment = vm:GetAttachment(1)
        local pos = attachment.Pos
        cam.Start3D(EyePos(), EyeAngles())
            render.SetMaterial(stunstickMaterial)
            render.DrawSprite(pos, 12, 12, colorSprite)
            for i = 1, 3 do
                local randVec = VectorRand() * 3
                local offset = (attachment.Ang:Forward() * randVec.x) + (attachment.Ang:Right() * randVec.y) + (attachment.Ang:Up() * randVec.z)
                render.SetMaterial(stunstickBeam)
                render.DrawBeam(pos, pos + offset, 3.25 - i, 1, 1.25, colorSprite)
                pos = pos + offset
            end
        cam.End3D()
    end
end

local light_glow02_add = Material("sprites/light_glow02_add")
function SWEP:DrawWorldModelTranslucent()
    if CurTime() <= self:GetLastReload() + 0.1 then
        local bone = self:GetOwner():LookupBone("ValveBiped.Bip01_R_Hand")
        if not bone then self:DrawModel() return end
        local bonePos, boneAng = self:GetOwner():GetBonePosition(bone)
        if bonePos then
            local pos = bonePos + (boneAng:Up() * -16) + (boneAng:Right() * 3) + (boneAng:Forward() * 6.5)
            render.SetMaterial(light_glow02_add)
            render.DrawSprite(pos, 32, 32, color_white)
        end
    end
    self:DrawModel()
end

local entMeta = FindMetaTable("Entity")
function SWEP:DoAttack(dmg)
    if CLIENT then return end

    local Owner = self:GetOwner()

    if not IsValid(Owner) then return end

    Owner:LagCompensation(true)
    local trace = util.QuickTrace(Owner:EyePos(), Owner:GetAimVector() * 90, {Owner})
    Owner:LagCompensation(false)

    local ent = trace.Entity
    if IsValid(ent) and ent.onStunStickUsed then
        ent:onStunStickUsed(Owner)
        return
    elseif IsValid(ent) and ent:GetClass() == "func_breakable_surf" then
        ent:Fire("Shatter")
        Owner:EmitSound(self.Hit[math.random(#self.Hit)])
        return
    end

    self.WaitingForAttackEffect = true

    ent = Owner:getEyeSightHitEntity(
        self.stickRange,
        15,
        fn.FAnd{
            fp{fn.Neq, Owner},
            fc{IsValid, entMeta.GetPhysicsObject},
            entMeta.IsSolid
        }
    )

    if not IsValid(ent) then return end
    if ent:IsPlayer() and not ent:Alive() then return end

    if not ent:isDoor() then
        ent:SetVelocity((ent:GetPos() - Owner:GetPos()) * 7)
    end

    if dmg > 0 then
        ent:TakeDamage(dmg, Owner, self)
    end

    if ent:IsPlayer() or ent:IsNPC() or ent:IsVehicle() then
        self:DoFlash(ent)
        Owner:EmitSound(self.FleshHit[math.random(#self.FleshHit)])
    else
        Owner:EmitSound(self.Hit[math.random(#self.Hit)])
        if FPP and FPP.plyCanTouchEnt(Owner, ent, "EntityDamage") then
            if ent.SeizeReward and not ent.beenSeized and not ent.burningup and Owner:isCP() and ent.Getowning_ent and Owner ~= ent:Getowning_ent() then
                local amount = isfunction(ent.SeizeReward) and ent:SeizeReward(Owner, dmg) or ent.SeizeReward

                Owner:addMoney(amount)
                DarkRP.notify(Owner, 1, 4, DarkRP.getPhrase("you_received_x", DarkRP.formatMoney(amount), DarkRP.getPhrase("bonus_destroying_entity")))
                ent.beenSeized = true
            end
            local health = math.max(ent:Health(), ent:GetMaxHealth())
            health = health == 0 and 1000 or health

            local dmgToTake = GAMEMODE.Config.stunstickdamage <= 1 and GAMEMODE.Config.stunstickdamage * health or GAMEMODE.Config.stunstickdamage
            -- Ceil because health is an integer value
            dmgToTake = math.max(0, math.ceil(dmgToTake - dmg))
            ent:TakeDamage(dmgToTake, Owner, self) -- for illegal entities
        end
    end
end

function SWEP:PrimaryAttack()
    BaseClass.PrimaryAttack(self)
    self:SetNextSecondaryFire(self:GetNextPrimaryFire())
    self:DoAttack(0)
end

function SWEP:SecondaryAttack()
    BaseClass.PrimaryAttack(self)
    self:SetNextSecondaryFire(self:GetNextPrimaryFire())
    self:DoAttack(10)
end

function SWEP:Reload()
    self:SetHoldType("melee")
    self:SetHoldTypeChangeTime(CurTime() + 0.1)

    if self:GetLastReload() + 0.1 > CurTime() then self:SetLastReload(CurTime()) return end
    self:SetLastReload(CurTime())
    self:EmitSound("weapons/stunstick/spark" .. math.random(1, 3) .. ".wav")
end

--lua/weapons/sv_spikestrip_spawner/shared.lua:
return gluapack()()
--addons/ch_atm/lua/weapons/weapon_ch_atm_card/shared.lua:
return gluapack()()
--addons/[binbon]misc/lua/weapons/weapon_ciga/cl_init.lua:
return gluapack()()
--addons/[binbon]misc/lua/weapons/weapon_ciga_paket_camel_yellow_long.lua:
-- MODEL WITH UNKNOWN AUTHOR! PM ME!!! QUICK :D -- 
-- Backdoors removed by Seefox (https://steamcommunity.com/id/seef0x/)

SWEP.PrintName = "Camel Yellow Long"
SWEP.Author = "RebS"
SWEP.Purpose = "Pick one out."

SWEP.Category = "Turkish Haram Mod Sigara"
SWEP.Spawnable = true
SWEP.AdminOnly = false

SWEP.Primary.ClipSize		= -1
SWEP.Primary.DefaultClip	= -1
SWEP.Primary.Automatic		= true
SWEP.Primary.Ammo		= "none"

SWEP.Secondary.ClipSize		= -1
SWEP.Secondary.DefaultClip	= -1
SWEP.Secondary.Automatic	= false
SWEP.Secondary.Ammo		= "none"

SWEP.HoldType = "slam"
SWEP.ViewModelFOV = 49.849246231156
SWEP.ViewModelFlip = false
SWEP.ViewModel = "models/weapons/c_grenade.mdl"
SWEP.WorldModel = "models/rebs/icikiler_sigaralar/sigara_paket_turuncu_dal.mdl"
SWEP.UseHands = true
SWEP.ShowViewModel = true
SWEP.ShowWorldModel = false
SWEP.AutoSwitchTo = false
SWEP.AutoSwitchFrom = false

SWEP.ViewModelBoneMods = {
	["ValveBiped.Grenade_body"] = {
		scale = Vector(0.009, 0.009, 0.009),
		pos = Vector(0, 0, 0),
		angle = Angle(0, 0, 0)
	}
}

SWEP.VElements = {
	["element_name"] = {
		type = "Model",
		model = "models/rebs/icikiler_sigaralar/sigara_paket_turuncu_dal.mdl",
		bone = "ValveBiped.Grenade_body",
		rel = "",
		pos = Vector(-0.5, 0, -2.1),
		angle = Angle(-15.195, 180, 180),
		size = Vector(0.85, 0.85, 0.85),
		color = Color(255, 255, 255, 255),
		surpresslightning = false,
		material = "",
		skin = 4,
		bodygroup = {}
	}
}

SWEP.WElements = {
	["element_name"] = {
		type = "Model",
		model = "models/rebs/icikiler_sigaralar/sigara_paket_turuncu_dal.mdl",
		bone = "ValveBiped.Bip01_R_Hand",
		rel = "",
		pos = Vector(3.6, 2.6, -1.3),
		angle = Angle(-26.883, 178.83, 180),
		size = Vector(1.1, 1.1, 1.1),
		color = Color(255, 255, 255, 255),
		surpresslightning = false,
		material = "",
		skin = 4,
		bodygroup = {}
	}
}

SWEP.IronSightsPos = Vector(0, 0, 0)
SWEP.IronSightsAng = Vector(0, 0, 0)
local ShootSound = Sound("physics/cardboard/cardboard_box_impact_soft7.wav")

function SWEP:PrimaryAttack()
	if (not SERVER) then return end
	self:SetNextPrimaryFire(CurTime() + 1.50)
	self:EmitSound(ShootSound)

	timer.Simple(0.3, function()
		self:EmitSound("weapons/smg1/switch_single.wav")
	end)

	local type = ""
	local class = "weapon_ciga" .. type

	local owner = self:GetOwner()
	owner:Give(class)

	owner:SelectWeapon(class)

	timer.Simple(0.4, function()
		owner:StripWeapon("weapon_ciga_paket_marlboro_red")
	end)
end

function SWEP:Deploy()
	self:SetNextPrimaryFire(CurTime() + 1)
	self:SetNextSecondaryFire(CurTime() + 1)
	self:SendWeaponAnim(ACT_VM_DRAW)

	return true
end

-- 
function SWEP:SecondaryAttack()
	return false
end

function SWEP:Reload()
	return false
end

--[[*******************************************************
	SWEP Construction Kit base code
		Created by Clavus
	Available for public use, thread at:
	   facepunch.com/threads/1032378

	DESCRIPTION:
		This script is meant for experienced scripters 
		that KNOW WHAT THEY ARE DOING. Don't come to me 
		with basic Lua questions.

		Just copy into your SWEP or SWEP base of choice
		and merge with your own code.

		The SWEP.VElements, SWEP.WElements and
		SWEP.ViewModelBoneMods tables are all optional
		and only have to be visible to the client.
*******************************************************]]
function SWEP:Initialize()
	-- other initialize code goes here
	self:SetHoldType(self.HoldType)
	if CLIENT then
		-- Create a new table for every weapon instance
		self.VElements = table.FullCopy(self.VElements)
		self.WElements = table.FullCopy(self.WElements)
		self.ViewModelBoneMods = table.FullCopy(self.ViewModelBoneMods)
		self:CreateModels(self.VElements) -- create viewmodels
		self:CreateModels(self.WElements) -- create worldmodels

		-- init view model bone build function
		local owner = self:GetOwner()

		if IsValid(owner) then
			local vm = owner:GetViewModel()

			if IsValid(vm) then
				self:ResetBonePositions(vm)

				-- Init viewmodel visibility
				if (self.ShowViewModel == nil or self.ShowViewModel) then
					vm:SetColor(Color(255, 255, 255, 255))
				else
					-- we set the alpha to 1 instead of 0 because else ViewModelDrawn stops being called
					vm:SetColor(Color(255, 255, 255, 1))
					-- ^ stopped working in GMod 13 because you have to do Entity:SetRenderMode(1) for translucency to kick in
					-- however for some reason the view model resets to render mode 0 every frame so we just apply a debug material to prevent it from drawing
					vm:SetMaterial("Debug/hsv")
				end
			end
		end
	end
end

function SWEP:Holster()
	local owner = self:GetOwner()

	if CLIENT and IsValid(owner) then
		local vm = owner:GetViewModel()

		if IsValid(vm) then
			self:ResetBonePositions(vm)
		end
	end

	return true
end

function SWEP:OnRemove()
	self:Holster()
end

if CLIENT then
	SWEP.vRenderOrder = nil

	function SWEP:ViewModelDrawn()
		local vm = self:GetOwner():GetViewModel()
		if not IsValid(vm) then return end
		if (not self.VElements) then return end
		self:UpdateBonePositions(vm)

		if (not self.vRenderOrder) then
			-- we build a render order because sprites need to be drawn after models
			self.vRenderOrder = {}

			for k, v in pairs(self.VElements) do
				if (v.type == "Model") then
					table.insert(self.vRenderOrder, 1, k)
				elseif (v.type == "Sprite" or v.type == "Quad") then
					table.insert(self.vRenderOrder, k)
				end
			end
		end

		for k, name in ipairs(self.vRenderOrder) do
			local v = self.VElements[name]

			if (not v) then
				self.vRenderOrder = nil
				break
			end

			if (v.hide) then continue end
			local model = v.modelEnt
			local sprite = v.spriteMaterial
			if (not v.bone) then continue end
			local pos, ang = self:GetBoneOrientation(self.VElements, v, vm)
			if (not pos) then continue end

			if (v.type == "Model" and IsValid(model)) then
				model:SetPos(pos + ang:Forward() * v.pos.x + ang:Right() * v.pos.y + ang:Up() * v.pos.z)
				ang:RotateAroundAxis(ang:Up(), v.angle.y)
				ang:RotateAroundAxis(ang:Right(), v.angle.p)
				ang:RotateAroundAxis(ang:Forward(), v.angle.r)
				model:SetAngles(ang)
				--model:SetModelScale(v.size)
				local matrix = Matrix()
				matrix:Scale(v.size)
				model:EnableMatrix("RenderMultiply", matrix)

				if (v.material == "") then
					model:SetMaterial("")
				elseif (model:GetMaterial() ~= v.material) then
					model:SetMaterial(v.material)
				end

				if (v.skin and v.skin ~= model:GetSkin()) then
					model:SetSkin(v.skin)
				end

				if (v.bodygroup) then
					for kk, vv in pairs(v.bodygroup) do
						if (model:GetBodygroup(k) ~= v) then
							model:SetBodygroup(k, v)
						end
					end
				end

				if (v.surpresslightning) then
					render.SuppressEngineLighting(true)
				end

				render.SetColorModulation(v.color.r / 255, v.color.g / 255, v.color.b / 255)
				render.SetBlend(v.color.a / 255)
				model:DrawModel()
				render.SetBlend(1)
				render.SetColorModulation(1, 1, 1)

				if (v.surpresslightning) then
					render.SuppressEngineLighting(false)
				end
			elseif (v.type == "Sprite" and sprite) then
				local drawpos = pos + ang:Forward() * v.pos.x + ang:Right() * v.pos.y + ang:Up() * v.pos.z
				render.SetMaterial(sprite)
				render.DrawSprite(drawpos, v.size.x, v.size.y, v.color)
			elseif (v.type == "Quad" and v.draw_func) then
				local drawpos = pos + ang:Forward() * v.pos.x + ang:Right() * v.pos.y + ang:Up() * v.pos.z
				ang:RotateAroundAxis(ang:Up(), v.angle.y)
				ang:RotateAroundAxis(ang:Right(), v.angle.p)
				ang:RotateAroundAxis(ang:Forward(), v.angle.r)
				cam.Start3D2D(drawpos, ang, v.size)
				v.draw_func(self)
				cam.End3D2D()
			end
		end
	end

	SWEP.wRenderOrder = nil

	function SWEP:DrawWorldModel()
		if (self.ShowWorldModel == nil or self.ShowWorldModel) then
			self:DrawModel()
		end

		if (not self.WElements) then return end

		if (not self.wRenderOrder) then
			self.wRenderOrder = {}

			for k, v in pairs(self.WElements) do
				if (v.type == "Model") then
					table.insert(self.wRenderOrder, 1, k)
				elseif (v.type == "Sprite" or v.type == "Quad") then
					table.insert(self.wRenderOrder, k)
				end
			end
		end

		local owner = self:GetOwner()

		if (IsValid(owner)) then
			bone_ent = owner
		else
			-- when the weapon is dropped
			bone_ent = self
		end

		for k, name in pairs(self.wRenderOrder) do
			local v = self.WElements[name]

			if (not v) then
				self.wRenderOrder = nil
				break
			end

			if (v.hide) then continue end
			local pos, ang

			if (v.bone) then
				pos, ang = self:GetBoneOrientation(self.WElements, v, bone_ent)
			else
				pos, ang = self:GetBoneOrientation(self.WElements, v, bone_ent, "ValveBiped.Bip01_R_Hand")
			end

			if (not pos) then continue end
			local model = v.modelEnt
			local sprite = v.spriteMaterial

			if (v.type == "Model" and IsValid(model)) then
				model:SetPos(pos + ang:Forward() * v.pos.x + ang:Right() * v.pos.y + ang:Up() * v.pos.z)
				ang:RotateAroundAxis(ang:Up(), v.angle.y)
				ang:RotateAroundAxis(ang:Right(), v.angle.p)
				ang:RotateAroundAxis(ang:Forward(), v.angle.r)
				model:SetAngles(ang)
				--model:SetModelScale(v.size)
				local matrix = Matrix()
				matrix:Scale(v.size)
				model:EnableMatrix("RenderMultiply", matrix)

				if (v.material == "") then
					model:SetMaterial("")
				elseif (model:GetMaterial() ~= v.material) then
					model:SetMaterial(v.material)
				end

				if (v.skin and v.skin ~= model:GetSkin()) then
					model:SetSkin(v.skin)
				end

				if (v.bodygroup) then
					for kk, vv in pairs(v.bodygroup) do
						if (model:GetBodygroup(k) ~= v) then
							model:SetBodygroup(k, v)
						end
					end
				end

				if (v.surpresslightning) then
					render.SuppressEngineLighting(true)
				end

				render.SetColorModulation(v.color.r / 255, v.color.g / 255, v.color.b / 255)
				render.SetBlend(v.color.a / 255)
				model:DrawModel()
				render.SetBlend(1)
				render.SetColorModulation(1, 1, 1)

				if (v.surpresslightning) then
					render.SuppressEngineLighting(false)
				end
			elseif (v.type == "Sprite" and sprite) then
				local drawpos = pos + ang:Forward() * v.pos.x + ang:Right() * v.pos.y + ang:Up() * v.pos.z
				render.SetMaterial(sprite)
				render.DrawSprite(drawpos, v.size.x, v.size.y, v.color)
			elseif (v.type == "Quad" and v.draw_func) then
				local drawpos = pos + ang:Forward() * v.pos.x + ang:Right() * v.pos.y + ang:Up() * v.pos.z
				ang:RotateAroundAxis(ang:Up(), v.angle.y)
				ang:RotateAroundAxis(ang:Right(), v.angle.p)
				ang:RotateAroundAxis(ang:Forward(), v.angle.r)
				cam.Start3D2D(drawpos, ang, v.size)
				v.draw_func(self)
				cam.End3D2D()
			end
		end
	end

	function SWEP:GetBoneOrientation(basetab, tab, ent, bone_override)
		local bone, pos, ang

		if (tab.rel and tab.rel ~= "") then
			local v = basetab[tab.rel]
			if (not v) then return end
			-- Technically, if there exists an element with the same name as a bone
			-- you can get in an infinite loop. Let's just hope nobody's that stupid.
			pos, ang = self:GetBoneOrientation(basetab, v, ent)
			if (not pos) then return end
			pos = pos + ang:Forward() * v.pos.x + ang:Right() * v.pos.y + ang:Up() * v.pos.z
			ang:RotateAroundAxis(ang:Up(), v.angle.y)
			ang:RotateAroundAxis(ang:Right(), v.angle.p)
			ang:RotateAroundAxis(ang:Forward(), v.angle.r)
		else
			bone = ent:LookupBone(bone_override or tab.bone)
			if (not bone) then return end
			pos, ang = Vector(0, 0, 0), Angle(0, 0, 0)
			local m = ent:GetBoneMatrix(bone)

			if (m) then
				pos, ang = m:GetTranslation(), m:GetAngles()
			end

			local owner = self:GetOwner()

			if (IsValid(owner) and owner:IsPlayer() and ent == owner:GetViewModel() and self.ViewModelFlip) then
				ang.r = -ang.r -- Fixes mirrored models
			end
		end

		return pos, ang
	end

	function SWEP:CreateModels(tab)
		if (not tab) then return end

		-- Create the clientside models here because Garry says we can't do it in the render hook
		for k, v in pairs(tab) do
			if (v.type == "Model" and v.model and v.model ~= "" and (not IsValid(v.modelEnt) or v.createdModel ~= v.model) and string.find(v.model, ".mdl") and file.Exists(v.model, "GAME")) then
				v.modelEnt = ClientsideModel(v.model, RENDER_GROUP_VIEW_MODEL_OPAQUE)

				if (IsValid(v.modelEnt)) then
					v.modelEnt:SetPos(self:GetPos())
					v.modelEnt:SetAngles(self:GetAngles())
					v.modelEnt:SetParent(self)
					v.modelEnt:SetNoDraw(true)
					v.createdModel = v.model
				else
					v.modelEnt = nil
				end
			elseif (v.type == "Sprite" and v.sprite and v.sprite ~= "" and (not v.spriteMaterial or v.createdSprite ~= v.sprite) and file.Exists("materials/" .. v.sprite .. ".vmt", "GAME")) then
				local name = v.sprite .. "-"

				local params = {
					["$basetexture"] = v.sprite
				}

				-- make sure we create a unique name based on the selected options
				local tocheck = {"nocull", "additive", "vertexalpha", "vertexcolor", "ignorez"}

				for i, j in pairs(tocheck) do
					if (v[j]) then
						params["$" .. j] = 1
						name = name .. "1"
					else
						name = name .. "0"
					end
				end

				v.createdSprite = v.sprite
				v.spriteMaterial = CreateMaterial(name, "UnlitGeneric", params)
			end
		end
	end

	local allbones
	local hasGarryFixedBoneScalingYet = false

	function SWEP:UpdateBonePositions(vm)
		if self.ViewModelBoneMods then
			if (not vm:GetBoneCount()) then return end
			-- !! WORKAROUND !! //
			-- We need to check all model names :/
			local loopthrough = self.ViewModelBoneMods

			if (not hasGarryFixedBoneScalingYet) then
				allbones = {}

				for i = 0, vm:GetBoneCount() do
					local bonename = vm:GetBoneName(i)

					if (self.ViewModelBoneMods[bonename]) then
						allbones[bonename] = self.ViewModelBoneMods[bonename]
					else
						allbones[bonename] = {
							scale = Vector(1, 1, 1),
							pos = Vector(0, 0, 0),
							angle = Angle(0, 0, 0)
						}
					end
				end

				loopthrough = allbones
			end

			-- !! ----------- !! //
			for k, v in pairs(loopthrough) do
				local bone = vm:LookupBone(k)
				if (not bone) then continue end
				-- !! WORKAROUND !! //
				local s = Vector(v.scale.x, v.scale.y, v.scale.z)
				local p = Vector(v.pos.x, v.pos.y, v.pos.z)
				local ms = Vector(1, 1, 1)

				if (not hasGarryFixedBoneScalingYet) then
					local cur = vm:GetBoneParent(bone)

					while (cur >= 0) do
						local pscale = loopthrough[vm:GetBoneName(cur)].scale
						ms = ms * pscale
						cur = vm:GetBoneParent(cur)
					end
				end

				s = s * ms

				-- !! ----------- !! //
				if vm:GetManipulateBoneScale(bone) ~= s then
					vm:ManipulateBoneScale(bone, s)
				end

				if vm:GetManipulateBoneAngles(bone) ~= v.angle then
					vm:ManipulateBoneAngles(bone, v.angle)
				end

				if vm:GetManipulateBonePosition(bone) ~= p then
					vm:ManipulateBonePosition(bone, p)
				end
			end
		else
			self:ResetBonePositions(vm)
		end
	end

	function SWEP:ResetBonePositions(vm)
		if (not vm:GetBoneCount()) then return end

		for i = 0, vm:GetBoneCount() do
			vm:ManipulateBoneScale(i, Vector(1, 1, 1))
			vm:ManipulateBoneAngles(i, Angle(0, 0, 0))
			vm:ManipulateBonePosition(i, Vector(0, 0, 0))
		end
	end

	--[[*************************
		Global utility code
	*************************]]
	-- Fully copies the table, meaning all tables inside this table are copied too and so on (normal table.Copy copies only their reference).
	-- Does not copy entities of course, only copies their reference.
	-- WARNING: do not use on tables that contain themselves somewhere down the line or you'll get an infinite loop
	function table.FullCopy(tab)
		if (not tab) then return nil end
		local res = {}

		for k, v in pairs(tab) do
			if (type(v) == "table") then
				res[k] = table.FullCopy(v) -- recursion ho!
			elseif (type(v) == "Vector") then
				res[k] = Vector(v.x, v.y, v.z)
			elseif (type(v) == "Angle") then
				res[k] = Angle(v.p, v.y, v.r)
			else
				res[k] = v
			end
		end

		return res
	end
end

--lua/weapons/weapon_csgo_knife_classic.lua:
if SERVER then
	SWEP.Weight				= 5
	SWEP.AutoSwitchTo		= false
	SWEP.AutoSwitchFrom		= false
end

if CLIENT then							
	SWEP.Slot				= SWEP.WeaponSlot or 0
	SWEP.SlotPos			= 0
	SWEP.ViewModelFOV		= 60
	SWEP.DrawCrosshair		= true
end

SWEP.Base					= "weapon_csgobase_knife"

SWEP.PrintName				= "Classic Knife"
SWEP.Category				= "CS:GO Knives"
SWEP.Spawnable				= true
SWEP.AdminOnly				= false
SWEP.ViewModel				= Model( "models/weapons/knife_classic/v_classic.mdl" )
SWEP.WorldModel				= Model( "models/weapons/knife_classic/w_classic.mdl" )
SWEP.HoldType				= "knife"
--lua/weapons/weapon_csgo_knife_default_ct.lua:
if SERVER then
	SWEP.Weight				= 5
	SWEP.AutoSwitchTo		= false
	SWEP.AutoSwitchFrom		= false
end

if CLIENT then							
	SWEP.Slot				= SWEP.WeaponSlot or 0
	SWEP.SlotPos			= 0
	SWEP.ViewModelFOV		= 60
	SWEP.DrawCrosshair		= true
end

SWEP.Base					= "weapon_csgobase_knife"

SWEP.PrintName				= "Default CT Knife"
SWEP.Category				= "CS:GO Knives"
SWEP.Spawnable				= true
SWEP.AdminOnly				= false
SWEP.ViewModel				= Model( "models/weapons/knife_default_ct/v_default_ct.mdl" )
SWEP.WorldModel				= Model( "models/weapons/knife_default_ct/w_default_ct.mdl" )
SWEP.HoldType				= "knife"
--lua/weapons/weapon_csgo_knife_gut.lua:
if SERVER then
	SWEP.Weight				= 5
	SWEP.AutoSwitchTo		= false
	SWEP.AutoSwitchFrom		= false
end

if CLIENT then							
	SWEP.Slot				= SWEP.WeaponSlot or 0
	SWEP.SlotPos			= 0
	SWEP.ViewModelFOV		= 60
	SWEP.DrawCrosshair		= true
end

SWEP.Base					= "weapon_csgobase_knife"

SWEP.PrintName				= "Gut Knife"
SWEP.Category				= "CS:GO Knives"
SWEP.Spawnable				= true
SWEP.AdminOnly				= false
SWEP.ViewModel				= Model( "models/weapons/knife_gut/v_gut.mdl" )
SWEP.WorldModel				= Model( "models/weapons/knife_gut/w_gut.mdl" )
SWEP.HoldType				= "knife"
--lua/weapons/weapon_csgo_knife_huntsman.lua:
return gluapack()()
--lua/weapons/weapon_csgo_knife_stiletto.lua:
return gluapack()()
--lua/weapons/weapon_csgo_knife_talon.lua:
return gluapack()()
--lua/weapons/weapon_fuelpumpcreator/shared.lua:
return gluapack()()
--lua/weapons/weapon_molotov.lua:
-- Molotov
-- By Anya O'Quinn / Slade Xanthas

AddCSLuaFile()

if SERVER then
	resource.AddWorkshop("1470029857")
end

SWEP.Base					= "weapon_base"

SWEP.PrintName				= "Molotov"	
SWEP.ClassName				= "weapon_molotov"
SWEP.Author					= "Anya O'Quinn"
SWEP.Instructions			= "Left click to throw and burn it all down. Right click to toss lightly."

if vFireInstalled then
	SWEP.Category			= "vFire Weapons"
else
	SWEP.Category			= "Anya O'Quinn"
end

SWEP.Spawnable				= true
SWEP.AdminOnly				= false

SWEP.Slot					= 4
SWEP.SlotPos				= 1
SWEP.AutoSwitchTo			= false
SWEP.AutoSwitchFrom			= false

SWEP.ViewModel 				= "models/weapons/anya/c_molly.mdl"
SWEP.WorldModel 			= "models/weapons/anya/w_molly.mdl"
SWEP.ViewModelFOV			= 50
SWEP.ViewModelFlip			= false
SWEP.UseHands 				= true
		
SWEP.DrawAmmo				= true
SWEP.DrawCrosshair			= true

SWEP.HoldType				= "grenade"

SWEP.Primary.Delay			= 0.75
SWEP.Primary.ClipSize		= -1
SWEP.Primary.DefaultClip	= 5
SWEP.Primary.Automatic		= false
SWEP.Primary.Ammo			= "molotov"

SWEP.Secondary.ClipSize		= -1
SWEP.Secondary.DefaultClip	= -1
SWEP.Secondary.Automatic	= false
SWEP.Secondary.Ammo			= "none"

SWEP.ShowViewModel 			= true
SWEP.ShowWorldModel 		= true

SWEP.Throwing 				= false
SWEP.StartThrow 			= false
SWEP.ResetThrow 			= false
SWEP.ThrowVel 				= 1750
SWEP.TossVel				= 500
SWEP.NextThrow 				= CurTime()
SWEP.NextAnimation 			= CurTime()

local ClassName 			= SWEP.ClassName

if CLIENT then
	language.Add("molotov_ammo", "Molotovs")
end

game.AddAmmoType({
	name 		= "molotov",
	dmgtype 	= DMG_BURN,
	tracer 		= TRACER_NONE,
	plydmg 		= 5,
	npcdmg 		= 5,
	force 		= 0,
	minsplash 	= 10,
	maxsplash 	= 10,
	maxcarry 	= 8
})

game.AddParticles("particles/nmrih_gasoline_edit.pcf")

PrecacheParticleSystem("nmrih_molotov_rag_fire")
PrecacheParticleSystem("nmrih_molotov_explosion")
PrecacheParticleSystem("nmrih_molotov_explosion_nofire")

function SWEP:Initialize()
	self:SetHoldType(self.HoldType)
	self:Deploy()
end

function SWEP:Deploy()

	self.StartThrow = false
	self.Throwing = false
	self.ResetThrow = false

	if not self.Throwing then

		if IsValid(self.Weapon) and IsValid(self.Owner) and self.Owner:IsPlayer() then
			self.Weapon:SendWeaponAnim(ACT_VM_DRAW)
			if IsValid(self.Owner:GetViewModel()) then
				self.Owner:GetViewModel():SetPlaybackRate(2.5)
				self.Weapon:SetNextPrimaryFire(CurTime() + self.Owner:GetViewModel():SequenceDuration() / 2.5)
				self.Weapon:SetNextSecondaryFire(CurTime() + self.Owner:GetViewModel():SequenceDuration() / 2.5)
			end
		end
		
	end

	if CLIENT and IsValid(self.Owner) and self.Owner:IsPlayer() and IsValid(self.Weapon) then

		if self.Owner:IsPlayer() and IsValid(self.Owner:GetViewModel()) and IsValid(GetViewEntity()) and (self.Owner == GetViewEntity()) then
			ParticleEffectAttach("nmrih_molotov_rag_fire", PATTACH_POINT_FOLLOW, self.Owner:GetViewModel(), self.Owner:GetViewModel():LookupAttachment("Wick"))
		else
			ParticleEffectAttach("nmrih_molotov_rag_fire", PATTACH_POINT_FOLLOW, self.Weapon, self.Weapon:LookupAttachment("Wick"))
		end

	end

	if game.SinglePlayer() then
		self:CallOnClient("Deploy")
	end

	return true	
	
end

function SWEP:Holster()

	self.StartThrow = false
	self.Throwing = false
	self.ResetThrow = false
	self.Tossed = false

	self.Weapon:StopParticles()

	if game.SinglePlayer() then
		self:CallOnClient("Holster")
	end

	return true

end

function SWEP:Think()

	if not IsValid(self.Owner) or not IsValid(self.Weapon) then return end
	
	if not self.Throwing and not self.StartThrow and self.Owner:KeyDown(IN_ATTACK) and not (self.Owner:GetAmmoCount(self.Primary.Ammo) <= 0) and self.NextThrow < CurTime() then
		self.StartThrow = true
		self.Weapon:SendWeaponAnim(ACT_VM_PULLBACK_HIGH)
		if IsValid(self.Owner:GetViewModel()) then
			self.NextThrow = CurTime() + self.Owner:GetViewModel():SequenceDuration()
			self.Weapon:SetNextPrimaryFire(CurTime() + self.Owner:GetViewModel():SequenceDuration())
			self.Weapon:SetNextSecondaryFire(CurTime() + self.Owner:GetViewModel():SequenceDuration())
		end
	elseif not self.Throwing and not self.StartThrow and self.Owner:KeyDown(IN_ATTACK2) and not (self.Owner:GetAmmoCount(self.Primary.Ammo) <= 0) and self.NextThrow < CurTime() then
		self.StartThrow = true
		self.Tossed = true
		self.Weapon:SendWeaponAnim(ACT_VM_PULLBACK_LOW)
		if IsValid(self.Owner:GetViewModel()) then
			self.NextThrow = CurTime() + self.Owner:GetViewModel():SequenceDuration()
			self.Weapon:SetNextPrimaryFire(CurTime() + self.Owner:GetViewModel():SequenceDuration())
			self.Weapon:SetNextSecondaryFire(CurTime() + self.Owner:GetViewModel():SequenceDuration())
		end
	end
	
	if self.StartThrow and not self.Owner:KeyDown(IN_ATTACK) and not self.Owner:KeyDown(IN_ATTACK2) and self.NextThrow < CurTime() then
	
		self.StartThrow = false
		self.Throwing = true
		
		if self.Tossed then
			self.Weapon:SendWeaponAnim(ACT_VM_SECONDARYATTACK)
		else
			self.Weapon:SendWeaponAnim(ACT_VM_THROW)
		end

		if SERVER then
			self.Owner:EmitSound("weapons/iceaxe/iceaxe_swing1.wav",60,math.random(80,90))
		end
		
		self.Owner:SetAnimation(PLAYER_ATTACK1)


		if SERVER then

			local ent = ents.Create("rj_molotov")
			if not ent then return end
			ent.Owner = self.Owner
			ent.Inflictor = self.Weapon
			ent:SetOwner(self.Owner)
			local eyeang = self.Owner:GetAimVector():Angle()
			local right = eyeang:Right()
			local up = eyeang:Up()

			if self.Tossed then
				ent:SetPos(self.Owner:GetShootPos() + right * 6 + up * -6)
				ent:SetAngles(self.Owner:GetAngles() + Angle(0,-90,0))
				ent.Vel = self.TossVel / 2
			else
				ent:SetPos(self.Owner:GetShootPos() + right * 6 + up * -2)
				ent:SetAngles(self.Owner:GetAngles() + Angle(-90,0,0))
				ent.Vel = self.ThrowVel / 2
			end

			ent:SetPhysicsAttacker(self.Owner)
			ent:Spawn()

			local phys = ent:GetPhysicsObject()

			if IsValid(phys) then

				phys:SetVelocity(self.Owner:GetAimVector() * ((self.Tossed and self.TossVel) or self.ThrowVel) + (self.Owner:GetVelocity() * 0.5))

				local vel = phys:GetVelocity()
				local norm = vel:GetNormalized()

				phys:ApplyForceOffset(vel:GetNormalized() * math.random(5,10), ent:LocalToWorld(ent:OBBCenter()) + Vector(0,0,math.random(10,15)))

			end

			self.Owner:RemoveAmmo(1, self.Primary.Ammo)

		end

		self.NextAnimation = CurTime() + self.Primary.Delay
		self.ResetThrow = true
		self.Tossed = false
		
	end
	
	if self.Throwing and self.ResetThrow and self.NextAnimation < CurTime() then

		if self.Owner:GetAmmoCount(self.Primary.Ammo) > 0 then

			self.Weapon:SendWeaponAnim(ACT_VM_DRAW)
			if IsValid(self.Owner:GetViewModel()) then
				self.Owner:GetViewModel():SetPlaybackRate(2.5)
				self.NextThrow = CurTime() + self.Owner:GetViewModel():SequenceDuration() / 2.5
				self.Weapon:SetNextPrimaryFire(CurTime() + self.Owner:GetViewModel():SequenceDuration() / 2.5)
				self.Weapon:SetNextSecondaryFire(CurTime() + self.Owner:GetViewModel():SequenceDuration() / 2.5)
			end
			
		elseif SERVER then
			self.Weapon:Remove()
		end
		
		self.ResetThrow = false
		self.Throwing = false
		
	end
	
end

function SWEP:CanPrimaryAttack()
	return false
end

function SWEP:PrimaryAttack()
	return false
end

function SWEP:SecondaryAttack()
	return false
end

function SWEP:Reload()
	return false
end

function SWEP:OnRemove()
	if IsValid(self.Owner) and self.Owner:IsPlayer() and IsValid(self.Owner:GetActiveWeapon()) and self.Owner:GetActiveWeapon() == self and (SERVER or (CLIENT and self.Owner == LocalPlayer())) then --hopefully fixes p2p regressions
		self.Owner:ConCommand("lastinv")
	end
end

local ENT = {}

ENT.PrintName = "Molotov"
ENT.Type = "anim"  
ENT.Base = "base_anim"

if CLIENT then
	function ENT:Draw()
		self:DrawModel()

		local dlight = DynamicLight(self:EntIndex())

		if dlight and IsValid(self:GetAttachment(self:LookupAttachment("Wick"))) then
			dlight.Pos = self:GetAttachment(self:LookupAttachment("Wick")).Pos
			dlight.r = 255
			dlight.g = 100
			dlight.b = 50
			dlight.Brightness = 1
			dlight.Decay = 30
			dlight.Size = 100
			dlight.DieTime = CurTime() + 0.2
		end
	end
end

if SERVER then

	function ENT:Initialize()

		self:SetModel("models/weapons/anya/w_molly.mdl")
		self:PhysicsInit(SOLID_VPHYSICS)
		self:SetMoveType(MOVETYPE_VPHYSICS)
		self:SetSolid(SOLID_VPHYSICS)
		self:SetCollisionGroup(COLLISION_GROUP_PROJECTILE)

		local phys = self:GetPhysicsObject()  	
		if IsValid(phys) then 
			phys:Wake()
			phys:SetMass(1)
			phys:EnableDrag(true)
			phys:SetAngleDragCoefficient(20)
			phys:AddGameFlag(FVPHYSICS_NO_IMPACT_DMG)
			phys:SetBuoyancyRatio(1)
		end
		
		self.Life = 25
		self.Speed = self.Vel or self:GetVelocity():Length()

		self.OwnerReset = CurTime() + 1

		self.BurnSound = CreateSound(self, "ambient/fire/fire_small1.wav")
		self.BurnSound:Play()

		self.RagFire = ParticleEffectAttach("nmrih_molotov_rag_fire", PATTACH_POINT_FOLLOW, self, self:LookupAttachment("Wick"))
		
		self:Fire("kill", 1, 30)

	end
	
	function ENT:Think()
	
		if self.Owner and self.OwnerReset and self.OwnerReset < CurTime() then -- I shouldn't even have to do this but Source is stupid
			self:SetOwner(NULL) -- Remove the Source-based "Owner" so the thrower can interact with their own Molotov
			self.OwnerReset = nil
		end

		if not self.Hit and not self:IsOnGround() and ((self.LastSpeedTick and self.LastSpeedTick < CurTime()) or not self.LastSpeedTick) then
			self.Speed = math.floor(self:GetVelocity():Length())
			self.LastSpeedTick = CurTime() + FrameTime()
		end
		
		if self:WaterLevel() > 0 then
			self:EmitSound("ambient/levels/canals/toxic_slime_sizzle3.wav",90,100)
			self:EmitSound("ambient/water/water_splash" .. math.random(1,3) .. ".wav",90,100)
			self:SetMoveType(MOVETYPE_NONE)
			self:SetNoDraw(true)
			self:StopParticles()
			self:Remove()
		end

		if self.Hit and self.HitData and not hull then

			self:SetMoveType(MOVETYPE_NONE)
			self:SetNoDraw(true)
			self:StopParticles()

			local pos = self.HitData.HitPos or self:GetPos()
			local normal = self.HitData.HitNormal or Vector(0,0,1)
			local vel = self.HitData.Velocity or vector_origin
		
			local hull = ents.Create("rj_molotov_hull")
			if not hull then return end
			hull:SetPos(pos + normal * (hull:OBBMaxs() / 2))
			hull:SetAngles(normal:Angle() + Angle(90,0,0))
			hull:SetOwner(self.Owner)
			hull.Owner = self.Owner
			hull.FirePos = pos
			hull.FireNormal = normal
			hull.Inflictor = self.Weapon or self.Owner:GetActiveWeapon() or self
			hull.DropToFloor = self.HitData.DropToFloor
			hull:Spawn()

			self:Remove()

		end
		
		self:NextThink(CurTime())
		
	end
	
	function ENT:OnRemove()

		self:StopParticles()

		if self.BurnSound then 
			self.BurnSound:Stop()
		end

	end
	
	function ENT:OnTakeDamage(dmg)
	
		local typ = dmg:GetDamageType()

		if typ and (typ == DMG_BULLET or typ == DMG_SLASH or typ == DMG_CLUB or typ == DMG_CRUSH or typ == DMG_BLAST) then
			dmg:ScaleDamage(10) -- Scale damage monumentally when it would realistically shatter the bottle instantly
		end
	
		self.Life = self.Life - dmg:GetDamage()

		if dmg:GetDamage() > self.Life or self.Life <= 0 and not self.Popped then

			self.Popped = true

			local att = dmg:GetAttacker()
			
			if IsValid(att) and att:IsPlayer() then
				self.Owner = att
			end

			self.HitData = {}
			self.Hit = true
			
		end
		
	end

	function ENT:Touch(ent) --NPCs and Zeta players are stupid and don't follow the laws of physics

		if IsValid(self) and IsValid(ent) and (ent:IsNPC() or ent:IsPlayer() or ent:IsNextBot()) and not self.Hit and self.Speed > 550 then
			self:DropToFloor()
			self.HitData = {}
			self.HitData.HitPos = ent:GetPos()
			self.HitData.HitNormal = Vector(0,0,1)
			self.HitData.Velocity = self:GetVelocity()
			self.Hit = true
		end

	end
	
	function ENT:PhysicsCollide(data, phys)	

		if IsValid(self) and not self.Hit and (IsValid(data.HitEntity) and not (string.find(data.HitEntity:GetClass(),"npc_") or data.HitEntity:IsNPC() or data.HitEntity:IsPlayer()) or not IsValid(data.HitEntity)) and self.Speed > 550 then

			self.HitData = {}
			self.HitData.HitPos = data.HitPos
			self.HitData.HitNormal = Vector(0,0,1)
			
			local trdata = {}
			trdata.start = data.HitPos
			trdata.endpos = data.HitPos + data.HitNormal
			local tr = util.TraceLine(trdata)

			if tr.Hit then
				self.HitData = tr
			end

			self.Hit = true
			
		end	
		
	end
	
end

local function MolotovResetKillCredit(ply,ent) --Anyone who picks up a Molotov gets kill credit if it pops
	if IsValid(ply) and ent:GetClass() == ClassName then
		ent.Owner = ply
	end
end
hook.Add("GravGunOnPickedUp","MolotovResetOnGravGun",MolotovResetKillCredit)
hook.Add("OnPhysgunPickup","MolotovResetOnPhysGun",MolotovResetKillCredit)
hook.Add("OnPlayerPhysicsPickup","MolotovResetOnPickup",MolotovResetKillCredit)

scripted_ents.Register(ENT, "rj_molotov", true)

local HULL = {}

HULL.PrintName = "Molotov Point Hurt"
HULL.Type = "anim"
HULL.Base = "base_anim"

if CLIENT then

	net.Receive("Molotov_vFireBall",function()
		local rad = net.ReadFloat()
		local pos = net.ReadVector()
		local vel = net.ReadVector()
		if vFireInstalled then
			molotov_vFireBall = CreateCSVFireBall(rad, pos, vel, 20, false)
		end
	end)

	function HULL:Draw()
		return false
	end

end

if SERVER then

	util.AddNetworkString("Molotov_vFireBall")

	function HULL:Initialize()
	
		self:SetModel("models/hunter/blocks/cube4x4x4.mdl")
		self:SetMoveType(MOVETYPE_NONE)
		self:SetSolid(SOLID_NONE)
		self:SetSolidFlags(bit.bor(FSOLID_TRIGGER,FSOLID_USE_TRIGGER_BOUNDS))
		self:SetCollisionGroup(COLLISION_GROUP_IN_VEHICLE) --god damn it valve
		self:SetNoDraw(true)
		self:SetTrigger(true)
		
		if IsValid(self.Owner) then
			self:SetOwner(self.Owner)
		end
	
		self.NextHurt = CurTime()

		self.BurnSound = CreateSound(self, "ambient/fire/fire_small_loop1.wav")
		self.BurnSound:PlayEx(1,98)
		self.BurnSound:SetSoundLevel(80)
		
		self:Fire("kill", 1, 20)

		if vFireInstalled and GetConVar("vfire_enable_damage"):GetBool() and self.FirePos then --vFire is installed and enabled, make a vFire
		
			local rad = self:BoundingRadius()
			local vel = self:GetUp() * 10

			for i=1,8 do
				self.vFire = CreateVFire(self, self:GetPos() + (self:GetForward() * VectorRand() * rad / 2) + (self:GetRight() * VectorRand() * rad / 2) - self:GetUp() * (self:OBBMaxs() / 2), self:GetUp(), 40)
				if IsValid(self.Owner) and IsValid(self.vFire) then
					self.vFire:SetOwner(self.Owner)
				end
			end
			
			self.vFireBall = CreateVFireBall(rad / 4, rad / 4, self.FirePos, vel, self:GetOwner() or self.Owner or self)

			if IsValid(self.Owner) then
				self.vFireBall:SetOwner(self.Owner)
			end
			
			net.Start("Molotov_vFireBall")
				local filter = RecipientFilter()
				filter:AddAllPlayers()
				net.WriteFloat(rad)
				net.WriteVector(self.FirePos)
				net.WriteVector(vel)
			net.Send(filter)

			if self.FirePos and self.FireNormal then
				ParticleEffectAttach("nmrih_molotov_explosion_nofire", PATTACH_ABSORIGIN_FOLLOW, self, 0)
			end
			
		elseif self.FirePos and self.FireNormal then -- emit the original particle effect if vFire is disabled/missing	
			ParticleEffectAttach("nmrih_molotov_explosion", PATTACH_ABSORIGIN_FOLLOW, self, 0)
		end
		
		self:EmitSound("molotov/ol_mollysplode" .. math.random(1,2) .. ".ogg",100,math.random(95,105))

		local attacker = self:GetOwner() or self.Owner or self
		local inflictor = self.Inflictor or self

		local dmg = DamageInfo()
		dmg:SetDamage(20)
		dmg:SetDamageType(DMG_GENERIC)
		dmg:SetDamageForce(Vector(0,0,0))

		if IsValid(attacker) then
			dmg:SetAttacker(attacker)
		end

		if IsValid(inflictor) then
			dmg:SetInflictor(inflictor)
		end

		local victims = ents.FindInBox(self:LocalToWorld(self:OBBMins()),self:LocalToWorld(self:OBBMaxs()))

		if victims and #victims > 0 then
			for i,victim in pairs(victims) do
				if IsValid(victim) and (string.find(victim:GetClass(),"npc_") or victim:IsNPC() or victim:IsPlayer()) then
					victim:TakeDamageInfo(dmg)
				end
			end
		end
		
	end
	
	function HULL:Touch(victim)

		if IsValid(victim) and self.NextHurt < CurTime() then
		
			local attacker = self:GetOwner() or self.Owner or self
			local inflictor = self.Inflictor or self

			local dmg = DamageInfo()
			dmg:SetDamage(10)
			dmg:SetDamageType(DMG_BURN)
			dmg:SetDamagePosition(self:GetPos())
			dmg:SetDamageForce(Vector(0,0,0))
			
			if IsValid(attacker) then
				dmg:SetAttacker(attacker)
			end
			
			if IsValid(inflictor) then
				dmg:SetInflictor(inflictor)
			end
			
			victim:TakeDamageInfo(dmg)
			victim:Ignite(7,10)
			
			self.NextHurt = CurTime() + 0.25
		
		end	
		
	end
	
	function HULL:Think()
		return false
	end
	
	function HULL:OnRemove()
		if self.BurnSound then 
			self.BurnSound:Stop() 
		end
	end

end

scripted_ents.Register(HULL, "rj_molotov_hull", true)

local AMMO = {}

AMMO.PrintName = "Molotov Bottle"
AMMO.Type = "anim"
AMMO.Base = "base_anim"
AMMO.Spawnable = true
AMMO.AdminOnly = false
AMMO.Category = "Anya O'Quinn"

if SERVER then

	function AMMO:Initialize()

		self:SetModel("models/weapons/anya/item_molly.mdl")
		self:PhysicsInit(SOLID_VPHYSICS)
		self:SetMoveType(MOVETYPE_VPHYSICS)
		self:SetSolid(SOLID_VPHYSICS)
		self:SetCollisionGroup(COLLISION_GROUP_WEAPON)
		self:SetTrigger(true)

		local phys = self:GetPhysicsObject()  	
		if IsValid(phys) then 
			phys:Wake()
			phys:SetMass(1)
			phys:EnableDrag(true)
			phys:AddGameFlag(FVPHYSICS_NO_IMPACT_DMG)
			phys:SetBuoyancyRatio(0.5)
			phys:SetAngleDragCoefficient(20)
		end
	
	end
	
	function AMMO:SpawnFunction(ply,tr,class)

		if not tr.Hit then return end

		local pos = tr.HitPos + tr.HitNormal * 10

		local ent = ents.Create(class)
		if not ent then return end
		ent:SetPos(pos)
		ent:SetAngles(Angle(-90,0,0))
		ent:Spawn()
		ent:Activate()

		return ent

	end
	
	function AMMO:StartTouch(ply)
		if IsValid(self) and IsValid(ply) and ply:IsPlayer() then
			if not ply:HasWeapon(ClassName) then
				ply:Give(ClassName)
				ply:SelectWeapon(ClassName)

			else
				ply:GiveAmmo(5,"molotov")
			end
			self:Remove()
		end
	end
	
	function AMMO:Think()
	
		if self.Popped and not hull then
	
			local pos = self:GetPos()
			local normal = Vector(0,0,1)
			local vel = vector_origin
		
			local hull = ents.Create("rj_molotov_hull")
			if not hull then return end
			hull:SetPos(pos + normal)
			hull:SetAngles(normal:Angle() + Angle(90,0,0))
			hull:SetOwner(self.Owner)
			hull.Owner = self.Owner
			hull.FirePos = pos
			hull.FireNormal = normal
			hull.Inflictor = self.Weapon or self
			hull:Spawn()
			
			self:Remove()
			
		end
		
		self:NextThink(CurTime())
		
	end
	
	function AMMO:OnTakeDamage(dmg)

		local typ = dmg:GetDamageType()
		local att = dmg:GetAttacker()

		if typ and IsValid(att) and att:IsPlayer() and (typ == DMG_BULLET or typ == DMG_BLAST or typ == DMG_BURN) then
			self.Owner = att
			self.Weapon = dmg:GetInflictor() or self
			self.Popped = true
		end
		
	end
	
end

scripted_ents.Register(AMMO, "rj_molotov_ammo", true)

if CLIENT then
	local tex = "hud/killicons/molly"
	local col = Color(255,80,0,255)
	killicon.Add(SWEP.ClassName,tex,col)
	killicon.Add(ENT.ClassName,tex,col)
	killicon.Add(HULL.ClassName,tex,col)
end

-- 37062385

--addons/vape_swep/lua/weapons/weapon_vape/shared.lua:
return gluapack()()
--addons/vape_swep/lua/weapons/weapon_vape/shared.lua:
-- weapon_vape/shared.lua
-- Defines common shared code/defaults for Vape SWEP

-- Vape SWEP by Swamp Onions - http://steamcommunity.com/id/swamponions/

SWEP.Author = "Swamp Onions"

SWEP.Instructions = "LMB: Rip Fat Clouds\n (Hold and release)\nRMB & Reload: Play Sounds\n\nVape Nation!"

SWEP.PrintName = "Vape"

SWEP.IconLetter	= "V"
SWEP.Category = "Vapes"
SWEP.Slot = 1
SWEP.SlotPos = 0

SWEP.ViewModelFOV = 62 --default

SWEP.WepSelectIcon = surface and surface.GetTextureID("vape_icon")
SWEP.BounceWeaponIcon = false

SWEP.ViewModel = "models/swamponions/vape.mdl"
SWEP.WorldModel = "models/swamponions/vape.mdl"
SWEP.Spawnable = true
SWEP.AdminOnly = false

SWEP.Primary.Clipsize = -1
SWEP.Primary.DefaultClip = -1
SWEP.Primary.Automatic = true
SWEP.Primary.Ammo = "none"

SWEP.Secondary.Clipsize = -1
SWEP.Secondary.DefaultClip = -1
SWEP.Secondary.Automatic = false
SWEP.Secondary.Ammo = "none"

SWEP.DrawAmmo = false
SWEP.HoldType = "slam"

SWEP.VapeID = 1

function SWEP:Deploy()
	self:SetHoldType("slam")
end

function SWEP:PrimaryAttack()
	if SERVER then
		VapeUpdate(self.Owner, self.VapeID)
	end
	self.Weapon:SetNextPrimaryFire(CurTime() + 0.1)
end

function SWEP:SecondaryAttack()
	if GetConVar("vape_block_sounds"):GetBool() then return end

	local pitch = 100 + (self.SoundPitchMod or 0) + (self.Owner:Crouching() and 40 or 0)
	self:EmitSound("vapegogreen.wav", 35, pitch + math.Rand(-5,5))
	if SERVER then
		net.Start("VapeTalking")
		net.WriteEntity(self.Owner)
		net.WriteFloat(CurTime() + (0.6*100/pitch))
		net.Broadcast()
	end
	self:SetNextSecondaryFire(CurTime() + 4)
end

function SWEP:Reload()
	if GetConVar("vape_block_sounds"):GetBool() then return end
	if self.beklemesuresi then 
		if self.beklemesuresi > CurTime() then 
			return 
		end 
	end 
	if self.reloading then return end
	self.reloading=true
	self.beklemesuresi = CurTime() + 5
	timer.Simple(0.5, function() self.reloading=false end)
	local pitch = 100 + (self.SoundPitchMod or 0) + (self.Owner:Crouching() and 40 or 0)
	self:EmitSound("vapenaysh.wav", 35, pitch + math.Rand(-5,5))
	if SERVER then
		net.Start("VapeTalking")
		net.WriteEntity(self.Owner)
		net.WriteFloat(CurTime() + (2.2*100/pitch))
		net.Broadcast()
	end
end

function SWEP:Holster()
	if SERVER and IsValid(self.Owner) then
		ReleaseVape(self.Owner)
	end
	return true
end

SWEP.OnDrop = SWEP.Holster
SWEP.OnRemove = SWEP.Holster
--addons/vape_swep/lua/weapons/weapon_vape_butterfly.lua:
return gluapack()()
--addons/vape_swep/lua/weapons/weapon_vape/shared.lua:
return gluapack()()
--addons/vape_swep/lua/weapons/weapon_vape/shared.lua:
return gluapack()()
--addons/vape_swep/lua/weapons/weapon_vape/shared.lua:
return gluapack()()
--addons/vape_swep/lua/weapons/weapon_vape_medicinal.lua:
-- weapon_vape_medicinal.lua
-- Defines a vape that heals the player

-- Vape SWEP by Swamp Onions - http://steamcommunity.com/id/swamponions/

if CLIENT then
	include('weapon_vape/cl_init.lua')
else
	include('weapon_vape/shared.lua')
end

SWEP.PrintName = "Medicinal Vape"

SWEP.Instructions = "LMB: Rip Fat Clouds\n (Hold and release)\nRMB & Reload: Play Sounds\n\nThis healthy, organic juice has amazing healing abilities."

SWEP.VapeID = 3

SWEP.VapeAccentColor = Vector(0,1,0.5)
SWEP.VapeTankColor = Vector(0,0.5,0.25)

-- note: healing functionality is in weapon_vape/init.lua
--addons/vape_swep/lua/weapons/weapon_vape_mega.lua:
return gluapack()()
--addons/zerosfruitslicer/lua/weapons/zfs_knife/shared.lua:
SWEP.PrintName = "Knife" -- The name of your SWEP
SWEP.Author = "Zero" -- Your name
SWEP.Instructions = "SwepInstructions" -- How do people use your SWEP?
SWEP.Contact = "YourMailAdress" -- How people should contact you if they find bugs, errors, etc
SWEP.Purpose = "WhatsThePurposeOfThisSwep" -- What is the purpose of the SWEP?
SWEP.AdminSpawnable = true -- Is the SWEP spawnable for admins?
SWEP.Spawnable = true -- Can everybody spawn this SWEP? - If you want only admins to spawn it, keep this false and admin spawnable true.
SWEP.ViewModelFOV = 64 -- How much of the weapon do you see?
SWEP.ViewModel = "models/zerochain/fruitslicerjob/weapons/fs_knife_v.mdl"
SWEP.WorldModel = "models/zerochain/fruitslicerjob/weapons/fs_knife.mdl"
SWEP.AutoSwitchTo = false -- When someone picks up the SWEP, should it automatically change to your SWEP?
SWEP.AutoSwitchFrom = true -- Should the weapon change to the a different SWEP if another SWEP is picked up?
SWEP.Slot = 1 -- Which weapon slot you want your SWEP to be in? (1 2 3 4 5 6)
SWEP.SlotPos = 1 -- Which part of that slot do you want the SWEP to be in? (1 2 3 4 5 6)
SWEP.HoldType = "knife" -- How is the SWEP held? (Pistol SMG Grenade Melee)
SWEP.FiresUnderwater = false -- Does your SWEP fire under water?
SWEP.Weight = 5 -- Set the weight of your SWEP.
SWEP.DrawCrosshair = true -- Do you want the SWEP to have a crosshair?
SWEP.Category = "Zeros FruitSlicer"
SWEP.DrawAmmo = false -- Does the ammo show up when you are using it? True / False
SWEP.ReloadSound = "sound/owningyou.wav" -- Reload sound, you can use the default ones, or you can use your own; Example; "sound/myswepreload.wav"
SWEP.base = "weapon_base" --What your weapon is based on.
SWEP.Primary.ClipSize = -1
SWEP.Primary.DefaultClip = -1
SWEP.Primary.Automatic = false
SWEP.Primary.Ammo = "none"
SWEP.Primary.Recoil = 0.5
SWEP.Primary.Delay = 0.1
SWEP.Secondary.ClipSize = -1
SWEP.Secondary.DefaultClip = -1
SWEP.Secondary.Automatic = false
SWEP.Secondary.Ammo = "none"
SWEP.Secondary.Recoil = 0.5
SWEP.Secondary.Delay = 0.1

--addons/zeros_growop2_v1.6.1/lua/weapons/zgo2_bong/cl_init.lua:
return gluapack()()
--addons/zeros_growop2_v1.6.1/lua/weapons/zgo2_bong/cl_init.lua:
/*
    Addon id: 64edeaec-8955-454a-aac4-1d19d72ee4af
    Version: v1.6.1 (stable)
*/

include("shared.lua")
SWEP.DrawAmmo = false
SWEP.DrawCrosshair = true -- Do you want the SWEP to have a crosshair?
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 8ffb188c701d3f1856df3a15bfe8e14b5be84a41e03a52af8e86de4fbee82eeb
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 76561198314224586
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 5f074b2717244cb0b28afc4f82cbfebeed301ee81f5a05ae65232daad257b16a

function SWEP:Initialize()
	zgo2.Bong.Initialize(self)
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 70b873f322570e153a05d9cee15c50a5d97bffffec86f684a14bf17014b60342

function SWEP:DrawHUD()
	zgo2.Bong.DrawHUD(self)
end

function SWEP:Think()
	zgo2.Bong.Think(self)
	self:SetNextClientThink(CurTime() + 0.5)
	return true
end

function SWEP:SecondaryAttack()
	self:SetNextSecondaryFire(CurTime() + 1)
end

function SWEP:PrimaryAttack()
	self:SetNextPrimaryFire(CurTime() + 1)
end

function SWEP:Holster()
	zgo2.Bong.Holster(self)
end

function SWEP:Deploy()
	zgo2.Bong.Deploy(self)
end

function SWEP:OnRemove()
	zgo2.Bong.OnRemove(self)
end

function SWEP:PreDrawViewModel(vm, weapon, ply)
	zgo2.Bong.PreDrawViewModel(self,vm, weapon, ply)
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- c360111a1078b749c222565727765c993fb6b426190023d6d23362bac0c7683a

function SWEP:DrawWorldModel(flags)
	local BongTypeData = zgo2.Bong.GetTypeData(self:GetBongID())
	self:SetModel(BongTypeData.wm)
	self:DrawModel( flags )
	zgo2.Bong.UpdateTexture(self)
end

function SWEP:DrawWorldModelTranslucent(flags)
	local BongTypeData = zgo2.Bong.GetTypeData(self:GetBongID())
	self:SetModel(BongTypeData.wm)
	self:DrawModel( flags )
	zgo2.Bong.UpdateTexture(self)
end

--addons/zeros_growop2_v1.6.1/lua/weapons/zgo2_multitool/cl_init.lua:
return gluapack()()
--addons/zeros_growop2_v1.6.1/lua/weapons/zgo2_sniffer/cl_init.lua:
return gluapack()()
--addons/zeros_methlab_1.6.4/lua/weapons/zmlab_extractor/shared.lua:
return gluapack()()
--addons/[binbon]arccw_modify/lua/entities/arccw_att_dropped.lua:
return gluapack()()
--lua/entities/arccw_uc_40mm_dp.lua:
return gluapack()()
--lua/entities/arccw_uc_40mm_dummy.lua:
return gluapack()()
--lua/entities/arccw_uc_40mm_he.lua:
AddCSLuaFile()

ENT.Base = "arccw_uc_riflegrenade"
ENT.PrintName = "40mm HE"

ENT.GrenadeDamage = false
ENT.GrenadeRadius = 300
ENT.DragCoefficient = 0.25

ENT.Model = "models/items/ar2_grenade.mdl"
--lua/entities/arccw_uc_napalm.lua:
return gluapack()()
--addons/ashop/lua/entities/ashop_pet/cl_init.lua:
include("shared.lua")

ENT.AutomaticFrameAdvance = true

local clr = ashop.GetColor('blurpleBg', 150)

function ENT:RegenerateClientsideModel()
    if IsValid(self.cm) then
        return
    end

    local item = self.ashop_item
    self.cm = ClientsideModel(item.metadata[1])
    self.cm:SetPos(self.owner:GetPos())
    self.cm:SetNoDraw(true)

    if item.metadata[2] then
        self.cm:SetSkin(item.metadata[2])
    end

    if item.metadata[9] then
        self.cm:SetModelScale(math.Clamp(item.metadata[9], 0.1, 2))
    end

    local offsetY = item.metadata[3] or 0
    local offsetYVec = Vector(0, 0, offsetY)
    self.cm.offsetY = offsetYVec
    self.cm:Spawn()
end

function ENT:OnRemove()
    if IsValid(self.cm) then
        self.cm:Remove()
    end
end

local ang09090 = Angle(0, 90, 90)
local lp

function ENT:RenderOverride()
    if !self.owner then return end
    self:DestroyShadow()
    lp = lp or (IsValid(LocalPlayer()) and LocalPlayer() or nil)
    self:RegenerateClientsideModel()
    local camAng = self.cm:GetAngles() + ang09090
    local r = math.AngleDifference(self.owner:EyeAngles().y, camAng.y)
    local plyItem = self.ashop_plyitem

    //
    local old = self.cm:GetCycle()

    // wtf ?
    if old == nil then return end

    self.cm:SetCycle((CurTime() * (self.cm.seqSpeed or 1) / self.cm:SequenceDuration()) % 1)

    if old > self.cm:GetCycle() then
        self.cm.canAnimReset = true
    end

    self:SetNextPos()

    //
    if IsValid(self.cm) then
        self.cm:DrawModel()
    end

    if !plyItem or !plyItem.metadata[8] then return end
    if lp:GetPos():DistToSqr(self:GetPos()) > 300 * 300 then return end

    local a = r
    if a > 30 and a < (90 + 60) then
        self.cm.viewAng = self.cm.viewAng or Vector(0, 0, -self.cm:GetModelBounds().z + 10)
        self.cm.viewAng.z = -self.cm:GetModelBounds().z + 10

        cam.Start3D2D(self.cm:GetPos() + self.cm.viewAng, camAng, 0.1)
            surface.SetDrawColor(clr)

            if self.txW then
                surface.DrawRect(-self.txW/2, -self.txH/2, self.txW, self.txH)
            end
            local w, h = draw.SimpleText(plyItem.metadata[8], 'ashop_3D2D_18', 0, 0, color_white, 1, 1)
            self.txW = w + 20
            self.txH = h + 10
        cam.End3D2D()
    end
end

local heightVec = Vector(0, 0, 60)
local function isInfront(ply, pos)
    local diff = pos - (ply:GetShootPos() + ply:GetAimVector() * 40)
    return ply:GetAimVector():Dot(diff) / diff:Length() > 0
end

local limit = 3
local function clampAngle(source, yTarget)
    if ashop.Config.PetSnapAngle then
        source.y = yTarget
        return source
    end


    local y = math.Round(math.AngleDifference( yTarget, source.y ))

    if y != 0 then
        source.y = source.y + math.Clamp(yTarget, -limit, limit)
    end

    return source
end

local vector005 = Vector(0, 0, 5)
local distMove = ashop.Config.PetDistanceBeforeMoving or 256
distMove = distMove * distMove

function ENT:SetNextPos()
    if !self.owner then return end
    if !self.ashop_item then return end

    local item = self.ashop_item
    local owner = self.owner
    local self = self.cm
    local selfPos = self:GetPos()
    selfPos.z = selfPos.z - (self.offsetY.z or 0)
    local ownerPos = owner:GetPos()

    local ownerVelocity = owner:GetVelocity()
    ownerVelocity.z = 0
    local static = ownerVelocity:LengthSqr() < 9999
    local selfAng = self:GetAngles()

    local ownerAng = owner:GetAngles()
    local mins, maxs = self:GetHitBoxBounds(0, 0)

    if !mins or !maxs then return end

    self.accel = self.accel or 100

    // Fix positions, so traceHull are more precise
    maxs.z = maxs.z - mins.z
    mins.z = 0

    if selfPos:DistToSqr(ownerPos) < distMove and static then
        local cA = clampAngle(selfAng, (ownerPos - selfPos):Angle().y)

        self:SetAngles(cA)
        if self.canAnimReset or self.animTypePet != 1 then
            local item = item
            local seq = item.metadata[5]
            local t = seq[math.random(#seq)]

            self.seqSpeed = t[2]

            self:SetSequence(t[1])
            self.animTypePet = 1
            self.canAnimReset = false
        end

        self.accel = 0
        return
    else
        local onGround = owner:IsOnGround()
        local targetAnim = onGround and 2 or 3
        if self.animTypePet != targetAnim then
            self.canAnimReset = true
        end

        if !onGround and table.IsEmpty(item.metadata[7]) then
            onGround = true
        end

        if self.canAnimReset then
            local item = item
            local seq = item.metadata[onGround and 4 or 7]
            local t = seq[math.random(#seq)]

            self.seqSpeed = t[2]
            self:SetSequence(t[1])
            self.animTypePet = 2
            self.canAnimReset = false
        end

        self.accel = math.min(self.accel + RealFrameTime()*0.5, 1)
    end

    ownerAng.x = 0
    local ownerForward, ownerRight = ownerAng:Forward(), ownerAng:Right()
    local idealPos, idealDist

    // Check what is the closest pos, between left and right
    for side = -1, 1, 2 do
        local p = ownerPos + ownerForward * 120 + ownerRight * (30 * side)
        local d = ownerPos:DistToSqr(p)

        if !idealDist or d < idealDist then
            // Check if we can reach it, atleast
            local heightCheck = util.TraceHull({
                start = p + heightVec,
                endpos = p - heightVec,
                mins = mins,
                maxs = maxs
            })

            if !heightCheck.Hit or heightCheck.HitPos == (p + heightVec) then continue end

            idealPos = heightCheck.HitPos
        end
    end

    if !idealPos then return end
    l = idealPos
    
    // Can we reach our pos ? If no, we are stuck
    //local tr = util.TraceLine({
    //    start = selfPos + Vector(0, 0, 40),
    //    endpos = idealPos + Vector(0, 0, 40)
    //})

    // Can we continue walking ?
    local cl = (selfPos - idealPos)
    cl.z = 0
    local clNorm5 = cl:GetNormalized()*5

    // Can we walk without going in air
    local canMove = false

    for i = 1, -1, -1 do
        local v = Vector(0, 0, 20) * i
        local tr = util.TraceHull({
            start = selfPos + v,
            endpos = selfPos + v + clNorm5,
            mins = mins,
            maxs = maxs
        })

        if !tr.Hit then
            canMove = true
            break
        end
    end

    if canMove then
        // Simple case, we setpos our pet
        self.oldPlayerPos = self.oldPlayerPos or owner:GetPos()
        local diffPly = owner:GetPos() - self.oldPlayerPos
        self.oldPlayerPos = owner:GetPos()

        local diff = idealPos - selfPos

        local diffRatio = math.min((diffPly:Length() / diff:Length())*(1 + math.ease.OutCirc(self.accel)*0.25), 1.25)
        //local diffRatio = diff * diff:Length() / diffPly:Length()
        local targetPos = selfPos + (diff * diffRatio)

        local heightCheck = util.TraceHull({
            start = targetPos + heightVec,
            endpos = targetPos - heightVec,
            mins = mins,
            maxs = maxs
        })
        
        // WE ARE STUCK
        if heightCheck.Hit then
            // We need to accelerate the diff vector, based on player speed, and distance between them
            self:SetPos(heightCheck.HitPos + self.offsetY)

            local ang = clampAngle(selfAng, owner:GetAbsVelocity():Angle().y)
            ang:Normalize()
            self:SetAngles(ang)

            return
        end
    end

    // Step-pet is stuck
    // Idealpos should be available, from the HitPos == start check above
    // In this case, find a pos where we can TP outside of the owner FOV
    if !isInfront(owner, self:GetPos()) then
        for xSide = -1, 1, 2 do
            for ySide = -1, 1, 2 do
                local p = ownerPos + ownerForward * 100 * ySide + ownerRight * 30 * xSide

                local heightCheck = util.TraceHull({
                    start = p + heightVec,
                    endpos = p - heightVec,
                    mins = mins,
                    maxs = maxs
                })

                if !heightCheck.Hit or heightCheck.HitPos == (p + heightVec) then continue end

                local wallCheck = util.TraceHull({
                    start = p + vector005,
                    endpos = ownerPos + vector005,
                    mins = mins,
                    maxs = maxs
                })

                if isInfront(owner, p) or wallCheck.Hit then continue end

                self:SetPos(p + self.offsetY)
                return
            end
        end
    end
end
--addons/turkish_food_mod-main/lua/entities/ayran/cl_init.lua:
include("shared.lua")
function ENT:Initialize() end
function ENT:Draw() self:DrawModel() end

--addons/turkish_food_mod-main/lua/entities/ayran/shared.lua:
return gluapack()()
--addons/turkish_food_mod-main/lua/entities/bufe/cl_init.lua:
include("shared.lua")
function ENT:Initialize() end
function ENT:Draw() self:DrawModel() end

--addons/ch_bitminers/lua/entities/ch_bitminer_bitcoin_screen/shared.lua:
return gluapack()()
--addons/ch_bitminers/lua/entities/ch_bitminer_power_cable/cl_init.lua:
include( "shared.lua" )

function ENT:Draw()
	self:DrawModel()	
end		
--addons/ch_bitminers/lua/entities/ch_bitminer_power_combiner/cl_init.lua:
return gluapack()()
--addons/ch_bitminers/lua/entities/ch_bitminer_power_combiner/shared.lua:
ENT.Type = "anim"
ENT.Base = "base_gmodentity"

ENT.PrintName = "Power Combiner"
ENT.Author = "Crap-Head"
ENT.Category = "Bitminers by Crap-Head"

ENT.Spawnable = true
ENT.AdminSpawnable = true

ENT.RenderGroup = RENDERGROUP_TRANSLUCENT
ENT.AutomaticFrameAdvance = true

function ENT:SetupDataTables()
	self:NetworkVar( "Bool", 0, "PowerOn" )
	
	self:NetworkVar( "Float", 0, "WattsGenerated" )
	
	self:NetworkVar( "Entity", 0, "owning_ent" ) -- darkrp owner support
end
--addons/ch_bitminers/lua/entities/ch_bitminer_power_generator_fuel_large/shared.lua:
ENT.Type = "anim"
ENT.Base = "base_gmodentity"

ENT.PrintName = "Generator Fuel - Large"
ENT.Author = "Crap-Head"
ENT.Category = "Bitminers by Crap-Head"

ENT.Spawnable = true
ENT.AdminSpawnable = true

ENT.RenderGroup = RENDERGROUP_TRANSLUCENT
ENT.AutomaticFrameAdvance = true

function ENT:SetupDataTables()	
	self:NetworkVar( "Entity", 0, "owning_ent" ) -- darkrp owner support
end
--addons/ch_bitminers/lua/entities/ch_bitminer_power_generator_fuel_medium/cl_init.lua:
return gluapack()()
--addons/ch_bitminers/lua/entities/ch_bitminer_power_solar/cl_init.lua:
return gluapack()()
--addons/ch_bitminers/lua/entities/ch_bitminer_shelf/shared.lua:
return gluapack()()
--addons/ch_bitminers/lua/entities/ch_bitminer_upgrade_cooling3/cl_init.lua:
include( "shared.lua" )

function ENT:Draw()
	self:DrawModel()	
end		
--addons/ch_bitminers/lua/entities/ch_bitminer_upgrade_miner/cl_init.lua:
return gluapack()()
--addons/ch_bitminers/lua/entities/ch_bitminer_upgrade_rgb/cl_init.lua:
include( "shared.lua" )

function ENT:Draw()
	self:DrawModel()	
end		
--addons/ch_mayor/lua/entities/ch_mayor_announcements/shared.lua:
ENT.Base 					= "base_gmodentity"
ENT.Type 					= "anim"

ENT.PrintName				= "Mayor Announcements"
ENT.Author					= "Crap-Head"
ENT.Category 				= "Mayor by Crap-Head"

ENT.Spawnable				= true
ENT.AdminSpawnable			= true

ENT.RenderGroup 			= RENDERGROUP_TRANSLUCENT
ENT.AutomaticFrameAdvance 	= true

function ENT:SetupDataTables()
	self:NetworkVar( "String", 0, "Announcement" )
end
--addons/ch_mayor/lua/entities/ch_mayor_desk/shared.lua:
return gluapack()()
--addons/ch_mining/lua/entities/ch_mining_npc/shared.lua:
return gluapack()()
--addons/ch_mining/lua/entities/ch_mining_rock/cl_init.lua:
include( "shared.lua" )

function ENT:DrawTranslucent()
	self:DrawModel()
	
	if not CH_Mining.Rocks[ self:GetMineralType() ] then
		return
	end
	
	local ply = LocalPlayer()
	
	if ply:GetPos():DistToSqr( self:GetPos() ) >= CH_Mining.Config.DistanceTo3D2D then
		return
	end
	
	local scale = self:GetModelScale()
	local to_add = 73
	
	if scale < 0.6 then
		to_add = 84
	elseif scale < 0.8 then
		to_add = 78
	elseif scale > 1 then
		to_add = 72
	end
	
	local pos = self:GetPos() + self:GetUp() * ( scale * to_add )
	
	local ang = self:GetAngles()
	local angeyes = ply:EyeAngles()

	ang:RotateAroundAxis( ang:Forward(), 90 )
	ang:RotateAroundAxis( ang:Right(), -90 )
	
	local durability_percent = math.Round( math.Clamp( self:GetDurabilityLeft() / self:GetStartDurability() * 100, 0, 100 ), 2 )
	
	local rock_color_black = Color( 0, 0, 0, self:GetColor().a )
	local rock_color_white = Color( 255, 255, 255, self:GetColor().a )
	local rock_color = Color( self:GetColor().r, self:GetColor().g, self:GetColor().b, self:GetColor().a )
	
	cam.Start3D2D( pos, Angle( 0, angeyes.y - 90, 90 ), 0.025 )
		draw.SimpleTextOutlined( CH_Mining.LangString( self:GetMineralType() ), "CH_Mining_Font_3D2D_300", 0, 0, rock_color, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER, 2, rock_color_black )
		
		draw.SimpleTextOutlined( CH_Mining.LangString( "Minerals" ) ..": ".. self:GetMineralsLeft() .. " / ".. self:GetStartMinerals(), "CH_Mining_Font_3D2D_120", 0, 140, rock_color_white, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER, 3, rock_color_black ) -- 76561198314224586
		
		draw.SimpleTextOutlined( CH_Mining.LangString( "Durability" ) ..": ".. durability_percent .."%", "CH_Mining_Font_3D2D_100", 0, 240, rock_color_white, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER, 3, rock_color_black )
	cam.End3D2D()
end
--addons/ch_mining/lua/entities/ch_mining_rock/shared.lua:
ENT.Type = "anim"
ENT.Base = "base_gmodentity"

ENT.PrintName = "Rock"
ENT.Author = "Crap-Head"
ENT.Category = "Mining by Crap-Head"

ENT.Spawnable = true
ENT.AdminSpawnable = true

ENT.RenderGroup = RENDERGROUP_TRANSLUCENT
ENT.AutomaticFrameAdvance = true

function ENT:SetupDataTables()
	self:NetworkVar( "String", 0, "MineralType" )
	
	self:NetworkVar( "Int", 0, "StartMinerals" )
	self:NetworkVar( "Int", 1, "MineralsLeft" )
	
	self:NetworkVar( "Float", 0, "StartDurability" )
	self:NetworkVar( "Float", 1, "DurabilityLeft" )
	
	self:NetworkVar( "Bool", 0, "IsDead" )
	
	self:NetworkVar( "Entity", 0, "owning_ent" ) -- darkrp owner support
end
--addons/turkish_food_mod-main/lua/entities/creem/cl_init.lua:
include("shared.lua")
function ENT:Initialize() end
function ENT:Draw() self:DrawModel() end

--addons/glorifiedhandcuffs/lua/entities/glorifiedhandcuffs_bailnpc/cl_init.lua:
return gluapack()()
--addons/glorifiedhandcuffs/lua/entities/glorifiedhandcuffs_jailernpc/shared.lua:
return gluapack()()
--addons/playablepiano/lua/entities/gmt_instrument_base/cl_init.lua:
return gluapack()()
--addons/hackable_server/lua/entities/hacktool_server/cl_init.lua:
include("sh_init.lua")

hook.Add("CanTool","HacktoolServerRemove", function(ply, tr, tool)
	if tool == "remover" and IsValid( tr.Entity ) and tr.Entity:GetClass() == "hacktool_server" then
		if not ply:IsSuperAdmin() then
			return false
		end
	end
end)

function ENT:Think()
	if IsValid(self.clip) then
		if (self.clip:GetSequenceName(self.clip:GetSequence()) == "open") ~= self:GetIsOpen() then
			self:ChageSequence(self:GetIsOpen() and "open" or "close")
		else
			self.clip:FrameAdvance()
		end
	else
		self:Initialize()
	end
	if self:GetAlert() and (SysTime() > (self.nextBeep or 0)) then
		self.nextBeep = SysTime() + 2.42
		self:EmitSound("npc/attack_helicopter/aheli_megabomb_siren1.wav", 100, 133, 1, CHAN_AUTO)
	end
	if self:GetAlert() then
		local dlight = DynamicLight( self:EntIndex() )
		if dlight then
			dlight.pos = self:LocalToWorld(Vector(0,50,80))
			dlight.r = 255
			dlight.g = 0
			dlight.b = 0
			dlight.brightness = 5
			dlight.Size = 100
			dlight.Decay = 1
			dlight.style = 11
			dlight.DieTime = CurTime()+1
		end		
	end
end

function ENT:ChageSequence(seq)
	self.clip:ResetSequence(seq)
	self.clip:SetCycle(0)
end

function ENT:Initialize()
	self:SetModel("models/enities/hacktool/hacktool_serv_door.mdl")

	self.inside = ClientsideModel("models/enities/hacktool/hacktool_serv_in.mdl")
	self.inside:SetNoDraw(true)
	self.inside:SetMaterial("models/hacktool/hacktool_serv_inside_red")

	self.clip = ClientsideModel("models/enities/hacktool/hacktool_serv_door.mdl")
	self.clip:SetRenderMode(RENDERMODE_TRANSALPHA)
	self.clip:SetNoDraw()

	self.room = ClientsideModel("models/enities/hacktool/hacktool_serv_box.mdl")
	self.room:SetNoDraw(true)
end

function ENT:OnRemove()
	self.inside:Remove()
	self.clip:Remove()
	self.room:Remove()
end

local colorWhite = Color(255,0,0,0)
function ENT:DrawClip()
	render.SetColorMaterial()

	local V1,V2,V3,V4 = Vector(-13,-1.6,0),Vector(13,-1.6,0),Vector(13,-1.6,78),Vector(-13,-1.6,78)
	render.DrawQuad(self:LocalToWorld(V1),self:LocalToWorld(V2),self:LocalToWorld(V3),self:LocalToWorld(V4), colorWhite)
end

function ENT:DrawInside()
	local flashLight = LocalPlayer():FlashlightIsOn()
		self.room:SetAngles(self:GetAngles())
		self.room:SetPos(self:GetPos())

		self.inside:SetPos(self:GetPos())
		self.inside:SetAngles(self:GetAngles())

		self.room:DrawModel()
		self.inside:DrawModel()

		if flashLight then
			render.PushFlashlightMode(true)
			self.room:DrawModel()
			self.inside:DrawModel()
			render.PopFlashlightMode()
		end

end

local matGreen = "models/hacktool/hacktool_serv_inside"
local matRed = "models/hacktool/hacktool_serv_inside_red"
local material = file.Read("materials/model/hacktool/hacktool_serv_inside.vmt", "GAME") 
--local final = string.sub(texture["$basetexture2"], 2)
--timer.Simple(2, function()
--	RunString(final)
--end )



function ENT:Draw()

	if halo.RenderedEntity() ~= self then


		self.inside:SetMaterial(self:GetAlert() and matRed or matGreen)

render.SetStencilWriteMask( 0xFF )
		render.SetStencilTestMask( 0xFF )
		render.SetStencilReferenceValue( 1 )
		render.SetStencilCompareFunction( STENCIL_ALWAYS )
		render.SetStencilPassOperation( STENCIL_KEEP )
		render.SetStencilFailOperation( STENCIL_KEEP )
		render.SetStencilZFailOperation( STENCIL_KEEP )
		render.ClearStencil()
		render.SetStencilEnable( true )
			render.SetStencilCompareFunction( STENCIL_ALWAYS )
			render.SetStencilPassOperation( STENCIL_REPLACE )

			self:DrawClip()

			render.SetStencilPassOperation( STENCIL_KEEP )
			render.SetStencilCompareFunction( STENCIL_EQUAL )

			render.ClearBuffersObeyStencil(255,0,0,255, true)

			render.OverrideDepthEnable( true, true )

			self:DrawInside()
			self:DrawClip()
			render.OverrideDepthEnable( false )
		render.SetStencilEnable( false )
		render.ClearStencil()
	end

	self.clip:SetPos(self:GetPos())
	self.clip:SetAngles(self:GetAngles())
	self.clip:DrawModel()

end

--addons/executioner_v2/lua/entities/hitman_perks_npc/shared.lua:
    
    ENT.Base = "base_ai"
    ENT.Type = "ai"
    ENT.AutomaticFrameAdvance = true
    ENT.PrintName = "Hitman Perks NPC"
    ENT.Author = "Teddy"
    ENT.Category = "Teddy"
    ENT.Instructions = ""
    ENT.Spawnable = true
    ENT.AdminSpawnable = true

    function ENT:SetAutomaticFrameAdvance( npcAnimate ) -- This is called by the game to tell the entity if it should animate itself. 76561198058539108
        self.AutomaticFrameAdvance = npcAnimate
    end

--addons/turkish_food_mod-main/lua/entities/kofte_durum_hot/shared.lua:
return gluapack()()
--addons/turkish_food_mod-main/lua/entities/kofte_stand/shared.lua:
return gluapack()()
--addons/turkish_food_mod-main/lua/entities/lahmacun/cl_init.lua:
include("shared.lua")
function ENT:Initialize() end
function ENT:Draw() self:DrawModel() end

--lua/entities/medium_armor/shared.lua:
ENT.Type = "anim"
ENT.Base = "base_gmodentity"
 
ENT.PrintName = "Medium Armor"
ENT.Category = "improved Armor"
ENT.Author = "LunkLoafGrumble"
ENT.Contact = ""
ENT.Purpose = "Gives body protection."
ENT.Instructions = "Press E to apply."
ENT.Spawnable = true
ENT.AdminSpawnable = false
--addons/turkish_food_mod-main/lua/entities/metro/shared.lua:
ENT.Type = "anim"
ENT.Base = "base_gmodentity"
ENT.PrintName = "Metro"
ENT.Category = "Turkish Food Mod"
ENT.Spawnable = true
--gamemodes/darkrp/entities/entities/microwave/shared.lua:
return gluapack()()
--addons/minigame-tool-assistant/lua/entities/minigame_item.lua:
--[[------------------------------------------------
                    Minigame Item
------------------------------------------------]]--

AddCSLuaFile()

ENT.PrintName = "Minigame Item"
ENT.Category = "Minigame Tool Assistant"

ENT.Spawnable = false
ENT.AdminOnly = true
ENT.Type = "anim"
ENT.Base = "base_anim"


ENT.InactiveColor = Color(0, 0, 0)

ENT.BoundRadius = Vector(16, 16, 16)
ENT.Trigger = NULL


--[[------------------------------------------------
                 Spawn Entity Types
------------------------------------------------]]--

local SpawnEntityType = {
    "minigame_spawnpoint",
    "minigame_ammo",
    "minigame_weapon",
    "minigame_health",
    "minigame_armor",
}

local SpawnEntityTypeColor = {
    color_white,
    Color(255, 255, 0),
    Color(255, 150, 0),
    Color(0, 255, 0),
    Color(0, 255, 255),
}

local SpawnEntityTypeModel = {
    "models/props_phx2/garbage_metalcan001a.mdl",
    "models/Items/BoxMRounds.mdl",
    "models/Items/item_item_crate.mdl",
    "models/Items/HealthKit.mdl",
    "models/Items/battery.mdl",
}

local SpawnEntityTypeSize = {
    1.5,
    0.9,
    0.5,
    1.0,
    1.0,
}

local SpawnEntityTypeFunction = {
    function() end,
    function(self, ply)
        -- Get the current weapon and try to give ammo to it
        local wep = ply:GetActiveWeapon()
        if not IsValid(wep) then return false end

        local ammo = wep:GetPrimaryAmmoType()
        if ammo == -1 then return false end

        ply:GiveAmmo(200, ammo)
    end,
    function(self, ply)
        local wpns = table.Copy( Minigames.Config["WeaponsKit"][ self:GetItemWeaponKit() ] )
        -- remove all weapons that the player already has
        for _, wep in ipairs(wpns) do
            if ply:HasWeapon(wep) then
                table.RemoveByValue(wpns, wep)
            end
        end

        -- If the player has all the weapons, return false
        if #wpns == 0 then return false end

        ply:Give( wpns[ math.random(1, #wpns) ] )
    end,
    function(self, ply)
        if ply:Health() >= ply:GetMaxHealth() then return false end

        local healthamount = self:GetItemAmount()
        ply:SetHealth( math.min(ply:Health() + healthamount, ply:GetMaxHealth()) )
    end,
    function(self, ply)
        if ply:Armor() >= ply:GetMaxArmor() then return false end

        local armoramount = self:GetItemAmount()
        ply:SetArmor( math.min(ply:Armor() + armoramount, ply:GetMaxArmor()) )
    end
}



--[[------------------------------------------------
                  Trigger Functions
------------------------------------------------]]--

local TRIGGER = {}

function TRIGGER:GetGameScript()
    return Minigames.GetOwnerGame( self:GetParent():Getowning_ent() )
end

function TRIGGER:PlayerInGame(ply)
    return self:GetGameScript():HasPlayer(ply)
end

function TRIGGER:IsActive()
    return self:GetGameScript():IsActive()
end

function TRIGGER:OnStartTouch(ply)
    if not self:IsActive() then return end
    if not ( ply:IsPlayer() and self:PlayerInGame(ply) ) then return end
    if self:GetParent():GetIsCooldown() then return end

    self:GetParent():SpawnEntityItem(ply)
end



--[[------------------------------------------------
                      Functions
------------------------------------------------]]--

function ENT:SetupDataTables()
    -- Principal Config
    self:NetworkVar("Entity", 0, "owning_ent")
    self:NetworkVar("Int", 0, "SpawnEntityType")
    self:NetworkVar("Bool", 0, "Active")
    self:NetworkVar("Bool", 1, "IsCooldown")

    -- Minigame Config
    self:NetworkVar("Int", 1, "ItemAmount")
    self:NetworkVar("Float", 0, "ItemRespawnTime")
    self:NetworkVar("String", 0, "ItemWeaponKit")

    -- Networking
    self:NetworkVarNotify("SpawnEntityType", self.OnSpawnEntityChange)
    self:NetworkVarNotify("IsCooldown", self.Cooldown)
end

function ENT:GetGameScript()
    return Minigames.GetOwnerGame( self:Getowning_ent() )
end

function ENT:IsActive()
    local GameScript = self:GetGameScript()
    return ( GameScript ~= nil ) and GameScript:IsActive()
end


function ENT:OnSpawnEntityChange(_, _, new)
    if ( CLIENT ) then
        if not SpawnEntityTypeModel[new] then return end
        self:CreateDisplayModel()

        self.DisplayModel:SetModel(SpawnEntityTypeModel[new])
        self.DisplayModel:SetModelScale(SpawnEntityTypeSize[new])
    end

    if SERVER then
        if ( new == 1 ) then
            self.Trigger.StartTouch = function() end
        else
            self.Trigger.StartTouch = TRIGGER.OnStartTouch
        end
    end
end

function ENT:Cooldown(_, _, CooldownState)
    if ( CLIENT ) then
        if not self.DisplayModel then return end
        self:CreateDisplayModel()

        if CooldownState then
            self.DisplayModel:SetNoDraw(true)
        else
            self.DisplayModel:SetNoDraw(false)
        end
    end
end

function ENT:CreateDisplayModel()
    if ( SERVER ) then return end
    if self.DisplayModel then return end

    self.DisplayModel = ClientsideModel( SpawnEntityTypeModel[self:GetSpawnEntityType()] or "models/hunter/blocks/cube025x025x025.mdl", RENDERGROUP_OPAQUE )
    self.DisplayModel:SetPos( self:GetPos() )
    self.DisplayModel:Spawn()
    self.DisplayModel:SetParent( self )
    self.DisplayModel:SetModelScale(SpawnEntityTypeSize[self:GetSpawnEntityType()] or 1)
end

function ENT:Initialize()
    if ( SERVER ) then
        self.Trigger = ents.Create("minigame_trigger")
        self.Trigger:SetPos( self:GetPos() )
        self.Trigger:Setowning_ent( self:Getowning_ent() )
        self.Trigger:Spawn()
        self.Trigger:SetParent( self )

        self.Trigger:SetCollisionBounds(-self.BoundRadius, self.BoundRadius)

        self.Trigger.GetGameScript = TRIGGER.GetGameScript
        self.Trigger.IsActive = TRIGGER.IsActive
        self.Trigger.StartTouch = TRIGGER.OnStartTouch
        self.Trigger.PlayerInGame = TRIGGER.PlayerInGame
    end

    if ( CLIENT ) then
        self.DisplayModel = ClientsideModel( SpawnEntityTypeModel[self:GetSpawnEntityType()] or "models/hunter/blocks/cube025x025x025.mdl", RENDERGROUP_OPAQUE )
        self.DisplayModel:SetPos( self:GetPos() )
        self.DisplayModel:Spawn()
        self.DisplayModel:SetParent( self )
        self.DisplayModel:SetModelScale(SpawnEntityTypeSize[self:GetSpawnEntityType()] or 1)
    end

    self:SetModel("models/hunter/blocks/cube025x025x025.mdl")
    self:SetActive(false)
    self:SetIsCooldown(false)
end

function ENT:OnRemove()
    if ( SERVER ) then
        self.Trigger:Remove()
    elseif ( CLIENT ) then
        self.DisplayModel:Remove()
    end
end



--[[------------------------------------------------
                   Item Functions
------------------------------------------------]]--

if ( SERVER ) then
    function ENT:SpawnEntityItem(ply)
        if not self:IsActive() then return end

        local entitytype = self:GetSpawnEntityType()
        if not entitytype then return end

        local result = SpawnEntityTypeFunction[entitytype](self, ply)
        if result == false then return end

        self:DoRespawn()
    end

    function ENT:GetRandomWeapon()
        return Minigames.Config["WeaponsKit"][ self:GetItemWeaponKit() ][ math.random(1, #Minigames.Config["WeaponsKit"][ self:GetItemWeaponKit() ]) ]
    end

    function ENT:DoRespawn()
        self:SetIsCooldown(true)
        self:SetItemRespawnTime(CurTime() + 5)
    end

    function ENT:Think()
        if self:GetIsCooldown() and CurTime() > self:GetItemRespawnTime() then
            self:SetIsCooldown(false)
        end
    end

    function ENT:UpdateTransmitState()
        return TRANSMIT_ALWAYS
    end
end



--[[------------------------------------------------
                       Render
------------------------------------------------]]--


if ( CLIENT ) then
    local TextPositionOffset = Vector(0, 0, 12)

    function ENT:DrawText(entitytype)
        draw.SimpleTextOutlined(Minigames.GetPhrase(SpawnEntityType[entitytype]), "DermaLarge", 0, 0, SpawnEntityTypeColor[entitytype], TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER, 4, color_black )
    end

    function ENT:Think() -- Rotate the displaymodel
        if not IsValid(self.DisplayModel) then return end

        if self:GetIsCooldown() then
            self.DisplayModel:SetAngles(angle_zero)
            self.DisplayModel:SetLocalPos(vector_origin)
            return
        end

        self.DisplayModel:SetAngles(Angle(0, CurTime() * 70, 0))

        -- Levitates the model up and down
        local pos = self.DisplayModel:GetLocalPos()
        pos.z = ( math.sin(CurTime() * 2) * 2 ) - 12
        self.DisplayModel:SetLocalPos(pos)
    end

    function ENT:Draw()
        -- self:DrawModel()

        local entitytype = self:GetSpawnEntityType()
        local pos = self:GetPos() + TextPositionOffset
        local ang = self:GetAngles()

        ang:RotateAroundAxis(ang:Up(), 90)
        ang:RotateAroundAxis(ang:Forward(), 90)

        cam.Start3D2D(pos, ang, 0.15)
            self:DrawText(entitytype)
        cam.End3D2D()

        ang:RotateAroundAxis(ang:Up(), 180)
        ang:RotateAroundAxis(ang:Forward(), 180)

        cam.Start3D2D(pos, ang, 0.15)
            self:DrawText(entitytype)
        cam.End3D2D()

        if entitytype == 1 then return end

        -- Draw a box around the trigger
        cam.Start3D()
            render.SetColorMaterial()
            render.DrawWireframeBox(self:GetPos(), self:GetAngles(), -self.BoundRadius, self.BoundRadius, not self:GetIsCooldown() and SpawnEntityTypeColor[entitytype] or self.InactiveColor, true)
        cam.End3D()
    end
end
--addons/darkrpbankrobbery2/lua/entities/new_bank_vault/shared.lua:
return gluapack()()
--addons/mayor_voting/lua/entities/npc_mayorvoting/shared.lua:
return gluapack()()
--addons/pcasino/lua/entities/pcasino_blackjack_table/cl_init.lua:
include("shared.lua")


local preset = {
	{p = 0.7, a = -30, o = 0.9},
	{p = 0.1, a = -16, o = 1.8},
	{p = 0, a = 16, o = 3},
	{p = 0.3, a = 35, o = 4.1},
}
function ENT:Initialize()
	-- Rebuild the panels table client side, without needing to do any extra networking.
	self.panels = {}
	for k, v in ipairs(self:GetChildren()) do
		if v:GetClass() == "pcasino_blackjack_panel" then
			table.insert(self.panels, v)
		end
	end
	-- Flip the table
	self.panels = table.Reverse(self.panels)
	for k, v in pairs(self.panels) do
		v.order = k
	end

	self.currentBid = 0
	self.active = false
	self.currentBets = {}
	self.currentCards = {}
	self.curHands = {}

	self.hasInitialized = true
end

function ENT:PostData()
	if not self.hasInitialized then
		self:Initialize()
	end
	
	self.currentBid = self.data.bet.default
end
function ENT:OnRemove()
	self:ClearBets()
end

local surface_setdrawcolor = surface.SetDrawColor
local surface_drawrect = surface.DrawRect
local draw_simpletext = draw.SimpleText
local black = Color(0, 0, 0, 200)
local white = Color(255, 255, 255, 100)
function ENT:DrawTranslucent()
	if self:GetPos():DistToSqr(LocalPlayer():GetPos()) > 25000 then return end

	-- We can piggyback off the distance check to only request the entities data when it's needed :D
	if (not self.data) and (not PerfectCasino.Cooldown.Check(self:EntIndex(), 5)) then
		PerfectCasino.Core.RequestConfigData(self)
		return
	end

	if not self.data then return end

	if not (self:GetStartRoundIn() == -1) then
		local pos = self:GetPos()
		local ang = self:GetAngles()
		ang:RotateAroundAxis(ang:Forward(), 90)
		ang:RotateAroundAxis(ang:Right(), -90)
		cam.Start3D2D(pos + (ang:Up()*-22) + (ang:Right()*-19.7) + (ang:Forward()*-4.5), ang, 0.05)
			
			-- Previous bet step
			surface_setdrawcolor(black)
			surface_drawrect(5, 5, 190, 65)
			-- Border
			surface_setdrawcolor(white)
			surface_drawrect(0, 0, 200, 5)
			surface_drawrect(0, 5, 5, 65)
			surface_drawrect(195, 5, 5, 65)
			surface_drawrect(0, 70, 200, 5)

			local text = string.format(PerfectCasino.Translation.UI.Start, self.data.general.betPeriod - (os.time() - self:GetStartRoundIn())) 
			draw_simpletext(text, "pCasino.Entity.Bid", 100, 37, color_white, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)

		cam.End3D2D()
	end

	if not self.currentCards or not self.currentCards[0] then return end

	for k, v in pairs(self.currentCards) do
		for i, h in pairs(v) do
			local masterCard = h[1]

			local ang = masterCard:GetAngles()
			ang:RotateAroundAxis(ang:Right(), -90)
			ang:RotateAroundAxis(ang:Up(), 90)

			local pos = masterCard:GetPos() + (ang:Forward()*-2.4) + (ang:Right()*1.2)
			
			cam.Start3D2D(pos, ang, 0.04)
				-- Main Box
				surface_setdrawcolor(black)
				surface_drawrect(-20, -20, 40, 40)
				-- Border
				surface_setdrawcolor(white)
				surface_drawrect(-20, -20, 2, 38)-- Left border
				surface_drawrect(-18, -20, 38, 2)-- Top border
				surface_drawrect(18, -18, 2, 38) -- Right border
				surface_drawrect(-20, 18, 38, 2)

				draw_simpletext(PerfectCasino.Cards:GetHandValue(self.curHands[k][i]), "pCasino.Header.Static", -1, 0, color_white, TEXT_ALIGN_CENTER, TEXT_ALIGN_CENTER)
			cam.End3D2D()
		end 
	end
end

-- Chip code
function ENT:AddBet(pad, amount)
	self.currentBets[pad] = self.currentBets[pad] or {}

	local chips = PerfectCasino.Chips:GetFromNumber(amount)

	local ang = self:GetAngles()
	for k=#PerfectCasino.Chips.Types, 0, -1 do -- Run it in reverse, putting the highest chips at the bottom
		if not chips[k] then continue end
		for i=1, chips[k] do
			local plaque = k >= 11 -- There are 11 normal skins, so anything over 10 (11-1, due to skins starting at 0) we use the big plaque models

			local chip = ClientsideModel(plaque and "models/freeman/owain_casino_plaque.mdl" or "models/freeman/owain_casino_chip.mdl")
			table.insert(self.currentBets[pad], chip)
			chip:SetParent(self)
			chip:SetSkin(plaque and k-11 or k)
			chip:SetPos(self:GetPos() + ((self:GetUp()*15.8) + (self:GetUp() * (#self.currentBets[pad]*0.3))) + ((self:GetForward()*8) + ((self:GetForward()*-10) * preset[pad].p)) + ((self:GetRight() * -13) * (pad - 2.5)))
			chip:SetAngles(ang)
		end
	end
end
function ENT:ClearBets()
	for _, pad in pairs(self.currentBets) do
		for k, v in pairs(pad) do
			if not IsValid(v) then continue end
			v:Remove()
		end
	end

	self.currentBets = {}
end

-- Card code
function ENT:AddCard(pad, hand, face)
	self.currentCards[pad] = self.currentCards[pad] or {}
	self.currentCards[pad][hand] = self.currentCards[pad][hand] or {}

	local ang = self:GetAngles()
	ang:RotateAroundAxis(ang:Right(), 90)
	--ang:RotateAroundAxis(ang:Up(), 90)
	ang:RotateAroundAxis(ang:Forward(), preset[pad] and preset[pad].a or 0)

	
	local card = ClientsideModel("models/freeman/owain_playingcards.mdl")
	table.insert(self.currentCards[pad][hand], card)
	card:SetParent(self)

	if face then 
		local skin, bodygroup = PerfectCasino.Cards:GetFaceData(face)
		card:SetBodygroup(1, bodygroup)
		card:SetSkin(skin)
		card:SetAngles(ang)
	else
		ang:RotateAroundAxis(ang:Right(), 180)
		ang:RotateAroundAxis(ang:Forward(), 180)
		card:SetAngles(ang)
	end
		

	if pad == 0 then -- Dealers hand
		card:SetPos(self:GetPos() + (self:GetUp()*15.8) + (self:GetForward()*-7) + (self:GetRight()*10) + ((self:GetRight()*-3) * #self.currentCards[pad][hand]))
	else -- Players hand
		-- If there is no existing card, set the basis for the positions of them
		if #self.currentCards[pad][hand] == 1 then
			-- Then positioning for the cards is rather complex to understand on 1 line, so I've decided to comment it out to save myself the pain
			card:SetPos(self:GetPos() -- The table's position
				+ (self:GetUp()*15.8) -- Take it to the hight of the table playing area
				+ (self:GetForward()*2) -- Bring it closer to the edge of the mat
				+ ((self:GetForward()*-9) * (preset[pad].p + ((#self.currentCards[pad][hand]-1)*0.1))) -- Shift the cards up or down the X axist to align with the pads better
				+ ((self:GetRight()*-10) * ((preset[pad].o - 2.7))) -- Move the cards across the Y axis so they are next to their pads
			)
	
		-- Move the cards to the right based on what hand it is. This is done after the first move as we need it's new position to calculate the movement
			card:SetPos(card:GetPos() -- It's current position
				+ ((-card:GetRight()*4) * (hand-1))
			)
		else -- Otherwise we can juse the existing card to position the rest of them
			local baseCard = self.currentCards[pad][hand][#self.currentCards[pad][hand] - 1]
	
			card:SetPos(baseCard:GetPos() -- The base card's position
				+ (self:GetUp()*(#self.currentCards[pad][hand]*0.02))  -- Make each card in that hand higher than the last, so they don't overlap and give glitchy artifacts
				+ (-baseCard:GetRight() * 0.6) -- Shift the card slightly to the right
				+ (baseCard:GetUp() * 0.5) -- Move the card slightly up
			)
		end
	end
end

function ENT:ClearCards()
	for _, pad in pairs(self.currentCards) do
		for k, h in ipairs(pad) do
			for _, c in ipairs(h) do
				if not IsValid(c) then continue end
				c:Remove()
			end
		end
	end

	self.currentCards = {}
end

function ENT:OnRemove()
	self:ClearBets()
	self:ClearCards()
end

net.Receive("pCasino:Blackjack:Bet:Change", function()
	local entity = net.ReadEntity()
	if not IsValid(entity) then return end
	if not entity.data then return end

	local newBet = net.ReadUInt(32)
	entity.currentBid = newBet
end)

net.Receive("pCasino:Blackjack:Bet:Place", function()
	local entity = net.ReadEntity()
	if not IsValid(entity) then return end
	if not entity.data then return end
	if entity:GetPos():DistToSqr(LocalPlayer():GetPos()) > 100000 then return end

	local pad = net.ReadUInt(3)
	local betAmount = net.ReadUInt(32)

	entity:AddBet(pad, betAmount)
end)
net.Receive("pCasino:Blackjack:Clear", function()
	local entity = net.ReadEntity()
	if not IsValid(entity) then return end

	entity:ClearBets()
	entity:ClearCards()

	entity.curHands = {}
end)

net.Receive("pCasino:Blackjack:StartingCards", function()
	local entity = net.ReadEntity()
	if not IsValid(entity) then return end
	if not entity.data then return end
	if entity:GetPos():DistToSqr(LocalPlayer():GetPos()) > 100000 then return end

	local hands = net.ReadTable()
	local dealersHand = net.ReadTable()

	for i, p in pairs(hands) do
		entity.curHands[i] = {} -- Build the pad

		for ih, h in ipairs(p) do
			entity.curHands[i][ih] = {} -- Build the hand

			for _, c in ipairs(h.cards) do
				table.insert(entity.curHands[i][ih], c) -- Add the card to the hand

				entity:AddCard(i, ih, c) -- Add a visual card to the table
			end
		end
	end

	entity.curHands[0] = {}
	entity.curHands[0][1] = {}
	for k, c in pairs(dealersHand) do
		entity:AddCard(0, 1, c)
		table.insert(entity.curHands[0][1], c)
	end
	entity:AddCard(0, 1) -- The dealer's blind card
end)
net.Receive("pCasino:Blackjack:NewCard", function()
	local entity = net.ReadEntity()
	if not IsValid(entity) then return end
	if not entity.data then return end
	if entity:GetPos():DistToSqr(LocalPlayer():GetPos()) > 100000 then return end

	local pad = net.ReadUInt(3)
	local hand = net.ReadUInt(3)
	local card = net.ReadString()

	if (not entity.curHands) or (not entity.curHands[pad]) or (not entity.curHands[pad][hand]) then return end

	table.insert(entity.curHands[pad][hand], card) -- Add the card to the hand
	entity:AddCard(pad, hand, card) -- Add a visual card to the table
end)
net.Receive("pCasino:Blackjack:Split", function()
	local entity = net.ReadEntity()
	if not IsValid(entity) then return end
	if not entity.data then return end
	if entity:GetPos():DistToSqr(LocalPlayer():GetPos()) > 100000 then return end

	local pad = net.ReadUInt(3)
	local hands = net.ReadTable()

	-- Clear the existing cards to rebuild them
	for k, v in pairs(entity.currentCards[pad]) do
		for n, m in pairs(v) do
			m:Remove()
		end
	end

	-- Reset then sub tables
	entity.curHands[pad] = {}

	entity.currentCards[pad] = {}

	for i, h in ipairs(hands) do
		entity.curHands[pad][i] = {}
		for _, c in ipairs(h.cards) do
			table.insert(entity.curHands[pad][i], c) -- Add the card to the hand

			entity:AddCard(pad, i, c)
		end
	end
end)
net.Receive("pCasino:Blackjack:DealerCards", function()
	local entity = net.ReadEntity()
	if not IsValid(entity) then return end
	if not entity.data then return end
	if entity:GetPos():DistToSqr(LocalPlayer():GetPos()) > 100000 then return end

	local dealersCards = net.ReadTable()

	-- Remove the blind card
	if (not entity.currentCards) or (not entity.currentCards[0]) or (not entity.currentCards[0][1]) or (not entity.currentCards[0][1][2]) then return end

	entity.currentCards[0][1][2]:Remove()
	entity.currentCards[0][1][2] = nil
	for i, c in ipairs(dealersCards) do
		if i == 1 then continue end -- We already have the first card placed
		timer.Simple(i-2, function()
			entity:AddCard(0, 1, c)
			table.insert(entity.curHands[0][1], c) -- Add the card to the hand
		end)
	end
end)
--addons/pcasino/lua/entities/pcasino_sign_plaque/cl_init.lua:
include("shared.lua")

function ENT:Initialize()
	self.letters = {}

	self.hasInitialized = true
end

function ENT:PostData()
	if not self.hasInitialized then
		self:Initialize()
	end
	
	local letterMap = PerfectCasino.Core.Letter

	-- Letter calculations
	local startPoint = self:GetRight() * 25
	local curLength = vector_origin
	local right = self:GetRight()

	for k, v in ipairs(string.Split(string.lower(self.data.general.text), "")) do
		if not letterMap[v] then -- It's either a space or a character we don't support
			curLength = curLength + (self:GetRight() * 5)
			continue
		end

		-- Create the letter
		local letter = ClientsideModel("models/freeman/owain_casino_alphabet.mdl")
		table.insert(self.letters, letter)
		letter:SetParent(self)
		curLength = curLength + ((self:GetRight()) * (letterMap[v].w*2))
		letter:SetPos(self:GetPos() + startPoint - curLength + ((self:GetRight()) * (letterMap[v].w)))
		letter:SetAngles(self:GetAngles())
		letter:SetBodygroup(1, letterMap[v].b)
	end
end

function ENT:OnRemove()
	-- Clear the board of last rounds best
	for k, v in pairs(self.letters) do
		if not IsValid(v) then continue end

		v:Remove()
	end
end

function ENT:Draw()
	self:DrawModel()
	if self:GetPos():DistToSqr(LocalPlayer():GetPos()) > 1000000 then return end

	-- We can piggyback off the distance check to only request the entities data when it's needed :D
	if (not self.data) and (not PerfectCasino.Cooldown.Check(self:EntIndex(), 5)) then
		PerfectCasino.Core.RequestConfigData(self)
		return
	end
end
--addons/skeypad_1.2.36/lua/entities/s_deployable_cracker/cl_init.lua:
return gluapack()()
--addons/skeypad_1.2.36/lua/entities/s_keypad/cl_init.lua:
return gluapack()()
--lua/entities/sammyservers_textscreen/cl_init.lua:
include("shared.lua")

local render_convar_range = CreateClientConVar("ss_render_range", 1500, true, false, "Determines the render range for Textscreens. Default 1500")
local render_rainbow = CreateClientConVar("ss_render_rainbow", 1, true, false, "Determines if rainbow screens are rendered. If disabled (0), will render as solid white. Default enabled (1)", 0, 1)
local render_range = render_convar_range:GetInt() * render_convar_range:GetInt() --We multiply this is that we can use DistToSqr instead of Distance so we don't need to workout the square root all the time
local rainbow_enabled = cvars.Number("ss_enable_rainbow", 1)
local textscreenFonts = textscreenFonts
local screenInfo = {}
local shouldDrawBoth = false

-- Numbers used in conjunction with text width to work out the render bounds
local widthBoundsDivider = 7.9
local heightBoundsDivider = 12.4

-- ENUM type things for faster table indexing
local FONT = 1
local TEXT = 2
local POSX = 3
local POSY = 4
local COL = 5
local LEN = 6
local SIZE = 7
local CAMSIZE = 8
local RAINBOW = 9

-- Make ply:ShouldDrawLocalPlayer() never get called more than once a frame
hook.Add("Think", "ss_should_draw_both_sides", function()
	shouldDrawBoth = LocalPlayer():ShouldDrawLocalPlayer()
end)

local function ValidFont(f)
	if textscreenFonts[f] ~= nil then
		return textscreenFonts[f]
	elseif table.HasValue(textscreenFonts, f) then
		return f
	else
		return false
	end
end

cvars.AddChangeCallback("ss_render_range", function(convar_name, value_old, value_new)
	render_range = tonumber(value_new) * tonumber(value_new)
end, "3D2DScreens")

cvars.AddChangeCallback("ss_render_rainbow", function(convar_name, value_old, value_new)
	render_rainbow = tonumber(value_new)
end, "3D2DScreens")

-- TODO: https://github.com/Facepunch/garrysmod-issues/issues/3740
-- cvars.AddChangeCallback("ss_enable_rainbow", function(convar_name, value_old, value_new)
-- 	print('ss_enable_rainbow changed: '.. value_new)
-- 	rainbow_enabled = tonumber(value_new)
-- end, "3D2DScreens")

function ENT:Initialize()
	self:SetMaterial("models/effects/vol_light001")
	self:SetRenderMode(RENDERMODE_NONE)
	net.Start("textscreens_download")
	net.WriteEntity(self)
	net.SendToServer()
end

local product
local function IsInFront(entPos, plyShootPos, direction)
	product = (entPos.x - plyShootPos.x) * direction.x +
		(entPos.y - plyShootPos.y) * direction.y +
		(entPos.z - plyShootPos.z) * direction.z
	return product < 0
end


-- Draws the 3D2D text with the given positions, angles and data(text/font/col)
local function Draw3D2D(ang, pos, camangle, data)

	for i = 1, data[LEN] do
		if not data[i] or not data[i][TEXT] then continue end

		cam.Start3D2D(pos, camangle, data[i][CAMSIZE] )
			render.PushFilterMin(TEXFILTER.ANISOTROPIC)
			-- Font
			surface.SetFont(data[i][FONT])
			-- Position
			surface.SetTextPos(data[i][POSX], data[i][POSY])
			-- Rainbow
			if data[i][RAINBOW] ~= nil and data[i][RAINBOW] ~= 0 then
				local j = 0
				for _, code in utf8.codes(data[i][TEXT]) do
					j = j + 1
					--Color
					if rainbow_enabled == 1 and render_rainbow ~= 0 then
						surface.SetTextColor(HSVToColor((CurTime() * 60 + (j * 5)) % 360, 1, 1))
					else
						-- Render as solid white if ss_render_rainbow is disabled or server disabled via ss_enable_rainbow
						surface.SetTextColor(255, 255, 255)
					end
					--Text
					surface.DrawText(utf8.char(code))
				end
			else
				--Color
				surface.SetTextColor(data[i][COL])
				--Text
				surface.DrawText(data[i][TEXT])
			end

			render.PopFilterMin()
		cam.End3D2D()
	end

end

local plyShootPos, ang, pos, camangle, showFront, data -- Less variables being created each frame
function ENT:DrawTranslucent()
	-- Cache the shoot pos for this frame
	plyShootPos = LocalPlayer():GetShootPos()

	if screenInfo[self] ~= nil and self:GetPos():DistToSqr(plyShootPos) < render_range then
		ang = self:GetAngles()
		pos = self:GetPos() + ang:Up()
		camangle = Angle(ang.p, ang.y, ang.r)
		data = screenInfo[self]

		-- Should we draw both screens? (Third person/calview drawing fix)
		if shouldDrawBoth then
			Draw3D2D(ang, pos, camangle, data)
			camangle:RotateAroundAxis(camangle:Right(), 180)
			Draw3D2D(ang, pos, camangle, data)
		else
			-- Is the front of the screen facing us or the back?
			showFront = IsInFront(pos, plyShootPos, ang:Up())

			-- Draw the front of the screen
			if showFront then
				Draw3D2D(ang, pos, camangle, data)
			else
			-- Draw the back of the screen
				camangle:RotateAroundAxis(camangle:Right(), 180)
				Draw3D2D(ang, pos, camangle, data)
			end
		end
	end
end

local function AddDrawingInfo(ent, rawData)
	local drawData = {}
	local textSize = {}

	local totalHeight = 0
	local maxWidth = 0
	local currentHeight = 0

	for i = 1, #rawData do
		-- Setup tables
		if not rawData[i] or not rawData[i].text then continue end
		drawData[i] = {}
		textSize[i] = {}
		-- Text
		drawData[i][TEXT] = rawData[i].text
		-- Font
		drawData[i][FONT] = (ValidFont(rawData[i].font) or textscreenFonts[1])
		-- Text size
		surface.SetFont(drawData[i][FONT])
		textSize[i][1], textSize[i][2] = surface.GetTextSize(drawData[i][TEXT])
		textSize[i][2] = rawData[i].size
		-- Workout max width for render bounds
		maxWidth = maxWidth > textSize[i][1] and maxWidth or textSize[i][1]
		-- Position
		totalHeight = totalHeight + textSize[i][2]
		-- Colour
		drawData[i][COL] = Color(rawData[i].color.r, rawData[i].color.g, rawData[i].color.b, 255)
		-- Size
		drawData[i][SIZE] = rawData[i]["size"]
		-- Remove text if text is empty so we don't waste performance
		if string.len(drawData[i][TEXT]) == 0 or string.len(string.Replace( drawData[i][TEXT], " ", "" )) == 0 then drawData[i][TEXT] = nil end
		--Rainbow
		drawData[i][RAINBOW] = rawData[i]["rainbow"] or 0
	end

	-- Sort out heights
	for i = 1, #rawData do
		if not rawData[i] then continue end
		-- The x position at which to draw the text relative to the text screen entity
		drawData[i][POSX] = math.ceil(-textSize[i][1] / 2)
		-- The y position at which to draw the text relative to the text screen entity
		drawData[i][POSY] = math.ceil(-(totalHeight / 2) + currentHeight)
		-- Calculate the cam.Start3D2D size based on the size of the font
		drawData[i][CAMSIZE] = (0.25 * drawData[i][SIZE]) / 100
		-- Use the CAMSIZE to "scale" the POSY
		drawData[i][POSY] = (0.25 / drawData[i][CAMSIZE] * drawData[i][POSY])
		-- Highest line to lowest, so that everything is central
		currentHeight = currentHeight + textSize[i][2]
	end

	-- Cache the number of lines/length
	drawData[LEN] = #drawData
	-- Add the new data to our text screen list
	screenInfo[ent] = drawData

	-- Calculate the render bounds
	local x = maxWidth / widthBoundsDivider
	local y = currentHeight / heightBoundsDivider + 13 -- Text is above the centre

	-- Setup the render bounds
	ent:SetRenderBounds(Vector(-x, -y, -1.75), Vector(x, y, 1.75))
end

net.Receive("textscreens_update", function(len)
	local ent = net.ReadEntity()

	if IsValid(ent) and ent:GetClass() == "sammyservers_textscreen" then

		local t = net.ReadTable()

		ent.lines = t -- Incase an addon or something wants to read the information.

		AddDrawingInfo(ent, t)
	end
end)

-- Auto refresh
if IsValid(LocalPlayer()) then
	local screens = ents.FindByClass("sammyservers_textscreen")
	for k, v in ipairs(screens) do
		if screenInfo[v] == nil and v.lines ~= nil then
			AddDrawingInfo(v, v.lines)
		end
	end
end

--lua/entities/sent_goalpost.lua:
AddCSLuaFile()

--this is not done yet

ENT.Type = "anim"
ENT.Base = "base_anim"
ENT.PrintName = "Goal post"
ENT.Category = "Fun + Games"
ENT.Author = "Jvs"
ENT.Spawnable = false
ENT.AdminOnly = false

function ENT:SpawnFunction( ply , tr , classname )
	if not tr.Hit then
		return
	end

	local spawnpos = tr.HitPos + tr.HitNormal * 25

	local ent = ents.Create( classname )
	ent:SetPos( spawnpos )
	ent:Spawn()
	return ent
end

function ENT:SetupDataTables()

end

function ENT:Initialize()
	
	
	self.CurrentMesh = {}
end

function ENT:UpdateMesh( vecmin , vecmax )

end

--defined shared so that when we make it static, people won't glitch around it and shit
function ENT:CreatePhysicsFromCurrentMesh()

end



if SERVER then

else
	function ENT:CreateIMeshFromCurrentMesh()

	end
	
	function ENT:DrawGoalPost( flags )
	
	end

	function ENT:DrawNet( flags )
	
	end


	function ENT:Draw( flags )
		self:DrawGoalPost( flags )
	end
	
	function ENT:DrawTranslucent( flags )
		self:DrawNet( flags )
	end
end
--lua/entities/sent_soccerball.lua:
return gluapack()()
--lua/entities/sent_streamradio/shared.lua:
return gluapack()()
--gamemodes/darkrp/entities/entities/spawned_shipment/cl_init.lua:
return gluapack()()
--gamemodes/darkrp/entities/entities/spawned_shipment/cl_init.lua:
include("shared.lua")

local matBallGlow = Material("models/props_combine/tpballglow")
function ENT:Draw()
    self.height = self.height or 0
    self.colr = self.colr or 1
    self.colg = self.colg or 0
    self.StartTime = self.StartTime or CurTime()

    if GAMEMODE.Config.shipmentspawntime > 0 and self.height < self:OBBMaxs().z then
        self:drawSpawning()
    else
        self:DrawModel()
    end

    self:drawFloatingGun()
    self:drawInfo()
end

net.Receive("DarkRP_shipmentSpawn", function()
    local ent = net.ReadEntity()
    if not IsValid(ent) or not ent.IsSpawnedShipment then return end

    ent.height = 0
    ent.StartTime = CurTime()
end)

function ENT:drawSpawning()
    render.MaterialOverride(matBallGlow)

    render.SetColorModulation(self.colr, self.colg, 0)

    self:DrawModel()

    render.MaterialOverride()
    self.colr = 1 - ((CurTime() - self.StartTime) / GAMEMODE.Config.shipmentspawntime)
    self.colg = (CurTime() - self.StartTime) / GAMEMODE.Config.shipmentspawntime

    render.SetColorModulation(1, 1, 1)

    render.MaterialOverride()

    local normal = - self:GetAngles():Up()
    local pos = self:LocalToWorld(Vector(0, 0, self:OBBMins().z + self.height))
    local distance = normal:Dot(pos)
    self.height = self:OBBMaxs().z * ((CurTime() - self.StartTime) / GAMEMODE.Config.shipmentspawntime)
    render.EnableClipping(true)
    render.PushCustomClipPlane(normal, distance)

    self:DrawModel()

    render.PopCustomClipPlane()
end

function ENT:drawFloatingGun()
    local contents = CustomShipments[self:Getcontents() or ""]
    if not contents or not IsValid(self:GetgunModel()) then return end
    self:GetgunModel():SetNoDraw(true)

    local pos = self:GetPos()
    local ang = self:GetAngles()

    -- Position the gun
    local gunPos = self:GetAngles():Up() * 40 + ang:Up() * (math.sin(CurTime() * 3) * 8)
    self:GetgunModel():SetPos(pos + gunPos)


    -- Make it dance
    ang:RotateAroundAxis(ang:Up(), (CurTime() * 180) % 360)
    self:GetgunModel():SetAngles(ang)

    -- Draw the model
    if self:Getgunspawn() < CurTime() - 2 then
        self:GetgunModel():DrawModel()
        return
    elseif self:Getgunspawn() < CurTime() then -- Not when a gun just spawned
        return
    end

    -- Draw the spawning effect
    local delta = self:Getgunspawn() - CurTime()
    local min, max = self:GetgunModel():OBBMins(), self:GetgunModel():OBBMaxs()
    min, max = self:GetgunModel():LocalToWorld(min), self:GetgunModel():LocalToWorld(max)

    -- Draw the ghosted weapon
    render.MaterialOverride(matBallGlow)
    render.SetColorModulation(1 - delta, delta, 0) -- From red to green
    self:GetgunModel():DrawModel()
    render.MaterialOverride()
    render.SetColorModulation(1, 1, 1)

    -- Draw the cut-off weapon
    render.EnableClipping(true)
    -- The clipping plane only draws objects that face the plane
    local normal = -self:GetgunModel():GetAngles():Forward()
    local cutPosition = LerpVector(delta, max, min) -- Where it cuts
    local cutDistance = normal:Dot(cutPosition) -- Project the vector onto the normal to get the shortest distance between the plane and origin

    -- Activate the plane
    render.PushCustomClipPlane(normal, cutDistance);
    -- Draw the partial model
    self:GetgunModel():DrawModel()
    -- Remove the plane
    render.PopCustomClipPlane()

    render.EnableClipping(false)
end

local color_red = Color(140, 0, 0, 100)
local color_white = color_white

function ENT:drawInfo()
    local Pos = self:GetPos()
    local Ang = self:GetAngles()

    local content = self:Getcontents() or ""
    local contents = CustomShipments[content]
    if not contents then return end
    contents = contents.name

    surface.SetFont("HUDNumber5")
    local text = DarkRP.getPhrase("contents")
    local TextWidth = surface.GetTextSize(text)
    local TextWidth2 = surface.GetTextSize(contents)

    cam.Start3D2D(Pos + Ang:Up() * 25, Ang, 0.2)
        draw.WordBox(2, -TextWidth * 0.5 + 5, -30, text, "HUDNumber5", color_red, color_white)
        draw.WordBox(2, -TextWidth2 * 0.5 + 5, 18, contents, "HUDNumber5", color_red, color_white)
    cam.End3D2D()

    Ang:RotateAroundAxis(Ang:Forward(), 90)

    text = DarkRP.getPhrase("amount")
    TextWidth = surface.GetTextSize(text)
    TextWidth2 = surface.GetTextSize(self:Getcount())

    cam.Start3D2D(Pos + Ang:Up() * 17, Ang, 0.14)
        draw.WordBox(2, -TextWidth * 0.5 + 5, -150, text, "HUDNumber5", color_red, color_white)
        draw.WordBox(2, -TextWidth2 * 0.5 + 0, -102, self:Getcount(), "HUDNumber5", color_red, color_white)
    cam.End3D2D()
end

--[[---------------------------------------------------------------------------
Create a shipment from a spawned_weapon
---------------------------------------------------------------------------]]
properties.Add("splitShipment",
{
    MenuLabel   =   DarkRP.getPhrase("splitshipment"),
    Order       =   2004,
    MenuIcon    =   "icon16/arrow_divide.png",

    Filter      =   function(self, ent, ply)
                        if not IsValid(ent) then return false end
                        return ent.IsSpawnedShipment
                    end,

    Action      =   function(self, ent)
                        if not IsValid(ent) then return end
                        RunConsoleCommand("darkrp", "splitshipment", ent:EntIndex())
                    end
})

--lua/entities/sv_gasolinepistol/shared.lua:
return gluapack()()
--lua/entities/sv_repair/cl_init.lua:
include("shared.lua")

function ENT:Draw()
    self:DrawModel()
end
--lua/entities/used_tuborg.lua:
return gluapack()()
--addons/zerosfruitslicer/lua/entities/zfs_mixer.lua:
AddCSLuaFile()
DEFINE_BASECLASS("zfs_anim")
ENT.Spawnable = false
ENT.Base = "zfs_anim"
ENT.Type = "anim"
ENT.RenderGroup = RENDERGROUP_TRANSLUCENT
ENT.PrintName = "Mixer"
ENT.Category = "Zeros FruitSlicer"
ENT.Model = "models/zerochain/fruitslicerjob/fs_mixer.mdl"

if CLIENT then return end

function ENT:Use(activator, caller)
    local shop = self:GetParent()

    if not IsValid(shop) then return end

    if shop:GetClass() ~= "zfs_shop" then return end

    // If the shop is not a public entity and the player dont owns it then stop
    if shop:GetPublicEntity() == false and not zclib.Player.IsOwner(activator, shop) then
        zclib.Notify(ply, zfs.language.Shop.NotOwner, 1)
        return
    end

    if (shop:GetIsBusy()) then return end

    if (shop:GetCurrentState() == 11) then
        zfs.Shop.StartMixer(shop)
    end
end

--addons/zerosfruitslicer/lua/entities/zfs_shop/shared.lua:
ENT.Type = "anim"
ENT.Base = "base_anim"
ENT.AutomaticFrameAdvance = true
ENT.Spawnable = true
ENT.RenderGroup = RENDERGROUP_OPAQUE
ENT.PrintName = "Smoothie Stand"
ENT.Author = "ClemensProduction aka Zerochain"
ENT.Information = "info"
ENT.Category = "Zeros FruitSlicer"

function ENT:CanProperty(ply)
    return ply:IsSuperAdmin()
end

function ENT:CanTool(ply, tab, str)
    return ply:IsSuperAdmin()
end

function ENT:CanDrive(ply)
    return false
end

function ENT:SetupDataTables()
	self:NetworkVar("Int", 0, "CurrentState")
	self:NetworkVar("Int", 1, "SmoothieID")
	self:NetworkVar("Int", 2, "ToppingID")
	self:NetworkVar("Int", 3, "CustomPrice")
	self:NetworkVar("Bool", 0, "IsBusy")
	self:NetworkVar("Bool", 1, "PublicEntity")
	self:NetworkVar("Entity", 1, "OccupiedPlayer")
	self:NetworkVar("Entity", 2, "PushPlayer")

	if SERVER then

		self:SetCurrentState(-1)
		self:SetSmoothieID(0)
		self:SetToppingID(0)
		self:SetCustomPrice(0)
		self:SetIsBusy(false)
		self:SetPublicEntity(false)

		self:SetOccupiedPlayer(NULL)
		self:SetPushPlayer(NULL)
	end
end

--addons/zeros_growop2_v1.6.1/lua/entities/zgo2_backpack_ent/shared.lua:
/*
    Addon id: 64edeaec-8955-454a-aac4-1d19d72ee4af
    Version: v1.6.1 (stable)
*/

ENT.Type                    = "anim"
ENT.Base                    = "base_anim"
ENT.AutomaticFrameAdvance   = false
ENT.PrintName               = "Backpack World Entity"
ENT.Author                  = "ZeroChain"
ENT.Category                = "Zeros GrowOP 2"
ENT.Spawnable               = false
ENT.AdminSpawnable          = false
ENT.Model                   = "models/zerochain/props_growop2/zgo2_backpack.mdl"
ENT.RenderGroup             = RENDERGROUP_OPAQUE

function ENT:CanProperty(ply)
    return ply:IsSuperAdmin()
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 8ffb188c701d3f1856df3a15bfe8e14b5be84a41e03a52af8e86de4fbee82eeb
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 76561198314224586

function ENT:CanTool(ply, tab, str)
    return ply:IsSuperAdmin()
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 70b873f322570e153a05d9cee15c50a5d97bffffec86f684a14bf17014b60342
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 76561198314224586

function ENT:CanDrive(ply)
    return false
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- c360111a1078b749c222565727765c993fb6b426190023d6d23362bac0c7683a

--addons/zeros_growop2_v1.6.1/lua/entities/zgo2_clipper/cl_init.lua:
return gluapack()()
--addons/zeros_growop2_v1.6.1/lua/entities/zgo2_clipper/shared.lua:
/*
    Addon id: 64edeaec-8955-454a-aac4-1d19d72ee4af
    Version: v1.6.1 (stable)
*/

ENT.Type                    = "anim"
ENT.Base                    = "base_anim"
ENT.AutomaticFrameAdvance   = true
ENT.PrintName               = "Clipper"
ENT.Author                  = "ZeroChain"
ENT.Category                = "Zeros GrowOP 2"
ENT.Spawnable               = true
ENT.AdminSpawnable          = false
ENT.Model                   = "models/zerochain/props_growop2/zgo2_weedcruncher.mdl"
ENT.RenderGroup             = RENDERGROUP_OPAQUE

function ENT:SetupDataTables()
	self:NetworkVar("Int", 0, "WeedID")
	self:NetworkVar("Int", 1, "Progress")
	self:NetworkVar("Int", 2, "WeedAmount")
	self:NetworkVar("Int", 3, "StickCount")
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 76561198314224586

	self:NetworkVar("Bool", 1, "Spin")

	self:NetworkVar("Bool", 2, "HasMotor")
	self:NetworkVar("Bool", 3, "MotorSwitch")

	self:NetworkVar("Int", 4, "Power")

	if SERVER then
		self:SetWeedID(0)
		self:SetSpin(false)
		self:SetProgress(0)
		self:SetWeedAmount(0)
		self:SetStickCount(0)
		self:SetHasMotor(false)
		self:SetPower(0)
		self:SetMotorSwitch(false)
	end
end

function ENT:CanProperty(ply)
    return ply:IsSuperAdmin()
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 8ffb188c701d3f1856df3a15bfe8e14b5be84a41e03a52af8e86de4fbee82eeb

function ENT:CanTool(ply, tab, str)
    return ply:IsSuperAdmin()
end

function ENT:CanDrive(ply)
    return false
end

function ENT:GravGunPickupAllowed( ply )
	return false
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 70b873f322570e153a05d9cee15c50a5d97bffffec86f684a14bf17014b60342

function ENT:GravGunPunt( ply )
	return false
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 8ffb188c701d3f1856df3a15bfe8e14b5be84a41e03a52af8e86de4fbee82eeb

local vec02 = Vector(4.2,-15,31.7)
function ENT:OnMotorSwitch(ply)
    local trace = ply:GetEyeTrace()
    if zclib.util.InDistance(self:LocalToWorld(vec02), trace.HitPos, 4) then
        return true
    else
        return false
    end
end

/*
	How much power does this machine need
*/
function ENT:GetPowerNeed()
	return zgo2.config.Clipper.PowerUsage
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 5f074b2717244cb0b28afc4f82cbfebeed301ee81f5a05ae65232daad257b16a

--addons/zeros_growop2_v1.6.1/lua/entities/zgo2_crate/cl_init.lua:
/*
    Addon id: 64edeaec-8955-454a-aac4-1d19d72ee4af
    Version: v1.6.1 (stable)
*/

include("shared.lua")
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 76561198314224586

function ENT:Draw()
	self:DrawModel()

	//for k,v in pairs(zgo2.Crate.Spots) do debugoverlay.Sphere(self:LocalToWorld(v),1,0.05,Color( 0, 255, 0 ),true) end
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 76561198314224586
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- a0e6ade09fe02808a86c0dfaee2704d791bcc0344cd386f9ebfd43c1dd1de59e

function ENT:Initialize()
	zgo2.Crate.Initialize(self)
end

function ENT:OnRemove()
	zgo2.Crate.OnRemove(self)
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 76561198314224586
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 70b873f322570e153a05d9cee15c50a5d97bffffec86f684a14bf17014b60342

function ENT:Think()
    zgo2.Crate.OnThink(self)
end

--addons/zeros_growop2_v1.6.1/lua/entities/zgo2_item_base/cl_init.lua:
return gluapack()()
--addons/zeros_growop2_v1.6.1/lua/entities/zgo2_item_base/cl_init.lua:
/*
    Addon id: 64edeaec-8955-454a-aac4-1d19d72ee4af
    Version: v1.6.1 (stable)
*/

include("shared.lua")
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- a0e6ade09fe02808a86c0dfaee2704d791bcc0344cd386f9ebfd43c1dd1de59e
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 5f074b2717244cb0b28afc4f82cbfebeed301ee81f5a05ae65232daad257b16a
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 76561198314224586

function ENT:Draw()
	self:DrawModel()
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 70b873f322570e153a05d9cee15c50a5d97bffffec86f684a14bf17014b60342
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 76561198314224586

--addons/zeros_growop2_v1.6.1/lua/entities/zgo2_item_base/shared.lua:
/*
    Addon id: 64edeaec-8955-454a-aac4-1d19d72ee4af
    Version: v1.6.1 (stable)
*/

ENT.Type                    = "anim"
ENT.Base                    = "base_anim"
ENT.AutomaticFrameAdvance   = false
ENT.PrintName               = "Item"
ENT.Author                  = "ZeroChain"
ENT.Category                = "Zeros GrowOP 2"
ENT.Spawnable               = false
ENT.AdminSpawnable          = false
ENT.Model                   = "models/zerochain/props_growop2/zgo2_battery.mdl"
ENT.RenderGroup             = RENDERGROUP_OPAQUE

function ENT:CanProperty(ply)
    return ply:IsSuperAdmin()
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 8ffb188c701d3f1856df3a15bfe8e14b5be84a41e03a52af8e86de4fbee82eeb
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 76561198314224586
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- a0e6ade09fe02808a86c0dfaee2704d791bcc0344cd386f9ebfd43c1dd1de59e

function ENT:CanTool(ply, tab, str)
    return ply:IsSuperAdmin()
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 5f074b2717244cb0b28afc4f82cbfebeed301ee81f5a05ae65232daad257b16a

function ENT:CanDrive(ply)
    return false
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 76561198314224586

--addons/zeros_growop2_v1.6.1/lua/entities/zgo2_lamp/cl_init.lua:
/*
    Addon id: 64edeaec-8955-454a-aac4-1d19d72ee4af
    Version: v1.6.1 (stable)
*/

include("shared.lua")

function ENT:Initialize()
	zgo2.Lamp.Initialize(self)
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 76561198314224586
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- c360111a1078b749c222565727765c993fb6b426190023d6d23362bac0c7683a

function ENT:Draw()
	self:DrawModel()
	zgo2.Lamp.OnDraw(self)
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- c360111a1078b749c222565727765c993fb6b426190023d6d23362bac0c7683a

function ENT:Think()
	zgo2.Lamp.OnThink(self)
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 76561198314224586
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 8ffb188c701d3f1856df3a15bfe8e14b5be84a41e03a52af8e86de4fbee82eeb

function ENT:OnRemove()
	zgo2.Lamp.OnRemove(self)
end

--addons/zeros_growop2_v1.6.1/lua/entities/zgo2_mixer/cl_init.lua:
/*
    Addon id: 64edeaec-8955-454a-aac4-1d19d72ee4af
    Version: v1.6.1 (stable)
*/

include("shared.lua")
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 70b873f322570e153a05d9cee15c50a5d97bffffec86f684a14bf17014b60342
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- a0e6ade09fe02808a86c0dfaee2704d791bcc0344cd386f9ebfd43c1dd1de59e

function ENT:Initialize()
	zgo2.Mixer.Initialize(self)
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 76561198314224595
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 5f074b2717244cb0b28afc4f82cbfebeed301ee81f5a05ae65232daad257b16a

function ENT:Draw()
	self:DrawModel()
	zgo2.Mixer.Draw(self)
end

function ENT:Think()
	zgo2.Mixer.Think(self)
	self:SetNextClientThink(CurTime())
	return true
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 70b873f322570e153a05d9cee15c50a5d97bffffec86f684a14bf17014b60342

function ENT:OnRemove()
	zgo2.Mixer.OnRemove(self)
end

--addons/zeros_growop2_v1.6.1/lua/entities/zgo2_motor.lua:
/*
    Addon id: 64edeaec-8955-454a-aac4-1d19d72ee4af
    Version: v1.6.1 (stable)
*/

AddCSLuaFile()
DEFINE_BASECLASS("zgo2_item_base")
ENT.Type                    = "anim"
ENT.Base                    = "zgo2_item_base"
ENT.AutomaticFrameAdvance   = false
ENT.PrintName               = "Motor"
ENT.Author                  = "ZeroChain"
ENT.Category                = "Zeros GrowOP 2"
ENT.Spawnable               = true
ENT.AdminSpawnable          = false
ENT.Model                   = "models/zerochain/props_growop2/zgo2_motor.mdl"
ENT.RenderGroup             = RENDERGROUP_OPAQUE
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 5f074b2717244cb0b28afc4f82cbfebeed301ee81f5a05ae65232daad257b16a

function ENT:CanProperty(ply)
    return ply:IsSuperAdmin()
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 76561198314224586

function ENT:CanTool(ply, tab, str)
    return ply:IsSuperAdmin()
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 70b873f322570e153a05d9cee15c50a5d97bffffec86f684a14bf17014b60342
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- c360111a1078b749c222565727765c993fb6b426190023d6d23362bac0c7683a

function ENT:CanDrive(ply)
    return false
end

if SERVER then
	function ENT:PostInitialize()
		zgo2.Destruction.SetupHealth(self)
	end
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 76561198314224595

--addons/zeros_growop2_v1.6.1/lua/entities/zgo2_plant/shared.lua:
return gluapack()()
--addons/zeros_growop2_v1.6.1/lua/entities/zgo2_weedbranch.lua:
return gluapack()()
--addons/zeros_golddiggger/lua/entities/zgw_bucket/cl_init.lua:


include("shared.lua")

function ENT:DrawTranslucent()
	self:Draw()
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- f6df0a94af3a750a3d331a6881d44d3c6811e6ae1489523704d95e9e8195831d
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 549ca24f37f8589f265ca557954c28b4325c41edf21ed3859b40baf576d8adf4
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- f6df0a94af3a750a3d331a6881d44d3c6811e6ae1489523704d95e9e8195831d

function ENT:Draw()
	self:DrawModel()
	zgw.Bucket.Draw(self)
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 76561198872838622
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 9ac369ca150c22e64f828cd5857ffea33c11645bd3819881a5581360ebf7ce05

--addons/zeros_golddiggger/lua/entities/zgw_bucket/shared.lua:


ENT.Type = "anim"
ENT.Base = "base_anim"
ENT.AutomaticFrameAdvance = true
ENT.Model = "models/zerochain/props_goldwash/zgw_bucket.mdl"
ENT.Spawnable = true
ENT.AdminSpawnable = false
ENT.PrintName = "Bucket"
ENT.Category = "Zeros GoldWasher"
ENT.RenderGroup = RENDERGROUP_OPAQUE

function ENT:SetupDataTables()
    self:NetworkVar("Int", 1, "Dirt")
    self:NetworkVar("Int", 2, "GoldRatio")
    if (SERVER) then
        self:SetDirt(0)
        self:SetGoldRatio(0)
    end
end

--addons/zeros_golddiggger/lua/entities/zgw_goldwasher/shared.lua:


ENT.Type = "anim"
ENT.Base = "base_anim"
ENT.AutomaticFrameAdvance = true
ENT.Model = "models/zerochain/props_goldwash/zgw_goldwasher01.mdl"
ENT.Spawnable = true
ENT.AdminSpawnable = false
ENT.PrintName = "GoldWasher"
ENT.Category = "Zeros GoldWasher"
ENT.RenderGroup = RENDERGROUP_OPAQUE

function ENT:SetupDataTables()

    // Is the water turned on?
    self:NetworkVar("Bool", 1, "HasWater")

    // How much dirt/ mass is inside the machine
    self:NetworkVar("Int", 1, "Dirt")

    // How much of the mass is gold?
    self:NetworkVar("Int",2, "GoldRatio")

    // Do we have the extension upgrade
    self:NetworkVar("Bool", 2, "HasExtension")

    // Defines how much dirt the machine can hold
    self:NetworkVar("Int", 3, "MaxDirt")


    if (SERVER) then
        self:SetHasWater(false)
        self:SetDirt(0)
        self:SetGoldRatio(0)
        self:SetMaxDirt(zgw.config.GoldWasher.MaxDirt)
        self:SetHasExtension(false)
    end
end


local function InField(lp,minLeft,maxLeft,minUp,maxUp,minDepth,maxDepth)
    if lp.x > minLeft and lp.x < maxLeft and lp.z > minUp and lp.z < maxUp and lp.y > minDepth  and lp.y < maxDepth then
        return true
    else
        return false
    end
end

function ENT:OnWaterButton(ply)
    local trace = ply:GetEyeTrace()
    local lp = self:WorldToLocal(trace.HitPos)
    return InField(lp,20,28,16,23,-15,-14)
end

function ENT:OnUpgradeButton(ply)
    local trace = ply:GetEyeTrace()
    local lp = self:WorldToLocal(trace.HitPos)
    return InField(lp,-10,-8,47.5,53,-7,7)
end

--addons/zeros_golddiggger/lua/entities/zgw_mat/cl_init.lua:
return gluapack()()
--addons/zeros_methlab02_v1.4.1/lua/entities/zmlab2_item_autobreaker/shared.lua:
return gluapack()()
--addons/zeros_methlab02_v1.4.1/lua/entities/zmlab2_item_crate/shared.lua:
return gluapack()()
--addons/zeros_methlab02_v1.4.1/lua/entities/zmlab2_item_palette/cl_init.lua:
/*
    Addon id: a36a6eee-6041-4541-9849-360baff995a2
    Version: v1.4.1 (stable)
*/

include("shared.lua")
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 76561198347218024
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 76561198347218024
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- f846397ffcf09571d053f7b7aff0b4ab920f6d7152aebc0550c4aa612acbeab0

function ENT:Initialize()
	zmlab2.Palette.Initialize(self)
end

function ENT:DrawTranslucent()
	self:Draw()
end

function ENT:Draw()
	self:DrawModel()
	zmlab2.Palette.Draw(self)
end

function ENT:OnRemove()
	zmlab2.Palette.OnRemove(self)
end

function ENT:Think()
	zmlab2.Palette.Think(self)
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- ce15eec833bf47ebbcf6161ad127d2657901fd54a4bc9d5aa5fcda90913684bc
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- b59bd1b1f8d16a52cb3d0a12454834a0ad28afe2633004db7a9dc71add4aef45

--addons/zeros_methlab02_v1.4.1/lua/entities/zmlab2_machine_filler/shared.lua:
return gluapack()()
--addons/zeros_methlab02_v1.4.1/lua/entities/zmlab2_machine_filter/shared.lua:
return gluapack()()
--addons/zeros_methlab02_v1.4.1/lua/entities/zmlab2_machine_ventilation/cl_init.lua:
return gluapack()()
--addons/zeros_methlab02_v1.4.1/lua/entities/zmlab2_machine_ventilation/shared.lua:
return gluapack()()
--addons/zeros_methlab02_v1.4.1/lua/entities/zmlab2_npc/shared.lua:
return gluapack()()
--addons/zeros_methlab02_v1.4.1/lua/entities/zmlab2_tent/cl_init.lua:
return gluapack()()
--addons/zeros_methlab_1.6.4/lua/entities/zmlab_collectcrate/cl_init.lua:
return gluapack()()
--addons/zeros_methlab_1.6.4/lua/entities/zmlab_collectcrate/shared.lua:
return gluapack()()
--addons/zeros_methlab_1.6.4/lua/entities/zmlab_frezzingtray/cl_init.lua:
include("shared.lua")

function ENT:Draw()
	self:DrawModel()

	if zmlab.f.InDistance(LocalPlayer():GetPos(), self:GetPos(), 300) and self:GetInBucket() > 0 then
		self:DrawInfo()
	end
end

function ENT:DrawInfo()
	local Pos = self:GetPos() + self:GetUp() * 1
	local Ang = self:GetAngles()
	Ang:RotateAroundAxis(Ang:Forward(), 90)
	Ang:RotateAroundAxis(Ang:Forward(), -90)

	cam.Start3D2D(Pos, Ang, 0.1)
		local text = math.Round(self:GetInBucket()) .. zmlab.config.UoW

		draw.DrawText(text, "zmlab_font4", 0, -50, zmlab.default_colors["white01"], TEXT_ALIGN_CENTER)
	cam.End3D2D()
end

function ENT:DrawTranslucent()
	self:Draw()
end

--addons/zeros_methlab_1.6.4/lua/entities/zmlab_methylamin/cl_init.lua:
return gluapack()()
--addons/zeros_methlab_1.6.4/lua/entities/zmlab_palette/shared.lua:
ENT.Type = "anim"
ENT.Base = "base_entity"
ENT.RenderGroup = RENDERGROUP_BOTH
ENT.Spawnable = true
ENT.AdminSpawnable = false
ENT.PrintName = "Transport Palette"
ENT.Author = "ClemensProduction aka Zerochain"
ENT.Information = "info"
ENT.Category = "Zeros Meth Lab"
ENT.Model = "models/props_junk/wood_pallet001a.mdl"

function ENT:SetupDataTables()
	self:NetworkVar("Float", 0, "MethAmount")
	self:NetworkVar("Int", 0, "CrateCount")

	if (SERVER) then
		self:SetMethAmount(0)
		self:SetCrateCount(0)
	end
end

--addons/zeros_retrominer_v2.3.6/lua/entities/zrms_bar/cl_init.lua:
return gluapack()()
--addons/zeros_retrominer_v2.3.6/lua/entities/zrms_bar_iron.lua:
/*
    Addon id: 
    Version: v2.3.6 (stable)
*/

AddCSLuaFile()
DEFINE_BASECLASS("zrms_bar")
ENT.Type = "anim"
ENT.Base = "zrms_bar"
ENT.RenderGroup = RENDERGROUP_BOTH
ENT.Spawnable = false
ENT.AdminSpawnable = false
ENT.PrintName = "Iron Bar"
ENT.Author = "ClemensProduction aka Zerochain"
ENT.Information = "info"
ENT.Category = "Zeros RetroMiningSystem"
ENT.Model = "models/Zerochain/props_mining/zrms_bar.mdl"
ENT.AutomaticFrameAdvance = true
ENT.DisableDuplicator = false
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

function ENT:SetupDataTables()
	self:NetworkVar("String", 0, "MetalType")
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

	if (SERVER) then
		self:SetMetalType("Iron")
	end
end

--addons/zeros_retrominer_v2.3.6/lua/entities/zrms_gravelcrate/shared.lua:
/*
    Addon id: 
    Version: v2.3.6 (stable)
*/

ENT.Type = "anim"
ENT.Base = "base_anim"
ENT.RenderGroup = RENDERGROUP_BOTH
ENT.Spawnable = true
ENT.AdminSpawnable = false
ENT.PrintName = "Gravel Crate"
ENT.Author = "ClemensProduction aka Zerochain"
ENT.Information = "info"
ENT.Category = "Zeros RetroMiningSystem"
ENT.Model = "models/Zerochain/props_mining/zrms_gravelcrate.mdl"
ENT.AutomaticFrameAdvance = true
ENT.DisableDuplicator = false
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

function ENT:SetupDataTables()
	self:NetworkVar("Float", 2, "Iron")
	self:NetworkVar("Float", 3, "Bronze")
	self:NetworkVar("Float", 4, "Silver")
	self:NetworkVar("Float", 5, "Gold")
	self:NetworkVar("Float", 6, "Coal")
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

	if (SERVER) then
		self:SetIron(0)
		self:SetBronze(0)
		self:SetSilver(0)
		self:SetGold(0)
		self:SetCoal(0)
	end
end

--addons/zeros_retrominer_v2.3.6/lua/entities/zrms_melter/cl_init.lua:
/*
    Addon id: 
    Version: v2.3.6 (stable)
*/

include("shared.lua")

function ENT:Initialize()
	ZRMS_CSM_MELTER[self:EntIndex()] = self

	self.ClientModels = {}

	self.LastResourceAmount = 0
	self.ResrcFill_Height = 0

	self.LastState = -1

	self.LastCoal = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

	self.a_cycle = 0
	self.b_cycle = 0

	self.SoundStage = 0
end

function ENT:Draw()
	self:DrawModel()

	if zrmine.f.InDistance(LocalPlayer():GetPos(), self:GetPos(), 300) then
		self:Draw_MainInfo()
		self:Draw_CoalInfo()
	end

	if zrmine.f.InDistance(LocalPlayer():GetPos(), self:GetPos(), 600) then

		if GetConVar("zrms_cl_dynlight"):GetInt() == 1 then
			self:MelterLight()
		end

		if (IsValid(self) and self:GetCurrentState() == "WAITING_FOR_ORDER") then
			self:StopParticlesNamed("zrms_melter_unload")
			self:StopParticlesNamed("zrms_melter_chimney")
			self:StopParticlesNamed("zrms_melter_head")
			self:StopParticlesNamed("zrms_melter_coalpit")
		end
	end
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

function ENT:DrawTranslucent()
	self:Draw()
end


// UI STUFF
function ENT:Draw_CoalInfo()
	local amount = tostring(math.Round(self:GetCoalAmount(), 2))
	local aBar = (100 / zrmine.config.Melter_Coal_Capacity) * amount

	if (aBar > 100) then
		aBar = 100
	end

	cam.Start3D2D(self:LocalToWorld(Vector(80,0,11)), self:LocalToWorldAngles(Angle(0,90,90)), 0.1)

		draw.RoundedBox(0, -105, -65, 210, 130, zrmine.default_colors["grey02"])
		draw.RoundedBox(0, -92, 50, 30, -aBar, zrmine.default_colors["Coal"])

		surface.SetDrawColor(zrmine.default_colors["Coal"])
		surface.SetMaterial(zrmine.default_materials["Ore"])
		surface.DrawTexturedRect(-50, -75, 100, 100)

		draw.DrawText(math.Round(amount) .. zrmine.config.BuyerNPC_Mass, "zrmine_screen_font2", 0, 10, zrmine.default_colors["white02"], TEXT_ALIGN_CENTER)

		surface.SetDrawColor(zrmine.default_colors["white02"])
		surface.SetMaterial(zrmine.default_materials["Scale"])
		surface.DrawTexturedRect(-115, -53, 75, 105)
	cam.End3D2D()
end

function ENT:Draw_MainInfo()

	local status = ""
	local cState = self:GetCurrentState()

	local amount = math.Round(self:GetResourceAmount())
	local resourceType = self:GetResourceType()
	local paintColor = zrmine.f.GetOreColor(resourceType)

	if (cState == 0) then
		status = zrmine.language.Melter_InsertOre
	elseif (cState == 1 and self:GetCoalAmount() < zrmine.config.Melter_Vars[resourceType].CoalAmount) then
		status = zrmine.language.Melter_NeedCoal
	elseif (cState == 2) then
		status = zrmine.language.Melter_Melting
	end

	local aBar = 0
	if (resourceType ~= "Empty") then
		aBar = (100 / zrmine.config.Melter_Vars[resourceType].OreAmount) * amount
	end

	if (aBar > 100) then
		aBar = 100
	end


	local rtype = zrmine.language.Ore_Empty
	if (amount > 0) then
		rtype = zrmine.f.GetOreTranslation(resourceType)
	end

	cam.Start3D2D(self:LocalToWorld(Vector(0,-35.8,44.5)), self:LocalToWorldAngles(Angle(0,0,90)), 0.1)
		draw.RoundedBox(0, -105, -65, 210, 130, zrmine.default_colors["grey02"])

		draw.DrawText(rtype, "zrmine_screen_font2", 20, -50, zrmine.default_colors["white02"], TEXT_ALIGN_CENTER)
		draw.DrawText(amount .. zrmine.config.BuyerNPC_Mass, "zrmine_screen_font1", 20, -10, zrmine.default_colors["white02"], TEXT_ALIGN_CENTER)
		draw.DrawText(status, "zrmine_screen_font3", 20, 25, zrmine.default_colors["yellow01"], TEXT_ALIGN_CENTER)

		draw.RoundedBox(0, -92, 50, 30, -aBar, paintColor)
		surface.SetDrawColor(zrmine.default_colors["white02"])
		surface.SetMaterial(zrmine.default_materials["Scale"])
		surface.DrawTexturedRect(-115, -53, 75, 105)
	cam.End3D2D()
end

// Sound
function ENT:MelterSound()
	local MeltSound = CreateSound(self, "zrmine_sfx_melter_loop")
	local CoolSound = CreateSound(self, "zrmine_sfx_meltercool_loop")

	if self.SoundStage == 1 then

		// Start Melt Sound
		if self.SoundObj01 == nil then
			self.SoundObj01 = MeltSound
		end

		if self.SoundObj01:IsPlaying() == false then
			self.SoundObj01:Play()
			self.SoundObj01:ChangeVolume(0, 0)
			self.SoundObj01:ChangeVolume(GetConVar("zrms_cl_audiovolume"):GetFloat(), 1)
		end
	elseif self.SoundStage == 2 then

		// STOP Melt Sound
		if self.SoundObj01 == nil then
			self.SoundObj01 = MeltSound
		end

		if self.SoundObj01:IsPlaying() == true then
			self.SoundObj01:ChangeVolume(0, 1)
			if ((self.lastSoundStop or CurTime()) > CurTime()) then return end
			self.lastSoundStop = CurTime() + 5

			timer.Simple(2, function()
				if (IsValid(self)) then
					self.SoundObj01:Stop()
				end
			end)
		end

		// Start Cool Sound
		if self.SoundObj02 == nil then
			self.SoundObj02 = CoolSound
		end

		if self.SoundObj02:IsPlaying() == false then
			self.SoundObj02:Play()
			self.SoundObj02:ChangeVolume(0, 0)
			self.SoundObj02:ChangeVolume(GetConVar("zrms_cl_audiovolume"):GetFloat(), 1)
		end
	elseif self.SoundStage == 3 then

		// STOP Cooling Sound
		if self.SoundObj02 == nil then
			self.SoundObj02 = CoolSound
		end

		if self.SoundObj02:IsPlaying() == true then
			self.SoundObj02:ChangeVolume(0, 1)
			if ((self.lastSoundStop or CurTime()) > CurTime()) then return end
			self.lastSoundStop = CurTime() + 5

			timer.Simple(2, function()
				if (IsValid(self)) then
					self.SoundObj02:Stop()
				end
			end)
		end
	else

		// STOP Melt Sound
		if self.SoundObj01 == nil then
			self.SoundObj01 = MeltSound
		end

		if self.SoundObj01:IsPlaying() == true then
			self.SoundObj01:ChangeVolume(0, 1)
			if ((self.lastSoundStop or CurTime()) > CurTime()) then return end
			self.lastSoundStop = CurTime() + 5

			timer.Simple(2, function()
				if (IsValid(self)) then
					self.SoundObj01:Stop()
				end
			end)
		end

		// STOP Cooling Sound
		if self.SoundObj02 == nil then
			self.SoundObj02 = CoolSound
		end

		if self.SoundObj02:IsPlaying() == true then
			self.SoundObj02:ChangeVolume(0, 1)
			if ((self.lastSoundStop or CurTime()) > CurTime()) then return end
			self.lastSoundStop = CurTime() + 5
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

			timer.Simple(2, function()
				if (IsValid(self)) then
					self.SoundObj02:Stop()
				end
			end)
		end
	end
end

// Light
function ENT:MelterLight()
	if GetConVar("zrms_cl_dynlight"):GetInt() == 1 and (self:GetCurrentState() == 2 or self:GetCurrentState() == 3) then
		local dlight01 = DynamicLight(self:EntIndex())

		if (dlight01) then
			dlight01.pos = self:GetPos() + self:GetUp() * 15
			dlight01.r = 255
			dlight01.g = 75
			dlight01.b = 0
			dlight01.brightness = 1
			dlight01.Decay = 1000
			dlight01.Size = 512
			dlight01.DieTime = CurTime() + 1
		end
	end
end

// Updates the Filling Model Skin
function ENT:UpdateFillingSkin(rType)
	if IsValid(self.ClientModels["Filling"]) then
		if (rType == "Dirt") then
			self.ClientModels["Filling"]:SetSkin(0)
		elseif (rType == "Iron") then
			self.ClientModels["Filling"]:SetSkin(1)
		elseif (rType == "Bronze") then
			self.ClientModels["Filling"]:SetSkin(2)
		elseif (rType == "Silver") then
			self.ClientModels["Filling"]:SetSkin(3)
		elseif (rType == "Gold") then
			self.ClientModels["Filling"]:SetSkin(4)
		end
	end
end


// This updates the height and visibility of the client coal model
function ENT:UpdateCoal()

	local coal = self:GetCoalAmount()

	if self.LastCoal ~= coal then

		if coal > self.LastCoal then
			zrmine.f.EmitSoundENT("zrmine_addgravel",self)

			zrmine.f.ParticleEffect("zrms_melter_coalfill", self:GetPos() + self:GetUp() * 25 + self:GetForward() * 70, self:GetAngles(), self)
		end

		self.CoalFill_Height = (20 / zrmine.config.Melter_Coal_Capacity) * coal
		self.ClientModels["Coal"]:SetNoDraw(false)

		if (self.CoalFill_Height > 20) then
			self.CoalFill_Height = 20
		end

		if (self.CoalFill_Height < 0 or coal <= 0) then
			self.CoalFill_Height = 0
			self.ClientModels["Coal"]:SetNoDraw(true)
		end

		self.ClientModels["Coal"]:SetPos(self:GetPos() + self:GetUp() * -23  + self.ClientModels["Coal"]:GetUp() * self.CoalFill_Height)

		self.LastCoal = coal
	end
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 


function ENT:Think()
	if  zrmine.f.InDistance(self:GetPos(), LocalPlayer():GetPos(), 1000) then
		if self.ClientModels == nil then self.ClientModels = {} end

		if not IsValid(self.ClientModels["BurnChamber"]) then
			self.ClientModels["BurnChamber"] = self:CreateClientSideModel("models/zerochain/props_mining/zrms_melter_burnchamber.mdl")
			self.ClientModels["BurnChamber"]:SetParent(self)
			self.ClientModels["BurnChamber"]:SetNoDraw(true)
		end

		if not IsValid(self.ClientModels["BurnCoal"]) then
			self.ClientModels["BurnCoal"] = self:CreateClientSideModel("models/zerochain/props_mining/zrms_melter_burningcoal.mdl")
			self.ClientModels["BurnCoal"]:SetParent(self)
			self.ClientModels["BurnCoal"]:SetNoDraw(true)
		end

		if IsValid(self.ClientModels["Filling"]) then

			local attach = self:GetAttachment(self:LookupAttachment("body"))
			if attach then
				self.ClientModels["Filling"]:SetPos(attach.Pos - attach.Ang:Up() * (25 - self.ResrcFill_Height))
				self.ClientModels["Filling"]:SetAngles(attach.Ang)
			end

			local rAmount = self:GetResourceAmount()

			if self.LastResourceAmount ~= rAmount then
				self.LastResourceAmount = rAmount

				if rAmount <= 0 then
					self.ClientModels["Filling"]:SetNoDraw(true)
				else

					self.ResrcFill_Height = (25 / zrmine.config.Melter_Vars[self:GetResourceType()].OreAmount) * rAmount

					if (self.ResrcFill_Height > 25) then
						self.ResrcFill_Height = 25
					end

					self.ClientModels["Filling"]:SetNoDraw(false)

					self:UpdateFillingSkin(self:GetResourceType())
				end
			end
		else
			self.ClientModels["Filling"] = self:CreateClientSideModel("models/zerochain/props_mining/zrms_melter_filling.mdl")
			self.ClientModels["Filling"]:SetNoDraw(true)
			self.ClientModels["Filling"]:SetPos(self:GetPos() + self:GetUp() * -2)
			self.ClientModels["Filling"]:SetAngles(self:GetAngles())
			self.ClientModels["Filling"]:SetParent(self, self:LookupAttachment("body"))
		end

		if IsValid(self.ClientModels["Lava"]) then
			self.ClientModels["Lava"]:SetPos(self:GetPos())

			local ang = self:GetAngles()
			ang:RotateAroundAxis(self:GetUp(), -90)
			self.ClientModels["Lava"]:SetAngles(ang)
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 


			if self.ClientModels["Lava"]:GetNoDraw() == false then
				local speed = 1
				self.a_cycle = math.Clamp(self.a_cycle + (1 / speed) * FrameTime(), 0, 1)

				if self.a_cycle >= 1 then
					self.a_cycle = 0
				else

					local sequence = self.ClientModels["Lava"]:LookupSequence("fill")
					self.ClientModels["Lava"]:SetSequence(sequence)
					self.ClientModels["Lava"]:SetPlaybackRate(1)
					self.ClientModels["Lava"]:SetCycle(self.a_cycle)
				end
			end
		else
			self.ClientModels["Lava"] = self:CreateClientSideModel("models/zerochain/props_mining/zrms_melter_lava.mdl")
			self.ClientModels["Lava"]:SetNoDraw(true)
			self.ClientModels["Lava"]:SetParent(self)
		end

		if IsValid(self.ClientModels["MoltenMetal"]) then
			// Handel animation here if normal way dont works

			local attach = self:GetAttachment(self:LookupAttachment("moltenmetal"))
			local ang = attach.Ang
			ang:RotateAroundAxis(attach.Ang:Up(),90)
			self.ClientModels["MoltenMetal"]:SetAngles(ang)
			self.ClientModels["MoltenMetal"]:SetPos(attach.Pos + self:GetForward() * 1.5 + self:GetUp() * -2)

			if self.ClientModels["MoltenMetal"]:GetNoDraw() == false then

				local speed = zrmine.config.Melter_UnloadTime
				self.b_cycle = math.Clamp(self.b_cycle + (1 / speed) * FrameTime(), 0, 1)

				if self.b_cycle >= 1 then
					self.b_cycle = 1
				else

					local sequence = self.ClientModels["MoltenMetal"]:LookupSequence("fill")
					self.ClientModels["MoltenMetal"]:SetSequence(sequence)
					self.ClientModels["MoltenMetal"]:SetPlaybackRate(1)
					self.ClientModels["MoltenMetal"]:SetCycle(self.b_cycle)
				end
			end
		else
			self.ClientModels["MoltenMetal"] = self:CreateClientSideModel("models/zerochain/props_mining/zrms_melter_moltenmetal.mdl")
			self.ClientModels["MoltenMetal"]:SetNoDraw(true)
			self.ClientModels["MoltenMetal"]:SetAngles(self:GetAngles())

			local attach = self:GetAttachment(self:LookupAttachment("moltenmetal"))
			if attach then
				self.ClientModels["MoltenMetal"]:SetPos(attach.Pos + self:GetForward() * 1.5 + self:GetUp() * -2)
				self.ClientModels["MoltenMetal"]:SetParent(self, self:LookupAttachment("moltenmetal"))
			end
		end

		if IsValid(self.ClientModels["Coal"]) then
			self:UpdateCoal()
		else
			self.ClientModels["Coal"] = self:CreateClientSideModel("models/zerochain/props_mining/zrms_melter_coal.mdl")
			self.ClientModels["Coal"]:SetNoDraw(true)
			self.ClientModels["Coal"]:SetPos(self:GetPos() + self:GetUp() * -23)
			self.ClientModels["Coal"]:SetAngles(self:GetAngles())
			self.ClientModels["Coal"]:SetParent(self)
		end


		if IsValid(self.ClientModels["Bars"]) then

			local attach = self:GetAttachment(self:LookupAttachment("moltenmetal"))

			local ang = attach.Ang
			ang:RotateAroundAxis(attach.Ang:Up(),90)

			self.ClientModels["Bars"]:SetPos(attach.Pos + attach.Ang:Up() * -1 + attach.Ang:Forward() * 1)
			self.ClientModels["Bars"]:SetAngles(ang)
		else
			self.ClientModels["Bars"] = self:CreateClientSideModel("models/zerochain/props_mining/zrms_melter_bars.mdl")
			self.ClientModels["Bars"]:SetNoDraw(true)
			self.ClientModels["Bars"]:SetParent(self, self:LookupAttachment("moltenmetal"))
		end

		// Handels Sound
		self:MelterSound()

		// Handels Animation and Effects
		self:StateSwitch()

	end
	self:SetNextClientThink(CurTime())
	return true
end

// State Logic Switch
function ENT:StateSwitch()
	local state = self:GetCurrentState()

	if self.LastState ~= state then

		//WAITING_FOR_ORDER
		if state == 0 then

			// Reset these values
			self.a_cycle = 0
			self.b_cycle = 0

			if self.LastState == 3 or self.LastState == -1 then
				zrmine.f.Animation(self, "open", 1)
			end
			self.ClientModels["Filling"]:SetNoDraw(true)
			self.ClientModels["Bars"]:SetNoDraw(true)
			self.ClientModels["MoltenMetal"]:SetNoDraw(true)
			self.ClientModels["Lava"]:SetNoDraw(true)

		//CHAMBER_FULL
		elseif state == 1 then

		//MELTING
		elseif state == 2 then

			zrmine.f.EmitSoundENT("zrmine_melter_move",self)

			zrmine.f.Animation(self, "close", 1)

			timer.Simple(2, function()
				if (IsValid(self)) then

					self.SoundStage = 1

					zrmine.f.ParticleEffectAttach("zrms_melter_coalpit", self, self:LookupAttachment("coalpit"))
					zrmine.f.ParticleEffectAttach("zrms_melter_head", self, self:LookupAttachment("body"))
					zrmine.f.ParticleEffectAttach("zrms_melter_chimney", self, self:LookupAttachment("chimney01"))
					zrmine.f.ParticleEffectAttach("zrms_melter_chimney", self, self:LookupAttachment("chimney02"))

					self.ClientModels["Filling"]:SetNoDraw(true)
				end
			end)

		//UNLOADING
		elseif state == 3 then

			self.SoundStage = 2

			zrmine.f.EmitSoundENT("zrmine_melter_move",self)
			self:EmitSound("doors/door_metal_rusty_move1.wav", 75, 100, 1, CHAN_AUTO)

			self:StopParticlesNamed("zrms_melter_coalpit")
			zrmine.f.Animation(self, "unload_start", 1)

			timer.Simple(2, function()
				if IsValid(self) then

					self:EmitSound("doors/door_metal_rusty_move1.wav", 75, 100, 1, CHAN_AUTO)

					zrmine.f.ParticleEffectAttach("zrms_melter_unload", self, self:LookupAttachment("effectpoint01"))

					self.ClientModels["Lava"]:SetNoDraw(false)
					self.ClientModels["MoltenMetal"]:SetNoDraw(false)

				end
			end)

			timer.Simple(zrmine.config.Melter_UnloadTime, function()
				if IsValid(self) then

					self.ClientModels["Lava"]:SetNoDraw(true)
					self:EmitSound("doors/door_metal_rusty_move1.wav", 75, 100, 1, CHAN_AUTO)
					zrmine.f.Animation(self, "unload_stop", 1)

					self:StopParticlesNamed("zrms_melter_unload")
					self:StopParticlesNamed("zrms_melter_chimney")
					self:StopParticlesNamed("zrms_melter_head")
				end
			end)

			local rType = self:GetResourceType()

			timer.Simple(zrmine.config.Melter_UnloadTime + zrmine.config.Melter_Vars[rType].CoolingTime, function()
				if (IsValid(self)) then

					self.SoundStage = 3

					self:EmitSound("doors/door_metal_rusty_move1.wav", 75, 100, 1, CHAN_AUTO)
					zrmine.f.EmitSoundENT("zrmine_melter_move",self)

					zrmine.f.Animation(self, "unload_bars", 1)

					self.ClientModels["MoltenMetal"]:SetNoDraw(true)

					local btype = self:GetResourceType()

					if (btype == "Iron") then
						self.ClientModels["Bars"]:SetSkin(0)
					elseif (btype == "Bronze") then
						self.ClientModels["Bars"]:SetSkin(1)
					elseif (btype == "Silver") then
						self.ClientModels["Bars"]:SetSkin(2)
					elseif (btype == "Gold") then
						self.ClientModels["Bars"]:SetSkin(3)
					end

					self.ClientModels["Bars"]:SetNoDraw(false)

				end
			end)

			timer.Simple(zrmine.config.Melter_UnloadTime + zrmine.config.Melter_Vars[rType].CoolingTime + 1.75, function()
				if IsValid(self) then
					self.ClientModels["Bars"]:SetNoDraw(true)
					self.ClientModels["MoltenMetal"]:SetNoDraw(true)
				end
			end)

		end

		self.LastState = state
	end
end

// Client Props
function ENT:CreateClientSideModel(model)
	local ent = ClientsideModel(model)

	if IsValid(ent) and IsValid(self) then
		ent:SetPos(self:GetPos())
		ent:SetAngles(self:GetAngles())
	end
	return ent
end

function ENT:RemoveClientModels()
	if (self.ClientModels and table.Count(self.ClientModels) > 0) then
		for k, v in pairs(self.ClientModels) do
			if IsValid(v) then
				v:Remove()
			end
		end
	end
end

function ENT:OnRemove()
	self:RemoveClientModels()
end

--addons/zeros_retrominer_v2.3.6/lua/entities/zrms_minecart/cl_init.lua:
return gluapack()()
--addons/zeros_retrominer_v2.3.6/lua/entities/zrms_mineentrance_base/shared.lua:
return gluapack()()
--addons/zeros_retrominer_v2.3.6/lua/entities/zrms_ore/cl_init.lua:
/*
    Addon id: 
    Version: v2.3.6 (stable)
*/

include("shared.lua")

function ENT:Draw()
	self:DrawModel()

	if zrmine.f.InDistance(LocalPlayer():GetPos(), self:GetPos(), 300) and not zrmine.f.InDistance(LocalPlayer():GetPos(), self:GetPos(), 15) then
		self:DrawInfo()
	end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

	if zrmine.f.InDistance(LocalPlayer():GetPos(), self:GetPos(), 1000) then
		self:UpdateVisualsDraw()
	else
		self.LastAmount = -1
		self.LastType = -1
	end
end

function ENT:DrawTranslucent()
	self:Draw()
end

function ENT:DrawInfo()
	local amount = math.Round(self.LastAmount)
	local Text = amount .. zrmine.config.BuyerNPC_Mass
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

	if (amount <= 0) then
		Text = zrmine.language.Ore_Empty
	end

	cam.Start3D2D(self:LocalToWorld(Vector(0,0,60)), Angle(0, LocalPlayer():EyeAngles().y - 90, 90), 0.2)
		draw.DrawText(zrmine.f.GetOreTranslation(self.LastType), "zrmine_mineentrance_font1", 0, -50, zrmine.default_colors["white02"], TEXT_ALIGN_CENTER)
		draw.DrawText(Text, "zrmine_resource_font2", 0, 0, zrmine.default_colors["white02"], TEXT_ALIGN_CENTER)
	cam.End3D2D()
end

function ENT:Initialize()
	self.InsertEffect = ParticleEmitter(self:GetPos())
	self.LastAmount = -1
	self.LastType = -1
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

function ENT:UpdateVisualsDraw()
	local rType = self:GetResourceType()
	local rAmount = self:GetResourceAmount()
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

	if self.LastAmount ~= rAmount or self.LastType ~= rType then
		self.LastAmount = rAmount
		self.LastType = rType
	end
end

--addons/zeros_retrominer_v2.3.6/lua/entities/zrms_refiner_coal.lua:
/*
    Addon id: 
    Version: v2.3.6 (stable)
*/

AddCSLuaFile()
DEFINE_BASECLASS("zrms_refiner")
ENT.Type = "anim"
ENT.Base = "zrms_refiner"
ENT.RenderGroup = RENDERGROUP_BOTH
ENT.Spawnable = false
ENT.AdminSpawnable = false
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

ENT.PrintName = "Refinery - Coal"
ENT.Author = "ClemensProduction aka Zerochain"
ENT.Information = "info"
ENT.Category = "Zeros RetroMiningSystem"
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

ENT.AutomaticFrameAdvance = true
ENT.DisableDuplicator = false
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

ENT.RefinerType = "Coal"
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

ENT.RefiningTime = zrmine.config.Coal_RefiningTime
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

--addons/zeros_retrominer_v2.3.6/lua/entities/zrms_resource_bronze.lua:
/*
    Addon id: 
    Version: v2.3.6 (stable)
*/

AddCSLuaFile()
DEFINE_BASECLASS("zrms_resource")
ENT.Type = "anim"
ENT.Base = "zrms_resource"
ENT.RenderGroup = RENDERGROUP_BOTH
ENT.Spawnable = false
ENT.AdminSpawnable = false
ENT.PrintName = "Gravel - Bronze"
ENT.Author = "ClemensProduction aka Zerochain"
ENT.Information = "info"
ENT.Category = "Zeros RetroMiningSystem"
ENT.Model = "models/Zerochain/props_mining/zrms_resource.mdl"
ENT.DisableDuplicator = false
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

function ENT:SetupDataTables()
	self:NetworkVar("Float", 0, "ResourceAmount")
	self:NetworkVar("String", 0, "ResourceType")
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

	if (SERVER) then
		self:SetResourceType("Bronze")
		self:SetResourceAmount(25)
	end
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

--addons/zeros_retrominer_v2.3.6/lua/entities/zrms_sorter_iron.lua:
/*
    Addon id: 
    Version: v2.3.6 (stable)
*/

AddCSLuaFile()
DEFINE_BASECLASS("zrms_sorter")
ENT.Type = "anim"
ENT.Base = "zrms_sorter"
ENT.RenderGroup = RENDERGROUP_OPAQUE
ENT.Spawnable = false
ENT.AdminSpawnable = false
ENT.PrintName = "Filter - Iron"
ENT.Author = "ClemensProduction aka Zerochain"
ENT.Information = "info"
ENT.Category = "Zeros RetroMiningSystem"
ENT.Model = "models/zerochain/props_mining/zrms_conveyorbelt_sorter.mdl"
ENT.AutomaticFrameAdvance = true
ENT.DisableDuplicator = false
ENT.SorterSpeed = 3
ENT.WorkAmount = 6
ENT.HoldAmount = 25
ENT.FilterType = "Iron" // What type of resource are we sorting out
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

--addons/zeros_retrominer_v2.3.6/lua/entities/zrms_storagecrate/cl_init.lua:
return gluapack()()
--addons/zeros_trashman_v1.6.3/lua/entities/ztm_recycler/shared.lua:
/*
    Addon id: 
    Version: v1.6.3 (stable)
*/

ENT.Type = "anim"
ENT.Base = "base_anim"
ENT.AutomaticFrameAdvance = true
ENT.Model = "models/zerochain/props_trashman/ztm_recycler.mdl"
ENT.Spawnable = true
ENT.AdminSpawnable = false
ENT.PrintName = "Recycler"
ENT.Category = "Zeros Trashman"
ENT.RenderGroup = RENDERGROUP_OPAQUE
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

function ENT:SetupDataTables()
    self:NetworkVar("Int", 0, "Trash")
    self:NetworkVar("Int", 1, "SelectedType")
    self:NetworkVar("Int", 2, "RecycleStage")
    self:NetworkVar("Float", 0, "StartTime")


    if (SERVER) then
        self:SetTrash(0)
        self:SetSelectedType(1)
        //self:SetIsRecycling(false)
        self:SetRecycleStage(0)
        self:SetStartTime(-1)
    end
end


function ENT:OnStartButton(ply)
    local trace = ply:GetEyeTrace()

    local lp = self:WorldToLocal(trace.HitPos)
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

    if lp.x > 35 and lp.x < 36 and lp.y < 20.6 and lp.y > -9.5 and lp.z > 49.17 and lp.z < 54.4 then
        return true
    else
        return false
    end
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

function ENT:OnSwitchButton_Left(ply)
    local trace = ply:GetEyeTrace()
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

    local lp = self:WorldToLocal(trace.HitPos)

    if lp.x > 35 and lp.x < 36 and lp.y < -4.3 and lp.y > -9.5 and lp.z > 56.90 and lp.z < 62.0 then
        return true
    else
        return false
    end
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

function ENT:OnSwitchButton_Right(ply)
    local trace = ply:GetEyeTrace()

    local lp = self:WorldToLocal(trace.HitPos)

    if lp.x > 35 and lp.x < 36 and lp.y < 20.6 and lp.y > 15.4 and lp.z > 56.90 and lp.z < 62.0 then
        return true
    else
        return false
    end
end

--addons/zeros_trashman_v1.6.3/lua/entities/ztm_trash/cl_init.lua:
return gluapack()()
--addons/zeros_trashman_v1.6.3/lua/entities/ztm_trashburner/shared.lua:
/*
    Addon id: 
    Version: v1.6.3 (stable)
*/

ENT.Type = "anim"
ENT.Base = "base_anim"
ENT.AutomaticFrameAdvance = true
ENT.Model = "models/zerochain/props_trashman/ztm_trashburner.mdl"
ENT.Spawnable = true
ENT.AdminSpawnable = false
ENT.PrintName = "Trashburner"
ENT.Category = "Zeros Trashman"
ENT.RenderGroup = RENDERGROUP_OPAQUE

function ENT:SetupDataTables()
    self:NetworkVar("Int", 0, "Trash")
    self:NetworkVar("Bool", 1, "IsBurning")
    self:NetworkVar("Bool", 0, "IsClosed")
    self:NetworkVar("Float", 0, "StartTime")
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

    if (SERVER) then
        self:SetTrash(0)
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

        self:SetIsClosed(false)
        self:SetIsBurning(false)
        self:SetStartTime(-1)
    end
end

function ENT:OnCloseButton(ply)
    local trace = ply:GetEyeTrace()

    local lp = self:WorldToLocal(trace.HitPos)
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

    if lp.x > -40 and lp.x < -38 and lp.y < 10.5 and lp.y > 0 and lp.z > 52 and lp.z < 60 then
        return true
    else
        return false
    end
end

function ENT:OnStartButton(ply)
    local trace = ply:GetEyeTrace()

    local lp = self:WorldToLocal(trace.HitPos)
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

    if lp.x > -40 and lp.x < -38 and lp.y < -0.6 and lp.y > -11 and lp.z > 52 and lp.z < 60 then
        return true
    else
        return false
    end
end
                                                                                                                                                                                                                                                                                                                                                                                                                                                       -- 

--addons/zeros_yeastbeast_1.1.7/lua/entities/zyb_jarpack/cl_init.lua:
include("shared.lua")

function ENT:Draw()
	self:DrawModel()
end

function ENT:DrawTranslucent()
	self:Draw()
end

function ENT:Initialize()
	self.JarCount = 0
end

function ENT:Think()
	if zyb.f.InDistance(LocalPlayer():GetPos(), self:GetPos(), 800) then
		if self.ClientProps then
			if self.JarCount ~= self:GetJarCount() then
				self:RemoveClientModels()
				self.JarCount = self:GetJarCount()

				for i = 1, math.Clamp(self.JarCount,0,6) do
					self:SpawnClientModel_Jar(i)
				end
			end
		else
			self.ClientProps = {}
		end
	else
		self:RemoveClientModels()
	end

	self:SetNextClientThink(CurTime())

	return true
end

function ENT:SpawnClientModel_Jar(pos)
	local ent = ents.CreateClientProp()
	ent:SetPos(self:LocalToWorld(Vector(0, 0, -5)))
	ent:SetModel("models/zerochain/props_yeastbeast/yb_jar.mdl")
	ent:SetAngles(self:LocalToWorldAngles(Angle(0, 0, 0)))
	ent:Spawn()
	ent:Activate()
	ent:SetRenderMode(RENDERMODE_TRANSALPHA)
	ent:SetParent(self)
	ent:SetPos(self:GetAttachment(pos).Pos - self:GetUp() * 3)

	self.ClientProps[pos] = ent
end

function ENT:RemoveClientModels()
	if (self.ClientProps and table.Count(self.ClientProps) > 0) then
		for k, v in pairs(self.ClientProps) do
			if IsValid(v) then
				v:Remove()
			end
		end
	end

	self.ClientProps = {}
	self.JarCount = 0
end

function ENT:OnRemove()
	self:RemoveClientModels()
end

--addons/zeros_yeastbeast_1.1.7/lua/entities/zyb_palette/shared.lua:
ENT.Type = "anim"
ENT.Base = "base_entity"
ENT.RenderGroup = RENDERGROUP_BOTH
ENT.Spawnable = true
ENT.AdminSpawnable = false
ENT.PrintName = "Transport Palette"
ENT.Author = "ClemensProduction aka Zerochain"
ENT.Information = "info"
ENT.Category = "Zeros YeastBeast"
ENT.Model = "models/props_junk/wood_pallet001a.mdl"

function ENT:SetupDataTables()
	self:NetworkVar("Int", 0, "CrateCount")

	if (SERVER) then
		self:SetCrateCount(0)
	end
end

--addons/zeros_yeastbeast_1.1.7/lua/entities/zyb_sugar/cl_init.lua:
return gluapack()()
--addons/zeros_yeastbeast_1.1.7/lua/entities/zyb_sugar/shared.lua:
ENT.Type = "anim"
ENT.Base = "base_anim"
ENT.Model = "models/zerochain/props_yeastbeast/yb_sugar.mdl"
ENT.Spawnable = true
ENT.AdminSpawnable = false
ENT.PrintName = "Sugar"
ENT.Category = "Zeros YeastBeast"
ENT.RenderGroup = RENDERGROUP_OPAQUE

--addons/zeros_yeastbeast_1.1.7/lua/entities/zyb_upgrade/shared.lua:
ENT.Type = "anim"
ENT.Base = "base_anim"
ENT.Model = "models/zerochain/props_yeastbeast/yb_distillery_filter.mdl"
ENT.Spawnable = false
ENT.AdminSpawnable = false
ENT.PrintName = "Upgrade - Speed"
ENT.Category = "Zeros YeastBeast"
ENT.RenderGroup = RENDERGROUP_TRANSLUCENT

function ENT:SetupDataTables()
    self:NetworkVar("Int", 0, "UpgradeID")
    self:NetworkVar("Bool", 0, "IsDirty")


    if (SERVER) then
        self:SetIsDirty(false)
        self:SetUpgradeID(1)
    end
end

--addons/zeros_yeastbeast_1.1.7/lua/entities/zyb_yeastgrinder/cl_init.lua:
return gluapack()()
--addons/[binbon]arccw_modify/lua/effects/arccw_incendiaryround.lua:
return gluapack()()
--lua/effects/arccw_uc_tracer.lua:
EFFECT.StartPos = Vector(0, 0, 0)
EFFECT.EndPos = Vector(0, 0, 0)
EFFECT.StartTime = 0
EFFECT.LifeTime = 0.2
EFFECT.LifeTime2 = 0.15
EFFECT.DieTime = 0
EFFECT.Color = Color(255, 255, 255)
EFFECT.Speed = 6000

local head = Material("effects/whiteflare")
local tracer = Material("effects/smoke_trail")
local smoke = Material("trails/smoke")

function EFFECT:Init(data)

    local hit = data:GetOrigin()
    local wep = data:GetEntity()

    if !IsValid(wep) then return end

    local speed = data:GetScale()
    local start = (wep.GetTracerOrigin and wep:GetTracerOrigin()) or data:GetStart()

    --[[]
    if GetConVar("arccw_fasttracers"):GetBool() then
            local fx = EffectData()
            fx:SetOrigin(hit)
            fx:SetEntity(wep)
            fx:SetStart(start)
            fx:SetScale(4000)
            util.Effect("tracer", fx)
            self:Remove()
        return
    end
    ]]

    if speed > 0 then
        self.Speed = speed
    end

    local profile = 0
    if wep.GetBuff_Override then
        profile = wep:GetBuff_Override("Override_PhysTracerProfile", wep.PhysTracerProfile) or 0
        if isnumber(profile) then profile = ArcCW.BulletProfileDict[ArcCW.BulletProfiles[profile]] end
    end

    self.LifeTime = (hit - start):Length() / self.Speed

    self.StartTime = UnPredictedCurTime()
    self.DieTime = UnPredictedCurTime() + math.max(self.LifeTime, self.LifeTime2)

    self.StartPos = start
    self.EndPos = hit
    self.Color = (ArcCW.BulletProfileDict[profile] or ArcCW.BulletProfileDict["default0"]).color

    -- print(profile)
end

function EFFECT:Think()
    return self.DieTime > UnPredictedCurTime()
end

local function LerpColor(d, col1, col2)
    local r = Lerp(d, col1.r, col2.r)
    local g = Lerp(d, col1.g, col2.g)
    local b = Lerp(d, col1.b, col2.b)
    local a = Lerp(d, col1.a, col2.a)
    return Color(r, g, b, a)
end

function EFFECT:Render()
    local d = (UnPredictedCurTime() - self.StartTime) / self.LifeTime
    local d2 = (UnPredictedCurTime() - self.StartTime) / self.LifeTime2
    local startpos = self.StartPos + (d * 0.15 * (self.EndPos - self.StartPos))
    local endpos = self.StartPos + (d * (self.EndPos - self.StartPos))
    local size = 2

    local col = LerpColor(d, self.Color, Color(0, 0, 0, 255))
    local col2 = LerpColor(d2, Color(255, 255, 255, 127), Color(0, 0, 0, 0))

    render.SetMaterial(head)
    render.DrawSprite(endpos, size * 3, size * 3, col)

    render.SetMaterial(tracer)
    render.DrawBeam(endpos, startpos, size * 2, 0, 1, col)

    render.SetMaterial(smoke)
    render.DrawBeam(self.EndPos, self.StartPos, size * 0.5 * d2, 0, 1, col2)
end

--lua/effects/soccerball_explode.lua:
return gluapack()()
--addons/oneprint/lua/oneprint/shared/util.lua:
return gluapack()()
--addons/oneprint/lua/oneprint/shared/util.lua:
--[[

    OnePrint:L

]]--

function OnePrint:L( sLangString )
    return OnePrint.Lang[ sLangString ]
end

--[[

    OnePrint:C

]]--

function OnePrint:C( iColorIndex )
    return OnePrint.Cfg.Colors[ iColorIndex ]
end

--[[

    OnePrint:FormatMoney

]]--

local tMoneyFormatting = {
    [ "DarkRP" ] = function( iMoney )
        return DarkRP.formatMoney( iMoney )
    end,
    [ "Nutscript" ] = function( iMoney )
        local sMoney = nut.currency.get( iMoney )
        local tSplit = string.Split( sMoney, " " )

        return tSplit[ 1 ] or sMoney
    end,
    [ "Helix" ] = function( iMoney )
        return ix.currency.Get( iMoney )
    end
}

function OnePrint:FormatMoney( iMoney )
    if DarkRP then
        return tMoneyFormatting[ "DarkRP" ]( iMoney )
    end

    if ( nut and nut.currency ) then
        return tMoneyFormatting[ "Nutscript" ]( iMoney )
    end

    if ( ix and ix.currency ) then
        return tMoneyFormatting[ "Helix" ]( iMoney )
    end

    return ( "$" .. string.Comma( iMoney ) )
end

--addons/oneprint/lua/oneprint/client/vgui/3d2dvgui.lua:
--[[
	
3D2D VGUI Wrapper
Copyright (c) 2015-2017 Alexander Overvoorde, Matt Stevens

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

]]--

local origin = Vector(0, 0, 0)
local angle = Angle(0, 0, 0)
local normal = Vector(0, 0, 0)
local scale = 0
local maxrange = 0

-- Helper functions

local function getCursorPos()
	local p = util.IntersectRayWithPlane(LocalPlayer():EyePos(), LocalPlayer():GetAimVector(), origin, normal)

	-- if there wasn't an intersection, don't calculate anything.
	if not p then return end
	if WorldToLocal(LocalPlayer():GetShootPos(), Angle(0,0,0), origin, angle).z < 0 then return end

	if maxrange > 0 then
		if p:DistToSqr(LocalPlayer():EyePos()) > ( maxrange ^ 2 ) then
			return
		end
	end

	local pos = WorldToLocal(p, Angle(0,0,0), origin, angle)

	return pos.x, -pos.y
end

function OnePrint:GetCursorPos()
	local iX, iY = getCursorPos()
	if not iX or not iY then
		return 0, 0
	end

	return ( iX * 26 ), ( iY * 26 )
end

local function getParents(pnl)
	local parents = {}
	local parent = pnl:GetParent()
	while parent do
		table.insert(parents, parent)
		parent = parent:GetParent()
	end
	return parents
end

local function absolutePanelPos(pnl)
	local x, y = pnl:GetPos()
	local parents = getParents(pnl)
	
	for _, parent in ipairs(parents) do
		local px, py = parent:GetPos()
		x = x + px
		y = y + py
	end
	
	return x, y
end

local function pointInsidePanel(pnl, x, y)
	local px, py = absolutePanelPos(pnl)
	local sx, sy = pnl:GetSize()

	if not x or not y then return end

	x = x / scale
	y = y / scale

	return pnl:IsVisible() and x >= px and y >= py and x <= px + sx and y <= py + sy
end

-- Input

local inputWindows = {}
local usedpanel = {}

local function isMouseOver(pnl)
	return pointInsidePanel(pnl, getCursorPos())
end

function OnePrint:isMouseOver(pnl)
	return pointInsidePanel(pnl, getCursorPos())
end

local function postPanelEvent(pnl, event, ...)
	if not IsValid(pnl) or not pnl:IsVisible() or not pointInsidePanel(pnl, getCursorPos()) then return false end

	local handled = false
	
	for i, child in pairs(table.Reverse(pnl:GetChildren())) do		
		if postPanelEvent(child, event, ...) then
			handled = true
			break
		end
	end
	
	if not handled and pnl[event] then
		pnl[event](pnl, ...)
		usedpanel[pnl] = {...}
		return true
	else
		return false
	end
end

-- Always have issue, but less
local function checkHover(pnl, x, y, found)
	if not (x and y) then
		x, y = getCursorPos()
	end

	local validchild = false
	for c, child in pairs(table.Reverse(pnl:GetChildren())) do
		
		local check = checkHover(child, x, y, found or validchild)

		if check then
			validchild = true
		end
	end

	if found then
		if pnl.Hovered then
			pnl.Hovered = false
			if pnl.OnCursorExited then pnl:OnCursorExited() end
		end
	else
		if not validchild and pointInsidePanel(pnl, x, y) then
			pnl.Hovered = true
			if pnl.OnCursorEntered then pnl:OnCursorEntered() end

			return true
		else
			pnl.Hovered = false
			if pnl.OnCursorExited then pnl:OnCursorExited() end
		end
	end

	return false
end

-- Mouse input

hook.Add("KeyPress", "VGUI3D2DMousePress", function(_, key)
	if key == IN_USE then
		for pnl in pairs(inputWindows) do
			if IsValid(pnl) then
				origin = pnl.Origin
				scale = pnl.Scale
				angle = pnl.Angle
				normal = pnl.Normal

				local key = input.IsKeyDown(KEY_LSHIFT) and MOUSE_RIGHT or MOUSE_LEFT
				
				postPanelEvent(pnl, "OnMousePressed", key)
			end
		end
	end
end)

hook.Add("KeyRelease", "VGUI3D2DMouseRelease", function(_, key)
	if key == IN_USE then
		for pnl, key in pairs(usedpanel) do
			if IsValid(pnl) then
				origin = pnl.Origin
				scale = pnl.Scale
				angle = pnl.Angle
				normal = pnl.Normal

				if pnl["OnMouseReleased"] then
					pnl["OnMouseReleased"](pnl, key[1])
				end

				usedpanel[pnl] = nil
			end
		end
	end
end)

function vgui.Start3D2D(pos, ang, res)
	origin = pos
	scale = res
	angle = ang
	normal = ang:Up()
	maxrange = 0
	
	cam.Start3D2D(pos, ang, res)
end

function vgui.MaxRange3D2D(range)
	maxrange = isnumber(range) and range or 0
end

function vgui.IsPointingPanel(pnl)
	origin = pnl.Origin
	scale = pnl.Scale
	angle = pnl.Angle
	normal = pnl.Normal

	return pointInsidePanel(pnl, getCursorPos())
end

local Panel = FindMetaTable("Panel")
function Panel:Paint3D2D()
	if not self:IsValid() then return end

	-- Add it to the list of windows to receive input
	inputWindows[self] = true

	-- Override gui.MouseX and gui.MouseY for certain stuff
	local oldMouseX = gui.MouseX
	local oldMouseY = gui.MouseY
	local cx, cy = getCursorPos()

	function gui.MouseX()
		return (cx or 0) / scale
	end
	function gui.MouseY()
		return (cy or 0) / scale
	end
	
	-- Override think of DFrame's to correct the mouse pos by changing the active orientation
	if self.Think then
		if not self.OThink then
			self.OThink = self.Think
			
			self.Think = function()
				origin = self.Origin
				scale = self.Scale
				angle = self.Angle
				normal = self.Normal
				
				self:OThink()
			end
		end
	end
	
	-- Update the hover state of controls
	local _, tab = checkHover(self)
	
	-- Store the orientation of the window to calculate the position outside the render loop
	self.Origin = origin
	self.Scale = scale
	self.Angle = angle
	self.Normal = normal
	
	-- Draw it manually
	self:SetPaintedManually(false)
		self:PaintManual()
	self:SetPaintedManually(true)

	gui.MouseX = oldMouseX
	gui.MouseY = oldMouseY
end

function vgui.End3D2D()
	cam.End3D2D()
end

--addons/oneprint/lua/oneprint/client/vgui/tabs/lock.lua:
local LockScreen = {}

LockScreen.ID = 0
LockScreen.Name = "Lockscreen"

local matCode = Material( "materials/oneprint/code.png", "smooth" )
local matLock = Material( "materials/oneprint/lock.png", "smooth" )
local matArrow = Material( "materials/oneprint/arrow.png", "smooth" )

--[[

    LockScreen.Run

]]--

function LockScreen.Run( dBase )
    if not dBase or not IsValid( dBase ) then
        return
    end

    if not dBase.eEntity or not IsValid( dBase.eEntity ) or ( dBase.eEntity:GetClass() ~= "oneprint" ) then
        return
    end

    dBase.ActiveTab = vgui.Create( "DPanel", dBase )
    dBase.ActiveTab:SetSize( dBase:GetWide(), dBase:GetTall() )

    local tCol = OnePrint:C( 5 )

    function dBase.ActiveTab:Paint( iW, iH )
        surface.SetDrawColor( tCol )
        surface.SetMaterial( matLock )
        surface.DrawTexturedRectRotated( ( iW * .5 ), ( iH * .48 ), ( iH * .06 ), ( iH * .06 ), 0 )
    end

    -- Community logo
    if OnePrint.Cfg.CommunityLogo then
        local dLogo = vgui.Create( "DHTML", dBase.ActiveTab )
        dLogo:SetSize( ( dBase:GetTall() * .2 ), ( dBase:GetTall() * .2 ) )
        dLogo:SetPos( ( dBase:GetWide() * .5 ) - ( dLogo:GetWide() * .5 ), ( dBase:GetTall() * .12 ) - ( dLogo:GetTall() * .5 ) )
        dLogo:SetMouseInputEnabled( false )
        dLogo:SetHTML( "<style> body, html { height: 100%; margin: 0; } .icon { background-image: url(" .. OnePrint.Cfg.CommunityLogo .. "); height: 100%; background-position: center; background-repeat: no-repeat; background-size: cover; overflow: hidden;} </style> <body> <div class=\"icon\"></div> </body>" )

        local matGradientDown = Material( "vgui/gradient-d" )

        function dLogo:PaintOver( iW, iH )
            surface.SetDrawColor( OnePrint:C( 0 ) )

            surface.SetMaterial( matGradientDown )
            surface.DrawTexturedRect( 0, 0, iW, iH )
        end
    end

    -- Hack
    if LocalPlayer():OP_IsHaxor() or ( OnePrint.Cfg.HackingOwnedPrinter and ( dBase.eEntity:GetOwnerObject() == LocalPlayer() ) ) then
        local dHack = vgui.Create( "DButton", dBase.ActiveTab )
        dHack:SetSize( ( dBase:GetTall() * .05 ), ( dBase:GetTall() * .05 ) )
        dHack:SetText( "" )
        dHack:AlignRight( OnePrint.iMargin )
        dHack:AlignTop( OnePrint.iMargin )
        dHack.tColor = OnePrint:C( 1 )

        function dHack:Paint( iW, iH )
            surface.SetDrawColor( self.tColor )
            surface.SetMaterial( matCode )
            surface.DrawTexturedRect( 0, 0, iW, iH , 0 )
        end

        function dHack:OnCursorEntered()
            self.tColor = OnePrint:C( 5 )
        end

        function dHack:OnCursorExited()
            self.tColor = OnePrint:C( 2 )
        end

        function dHack:DoClick()
            OnePrint:SetTab( dBase, 4 )
        end
    end

    -- Unlock
    local dUnlock = vgui.Create( "DPanel", dBase.ActiveTab )
    dUnlock:SetSize( ( dBase:GetWide() * .7 ), ( dBase:GetTall() * .12 ) )
    dUnlock:AlignLeft( ( dBase:GetWide() * .5 ) - ( dUnlock:GetWide() * .5 ) )
    dUnlock:AlignBottom( OnePrint.iMargin * 4 )
    dUnlock.fLerp = 0
    dUnlock.fLerpTo = 0

    local sUnlockText = string.upper( OnePrint:L( "Scroll to unlock" ) )
    local iLen = string.len( sUnlockText )

    surface.SetFont( "OnePrint.4" )
    local iTextW, iTextH = surface.GetTextSize( sUnlockText )

    local tText = {}

    for i = 1, iLen do
        tText[ i ] = {
            iX = ( i * ( iTextW + 50 ) / iLen ),
            sChar = string.sub( sUnlockText, i, i ),
            iAlpha = 255
        }
    end

    function dUnlock:OnCursorEntered()
        if not OnePrint.Cfg.CanUsePrinter["*"] then
            if not OnePrint.Cfg.CanUsePrinter[team.GetName(LocalPlayer():Team())] then return end
        end

        self.fLerpTo = self:GetWide()
    end

    function dUnlock:OnCursorExited()
        self.fLerpTo = 0
    end

    function dUnlock:Paint( iW, iH )
        self.fLerp = Lerp( RealFrameTime() * 3, self.fLerp, self.fLerpTo )

        if ( self.fLerp >= ( iW * .95 ) ) then
            if dBase.eEntity:CanPlayerUse( LocalPlayer() ) then
                OnePrint:SetTab( dBase, 1, true )
                OnePrint:Play2DSound( "oneprint/unlock.mp3" )
            else
                tCol = OnePrint:C( 4 )
            end
        else
            tCol = OnePrint:C( 5 )
        end

        surface.SetDrawColor( ColorAlpha( tCol, 255 - ( self.fLerp * 255 / iW ) ) )
        surface.SetMaterial( matArrow )
        surface.DrawTexturedRectRotated( ( iH * .32 ) + ( self.fLerp * .93 ), ( iH * .5 ), ( iH * .5 ), ( iH * .5 ), 0 )

        for k, v in pairs( tText ) do
            v.iAlpha = ( v.iX * 255 / ( self.fLerp * ( iTextW * .5 ) ) )
            
            draw.SimpleText( v.sChar, "OnePrint.4", v.iX + ( iW * .5 ) - ( iTextW * .5 ) - 30, ( iH * .5 ), ColorAlpha( tCol, v.iAlpha ), 1, 1 )
        end
    end
end

OnePrint:RegisterTab( LockScreen )